"use strict";(self.webpackChunkLKovariHome=self.webpackChunkLKovariHome||[]).push([[582],{2090:(qr,Ut,q)=>{q.d(Ut,{BH:()=>E,G6:()=>un,L:()=>ke,LL:()=>Me,Pz:()=>Ue,Sg:()=>cn,UG:()=>F,ZB:()=>ne,ZR:()=>De,aH:()=>Rt,b$:()=>Nn,eu:()=>ai,hl:()=>In,jU:()=>nt,m9:()=>Cn,ne:()=>Pn,pd:()=>Ri,r3:()=>dr,ru:()=>ct,tV:()=>B,uI:()=>Pt,vZ:()=>Ni,w1:()=>hr,xO:()=>jr,xb:()=>Oi,z$:()=>we,zd:()=>En});const X=function(T){const I=[];let b=0;for(let M=0;M<T.length;M++){let D=T.charCodeAt(M);D<128?I[b++]=D:D<2048?(I[b++]=D>>6|192,I[b++]=63&D|128):55296==(64512&D)&&M+1<T.length&&56320==(64512&T.charCodeAt(M+1))?(D=65536+((1023&D)<<10)+(1023&T.charCodeAt(++M)),I[b++]=D>>18|240,I[b++]=D>>12&63|128,I[b++]=D>>6&63|128,I[b++]=63&D|128):(I[b++]=D>>12|224,I[b++]=D>>6&63|128,I[b++]=63&D|128)}return I},tt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(T,I){if(!Array.isArray(T))throw Error("encodeByteArray takes an array as a parameter");this.init_();const b=I?this.byteToCharMapWebSafe_:this.byteToCharMap_,M=[];for(let D=0;D<T.length;D+=3){const ee=T[D],ue=D+1<T.length,Ae=ue?T[D+1]:0,St=D+2<T.length,ht=St?T[D+2]:0;let Yt=(15&Ae)<<2|ht>>6,Mi=63&ht;St||(Mi=64,ue||(Yt=64)),M.push(b[ee>>2],b[(3&ee)<<4|Ae>>4],b[Yt],b[Mi])}return M.join("")},encodeString(T,I){return this.HAS_NATIVE_SUPPORT&&!I?btoa(T):this.encodeByteArray(X(T),I)},decodeString(T,I){return this.HAS_NATIVE_SUPPORT&&!I?atob(T):function(T){const I=[];let b=0,M=0;for(;b<T.length;){const D=T[b++];if(D<128)I[M++]=String.fromCharCode(D);else if(D>191&&D<224){const ee=T[b++];I[M++]=String.fromCharCode((31&D)<<6|63&ee)}else if(D>239&&D<365){const St=((7&D)<<18|(63&T[b++])<<12|(63&T[b++])<<6|63&T[b++])-65536;I[M++]=String.fromCharCode(55296+(St>>10)),I[M++]=String.fromCharCode(56320+(1023&St))}else{const ee=T[b++],ue=T[b++];I[M++]=String.fromCharCode((15&D)<<12|(63&ee)<<6|63&ue)}}return I.join("")}(this.decodeStringToByteArray(T,I))},decodeStringToByteArray(T,I){this.init_();const b=I?this.charToByteMapWebSafe_:this.charToByteMap_,M=[];for(let D=0;D<T.length;){const ee=b[T.charAt(D++)],Ae=D<T.length?b[T.charAt(D)]:0;++D;const ht=D<T.length?b[T.charAt(D)]:64;++D;const Ee=D<T.length?b[T.charAt(D)]:64;if(++D,null==ee||null==Ae||null==ht||null==Ee)throw new Fe;M.push(ee<<2|Ae>>4),64!==ht&&(M.push(Ae<<4&240|ht>>2),64!==Ee&&M.push(ht<<6&192|Ee))}return M},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let T=0;T<this.ENCODED_VALS.length;T++)this.byteToCharMap_[T]=this.ENCODED_VALS.charAt(T),this.charToByteMap_[this.byteToCharMap_[T]]=T,this.byteToCharMapWebSafe_[T]=this.ENCODED_VALS_WEBSAFE.charAt(T),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[T]]=T,T>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(T)]=T,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(T)]=T)}}};class Fe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ke=function(T){return function(T){const I=X(T);return tt.encodeByteArray(I,!0)}(T).replace(/\./g,"")},B=function(T){try{return tt.decodeString(T,!0)}catch(I){console.error("base64Decode failed: ",I)}return null};function ne(T,I){if(!(I instanceof Object))return I;switch(I.constructor){case Date:return new Date(I.getTime());case Object:void 0===T&&(T={});break;case Array:T=[];break;default:return I}for(const b in I)!I.hasOwnProperty(b)||!ae(b)||(T[b]=ne(T[b],I[b]));return T}function ae(T){return"__proto__"!==T}const _e=()=>{try{return function Pe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const T=process.env.__FIREBASE_DEFAULTS__;return T?JSON.parse(T):void 0})()||(()=>{if(typeof document>"u")return;let T;try{T=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const I=T&&B(T[1]);return I&&JSON.parse(I)})()}catch(T){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${T}`)}},Rt=()=>{var T;return null===(T=_e())||void 0===T?void 0:T.config},Ue=T=>{var I;return null===(I=_e())||void 0===I?void 0:I[`_${T}`]};class E{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((I,b)=>{this.resolve=I,this.reject=b})}wrapCallback(I){return(b,M)=>{b?this.reject(b):this.resolve(M),"function"==typeof I&&(this.promise.catch(()=>{}),1===I.length?I(b):I(b,M))}}}function cn(T,I){if(T.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const M=I||"demo-project",D=T.iat||0,ee=T.sub||T.user_id;if(!ee)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ue=Object.assign({iss:`https://securetoken.google.com/${M}`,aud:M,iat:D,exp:D+3600,auth_time:D,sub:ee,user_id:ee,firebase:{sign_in_provider:"custom",identities:{}}},T);return[ke(JSON.stringify({alg:"none",type:"JWT"})),ke(JSON.stringify(ue)),""].join(".")}function we(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Pt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(we())}function F(){var T;const I=null===(T=_e())||void 0===T?void 0:T.forceEnvironment;if("node"===I)return!0;if("browser"===I)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function nt(){return"object"==typeof self&&self.self===self}function ct(){const T="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof T&&void 0!==T.id}function Nn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function hr(){const T=we();return T.indexOf("MSIE ")>=0||T.indexOf("Trident/")>=0}function un(){return!F()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function In(){try{return"object"==typeof indexedDB}catch{return!1}}function ai(){return new Promise((T,I)=>{try{let b=!0;const M="validate-browser-context-for-indexeddb-analytics-module",D=self.indexedDB.open(M);D.onsuccess=()=>{D.result.close(),b||self.indexedDB.deleteDatabase(M),T(!0)},D.onupgradeneeded=()=>{b=!1},D.onerror=()=>{var ee;I((null===(ee=D.error)||void 0===ee?void 0:ee.message)||"")}}catch(b){I(b)}})}class De extends Error{constructor(I,b,M){super(b),this.code=I,this.customData=M,this.name="FirebaseError",Object.setPrototypeOf(this,De.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Me.prototype.create)}}class Me{constructor(I,b,M){this.service=I,this.serviceName=b,this.errors=M}create(I,...b){const M=b[0]||{},D=`${this.service}/${I}`,ee=this.errors[I],ue=ee?function Di(T,I){return T.replace(wn,(b,M)=>{const D=I[M];return null!=D?String(D):`<${M}?>`})}(ee,M):"Error";return new De(D,`${this.serviceName}: ${ue} (${D}).`,M)}}const wn=/\{\$([^}]+)}/g;function dr(T,I){return Object.prototype.hasOwnProperty.call(T,I)}function Oi(T){for(const I in T)if(Object.prototype.hasOwnProperty.call(T,I))return!1;return!0}function Ni(T,I){if(T===I)return!0;const b=Object.keys(T),M=Object.keys(I);for(const D of b){if(!M.includes(D))return!1;const ee=T[D],ue=I[D];if(Ct(ee)&&Ct(ue)){if(!Ni(ee,ue))return!1}else if(ee!==ue)return!1}for(const D of M)if(!b.includes(D))return!1;return!0}function Ct(T){return null!==T&&"object"==typeof T}function jr(T){const I=[];for(const[b,M]of Object.entries(T))Array.isArray(M)?M.forEach(D=>{I.push(encodeURIComponent(b)+"="+encodeURIComponent(D))}):I.push(encodeURIComponent(b)+"="+encodeURIComponent(M));return I.length?"&"+I.join("&"):""}function En(T){const I={};return T.replace(/^\?/,"").split("&").forEach(M=>{if(M){const[D,ee]=M.split("=");I[decodeURIComponent(D)]=decodeURIComponent(ee)}}),I}function Ri(T){const I=T.indexOf("?");if(!I)return"";const b=T.indexOf("#",I);return T.substring(I,b>0?b:void 0)}function Pn(T,I){const b=new xt(T,I);return b.subscribe.bind(b)}class xt{constructor(I,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{I(this)}).catch(M=>{this.error(M)})}next(I){this.forEachObserver(b=>{b.next(I)})}error(I){this.forEachObserver(b=>{b.error(I)}),this.close(I)}complete(){this.forEachObserver(I=>{I.complete()}),this.close()}subscribe(I,b,M){let D;if(void 0===I&&void 0===b&&void 0===M)throw new Error("Missing Observer.");D=function Mn(T,I){if("object"!=typeof T||null===T)return!1;for(const b of I)if(b in T&&"function"==typeof T[b])return!0;return!1}(I,["next","error","complete"])?I:{next:I,error:b,complete:M},void 0===D.next&&(D.next=ci),void 0===D.error&&(D.error=ci),void 0===D.complete&&(D.complete=ci);const ee=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?D.error(this.finalError):D.complete()}catch{}}),this.observers.push(D),ee}unsubscribeOne(I){void 0===this.observers||void 0===this.observers[I]||(delete this.observers[I],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(I){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,I)}sendOne(I,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[I])try{b(this.observers[I])}catch(M){typeof console<"u"&&console.error&&console.error(M)}})}close(I){this.finalized||(this.finalized=!0,void 0!==I&&(this.finalError=I),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ci(){}function Cn(T){return T&&T._delegate?T._delegate:T}},2582:(qr,Ut,q)=>{q.r(Ut),q.d(Ut,{DigitsModule:()=>Ow});var v=q(4755),te=q(3439),R=q(387);let X=(()=>{var n;class e{}return(n=e).OPERATOR_REV="\xab",n.OPERATOR_ADD="+",n.OPERATOR_SUB="-",n.OPERATOR_MUL="\xd7",n.OPERATOR_DIV="/",e})();class vt{constructor(e,t,i,r){this.id=e,this.selected=t,this.disabled=i,this.value=r}}class tt{constructor(){this.operands=[]}}class Fe{static evaluate(e,t,i){var r=Number.MIN_VALUE;switch(i){case X.OPERATOR_ADD:r=e+t;break;case X.OPERATOR_SUB:r=e>=t?e-t:Number.MIN_VALUE;break;case X.OPERATOR_DIV:r=e%t==0?e/t:Number.MIN_VALUE;break;case X.OPERATOR_MUL:r=e*t}return r}static cloneGameParameters(e){let t=new tt;return t.result=e.result,e.operands.forEach(i=>{let r=new vt(i.id,!1,!1,-1);Object.assign(r,i),t.operands.push(r)}),t}}class zt{constructor(){this.numbers=[]}generateNumber(e,t){let i=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(i)>=0;)i=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(i)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}}class ke{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){let e=this.generateNumber(0,4),t=X.OPERATOR_ADD;switch(e){case 0:t=X.OPERATOR_ADD;break;case 1:t=X.OPERATOR_SUB;break;case 2:t=X.OPERATOR_MUL;break;case 0:t=X.OPERATOR_DIV}return t}checkExecuteDivision(e,t){return e%t==0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let i=t;return e<t&&(i=t-1),this.operands.splice(e,1),i}calculateResult(e){let t=this.operands.length,i=0,r=0,s=this.generateNumber(3,5),a=Number.MIN_VALUE;for(;r<s&&e.length>1;){let d=this.choiceRandomOperation(),f=this.generateNumber(0,t-1);for(a===Number.MIN_VALUE&&(a=this.generateNumber(0,t-1));a===f;)f=this.generateNumber(0,t-1);switch(d){case X.OPERATOR_ADD:e[a]=Fe.evaluate(e[a],e[f],d),a=this.removeOperandByIndex(f,a),--t,++r;break;case X.OPERATOR_SUB:if(!this.checkExecuteSubstraction(e[a],e[f]))continue;e[a]=Fe.evaluate(e[a],e[f],d),a=this.removeOperandByIndex(f,a),--t,++r;break;case X.OPERATOR_MUL:e[a]=Fe.evaluate(e[a],e[f],d),a=this.removeOperandByIndex(f,a),--t,++r;break;case X.OPERATOR_DIV:if(!this.checkExecuteDivision(e[a],e[f]))continue;e[a]=Fe.evaluate(e[a],e[f],d),a=this.removeOperandByIndex(f,a),--t,++r}}return i=e[a],i}generateGameParameter(e){let t=new zt;switch(e){case 0:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break;case 1:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break;case 2:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 3:t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 4:t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25)}let i=t.getGeneratedNumbers();i=i.sort((g,y)=>g-y);let r=new Array(i[0],i[1],i[2],i[3],i[4],i[5]);this.operands=new Array(i[0],i[1],i[2],i[3],i[4],i[5]),t.clearGeneratedNumbers();let s=0,a=0;switch(e){case 0:s=30,a=100;break;case 1:s=50,a=150;break;case 2:s=100,a=200;break;case 3:s=300,a=400;break;case 4:s=400,a=550}let d=this.calculateResult(this.operands);for(;s>d||d>a;)this.operands=new Array(i[0],i[1],i[2],i[3],i[4],i[5]),d=this.calculateResult(this.operands);let f=new tt;f.result=d;let m=0;return r.forEach(g=>{let y=new vt(m,!1,!1,g);f.operands.push(y),++m}),f}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){let i=this.generateGameParameter(t);i.stageIndex=t,e.push(i)}return e=e.sort((t,i)=>t.result-i.result),e}}class B{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}}var l=q(2223);let ne=(()=>{var n;class e{constructor(i,r){this.document=i,this.platformId=r,this.documentIsAccessible=(0,v.NF)(this.platformId)}static getCookieRegExp(i){const r=i.replace(/([\[\]\{\}\(\)\|\=\;\+\?\,\.\*\^\$])/gi,"\\$1");return new RegExp("(?:^"+r+"|;\\s*"+r+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(i){try{return decodeURIComponent(i)}catch{return i}}check(i){return!!this.documentIsAccessible&&(i=encodeURIComponent(i),e.getCookieRegExp(i).test(this.document.cookie))}get(i){if(this.documentIsAccessible&&this.check(i)){i=encodeURIComponent(i);const s=e.getCookieRegExp(i).exec(this.document.cookie);return s[1]?e.safeDecodeURIComponent(s[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const i={},r=this.document;return r.cookie&&""!==r.cookie&&r.cookie.split(";").forEach(s=>{const[a,d]=s.split("=");i[e.safeDecodeURIComponent(a.replace(/^ /,""))]=e.safeDecodeURIComponent(d)}),i}set(i,r,s,a,d,f,m){if(!this.documentIsAccessible)return;if("number"==typeof s||s instanceof Date||a||d||f||m)return void this.set(i,r,{expires:s,path:a,domain:d,secure:f,sameSite:m||"Lax"});let g=encodeURIComponent(i)+"="+encodeURIComponent(r)+";";const y=s||{};y.expires&&(g+="number"==typeof y.expires?"expires="+new Date((new Date).getTime()+1e3*y.expires*60*60*24).toUTCString()+";":"expires="+y.expires.toUTCString()+";"),y.path&&(g+="path="+y.path+";"),y.domain&&(g+="domain="+y.domain+";"),!1===y.secure&&"None"===y.sameSite&&(y.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${i} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),y.secure&&(g+="secure;"),y.sameSite||(y.sameSite="Lax"),g+="sameSite="+y.sameSite+";",this.document.cookie=g}delete(i,r,s,a,d="Lax"){this.documentIsAccessible&&this.set(i,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:r,domain:s,secure:a,sameSite:d})}deleteAll(i,r,s,a="Lax"){if(!this.documentIsAccessible)return;const d=this.getAll();for(const f in d)d.hasOwnProperty(f)&&this.delete(f,i,r,s,a)}}return(n=e).\u0275fac=function(i){return new(i||n)(l.LFG(v.K0),l.LFG(l.Lbi))},n.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var ae=q(4004);class Pe{constructor(){this.stages=[]}}class Zt{constructor(){this.operands=[]}}class Ve{}const ge=new l.OlP("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var _e=q(7579);let Bt=(()=>{class n{constructor(t,i,r){this.ngZone=t,this.document=i,this.window=r,this.copySubject=new _e.x,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});const i=this.copyFromContent(t);return this.pushCopyResponse(i?{content:t,isSuccess:i}:{isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,i=!0){try{this.selectTarget(t);const r=this.copyText();return this.clearSelection(i?t:void 0,this.window),r&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){const t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,i=this.document.body){if(this.tempTextArea&&!i.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{i.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;const r=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),r}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,i){t&&t.focus(),i.getSelection()?.removeAllRanges()}createTempTextArea(t,i){const r="rtl"===t.documentElement.getAttribute("dir");let s;return s=t.createElement("textarea"),s.style.fontSize="12pt",s.style.border="0",s.style.padding="0",s.style.margin="0",s.style.position="absolute",s.style[r?"right":"left"]="-9999px",s.style.top=(i.pageYOffset||t.documentElement.scrollTop)+"px",s.setAttribute("readonly",""),s}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return n.\u0275fac=function(t){return new(t||n)(l.LFG(l.R0b),l.LFG(v.K0),l.LFG(ge,8))},n.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=l.oAB({type:n}),n.\u0275inj=l.cJS({imports:[v.ez]}),n})();var E=q(1180),cn=q(7212);(0,cn.registerVersion)("firebase","9.23.0","app");var F=q(4408),ct=q(7565);const oi=new class Nn extends ct.v{}(class nt extends F.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}});var vn=q(4986),co=q(8505),un=q(9468),In=q(5363);const ai=new l.GfV("ANGULARFIRE2_VERSION");class Me{constructor(){return((n,e)=>{const t=(0,cn.getApps)(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(a=>{i.includes(a)||i.push(a)})}),i})(Di)}}const Di="app-check";function wn(){}class Zn{constructor(e,t=oi){(0,E.Z)(this,"zone",void 0),(0,E.Z)(this,"delegate",void 0),this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){const r=this.zone;return this.delegate.schedule(function(a){r.runGuarded(()=>{e.apply(this,[a])})},t,i)}}class ln{constructor(e){(0,E.Z)(this,"zone",void 0),(0,E.Z)(this,"task",null),this.zone=e}call(e,t){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",wn,{},wn,wn)),t.pipe((0,co.b)({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Tn=(()=>{var n;class e{constructor(i){(0,E.Z)(this,"ngZone",void 0),(0,E.Z)(this,"outsideAngular",void 0),(0,E.Z)(this,"insideAngular",void 0),this.ngZone=i,this.outsideAngular=i.runOutsideAngular(()=>new Zn(Zone.current)),this.insideAngular=i.run(()=>new Zn(Zone.current,vn.z)),globalThis.\u0275AngularFireScheduler||=this}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.LFG(l.R0b))}),(0,E.Z)(e,"\u0275prov",l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})),e})();function Mt(n){return function Oi(n){return function(t){return(t=t.lift(new ln(n.ngZone))).pipe((0,un.R)(n.outsideAngular),(0,In.Q)(n.insideAngular))}}(function Rn(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}())(n)}var Ct=q(6101);Ct.Z.registerVersion("firebase","9.23.0","app-compat");const En=["ngOnDestroy"];class Pn{constructor(e){return e}}const xt=new l.OlP("angularfire2.app.options"),Bn=new l.OlP("angularfire2.app.name");function Mn(n,e,t){const r="object"==typeof t&&t||{};r.name=r.name||"string"==typeof t&&t||"[DEFAULT]";const a=Ct.Z.apps.filter(d=>d&&d.name===r.name)[0]||e.runOutsideAngular(()=>Ct.Z.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(a.options)){const d=!!module.hot;ci("error",`${a.name} Firebase App already initialized with different options${d?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Pn(a)}const ci=(n,...e)=>{(0,l.X6Q)()&&typeof console<"u"&&console[n](...e)},$r={provide:Pn,useFactory:Mn,deps:[xt,l.R0b,[new l.FiY,Bn]]};let bn=(()=>{var n;class e{static initializeApp(i,r){return{ngModule:e,providers:[{provide:xt,useValue:i},{provide:Bn,useValue:r}]}}constructor(i){Ct.Z.registerVersion("angularfire",ai.full,"core"),Ct.Z.registerVersion("angularfire",ai.full,"app-compat"),Ct.Z.registerVersion("angular",l.q4F.full,i.toString())}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.LFG(l.Lbi))}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({providers:[$r]})),e})();function Pi(n,e,t,i,r){const[,s,a]=globalThis.\u0275AngularfireInstanceCache.find(d=>d[0]===n)||[];if(s)return function hn(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(r,a)||(Hr("error",`${e} was already initialized on the ${t} Firebase App with different settings.${fr?" You may need to reload as Firebase is not HMR aware.":""}`),Hr("warn",{is:r,was:a})),s;{const d=i();return globalThis.\u0275AngularfireInstanceCache.push([n,d,r]),d}}const fr=typeof module<"u"&&!!module.hot,Hr=(n,...e)=>{(0,l.X6Q)()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[],q(8463);var Gn=q(9646),qn=q(9751),Wt=q(8996),Qt=q(6451),it=q(3900),Kr=q(6063);class Lt extends _e.x{constructor(e=1/0,t=1/0,i=Kr.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:a}=this;t||(i.push(e),!r&&i.push(s.now()+a)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let a=0;a<s.length&&!e.closed;a+=i?1:2)e.next(s[a]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const a=t.now();let d=0;for(let f=1;f<i.length&&i[f]<=a;f+=2)d=f;d&&i.splice(0,d+1)}}}var po=q(3099);function Cn(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,(0,po.B)({connector:()=>new Lt(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}var T=q(590),I=q(576);function b(n,e){return(0,I.m)(e)?(0,it.w)(()=>n,e):(0,it.w)(()=>n)}var M=q(9300);const ee=new l.OlP("angularfire2.auth.use-emulator"),ue=new l.OlP("angularfire2.auth.settings"),Ae=new l.OlP("angularfire2.auth.tenant-id"),St=new l.OlP("angularfire2.auth.langugage-code"),ht=new l.OlP("angularfire2.auth.use-device-language"),It=new l.OlP("angularfire.auth.persistence"),Ee=(n,e,t,i,r,s,a,d)=>Pi(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),i&&(f.tenantId=i),f.languageCode=r,s&&f.useDeviceLanguage(),a)for(const[m,g]of Object.entries(a))f.settings[m]=g;return d&&f.setPersistence(d),f},[t,i,r,s,a,d]);let Yt=(()=>{var n;class e{constructor(i,r,s,a,d,f,m,g,y,C,N,Z){(0,E.Z)(this,"authState",void 0),(0,E.Z)(this,"idToken",void 0),(0,E.Z)(this,"user",void 0),(0,E.Z)(this,"idTokenResult",void 0),(0,E.Z)(this,"credential",void 0);const $=new _e.x,W=(0,Gn.of)(void 0).pipe((0,In.Q)(d.outsideAngular),(0,it.w)(()=>a.runOutsideAngular(()=>Promise.resolve().then(q.bind(q,8463)))),(0,ae.U)(()=>Mn(i,a,r)),(0,ae.U)(oe=>Ee(oe,a,f,g,y,C,m,N)),Cn({bufferSize:1,refCount:!1}));if((0,v.PM)(s))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Gn.of)(null);else{W.pipe((0,T.P)()).subscribe();const oe=W.pipe((0,it.w)(fe=>fe.getRedirectResult().then(Se=>Se,()=>null)),Mt,Cn({bufferSize:1,refCount:!1})),ve=W.pipe((0,it.w)(fe=>new qn.y(Se=>({unsubscribe:a.runOutsideAngular(()=>fe.onAuthStateChanged(Ie=>Se.next(Ie),Ie=>Se.error(Ie),()=>Se.complete()))})))),de=W.pipe((0,it.w)(fe=>new qn.y(Se=>({unsubscribe:a.runOutsideAngular(()=>fe.onIdTokenChanged(Ie=>Se.next(Ie),Ie=>Se.error(Ie),()=>Se.complete()))}))));this.authState=oe.pipe(b(ve),(0,un.R)(d.outsideAngular),(0,In.Q)(d.insideAngular)),this.user=oe.pipe(b(de),(0,un.R)(d.outsideAngular),(0,In.Q)(d.insideAngular)),this.idToken=this.user.pipe((0,it.w)(fe=>fe?(0,Wt.D)(fe.getIdToken()):(0,Gn.of)(null))),this.idTokenResult=this.user.pipe((0,it.w)(fe=>fe?(0,Wt.D)(fe.getIdTokenResult()):(0,Gn.of)(null))),this.credential=(0,Qt.T)(oe,$,this.authState.pipe((0,M.h)(fe=>!fe))).pipe((0,ae.U)(fe=>fe?.user?fe:null),(0,un.R)(d.outsideAngular),(0,In.Q)(d.insideAngular))}return((n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(En.indexOf(s)>-1)return()=>{};const a=e.toPromise().then(d=>{const f=d?.[s];return"function"==typeof f?f.bind(d):f?.then?f.then(m=>t.run(()=>m)):t.run(()=>f)});return new Proxy(()=>{},{get:(d,f)=>a[f],apply:(d,f,m)=>a.then(g=>{const y=g?.(...m);return i?.spy?.apply&&i.spy.apply(s,m,y),y})})})}))(this,W,a,{spy:{apply:(oe,ve,de)=>{(oe.startsWith("signIn")||oe.startsWith("createUser"))&&de.then(fe=>$.next(fe))}}})}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.LFG(xt),l.LFG(Bn,8),l.LFG(l.Lbi),l.LFG(l.R0b),l.LFG(Tn),l.LFG(ee,8),l.LFG(ue,8),l.LFG(Ae,8),l.LFG(St,8),l.LFG(ht,8),l.LFG(It,8),l.LFG(Me,8))}),(0,E.Z)(e,"\u0275prov",l.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})),e})();var jn=q(8675),$a=q(4482),P=q(5403);function k(){return(0,$a.e)((n,e)=>{let t,i=!1;n.subscribe((0,P.x)(e,r=>{const s=t;t=r,i&&e.next([s,r]),i=!0}))})}var j,z=q(5026),se=q(1884),S=q(5861),me=q(4859),Te=q(1877),he=q(2090),dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ut={},Ha=Ha||{},le=dt||self;function mo(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function pr(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Wr="closure_uid_"+(1e9*Math.random()>>>0),Mh=0;function Lh(n,e,t){return n.call.apply(n.bind,arguments)}function We(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(e,r)}}return function(){return n.apply(e,arguments)}}function At(n,e,t){return(At=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Lh:We).apply(null,arguments)}function go(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function wt(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(i,r,s){for(var a=Array(arguments.length-2),d=2;d<arguments.length;d++)a[d-2]=arguments[d];return e.prototype[r].apply(i,a)}}function $n(){this.s=this.s,this.o=this.o}$n.prototype.s=!1,$n.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function ui(n){Object.prototype.hasOwnProperty.call(n,Wr)&&n[Wr]||(n[Wr]=++Mh)}(this)},$n.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Mu=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function _o(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function Lu(n,e){for(let t=1;t<arguments.length;t++){const i=arguments[t];if(mo(i)){const r=n.length||0,s=i.length||0;n.length=r+s;for(let a=0;a<s;a++)n[r+a]=i[a]}else n.push(i)}}function rt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var Fu=function(){if(!le.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{le.addEventListener("test",()=>{},e),le.removeEventListener("test",()=>{},e)}catch{}return n}();function Li(n){return/^[\s\xa0]*$/.test(n)}function Qr(){var n=le.navigator;return n&&(n=n.userAgent)?n:""}function dn(n){return-1!=Qr().indexOf(n)}function Ka(n){return Ka[" "](n),n}Ka[" "]=function(){};var Xr,n,Qa=dn("Opera"),li=dn("Trident")||dn("MSIE"),Yr=dn("Edge"),Jr=Yr||li,Vu=dn("Gecko")&&!(-1!=Qr().toLowerCase().indexOf("webkit")&&!dn("Edge"))&&!(dn("Trident")||dn("MSIE"))&&!dn("Edge"),Ya=-1!=Qr().toLowerCase().indexOf("webkit")&&!dn("Edge");function yo(){var n=le.document;return n?n.documentMode:void 0}e:{var es="",ts=(n=Qr(),Vu?/rv:([^\);]+)(\)|;)/.exec(n):Yr?/Edge\/([\d\.]+)/.exec(n):li?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Ya?/WebKit\/(\S+)/.exec(n):Qa?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(ts&&(es=ts?ts[1]:""),li){var Ja=yo();if(null!=Ja&&Ja>parseFloat(es)){Xr=String(Ja);break e}}Xr=es}var Xa=le.document&&li&&(yo()||parseInt(Xr,10))||void 0;function is(n,e){if(rt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Vu){e:{try{Ka(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ec[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&is.$.h.call(this)}}wt(is,rt);var ec={2:"touch",3:"pen",4:"mouse"};is.prototype.h=function(){is.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Hn="closure_listenable_"+(1e6*Math.random()|0),Kn=0;function tc(n,e,t,i,r){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.la=r,this.key=++Kn,this.fa=this.ia=!1}function vo(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function fn(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function Io(n){const e={};for(const t in n)e[t]=n[t];return e}const zu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wo(n,e){let t,i;for(let r=1;r<arguments.length;r++){for(t in i=arguments[r],i)n[t]=i[t];for(let s=0;s<zu.length;s++)t=zu[s],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function To(n){this.src=n,this.g={},this.h=0}function rs(n,e){var t=e.type;if(t in n.g){var s,i=n.g[t],r=Mu(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(vo(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function nc(n,e,t,i){for(var r=0;r<n.length;++r){var s=n[r];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==i)return r}return-1}To.prototype.add=function(n,e,t,i,r){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var a=nc(n,e,i,r);return-1<a?(e=n[a],t||(e.ia=!1)):((e=new tc(e,this.src,s,!!i,r)).ia=t,n.push(e)),e};var ic="closure_lm_"+(1e6*Math.random()|0),ss={};function hi(n,e,t,i,r){if(i&&i.once)return mr(n,e,t,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)hi(n,e[s],t,i,r);return null}return t=bo(t),n&&n[Hn]?n.O(e,t,pr(i)?!!i.capture:!!i,r):Zu(n,e,t,!1,i,r)}function Zu(n,e,t,i,r,s){if(!e)throw Error("Invalid event type");var a=pr(r)?!!r.capture:!!r,d=di(n);if(d||(n[ic]=d=new To(n)),(t=d.add(e,t,i,a,s)).proxy)return t;if(i=function Vh(){const e=gr;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)Fu||(r=a),void 0===r&&(r=!1),n.addEventListener(e.toString(),i,r);else if(n.attachEvent)n.attachEvent(Ln(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function mr(n,e,t,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)mr(n,e[s],t,i,r);return null}return t=bo(t),n&&n[Hn]?n.P(e,t,pr(i)?!!i.capture:!!i,r):Zu(n,e,t,!0,i,r)}function Uh(n,e,t,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Uh(n,e[s],t,i,r);else i=pr(i)?!!i.capture:!!i,t=bo(t),n&&n[Hn]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=nc(s=n.g[e],t,i,r))&&(vo(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=di(n))&&(e=n.g[e.toString()],n=-1,e&&(n=nc(e,t,i,r)),(t=-1<n?e[n]:null)&&os(t))}function os(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Hn])rs(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(Ln(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=di(e))?(rs(t,n),0==t.h&&(t.src=null,e[ic]=null)):vo(n)}}}function Ln(n){return n in ss?ss[n]:ss[n]="on"+n}function gr(n,e){if(n.fa)n=!0;else{e=new is(e,this);var t=n.listener,i=n.la||n.src;n.ia&&os(n),n=t.call(i,e)}return n}function di(n){return(n=n[ic])instanceof To?n:null}var Eo="__closure_events_fn_"+(1e9*Math.random()>>>0);function bo(n){return"function"==typeof n?n:(n[Eo]||(n[Eo]=function(e){return n.handleEvent(e)}),n[Eo])}function ft(){$n.call(this),this.i=new To(this),this.S=this,this.J=null}function kt(n,e){var t,i=n.J;if(i)for(t=[];i;i=i.J)t.push(i);if(n=n.S,i=e.type||e,"string"==typeof e)e=new rt(e,n);else if(e instanceof rt)e.target=e.target||n;else{var r=e;wo(e=new rt(i,n),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];r=Wn(a,i,!0,e)&&r}if(r=Wn(a=e.g=n,i,!0,e)&&r,r=Wn(a,i,!1,e)&&r,t)for(s=0;s<t.length;s++)r=Wn(a=e.g=t[s],i,!1,e)&&r}function Wn(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var d=a.listener,f=a.la||a.src;a.ia&&rs(n.i,a),r=!1!==d.call(f,i)&&r}}return r&&!i.defaultPrevented}wt(ft,$n),ft.prototype[Hn]=!0,ft.prototype.removeEventListener=function(n,e,t,i){Uh(this,n,e,t,i)},ft.prototype.N=function(){if(ft.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)vo(t[i]);delete n.g[e],n.h--}}this.J=null},ft.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},ft.prototype.P=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var rc=le.JSON.stringify;function Bu(){var n=Ao;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var So=new class Co{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new pn,n=>n.reset());class pn{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Gu(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function zh(n){le.setTimeout(()=>{throw n},0)}let Fi,fi=!1,Ao=new class xo{constructor(){this.h=this.g=null}add(e,t){const i=So.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}},sc=()=>{const n=le.Promise.resolve(void 0);Fi=()=>{n.then(Zh)}};var Zh=()=>{for(var n;n=Bu();){try{n.h.call(n.g)}catch(t){zh(t)}var e=So;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}fi=!1};function _r(n,e){ft.call(this),this.h=n||1,this.g=e||le,this.j=At(this.qb,this),this.l=Date.now()}function as(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function cs(n,e,t){if("function"==typeof n)t&&(n=At(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=At(n.handleEvent,n)}return 2147483647<Number(e)?-1:le.setTimeout(n,e||0)}function us(n){n.g=cs(()=>{n.g=null,n.i&&(n.i=!1,us(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}wt(_r,ft),(j=_r.prototype).ga=!1,j.T=null,j.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),kt(this,"tick"),this.ga&&(as(this),this.start()))}},j.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},j.N=function(){_r.$.N.call(this),as(this),delete this.g};class oc extends $n{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:us(this)}N(){super.N(),this.g&&(le.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yr(n){$n.call(this),this.h=n,this.g={}}wt(yr,$n);var ko=[];function ac(n,e,t,i){Array.isArray(t)||(t&&(ko[0]=t.toString()),t=ko);for(var r=0;r<t.length;r++){var s=hi(e,t[r],i||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Do(n){fn(n.g,function(e,t){this.g.hasOwnProperty(t)&&os(e)},n),n.g={}}function Vi(){this.g=!0}function pi(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function uc(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<r.length;a++)r[a]=""}}}return rc(t)}catch{return e}}(n,t)+(i?" "+i:"")})}yr.prototype.N=function(){yr.$.N.call(this),Do(this)},yr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vi.prototype.Ea=function(){this.g=!1},Vi.prototype.info=function(){};var Ui={},Oo=null;function No(){return Oo=Oo||new ft}function Ro(n){rt.call(this,Ui.Ta,n)}function Qn(n){const e=No();kt(e,new Ro(e))}function Po(n,e){rt.call(this,Ui.STAT_EVENT,n),this.stat=e}function Dt(n){const e=No();kt(e,new Po(e,n))}function zi(n,e){rt.call(this,Ui.Ua,n),this.size=e}function ls(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return le.setTimeout(function(){n()},e)}Ui.Ta="serverreachability",wt(Ro,rt),Ui.STAT_EVENT="statevent",wt(Po,rt),Ui.Ua="timingevent",wt(zi,rt);var vr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},$u={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function hs(){}function Mo(){}hs.prototype.h=null;var fs,Ir={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ds(){rt.call(this,"d")}function lc(){rt.call(this,"c")}function Lo(){}function Zi(n,e,t,i){this.l=n,this.j=e,this.m=t,this.W=i||1,this.U=new yr(this),this.P=Bh,this.V=new _r(n=Jr?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Ku}function Ku(){this.i=null,this.g="",this.h=!1}wt(ds,rt),wt(lc,rt),wt(Lo,hs),Lo.prototype.g=function(){return new XMLHttpRequest},Lo.prototype.i=function(){return{}},fs=new Lo;var Bh=45e3,ps={},Fo={};function hc(n,e,t){n.L=1,n.v=Bo(xn(e)),n.s=t,n.S=!0,Vo(n,null)}function Vo(n,e){n.G=Date.now(),Bi(n),n.A=xn(n.v);var t=n.A,i=n.W;Array.isArray(i)||(i=[String(i)]),qo(t.i,"t",i),n.C=0,t=n.l.J,n.h=new Ku,n.g=hl(n.l,t?e:null,!n.s),0<n.O&&(n.M=new oc(At(n.Pa,n,n.g),n.O)),ac(n.U,n.g,"readystatechange",n.nb),e=n.I?Io(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Qn(),function cc(n,e,t,i,r,s){n.info(function(){if(n.g)if(s)for(var a="",d=s.split("&"),f=0;f<d.length;f++){var m=d[f].split("=");if(1<m.length){var g=m[0];m=m[1];var y=g.split("_");a=2<=y.length&&"type"==y[1]?a+(g+"=")+m+"&":a+(g+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+t+"\n"+a})}(n.j,n.u,n.A,n.m,n.W,n.s)}function Wu(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function Uo(n,e,t){let r,i=!0;for(;!n.J&&n.C<t.length;){if(r=Gh(n,t),r==Fo){4==e&&(n.o=4,Dt(14),i=!1),pi(n.j,n.m,null,"[Incomplete Response]");break}if(r==ps){n.o=4,Dt(15),pi(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}pi(n.j,n.m,r,null),dc(n,r)}Wu(n)&&r!=Fo&&r!=ps&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Dt(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Tc(e),e.M=!0,Dt(11))):(pi(n.j,n.m,t,"[Invalid Chunked Response]"),Yn(n),ms(n))}function Gh(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?Fo:(t=Number(e.substring(t,i)),isNaN(t)?ps:(i+=1)+t>e.length?Fo:(e=e.slice(i,i+t),n.C=i+t,e))}function Bi(n){n.Y=Date.now()+n.P,Qu(n,n.P)}function Qu(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ls(At(n.lb,n),e)}function wr(n){n.B&&(le.clearTimeout(n.B),n.B=null)}function ms(n){0==n.l.H||n.J||Ss(n.l,n)}function Yn(n){wr(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,as(n.V),Do(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function dc(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||gc(t.i,n)))if(!n.K&&gc(t.i,n)&&3==t.H){try{var i=t.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Xo(t),Qo(t)}wc(t),Dt(18)}}else t.Fa=r[1],0<t.Fa-t.V&&37500>r[2]&&t.G&&0==t.A&&!t.v&&(t.v=ls(At(t.ib,t),6e3));if(1>=Xu(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Hi(t,11)}else if((n.K||t.g==n)&&Xo(t),!Li(e))for(r=t.Ja.g.parse(e),e=0;e<r.length;e++){let m=r[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const g=m[3];null!=g&&(t.ra=g,t.l.info("VER="+t.ra));const y=m[4];null!=y&&(t.Ga=y,t.l.info("SVER="+t.Ga));const C=m[5];null!=C&&"number"==typeof C&&0<C&&(t.L=i=1.5*C,t.l.info("backChannelRequestTimeoutMs_="+i)),i=t;const N=n.g;if(N){const Z=N.g?N.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Z){var s=i.i;s.g||-1==Z.indexOf("spdy")&&-1==Z.indexOf("quic")&&-1==Z.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ys(s,s.h),s.h=null))}if(i.F){const $=N.g?N.g.getResponseHeader("X-HTTP-Session-Id"):null;$&&(i.Da=$,Be(i.I,i.F,$))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var a=n;if((i=t).wa=ea(i,i.J?i.pa:null,i.Y),a.K){jo(i.i,a);var d=a,f=i.L;f&&d.setTimeout(f),d.B&&(wr(d),Bi(d)),i.g=a}else al(i);0<t.j.length&&xs(t)}else"stop"!=m[0]&&"close"!=m[0]||Hi(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?Hi(t,7):Cs(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}Qn()}catch{}}function zo(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(mo(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function qh(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(mo(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const i in n)e[t++]=i;return e}}}(n),i=function fc(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(mo(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],t&&t[s],n)}(j=Zi.prototype).setTimeout=function(n){this.P=n},j.nb=function(n){n=n.target;const e=this.M;e&&3==tn(n)?e.l():this.Pa(n)},j.Pa=function(n){try{if(n==this.g)e:{const g=tn(this.g);var e=this.g.Ia();if(this.g.da(),!(3>g)&&(3!=g||Jr||this.g&&(this.h.h||this.g.ja()||yc(this.g)))){this.J||4!=g||7==e||Qn(),wr(this);var t=this.g.da();this.ca=t;t:if(Wu(this)){var i=yc(this.g);n="";var r=i.length,s=4==tn(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Yn(this),ms(this);var a="";break t}this.h.i=new le.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=n,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=200==t,function qu(n,e,t,i,r,s,a){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+a})}(this.j,this.u,this.A,this.m,this.W,g,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var d,f=this.g;if((d=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Li(d)){var m=d;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,Dt(12),Yn(this),ms(this);break e}pi(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dc(this,t)}this.S?(Uo(this,g,a),Jr&&this.i&&3==g&&(ac(this.U,this.V,"tick",this.mb),this.V.start())):(pi(this.j,this.m,a,null),dc(this,a)),4==g&&Yn(this),this.i&&!this.J&&(4==g?Ss(this.l,this):(this.i=!1,Bi(this)))}else(function Es(n){const e={};n=(n.g&&2<=tn(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<n.length;i++){if(Li(n[i]))continue;var t=Gu(n[i]);const r=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[r]||[];e[r]=s,s.push(t)}!function Fh(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(i){return i.join(", ")})})(this.g),400==t&&0<a.indexOf("Unknown SID")?(this.o=3,Dt(12)):(this.o=0,Dt(13)),Yn(this),ms(this)}}}catch{}},j.mb=function(){if(this.g){var n=tn(this.g),e=this.g.ja();this.C<e.length&&(wr(this),Uo(this,n,e),this.i&&4!=n&&Bi(this))}},j.cancel=function(){this.J=!0,Yn(this)},j.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function ju(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Qn(),Dt(17)),Yn(this),this.o=2,ms(this)):Qu(this,this.Y-n)};var Yu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mi(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof mi){this.h=n.h,Zo(this,n.j),this.s=n.s,this.g=n.g,Jn(this,n.m),this.l=n.l;var e=n.i,t=new Go;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),pc(this,t),this.o=n.o}else n&&(e=String(n).match(Yu))?(this.h=!1,Zo(this,e[1]||"",!0),this.s=gs(e[2]||""),this.g=gs(e[3]||"",!0),Jn(this,e[4]),this.l=gs(e[5]||"",!0),pc(this,e[6]||"",!0),this.o=gs(e[7]||"")):(this.h=!1,this.i=new Go(null,this.h))}function xn(n){return new mi(n)}function Zo(n,e,t){n.j=t?gs(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Jn(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function pc(n,e,t){e instanceof Go?(n.i=e,function mc(n,e){e&&!n.j&&(Gi(n),n.i=null,n.g.forEach(function(t,i){var r=i.toLowerCase();i!=r&&(Qh(this,i),qo(this,r,t))},n)),n.j=e}(n.i,n.h)):(t||(e=_s(e,Wh)),n.i=new Go(e,n.h))}function Be(n,e,t){n.i.set(e,t)}function Bo(n){return Be(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function gs(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function _s(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,$h),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function $h(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}mi.prototype.toString=function(){var n=[],e=this.j;e&&n.push(_s(e,Hh,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(_s(e,Hh,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(_s(t,"/"==t.charAt(0)?Kh:Gp,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",_s(t,qp)),n.join("")};var Hh=/[#\/\?@]/g,Gp=/[#\?:]/g,Kh=/[#\?]/g,Wh=/[#\?@]/g,qp=/#/g;function Go(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Gi(n){n.g||(n.g=new Map,n.h=0,n.i&&function jh(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),r=null;if(0<=i){var s=n[t].substring(0,i);r=n[t].substring(i+1)}else s=n[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Qh(n,e){Gi(n),e=mn(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function Yh(n,e){return Gi(n),e=mn(n,e),n.g.has(e)}function qo(n,e,t){Qh(n,e),0<t.length&&(n.i=null,n.g.set(mn(n,e),_o(t)),n.h+=t.length)}function mn(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Ju(n){this.l=n||Xh,n=le.PerformanceNavigationTiming?0<(n=le.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(le.g&&le.g.Ka&&le.g.Ka()&&le.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(j=Go.prototype).add=function(n,e){Gi(this),this.i=null,n=mn(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},j.forEach=function(n,e){Gi(this),this.g.forEach(function(t,i){t.forEach(function(r){n.call(e,r,i,this)},this)},this)},j.ta=function(){Gi(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let i=0;i<e.length;i++){const r=n[i];for(let s=0;s<r.length;s++)t.push(e[i])}return t},j.Z=function(n){Gi(this);let e=[];if("string"==typeof n)Yh(this,n)&&(e=e.concat(this.g.get(mn(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},j.set=function(n,e){return Gi(this),this.i=null,Yh(this,n=mn(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},j.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},j.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var i=e[t];const s=encodeURIComponent(String(i)),a=this.Z(i);for(i=0;i<a.length;i++){var r=s;""!==a[i]&&(r+="="+encodeURIComponent(String(a[i]))),n.push(r)}}return this.i=n.join("&")};var Xh=10;function ed(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Xu(n){return n.h?1:n.g?n.g.size:0}function gc(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function ys(n,e){n.g?n.g.add(e):n.h=e}function jo(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function el(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return _o(n.i)}Ju.prototype.cancel=function(){if(this.i=el(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var $o=class{stringify(n){return le.JSON.stringify(n,void 0)}parse(n){return le.JSON.parse(n,void 0)}};function tl(){this.g=new $o}function td(n,e,t){const i=t||"";try{zo(n,function(r,s){let a=r;pr(r)&&(a=rc(r)),e.push(i+s+"="+encodeURIComponent(a))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function Ho(n,e,t,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function Ko(n){this.l=n.fc||null,this.j=n.ob||!1}function qi(n,e){ft.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=nl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wt(Ko,hs),Ko.prototype.g=function(){return new qi(this.l,this.j)},Ko.prototype.i=function(n){return function(){return n}}({}),wt(qi,ft);var nl=0;function Xn(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function vs(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Is(n)}function Is(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(j=qi.prototype).open=function(n,e){if(this.readyState!=nl)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Is(this)},j.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||le).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},j.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,vs(this)),this.readyState=nl},j.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Is(this)),this.g&&(this.readyState=3,Is(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof le.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Xn(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},j.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?vs(this):Is(this),3==this.readyState&&Xn(this)}},j.Za=function(n){this.g&&(this.response=this.responseText=n,vs(this))},j.Ya=function(n){this.g&&(this.response=n,vs(this))},j.ka=function(){this.g&&vs(this)},j.setRequestHeader=function(n,e){this.v.append(n,e)},j.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},j.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(qi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var ws=le.JSON.parse;function Qe(n){ft.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=st,this.L=this.M=!1}wt(Qe,ft);var st="",id=/^https?$/i,_c=["POST","PUT"];function Wo(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,il(n),Ts(n)}function il(n){n.F||(n.F=!0,kt(n,"complete"),kt(n,"error"))}function rl(n){if(n.h&&typeof Ha<"u"&&(!n.C[1]||4!=tn(n)||2!=n.da()))if(n.v&&4==tn(n))cs(n.La,0,n);else if(kt(n,"readystatechange"),4==tn(n)){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===a){var r=String(n.I).match(Yu)[1]||null;!r&&le.self&&le.self.location&&(r=le.self.location.protocol.slice(0,-1)),i=!id.test(r?r.toLowerCase():"")}t=i}if(t)kt(n,"complete"),kt(n,"success");else{n.m=6;try{var s=2<tn(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",il(n)}}finally{Ts(n)}}}function Ts(n,e){if(n.g){sl(n);const t=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||kt(n,"ready");try{t.onreadystatechange=i}catch{}}}function sl(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(le.clearTimeout(n.A),n.A=null)}function tn(n){return n.g?n.g.readyState:0}function yc(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case st:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function bs(n){let e="";return fn(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function vc(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=bs(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Be(n,e,t))}function ji(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Ic(n){this.Ga=0,this.j=[],this.l=new Vi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ji("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ji("baseRetryDelayMs",5e3,n),this.hb=ji("retryDelaySeedMs",1e4,n),this.eb=ji("forwardChannelMaxRetries",2,n),this.xa=ji("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Ju(n&&n.concurrentRequestLimit),this.Ja=new tl,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Cs(n){if(Yo(n),3==n.H){var e=n.W++,t=xn(n.I);if(Be(t,"SID",n.K),Be(t,"RID",e),Be(t,"TYPE","terminate"),Jo(n,t),(e=new Zi(n,n.l,e)).L=2,e.v=Bo(xn(t)),t=!1,le.navigator&&le.navigator.sendBeacon)try{t=le.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&le.Image&&((new Image).src=e.v,t=!0),t||(e.g=hl(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Bi(e)}ll(n)}function Qo(n){n.g&&(Tc(n),n.g.cancel(),n.g=null)}function Yo(n){Qo(n),n.u&&(le.clearTimeout(n.u),n.u=null),Xo(n),n.i.cancel(),n.m&&("number"==typeof n.m&&le.clearTimeout(n.m),n.m=null)}function xs(n){if(!ed(n.i)&&!n.m){n.m=!0;var e=n.Na;Fi||sc(),fi||(Fi(),fi=!0),Ao.add(e,n),n.C=0}}function ol(n,e){var t;t=e?e.m:n.W++;const i=xn(n.I);Be(i,"SID",n.K),Be(i,"RID",t),Be(i,"AID",n.V),Jo(n,i),n.o&&n.s&&vc(i,n.o,n.s),t=new Zi(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=$i(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),ys(n.i,t),hc(t,i,e)}function Jo(n,e){n.na&&fn(n.na,function(t,i){Be(e,i,t)}),n.h&&zo({},function(t,i){Be(e,i,t)})}function $i(n,e,t){t=Math.min(n.j.length,t);var i=n.h?At(n.h.Va,n.h,n):null;e:{var r=n.j;let s=-1;for(;;){const a=["count="+t];-1==s?0<t?(s=r[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let d=!0;for(let f=0;f<t;f++){let m=r[f].g;const g=r[f].map;if(m-=s,0>m)s=Math.max(0,r[f].g-100),d=!1;else try{td(g,a,"req"+m+"_")}catch{i&&i(g)}}if(d){i=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,i}function al(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Fi||sc(),fi||(Fi(),fi=!0),Ao.add(e,n),n.A=0}}function wc(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=ls(At(n.Ma,n),ul(n,n.A)),n.A++,0))}function Tc(n){null!=n.B&&(le.clearTimeout(n.B),n.B=null)}function cl(n){n.g=new Zi(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=xn(n.wa);Be(e,"RID","rpc"),Be(e,"SID",n.K),Be(e,"AID",n.V),Be(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Be(e,"TO",n.qa),Be(e,"TYPE","xmlhttp"),Jo(n,e),n.o&&n.s&&vc(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=Bo(xn(e)),t.s=null,t.S=!0,Vo(t,n)}function Xo(n){null!=n.v&&(le.clearTimeout(n.v),n.v=null)}function Ss(n,e){var t=null;if(n.g==e){Xo(n),Tc(n),n.g=null;var i=2}else{if(!gc(n.i,e))return;t=e.F,jo(n.i,e),i=1}if(0!=n.H)if(e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.G;var r=n.C;kt(i=No(),new zi(i,t)),xs(n)}else al(n);else if(3==(r=e.o)||0==r&&0<e.ca||!(1==i&&function sd(n,e){return!(Xu(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=ls(At(n.Na,n,e),ul(n,n.C)),n.C++,0)))}(n,e)||2==i&&wc(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),r){case 1:Hi(n,5);break;case 4:Hi(n,10);break;case 3:Hi(n,6);break;default:Hi(n,2)}}function ul(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Hi(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var i=At(n.pb,n);t||(t=new mi("//www.google.com/images/cleardot.gif"),le.location&&"http"==le.location.protocol||Zo(t,"https"),Bo(t)),function nd(n,e){const t=new Vi;if(le.Image){const i=new Image;i.onload=go(Ho,t,i,"TestLoadImage: loaded",!0,e),i.onerror=go(Ho,t,i,"TestLoadImage: error",!1,e),i.onabort=go(Ho,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=go(Ho,t,i,"TestLoadImage: timeout",!1,e),le.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Dt(2);n.H=0,n.h&&n.h.za(e),ll(n),Yo(n)}function ll(n){if(n.H=0,n.ma=[],n.h){const e=el(n.i);(0!=e.length||0!=n.j.length)&&(Lu(n.ma,e),Lu(n.ma,n.j),n.i.i.length=0,_o(n.j),n.j.length=0),n.h.ya()}}function ea(n,e,t){var i=t instanceof mi?xn(t):new mi(t);if(""!=i.g)e&&(i.g=e+"."+i.g),Jn(i,i.m);else{var r=le.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new mi(null);i&&Zo(s,i),e&&(s.g=e),r&&Jn(s,r),t&&(s.l=t),i=s}return e=n.Da,(t=n.F)&&e&&Be(i,t,e),Be(i,"VER",n.ra),Jo(n,i),i}function hl(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Qe(t&&n.Ha&&!n.va?new Ko({ob:!0}):n.va)).Oa(n.J),e}function dl(){}function ta(){if(li&&!(10<=Number(Xa)))throw Error("Environmental error: no available transport.")}function nn(n,e){ft.call(this),this.g=new Ic(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Li(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Li(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Tr(this)}function fl(n){ds.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Ec(){lc.call(this),this.status=1}function Tr(n){this.g=n}function Sn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function As(n,e,t){t||(t=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(r=0;16>r;++r)i[r]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],a=(e=n.g[0])+(s^(t=n.g[1])&((r=n.g[2])^s))+i[0]+3614090360&4294967295;a=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=(t=(r=(s=(e=t+(a<<7&4294967295|a>>>25))+((a=s+(r^e&(t^r))+i[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=r+(t^s&(e^t))+i[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(r^e&(t^r))+i[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=r+(t^s&(e^t))+i[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(r^e&(t^r))+i[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=r+(t^s&(e^t))+i[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(r^e&(t^r))+i[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=r+(t^s&(e^t))+i[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(r^s&(t^r))+i[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^r&(e^t))+i[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=r+(e^t&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(r^s&(t^r))+i[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^r&(e^t))+i[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=r+(e^t&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(r^s&(t^r))+i[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^r&(e^t))+i[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=r+(e^t&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(r^s&(t^r))+i[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^r&(e^t))+i[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=r+(e^t&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(t^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^r)+i[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=r+(s^e^t)+i[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=t+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^r)+i[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=r+(s^e^t)+i[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=t+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^r^s)+i[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^r)+i[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=r+(s^e^t)+i[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=t+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^r)+i[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=r+(s^e^t)+i[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=t+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(r^(t|~s))+i[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=r+(e^(s|~t))+i[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(r^(t|~s))+i[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=r+(e^(s|~t))+i[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(r^(t|~s))+i[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=r+(e^(s|~t))+i[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(e=t+((a=e+(r^(t|~s))+i[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((r=s+((a=r+(e^(s|~t))+i[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(r+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+s&4294967295}function Ne(n,e){this.h=e;for(var t=[],i=!0,r=n.length-1;0<=r;r--){var s=0|n[r];i&&s==e||(t[r]=s,i=!1)}this.g=t}(j=Qe.prototype).Oa=function(n){this.M=n},j.ha=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():fs.g(),this.C=function Hu(n){return n.h||(n.h=n.i())}(this.u?this.u:fs),this.g.onreadystatechange=At(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void Wo(this,s)}if(n=t||"",t=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)t.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const s of i.keys())t.set(s,i.get(s))}i=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),r=le.FormData&&n instanceof le.FormData,!(0<=Mu(_c,e))||i||r||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{sl(this),0<this.B&&((this.L=function rd(n){return li&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=At(this.ua,this)):this.A=cs(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Wo(this,s)}},j.ua=function(){typeof Ha<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,kt(this,"timeout"),this.abort(8))},j.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,kt(this,"complete"),kt(this,"abort"),Ts(this))},j.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ts(this,!0)),Qe.$.N.call(this)},j.La=function(){this.s||(this.G||this.v||this.l?rl(this):this.kb())},j.kb=function(){rl(this)},j.isActive=function(){return!!this.g},j.da=function(){try{return 2<tn(this)?this.g.status:-1}catch{return-1}},j.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},j.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),ws(e)}},j.Ia=function(){return this.m},j.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(j=Ic.prototype).ra=8,j.H=1,j.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new Zi(this,this.l,n);let s=this.s;if(this.U&&(s?(s=Io(s),wo(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var i=this.j[t];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=$i(this,r,e),Be(t=xn(this.I),"RID",n),Be(t,"CVER",22),this.F&&Be(t,"X-HTTP-Session-Id",this.F),Jo(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(bs(s)))+"&"+e:this.o&&vc(t,this.o,s)),ys(this.i,r),this.bb&&Be(t,"TYPE","init"),this.P?(Be(t,"$req",e),Be(t,"SID","null"),r.aa=!0,hc(r,t,null)):hc(r,t,e),this.H=2}}else 3==this.H&&(n?ol(this,n):0==this.j.length||ed(this.i)||ol(this))},j.Ma=function(){if(this.u=null,cl(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=ls(At(this.jb,this),n)}},j.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dt(10),Qo(this),cl(this))},j.ib=function(){null!=this.v&&(this.v=null,Qo(this),wc(this),Dt(19))},j.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Dt(2)):(this.l.info("Failed to ping google.com"),Dt(1))},j.isActive=function(){return!!this.h&&this.h.isActive(this)},(j=dl.prototype).Ba=function(){},j.Aa=function(){},j.za=function(){},j.ya=function(){},j.isActive=function(){return!0},j.Va=function(){},ta.prototype.g=function(n,e){return new nn(n,e)},wt(nn,ft),nn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Dt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=ea(n,null,n.Y),xs(n)},nn.prototype.close=function(){Cs(this.g)},nn.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=rc(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&xs(e)},nn.prototype.N=function(){this.g.h=null,delete this.j,Cs(this.g),delete this.g,nn.$.N.call(this)},wt(fl,ds),wt(Ec,lc),wt(Tr,dl),Tr.prototype.Ba=function(){kt(this.g,"a")},Tr.prototype.Aa=function(n){kt(this.g,new fl(n))},Tr.prototype.za=function(n){kt(this.g,new Ec)},Tr.prototype.ya=function(){kt(this.g,"b")},wt(Sn,function od(){this.blockSize=-1}),Sn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Sn.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=t;)As(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(i[r++]=n.charCodeAt(s++),r==this.blockSize){As(this,i),r=0;break}}else for(;s<e;)if(i[r++]=n[s++],r==this.blockSize){As(this,i),r=0;break}}this.h=r,this.i+=e},Sn.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var i=0;32>i;i+=8)n[t++]=this.g[e]>>>i&255;return n};var bc={};function Cc(n){return-128<=n&&128>n?function Wa(n,e){var t=bc;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new Ne([0|e],0>e?-1:0)}):new Ne([0|n],0>n?-1:0)}function gn(n){if(isNaN(n)||!isFinite(n))return ei;if(0>n)return qe(gn(-n));for(var e=[],t=1,i=0;n>=t;i++)e[i]=n/t|0,t*=ks;return new Ne(e,0)}var ks=4294967296,ei=Cc(0),Ds=Cc(1),ml=Cc(16777216);function An(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Ft(n){return-1==n.h}function qe(n){for(var e=n.g.length,t=[],i=0;i<e;i++)t[i]=~n.g[i];return new Ne(t,~n.h).add(Ds)}function Er(n,e){return n.add(qe(e))}function na(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Os(n,e){this.g=n,this.h=e}function ia(n,e){if(An(e))throw Error("division by zero");if(An(n))return new Os(ei,ei);if(Ft(n))return e=ia(qe(n),e),new Os(qe(e.g),qe(e.h));if(Ft(e))return e=ia(n,qe(e)),new Os(qe(e.g),e.h);if(30<n.g.length){if(Ft(n)||Ft(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Ds,i=e;0>=i.X(n);)t=ra(t),i=ra(i);var r=Ki(t,1),s=Ki(i,1);for(i=Ki(i,2),t=Ki(t,2);!An(i);){var a=s.add(i);0>=a.X(n)&&(r=r.add(t),s=a),i=Ki(i,1),t=Ki(t,1)}return e=Er(n,r.R(e)),new Os(r,e)}for(r=ei;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,i-48),a=(s=gn(t)).R(e);Ft(a)||0<a.X(n);)a=(s=gn(t-=i)).R(e);An(s)&&(s=Ds),r=r.add(s),n=Er(n,a)}return new Os(r,n)}function ra(n){for(var e=n.g.length+1,t=[],i=0;i<e;i++)t[i]=n.D(i)<<1|n.D(i-1)>>>31;return new Ne(t,n.h)}function Ki(n,e){var t=e>>5;e%=32;for(var i=n.g.length-t,r=[],s=0;s<i;s++)r[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ne(r,n.h)}(j=Ne.prototype).ea=function(){if(Ft(this))return-qe(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var i=this.D(t);n+=(0<=i?i:ks+i)*e,e*=ks}return n},j.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(An(this))return"0";if(Ft(this))return"-"+qe(this).toString(n);for(var e=gn(Math.pow(n,6)),t=this,i="";;){var r=ia(t,e).g,s=((0<(t=Er(t,r.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(An(t=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},j.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},j.X=function(n){return Ft(n=Er(this,n))?-1:An(n)?0:1},j.abs=function(){return Ft(this)?qe(this):this},j.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&n.D(r)),a=(s>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=a>>>16,t[r]=(a&=65535)<<16|(s&=65535)}return new Ne(t,-2147483648&t[t.length-1]?-1:0)},j.R=function(n){if(An(this)||An(n))return ei;if(Ft(this))return Ft(n)?qe(this).R(qe(n)):qe(qe(this).R(n));if(Ft(n))return qe(this.R(qe(n)));if(0>this.X(ml)&&0>n.X(ml))return gn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],i=0;i<2*e;i++)t[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var s=this.D(i)>>>16,a=65535&this.D(i),d=n.D(r)>>>16,f=65535&n.D(r);t[2*i+2*r]+=a*f,na(t,2*i+2*r),t[2*i+2*r+1]+=s*f,na(t,2*i+2*r+1),t[2*i+2*r+1]+=a*d,na(t,2*i+2*r+1),t[2*i+2*r+2]+=s*d,na(t,2*i+2*r+2)}for(i=0;i<e;i++)t[i]=t[2*i+1]<<16|t[2*i];for(i=e;i<2*e;i++)t[i]=0;return new Ne(t,0)},j.gb=function(n){return ia(this,n).h},j.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)&n.D(i);return new Ne(t,this.h&n.h)},j.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)|n.D(i);return new Ne(t,this.h|n.h)},j.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],i=0;i<e;i++)t[i]=this.D(i)^n.D(i);return new Ne(t,this.h^n.h)},ta.prototype.createWebChannel=ta.prototype.g,nn.prototype.send=nn.prototype.u,nn.prototype.open=nn.prototype.m,nn.prototype.close=nn.prototype.close,vr.NO_ERROR=0,vr.TIMEOUT=8,vr.HTTP_ERROR=6,$u.COMPLETE="complete",Mo.EventType=Ir,Ir.OPEN="a",Ir.CLOSE="b",Ir.ERROR="c",Ir.MESSAGE="d",ft.prototype.listen=ft.prototype.O,Qe.prototype.listenOnce=Qe.prototype.P,Qe.prototype.getLastError=Qe.prototype.Sa,Qe.prototype.getLastErrorCode=Qe.prototype.Ia,Qe.prototype.getStatus=Qe.prototype.da,Qe.prototype.getResponseJson=Qe.prototype.Wa,Qe.prototype.getResponseText=Qe.prototype.ja,Qe.prototype.send=Qe.prototype.ha,Qe.prototype.setWithCredentials=Qe.prototype.Oa,Sn.prototype.digest=Sn.prototype.l,Sn.prototype.reset=Sn.prototype.reset,Sn.prototype.update=Sn.prototype.j,Ne.prototype.add=Ne.prototype.add,Ne.prototype.multiply=Ne.prototype.R,Ne.prototype.modulo=Ne.prototype.gb,Ne.prototype.compare=Ne.prototype.X,Ne.prototype.toNumber=Ne.prototype.ea,Ne.prototype.toString=Ne.prototype.toString,Ne.prototype.getBits=Ne.prototype.D,Ne.fromNumber=gn,Ne.fromString=function pl(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return qe(pl(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=gn(Math.pow(e,8)),i=ei,r=0;r<n.length;r+=8){var s=Math.min(8,n.length-r),a=parseInt(n.substring(r,r+s),e);8>s?(s=gn(Math.pow(e,s)),i=i.R(s).add(gn(a))):i=(i=i.R(t)).add(gn(a))}return i};var ad=ut.createWebChannelTransport=function(){return new ta},cd=ut.getStatEventTarget=function(){return No()},Ns=ut.ErrorCode=vr,ud=ut.EventType=$u,xc=ut.Event=Ui,gl=ut.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Sc=ut.FetchXmlHttpFactory=Ko,br=ut.WebChannel=Mo,ld=ut.XhrIo=Qe,Rs=ut.Md5=Sn,Cr=ut.Integer=Ne;const _l="@firebase/firestore";class lt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lt.UNAUTHENTICATED=new lt(null),lt.GOOGLE_CREDENTIALS=new lt("google-credentials-uid"),lt.FIRST_PARTY=new lt("first-party-uid"),lt.MOCK_USER=new lt("mock-user");let gi="9.23.0";const Fn=new Te.Yd("@firebase/firestore");function Ac(){return Fn.logLevel}function U(n,...e){if(Fn.logLevel<=Te.in.DEBUG){const t=e.map(Dc);Fn.debug(`Firestore (${gi}): ${n}`,...t)}}function Ye(n,...e){if(Fn.logLevel<=Te.in.ERROR){const t=e.map(Dc);Fn.error(`Firestore (${gi}): ${n}`,...t)}}function _n(n,...e){if(Fn.logLevel<=Te.in.WARN){const t=e.map(Dc);Fn.warn(`Firestore (${gi}): ${n}`,...t)}}function Dc(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Q(n="Unexpected state"){const e=`FIRESTORE (${gi}) INTERNAL ASSERTION FAILED: `+n;throw Ye(e),new Error(e)}function ie(n,e){n||Q()}function H(n,e){return n}const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends he.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ot{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class yl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Oc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lt.UNAUTHENTICATED))}shutdown(){}}class sa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Nc{constructor(e){this.t=e,this.currentUser=lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let r=this.i;const s=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let a=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ot,e.enqueueRetryable(()=>s(this.currentUser))};const d=()=>{const m=a;e.enqueueRetryable((0,S.Z)(function*(){yield m.promise,yield s(i.currentUser)}))},f=m=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ot)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ie("string"==typeof i.accessToken),new yl(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ie(null===e||"string"==typeof e),new lt(e)}}class vl{constructor(e,t,i){this.h=e,this.l=t,this.m=i,this.type="FirstParty",this.user=lt.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Rc{constructor(e,t,i){this.h=e,this.l=t,this.m=i}getToken(){return Promise.resolve(new vl(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Il{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wl{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const i=s=>{null!=s.error&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.T;return this.T=s.token,U("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ie("string"==typeof t.token),this.T=t.token,new Il(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Tl(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class El{static A(){const t=62*Math.floor(256/62);let i="";for(;i.length<20;){const r=Tl(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[s]%62))}return i}}function ce(n,e){return n<e?-1:n>e?1:0}function _i(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function bl(n){return n+"\0"}class Ge{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ge.fromMillis(Date.now())}static fromDate(e){return Ge.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ge(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Ge(0,0))}static max(){return new re(new Ge(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Wi{constructor(e,t,i){void 0===t?t=0:t>e.length&&Q(),void 0===i?i=e.length-t:i>e.length-t&&Q(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===Wi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Wi?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),a=t.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class be extends Wi{construct(e,t,i){return new be(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new L(O.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new be(t)}static emptyPath(){return new be([])}}const fd=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class je extends Wi{construct(e,t,i){return new je(e,t,i)}static isValidIdentifier(e){return fd.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),je.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new je(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new L(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let a=!1;for(;r<e.length;){const d=e[r];if("\\"===d){if(r+1===e.length)throw new L(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new L(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,r+=2}else"`"===d?(a=!a,r++):"."!==d||a?(i+=d,r++):(s(),r++)}if(s(),a)throw new L(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new je(t)}static emptyPath(){return new je([])}}class K{constructor(e){this.path=e}static fromPath(e){return new K(be.fromString(e))}static fromName(e){return new K(be.fromString(e).popFirst(5))}static empty(){return new K(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===be.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return be.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new be(e.slice()))}}class Qi{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function Pc(n){return n.fields.find(e=>2===e.kind)}function Yi(n){return n.fields.filter(e=>2!==e.kind)}Qi.UNKNOWN_ID=-1;class oa{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ps{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ps(0,Gt.min())}}function Cl(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=re.fromTimestamp(1e9===i?new Ge(t+1,0):new Ge(t,i));return new Gt(r,K.empty(),e)}function xl(n){return new Gt(n.readTime,n.key,-1)}class Gt{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Gt(re.min(),K.empty(),-1)}static max(){return new Gt(re.max(),K.empty(),-1)}}function Mc(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=K.comparator(n.documentKey,e.documentKey),0!==t?t:ce(n.largestBatchId,e.largestBatchId))}const Sl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Al{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function yi(n){return Lc.apply(this,arguments)}function Lc(){return Lc=(0,S.Z)(function*(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==Sl)throw n;U("LocalStore","Unexpectedly lost primary lease")}),Lc.apply(this,arguments)}class A{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new A((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof A?t:A.resolve(t)}catch(t){return A.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):A.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):A.reject(t)}static resolve(e){return new A((t,i)=>{t(e)})}static reject(e){return new A((t,i)=>{i(e)})}static waitFor(e){return new A((t,i)=>{let r=0,s=0,a=!1;e.forEach(d=>{++r,d.next(()=>{++s,a&&s===r&&t()},f=>i(f))}),a=!0,s===r&&t()})}static or(e){let t=A.resolve(!1);for(const i of e)t=t.next(r=>r?A.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new A((i,r)=>{const s=e.length,a=new Array(s);let d=0;for(let f=0;f<s;f++){const m=f;t(e[m]).next(g=>{a[m]=g,++d,d===s&&i(a)},g=>r(g))}})}static doWhile(e,t){return new A((i,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):i()};s()})}}class aa{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new ot,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new Ms(e,t.error)):this.v.resolve()},this.transaction.onerror=i=>{const r=Ls(i.target.error);this.v.reject(new Ms(e,r))}}static open(e,t,i,r){try{return new aa(t,e.transaction(r,i))}catch(s){throw new Ms(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Fc(t)}}class kn{constructor(e,t,i){this.name=e,this.version=t,this.V=i,12.2===kn.S((0,he.z$)())&&Ye("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),ti(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,he.hl)())return!1;if(kn.C())return!0;const e=(0,he.z$)(),t=kn.S(e),i=0<t&&t<10,r=kn.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static N(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}$(e){var t=this;return(0,S.Z)(function*(){return t.db||(U("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=a=>{i(a.target.result)},s.onblocked=()=>{r(new Ms(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const d=a.target.error;r("VersionError"===d.name?new L(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===d.name?new L(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d):new Ms(e,d))},s.onupgradeneeded=a=>{U("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',a.oldVersion),t.V.O(a.target.result,s.transaction,a.oldVersion,t.version).next(()=>{U("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=i=>t.F(i)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){var s=this;return(0,S.Z)(function*(){const a="readonly"===t;let d=0;for(;;){++d;try{s.db=yield s.$(e);const f=aa.open(s.db,e,a?"readonly":"readwrite",i),m=r(f).next(g=>(f.P(),g)).catch(g=>(f.abort(g),A.reject(g))).toPromise();return m.catch(()=>{}),yield f.R,m}catch(f){const m=f,g="FirebaseError"!==m.name&&d<3;if(U("SimpleDb","Transaction failed with error:",m.message,"Retrying:",g),s.close(),!g)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class gd{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return ti(this.L.delete())}}class Ms extends L{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function vi(n){return"IndexedDbTransactionError"===n.name}class Fc{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(U("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),ti(i)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),ti(this.store.add(e))}get(e){return ti(this.store.get(e)).next(t=>(void 0===t&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),ti(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),ti(this.store.count())}j(e,t){const i=this.options(e,t);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),s=[];return this.W(r,(a,d)=>{s.push(d)}).next(()=>s)}{const r=this.store.getAll(i.range);return new A((s,a)=>{r.onerror=d=>{a(d.target.error)},r.onsuccess=d=>{s(d.target.result)}})}}H(e,t){const i=this.store.getAll(e,null===t?void 0:t);return new A((r,s)=>{i.onerror=a=>{s(a.target.error)},i.onsuccess=a=>{r(a.target.result)}})}J(e,t){U("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.W(r,(s,a,d)=>d.delete())}X(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}Z(e){const t=this.cursor({});return new A((i,r)=>{t.onerror=s=>{const a=Ls(s.target.error);r(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(d=>{d?a.continue():i()}):i()}})}W(e,t){const i=[];return new A((r,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const d=a.target.result;if(!d)return void r();const f=new gd(d),m=t(d.primaryKey,d.value,f);if(m instanceof A){const g=m.catch(y=>(f.done(),A.reject(y)));i.push(g)}f.isDone?r():null===f.K?d.continue():d.continue(f.K)}}).next(()=>A.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ti(n){return new A((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const r=Ls(i.target.error);t(r)}})}let kl=!1;function Ls(n){const e=kn.S((0,he.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kl||(kl=!0,setTimeout(()=>{throw i},0)),i}}return n}class _d{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;U("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,S.Z)(function*(){t.task=null;try{U("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(i){vi(i)?U("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield yi(i)}yield t.et(6e4)}))}}class Dl{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,S.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>t.st(i,e))})()}st(e,t){const i=new Set;let r=t,s=!0;return A.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(null!==a&&!i.has(a))return U("IndexBackiller",`Processing collection: ${a}`),this.it(e,a,r).next(d=>{r-=d,i.add(a)});s=!1})).next(()=>t-r)}it(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.rt(r,s)).next(d=>(U("IndexBackiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>a.size)}))}rt(e,t){let i=e;return t.changes.forEach((r,s)=>{const a=xl(s);Mc(a,i)>0&&(i=a)}),new Gt(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}let rn=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>i.writeSequenceNumber(r))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function Ji(n){return null==n}function Fs(n){return 0===n&&1/n==-1/0}function yd(n){return"number"==typeof n&&Number.isInteger(n)&&!Fs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Tt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Vs(e)),e=Ol(n.get(t),e);return Vs(e)}function Ol(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function Vs(n){return n+"\x01\x01"}function Dn(n){const e=n.length;if(ie(e>=2),2===e)return ie("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),be.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const a=n.indexOf("\x01",s);switch((a<0||a>t)&&Q(),n.charAt(a+1)){case"\x01":const d=n.substring(s,a);let f;0===r.length?f=d:(r+=d,f=r,r=""),i.push(f);break;case"\x10":r+=n.substring(s,a),r+="\0";break;case"\x11":r+=n.substring(s,a+1);break;default:Q()}s=a+2}return new be(i)}const Vc=["userId","batchId"];function ca(n,e){return[n,Tt(e)]}function Nl(n,e,t){return[n,Tt(e),t]}const vd={},Id=["prefixPath","collectionGroup","readTime","documentId"],wd=["prefixPath","collectionGroup","documentId"],Rl=["collectionGroup","readTime","prefixPath","documentId"],Td=["canonicalId","targetId"],jp=["targetId","path"],Xi=["path","targetId"],Ed=["collectionId","parent"],bd=["indexId","uid"],Uc=["uid","sequenceNumber"],Cd=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zc=["indexId","uid","orderedDocumentKey"],xd=["userId","collectionPath","documentId"],Sd=["userId","collectionPath","largestBatchId"],Zc=["userId","collectionGroup","largestBatchId"],Pl=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ad=[...Pl,"documentOverlays"],ua=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ml=ua,kd=[...Ml,"indexConfiguration","indexState","indexEntries"];class Bc extends Al{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Et(n,e){const t=H(n);return kn.M(t.ht,e)}function Ll(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ni(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function la(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ze{constructor(e,t){this.comparator=e,this.root=t||pt.EMPTY}insert(e,t){return new ze(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ha(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ha(this.root,e,this.comparator,!1)}getReverseIterator(){return new ha(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ha(this.root,e,this.comparator,!0)}}class ha{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??pt.RED,this.left=r??pt.EMPTY,this.right=s??pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new pt(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return pt.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1,pt.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(n,e,t,i,r){return this}insert(n,e,t){return new pt(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Le{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Fl(this.data.getIterator())}getIteratorFrom(e){return new Fl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Le)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Le(this.comparator);return t.data=e,t}}class Fl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xr(n){return n.hasNext()?n.getNext():void 0}class Ot{constructor(e){this.fields=e,e.sort(je.comparator)}static empty(){return new Ot([])}unionWith(e){let t=new Le(je.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ot(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _i(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class Vl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Vl("Invalid base64 string: "+r):r}}(e);return new mt(t)}static fromUint8Array(e){const t=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new mt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const Ul=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ii(n){if(ie(!!n),"string"==typeof n){let e=0;const t=Ul.exec(n);if(ie(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Je(n.seconds),nanos:Je(n.nanos)}}function Je(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function ii(n){return"string"==typeof n?mt.fromBase64String(n):mt.fromUint8Array(n)}function da(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function wi(n){const e=n.mapValue.fields.__previous_value__;return da(e)?wi(e):e}function Us(n){const e=Ii(n.mapValue.fields.__local_write_time__.timestampValue);return new Ge(e.seconds,e.nanos)}class zl{constructor(e,t,i,r,s,a,d,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=m}}class Ti{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ti("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ti&&e.projectId===this.projectId&&e.database===this.database}}const Ei={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},fa={nullValue:"NULL_VALUE"};function bi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?da(n)?4:qc(n)?9007199254740991:10:Q()}function On(n,e){if(n===e)return!0;const t=bi(n);if(t!==bi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Us(n).isEqual(Us(e));case 3:return function(i,r){if("string"==typeof i.timestampValue&&"string"==typeof r.timestampValue&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=Ii(i.timestampValue),a=Ii(r.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return r=e,ii(n.bytesValue).isEqual(ii(r.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return Je(i.geoPointValue.latitude)===Je(r.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return Je(i.integerValue)===Je(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=Je(i.doubleValue),a=Je(r.doubleValue);return s===a?Fs(s)===Fs(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return _i(n.arrayValue.values||[],e.arrayValue.values||[],On);case 10:return function(i,r){const s=i.mapValue.fields||{},a=r.mapValue.fields||{};if(Ll(s)!==Ll(a))return!1;for(const d in s)if(s.hasOwnProperty(d)&&(void 0===a[d]||!On(s[d],a[d])))return!1;return!0}(n,e);default:return Q()}var r}function er(n,e){return void 0!==(n.values||[]).find(t=>On(t,e))}function Vn(n,e){if(n===e)return 0;const t=bi(n),i=bi(e);if(t!==i)return ce(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ce(n.booleanValue,e.booleanValue);case 2:return function(r,s){const a=Je(r.integerValue||r.doubleValue),d=Je(s.integerValue||s.doubleValue);return a<d?-1:a>d?1:a===d?0:isNaN(a)?isNaN(d)?0:-1:1}(n,e);case 3:return Gc(n.timestampValue,e.timestampValue);case 4:return Gc(Us(n),Us(e));case 5:return ce(n.stringValue,e.stringValue);case 6:return function(r,s){const a=ii(r),d=ii(s);return a.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(r,s){const a=r.split("/"),d=s.split("/");for(let f=0;f<a.length&&f<d.length;f++){const m=ce(a[f],d[f]);if(0!==m)return m}return ce(a.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,s){const a=ce(Je(r.latitude),Je(s.latitude));return 0!==a?a:ce(Je(r.longitude),Je(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(r,s){const a=r.values||[],d=s.values||[];for(let f=0;f<a.length&&f<d.length;++f){const m=Vn(a[f],d[f]);if(m)return m}return ce(a.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===Ei.mapValue&&s===Ei.mapValue)return 0;if(r===Ei.mapValue)return 1;if(s===Ei.mapValue)return-1;const a=r.fields||{},d=Object.keys(a),f=s.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let g=0;g<d.length&&g<m.length;++g){const y=ce(d[g],m[g]);if(0!==y)return y;const C=Vn(a[d[g]],f[m[g]]);if(0!==C)return C}return ce(d.length,m.length)}(n.mapValue,e.mapValue);default:throw Q()}}function Gc(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return ce(n,e);const t=Ii(n),i=Ii(e),r=ce(t.seconds,i.seconds);return 0!==r?r:ce(t.nanos,i.nanos)}function Sr(n){return zs(n)}function zs(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const r=Ii(i);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?ii(n.bytesValue).toBase64():"referenceValue"in n?K.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let r="[",s=!0;for(const a of i.values||[])s?s=!1:r+=",",r+=zs(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",a=!0;for(const d of r)a?a=!1:s+=",",s+=`${d}:${zs(i.fields[d])}`;return s+"}"}(n.mapValue):Q();var e}function gt(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function tr(n){return!!n&&"integerValue"in n}function Ar(n){return!!n&&"arrayValue"in n}function Zl(n){return!!n&&"nullValue"in n}function ma(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kr(n){return!!n&&"mapValue"in n}function Zs(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ni(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Zs(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zs(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qc(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Od(n){return"nullValue"in n?fa:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?gt(Ti.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Q()}function Ci(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?gt(Ti.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Ei:Q()}function jc(n,e){const t=Vn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Bl(n,e){const t=Vn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Nt{constructor(e){this.value=e}static empty(){return new Nt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!kr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zs(t)}setAll(e){let t=je.emptyPath(),i={},r=[];e.forEach((a,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,i,r),i={},r=[],t=d.popLast()}a?i[d.lastSegment()]=Zs(a):r.push(d.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());kr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return On(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];kr(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ni(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Nt(Zs(this.value))}}function Gl(n){const e=[];return ni(n.fields,(t,i)=>{const r=new je([t]);if(kr(i)){const s=Gl(i.mapValue).fields;if(0===s.length)e.push(r);else for(const a of s)e.push(r.child(a))}else e.push(r)}),new Ot(e)}class Ze{constructor(e,t,i,r,s,a,d){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=a,this.documentState=d}static newInvalidDocument(e){return new Ze(e,0,re.min(),re.min(),re.min(),Nt.empty(),0)}static newFoundDocument(e,t,i,r){return new Ze(e,1,t,re.min(),i,r,0)}static newNoDocument(e,t){return new Ze(e,2,t,re.min(),re.min(),Nt.empty(),0)}static newUnknownDocument(e,t){return new Ze(e,3,t,re.min(),re.min(),Nt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class at{constructor(e,t){this.position=e,this.inclusive=t}}function ga(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],a=n.position[r];if(i=s.field.isKeyField()?K.comparator(K.fromName(a.referenceValue),t.key):Vn(a,t.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function _a(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!On(n.position[t],e.position[t]))return!1;return!0}class Dr{constructor(e,t="asc"){this.field=e,this.dir=t}}function ri(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Or{}class ye extends Or{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new c(e,t,i):"array-contains"===t?new w(e,i):"in"===t?new x(e,i):"not-in"===t?new V(e,i):"array-contains-any"===t?new G(e,i):new ye(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new h(e,i):new p(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Vn(t,this.value)):null!==t&&bi(this.value)===bi(t)&&this.matchesComparison(Vn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Oe extends Or{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Oe(e,t)}matches(e){return Nr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Nr(n){return"and"===n.op}function Bs(n){return"or"===n.op}function $c(n){return ql(n)&&Nr(n)}function ql(n){for(const e of n.filters)if(e instanceof Oe)return!1;return!0}function Hc(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+Sr(n.value);if($c(n))return n.filters.map(e=>Hc(e)).join(",");{const e=n.filters.map(t=>Hc(t)).join(",");return`${n.op}(${e})`}}function jl(n,e){return n instanceof ye?(t=n,(i=e)instanceof ye&&t.op===i.op&&t.field.isEqual(i.field)&&On(t.value,i.value)):n instanceof Oe?function(t,i){return i instanceof Oe&&t.op===i.op&&t.filters.length===i.filters.length&&t.filters.reduce((r,s,a)=>r&&jl(s,i.filters[a]),!0)}(n,e):void Q();var t,i}function u(n,e){const t=n.filters.concat(e);return Oe.create(t,n.op)}function o(n){return n instanceof ye?`${(e=n).field.canonicalString()} ${e.op} ${Sr(e.value)}`:n instanceof Oe?function(e){return e.op.toString()+" {"+e.getFilters().map(o).join(" ,")+"}"}(n):"Filter";var e}class c extends ye{constructor(e,t,i){super(e,t,i),this.key=K.fromName(i.referenceValue)}matches(e){const t=K.comparator(e.key,this.key);return this.matchesComparison(t)}}class h extends ye{constructor(e,t){super(e,"in",t),this.keys=_(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class p extends ye{constructor(e,t){super(e,"not-in",t),this.keys=_(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function _(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>K.fromName(i.referenceValue))}class w extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ar(t)&&er(t.arrayValue,this.value)}}class x extends ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&er(this.value.arrayValue,t)}}class V extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(er(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!er(this.value.arrayValue,t)}}class G extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ar(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>er(this.value.arrayValue,i))}}class Y{constructor(e,t=null,i=[],r=[],s=null,a=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=a,this.endAt=d,this.dt=null}}function J(n,e=null,t=[],i=[],r=null,s=null,a=null){return new Y(n,e,t,i,r,s,a)}function Re(n){const e=H(n);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Hc(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(r=i).field.canonicalString()+r.dir;var r}).join(","),Ji(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Sr(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Sr(i)).join(",")),e.dt=t}return e.dt}function qt(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ri(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!jl(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!_a(n.startAt,e.startAt)&&_a(n.endAt,e.endAt)}function nr(n){return K.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Gs(n,e){return n.filters.filter(t=>t instanceof ye&&t.field.isEqual(e))}function ya(n,e,t){let i=fa,r=!0;for(const s of Gs(n,e)){let a=fa,d=!0;switch(s.op){case"<":case"<=":a=Od(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,d=!1;break;case"!=":case"not-in":a=fa}jc({value:i,inclusive:r},{value:a,inclusive:d})<0&&(i=a,r=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];jc({value:i,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(i=a,r=t.inclusive);break}return{value:i,inclusive:r}}function Kc(n,e,t){let i=Ei,r=!0;for(const s of Gs(n,e)){let a=Ei,d=!0;switch(s.op){case">=":case">":a=Ci(s.value),d=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,d=!1;break;case"!=":case"not-in":a=Ei}Bl({value:i,inclusive:r},{value:a,inclusive:d})>0&&(i=a,r=d)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Bl({value:i,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(i=a,r=t.inclusive);break}return{value:i,inclusive:r}}class Un{constructor(e,t=null,i=[],r=[],s=null,a="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=a,this.startAt=d,this.endAt=f,this.wt=null,this._t=null}}function va(n,e,t,i,r,s,a,d){return new Un(n,e,t,i,r,s,a,d)}function ir(n){return new Un(n)}function Wc(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function qs(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function js(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Qc(n){return null!==n.collectionGroup}function si(n){const e=H(n);if(null===e.wt){e.wt=[];const t=js(e),i=qs(e);if(null!==t&&null===i)t.isKeyField()||e.wt.push(new Dr(t)),e.wt.push(new Dr(je.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Dr(je.keyField(),s))}}}return e.wt}function jt(n){const e=H(n);if(!e._t)if("F"===e.limitType)e._t=J(e.path,e.collectionGroup,si(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of si(e))t.push(new Dr(s.field,"desc"===s.dir?"asc":"desc"));const i=e.endAt?new at(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new at(e.startAt.position,e.startAt.inclusive):null;e._t=J(e.path,e.collectionGroup,t,e.filters,e.limit,i,r)}return e._t}function Nd(n,e){e.getFirstInequalityField(),js(n);const t=n.filters.concat([e]);return new Un(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $l(n,e,t){return new Un(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yc(n,e){return qt(jt(n),jt(e))&&n.limitType===e.limitType}function $p(n){return`${Re(jt(n))}|lt:${n.limitType}`}function Rd(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(i=>o(i)).join(", ")}]`),Ji(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(i=>{return`${(r=i).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Sr(i)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Sr(i)).join(",")),`Target(${t})`}(jt(n))}; limitType=${n.limitType})`}function Jc(n,e){return e.isFoundDocument()&&function(t,i){const r=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):K.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(n,e)&&function(t,i){for(const r of si(t))if(!r.field.isKeyField()&&null===i.data.field(r.field))return!1;return!0}(n,e)&&function(t,i){for(const r of t.filters)if(!r.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!function(r,s,a){const d=ga(r,s,a);return r.inclusive?d<=0:d<0}(t.startAt,si(t),i)||t.endAt&&!function(r,s,a){const d=ga(r,s,a);return r.inclusive?d>=0:d>0}(t.endAt,si(t),i)));var t,i}function Hp(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Kp(n){return(e,t)=>{let i=!1;for(const r of si(n)){const s=W_(r,e,t);if(0!==s)return s;i=i||r.field.isKeyField()}return 0}}function W_(n,e,t){const i=n.field.isKeyField()?K.comparator(e.key,t.key):function(r,s,a){const d=s.data.field(r),f=a.data.field(r);return null!==d&&null!==f?Vn(d,f):Q()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Q()}}class rr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[r,s]of i)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(void 0===r)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return 1===i.length?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ni(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return la(this.inner)}size(){return this.innerSize}}const Q_=new ze(K.comparator);function yn(){return Q_}const Wp=new ze(K.comparator);function Xc(...n){let e=Wp;for(const t of n)e=e.insert(t.key,t);return e}function Qp(n){let e=Wp;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function xi(){return eu()}function Yp(){return eu()}function eu(){return new rr(n=>n.toString(),(n,e)=>n.isEqual(e))}const Y_=new ze(K.comparator),J_=new Le(K.comparator);function pe(...n){let e=J_;for(const t of n)e=e.add(t);return e}const X_=new Le(ce);function Pd(){return X_}function Jp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fs(e)?"-0":e}}function Xp(n){return{integerValue:""+n}}function em(n,e){return yd(e)?Xp(e):Jp(n,e)}class Hl{constructor(){this._=void 0}}function ey(n,e,t){return n instanceof Ia?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&da(r)&&(r=wi(r)),r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):n instanceof $s?nm(n,e):n instanceof Hs?im(n,e):function(i,r){const s=tm(i,r),a=rm(s)+rm(i.gt);return tr(s)&&tr(i.gt)?Xp(a):Jp(i.serializer,a)}(n,e)}function ty(n,e,t){return n instanceof $s?nm(n,e):n instanceof Hs?im(n,e):t}function tm(n,e){return n instanceof wa?tr(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class Ia extends Hl{}class $s extends Hl{constructor(e){super(),this.elements=e}}function nm(n,e){const t=sm(e);for(const i of n.elements)t.some(r=>On(r,i))||t.push(i);return{arrayValue:{values:t}}}class Hs extends Hl{constructor(e){super(),this.elements=e}}function im(n,e){let t=sm(e);for(const i of n.elements)t=t.filter(r=>!On(r,i));return{arrayValue:{values:t}}}class wa extends Hl{constructor(e,t){super(),this.serializer=e,this.gt=t}}function rm(n){return Je(n.integerValue||n.doubleValue)}function sm(n){return Ar(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class tu{constructor(e,t){this.field=e,this.transform=t}}class iy{constructor(e,t){this.version=e,this.transformResults=t}}class Xe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xe}static exists(e){return new Xe(void 0,e)}static updateTime(e){return new Xe(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Kl(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Wl{}function om(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Ea(n.key,Xe.none()):new Ta(n.key,n.data,Xe.none());{const t=n.data,i=Nt.empty();let r=new Le(je.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);null===a&&s.length>1&&(s=s.popLast(),a=t.field(s)),null===a?i.delete(s):i.set(s,a),r=r.add(s)}return new sr(n.key,i,new Ot(r.toArray()),Xe.none())}}function ry(n,e,t){n instanceof Ta?function(i,r,s){const a=i.value.clone(),d=um(i.fieldTransforms,r,s.transformResults);a.setAll(d),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof sr?function(i,r,s){if(!Kl(i.precondition,r))return void r.convertToUnknownDocument(s.version);const a=um(i.fieldTransforms,r,s.transformResults),d=r.data;d.setAll(cm(i)),d.setAll(a),r.convertToFoundDocument(s.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function nu(n,e,t,i){return n instanceof Ta?function(r,s,a,d){if(!Kl(r.precondition,s))return a;const f=r.value.clone(),m=lm(r.fieldTransforms,d,s);return f.setAll(m),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),null}(n,e,t,i):n instanceof sr?function(r,s,a,d){if(!Kl(r.precondition,s))return a;const f=lm(r.fieldTransforms,d,s),m=s.data;return m.setAll(cm(r)),m.setAll(f),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===a?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(g=>g.field))}(n,e,t,i):(a=t,Kl(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a);var s,a}function sy(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=tm(i.transform,r||null);null!=s&&(null===t&&(t=Nt.empty()),t.set(i.field,s))}return t||null}function am(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&_i(t,i,(r,s)=>function ny(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof $s&&i instanceof $s||t instanceof Hs&&i instanceof Hs?_i(t.elements,i.elements,On):t instanceof wa&&i instanceof wa?On(t.gt,i.gt):t instanceof Ia&&i instanceof Ia);var t,i}(r,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}class Ta extends Wl{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class sr extends Wl{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function cm(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function um(n,e,t){const i=new Map;ie(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],a=s.transform,d=e.data.field(s.field);i.set(s.field,ty(a,d,t[r]))}return i}function lm(n,e,t){const i=new Map;for(const r of n){const s=r.transform,a=t.data.field(r.field);i.set(r.field,ey(s,a,e))}return i}class Ea extends Wl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Md extends Wl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ld{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&ry(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=nu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=nu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Yp();return this.mutations.forEach(r=>{const s=e.get(r.key),a=s.overlayedDocument;let d=this.applyToLocalView(a,s.mutatedFields);d=t.has(r.key)?null:d;const f=om(a,d);null!==f&&i.set(r.key,f),a.isValidDocument()||a.convertToNoDocument(re.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&_i(this.mutations,e.mutations,(t,i)=>am(t,i))&&_i(this.baseMutations,e.baseMutations,(t,i)=>am(t,i))}}class Fd{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){ie(e.mutations.length===i.length);let r=Y_;const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,i[a].version);return new Fd(e,t,i,r)}}class Vd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ay{constructor(e,t){this.count=e,this.unchangedNames=t}}var bt,xe;function hm(n){switch(n){default:return Q();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function dm(n){if(void 0===n)return Ye("GRPC error has no .code"),O.UNKNOWN;switch(n){case bt.OK:return O.OK;case bt.CANCELLED:return O.CANCELLED;case bt.UNKNOWN:return O.UNKNOWN;case bt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case bt.INTERNAL:return O.INTERNAL;case bt.UNAVAILABLE:return O.UNAVAILABLE;case bt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case bt.NOT_FOUND:return O.NOT_FOUND;case bt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case bt.ABORTED:return O.ABORTED;case bt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case bt.DATA_LOSS:return O.DATA_LOSS;default:return Q()}}(xe=bt||(bt={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";class Ud{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Ql}static getOrCreateInstance(){return null===Ql&&(Ql=new Ud),Ql}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Ql=null;function fm(){return new TextEncoder}const cy=new Cr([4294967295,4294967295],0);function pm(n){const e=fm().encode(n),t=new Rs;return t.update(e),new Uint8Array(t.digest())}function mm(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Cr([t,i],0),new Cr([r,s],0)]}class zd{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new iu(`Invalid padding: ${t}`);if(i<0)throw new iu(`Invalid hash count: ${i}`);if(e.length>0&&0===this.hashCount)throw new iu(`Invalid hash count: ${i}`);if(0===e.length&&0!==t)throw new iu(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Cr.fromNumber(this.It)}Et(e,t,i){let r=e.add(t.multiply(Cr.fromNumber(i)));return 1===r.compare(cy)&&(r=new Cr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=pm(e),[i,r]=mm(t);for(let s=0;s<this.hashCount;s++){const a=this.Et(i,r,s);if(!this.At(a))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new zd(s,r,t);return i.forEach(d=>a.insert(d)),a}insert(e){if(0===this.It)return;const t=pm(e),[i,r]=mm(t);for(let s=0;s<this.hashCount;s++){const a=this.Et(i,r,s);this.Rt(a)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class iu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ru{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,su.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new ru(re.min(),r,new ze(ce),yn(),pe())}}class su{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new su(i,t,pe(),pe(),pe())}}class Yl{constructor(e,t,i,r){this.Pt=e,this.removedTargetIds=t,this.key=i,this.bt=r}}class gm{constructor(e,t){this.targetId=e,this.Vt=t}}class _m{constructor(e,t,i=mt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class ym{constructor(){this.St=0,this.Dt=Im(),this.Ct=mt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=pe(),t=pe(),i=pe();return this.Dt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Q()}}),new su(this.Ct,this.xt,e,t,i)}Ft(){this.Nt=!1,this.Dt=Im()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class uy{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=yn(),this.zt=vm(),this.Wt=new ze(ce)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const i=this.Zt(t);switch(e.state){case 0:this.te(t)&&i.$t(e.resumeToken);break;case 1:i.Ut(),i.kt||i.Ft(),i.$t(e.resumeToken);break;case 2:i.Ut(),i.kt||this.removeTarget(t);break;case 3:this.te(t)&&(i.Kt(),i.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),i.$t(e.resumeToken));break;default:Q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((i,r)=>{this.te(r)&&t(r)})}ne(e){var t;const i=e.targetId,r=e.Vt.count,s=this.se(i);if(s){const a=s.target;if(nr(a))if(0===r){const d=new K(a.path);this.Yt(i,d,Ze.newNoDocument(d,re.min()))}else ie(1===r);else{const d=this.ie(i);if(d!==r){const f=this.re(e,d);0!==f&&(this.ee(i),this.Wt=this.Wt.insert(i,2===f?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=Ud.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(m,g,y){var C,N,Z,$,W,oe;const ve={localCacheCount:g,existenceFilterCount:y.count},de=y.unchangedNames;return de&&(ve.bloomFilter={applied:0===m,hashCount:null!==(C=de?.hashCount)&&void 0!==C?C:0,bitmapLength:null!==($=null===(Z=null===(N=de?.bits)||void 0===N?void 0:N.bitmap)||void 0===Z?void 0:Z.length)&&void 0!==$?$:0,padding:null!==(oe=null===(W=de?.bits)||void 0===W?void 0:W.padding)&&void 0!==oe?oe:0}),ve}(f,d,e.Vt))}}}}re(e,t){const{unchangedNames:i,count:r}=e.Vt;if(!i||!i.bits)return 1;const{bits:{bitmap:s="",padding:a=0},hashCount:d=0}=i;let f,m;try{f=ii(s).toUint8Array()}catch(g){if(g instanceof Vl)return _n("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw g}try{m=new zd(f,a,d)}catch(g){return _n(g instanceof iu?"BloomFilter error: ":"Applying bloom filter failed: ",g),1}return 0===m.It?1:r!==t-this.oe(e.targetId,m)?2:0}oe(e,t){const i=this.Gt.getRemoteKeysForTarget(e);let r=0;return i.forEach(s=>{const a=this.Gt.ue(),d=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.vt(d)||(this.Yt(e,s,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((s,a)=>{const d=this.se(a);if(d){if(s.current&&nr(d.target)){const f=new K(d.target.path);null!==this.jt.get(f)||this.ae(a,f)||this.Yt(a,f,Ze.newNoDocument(f,e))}s.Mt&&(t.set(a,s.Ot()),s.Ft())}});let i=pe();this.zt.forEach((s,a)=>{let d=!0;a.forEachWhile(f=>{const m=this.se(f);return!m||"TargetPurposeLimboResolution"===m.purpose||(d=!1,!1)}),d&&(i=i.add(s))}),this.jt.forEach((s,a)=>a.setReadTime(e));const r=new ru(e,t,this.Wt,this.jt,i);return this.jt=yn(),this.zt=vm(),this.Wt=new ze(ce),r}Jt(e,t){if(!this.te(e))return;const i=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,i),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,i){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),i&&(this.jt=this.jt.insert(t,i))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new ym,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Le(ce),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||U("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new ym),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function vm(){return new ze(K.comparator)}function Im(){return new ze(K.comparator)}const ly={asc:"ASCENDING",desc:"DESCENDING"},hy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dy={and:"AND",or:"OR"};class fy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Zd(n,e){return n.useProto3Json||Ji(e)?e:{value:e}}function ba(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function py(n,e){return ba(n,e.toTimestamp())}function _t(n){return ie(!!n),re.fromTimestamp(function(e){const t=Ii(e);return new Ge(t.seconds,t.nanos)}(n))}function Bd(n,e){return(t=n,new be(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function Tm(n){const e=be.fromString(n);return ie(Om(e)),e}function ou(n,e){return Bd(n.databaseId,e.path)}function Si(n,e){const t=Tm(e);if(t.get(1)!==n.databaseId.projectId)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(bm(t))}function Gd(n,e){return Bd(n.databaseId,e)}function Em(n){const e=Tm(n);return 4===e.length?be.emptyPath():bm(e)}function au(n){return new be(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bm(n){return ie(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Cm(n,e,t){return{name:ou(n,e),fields:t.value.mapValue.fields}}function xm(n,e,t){const i=Si(n,e.name),r=_t(e.updateTime),s=e.createTime?_t(e.createTime):re.min(),a=new Nt({mapValue:{fields:e.fields}}),d=Ze.newFoundDocument(i,r,s,a);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function cu(n,e){let t;if(e instanceof Ta)t={update:Cm(n,e.key,e.value)};else if(e instanceof Ea)t={delete:ou(n,e.key)};else if(e instanceof sr)t={update:Cm(n,e.key,e.data),updateMask:Ty(e.fieldMask)};else{if(!(e instanceof Md))return Q();t={verify:ou(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const a=s.transform;if(a instanceof Ia)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $s)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Hs)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wa)return{fieldPath:s.field.canonicalString(),increment:a.gt};throw Q()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:py(n,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:Q()),t;var r}function qd(n,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?Xe.updateTime(_t(r.updateTime)):void 0!==r.exists?Xe.exists(r.exists):Xe.none():Xe.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,a){let d=null;"setToServerValue"in a?(ie("REQUEST_TIME"===a.setToServerValue),d=new Ia):"appendMissingElements"in a?d=new $s(a.appendMissingElements.values||[]):"removeAllFromArray"in a?d=new Hs(a.removeAllFromArray.values||[]):"increment"in a?d=new wa(s,a.increment):Q();const f=je.fromServerFormat(a.fieldPath);return new tu(f,d)}(n,r)):[];var r;if(e.update){const r=Si(n,e.update.name),s=new Nt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=new Ot((e.updateMask.fieldPaths||[]).map(m=>je.fromServerFormat(m)));return new sr(r,s,a,t,i)}return new Ta(r,s,t,i)}if(e.delete){const r=Si(n,e.delete);return new Ea(r,t)}if(e.verify){const r=Si(n,e.verify);return new Md(r,t)}return Q()}function Sm(n,e){return{documents:[Gd(n,e.path)]}}function jd(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=Gd(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Gd(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(f){if(0!==f.length)return Dm(Oe.create(f,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(f){if(0!==f.length)return f.map(m=>{return{field:Rr((g=m).field),direction:vy(g.dir)};var g})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Zd(n,e.limit);var d,f;return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(f=e.endAt).inclusive,values:f.position}),t}function Am(n){let e=Em(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){ie(1===i);const g=t.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=function(g){const y=km(g);return y instanceof Oe&&$c(y)?y.getFilters():[y]}(t.where));let a=[];t.orderBy&&(a=t.orderBy.map(g=>{return new Dr(Ca((y=g).field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction));var y}));let d=null;t.limit&&(d=function(g){let y;return y="object"==typeof g?g.value:g,Ji(y)?null:y}(t.limit));let f=null;var g;t.startAt&&(f=new at((g=t.startAt).values||[],!!g.before));let m=null;return t.endAt&&(m=function(g){return new at(g.values||[],!g.before)}(t.endAt)),va(e,r,a,s,d,"F",f,m)}function km(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ca(e.unaryFilter.field);return ye.create(t,"==",{doubleValue:NaN});case"IS_NULL":const i=Ca(e.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ca(e.unaryFilter.field);return ye.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ca(e.unaryFilter.field);return ye.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(n):void 0!==n.fieldFilter?ye.create(Ca((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Oe.create(e.compositeFilter.filters.map(t=>km(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Q()}}(e.compositeFilter.op))}(n):Q();var e}function vy(n){return ly[n]}function Iy(n){return hy[n]}function wy(n){return dy[n]}function Rr(n){return{fieldPath:n.canonicalString()}}function Ca(n){return je.fromServerFormat(n.fieldPath)}function Dm(n){return n instanceof ye?function(e){if("=="===e.op){if(ma(e.value))return{unaryFilter:{field:Rr(e.field),op:"IS_NAN"}};if(Zl(e.value))return{unaryFilter:{field:Rr(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ma(e.value))return{unaryFilter:{field:Rr(e.field),op:"IS_NOT_NAN"}};if(Zl(e.value))return{unaryFilter:{field:Rr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rr(e.field),op:Iy(e.op),value:e.value}}}(n):n instanceof Oe?function(e){const t=e.getFilters().map(i=>Dm(i));return 1===t.length?t[0]:{compositeFilter:{op:wy(e.op),filters:t}}}(n):Q()}function Ty(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Om(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class or{constructor(e,t,i,r,s=re.min(),a=re.min(),d=mt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Nm{constructor(e){this.fe=e}}function Rm(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Jl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document={name:ou(r=n.fe,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:ba(r,s.version.toTimestamp()),createTime:ba(r,s.createTime.toTimestamp())};else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ks(e.version)};else{if(!e.isUnknownDocument())return Q();i.unknownDocument={path:t.path.toArray(),version:Ks(e.version)}}var r,s;return i}function Jl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ks(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ws(n){const e=new Ge(n.seconds,n.nanoseconds);return re.fromTimestamp(e)}function Qs(n,e){const t=(e.baseMutations||[]).map(s=>qd(n.fe,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const i=e.mutations.map(s=>qd(n.fe,s)),r=Ge.fromMillis(e.localWriteTimeMs);return new Ld(e.batchId,r,t,i)}function uu(n){const e=Ws(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Ws(n.lastLimboFreeSnapshotVersion):re.min();let i;var r;return void 0!==n.query.documents?(ie(1===(r=n.query).documents.length),i=jt(ir(Em(r.documents[0])))):i=jt(Am(n.query)),new or(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,mt.fromBase64String(n.resumeToken))}function Pm(n,e){const t=Ks(e.snapshotVersion),i=Ks(e.lastLimboFreeSnapshotVersion);let r;r=nr(e.target)?Sm(n.fe,e.target):jd(n.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Re(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function $d(n){const e=Am({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?$l(e,e.limit,"L"):e}function Hd(n,e){return new Vd(e.largestBatchId,qd(n.fe,e.overlayMutation))}function Mm(n,e){const t=e.path.lastSegment();return[n,Tt(e.path.popLast()),t]}function Lm(n,e,t,i){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ks(i.readTime),documentKey:Tt(i.documentKey.path),largestBatchId:i.largestBatchId}}class by{getBundleMetadata(e,t){return Fm(e).get(t).next(i=>{if(i)return{id:(r=i).bundleId,createTime:Ws(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return Fm(e).put({bundleId:(i=t).id,createTime:Ks(_t(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return Vm(e).get(t).next(i=>{if(i)return{name:(r=i).name,query:$d(r.bundledQuery),readTime:Ws(r.readTime)};var r})}saveNamedQuery(e,t){return Vm(e).put({name:(i=t).name,readTime:Ks(_t(i.readTime)),bundledQuery:i.bundledQuery});var i}}function Fm(n){return Et(n,"bundles")}function Vm(n){return Et(n,"namedQueries")}class Xl{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new Xl(e,t.uid||"")}getOverlay(e,t){return lu(e).get(Mm(this.userId,t)).next(i=>i?Hd(this.serializer,i):null)}getOverlays(e,t){const i=xi();return A.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,a)=>{const d=new Vd(t,a);r.push(this.we(e,d))}),A.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(a=>r.add(Tt(a.getCollectionPath())));const s=[];return r.forEach(a=>{const d=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,i+1],!1,!0);s.push(lu(e).J("collectionPathOverlayIndex",d))}),A.waitFor(s)}getOverlaysForCollection(e,t,i){const r=xi(),s=Tt(t),a=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return lu(e).j("collectionPathOverlayIndex",a).next(d=>{for(const f of d){const m=Hd(this.serializer,f);r.set(m.getKey(),m)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=xi();let a;const d=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return lu(e).X({index:"collectionGroupOverlayIndex",range:d},(f,m,g)=>{const y=Hd(this.serializer,m);s.size()<r||y.largestBatchId===a?(s.set(y.getKey(),y),a=y.largestBatchId):g.done()}).next(()=>s)}we(e,t){return lu(e).put(function(i,r,s){const[a,d,f]=Mm(r,s.mutation.key);return{userId:r,collectionPath:d,documentId:f,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:cu(i.fe,s.mutation)}}(this.serializer,this.userId,t))}}function lu(n){return Et(n,"documentOverlays")}class Ys{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Je(e.integerValue));else if("doubleValue"in e){const i=Je(e.doubleValue);isNaN(i)?this.ye(t,13):(this.ye(t,15),Fs(i)?t.pe(0):t.pe(i))}else if("timestampValue"in e){const i=e.timestampValue;this.ye(t,20),"string"==typeof i?t.Ie(i):(t.Ie(`${i.seconds||""}`),t.pe(i.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(ii(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.ye(t,45),t.pe(i.latitude||0),t.pe(i.longitude||0)}else"mapValue"in e?qc(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Q()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const i=e.fields||{};this.ye(t,55);for(const r of Object.keys(i))this.Te(r,t),this.me(i[r],t)}Pe(e,t){const i=e.values||[];this.ye(t,50);for(const r of i)this.me(r,t)}ve(e,t){this.ye(t,37),K.fromName(e).path.forEach(i=>{this.ye(t,60),this.be(i,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function Cy(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Um(n){const e=64-function(t){let i=0;for(let r=0;r<8;++r){const s=Cy(255&t[r]);if(i+=s,8!==s)break}return i}(n);return Math.ceil(e/8)}Ys.Ve=new Ys;class xy{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.De(i.value),i=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ne(i.value),i=t.next();this.ke()}Me(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.De(i);else if(i<2048)this.De(960|i>>>6),this.De(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.De(480|i>>>12),this.De(128|63&i>>>6),this.De(128|63&i);else{const r=t.codePointAt(0);this.De(240|r>>>18),this.De(128|63&r>>>12),this.De(128|63&r>>>6),this.De(128|63&r)}}this.Ce()}$e(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ne(i);else if(i<2048)this.Ne(960|i>>>6),this.Ne(128|63&i);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i);else{const r=t.codePointAt(0);this.Ne(240|r>>>18),this.Ne(128|63&r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r)}}this.ke()}Oe(e){const t=this.Fe(e),i=Um(t);this.Be(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Le(e){const t=this.Fe(e),i=Um(t);this.Be(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=0!=(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class Sy{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Ay{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class hu{constructor(){this.je=new xy,this.ze=new Sy(this.je),this.We=new Ay(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class Js{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new Js(this.indexId,this.documentKey,this.arrayValue,i)}}function Pr(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=zm(n.arrayValue,e.arrayValue),0!==t?t:(t=zm(n.directionalValue,e.directionalValue),0!==t?t:K.comparator(n.documentKey,e.documentKey)))}function zm(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(0!==i)return i}return n.length-e.length}class ky{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const i=t;i.isInequality()?this.Ze=i:this.Xe.push(i)}}tn(e){ie(e.collectionGroup===this.collectionId);const t=Pc(e);if(void 0!==t&&!this.en(t))return!1;const i=Yi(e);let r=new Set,s=0,a=0;for(;s<i.length&&this.en(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){const d=i[s];if(!this.nn(this.Ze,d)||!this.sn(this.Ye[a++],d))return!1}++s}for(;s<i.length;++s)if(a>=this.Ye.length||!this.sn(this.Ye[a++],i[s]))return!1;return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Zm(n){var e,t;if(ie(n instanceof ye||n instanceof Oe),n instanceof ye){if(n instanceof x){const r=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>ye.create(n.field,"==",s)))||[];return Oe.create(r,"or")}return n}const i=n.filters.map(r=>Zm(r));return Oe.create(i,n.op)}function Dy(n){if(0===n.getFilters().length)return[];const e=Qd(Zm(n));return ie(Bm(e)),Kd(e)||Wd(e)?[e]:e.getFilters()}function Kd(n){return n instanceof ye}function Wd(n){return n instanceof Oe&&$c(n)}function Bm(n){return Kd(n)||Wd(n)||function(e){if(e instanceof Oe&&Bs(e)){for(const t of e.getFilters())if(!Kd(t)&&!Wd(t))return!1;return!0}return!1}(n)}function Qd(n){if(ie(n instanceof ye||n instanceof Oe),n instanceof ye)return n;if(1===n.filters.length)return Qd(n.filters[0]);const e=n.filters.map(i=>Qd(i));let t=Oe.create(e,n.op);return t=eh(t),Bm(t)?t:(ie(t instanceof Oe),ie(Nr(t)),ie(t.filters.length>1),t.filters.reduce((i,r)=>Yd(i,r)))}function Yd(n,e){let t;return ie(n instanceof ye||n instanceof Oe),ie(e instanceof ye||e instanceof Oe),t=n instanceof ye?e instanceof ye?Oe.create([n,e],"and"):Gm(n,e):e instanceof ye?Gm(e,n):function(i,r){if(ie(i.filters.length>0&&r.filters.length>0),Nr(i)&&Nr(r))return u(i,r.getFilters());const s=Bs(i)?i:r,a=Bs(i)?r:i,d=s.filters.map(f=>Yd(f,a));return Oe.create(d,"or")}(n,e),eh(t)}function Gm(n,e){if(Nr(e))return u(e,n.getFilters());{const t=e.filters.map(i=>Yd(n,i));return Oe.create(t,"or")}}function eh(n){if(ie(n instanceof ye||n instanceof Oe),n instanceof ye)return n;const e=n.getFilters();if(1===e.length)return eh(e[0]);if(ql(n))return n;const t=e.map(r=>eh(r)),i=[];return t.forEach(r=>{r instanceof ye?i.push(r):r instanceof Oe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:Oe.create(i,n.op)}class Oy{constructor(){this.rn=new Jd}addToCollectionParentIndex(e,t){return this.rn.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(Gt.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(Gt.min())}updateCollectionGroup(e,t,i){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}}class Jd{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Le(be.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Le(be.comparator)).toArray()}}const th=new Uint8Array(0);class Ny{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Jd,this.un=new rr(i=>Re(i),(i,r)=>qt(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const s={collectionId:i,parent:Tt(r)};return qm(e).put(s)}return A.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[bl(t),""],!1,!0);return qm(e).j(r).next(s=>{for(const a of s){if(a.collectionId!==t)break;i.push(Dn(a.parent))}return i})}addFieldIndex(e,t){const i=nh(e),r={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])};var a;delete r.indexId;const s=i.add(r);if(t.indexState){const a=fu(e);return s.next(d=>{a.put(Lm(d,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=nh(e),r=fu(e),s=du(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const i=du(e);let r=!0;const s=new Map;return A.forEach(this.cn(t),a=>this.an(e,a).next(d=>{r&&(r=!!d),s.set(a,d)})).next(()=>{if(r){let a=pe();const d=[];return A.forEach(s,(f,m)=>{var g;U("IndexedDbIndexManager",`Using index ${g=f,`id=${g.indexId}|cg=${g.collectionGroup}|f=${g.fields.map(de=>`${de.fieldPath}:${de.kind}`).join(",")}`} to execute ${Re(t)}`);const y=function(de,fe){const Se=Pc(fe);if(void 0===Se)return null;for(const Ie of Gs(de,Se.fieldPath))switch(Ie.op){case"array-contains-any":return Ie.value.arrayValue.values||[];case"array-contains":return[Ie.value]}return null}(m,f),C=function(de,fe){const Se=new Map;for(const Ie of Yi(fe))for(const en of Gs(de,Ie.fieldPath))switch(en.op){case"==":case"in":Se.set(Ie.fieldPath.canonicalString(),en.value);break;case"not-in":case"!=":return Se.set(Ie.fieldPath.canonicalString(),en.value),Array.from(Se.values())}return null}(m,f),N=function(de,fe){const Se=[];let Ie=!0;for(const en of Yi(fe)){const lr=0===en.kind?ya(de,en.fieldPath,de.startAt):Kc(de,en.fieldPath,de.startAt);Se.push(lr.value),Ie&&(Ie=lr.inclusive)}return new at(Se,Ie)}(m,f),Z=function(de,fe){const Se=[];let Ie=!0;for(const en of Yi(fe)){const lr=0===en.kind?Kc(de,en.fieldPath,de.endAt):ya(de,en.fieldPath,de.endAt);Se.push(lr.value),Ie&&(Ie=lr.inclusive)}return new at(Se,Ie)}(m,f),$=this.hn(f,m,N),W=this.hn(f,m,Z),oe=this.ln(f,m,C),ve=this.fn(f.indexId,y,$,N.inclusive,W,Z.inclusive,oe);return A.forEach(ve,de=>i.H(de,t.limit).next(fe=>{fe.forEach(Se=>{const Ie=K.fromSegments(Se.documentKey);a.has(Ie)||(a=a.add(Ie),d.push(Ie))})}))}).next(()=>d)}return A.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Dy(Oe.create(e.filters,"and")).map(i=>J(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,i,r,s,a,d){const f=(null!=t?t.length:1)*Math.max(i.length,s.length),m=f/(null!=t?t.length:1),g=[];for(let y=0;y<f;++y){const C=t?this.dn(t[y/m]):th,N=this.wn(e,C,i[y%m],r),Z=this._n(e,C,s[y%m],a),$=d.map(W=>this.wn(e,C,W,!0));g.push(...this.createRange(N,Z,$))}return g}wn(e,t,i,r){const s=new Js(e,K.empty(),t,i);return r?s:s.Je()}_n(e,t,i,r){const s=new Js(e,K.empty(),t,i);return r?s.Je():s}an(e,t){const i=new ky(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let a=null;for(const d of s)i.tn(d)&&(!a||d.fields.length>a.fields.length)&&(a=d);return a})}getIndexType(e,t){let i=2;const r=this.cn(t);return A.forEach(r,s=>this.an(e,s).next(a=>{a?0!==i&&a.fields.length<function(d){let f=new Le(je.comparator),m=!1;for(const g of d.filters)for(const y of g.getFlattenedFilters())y.field.isKeyField()||("array-contains"===y.op||"array-contains-any"===y.op?m=!0:f=f.add(y.field));for(const g of d.orderBy)g.field.isKeyField()||(f=f.add(g.field));return f.size+(m?1:0)}(s)&&(i=1):i=0})).next(()=>null!==t.limit&&r.length>1&&2===i?1:i)}mn(e,t){const i=new hu;for(const r of Yi(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const a=i.He(r.kind);Ys.Ve._e(s,a)}return i.Qe()}dn(e){const t=new hu;return Ys.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const i=new hu;return Ys.Ve._e(gt(this.databaseId,t),i.He(function(r){const s=Yi(r);return 0===s.length?0:s[s.length-1].kind}(e))),i.Qe()}ln(e,t,i){if(null===i)return[];let r=[];r.push(new hu);let s=0;for(const a of Yi(e)){const d=i[s++];for(const f of r)if(this.yn(t,a.fieldPath)&&Ar(d))r=this.pn(r,a,d);else{const m=f.He(a.kind);Ys.Ve._e(d,m)}}return this.In(r)}hn(e,t,i){return this.ln(e,t,i.position)}In(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Qe();return t}pn(e,t,i){const r=[...e],s=[];for(const a of i.arrayValue.values||[])for(const d of r){const f=new hu;f.seed(d.Qe()),Ys.Ve._e(a,f.He(t.kind)),s.push(f)}return s}yn(e,t){return!!e.filters.find(i=>i instanceof ye&&i.field.isEqual(t)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(e,t){const i=nh(e),r=fu(e);return(t?i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.j()).next(s=>{const a=[];return A.forEach(s,d=>r.get([d.indexId,this.uid]).next(f=>{a.push(function(m,g){const y=g?new Ps(g.sequenceNumber,new Gt(Ws(g.readTime),new K(Dn(g.documentKey)),g.largestBatchId)):Ps.empty(),C=m.fields.map(([N,Z])=>new oa(je.fromServerFormat(N),Z));return new Qi(m.indexId,m.collectionGroup,C,y)}(d,f))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:ce(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=nh(e),s=fu(e);return this.Tn(e).next(a=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(d=>A.forEach(d,f=>s.put(Lm(f.indexId,this.user,a,i)))))}updateIndexEntries(e,t){const i=new Map;return A.forEach(t,(r,s)=>{const a=i.get(r.collectionGroup);return(a?A.resolve(a):this.getFieldIndexes(e,r.collectionGroup)).next(d=>(i.set(r.collectionGroup,d),A.forEach(d,f=>this.En(e,r,f).next(m=>{const g=this.An(s,f);return m.isEqual(g)?A.resolve():this.vn(e,s,f,m,g)}))))})}Rn(e,t,i,r){return du(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(i,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,i,r){return du(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(i,t.key),t.key.path.toArray()])}En(e,t,i){const r=du(e);let s=new Le(Pr);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.gn(i,t)])},(a,d)=>{s=s.add(new Js(i.indexId,t,d.arrayValue,d.directionalValue))}).next(()=>s)}An(e,t){let i=new Le(Pr);const r=this.mn(t,e);if(null==r)return i;const s=Pc(t);if(null!=s){const a=e.data.field(s.fieldPath);if(Ar(a))for(const d of a.arrayValue.values||[])i=i.add(new Js(t.indexId,e.key,this.dn(d),r))}else i=i.add(new Js(t.indexId,e.key,th,r));return i}vn(e,t,i,r,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(d,f,m,g,y){const C=d.getIterator(),N=f.getIterator();let Z=xr(C),$=xr(N);for(;Z||$;){let W=!1,oe=!1;if(Z&&$){const ve=m(Z,$);ve<0?oe=!0:ve>0&&(W=!0)}else null!=Z?oe=!0:W=!0;W?(g($),$=xr(N)):oe?(y(Z),Z=xr(C)):(Z=xr(C),$=xr(N))}}(r,s,Pr,d=>{a.push(this.Rn(e,t,i,d))},d=>{a.push(this.Pn(e,t,i,d))}),A.waitFor(a)}Tn(e){let t=1;return fu(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((a,d)=>Pr(a,d)).filter((a,d,f)=>!d||0!==Pr(a,f[d-1]));const r=[];r.push(e);for(const a of i){const d=Pr(a,e),f=Pr(a,t);if(0===d)r[0]=e.Je();else if(d>0&&f<0)r.push(a),r.push(a.Je());else if(f>0)break}r.push(t);const s=[];for(let a=0;a<r.length;a+=2){if(this.bn(r[a],r[a+1]))return[];s.push(IDBKeyRange.bound([r[a].indexId,this.uid,r[a].arrayValue,r[a].directionalValue,th,[]],[r[a+1].indexId,this.uid,r[a+1].arrayValue,r[a+1].directionalValue,th,[]]))}return s}bn(e,t){return Pr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(jm)}getMinOffset(e,t){return A.mapArray(this.cn(t),i=>this.an(e,i).next(r=>r||Q())).next(jm)}}function qm(n){return Et(n,"collectionParents")}function du(n){return Et(n,"indexEntries")}function nh(n){return Et(n,"indexConfiguration")}function fu(n){return Et(n,"indexState")}function jm(n){ie(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Mc(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Gt(e.readTime,e.documentKey,t)}const $m={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Jt{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Jt(e,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Hm(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let d=0;const f=i.X({range:a},(g,y,C)=>(d++,C.delete()));s.push(f.next(()=>{ie(1===d)}));const m=[];for(const g of t.mutations){const y=Nl(e,g.key.path,t.batchId);s.push(r.delete(y)),m.push(g.key)}return A.waitFor(s).next(()=>m)}function ih(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Q();e=n.noDocument}return JSON.stringify(e).length}Jt.DEFAULT_COLLECTION_PERCENTILE=10,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jt.DEFAULT=new Jt(41943040,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jt.DISABLED=new Jt(-1,0,0);class rh{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Vn={}}static de(e,t,i,r){ie(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new rh(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mr(e).X({index:"userMutationsIndex",range:i},(r,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=xa(e),a=Mr(e);return a.add({}).next(d=>{ie("number"==typeof d);const f=new Ld(d,t,i,r),m=function(C,N,Z){const $=Z.baseMutations.map(oe=>cu(C.fe,oe)),W=Z.mutations.map(oe=>cu(C.fe,oe));return{userId:N,batchId:Z.batchId,localWriteTimeMs:Z.localWriteTime.toMillis(),baseMutations:$,mutations:W}}(this.serializer,this.userId,f),g=[];let y=new Le((C,N)=>ce(C.canonicalString(),N.canonicalString()));for(const C of r){const N=Nl(this.userId,C.key.path,d);y=y.add(C.key.path.popLast()),g.push(a.put(m)),g.push(s.put(N,vd))}return y.forEach(C=>{g.push(this.indexManager.addToCollectionParentIndex(e,C))}),e.addOnCommittedListener(()=>{this.Vn[d]=f.keys()}),A.waitFor(g).next(()=>f)})}lookupMutationBatch(e,t){return Mr(e).get(t).next(i=>i?(ie(i.userId===this.userId),Qs(this.serializer,i)):null)}Sn(e,t){return this.Vn[t]?A.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.Vn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Mr(e).X({index:"userMutationsIndex",range:r},(a,d,f)=>{d.userId===this.userId&&(ie(d.batchId>=i),s=Qs(this.serializer,d)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return Mr(e).X({index:"userMutationsIndex",range:t,reverse:!0},(r,s,a)=>{i=s.batchId,a.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Mr(e).j("userMutationsIndex",t).next(i=>i.map(r=>Qs(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=ca(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return xa(e).X({range:r},(a,d,f)=>{const[m,g,y]=a,C=Dn(g);if(m===this.userId&&t.path.isEqual(C))return Mr(e).get(y).next(N=>{if(!N)throw Q();ie(N.userId===this.userId),s.push(Qs(this.serializer,N))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Le(ce);const r=[];return t.forEach(s=>{const a=ca(this.userId,s.path),d=IDBKeyRange.lowerBound(a),f=xa(e).X({range:d},(m,g,y)=>{const[C,N,Z]=m,$=Dn(N);C===this.userId&&s.path.isEqual($)?i=i.add(Z):y.done()});r.push(f)}),A.waitFor(r).next(()=>this.Dn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=ca(this.userId,i),a=IDBKeyRange.lowerBound(s);let d=new Le(ce);return xa(e).X({range:a},(f,m,g)=>{const[y,C,N]=f,Z=Dn(C);y===this.userId&&i.isPrefixOf(Z)?Z.length===r&&(d=d.add(N)):g.done()}).next(()=>this.Dn(e,d))}Dn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(Mr(e).get(s).next(a=>{if(null===a)throw Q();ie(a.userId===this.userId),i.push(Qs(this.serializer,a))}))}),A.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return Hm(e.ht,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),A.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return A.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return xa(e).X({range:i},(s,a,d)=>{if(s[0]===this.userId){const f=Dn(s[1]);r.push(f)}else d.done()}).next(()=>{ie(0===r.length)})})}containsKey(e,t){return Km(e,this.userId,t)}xn(e){return Wm(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Km(n,e,t){const i=ca(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let a=!1;return xa(n).X({range:s,Y:!0},(d,f,m)=>{const[g,y,C]=d;g===e&&y===r&&(a=!0),m.done()}).next(()=>a)}function Mr(n){return Et(n,"mutations")}function xa(n){return Et(n,"documentMutations")}function Wm(n){return Et(n,"mutationQueues")}class Xs{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Xs(0)}static Mn(){return new Xs(-1)}}class Ry{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const i=new Xs(t.highestTargetId);return t.highestTargetId=i.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>re.fromTimestamp(new Ge(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.$n(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(i=>(i.targetCount+=1,this.Bn(t,i),this.On(e,i))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Sa(e).delete(t.targetId)).next(()=>this.$n(e)).next(i=>(ie(i.targetCount>0),i.targetCount-=1,this.On(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return Sa(e).X((a,d)=>{const f=uu(d);f.sequenceNumber<=t&&null===i.get(f.targetId)&&(r++,s.push(this.removeTargetData(e,f)))}).next(()=>A.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Sa(e).X((i,r)=>{const s=uu(r);t(s)})}$n(e){return Qm(e).get("targetGlobalKey").next(t=>(ie(null!==t),t))}On(e,t){return Qm(e).put("targetGlobalKey",t)}Fn(e,t){return Sa(e).put(Pm(this.serializer,t))}Bn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Re(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return Sa(e).X({range:r,index:"queryTargetsIndex"},(a,d,f)=>{const m=uu(d);qt(t,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=Lr(e);return t.forEach(a=>{const d=Tt(a.path);r.push(s.put({targetId:i,path:d})),r.push(this.referenceDelegate.addReference(e,i,a))}),A.waitFor(r)}removeMatchingKeys(e,t,i){const r=Lr(e);return A.forEach(t,s=>{const a=Tt(s.path);return A.waitFor([r.delete([i,a]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=Lr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Lr(e);let s=pe();return r.X({range:i,Y:!0},(a,d,f)=>{const m=Dn(a[1]),g=new K(m);s=s.add(g)}).next(()=>s)}containsKey(e,t){const i=Tt(t.path),r=IDBKeyRange.bound([i],[bl(i)],!1,!0);let s=0;return Lr(e).X({index:"documentTargetsIndex",Y:!0,range:r},([a,d],f,m)=>{0!==a&&(s++,m.done())}).next(()=>s>0)}le(e,t){return Sa(e).get(t).next(i=>i?uu(i):null)}}function Sa(n){return Et(n,"targets")}function Qm(n){return Et(n,"targetGlobal")}function Lr(n){return Et(n,"targetDocuments")}function Ym([n,e],[t,i]){const r=ce(n,t);return 0===r?ce(e,i):r}class Py{constructor(e){this.Ln=e,this.buffer=new Le(Ym),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Ym(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Jm{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,S.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(i){vi(i)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield yi(i)}yield t.Qn(3e5)}))}}class My{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return A.resolve(rn.ct);const i=new Py(t);return this.jn.forEachTarget(e,r=>i.Kn(r.sequenceNumber)).next(()=>this.jn.Wn(e,r=>i.Kn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve($m)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$m):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let i,r,s,a,d,f,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),r=this.params.maximumSequenceNumbersToCollect):r=y,a=Date.now(),this.nthSequenceNumber(e,r))).next(y=>(i=y,d=Date.now(),this.removeTargets(e,i,t))).next(y=>(s=y,f=Date.now(),this.removeOrphanedDocuments(e,i))).next(y=>(m=Date.now(),Ac()<=Te.in.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-g}ms\n\tDetermined least recently used ${r} in `+(d-a)+`ms\n\tRemoved ${s} targets in `+(f-d)+`ms\n\tRemoved ${y} documents in `+(m-f)+`ms\nTotal Duration: ${m-g}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:y})))}}class Ly{constructor(e,t){this.db=e,this.garbageCollector=function Xm(n,e){return new My(n,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Jn(e){let t=0;return this.Wn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(i,r)=>t(r))}addReference(e,t,i){return sh(e,i)}removeReference(e,t,i){return sh(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return sh(e,t)}Xn(e,t){return function(i,r){let s=!1;return Wm(i).Z(a=>Km(i,a,r).next(d=>(d&&(s=!0),A.resolve(!d)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Yn(e,(a,d)=>{if(d<=t){const f=this.Xn(e,a).next(m=>{if(!m)return s++,i.getEntry(e,a).next(()=>(i.removeEntry(a,re.min()),Lr(e).delete([0,Tt(a.path)])))});r.push(f)}}).next(()=>A.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return sh(e,t)}Yn(e,t){const i=Lr(e);let r,s=rn.ct;return i.X({index:"documentTargetsIndex"},([a,d],{path:f,sequenceNumber:m})=>{0===a?(s!==rn.ct&&t(new K(Dn(r)),s),s=m,r=f):s=rn.ct}).next(()=>{s!==rn.ct&&t(new K(Dn(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sh(n,e){return Lr(n).put((i=n.currentSequenceNumber,{targetId:0,path:Tt(e.path),sequenceNumber:i}));var i}class eg{constructor(){this.changes=new rr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ze.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?A.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Fy{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return eo(e).put(i)}removeEntry(e,t,i){return eo(e).delete(function(r,s){const a=r.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Jl(s),a[a.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Zn(e,i)))}getEntry(e,t){let i=Ze.newInvalidDocument(t);return eo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(pu(t))},(r,s)=>{i=this.ts(t,s)}).next(()=>i)}es(e,t){let i={size:0,document:Ze.newInvalidDocument(t)};return eo(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(pu(t))},(r,s)=>{i={document:this.ts(t,s),size:ih(s)}}).next(()=>i)}getEntries(e,t){let i=yn();return this.ns(e,t,(r,s)=>{const a=this.ts(r,s);i=i.insert(r,a)}).next(()=>i)}ss(e,t){let i=yn(),r=new ze(K.comparator);return this.ns(e,t,(s,a)=>{const d=this.ts(s,a);i=i.insert(s,d),r=r.insert(s,ih(a))}).next(()=>({documents:i,rs:r}))}ns(e,t,i){if(t.isEmpty())return A.resolve();let r=new Le(rg);t.forEach(f=>r=r.add(f));const s=IDBKeyRange.bound(pu(r.first()),pu(r.last())),a=r.getIterator();let d=a.getNext();return eo(e).X({index:"documentKeyIndex",range:s},(f,m,g)=>{const y=K.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&rg(d,y)<0;)i(d,null),d=a.getNext();d&&d.isEqual(y)&&(i(d,m),d=a.hasNext()?a.getNext():null),d?g.G(pu(d)):g.done()}).next(()=>{for(;d;)i(d,null),d=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,i,r){const s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Jl(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],d=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return eo(e).j(IDBKeyRange.bound(a,d,!0)).next(f=>{let m=yn();for(const g of f){const y=this.ts(K.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);y.isFoundDocument()&&(Jc(t,y)||r.has(y.key))&&(m=m.insert(y.key,y))}return m})}getAllFromCollectionGroup(e,t,i,r){let s=yn();const a=ig(t,i),d=ig(t,Gt.max());return eo(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,d,!0)},(f,m,g)=>{const y=this.ts(K.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(y.key,y),s.size===r&&g.done()}).next(()=>s)}newChangeBuffer(e){return new Vy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ng(e).get("remoteDocumentGlobalKey").next(t=>(ie(!!t),t))}Zn(e,t){return ng(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const i=function Ey(n,e){let t;if(e.document)t=xm(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=K.fromSegments(e.noDocument.path),r=Ws(e.noDocument.readTime);t=Ze.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const i=K.fromSegments(e.unknownDocument.path),r=Ws(e.unknownDocument.version);t=Ze.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(i){const r=new Ge(i[0],i[1]);return re.fromTimestamp(r)}(e.readTime)),t}(this.serializer,t);if(!i.isNoDocument()||!i.version.isEqual(re.min()))return i}return Ze.newInvalidDocument(e)}}function tg(n){return new Fy(n)}class Vy extends eg{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new rr(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new Le((s,a)=>ce(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const d=this.us.get(s);if(t.push(this.os.removeEntry(e,s,d.readTime)),a.isValidDocument()){const f=Rm(this.os.serializer,a);r=r.add(s.path.popLast());const m=ih(f);i+=m-d.size,t.push(this.os.addEntry(e,s,f))}else if(i-=d.size,this.trackRemovals){const f=Rm(this.os.serializer,a.convertToNoDocument(re.min()));t.push(this.os.addEntry(e,s,f))}}),r.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,i)),A.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(i=>(this.us.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:i,rs:r})=>(r.forEach((s,a)=>{this.us.set(s,{size:a,readTime:i.get(s).readTime})}),i))}}function ng(n){return Et(n,"remoteDocumentGlobal")}function eo(n){return Et(n,"remoteDocumentsV14")}function pu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ig(n,e){const t=e.documentKey.path.toArray();return[n,Jl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function rg(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=ce(t[s],i[s]),r)return r;return r=ce(t.length,i.length),r||(r=ce(t[t.length-2],i[i.length-2]),r||ce(t[t.length-1],i[i.length-1]))}class Uy{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class sg{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(null!==i&&nu(i.mutation,r,Ot.empty(),Ge.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,pe()).next(()=>i))}getLocalViewOfDocuments(e,t,i=pe()){const r=xi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let a=Xc();return s.forEach((d,f)=>{a=a.insert(d,f.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const i=xi();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,pe()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,d)=>{t.set(a,d)})})}computeViews(e,t,i,r){let s=yn();const a=eu(),d=eu();return t.forEach((f,m)=>{const g=i.get(m.key);r.has(m.key)&&(void 0===g||g.mutation instanceof sr)?s=s.insert(m.key,m):void 0!==g?(a.set(m.key,g.mutation.getFieldMask()),nu(g.mutation,m,g.mutation.getFieldMask(),Ge.now())):a.set(m.key,Ot.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,g)=>a.set(m,g)),t.forEach((m,g)=>{var y;return d.set(m,new Uy(g,null!==(y=a.get(m))&&void 0!==y?y:null))}),d))}recalculateAndSaveOverlays(e,t){const i=eu();let r=new ze((a,d)=>a-d),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const d of a)d.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let g=i.get(f)||Ot.empty();g=d.applyToLocalView(m,g),i.set(f,g);const y=(r.get(d.batchId)||pe()).add(f);r=r.insert(d.batchId,y)})}).next(()=>{const a=[],d=r.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,g=f.value,y=Yp();g.forEach(C=>{if(!s.has(C)){const N=om(t.get(C),i.get(C));null!==N&&y.set(C,N),s=s.add(C)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,y))}return A.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i){return K.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Qc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i):this.getDocumentsMatchingCollectionQuery(e,t,i);var r}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):A.resolve(xi());let d=-1,f=s;return a.next(m=>A.forEach(m,(g,y)=>(d<y.largestBatchId&&(d=y.largestBatchId),s.get(g)?A.resolve():this.remoteDocumentCache.getEntry(e,g).next(C=>{f=f.insert(g,C)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,pe())).next(g=>({batchId:d,changes:Qp(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(i=>{let r=Xc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i){const r=t.collectionGroup;let s=Xc();return this.indexManager.getCollectionParents(e,r).next(a=>A.forEach(a,d=>{const f=(m=t,g=d.child(r),new Un(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,g;return this.getDocumentsMatchingCollectionQuery(e,f,i).next(m=>{m.forEach((g,y)=>{s=s.insert(g,y)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r))).next(s=>{r.forEach((d,f)=>{const m=f.getKey();null===s.get(m)&&(s=s.insert(m,Ze.newInvalidDocument(m)))});let a=Xc();return s.forEach((d,f)=>{const m=r.get(d);void 0!==m&&nu(m.mutation,f,Ot.empty(),Ge.now()),Jc(t,f)&&(a=a.insert(d,f))}),a})}}class zy{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return A.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var i;return this.cs.set(t.id,{id:(i=t).id,version:i.version,createTime:_t(i.createTime)}),A.resolve()}getNamedQuery(e,t){return A.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(i=t).name,query:$d(i.bundledQuery),readTime:_t(i.readTime)}),A.resolve();var i}}class Zy{constructor(){this.overlays=new ze(K.comparator),this.ls=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){const i=xi();return A.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.we(e,t,s)}),A.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.ls.get(i);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(i)),A.resolve()}getOverlaysForCollection(e,t,i){const r=xi(),s=t.length+1,a=new K(t.child("")),d=this.overlays.getIteratorFrom(a);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>i&&r.set(f.getKey(),f)}return A.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ze((m,g)=>m-g);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let g=s.get(m.largestBatchId);null===g&&(g=xi(),s=s.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=xi(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,g)=>d.set(m,g)),!(d.size()>=r)););return A.resolve(d)}we(e,t,i){const r=this.overlays.get(i.key);if(null!==r){const a=this.ls.get(r.largestBatchId).delete(i.key);this.ls.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new Vd(t,i));let s=this.ls.get(t);void 0===s&&(s=pe(),this.ls.set(t,s)),this.ls.set(t,s.add(i.key))}}class Xd{constructor(){this.fs=new Le(Vt.ds),this.ws=new Le(Vt._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const i=new Vt(e,t);this.fs=this.fs.add(i),this.ws=this.ws.add(i)}gs(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.ys(new Vt(e,t))}ps(e,t){e.forEach(i=>this.removeReference(i,t))}Is(e){const t=new K(new be([])),i=new Vt(t,e),r=new Vt(t,e+1),s=[];return this.ws.forEachInRange([i,r],a=>{this.ys(a),s.push(a.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new K(new be([])),i=new Vt(t,e),r=new Vt(t,e+1);let s=pe();return this.ws.forEachInRange([i,r],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Vt(e,0),i=this.fs.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class Vt{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return K.comparator(e.key,t.key)||ce(e.As,t.As)}static _s(e,t){return ce(e.As,t.As)||K.comparator(e.key,t.key)}}class By{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Le(Vt.ds)}checkEmpty(e){return A.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,i,r){const s=this.vs;this.vs++;const a=new Ld(s,t,i,r);this.mutationQueue.push(a);for(const d of r)this.Rs=this.Rs.add(new Vt(d.key,s)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return A.resolve(a)}lookupMutationBatch(e,t){return A.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.bs(t+1),s=r<0?0:r;return A.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Vt(t,0),r=new Vt(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([i,r],a=>{const d=this.Ps(a.As);s.push(d)}),A.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Le(ce);return t.forEach(r=>{const s=new Vt(r,0),a=new Vt(r,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,a],d=>{i=i.add(d.As)})}),A.resolve(this.Vs(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;K.isDocumentKey(s)||(s=s.child(""));const a=new Vt(new K(s),0);let d=new Le(ce);return this.Rs.forEachWhile(f=>{const m=f.key.path;return!!i.isPrefixOf(m)&&(m.length===r&&(d=d.add(f.As)),!0)},a),A.resolve(this.Vs(d))}Vs(e){const t=[];return e.forEach(i=>{const r=this.Ps(i);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){ie(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let i=this.Rs;return A.forEach(t.mutations,r=>{const s=new Vt(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=i})}Cn(e){}containsKey(e,t){const i=new Vt(t,0),r=this.Rs.firstAfterOrEqual(i);return A.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return A.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Gy{constructor(e){this.Ds=e,this.docs=new ze(K.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,a=this.Ds(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return A.resolve(i?i.document.mutableCopy():Ze.newInvalidDocument(t))}getEntries(e,t){let i=yn();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ze.newInvalidDocument(r))}),A.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=yn();const a=t.path,d=new K(a.child("")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:m,value:{document:g}}=f.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||Mc(xl(g),i)<=0||(r.has(g.key)||Jc(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return A.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Q()}Cs(e,t){return A.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new qy(this)}getSize(e){return A.resolve(this.size)}}class qy extends eg{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(i)}),A.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class jy{constructor(e){this.persistence=e,this.xs=new rr(t=>Re(t),qt),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Xd,this.targetCount=0,this.Ms=Xs.kn()}forEachTarget(e,t){return this.xs.forEach((i,r)=>t(r)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Ns&&(this.Ns=t),A.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Xs(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.Fn(t),A.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.xs.forEach((a,d)=>{d.sequenceNumber<=t&&null===i.get(d.targetId)&&(this.xs.delete(a),s.push(this.removeMatchingKeysForTargetId(e,d.targetId)),r++)}),A.waitFor(s).next(()=>r)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){const i=this.xs.get(t)||null;return A.resolve(i)}addMatchingKeys(e,t,i){return this.ks.gs(t,i),A.resolve()}removeMatchingKeys(e,t,i){this.ks.ps(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),A.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),A.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ks.Es(t);return A.resolve(i)}containsKey(e,t){return A.resolve(this.ks.containsKey(t))}}class ef{constructor(e,t){this.$s={},this.overlays={},this.Os=new rn(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new jy(this),this.indexManager=new Oy,this.remoteDocumentCache=new Gy(i=>this.referenceDelegate.Ls(i)),this.serializer=new Nm(t),this.qs=new zy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Zy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.$s[e.toKey()];return i||(i=new By(t,this.referenceDelegate),this.$s[e.toKey()]=i),i}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,i){U("MemoryPersistence","Starting transaction:",e);const r=new $y(this.Os.next());return this.referenceDelegate.Us(),i(r).next(s=>this.referenceDelegate.Ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gs(e,t){return A.or(Object.values(this.$s).map(i=>()=>i.containsKey(e,t)))}}class $y extends Al{constructor(e){super(),this.currentSequenceNumber=e}}class oh{constructor(e){this.persistence=e,this.Qs=new Xd,this.js=null}static zs(e){return new oh(e)}get Ws(){if(this.js)return this.js;throw Q()}addReference(e,t,i){return this.Qs.addReference(i,t),this.Ws.delete(i.toString()),A.resolve()}removeReference(e,t,i){return this.Qs.removeReference(i,t),this.Ws.add(i.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),A.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(r=>this.Ws.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Ws.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Ws,i=>{const r=K.fromPath(i);return this.Hs(e,r).next(s=>{s||t.removeEntry(r,re.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(i=>{i?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return A.or([()=>A.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Hy{constructor(e){this.serializer=e}O(e,t,i,r){const s=new aa("createOrUpgrade",t);var d;i<1&&r>=1&&(e.createObjectStore("owner"),(d=e).createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Vc,{unique:!0}),d.createObjectStore("documentMutations"),og(e),function(d){d.createObjectStore("remoteDocuments")}(e));let a=A.resolve();return i<3&&r>=3&&(0!==i&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),og(e)),a=a.next(()=>function(d){const f=d.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",m)}(s))),i<4&&r>=4&&(0!==i&&(a=a.next(()=>function(d,f){return f.store("mutations").j().next(m=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Vc,{unique:!0});const g=f.store("mutations"),y=m.map(C=>g.put(C));return A.waitFor(y)})}(e,s))),a=a.next(()=>{!function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),i<5&&r>=5&&(a=a.next(()=>this.Ys(s))),i<6&&r>=6&&(a=a.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),i<7&&r>=7&&(a=a.next(()=>this.Zs(s))),i<8&&r>=8&&(a=a.next(()=>this.ti(e,s))),i<9&&r>=9&&(a=a.next(()=>{!function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")}(e)})),i<10&&r>=10&&(a=a.next(()=>this.ei(s))),i<11&&r>=11&&(a=a.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(a=a.next(()=>{!function(d){const f=d.createObjectStore("documentOverlays",{keyPath:xd});f.createIndex("collectionPathOverlayIndex",Sd,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",Zc,{unique:!1})}(e)})),i<13&&r>=13&&(a=a.next(()=>function(d){const f=d.createObjectStore("remoteDocumentsV14",{keyPath:Id});f.createIndex("documentKeyIndex",wd),f.createIndex("collectionGroupIndex",Rl)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(a=a.next(()=>this.si(e,s))),i<15&&r>=15&&(a=a.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:bd}).createIndex("sequenceNumberIndex",Uc,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:Cd}).createIndex("documentKeyIndex",zc,{unique:!1})}(e))),a}Xs(e){let t=0;return e.store("remoteDocuments").X((i,r)=>{t+=ih(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Ys(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.j().next(r=>A.forEach(r,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.j("userMutationsIndex",a).next(d=>A.forEach(d,f=>{ie(f.userId===s.userId);const m=Qs(this.serializer,f);return Hm(e,s.userId,m).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.X((a,d)=>{const f=new be(a),m=[0,Tt(f)];s.push(t.get(m).next(g=>g?A.resolve():t.put({targetId:0,path:Tt(f),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>A.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Ed});const i=t.store("collectionParents"),r=new Jd,s=a=>{if(r.add(a)){const d=a.lastSegment(),f=a.popLast();return i.put({collectionId:d,parent:Tt(f)})}};return t.store("remoteDocuments").X({Y:!0},(a,d)=>{const f=new be(a);return s(f.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([a,d,f],m)=>{const g=Dn(d);return s(g.popLast())}))}ei(e){const t=e.store("targets");return t.X((i,r)=>{const s=uu(r),a=Pm(this.serializer,s);return t.put(a)})}ni(e,t){const i=t.store("remoteDocuments"),r=[];return i.X((s,a)=>{const d=t.store("remoteDocumentsV14"),f=(m=a,m.document?new K(be.fromString(m.document.name).popFirst(5)):m.noDocument?K.fromSegments(m.noDocument.path):m.unknownDocument?K.fromSegments(m.unknownDocument.path):Q()).path.toArray();var m;const g={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};r.push(d.put(g))}).next(()=>A.waitFor(r))}si(e,t){const i=t.store("mutations"),r=tg(this.serializer),s=new ef(oh.zs,this.serializer.fe);return i.j().next(a=>{const d=new Map;return a.forEach(f=>{var m;let g=null!==(m=d.get(f.userId))&&void 0!==m?m:pe();Qs(this.serializer,f).keys().forEach(y=>g=g.add(y)),d.set(f.userId,g)}),A.forEach(d,(f,m)=>{const g=new lt(m),y=Xl.de(this.serializer,g),C=s.getIndexManager(g),N=rh.de(g,this.serializer,C,s.referenceDelegate);return new sg(r,N,y,C).recalculateAndSaveOverlaysForDocumentKeys(new Bc(t,rn.ct),f).next()})})}}function og(n){n.createObjectStore("targetDocuments",{keyPath:jp}).createIndex("documentTargetsIndex",Xi,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Td,{unique:!0}),n.createObjectStore("targetGlobal")}const tf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class nf{constructor(e,t,i,r,s,a,d,f,m,g,y=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ii=s,this.window=a,this.document=d,this.ri=m,this.oi=g,this.ui=y,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=C=>Promise.resolve(),!nf.D())throw new L(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ly(this,r),this.di=t+"main",this.serializer=new Nm(f),this.wi=new kn(this.di,this.ui,new Hy(this.serializer)),this.Bs=new Ry(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tg(this.serializer),this.qs=new by,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===g&&Ye("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(O.FAILED_PRECONDITION,tf);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new rn(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var t=this;return this.fi=function(){var i=(0,S.Z)(function*(r){if(t.started)return e(r)});return function(r){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(function(){var t=(0,S.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,S.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ch(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(vi(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return mu(e).get("owner").next(t=>A.resolve(this.Ri(t)))}Pi(e){return ch(e).delete(this.clientId)}bi(){var e=this;return(0,S.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=Et(i,"clientMetadata");return r.j().next(s=>{const a=e.Si(s,18e5),d=s.filter(f=>-1===a.indexOf(f));return A.forEach(d,f=>r.delete(f.clientId)).next(()=>d)})}).catch(()=>[]);if(e._i)for(const i of t)e._i.removeItem(e.Di(i.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?A.resolve(!0):mu(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new L(O.FAILED_PRECONDITION,tf);return!1}}return!(!this.networkEnabled||!this.inForeground)||ch(e).j().next(i=>void 0===this.Si(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,S.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const i=new Bc(t,rn.ct);return e.Ai(i).next(()=>e.Pi(i))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(i=>this.Vi(i.updateTimeMs,t)&&!this.Ci(i.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>ch(e).j().next(t=>this.Si(t,18e5).map(i=>i.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return rh.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ny(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Xl.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,i){U("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(a=this.ui)?kd:14===a?Ml:13===a?ua:12===a?Ad:11===a?Pl:void Q();var a;let d;return this.wi.runTransaction(e,r,s,f=>(d=new Bc(f,this.Os?this.Os.next():rn.ct),"readwrite-primary"===t?this.Ti(d).next(m=>!!m||this.Ei(d)).next(m=>{if(!m)throw Ye(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new L(O.FAILED_PRECONDITION,Sl);return i(d)}).next(m=>this.vi(d).next(()=>m)):this.Oi(d).next(()=>i(d)))).then(f=>(d.raiseOnCommittedEvent(),f))}Oi(e){return mu(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new L(O.FAILED_PRECONDITION,tf)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return mu(e).put("owner",t)}static D(){return kn.D()}Ai(e){const t=mu(e);return t.get("owner").next(i=>this.Ri(i)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):A.resolve())}Vi(e,t){const i=Date.now();return!(e<i-t||e>i&&(Ye(`Detected an update time that is in the future: ${e} > ${i}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,he.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const i=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return U("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Ye("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Ye("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function mu(n){return Et(n,"owner")}function ch(n){return Et(n,"clientMetadata")}function rf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class sf{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Fi=i,this.Bi=r}static Li(e,t){let i=pe(),r=pe();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new sf(e,t.fromCache,i,r)}}class ag{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,i,r){return this.Ki(e,t).next(s=>s||this.Gi(e,t,r,i)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(Wc(t))return A.resolve(null);let i=jt(t);return this.indexManager.getIndexType(e,i).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=$l(t,null,"F"),i=jt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const a=pe(...s);return this.Ui.getDocuments(e,a).next(d=>this.indexManager.getMinOffset(e,i).next(f=>{const m=this.ji(t,d);return this.zi(t,m,a,f.readTime)?this.Ki(e,$l(t,null,"F")):this.Wi(e,m,t,f)}))})))}Gi(e,t,i,r){return Wc(t)||r.isEqual(re.min())?this.Qi(e,t):this.Ui.getDocuments(e,i).next(s=>{const a=this.ji(t,s);return this.zi(t,a,i,r)?this.Qi(e,t):(Ac()<=Te.in.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Rd(t)),this.Wi(e,a,t,Cl(r,-1)))})}ji(e,t){let i=new Le(Kp(e));return t.forEach((r,s)=>{Jc(e,s)&&(i=i.add(s))}),i}zi(e,t,i,r){if(null===e.limit)return!1;if(i.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,t){return Ac()<=Te.in.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Rd(t)),this.Ui.getDocumentsMatchingQuery(e,t,Gt.min())}Wi(e,t,i,r){return this.Ui.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class Ky{constructor(e,t,i,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new ze(ce),this.Yi=new rr(s=>Re(s),qt),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(i)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sg(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function cg(n,e,t,i){return new Ky(n,e,t,i)}function ug(n,e){return of.apply(this,arguments)}function of(){return of=(0,S.Z)(function*(n,e){const t=H(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.tr(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],d=[];let f=pe();for(const m of r){a.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}for(const m of s){d.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(i,f).next(m=>({er:m,removedBatchIds:a,addedBatchIds:d}))})})}),of.apply(this,arguments)}function lg(n){const e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function hg(n,e,t){let i=pe(),r=pe();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let a=yn();return t.forEach((d,f)=>{const m=s.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(r=r.add(d)),f.isNoDocument()&&f.version.isEqual(re.min())?(e.removeEntry(d,f.readTime),a=a.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),a=a.insert(d,f)):U("LocalStore","Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)}),{nr:a,sr:r}})}function Yy(n,e){const t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Aa(n,e){const t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Bs.getTargetData(i,e).next(s=>s?(r=s,A.resolve(r)):t.Bs.allocateTargetId(i).next(a=>(r=new or(e,a,"TargetPurposeListen",i.currentSequenceNumber),t.Bs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.Ji.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(i.targetId,i),t.Yi.set(e,i.targetId)),i})}function ka(n,e,t){return af.apply(this,arguments)}function af(){return af=(0,S.Z)(function*(n,e,t){const i=H(n),r=i.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!vi(a))throw a;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}i.Ji=i.Ji.remove(e),i.Yi.delete(r.target)}),af.apply(this,arguments)}function uh(n,e,t){const i=H(n);let r=re.min(),s=pe();return i.persistence.runTransaction("Execute query","readonly",a=>function(d,f,m){const g=H(d),y=g.Yi.get(m);return void 0!==y?A.resolve(g.Ji.get(y)):g.Bs.getTargetData(f,m)}(i,a,jt(e)).next(d=>{if(d)return r=d.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(a,d.targetId).next(f=>{s=f})}).next(()=>i.Hi.getDocumentsMatchingQuery(a,e,t?r:re.min(),t?s:pe())).next(d=>(pg(i,Hp(e),d),{documents:d,ir:s})))}function dg(n,e){const t=H(n),i=H(t.Bs),r=t.Ji.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.le(s,e).next(a=>a?a.target:null))}function fg(n,e){const t=H(n),i=t.Xi.get(e)||re.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Zi.getAllFromCollectionGroup(r,e,Cl(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(pg(t,e,r),r))}function pg(n,e,t){let i=n.Xi.get(e)||re.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Xi.set(e,i)}function cf(){return cf=(0,S.Z)(function*(n,e,t,i){const r=H(n);let s=pe(),a=yn();for(const m of t){const g=e.rr(m.metadata.name);m.document&&(s=s.add(g));const y=e.ur(m);y.setReadTime(e.cr(m.metadata.readTime)),a=a.insert(g,y)}const d=r.Zi.newChangeBuffer({trackRemovals:!0}),f=yield Aa(r,(m=i,jt(ir(be.fromString(`__bundle__/docs/${m}`)))));var m;return r.persistence.runTransaction("Apply bundle documents","readwrite",m=>hg(m,d,a).next(g=>(d.apply(m),g)).next(g=>r.Bs.removeMatchingKeysForTargetId(m,f.targetId).next(()=>r.Bs.addMatchingKeys(m,s,f.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(m,g.nr,g.sr)).next(()=>g.nr)))}),cf.apply(this,arguments)}function Xy(n,e){return uf.apply(this,arguments)}function uf(){return uf=(0,S.Z)(function*(n,e,t=pe()){const i=yield Aa(n,jt($d(e.bundledQuery))),r=H(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const a=_t(e.readTime);if(i.snapshotVersion.compareTo(a)>=0)return r.qs.saveNamedQuery(s,e);const d=i.withResumeToken(mt.EMPTY_BYTE_STRING,a);return r.Ji=r.Ji.insert(d.targetId,d),r.Bs.updateTargetData(s,d).next(()=>r.Bs.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Bs.addMatchingKeys(s,t,i.targetId)).next(()=>r.qs.saveNamedQuery(s,e))})}),uf.apply(this,arguments)}function mg(n,e){return`firestore_clients_${n}_${e}`}function gg(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function lf(n,e){return`firestore_targets_${n}_${e}`}class lh{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static ar(e,t,i){const r=JSON.parse(i);let s,a="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(s=new L(r.error.code,r.error.message))),a?new lh(e,t,r.state,s):(Ye("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gu{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static ar(e,t){const i=JSON.parse(t);let r,s="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return s&&i.error&&(s="string"==typeof i.error.message&&"string"==typeof i.error.code,s&&(r=new L(i.error.code,i.error.message))),s?new gu(e,i.state,r):(Ye("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const i=JSON.parse(t);let r="object"==typeof i&&i.activeTargetIds instanceof Array,s=Pd();for(let a=0;r&&a<i.activeTargetIds.length;++a)r=yd(i.activeTargetIds[a]),s=s.add(i.activeTargetIds[a]);return r?new hh(e,s):(Ye("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class hf{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new hf(t.clientId,t.onlineState):(Ye("SharedClientState",`Failed to parse online state: ${e}`),null)}}class df{constructor(){this.activeTargetIds=Pd()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ff{constructor(e,t,i,r,s){this.window=e,this.ii=t,this.persistenceKey=i,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new ze(ce),this.started=!1,this.yr=[];const a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=mg(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new df),this.Tr=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.vr=`firestore_online_state_${this.persistenceKey}`,this.Rr=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,S.Z)(function*(){const t=yield e.syncEngine.$i();for(const r of t){if(r===e.wr)continue;const s=e.getItem(mg(e.persistenceKey,r));if(s){const a=hh.ar(r,s);a&&(e.gr=e.gr.insert(a.clientId,a))}}e.Pr();const i=e.storage.getItem(e.vr);if(i){const r=e.br(i);r&&e.Vr(r)}for(const r of e.yr)e.mr(r);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,i){this.Dr(e,t,i),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(lf(this.persistenceKey,e));if(i){const r=gu.ar(e,i);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(lf(this.persistenceKey,e))}updateQueryState(e,t,i){this.kr(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Cr(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const i=e;if(i.storageArea===this.storage){if(U("SharedClientState","EVENT",i.key,i.newValue),i.key===this.pr)return void Ye("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,S.Z)(function*(){if(t.started){if(null!==i.key)if(t.Tr.test(i.key)){if(null==i.newValue){const r=t.Or(i.key);return t.Fr(r,null)}{const r=t.Br(i.key,i.newValue);if(r)return t.Fr(r.clientId,r)}}else if(t.Er.test(i.key)){if(null!==i.newValue){const r=t.Lr(i.key,i.newValue);if(r)return t.qr(r)}}else if(t.Ar.test(i.key)){if(null!==i.newValue){const r=t.Ur(i.key,i.newValue);if(r)return t.Kr(r)}}else if(i.key===t.vr){if(null!==i.newValue){const r=t.br(i.newValue);if(r)return t.Vr(r)}}else if(i.key===t.Ir){const r=function(s){let a=rn.ct;if(null!=s)try{const d=JSON.parse(s);ie("number"==typeof d),a=d}catch(d){Ye("SharedClientState","Failed to read sequence number from WebStorage",d)}return a}(i.newValue);r!==rn.ct&&t.sequenceNumberHandler(r)}else if(i.key===t.Rr){const r=t.Gr(i.newValue);yield Promise.all(r.map(s=>t.syncEngine.Qr(s)))}}else t.yr.push(i)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,i){const r=new lh(this.currentUser,e,t,i),s=gg(this.persistenceKey,this.currentUser,e);this.setItem(s,r.hr())}Cr(e){const t=gg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,i){const r=lf(this.persistenceKey,e),s=new gu(e,t,i);this.setItem(r,s.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const i=this.Or(e);return hh.ar(i,t)}Lr(e,t){const i=this.Er.exec(e),r=Number(i[1]);return lh.ar(new lt(void 0!==i[2]?i[2]:null),r,t)}Ur(e,t){const i=this.Ar.exec(e),r=Number(i[1]);return gu.ar(r,t)}br(e){return hf.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,S.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const i=t?this.gr.insert(e,t):this.gr.remove(e),r=this.Sr(this.gr),s=this.Sr(i),a=[],d=[];return s.forEach(f=>{r.has(f)||a.push(f)}),r.forEach(f=>{s.has(f)||d.push(f)}),this.syncEngine.Wr(a,d).then(()=>{this.gr=i})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=Pd();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class _g{constructor(){this.Hr=new df,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,i){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new df,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class e0{Yr(e){}shutdown(){}}class yg{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let dh=null;function pf(){return null===dh?dh=268435456+Math.round(2147483648*Math.random()):dh++,"0x"+dh.toString(16)}const t0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class n0{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Xt="WebChannelConnection";class r0 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,i,r,s){const a=pf(),d=this.To(e,t);U("RestConnection",`Sending RPC '${e}' ${a}:`,d,i);const f={};return this.Eo(f,r,s),this.Ao(e,d,f,i).then(m=>(U("RestConnection",`Received RPC '${e}' ${a}: `,m),m),m=>{throw _n("RestConnection",`RPC '${e}' ${a} failed with error: `,m,"url: ",d,"request:",i),m})}vo(e,t,i,r,s,a){return this.Io(e,t,i,r,s)}Eo(e,t,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+gi,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}To(e,t){return`${this.mo}/v1/${t}:${t0[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,i,r){const s=pf();return new Promise((a,d)=>{const f=new ld;f.setWithCredentials(!0),f.listenOnce(ud.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Ns.NO_ERROR:const g=f.getResponseJson();U(Xt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),a(g);break;case Ns.TIMEOUT:U(Xt,`RPC '${e}' ${s} timed out`),d(new L(O.DEADLINE_EXCEEDED,"Request time out"));break;case Ns.HTTP_ERROR:const y=f.getStatus();if(U(Xt,`RPC '${e}' ${s} failed with status:`,y,"response text:",f.getResponseText()),y>0){let C=f.getResponseJson();Array.isArray(C)&&(C=C[0]);const N=C?.error;if(N&&N.status&&N.message){const Z=function($){const W=$.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(W)>=0?W:O.UNKNOWN}(N.status);d(new L(Z,N.message))}else d(new L(O.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new L(O.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{U(Xt,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(r);U(Xt,`RPC '${e}' ${s} sending request:`,r),f.send(t,"POST",m,i,15)})}Ro(e,t,i){const r=pf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ad(),d=cd(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.xmlHttpFactory=new Sc({})),this.Eo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const g=s.join("");U(Xt,`Creating RPC '${e}' stream ${r}: ${g}`,f);const y=a.createWebChannel(g,f);let C=!1,N=!1;const Z=new n0({ro:W=>{N?U(Xt,`Not sending because RPC '${e}' stream ${r} is closed:`,W):(C||(U(Xt,`Opening RPC '${e}' stream ${r} transport.`),y.open(),C=!0),U(Xt,`RPC '${e}' stream ${r} sending:`,W),y.send(W))},oo:()=>y.close()}),$=(W,oe,ve)=>{W.listen(oe,de=>{try{ve(de)}catch(fe){setTimeout(()=>{throw fe},0)}})};return $(y,br.EventType.OPEN,()=>{N||U(Xt,`RPC '${e}' stream ${r} transport opened.`)}),$(y,br.EventType.CLOSE,()=>{N||(N=!0,U(Xt,`RPC '${e}' stream ${r} transport closed`),Z.wo())}),$(y,br.EventType.ERROR,W=>{N||(N=!0,_n(Xt,`RPC '${e}' stream ${r} transport errored:`,W),Z.wo(new L(O.UNAVAILABLE,"The operation could not be completed")))}),$(y,br.EventType.MESSAGE,W=>{var oe;if(!N){const ve=W.data[0];ie(!!ve);const fe=ve.error||(null===(oe=ve[0])||void 0===oe?void 0:oe.error);if(fe){U(Xt,`RPC '${e}' stream ${r} received error:`,fe);const Se=fe.status;let Ie=function(lr){const K_=bt[lr];if(void 0!==K_)return dm(K_)}(Se),en=fe.message;void 0===Ie&&(Ie=O.INTERNAL,en="Unknown error status: "+Se+" with message "+fe.message),N=!0,Z.wo(new L(Ie,en)),y.close()}else U(Xt,`RPC '${e}' stream ${r} received:`,ve),Z._o(ve)}}),$(d,xc.STAT_EVENT,W=>{W.stat===gl.PROXY?U(Xt,`RPC '${e}' stream ${r} detected buffering proxy`):W.stat===gl.NOPROXY&&U(Xt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{Z.fo()},0),Z}}function vg(){return typeof window<"u"?window:null}function fh(){return typeof document<"u"?document:null}function _u(n){return new fy(n,!0)}class mf{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=i,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),i=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-i);r>0&&U("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Ig{constructor(e,t,i,r,s,a,d,f){this.ii=e,this.$o=i,this.Oo=r,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new mf(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,S.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,S.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var i=this;return(0,S.Z)(function*(){i.Ho(),i.Jo(),i.qo.cancel(),i.Fo++,4!==e?i.qo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(Ye(t.toString()),Ye("Using maximum backoff delay to prevent overloading the backend."),i.qo.xo()):t&&t.code===O.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.Yo(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Fo===t&&this.Zo(i,r)},i=>{e(()=>{const r=new L(O.UNKNOWN,"Fetching auth token failed: "+i.message);return this.tu(r)})})}Zo(e,t){const i=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{i(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(r=>{i(()=>this.tu(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Go(){var e=this;this.state=5,this.qo.No((0,S.Z)(function*(){e.state=0,e.start()}))}tu(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class s0 extends Ig{constructor(e,t,i,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function gy(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(f=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:Q(),r=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(ie(void 0===m||"string"==typeof m),mt.fromBase64String(m||"")):(ie(void 0===m||m instanceof Uint8Array),mt.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,d=a&&function(f){const m=void 0===f.code?O.UNKNOWN:dm(f.code);return new L(m,f.message||"")}(a);t=new _m(i,r,s,d||null)}else if("documentChange"in e){const i=e.documentChange,r=Si(n,i.document.name),s=_t(i.document.updateTime),a=i.document.createTime?_t(i.document.createTime):re.min(),d=new Nt({mapValue:{fields:i.document.fields}}),f=Ze.newFoundDocument(r,s,a,d);t=new Yl(i.targetIds||[],i.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){const i=e.documentDelete,r=Si(n,i.document),s=i.readTime?_t(i.readTime):re.min(),a=Ze.newNoDocument(r,s);t=new Yl([],i.removedTargetIds||[],a.key,a)}else if("documentRemove"in e){const i=e.documentRemove,r=Si(n,i.document);t=new Yl([],i.removedTargetIds||[],r,null)}else{if(!("filter"in e))return Q();{const i=e.filter,{count:r=0,unchangedNames:s}=i,a=new ay(r,s);t=new gm(i.targetId,a)}}var f;return t}(this.serializer,e),i=function(r){if(!("targetChange"in r))return re.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?re.min():s.readTime?_t(s.readTime):re.min()}(e);return this.listener.nu(t,i)}su(e){const t={};t.database=au(this.serializer),t.addTarget=function(r,s){let a;const d=s.target;if(a=nr(d)?{documents:Sm(r,d)}:{query:jd(r,d)},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=wm(r,s.resumeToken);const f=Zd(r,s.expectedCount);null!==f&&(a.expectedCount=f)}else if(s.snapshotVersion.compareTo(re.min())>0){a.readTime=ba(r,s.snapshotVersion.toTimestamp());const f=Zd(r,s.expectedCount);null!==f&&(a.expectedCount=f)}return a}(this.serializer,e);const i=function yy(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.Wo(t)}iu(e){const t={};t.database=au(this.serializer),t.removeTarget=e,this.Wo(t)}}class o0 extends Ig{constructor(e,t,i,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,a),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function _y(n,e){return n&&n.length>0?(ie(void 0!==e),n.map(t=>function(i,r){let s=_t(i.updateTime?i.updateTime:r);return s.isEqual(re.min())&&(s=_t(r)),new iy(s,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=_t(e.commitTime);return this.listener.cu(i,t)}return ie(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=au(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>cu(this.serializer,i))};this.Wo(t)}}class a0 extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Io(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new L(O.UNKNOWN,r.toString())})}vo(e,t,i,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.vo(e,t,i,s,a,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(O.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class u0{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Ye(t),this.mu=!1):U("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class l0{constructor(e,t,i,r,s){var a=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(d=>{i.enqueueAndForget((0,S.Z)(function*(){var f;Fr(a)&&(U("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,S.Z)(function*(m){const g=H(m);g.vu.add(4),yield Da(g),g.bu.set("Unknown"),g.vu.delete(4),yield yu(g)}),function(m){return f.apply(this,arguments)})(a))}))}),this.bu=new u0(i,r)}}function yu(n){return _f.apply(this,arguments)}function _f(){return _f=(0,S.Z)(function*(n){if(Fr(n))for(const e of n.Ru)yield e(!0)}),_f.apply(this,arguments)}function Da(n){return yf.apply(this,arguments)}function yf(){return yf=(0,S.Z)(function*(n){for(const e of n.Ru)yield e(!1)}),yf.apply(this,arguments)}function ph(n,e){const t=H(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),wf(t)?If(t):Na(t).Ko()&&vf(t,e))}function vu(n,e){const t=H(n),i=Na(t);t.Au.delete(e),i.Ko()&&wg(t,e),0===t.Au.size&&(i.Ko()?i.jo():Fr(t)&&t.bu.set("Unknown"))}function vf(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Na(n).su(e)}function wg(n,e){n.Vu.qt(e),Na(n).iu(e)}function If(n){n.Vu=new uy({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),Na(n).start(),n.bu.gu()}function wf(n){return Fr(n)&&!Na(n).Uo()&&n.Au.size>0}function Fr(n){return 0===H(n).vu.size}function Tg(n){n.Vu=void 0}function h0(n){return Tf.apply(this,arguments)}function Tf(){return Tf=(0,S.Z)(function*(n){n.Au.forEach((e,t)=>{vf(n,e)})}),Tf.apply(this,arguments)}function d0(n,e){return Ef.apply(this,arguments)}function Ef(){return Ef=(0,S.Z)(function*(n,e){Tg(n),wf(n)?(n.bu.Iu(e),If(n)):n.bu.set("Unknown")}),Ef.apply(this,arguments)}function f0(n,e,t){return bf.apply(this,arguments)}function bf(){return bf=(0,S.Z)(function*(n,e,t){if(n.bu.set("Online"),e instanceof _m&&2===e.state&&e.cause)try{yield(i=(0,S.Z)(function*(r,s){const a=s.cause;for(const d of s.targetIds)r.Au.has(d)&&(yield r.remoteSyncer.rejectListen(d,a),r.Au.delete(d),r.Vu.removeTarget(d))}),function(r,s){return i.apply(this,arguments)})(n,e)}catch(i){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield mh(n,i)}else if(e instanceof Yl?n.Vu.Ht(e):e instanceof gm?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(re.min()))try{const i=yield lg(n.localStore);t.compareTo(i)>=0&&(yield function(r,s){const a=r.Vu.ce(s);return a.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=r.Au.get(f);m&&r.Au.set(f,m.withResumeToken(d.resumeToken,s))}}),a.targetMismatches.forEach((d,f)=>{const m=r.Au.get(d);if(!m)return;r.Au.set(d,m.withResumeToken(mt.EMPTY_BYTE_STRING,m.snapshotVersion)),wg(r,d);const g=new or(m.target,d,f,m.sequenceNumber);vf(r,g)}),r.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(i){U("RemoteStore","Failed to raise snapshot:",i),yield mh(n,i)}var i}),bf.apply(this,arguments)}function mh(n,e,t){return Cf.apply(this,arguments)}function Cf(){return Cf=(0,S.Z)(function*(n,e,t){if(!vi(e))throw e;n.vu.add(1),yield Da(n),n.bu.set("Offline"),t||(t=()=>lg(n.localStore)),n.asyncQueue.enqueueRetryable((0,S.Z)(function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.vu.delete(1),yield yu(n)}))}),Cf.apply(this,arguments)}function Eg(n,e){return e().catch(t=>mh(n,t,e))}function Oa(n){return xf.apply(this,arguments)}function xf(){return xf=(0,S.Z)(function*(n){const e=H(n),t=Vr(e);let i=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;p0(e);)try{const r=yield Yy(e.localStore,i);if(null===r){0===e.Eu.length&&t.jo();break}i=r.batchId,m0(e,r)}catch(r){yield mh(e,r)}bg(e)&&Cg(e)}),xf.apply(this,arguments)}function p0(n){return Fr(n)&&n.Eu.length<10}function m0(n,e){n.Eu.push(e);const t=Vr(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function bg(n){return Fr(n)&&!Vr(n).Uo()&&n.Eu.length>0}function Cg(n){Vr(n).start()}function g0(n){return Sf.apply(this,arguments)}function Sf(){return Sf=(0,S.Z)(function*(n){Vr(n).hu()}),Sf.apply(this,arguments)}function _0(n){return Af.apply(this,arguments)}function Af(){return Af=(0,S.Z)(function*(n){const e=Vr(n);for(const t of n.Eu)e.uu(t.mutations)}),Af.apply(this,arguments)}function y0(n,e,t){return kf.apply(this,arguments)}function kf(){return kf=(0,S.Z)(function*(n,e,t){const i=n.Eu.shift(),r=Fd.from(i,e,t);yield Eg(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Oa(n)}),kf.apply(this,arguments)}function v0(n,e){return Df.apply(this,arguments)}function Df(){return Df=(0,S.Z)(function*(n,e){var t;e&&Vr(n).ou&&(yield(t=(0,S.Z)(function*(i,r){if(hm(s=r.code)&&s!==O.ABORTED){const a=i.Eu.shift();Vr(i).Qo(),yield Eg(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,r)),yield Oa(i)}var s}),function(i,r){return t.apply(this,arguments)})(n,e)),bg(n)&&Cg(n)}),Df.apply(this,arguments)}function xg(n,e){return Of.apply(this,arguments)}function Of(){return Of=(0,S.Z)(function*(n,e){const t=H(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const i=Fr(t);t.vu.add(3),yield Da(t),i&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield yu(t)}),Of.apply(this,arguments)}function Nf(n,e){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,S.Z)(function*(n,e){const t=H(n);e?(t.vu.delete(2),yield yu(t)):e||(t.vu.add(2),yield Da(t),t.bu.set("Unknown"))}),Rf.apply(this,arguments)}function Na(n){return n.Su||(n.Su=function(e,t,i){const r=H(e);return r.fu(),new s0(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{uo:h0.bind(null,n),ao:d0.bind(null,n),nu:f0.bind(null,n)}),n.Ru.push(function(){var e=(0,S.Z)(function*(t){t?(n.Su.Qo(),wf(n)?If(n):n.bu.set("Unknown")):(yield n.Su.stop(),Tg(n))});return function(t){return e.apply(this,arguments)}}())),n.Su}function Vr(n){return n.Du||(n.Du=function(e,t,i){const r=H(e);return r.fu(),new o0(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{uo:g0.bind(null,n),ao:v0.bind(null,n),au:_0.bind(null,n),cu:y0.bind(null,n)}),n.Ru.push(function(){var e=(0,S.Z)(function*(t){t?(n.Du.Qo(),yield Oa(n)):(yield n.Du.stop(),n.Eu.length>0&&(U("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Du}class Pf{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,t,i,r,s){const a=Date.now()+i,d=new Pf(e,t,a,r,s);return d.start(i),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new L(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ra(n,e){if(Ye("AsyncQueue",`${e}: ${n}`),vi(n))return new L(O.UNAVAILABLE,`${e}: ${n}`);throw n}class Pa{constructor(e){this.comparator=e?(t,i)=>e(t,i)||K.comparator(t.key,i.key):(t,i)=>K.comparator(t.key,i.key),this.keyedMap=Xc(),this.sortedSet=new ze(this.comparator)}static emptySet(e){return new Pa(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Pa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new Pa;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Sg{constructor(){this.Cu=new ze(K.comparator)}track(e){const t=e.doc.key,i=this.Cu.get(t);i?0!==e.type&&3===i.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==i.type?this.Cu=this.Cu.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Cu=this.Cu.remove(t):1===e.type&&2===i.type?this.Cu=this.Cu.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Q():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,i)=>{e.push(i)}),e}}class Ma{constructor(e,t,i,r,s,a,d,f,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,r,s){const a=[];return t.forEach(d=>{a.push({type:0,doc:d})}),new Ma(e,t,Pa.emptySet(t),a,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}class I0{constructor(){this.Nu=void 0,this.listeners=[]}}class w0{constructor(){this.queries=new rr(e=>$p(e),Yc),this.onlineState="Unknown",this.ku=new Set}}function Mf(n,e){return Lf.apply(this,arguments)}function Lf(){return Lf=(0,S.Z)(function*(n,e){const t=H(n),i=e.query;let r=!1,s=t.queries.get(i);if(s||(r=!0,s=new I0),r)try{s.Nu=yield t.onListen(i)}catch(a){const d=Ra(a,`Initialization of query '${Rd(e.query)}' failed`);return void e.onError(d)}t.queries.set(i,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&Uf(t)}),Lf.apply(this,arguments)}function Ff(n,e){return Vf.apply(this,arguments)}function Vf(){return Vf=(0,S.Z)(function*(n,e){const t=H(n),i=e.query;let r=!1;const s=t.queries.get(i);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),r=0===s.listeners.length)}if(r)return t.queries.delete(i),t.onUnlisten(i)}),Vf.apply(this,arguments)}function T0(n,e){const t=H(n);let i=!1;for(const r of e){const a=t.queries.get(r.query);if(a){for(const d of a.listeners)d.$u(r)&&(i=!0);a.Nu=r}}i&&Uf(t)}function E0(n,e,t){const i=H(n),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);i.queries.delete(e)}function Uf(n){n.ku.forEach(e=>{e.next()})}class zf{constructor(e,t,i){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=i||{}}$u(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)3!==r.type&&i.push(r);e=new Ma(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=Ma.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class b0{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class Ag{constructor(e){this.serializer=e}rr(e){return Si(this.serializer,e)}ur(e){return e.metadata.exists?xm(this.serializer,e.document,!1):Ze.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return _t(e)}}class C0{constructor(e,t,i){this.ju=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kg(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const i=be.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,i=new Ag(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.rr(r.metadata.name);for(const a of r.metadata.queries){const d=(t.get(a)||pe()).add(s);t.set(a,d)}}return t}complete(){var e=this;return(0,S.Z)(function*(){const t=yield function Jy(n,e,t,i){return cf.apply(this,arguments)}(e.localStore,new Ag(e.serializer),e.documents,e.ju.id),i=e.Wu(e.documents);for(const r of e.queries)yield Xy(e.localStore,r,i.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function kg(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Dg{constructor(e){this.key=e}}class Og{constructor(e){this.key=e}}class Ng{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=pe(),this.mutatedKeys=pe(),this.tc=Kp(e),this.ec=new Pa(this.tc)}get nc(){return this.Yu}sc(e,t){const i=t?t.ic:new Sg,r=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,a=r,d=!1;const f="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,m="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((g,y)=>{const C=r.get(g),N=Jc(this.query,y)?y:null,Z=!!C&&this.mutatedKeys.has(C.key),$=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let W=!1;C&&N?C.data.isEqual(N.data)?Z!==$&&(i.track({type:3,doc:N}),W=!0):this.rc(C,N)||(i.track({type:2,doc:N}),W=!0,(f&&this.tc(N,f)>0||m&&this.tc(N,m)<0)&&(d=!0)):!C&&N?(i.track({type:0,doc:N}),W=!0):C&&!N&&(i.track({type:1,doc:C}),W=!0,(f||m)&&(d=!0)),W&&(N?(a=a.add(N),s=$?s.add(g):s.delete(g)):(a=a.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const g="F"===this.query.limitType?a.last():a.first();a=a.delete(g.key),s=s.delete(g.key),i.track({type:1,doc:g})}return{ec:a,ic:i,zi:d,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((m,g)=>function(y,C){const N=Z=>{switch(Z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return N(y)-N(C)}(m.type,g.type)||this.tc(m.doc,g.doc)),this.oc(i);const a=t?this.uc():[],d=0===this.Zu.size&&this.current?1:0,f=d!==this.Xu;return this.Xu=d,0!==s.length||f?{snapshot:new Ma(this.query,e.ec,r,s,e.mutatedKeys,0===d,f,!1,!!i&&i.resumeToken.approximateByteSize()>0),cc:a}:{cc:a}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Sg,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=pe(),this.ec.forEach(i=>{this.ac(i.key)&&(this.Zu=this.Zu.add(i.key))});const t=[];return e.forEach(i=>{this.Zu.has(i)||t.push(new Og(i))}),this.Zu.forEach(i=>{e.has(i)||t.push(new Dg(i))}),t}hc(e){this.Yu=e.ir,this.Zu=pe();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Ma.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class x0{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class S0{constructor(e){this.key=e,this.fc=!1}}class A0{constructor(e,t,i,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.dc={},this.wc=new rr(d=>$p(d),Yc),this._c=new Map,this.mc=new Set,this.gc=new ze(K.comparator),this.yc=new Map,this.Ic=new Xd,this.Tc={},this.Ec=new Map,this.Ac=Xs.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function k0(n,e){return Zf.apply(this,arguments)}function Zf(){return Zf=(0,S.Z)(function*(n,e){const t=lp(n);let i,r;const s=t.wc.get(e);if(s)i=s.targetId,t.sharedClientState.addLocalQueryTarget(i),r=s.view.lc();else{const a=yield Aa(t.localStore,jt(e)),d=t.sharedClientState.addLocalQueryTarget(a.targetId);i=a.targetId,r=yield Bf(t,e,i,"current"===d,a.resumeToken),t.isPrimaryClient&&ph(t.remoteStore,a)}return r}),Zf.apply(this,arguments)}function Bf(n,e,t,i,r){return Gf.apply(this,arguments)}function Gf(){return Gf=(0,S.Z)(function*(n,e,t,i,r){n.Rc=(y,C,N)=>{return(Z=(0,S.Z)(function*($,W,oe,ve){let de=W.view.sc(oe);de.zi&&(de=yield uh($.localStore,W.query,!1).then(({documents:Ie})=>W.view.sc(Ie,de)));const fe=ve&&ve.targetChanges.get(W.targetId),Se=W.view.applyChanges(de,$.isPrimaryClient,fe);return Xf($,W.targetId,Se.cc),Se.snapshot}),function($,W,oe,ve){return Z.apply(this,arguments)})(n,y,C,N);var Z};const s=yield uh(n.localStore,e,!0),a=new Ng(e,s.ir),d=a.sc(s.documents),f=su.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState,r),m=a.applyChanges(d,n.isPrimaryClient,f);Xf(n,t,m.cc);const g=new x0(e,t,a);return n.wc.set(e,g),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),m.snapshot}),Gf.apply(this,arguments)}function D0(n,e){return qf.apply(this,arguments)}function qf(){return qf=(0,S.Z)(function*(n,e){const t=H(n),i=t.wc.get(e),r=t._c.get(i.targetId);if(r.length>1)return t._c.set(i.targetId,r.filter(s=>!Yc(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield ka(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),vu(t.remoteStore,i.targetId),La(t,i.targetId)}).catch(yi))):(La(t,i.targetId),yield ka(t.localStore,i.targetId,!0))}),qf.apply(this,arguments)}function jf(){return jf=(0,S.Z)(function*(n,e,t){const i=hp(n);try{const r=yield function(s,a){const d=H(s),f=Ge.now(),m=a.reduce((C,N)=>C.add(N.key),pe());let g,y;return d.persistence.runTransaction("Locally write mutations","readwrite",C=>{let N=yn(),Z=pe();return d.Zi.getEntries(C,m).next($=>{N=$,N.forEach((W,oe)=>{oe.isValidDocument()||(Z=Z.add(W))})}).next(()=>d.localDocuments.getOverlayedDocuments(C,N)).next($=>{g=$;const W=[];for(const oe of a){const ve=sy(oe,g.get(oe.key).overlayedDocument);null!=ve&&W.push(new sr(oe.key,ve,Gl(ve.value.mapValue),Xe.exists(!0)))}return d.mutationQueue.addMutationBatch(C,f,W,a)}).next($=>{y=$;const W=$.applyToLocalDocumentSet(g,Z);return d.documentOverlayCache.saveOverlays(C,$.batchId,W)})}).then(()=>({batchId:y.batchId,changes:Qp(g)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,a,d){let f=s.Tc[s.currentUser.toKey()];f||(f=new ze(ce)),f=f.insert(a,d),s.Tc[s.currentUser.toKey()]=f}(i,r.batchId,t),yield ar(i,r.changes),yield Oa(i.remoteStore)}catch(r){const s=Ra(r,"Failed to persist write");t.reject(s)}}),jf.apply(this,arguments)}function Rg(n,e){return $f.apply(this,arguments)}function $f(){return $f=(0,S.Z)(function*(n,e){const t=H(n);try{const i=yield function Qy(n,e){const t=H(n),i=e.snapshotVersion;let r=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Zi.newChangeBuffer({trackRemovals:!0});r=t.Ji;const d=[];e.targetChanges.forEach((g,y)=>{const C=r.get(y);if(!C)return;d.push(t.Bs.removeMatchingKeys(s,g.removedDocuments,y).next(()=>t.Bs.addMatchingKeys(s,g.addedDocuments,y)));let N=C.withSequenceNumber(s.currentSequenceNumber);var Z,$,W;null!==e.targetMismatches.get(y)?N=N.withResumeToken(mt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):g.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(g.resumeToken,i)),r=r.insert(y,N),$=N,W=g,(0===(Z=C).resumeToken.approximateByteSize()||$.snapshotVersion.toMicroseconds()-Z.snapshotVersion.toMicroseconds()>=3e8||W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0)&&d.push(t.Bs.updateTargetData(s,N))});let f=yn(),m=pe();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),d.push(hg(s,a,e.documentUpdates).next(g=>{f=g.nr,m=g.sr})),!i.isEqual(re.min())){const g=t.Bs.getLastRemoteSnapshotVersion(s).next(y=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,i));d.push(g)}return A.waitFor(d).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(t.Ji=r,s))}(t.localStore,e);e.targetChanges.forEach((r,s)=>{const a=t.yc.get(s);a&&(ie(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.fc=!0:r.modifiedDocuments.size>0?ie(a.fc):r.removedDocuments.size>0&&(ie(a.fc),a.fc=!1))}),yield ar(t,i,e)}catch(i){yield yi(i)}}),$f.apply(this,arguments)}function Pg(n,e,t){const i=H(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const r=[];i.wc.forEach((s,a)=>{const d=a.view.Mu(e);d.snapshot&&r.push(d.snapshot)}),function(s,a){const d=H(s);d.onlineState=a;let f=!1;d.queries.forEach((m,g)=>{for(const y of g.listeners)y.Mu(a)&&(f=!0)}),f&&Uf(d)}(i.eventManager,e),r.length&&i.dc.nu(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function N0(n,e,t){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,S.Z)(function*(n,e,t){const i=H(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.yc.get(e),s=r&&r.key;if(s){let a=new ze(K.comparator);a=a.insert(s,Ze.newNoDocument(s,re.min()));const d=pe().add(s),f=new ru(re.min(),new Map,new ze(ce),a,d);yield Rg(i,f),i.gc=i.gc.remove(s),i.yc.delete(e),ep(i)}else yield ka(i.localStore,e,!1).then(()=>La(i,e,t)).catch(yi)}),Hf.apply(this,arguments)}function R0(n,e){return Kf.apply(this,arguments)}function Kf(){return Kf=(0,S.Z)(function*(n,e){const t=H(n),i=e.batch.batchId;try{const r=yield function Wy(n,e){const t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(a,d,f,m){const g=f.batch,y=g.keys();let C=A.resolve();return y.forEach(N=>{C=C.next(()=>m.getEntry(d,N)).next(Z=>{const $=f.docVersions.get(N);ie(null!==$),Z.version.compareTo($)<0&&(g.applyToRemoteDocument(Z,f),Z.isValidDocument()&&(Z.setReadTime(f.commitVersion),m.addEntry(Z)))})}),C.next(()=>a.mutationQueue.removeMutationBatch(d,g))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let d=pe();for(let f=0;f<a.mutationResults.length;++f)a.mutationResults[f].transformResults.length>0&&(d=d.add(a.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}(t.localStore,e);Jf(t,i,null),Yf(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield ar(t,r)}catch(r){yield yi(r)}}),Kf.apply(this,arguments)}function P0(n,e,t){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,S.Z)(function*(n,e,t){const i=H(n);try{const r=yield function(s,a){const d=H(s);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.mutationQueue.lookupMutationBatch(f,a).next(g=>(ie(null!==g),m=g.keys(),d.mutationQueue.removeMutationBatch(f,g))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,a)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>d.localDocuments.getDocuments(f,m))})}(i.localStore,e);Jf(i,e,t),Yf(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield ar(i,r)}catch(r){yield yi(r)}}),Wf.apply(this,arguments)}function Qf(){return Qf=(0,S.Z)(function*(n,e){const t=H(n);Fr(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(s){const a=H(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>a.mutationQueue.getHighestUnacknowledgedBatchId(d))}(t.localStore);if(-1===i)return void e.resolve();const r=t.Ec.get(i)||[];r.push(e),t.Ec.set(i,r)}catch(i){const r=Ra(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),Qf.apply(this,arguments)}function Yf(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function Jf(n,e,t){const i=H(n);let r=i.Tc[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Tc[i.currentUser.toKey()]=r}}function La(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n._c.get(e))n.wc.delete(i),t&&n.dc.Pc(i,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(i=>{n.Ic.containsKey(i)||Mg(n,i)})}function Mg(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);null!==t&&(vu(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),ep(n))}function Xf(n,e,t){for(const i of t)i instanceof Dg?(n.Ic.addReference(i.key,e),L0(n,i)):i instanceof Og?(U("SyncEngine","Document no longer in limbo: "+i.key),n.Ic.removeReference(i.key,e),n.Ic.containsKey(i.key)||Mg(n,i.key)):Q()}function L0(n,e){const t=e.key,i=t.path.canonicalString();n.gc.get(t)||n.mc.has(i)||(U("SyncEngine","New document in limbo: "+t),n.mc.add(i),ep(n))}function ep(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new K(be.fromString(e)),i=n.Ac.next();n.yc.set(i,new S0(t)),n.gc=n.gc.insert(t,i),ph(n.remoteStore,new or(jt(ir(t.path)),i,"TargetPurposeLimboResolution",rn.ct))}}function ar(n,e,t){return tp.apply(this,arguments)}function tp(){return tp=(0,S.Z)(function*(n,e,t){const i=H(n),r=[],s=[],a=[];var d;i.wc.isEmpty()||(i.wc.forEach((d,f)=>{a.push(i.Rc(f,e,t).then(m=>{if((m||t)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(f.targetId,m?.fromCache?"not-current":"current"),m){r.push(m);const g=sf.Li(f.targetId,m);s.push(g)}}))}),yield Promise.all(a),i.dc.nu(r),yield(d=(0,S.Z)(function*(f,m){const g=H(f);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>A.forEach(m,C=>A.forEach(C.Fi,N=>g.persistence.referenceDelegate.addReference(y,C.targetId,N)).next(()=>A.forEach(C.Bi,N=>g.persistence.referenceDelegate.removeReference(y,C.targetId,N)))))}catch(y){if(!vi(y))throw y;U("LocalStore","Failed to update sequence numbers: "+y)}for(const y of m){const C=y.targetId;if(!y.fromCache){const N=g.Ji.get(C),$=N.withLastLimboFreeSnapshotVersion(N.snapshotVersion);g.Ji=g.Ji.insert(C,$)}}}),function(f,m){return d.apply(this,arguments)})(i.localStore,s))}),tp.apply(this,arguments)}function F0(n,e){return np.apply(this,arguments)}function np(){return np=(0,S.Z)(function*(n,e){const t=H(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const i=yield ug(t.localStore,e);t.currentUser=e,(r=t).Ec.forEach(a=>{a.forEach(d=>{d.reject(new L(O.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.Ec.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield ar(t,i.er)}var r}),np.apply(this,arguments)}function V0(n,e){const t=H(n),i=t.yc.get(e);if(i&&i.fc)return pe().add(i.key);{let r=pe();const s=t._c.get(e);if(!s)return r;for(const a of s){const d=t.wc.get(a);r=r.unionWith(d.view.nc)}return r}}function U0(n,e){return ip.apply(this,arguments)}function ip(){return ip=(0,S.Z)(function*(n,e){const t=H(n),i=yield uh(t.localStore,e.query,!0),r=e.view.hc(i);return t.isPrimaryClient&&Xf(t,e.targetId,r.cc),r}),ip.apply(this,arguments)}function z0(n,e){return rp.apply(this,arguments)}function rp(){return rp=(0,S.Z)(function*(n,e){const t=H(n);return fg(t.localStore,e).then(i=>ar(t,i))}),rp.apply(this,arguments)}function Z0(n,e,t,i){return sp.apply(this,arguments)}function sp(){return sp=(0,S.Z)(function*(n,e,t,i){const r=H(n),s=yield function(a,d){const f=H(a),m=H(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",g=>m.Sn(g,d).next(y=>y?f.localDocuments.getDocuments(g,y):A.resolve(null)))}(r.localStore,e);var d;null!==s?("pending"===t?yield Oa(r.remoteStore):"acknowledged"===t||"rejected"===t?(Jf(r,e,i||null),Yf(r,e),d=e,H(H(r.localStore).mutationQueue).Cn(d)):Q(),yield ar(r,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)}),sp.apply(this,arguments)}function op(){return op=(0,S.Z)(function*(n,e){const t=H(n);if(lp(t),hp(t),!0===e&&!0!==t.vc){const i=t.sharedClientState.getAllActiveQueryTargets(),r=yield Lg(t,i.toArray());t.vc=!0,yield Nf(t.remoteStore,!0);for(const s of r)ph(t.remoteStore,s)}else if(!1===e&&!1!==t.vc){const i=[];let r=Promise.resolve();t._c.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?i.push(a):r=r.then(()=>(La(t,a),ka(t.localStore,a,!0))),vu(t.remoteStore,a)}),yield r,yield Lg(t,i),function(s){const a=H(s);a.yc.forEach((d,f)=>{vu(a.remoteStore,f)}),a.Ic.Ts(),a.yc=new Map,a.gc=new ze(K.comparator)}(t),t.vc=!1,yield Nf(t.remoteStore,!1)}}),op.apply(this,arguments)}function Lg(n,e,t){return ap.apply(this,arguments)}function ap(){return ap=(0,S.Z)(function*(n,e,t){const i=H(n),r=[],s=[];for(const a of e){let d;const f=i._c.get(a);if(f&&0!==f.length){d=yield Aa(i.localStore,jt(f[0]));for(const m of f){const g=i.wc.get(m),y=yield U0(i,g);y.snapshot&&s.push(y.snapshot)}}else{const m=yield dg(i.localStore,a);d=yield Aa(i.localStore,m),yield Bf(i,Fg(m),a,!1,d.resumeToken)}r.push(d)}return i.dc.nu(s),r}),ap.apply(this,arguments)}function Fg(n){return va(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function G0(n){const e=H(n);return H(H(e.localStore).persistence).$i()}function q0(n,e,t,i){return cp.apply(this,arguments)}function cp(){return cp=(0,S.Z)(function*(n,e,t,i){const r=H(n);if(r.vc)return void U("SyncEngine","Ignoring unexpected query state notification.");const s=r._c.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=yield fg(r.localStore,Hp(s[0])),d=ru.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,mt.EMPTY_BYTE_STRING);yield ar(r,a,d);break}case"rejected":yield ka(r.localStore,e,!0),La(r,e,i);break;default:Q()}}),cp.apply(this,arguments)}function j0(n,e,t){return up.apply(this,arguments)}function up(){return up=(0,S.Z)(function*(n,e,t){const i=lp(n);if(i.vc){for(const r of e){if(i._c.has(r)){U("SyncEngine","Adding an already active target "+r);continue}const s=yield dg(i.localStore,r),a=yield Aa(i.localStore,s);yield Bf(i,Fg(s),a.targetId,!1,a.resumeToken),ph(i.remoteStore,a)}for(const r of t)i._c.has(r)&&(yield ka(i.localStore,r,!1).then(()=>{vu(i.remoteStore,r),La(i,r)}).catch(yi))}}),up.apply(this,arguments)}function lp(n){const e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=V0.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=N0.bind(null,e),e.dc.nu=T0.bind(null,e.eventManager),e.dc.Pc=E0.bind(null,e.eventManager),e}function hp(n){const e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=R0.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=P0.bind(null,e),e}class Iu{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,S.Z)(function*(){t.serializer=_u(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return cg(this.persistence,new ag,e.initialUser,this.serializer)}createPersistence(e){return new ef(oh.zs,this.serializer)}createSharedClientState(e){return new _g}terminate(){var e=this;return(0,S.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class dp extends Iu{constructor(e,t,i){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,S.Z)(function*(){yield t().call(i,e),yield i.Vc.initialize(i,e),yield hp(i.Vc.syncEngine),yield Oa(i.Vc.remoteStore),yield i.persistence.Ii(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return cg(this.persistence,new ag,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new Jm(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new Dl(t,this.persistence);return new _d(e.asyncQueue,i)}createPersistence(e){const t=rf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Jt.withCacheSize(this.cacheSizeBytes):Jt.DEFAULT;return new nf(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,vg(),fh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new _g}}class Vg extends dp{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,S.Z)(function*(){yield t().call(i,e);const r=i.Vc.syncEngine;i.sharedClientState instanceof ff&&(i.sharedClientState.syncEngine={jr:Z0.bind(null,r),zr:q0.bind(null,r),Wr:j0.bind(null,r),$i:G0.bind(null,r),Qr:z0.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.Ii(function(){var s=(0,S.Z)(function*(a){yield function B0(n,e){return op.apply(this,arguments)}(i.Vc.syncEngine,a),i.gcScheduler&&(a&&!i.gcScheduler.started?i.gcScheduler.start():a||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(a&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():a||i.indexBackfillerScheduler.stop())});return function(a){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=vg();if(!ff.D(t))throw new L(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=rf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ff(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Fa{initialize(e,t){var i=this;return(0,S.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>Pg(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=F0.bind(null,i.syncEngine),yield Nf(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new w0}createDatastore(e){const t=_u(e.databaseInfo.databaseId),i=new r0(e.databaseInfo);return new a0(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,r=e.asyncQueue,s=d=>Pg(this.syncEngine,d,0),a=yg.D()?new yg:new e0,new l0(t,i,r,s,a);var t,i,r,s,a}createSyncEngine(e,t){return function(i,r,s,a,d,f,m){const g=new A0(i,r,s,a,d,f);return m&&(g.vc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,S.Z)(function*(t){const i=H(t);U("RemoteStore","RemoteStore shutting down."),i.vu.add(5),yield Da(i),i.Pu.shutdown(),i.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Ug(n,e=10240){let t=0;return{read:()=>(0,S.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,S.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class gh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Ye("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class K0{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new ot,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(i=>{i&&i.Qu()?this.metadata.resolve(i.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Gu)}`))},i=>this.metadata.reject(i))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,S.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,S.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,S.Z)(function*(){const t=yield e.kc();if(null===t)return null;const i=e.xc.decode(t),r=Number(i);isNaN(r)&&e.Mc(`length string (${i}) is not valid number`);const s=yield e.$c(r);return new b0(JSON.parse(s),t.length+r)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,S.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}$c(e){var t=this;return(0,S.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const i=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,S.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class W0{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,S.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new L(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,S.Z)(function*(s,a){const d=H(s),f=au(d.serializer)+"/documents",m={documents:a.map(N=>ou(d.serializer,N))},g=yield d.vo("BatchGetDocuments",f,m,a.length),y=new Map;g.forEach(N=>{const Z=function my(n,e){return"found"in e?function(t,i){ie(!!i.found);const r=Si(t,i.found.name),s=_t(i.found.updateTime),a=i.found.createTime?_t(i.found.createTime):re.min(),d=new Nt({mapValue:{fields:i.found.fields}});return Ze.newFoundDocument(r,s,a,d)}(n,e):"missing"in e?function(t,i){ie(!!i.missing),ie(!!i.readTime);const r=Si(t,i.missing),s=_t(i.readTime);return Ze.newNoDocument(r,s)}(n,e):Q()}(d.serializer,N);y.set(Z.key.toString(),Z)});const C=[];return a.forEach(N=>{const Z=y.get(N.toString());ie(!!Z),C.push(Z)}),C}),function(s,a){return r.apply(this,arguments)})(t.datastore,e);var r;return i.forEach(r=>t.recordVersion(r)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ea(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,S.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,r)=>{const s=K.fromPath(r);e.mutations.push(new Md(s,e.precondition(s)))}),yield(i=(0,S.Z)(function*(r,s){const a=H(r),d=au(a.serializer)+"/documents",f={writes:s.map(m=>cu(a.serializer,m))};yield a.Io("Commit",d,f)}),function(r,s){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Q();t=re.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new L(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(re.min())?Xe.exists(!1):Xe.updateTime(t):Xe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(re.min()))throw new L(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xe.updateTime(t)}return Xe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Q0{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Bc=i.maxAttempts,this.qo=new mf(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,S.Z)(function*(){const t=new W0(e.datastore),i=e.qc(t);i&&i.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Uc(s)}))}).catch(r=>{e.Uc(r)})}))}qc(e){try{const t=this.updateFunction(e);return!Ji(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!hm(t)}return!1}}class Y0{constructor(e,t,i,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=lt.UNAUTHENTICATED,this.clientId=El.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var a=(0,S.Z)(function*(d){U("FirestoreClient","Received user=",d.uid),yield s.authCredentialListener(d),s.user=d});return function(d){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(i,a=>(U("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}getConfiguration(){var e=this;return(0,S.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,S.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(i){const r=Ra(i,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function _h(n,e){return fp.apply(this,arguments)}function fp(){return fp=(0,S.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var r=(0,S.Z)(function*(s){i.isEqual(s)||(yield ug(e.localStore,s),i=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),fp.apply(this,arguments)}function pp(n,e){return mp.apply(this,arguments)}function mp(){return mp=(0,S.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield gp(n);U("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(r=>xg(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>xg(e.remoteStore,s)),n._onlineComponents=e}),mp.apply(this,arguments)}function zg(n){return"FirebaseError"===n.name?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function gp(n){return _p.apply(this,arguments)}function _p(){return _p=(0,S.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield _h(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!zg(t))throw t;_n("Error using user provided cache. Falling back to memory cache: "+t),yield _h(n,new Iu)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield _h(n,new Iu);return n._offlineComponents}),_p.apply(this,arguments)}function yh(n){return yp.apply(this,arguments)}function yp(){return yp=(0,S.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield pp(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield pp(n,new Fa))),n._onlineComponents}),yp.apply(this,arguments)}function Zg(n){return gp(n).then(e=>e.persistence)}function vh(n){return gp(n).then(e=>e.localStore)}function Bg(n){return yh(n).then(e=>e.remoteStore)}function vp(n){return yh(n).then(e=>e.syncEngine)}function Va(n){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,S.Z)(function*(n){const e=yield yh(n),t=e.eventManager;return t.onListen=k0.bind(null,e.syncEngine),t.onUnlisten=D0.bind(null,e.syncEngine),t}),Ip.apply(this,arguments)}function qg(n,e,t={}){const i=new ot;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(r,s,a,d,f){const m=new gh({next:y=>{s.enqueueAndForget(()=>Ff(r,g));const C=y.docs.has(a);!C&&y.fromCache?f.reject(new L(O.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&y.fromCache&&d&&"server"===d.source?f.reject(new L(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(y)},error:y=>f.reject(y)}),g=new zf(ir(a.path),m,{includeMetadataChanges:!0,Ku:!0});return Mf(r,g)}(yield Va(n),n.asyncQueue,e,t,i)})),i.promise}function jg(n,e,t={}){const i=new ot;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(r,s,a,d,f){const m=new gh({next:y=>{s.enqueueAndForget(()=>Ff(r,g)),y.fromCache&&"server"===d.source?f.reject(new L(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(y)},error:y=>f.reject(y)}),g=new zf(a,m,{includeMetadataChanges:!0,Ku:!0});return Mf(r,g)}(yield Va(n),n.asyncQueue,e,t,i)})),i.promise}function $g(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const Hg=new Map;function wp(n,e,t){if(!t)throw new L(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Kg(n,e,t,i){if(!0===e&&!0===i)throw new L(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Wg(n){if(!K.isDocumentKey(n))throw new L(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Qg(n){if(K.isDocumentKey(n))throw new L(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ih(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Q()}function Ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ih(n);throw new L(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Yg(n,e){if(e<=0)throw new L(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Jg{constructor(e){var t,i;if(void 0===e.host){if(void 0!==e.ssl)throw new L(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new L(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=$g(null!==(i=e.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(r){if(void 0!==r.timeoutSeconds){if(isNaN(r.timeoutSeconds))throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(O.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wu{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new L(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jg(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Oc;switch(t.type){case"firstParty":return new Rc(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new L(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hg.get(e);t&&(U("ComponentProvider","Removing Datastore"),Hg.delete(e),t.terminate())}(this),Promise.resolve()}}class $e{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $e(this.firestore,e,this._key)}}class $t{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new $t(this.firestore,e,this._query)}}class Ai extends $t{constructor(e,t,i){super(e,t,ir(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $e(this.firestore,null,new K(e))}withConverter(e){return new Ai(this.firestore,e,this._path)}}function e_(n,e,...t){if(n=(0,he.m9)(n),wp("collection","path",e),n instanceof wu){const i=be.fromString(e,...t);return Qg(i),new Ai(n,null,i)}{if(!(n instanceof $e||n instanceof Ai))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(be.fromString(e,...t));return Qg(i),new Ai(n.firestore,null,i)}}function wh(n,e,...t){if(n=(0,he.m9)(n),1===arguments.length&&(e=El.A()),wp("doc","path",e),n instanceof wu){const i=be.fromString(e,...t);return Wg(i),new $e(n,null,new K(i))}{if(!(n instanceof $e||n instanceof Ai))throw new L(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(be.fromString(e,...t));return Wg(i),new $e(n.firestore,n instanceof Ai?n.converter:null,new K(i))}}function t_(n,e){return n=(0,he.m9)(n),e=(0,he.m9)(e),(n instanceof $e||n instanceof Ai)&&(e instanceof $e||e instanceof Ai)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Tp(n,e){return n=(0,he.m9)(n),e=(0,he.m9)(e),n instanceof $t&&e instanceof $t&&n.firestore===e.firestore&&Yc(n._query,e._query)&&n.converter===e.converter}class av{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new mf(this,"async_queue_retry"),this.Xc=()=>{const t=fh();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=fh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=fh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new ot;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,S.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!vi(t))throw t;U("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(i=>{throw this.Wc=i,this.Hc=!1,Ye("INTERNAL UNHANDLED ERROR: ",function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),a}(i)),i}).then(i=>(this.Hc=!1,i))));return this.Gc=t,t}enqueueAfterDelay(e,t,i){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=Pf.createAndSchedule(this,e,t,i,s=>this.na(s));return this.zc.push(r),r}Zc(){this.Wc&&Q()}verifyOperationInProgress(){}sa(){var e=this;return(0,S.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function Ep(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const r of["next","error","complete"])if(r in i&&"function"==typeof i[r])return!0;return!1}(n)}class cv{constructor(){this._progressObserver={},this._taskCompletionResolver=new ot,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class He extends wu{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new av,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||n_(this),this._firestoreClient.terminate()}}function yt(n){return n._firestoreClient||n_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function n_(n){var e,t,i;const r=n._freezeSettings(),s=(d=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new zl(n._databaseId,d,n._persistenceKey,(m=r).host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,$g(m.experimentalLongPollingOptions),m.useFetchStreams));var d,m;n._firestoreClient=new Y0(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=r.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(i=r.cache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function i_(n,e,t){const i=new ot;return n.asyncQueue.enqueue((0,S.Z)(function*(){try{yield _h(n,t),yield pp(n,e),i.resolve()}catch(r){const s=r;if(!zg(s))throw s;_n("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function r_(n){if(n._initialized||n._terminated)throw new L(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ki{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ki(mt.fromBase64String(e))}catch(t){throw new L(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ki(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class cr{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new L(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new je(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class to{constructor(e){this._methodName=e}}class Th{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}}const vv=/^__.*__$/;class Iv{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new sr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ta(e,this.data,t,this.fieldTransforms)}}class s_{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new sr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function o_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class Eh{constructor(e,t,i,r,s,a){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Eh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:i,la:!1});return r.fa(e),r}da(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:i,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return xh(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(o_(this.ca)&&vv.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class wv{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_u(e)}ya(e,t,i,r=!1){return new Eh({ca:e,methodName:t,ga:i,path:je.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function no(n){const e=n._freezeSettings(),t=_u(n._databaseId);return new wv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bh(n,e,t,i,r,s={}){const a=n.ya(s.merge||s.mergeFields?2:0,e,t,r);Sp("Data must be an object, but it was:",a,i);const d=u_(i,a);let f,m;if(s.merge)f=new Ot(a.fieldMask),m=a.fieldTransforms;else if(s.mergeFields){const g=[];for(const y of s.mergeFields){const C=bu(e,y,t);if(!a.contains(C))throw new L(O.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);h_(g,C)||g.push(C)}f=new Ot(g),m=a.fieldTransforms.filter(y=>f.covers(y.field))}else f=null,m=a.fieldTransforms;return new Iv(new Nt(d),f,m)}class Eu extends to{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Eu}}function a_(n,e,t){return new Eh({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class bp extends to{_toFieldTransform(e){return new tu(e.path,new Ia)}isEqual(e){return e instanceof bp}}class Tv extends to{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=a_(this,e,!0),i=this.pa.map(s=>io(s,t)),r=new $s(i);return new tu(e.path,r)}isEqual(e){return this===e}}class Ev extends to{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=a_(this,e,!0),i=this.pa.map(s=>io(s,t)),r=new Hs(i);return new tu(e.path,r)}isEqual(e){return this===e}}class bv extends to{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new wa(e.serializer,em(e.serializer,this.Ia));return new tu(e.path,t)}isEqual(e){return this===e}}function Cp(n,e,t,i){const r=n.ya(1,e,t);Sp("Data must be an object, but it was:",r,i);const s=[],a=Nt.empty();ni(i,(f,m)=>{const g=Ch(e,f,t);m=(0,he.m9)(m);const y=r.da(g);if(m instanceof Eu)s.push(g);else{const C=io(m,y);null!=C&&(s.push(g),a.set(g,C))}});const d=new Ot(s);return new s_(a,d,r.fieldTransforms)}function xp(n,e,t,i,r,s){const a=n.ya(1,e,t),d=[bu(e,i,t)],f=[r];if(s.length%2!=0)throw new L(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<s.length;C+=2)d.push(bu(e,s[C])),f.push(s[C+1]);const m=[],g=Nt.empty();for(let C=d.length-1;C>=0;--C)if(!h_(m,d[C])){const N=d[C];let Z=f[C];Z=(0,he.m9)(Z);const $=a.da(N);if(Z instanceof Eu)m.push(N);else{const W=io(Z,$);null!=W&&(m.push(N),g.set(N,W))}}const y=new Ot(m);return new s_(g,y,a.fieldTransforms)}function c_(n,e,t,i=!1){return io(t,n.ya(i?4:3,e))}function io(n,e){if(l_(n=(0,he.m9)(n)))return Sp("Unsupported field value:",e,n),u_(n,e);if(n instanceof to)return function(t,i){if(!o_(i.ca))throw i._a(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i._a(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,i){const r=[];let s=0;for(const a of t){let d=io(a,i.wa(s));null==d&&(d={nullValue:"NULL_VALUE"}),r.push(d),s++}return{arrayValue:{values:r}}}(n,e)}return function(t,i){if(null===(t=(0,he.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return em(i.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Ge.fromDate(t);return{timestampValue:ba(i.serializer,r)}}if(t instanceof Ge){const r=new Ge(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ba(i.serializer,r)}}if(t instanceof Th)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ki)return{bytesValue:wm(i.serializer,t._byteString)};if(t instanceof $e){const r=i.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw i._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Bd(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i._a(`Unsupported field value: ${Ih(t)}`)}(n,e)}function u_(n,e){const t={};return la(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ni(n,(i,r)=>{const s=io(r,e.ha(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}function l_(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Ge||n instanceof Th||n instanceof ki||n instanceof $e||n instanceof to)}function Sp(n,e,t){if(!l_(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=Ih(t);throw e._a("an object"===i?n+" a custom object":n+" "+i)}var i}function bu(n,e,t){if((e=(0,he.m9)(e))instanceof cr)return e._internalPath;if("string"==typeof e)return Ch(n,e);throw xh("Field path arguments must be of type string or ",n,!1,void 0,t)}const Cv=new RegExp("[~\\*/\\[\\]]");function Ch(n,e,t){if(e.search(Cv)>=0)throw xh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cr(...e.split("."))._internalPath}catch{throw xh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xh(n,e,t,i,r){const s=i&&!i.isEmpty(),a=void 0!==r;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(s||a)&&(f+=" (found",s&&(f+=` in field ${i}`),a&&(f+=` in document ${r}`),f+=")"),new L(O.INVALID_ARGUMENT,d+n+f)}function h_(n,e){return n.some(t=>t.isEqual(e))}class Cu{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $e(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Sh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xv extends Cu{data(){return super.data()}}function Sh(n,e){return"string"==typeof e?Ch(n,e):e instanceof cr?e._internalPath:e._delegate._internalPath}function d_(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new L(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ap{}class xu extends Ap{}function Ur(n,e,...t){let i=[];e instanceof Ap&&i.push(e),i=i.concat(t),function(r){const s=r.filter(d=>d instanceof Ua).length,a=r.filter(d=>d instanceof Su).length;if(s>1||s>0&&a>0)throw new L(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class Su extends xu{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Su(e,t,i)}_apply(e){const t=this._parse(e);return g_(e._query,t),new $t(e.firestore,e.converter,Nd(e._query,t))}_parse(e){const t=no(e.firestore);return function(r,s,a,d,f,m,g){let y;if(f.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new L(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){m_(g,m);const C=[];for(const N of g)C.push(p_(d,r,N));y={arrayValue:{values:C}}}else y=p_(d,r,g)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||m_(g,m),y=c_(a,"where",g,"in"===m||"not-in"===m);return ye.create(f,m,y)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ua extends Ap{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ua(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return 1===t.length?t[0]:Oe.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,r){let s=i;const a=r.getFlattenedFilters();for(const d of a)g_(s,d),s=Nd(s,d)}(e._query,t),new $t(e.firestore,e.converter,Nd(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class kp extends xu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new kp(e,t)}_apply(e){const t=function(i,r,s){if(null!==i.startAt)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new L(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Dr(r,s);return function(d,f){if(null===qs(d)){const m=js(d);null!==m&&__(0,m,f.field)}}(i,a),a}(e._query,this._field,this._direction);return new $t(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new Un(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class Ah extends xu{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Ah(e,t,i)}_apply(e){return new $t(e.firestore,e.converter,$l(e._query,this._limit,this._limitType))}}class kh extends xu{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new kh(e,t,i)}_apply(e){const t=f_(e,this.type,this._docOrFields,this._inclusive);return new $t(e.firestore,e.converter,(r=t,new Un((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)));var i,r}}class Dh extends xu{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Dh(e,t,i)}_apply(e){const t=f_(e,this.type,this._docOrFields,this._inclusive);return new $t(e.firestore,e.converter,(r=t,new Un((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)));var i,r}}function f_(n,e,t,i){if(t[0]=(0,he.m9)(t[0]),t[0]instanceof Cu)return function(r,s,a,d,f){if(!d)throw new L(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const m=[];for(const g of si(r))if(g.field.isKeyField())m.push(gt(s,d.key));else{const y=d.data.field(g.field);if(da(y))throw new L(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===y){const C=g.field.canonicalString();throw new L(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}m.push(y)}return new at(m,f)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=no(n.firestore);return function(s,a,d,f,m,g){const y=s.explicitOrderBy;if(m.length>y.length)throw new L(O.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let N=0;N<m.length;N++){const Z=m[N];if(y[N].field.isKeyField()){if("string"!=typeof Z)throw new L(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof Z}`);if(!Qc(s)&&-1!==Z.indexOf("/"))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${Z}' contains a slash.`);const $=s.path.child(be.fromString(Z));if(!K.isDocumentKey($))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${$}' is not because it contains an odd number of segments.`);const W=new K($);C.push(gt(a,W))}else{const $=c_(d,f,Z);C.push($)}}return new at(C,g)}(n._query,n.firestore._databaseId,r,e,t,i)}}function p_(n,e,t){if("string"==typeof(t=(0,he.m9)(t))){if(""===t)throw new L(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qc(e)&&-1!==t.indexOf("/"))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(be.fromString(t));if(!K.isDocumentKey(i))throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return gt(n,new K(i))}if(t instanceof $e)return gt(n,t._key);throw new L(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ih(t)}.`)}function m_(n,e){if(!Array.isArray(n)||0===n.length)throw new L(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function g_(n,e){if(e.isInequality()){const i=js(n),r=e.field;if(null!==i&&!i.isEqual(r))throw new L(O.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=qs(n);null!==s&&__(0,r,s)}const t=function(i,r){for(const s of i)for(const a of s.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new L(O.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function __(n,e,t){if(!t.isEqual(e))throw new L(O.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class Dp{convertValue(e,t="none"){switch(bi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ii(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ni(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new Th(Je(e.latitude),Je(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=wi(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Us(e));default:return null}}convertTimestamp(e){const t=Ii(e);return new Ge(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=be.fromString(e);ie(Om(i));const r=new Ti(i.get(1),i.get(3)),s=new K(i.popFirst(5));return r.isEqual(t)||Ye(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Oh(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Mv extends Dp{constructor(e){super(),this.firestore=e}convertBytes(e){return new ki(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}}class ro{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ur extends Cu{constructor(e,t,i,r,s,a){super(e,t,i,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Au(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Sh("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Au extends ur{data(e={}){return super.data(e)}}class zr{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ro(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Au(this._firestore,this._userDataWriter,i.key,i,new ro(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new Au(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ro(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:s++}))}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||3!==a.type).map(a=>{const d=new Au(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ro(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return 0!==a.type&&(f=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),1!==a.type&&(s=s.add(a.doc),m=s.indexOf(a.doc.key)),{type:Fv(a.type),doc:d,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Fv(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}function v_(n,e){return n instanceof ur&&e instanceof ur?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof zr&&e instanceof zr&&n._firestore===e._firestore&&Tp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Zr extends Dp{constructor(e){super(),this.firestore=e}convertBytes(e){return new ki(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}}function I_(n,e,t){n=Ce(n,$e);const i=Ce(n.firestore,He),r=Oh(n.converter,e,t);return za(i,[bh(no(i),"setDoc",n._key,r,null!==n.converter,t).toMutation(n._key,Xe.none())])}function w_(n,e,t,...i){n=Ce(n,$e);const r=Ce(n.firestore,He),s=no(r);let a;return a="string"==typeof(e=(0,he.m9)(e))||e instanceof cr?xp(s,"updateDoc",n._key,e,t,i):Cp(s,"updateDoc",n._key,e),za(r,[a.toMutation(n._key,Xe.exists(!0))])}function T_(n,...e){var t,i,r;n=(0,he.m9)(n);let s={includeMetadataChanges:!1},a=0;"object"!=typeof e[a]||Ep(e[a])||(s=e[a],a++);const d={includeMetadataChanges:s.includeMetadataChanges};if(Ep(e[a])){const y=e[a];e[a]=null===(t=y.next)||void 0===t?void 0:t.bind(y),e[a+1]=null===(i=y.error)||void 0===i?void 0:i.bind(y),e[a+2]=null===(r=y.complete)||void 0===r?void 0:r.bind(y)}let f,m,g;if(n instanceof $e)m=Ce(n.firestore,He),g=ir(n._key.path),f={next:y=>{e[a]&&e[a](Op(m,n,y))},error:e[a+1],complete:e[a+2]};else{const y=Ce(n,$t);m=Ce(y.firestore,He),g=y._query;const C=new Zr(m);f={next:N=>{e[a]&&e[a](new zr(m,C,y,N))},error:e[a+1],complete:e[a+2]},d_(n._query)}return function(y,C,N,Z){const $=new gh(Z),W=new zf(C,$,N);return y.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return Mf(yield Va(y),W)})),()=>{$.Dc(),y.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return Ff(yield Va(y),W)}))}}(yt(m),g,d,f)}function za(n,e){return function(t,i){const r=new ot;return t.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function O0(n,e,t){return jf.apply(this,arguments)}(yield vp(t),i,r)})),r.promise}(yt(n),e)}function Op(n,e,t){const i=t.docs.get(e._key),r=new Zr(n);return new ur(n,r,e._key,i,new ro(t.hasPendingWrites,t.fromCache),e.converter)}const t1={maxAttempts:5};class E_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=no(e)}set(e,t,i){this._verifyNotCommitted();const r=Br(e,this._firestore),s=Oh(r.converter,t,i),a=bh(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,i);return this._mutations.push(a.toMutation(r._key,Xe.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=Br(e,this._firestore);let a;return a="string"==typeof(t=(0,he.m9)(t))||t instanceof cr?xp(this._dataReader,"WriteBatch.update",s._key,t,i,r):Cp(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Xe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Br(e,this._firestore);return this._mutations=this._mutations.concat(new Ea(t._key,Xe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Br(n,e){if((n=(0,he.m9)(n)).firestore!==e)throw new L(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class n1 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=no(e)}get(e){const t=Br(e,this._firestore),i=new Mv(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return Q();const s=r[0];if(s.isFoundDocument())return new Cu(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new Cu(this._firestore,i,t._key,null,t.converter);throw Q()})}set(e,t,i){const r=Br(e,this._firestore),s=Oh(r.converter,t,i),a=bh(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,i);return this._transaction.set(r._key,a),this}update(e,t,i,...r){const s=Br(e,this._firestore);let a;return a="string"==typeof(t=(0,he.m9)(t))||t instanceof cr?xp(this._dataReader,"Transaction.update",s._key,t,i,r):Cp(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,a),this}delete(e){const t=Br(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Br(e,this._firestore),i=new Zr(this._firestore);return super.get(e).then(r=>new ur(this._firestore,i,t._key,r._document,new ro(!1,!1),t.converter))}}function Np(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new L("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function C_(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function x_(){if(!function Dd(){return typeof atob<"u"}())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){gi=cn.SDK_VERSION,(0,cn._registerComponent)(new me.wA("firestore",(t,{instanceIdentifier:i,options:r})=>{const s=t.getProvider("app").getImmediate(),a=new He(new Nc(t.getProvider("auth-internal")),new wl(t.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new L(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ti(d.options.projectId,f)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),(0,cn.registerVersion)(_l,"3.13.0",n),(0,cn.registerVersion)(_l,"3.13.0","esm2017")}();class ku{constructor(e){this._delegate=e}static fromBase64String(e){return x_(),new ku(ki.fromBase64String(e))}static fromUint8Array(e){return C_(),new ku(ki.fromUint8Array(e))}toBase64(){return x_(),this._delegate.toBase64()}toUint8Array(){return C_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Rp(n){return function d1(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of e)if(i in t&&"function"==typeof t[i])return!0;return!1}(n,["next","error","complete"])}class f1{enableIndexedDbPersistence(e,t){return function lv(n,e){r_(n=Ce(n,He));const t=yt(n);if(t._uninitializedComponentsProvider)throw new L(O.FAILED_PRECONDITION,"SDK cache is already specified.");_n("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new Fa;return i_(t,r,new dp(r,i.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function hv(n){r_(n=Ce(n,He));const e=yt(n);if(e._uninitializedComponentsProvider)throw new L(O.FAILED_PRECONDITION,"SDK cache is already specified.");_n("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new Fa;return i_(e,i,new Vg(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function dv(n){if(n._initialized&&!n._terminated)throw new L(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ot;return n._queue.enqueueAndForgetEvenWhileRestricted((0,S.Z)(function*(){try{yield(t=(0,S.Z)(function*(i){if(!kn.D())return Promise.resolve();const r=i+"main";yield kn.delete(r)}),function(i){return t.apply(this,arguments)})(rf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class S_{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ti||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&_n("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){!function Xg(n,e,t,i={}){var r;const s=(n=Ce(n,wu))._getSettings(),a=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&_n("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let d,f;if("string"==typeof i.mockUserToken)d=i.mockUserToken,f=lt.MOCK_USER;else{d=(0,he.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const m=i.mockUserToken.sub||i.mockUserToken.user_id;if(!m)throw new L(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new lt(m)}n._authCredentials=new sa(new yl(d,f))}}(this._delegate,e,t,i)}enableNetwork(){return function pv(n){return function J0(n){return n.asyncQueue.enqueue((0,S.Z)(function*(){const e=yield Zg(n),t=yield Bg(n);return e.setNetworkEnabled(!0),function(i){const r=H(i);return r.vu.delete(0),yu(r)}(t)}))}(yt(n=Ce(n,He)))}(this._delegate)}disableNetwork(){return function mv(n){return function X0(n){return n.asyncQueue.enqueue((0,S.Z)(function*(){const e=yield Zg(n),t=yield Bg(n);return e.setNetworkEnabled(!1),(i=(0,S.Z)(function*(r){const s=H(r);s.vu.add(0),yield Da(s),s.bu.set("Offline")}),function(r){return i.apply(this,arguments)})(t);var i}))}(yt(n=Ce(n,He)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Kg("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function fv(n){return function(e){const t=new ot;return e.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function M0(n,e){return Qf.apply(this,arguments)}(yield vp(e),t)})),t.promise}(yt(n=Ce(n,He)))}(this._delegate)}onSnapshotsInSync(e){return function $v(n,e){return function nv(n,e){const t=new gh(e);return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return i=yield Va(n),r=t,H(i).ku.add(r),void r.next();var i,r})),()=>{t.Dc(),n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return i=yield Va(n),r=t,void H(i).ku.delete(r);var i,r}))}}(yt(n=Ce(n,He)),Ep(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Za(this,e_(this._delegate,e))}catch(t){throw sn(t,"collection()","Firestore.collection()")}}doc(e){try{return new zn(this,wh(this._delegate,e))}catch(t){throw sn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new on(this,function ov(n,e){if(n=Ce(n,wu),wp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $t(n,null,(t=e,new Un(be.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw sn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function r1(n,e,t){n=Ce(n,He);const i=Object.assign(Object.assign({},t1),t);return function(r){if(r.maxAttempts<1)throw new L(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,a){const d=new ot;return r.asyncQueue.enqueueAndForget((0,S.Z)(function*(){const f=yield function Gg(n){return yh(n).then(e=>e.datastore)}(r);new Q0(r.asyncQueue,f,a,s,d).run()})),d.promise}(yt(n),r=>e(new n1(n,r)),i)}(this._delegate,t=>e(new A_(this,t)))}batch(){return yt(this._delegate),new k_(new E_(this._delegate,e=>za(this._delegate,e)))}loadBundle(e){return function gv(n,e){const t=yt(n=Ce(n,He)),i=new cv;return function iv(n,e,t,i){const r=function(s,a){let d;return d="string"==typeof s?fm().encode(s):s,f=function(f,m){if(f instanceof Uint8Array)return Ug(f,m);if(f instanceof ArrayBuffer)return Ug(new Uint8Array(f),m);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new K0(f,a);var f}(t,_u(e));n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){!function $0(n,e,t){const i=H(n);var r;(r=(0,S.Z)(function*(s,a,d){try{const f=yield a.getMetadata();if(yield function(C,N){const Z=H(C),$=_t(N.createTime);return Z.persistence.runTransaction("hasNewerBundle","readonly",W=>Z.qs.getBundleMetadata(W,N.id)).then(W=>!!W&&W.createTime.compareTo($)>=0)}(s.localStore,f))return yield a.close(),d._completeWith({taskState:"Success",documentsLoaded:(C=f).totalDocuments,bytesLoaded:C.totalBytes,totalDocuments:C.totalDocuments,totalBytes:C.totalBytes}),Promise.resolve(new Set);d._updateProgress(kg(f));const m=new C0(f,s.localStore,a.serializer);let g=yield a.bc();for(;g;){const C=yield m.zu(g);C&&d._updateProgress(C),g=yield a.bc()}const y=yield m.complete();return yield ar(s,y.Ju,void 0),yield function(C,N){const Z=H(C);return Z.persistence.runTransaction("Save bundle","readwrite",$=>Z.qs.saveBundleMetadata($,N))}(s.localStore,f),d._completeWith(y.progress),Promise.resolve(y.Hu)}catch(f){return _n("SyncEngine",`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}var C}),function(s,a,d){return r.apply(this,arguments)})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield vp(n),r,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function _v(n,e){return function rv(n,e){return n.asyncQueue.enqueue((0,S.Z)(function*(){return function(t,i){const r=H(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.qs.getNamedQuery(s,i))}(yield vh(n),e)}))}(yt(n=Ce(n,He)),e).then(t=>t?new $t(n,null,t.query):null)}(this._delegate,e).then(t=>t?new on(this,t):null)}}class Nh extends Dp{constructor(e){super(),this.firestore=e}convertBytes(e){return new ku(new ki(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return zn.forKey(t,this.firestore,null)}}class A_{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Nh(e)}get(e){const t=oo(e);return this._delegate.get(t).then(i=>new Du(this._firestore,new ur(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=oo(e);return i?(Np("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=oo(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=oo(e);return this._delegate.delete(t),this}}class k_{constructor(e){this._delegate=e}set(e,t,i){const r=oo(e);return i?(Np("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=oo(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=oo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class so{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new Au(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ou(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=so.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new so(e,new Nh(e),t),r.set(t,s)),s}}so.INSTANCES=new WeakMap;class zn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nh(e)}static forPath(e,t,i){if(e.length%2!=0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new zn(t,new $e(t._delegate,i,new K(e)))}static forKey(e,t,i){return new zn(t,new $e(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Za(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Za(this.firestore,e_(this._delegate,e))}catch(t){throw sn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,he.m9)(e))instanceof $e&&t_(this._delegate,e)}set(e,t){t=Np("DocumentReference.set",t);try{return t?I_(this._delegate,e,t):I_(this._delegate,e)}catch(i){throw sn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?w_(this._delegate,e):w_(this._delegate,e,t,...i)}catch(r){throw sn(r,"updateDoc()","DocumentReference.update()")}}delete(){return function qv(n){return za(Ce(n.firestore,He),[new Ea(n._key,Xe.none())])}(this._delegate)}onSnapshot(...e){const t=D_(e),i=O_(e,r=>new Du(this.firestore,new ur(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return T_(this._delegate,t,i)}get(e){let t;return t="cache"===e?.source?function Uv(n){n=Ce(n,$e);const e=Ce(n.firestore,He),t=yt(e),i=new Zr(e);return function ev(n,e){const t=new ot;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return(i=(0,S.Z)(function*(r,s,a){try{const d=yield function(f,m){const g=H(f);return g.persistence.runTransaction("read document","readonly",y=>g.localDocuments.getDocument(y,m))}(r,s);d.isFoundDocument()?a.resolve(d):d.isNoDocument()?a.resolve(null):a.reject(new L(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=Ra(d,`Failed to get document '${s} from cache`);a.reject(f)}}),function(r,s,a){return i.apply(this,arguments)})(yield vh(n),e,t);var i})),t.promise}(t,n._key).then(r=>new ur(e,i,n._key,r,new ro(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function zv(n){n=Ce(n,$e);const e=Ce(n.firestore,He);return qg(yt(e),n._key,{source:"server"}).then(t=>Op(e,n,t))}(this._delegate):function Vv(n){n=Ce(n,$e);const e=Ce(n.firestore,He);return qg(yt(e),n._key).then(t=>Op(e,n,t))}(this._delegate),t.then(i=>new Du(this.firestore,new ur(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new zn(this.firestore,this._delegate.withConverter(e?so.getInstance(this.firestore,e):null))}}function sn(n,e,t){return n.message=n.message.replace(e,t),n}function D_(n){for(const e of n)if("object"==typeof e&&!Rp(e))return e;return{}}function O_(n,e){var t,i;let r;return r=Rp(n[0])?n[0]:Rp(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class Du{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new zn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return v_(this._delegate,e._delegate)}}class Ou extends Du{data(e){const t=this._delegate.data(e);return function hd(n,e){n||Q()}(void 0!==t),t}}class on{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nh(e)}where(e,t,i){try{return new on(this.firestore,Ur(this._delegate,function Sv(n,e,t){const i=e,r=Sh("where",n);return Su._create(r,i,t)}(e,t,i)))}catch(r){throw sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new on(this.firestore,Ur(this._delegate,function Av(n,e="asc"){const t=e,i=Sh("orderBy",n);return kp._create(i,t)}(e,t)))}catch(i){throw sn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new on(this.firestore,Ur(this._delegate,function kv(n){return Yg("limit",n),Ah._create("limit",n,"F")}(e)))}catch(t){throw sn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new on(this.firestore,Ur(this._delegate,function Dv(n){return Yg("limitToLast",n),Ah._create("limitToLast",n,"L")}(e)))}catch(t){throw sn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new on(this.firestore,Ur(this._delegate,function Ov(...n){return kh._create("startAt",n,!0)}(...e)))}catch(t){throw sn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new on(this.firestore,Ur(this._delegate,function Nv(...n){return kh._create("startAfter",n,!1)}(...e)))}catch(t){throw sn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new on(this.firestore,Ur(this._delegate,function Rv(...n){return Dh._create("endBefore",n,!1)}(...e)))}catch(t){throw sn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new on(this.firestore,Ur(this._delegate,function Pv(...n){return Dh._create("endAt",n,!0)}(...e)))}catch(t){throw sn(t,"endAt()","Query.endAt()")}}isEqual(e){return Tp(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Bv(n){n=Ce(n,$t);const e=Ce(n.firestore,He),t=yt(e),i=new Zr(e);return function tv(n,e){const t=new ot;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return(i=(0,S.Z)(function*(r,s,a){try{const d=yield uh(r,s,!0),f=new Ng(s,d.ir),m=f.sc(d.documents),g=f.applyChanges(m,!1);a.resolve(g.snapshot)}catch(d){const f=Ra(d,`Failed to execute query '${s} against cache`);a.reject(f)}}),function(r,s,a){return i.apply(this,arguments)})(yield vh(n),e,t);var i})),t.promise}(t,n._query).then(r=>new zr(e,i,n,r))}(this._delegate):"server"===e?.source?function Gv(n){n=Ce(n,$t);const e=Ce(n.firestore,He),t=yt(e),i=new Zr(e);return jg(t,n._query,{source:"server"}).then(r=>new zr(e,i,n,r))}(this._delegate):function Zv(n){n=Ce(n,$t);const e=Ce(n.firestore,He),t=yt(e),i=new Zr(e);return d_(n._query),jg(t,n._query).then(r=>new zr(e,i,n,r))}(this._delegate),t.then(i=>new Pp(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=D_(e),i=O_(e,r=>new Pp(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return T_(this._delegate,t,i)}withConverter(e){return new on(this.firestore,this._delegate.withConverter(e?so.getInstance(this.firestore,e):null))}}class m1{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ou(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Pp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new on(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ou(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new m1(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Ou(this._firestore,i))})}isEqual(e){return v_(this._delegate,e._delegate)}}class Za extends on{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new zn(this.firestore,e):null}doc(e){try{return new zn(this.firestore,void 0===e?wh(this._delegate):wh(this._delegate,e))}catch(t){throw sn(t,"doc()","CollectionReference.doc()")}}add(e){return function jv(n,e){const t=Ce(n.firestore,He),i=wh(n),r=Oh(n.converter,e);return za(t,[bh(no(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,Xe.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new zn(this.firestore,t))}isEqual(e){return t_(this._delegate,e._delegate)}withConverter(e){return new Za(this.firestore,this._delegate.withConverter(e?so.getInstance(this.firestore,e):null))}}function oo(n){return Ce(n,$e)}class Mp{constructor(...e){this._delegate=new cr(...e)}static documentId(){return new Mp(je.keyField().canonicalString())}isEqual(e){return(e=(0,he.m9)(e))instanceof cr&&this._delegate._internalPath.isEqual(e._internalPath)}}class ao{constructor(e){this._delegate=e}static serverTimestamp(){const e=function o1(){return new bp("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new ao(e)}static delete(){const e=function s1(){return new Eu("deleteField")}();return e._methodName="FieldValue.delete",new ao(e)}static arrayUnion(...e){const t=function a1(...n){return new Tv("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new ao(t)}static arrayRemove(...e){const t=function c1(...n){return new Ev("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new ao(t)}static increment(e){const t=function u1(n){return new bv("increment",n)}(e);return t._methodName="FieldValue.increment",new ao(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const g1={Firestore:S_,GeoPoint:Th,Timestamp:Ge,Blob:ku,Transaction:A_,WriteBatch:k_,DocumentReference:zn,DocumentSnapshot:Du,Query:on,QueryDocumentSnapshot:Ou,QuerySnapshot:Pp,CollectionReference:Za,FieldPath:Mp,FieldValue:ao,setLogLevel:function p1(n){!function kc(n){Fn.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function N_(n,e){return function v1(n,e=vn.z){return new qn.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}(n,e)}function Lp(n,e){return N_(n,e).pipe((0,ae.U)(t=>({payload:t,type:"query"})))}!function y1(n){(function _1(n,e){n.INTERNAL.registerComponent(new me.wA("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},g1)))})(n,(e,t)=>new S_(e,t,new f1)),n.registerVersion("@firebase/firestore-compat","0.3.12")}(Ct.Z);class R_{constructor(e,t){(0,E.Z)(this,"ref",void 0),(0,E.Z)(this,"afs",void 0),this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:r,query:s}=U_(i,t);return new L_(r,s,this.afs)}snapshotChanges(){return function I1(n,e){return N_(n,e).pipe((0,jn.O)(void 0),k(),(0,ae.U)(t=>{const[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Mt)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ae.U)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,Wt.D)(this.ref.get(e)).pipe(Mt)}}function Rh(n,e){return Lp(n,e).pipe((0,jn.O)(void 0),k(),(0,ae.U)(t=>{const[i,r]=t,s=r.payload.docChanges(),a=s.map(d=>({type:d.type,payload:d}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((d,f)=>{const m=s.find(y=>y.doc.ref.isEqual(d.ref)),g=i?.payload.docs.find(y=>y.ref.isEqual(d.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(d.metadata)||!m&&g&&JSON.stringify(g.metadata)===JSON.stringify(d.metadata)||a.push({type:"modified",payload:{oldIndex:f,newIndex:f,type:"modified",doc:d}})}),a}))}function P_(n,e,t){return Rh(n,t).pipe((0,z.R)((i,r)=>function w1(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function T1(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Fp(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Fp(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Fp(n,e.oldIndex,1)}return n}(n,i))}),n}(i,r.map(s=>s.payload),e),[]),(0,se.x)(),(0,ae.U)(i=>i.map(r=>({type:r.type,payload:r}))))}function Fp(n,e,t,...i){const r=n.slice();return r.splice(e,t,...i),r}function M_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class L_{constructor(e,t,i){(0,E.Z)(this,"ref",void 0),(0,E.Z)(this,"query",void 0),(0,E.Z)(this,"afs",void 0),this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=Rh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ae.U)(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe((0,jn.O)(void 0),k(),(0,M.h)(([i,r])=>r.length>0||!i),(0,ae.U)(([,i])=>i),Mt)}auditTrail(e){return this.stateChanges(e).pipe((0,z.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=M_(e);return P_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Mt)}valueChanges(e={}){return Lp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.payload.docs.map(i=>e.idField?{...i.data(),[e.idField]:i.id}:i.data())),Mt)}get(e){return(0,Wt.D)(this.query.get(e)).pipe(Mt)}add(e){return this.ref.add(e)}doc(e){return new R_(this.ref.doc(e),this.afs)}}class E1{constructor(e,t){(0,E.Z)(this,"query",void 0),(0,E.Z)(this,"afs",void 0),this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Rh(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),(0,M.h)(t=>t.length>0),Mt):Rh(this.query,this.afs.schedulers.outsideAngular).pipe(Mt)}auditTrail(e){return this.stateChanges(e).pipe((0,z.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=M_(e);return P_(this.query,t,this.afs.schedulers.outsideAngular).pipe(Mt)}valueChanges(e={}){return Lp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(i=>i.payload.docs.map(r=>e.idField?{[e.idField]:r.id,...r.data()}:r.data())),Mt)}get(e){return(0,Wt.D)(this.query.get(e)).pipe(Mt)}}const F_=new l.OlP("angularfire2.enableFirestorePersistence"),V_=new l.OlP("angularfire2.firestore.persistenceSettings"),b1=new l.OlP("angularfire2.firestore.settings"),C1=new l.OlP("angularfire2.firestore.use-emulator");function U_(n,e=(t=>t)){return{query:e(n),ref:n}}let z_=(()=>{var n;class e{constructor(i,r,s,a,d,f,m,g,y,C,N,Z,$,W,oe,ve,de){(0,E.Z)(this,"schedulers",void 0),(0,E.Z)(this,"firestore",void 0),(0,E.Z)(this,"persistenceEnabled$",void 0),this.schedulers=m;const fe=Mn(i,f,r),Se=y;C&&Ee(fe,f,N,$,W,oe,Z,ve),[this.firestore,this.persistenceEnabled$]=Pi(`${fe.name}.firestore`,"AngularFirestore",fe.name,()=>{const Ie=f.runOutsideAngular(()=>fe.firestore());if(a&&Ie.settings(a),Se&&Ie.useEmulator(...Se),s&&!(0,v.PM)(d)){const en=()=>{try{return(0,Wt.D)(Ie.enablePersistence(g||void 0).then(()=>!0,()=>!1))}catch(lr){return typeof console<"u"&&console.warn(lr),(0,Gn.of)(!1)}};return[Ie,f.runOutsideAngular(en)]}return[Ie,(0,Gn.of)(!1)]},[a,Se,s])}collection(i,r){let s;s="string"==typeof i?this.firestore.collection(i):i;const{ref:a,query:d}=U_(s,r),f=this.schedulers.ngZone.run(()=>a);return new L_(f,d,this)}collectionGroup(i,r){const s=r||(d=>d),a=this.firestore.collectionGroup(i);return new E1(s(a),this)}doc(i){let r;r="string"==typeof i?this.firestore.doc(i):i;const s=this.schedulers.ngZone.run(()=>r);return new R_(s,this)}createId(){return this.firestore.collection("_").doc().id}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.LFG(xt),l.LFG(Bn,8),l.LFG(F_,8),l.LFG(b1,8),l.LFG(l.Lbi),l.LFG(l.R0b),l.LFG(Tn),l.LFG(V_,8),l.LFG(C1,8),l.LFG(Yt,8),l.LFG(ee,8),l.LFG(ue,8),l.LFG(Ae,8),l.LFG(St,8),l.LFG(ht,8),l.LFG(It,8),l.LFG(Me,8))}),(0,E.Z)(e,"\u0275prov",l.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})),e})(),x1=(()=>{var n;class e{constructor(){Ct.Z.registerVersion("angularfire",ai.full,"fst-compat")}static enablePersistence(i){return{ngModule:e,providers:[{provide:F_,useValue:!0},{provide:V_,useValue:i}]}}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({providers:[z_]})),e})(),Z_=(()=>{var n;class e{constructor(i){this.db=i,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(i){return this.puzzleDataRef.add({...i})}update(i,r){return this.puzzleDataRef.doc(i).update(r)}delete(i){return this.puzzleDataRef.doc(i).delete()}}return(n=e).\u0275fac=function(i){return new(i||n)(l.LFG(z_))},n.\u0275prov=l.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var Gr=q(7423),Nu=q(568),et=q(1591),Ba=q(7594);let Vp=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0),l._UZ(1,"path",1),l.qZA()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})(),Up=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["InfoCircleIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:6,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_408_21102)"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],["id","clip0_408_21102"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0)(1,"g",1),l._UZ(2,"path",2),l.qZA(),l.TgZ(3,"defs")(4,"clipPath",3),l._UZ(5,"rect",4),l.qZA()()()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})(),zp=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["TimesCircleIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:6,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_334_13179)"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],["id","clip0_334_13179"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0)(1,"g",1),l._UZ(2,"path",2),l.qZA(),l.TgZ(3,"defs")(4,"clipPath",3),l._UZ(5,"rect",4),l.qZA()()()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})(),Zp=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:8,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_323_12417)"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],["id","clip0_323_12417"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0)(1,"g",1),l._UZ(2,"path",2)(3,"path",3)(4,"path",4),l.qZA(),l.TgZ(5,"defs")(6,"clipPath",5),l._UZ(7,"rect",6),l.qZA()()()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})();var Ru=q(2132);const B_=["container"];function S1(n,e){if(1&n&&l._UZ(0,"span"),2&n){const t=l.oxw(2);l.Tol("p-toast-message-icon pi "+t.message.icon)}}function A1(n,e){1&n&&l._UZ(0,"CheckIcon")}function k1(n,e){1&n&&l._UZ(0,"InfoCircleIcon")}function D1(n,e){1&n&&l._UZ(0,"TimesCircleIcon")}function O1(n,e){1&n&&l._UZ(0,"ExclamationTriangleIcon")}function N1(n,e){if(1&n&&(l.TgZ(0,"span",11),l.ynx(1),l.YNc(2,A1,1,0,"CheckIcon",3),l.YNc(3,k1,1,0,"InfoCircleIcon",3),l.YNc(4,D1,1,0,"TimesCircleIcon",3),l.YNc(5,O1,1,0,"ExclamationTriangleIcon",3),l.BQk(),l.qZA()),2&n){const t=l.oxw(2);l.xp6(2),l.Q6J("ngIf","success"===t.message.severity),l.xp6(1),l.Q6J("ngIf","info"===t.message.severity),l.xp6(1),l.Q6J("ngIf","error"===t.message.severity),l.xp6(1),l.Q6J("ngIf","warn"===t.message.severity)}}function R1(n,e){if(1&n&&(l.ynx(0),l.YNc(1,S1,1,2,"span",6),l.YNc(2,N1,6,4,"span",7),l.TgZ(3,"div",8)(4,"div",9),l._uU(5),l.qZA(),l.TgZ(6,"div",10),l._uU(7),l.qZA()(),l.BQk()),2&n){const t=l.oxw();l.xp6(1),l.Q6J("ngIf",t.message.icon),l.xp6(1),l.Q6J("ngIf",!t.message.icon),l.xp6(3),l.Oqu(t.message.summary),l.xp6(2),l.Oqu(t.message.detail)}}function P1(n,e){1&n&&l.GkF(0)}function M1(n,e){if(1&n&&l._UZ(0,"span"),2&n){const t=l.oxw(2);l.Tol("p-toast-message-icon pi "+t.message.closeIcon)}}function L1(n,e){1&n&&l._UZ(0,"TimesIcon",14),2&n&&l.Q6J("styleClass","p-toast-icon-close-icon")}function F1(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"button",12),l.NdJ("click",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s.onCloseIconClick(r))})("keydown.enter",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s.onCloseIconClick(r))}),l.YNc(1,M1,1,2,"span",6),l.YNc(2,L1,1,1,"TimesIcon",13),l.qZA()}if(2&n){const t=l.oxw();l.xp6(1),l.Q6J("ngIf",t.message.closeIcon),l.xp6(1),l.Q6J("ngIf",!t.message.closeIcon)}}const V1=function(n){return[n,"p-toast-message"]},U1=function(n,e,t,i){return{showTransformParams:n,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:i}},z1=function(n){return{value:"visible",params:n}},Z1=function(n){return{$implicit:n}};function B1(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"p-toastItem",3),l.NdJ("onClose",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s.onMessageClose(r))})("@toastAnimation.start",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s.onAnimationStart(r))})("@toastAnimation.done",function(r){l.CHM(t);const s=l.oxw();return l.KtG(s.onAnimationEnd(r))}),l.qZA()}if(2&n){const t=e.$implicit,i=e.index,r=l.oxw();l.Q6J("message",t)("index",i)("template",r.template)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}let G1=(()=>{var n;class e{constructor(i){(0,E.Z)(this,"zone",void 0),(0,E.Z)(this,"message",void 0),(0,E.Z)(this,"index",void 0),(0,E.Z)(this,"template",void 0),(0,E.Z)(this,"showTransformOptions",void 0),(0,E.Z)(this,"hideTransformOptions",void 0),(0,E.Z)(this,"showTransitionOptions",void 0),(0,E.Z)(this,"hideTransitionOptions",void 0),(0,E.Z)(this,"onClose",new l.vpe),(0,E.Z)(this,"containerViewChild",void 0),(0,E.Z)(this,"timeout",void 0),this.zone=i}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick(i){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),i.preventDefault()}ngOnDestroy(){this.clearTimeout()}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.Y36(l.R0b))}),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["p-toastItem"]],viewQuery:function(i,r){if(1&i&&l.Gf(B_,5),2&i){let s;l.iGM(s=l.CRH())&&(r.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:"index",template:"template",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},decls:6,vars:21,consts:[[3,"ngClass","mouseenter","mouseleave"],["container",""],["role","alert","aria-live","assertive","aria-atomic","true",1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(i,r){1&i&&(l.TgZ(0,"div",0,1),l.NdJ("mouseenter",function(){return r.onMouseEnter()})("mouseleave",function(){return r.onMouseLeave()}),l.TgZ(2,"div",2),l.YNc(3,R1,8,4,"ng-container",3),l.YNc(4,P1,1,0,"ng-container",4),l.YNc(5,F1,3,2,"button",5),l.qZA()()),2&i&&(l.Tol(r.message.styleClass),l.Q6J("ngClass",l.VKq(10,V1,"p-toast-message-"+r.message.severity))("@messageState",l.VKq(17,z1,l.l5B(12,U1,r.showTransformOptions,r.hideTransformOptions,r.showTransitionOptions,r.hideTransitionOptions))),l.uIk("id",r.message.id),l.xp6(2),l.Q6J("ngClass",r.message.contentStyleClass),l.xp6(1),l.Q6J("ngIf",!r.template),l.xp6(1),l.Q6J("ngTemplateOutlet",r.template)("ngTemplateOutletContext",l.VKq(19,Z1,r.message)),l.xp6(1),l.Q6J("ngIf",!1!==r.message.closable))},dependencies:function(){return[v.mk,v.O5,v.tP,Nu.H,Vp,Up,zp,Zp,Ru.q]},encapsulation:2,data:{animation:[(0,et.X$)("messageState",[(0,et.SB)("visible",(0,et.oB)({transform:"translateY(0)",opacity:1})),(0,et.eR)("void => *",[(0,et.oB)({transform:"{{showTransformParams}}",opacity:0}),(0,et.jt)("{{showTransitionParams}}")]),(0,et.eR)("* => void",[(0,et.jt)("{{hideTransitionParams}}",(0,et.oB)({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})),e})(),q1=(()=>{var n;class e{constructor(i,r,s,a,d){(0,E.Z)(this,"document",void 0),(0,E.Z)(this,"renderer",void 0),(0,E.Z)(this,"messageService",void 0),(0,E.Z)(this,"cd",void 0),(0,E.Z)(this,"config",void 0),(0,E.Z)(this,"key",void 0),(0,E.Z)(this,"autoZIndex",!0),(0,E.Z)(this,"baseZIndex",0),(0,E.Z)(this,"style",void 0),(0,E.Z)(this,"styleClass",void 0),(0,E.Z)(this,"position","top-right"),(0,E.Z)(this,"preventOpenDuplicates",!1),(0,E.Z)(this,"preventDuplicates",!1),(0,E.Z)(this,"showTransformOptions","translateY(100%)"),(0,E.Z)(this,"hideTransformOptions","translateY(-100%)"),(0,E.Z)(this,"showTransitionOptions","300ms ease-out"),(0,E.Z)(this,"hideTransitionOptions","250ms ease-in"),(0,E.Z)(this,"breakpoints",void 0),(0,E.Z)(this,"onClose",new l.vpe),(0,E.Z)(this,"containerViewChild",void 0),(0,E.Z)(this,"templates",void 0),(0,E.Z)(this,"messageSubscription",void 0),(0,E.Z)(this,"clearSubscription",void 0),(0,E.Z)(this,"messages",void 0),(0,E.Z)(this,"messagesArchieve",void 0),(0,E.Z)(this,"template",void 0),(0,E.Z)(this,"styleElement",void 0),(0,E.Z)(this,"id",(0,Gr.Th)()),this.document=i,this.renderer=r,this.messageService=s,this.cd=a,this.config=d}ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(i=>{if(i)if(Array.isArray(i)){const r=i.filter(s=>this.canAdd(s));this.add(r)}else this.canAdd(i)&&this.add([i])}),this.clearSubscription=this.messageService.clearObserver.subscribe(i=>{i?this.key===i&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(i){this.messages=this.messages?[...this.messages,...i]:[...i],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...i]:[...i]),this.cd.markForCheck()}canAdd(i){let r=this.key===i.key;return r&&this.preventOpenDuplicates&&(r=!this.containsMessage(this.messages,i)),r&&this.preventDuplicates&&(r=!this.containsMessage(this.messagesArchieve,i)),r}containsMessage(i,r){return!!i&&null!=i.find(s=>s.summary===r.summary&&s.detail==r.detail&&s.severity===r.severity)}ngAfterContentInit(){this.templates.forEach(i=>{i.getType(),this.template=i.template})}onMessageClose(i){this.messages.splice(i.index,1),this.onClose.emit({message:i.message}),this.cd.detectChanges()}onAnimationStart(i){"void"===i.fromState&&(this.renderer.setAttribute(this.containerViewChild.nativeElement,this.id,""),this.autoZIndex&&""===this.containerViewChild.nativeElement.style.zIndex&&Gr.P9.set("modal",this.containerViewChild.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(i){"void"===i.toState&&this.autoZIndex&&Gr.gb.isEmpty(this.messages)&&Gr.P9.clear(this.containerViewChild.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let i="";for(let r in this.breakpoints){let s="";for(let a in this.breakpoints[r])s+=a+":"+this.breakpoints[r][a]+" !important;";i+=`\n                    @media screen and (max-width: ${r}) {\n                        .p-toast[${this.id}] {\n                           ${s}\n                        }\n                    }\n                `}this.renderer.setProperty(this.styleElement,"innerHTML",i)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Gr.P9.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.Y36(v.K0),l.Y36(l.Qsj),l.Y36(R.ez),l.Y36(l.sBO),l.Y36(R.b4))}),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["p-toast"]],contentQueries:function(i,r,s){if(1&i&&l.Suo(s,R.jx,4),2&i){let a;l.iGM(a=l.CRH())&&(r.templates=a)}},viewQuery:function(i,r){if(1&i&&l.Gf(B_,5),2&i){let s;l.iGM(s=l.CRH())&&(r.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:"preventOpenDuplicates",preventDuplicates:"preventDuplicates",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},decls:3,vars:5,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose"]],template:function(i,r){1&i&&(l.TgZ(0,"div",0,1),l.YNc(2,B1,1,8,"p-toastItem",2),l.qZA()),2&i&&(l.Tol(r.styleClass),l.Q6J("ngClass","p-toast p-component p-toast-"+r.position)("ngStyle",r.style),l.xp6(2),l.Q6J("ngForOf",r.messages))},dependencies:[v.mk,v.sg,v.PC,G1],styles:[".p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-toast-icon-close.p-link{cursor:pointer}\n"],encapsulation:2,data:{animation:[(0,et.X$)("toastAnimation",[(0,et.eR)(":enter, :leave",[(0,et.IO)("@*",(0,et.pV)())])])]},changeDetection:0})),e})(),j1=(()=>{var n;class e{}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({imports:[v.ez,Nu.T,Vp,Up,zp,Zp,Ru.q,R.m8]})),e})();var Ke=q(880);let $1=(()=>{var n;class e{constructor(i){(0,E.Z)(this,"el",void 0),(0,E.Z)(this,"pFocusTrapDisabled",void 0),this.el=i}onkeydown(i){if(!0!==this.pFocusTrapDisabled){i.preventDefault();const r=Ke.p.getNextFocusableElement(this.el.nativeElement,i.shiftKey);r&&(r.focus(),r.select?.())}}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.Y36(l.SBq))}),(0,E.Z)(e,"\u0275dir",l.lG2({type:n,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(i,r){1&i&&l.NdJ("keydown.tab",function(a){return r.onkeydown(a)})("keydown.shift.tab",function(a){return r.onkeydown(a)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}})),e})(),H1=(()=>{var n;class e{}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({imports:[v.ez]})),e})(),G_=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:6,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_414_20927)"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],["id","clip0_414_20927"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0)(1,"g",1),l._UZ(2,"path",2),l.qZA(),l.TgZ(3,"defs")(4,"clipPath",3),l._UZ(5,"rect",4),l.qZA()()()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})(),q_=(()=>{var n;class e extends Ba.s{}return n=e,(0,E.Z)(e,"\u0275fac",function(){let t;return function(r){return(t||(t=l.n5z(n)))(r||n)}}()),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[l.qOj,l.jDz],decls:6,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_414_20939)"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],["id","clip0_414_20939"],["width","14","height","14","fill","white"]],template:function(i,r){1&i&&(l.O4$(),l.TgZ(0,"svg",0)(1,"g",1),l._UZ(2,"path",2),l.qZA(),l.TgZ(3,"defs")(4,"clipPath",3),l._UZ(5,"rect",4),l.qZA()()()),2&i&&(l.Tol(r.getClassNames()),l.uIk("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})),e})();const K1=["titlebar"],W1=["content"],Q1=["footer"];function Y1(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"div",11),l.NdJ("mousedown",function(r){l.CHM(t);const s=l.oxw(3);return l.KtG(s.initResize(r))}),l.qZA()}}function J1(n,e){if(1&n&&(l.TgZ(0,"span",18),l._uU(1),l.qZA()),2&n){const t=l.oxw(4);l.uIk("id",t.id+"-label"),l.xp6(1),l.Oqu(t.header)}}function X1(n,e){if(1&n&&(l.TgZ(0,"span",18),l.Hsn(1,1),l.qZA()),2&n){const t=l.oxw(4);l.uIk("id",t.id+"-label")}}function eI(n,e){1&n&&l.GkF(0)}function tI(n,e){if(1&n&&l._UZ(0,"span",22),2&n){const t=l.oxw(5);l.Q6J("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function nI(n,e){1&n&&l._UZ(0,"WindowMaximizeIcon",24),2&n&&l.Q6J("styleClass","p-dialog-header-maximize-icon")}function iI(n,e){1&n&&l._UZ(0,"WindowMinimizeIcon",24),2&n&&l.Q6J("styleClass","p-dialog-header-maximize-icon")}function rI(n,e){if(1&n&&(l.ynx(0),l.YNc(1,nI,1,1,"WindowMaximizeIcon",23),l.YNc(2,iI,1,1,"WindowMinimizeIcon",23),l.BQk()),2&n){const t=l.oxw(5);l.xp6(1),l.Q6J("ngIf",!t.maximized&&!t.maximizeIconTemplate),l.xp6(1),l.Q6J("ngIf",t.maximized&&!t.minimizeIconTemplate)}}function sI(n,e){}function oI(n,e){1&n&&l.YNc(0,sI,0,0,"ng-template")}function aI(n,e){if(1&n&&(l.ynx(0),l.YNc(1,oI,1,0,null,9),l.BQk()),2&n){const t=l.oxw(5);l.xp6(1),l.Q6J("ngTemplateOutlet",t.maximizeIconTemplate)}}function cI(n,e){}function uI(n,e){1&n&&l.YNc(0,cI,0,0,"ng-template")}function lI(n,e){if(1&n&&(l.ynx(0),l.YNc(1,uI,1,0,null,9),l.BQk()),2&n){const t=l.oxw(5);l.xp6(1),l.Q6J("ngTemplateOutlet",t.minimizeIconTemplate)}}const hI=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function dI(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"button",19),l.NdJ("click",function(){l.CHM(t);const r=l.oxw(4);return l.KtG(r.maximize())})("keydown.enter",function(){l.CHM(t);const r=l.oxw(4);return l.KtG(r.maximize())}),l.YNc(1,tI,1,1,"span",20),l.YNc(2,rI,3,2,"ng-container",21),l.YNc(3,aI,2,1,"ng-container",21),l.YNc(4,lI,2,1,"ng-container",21),l.qZA()}if(2&n){const t=l.oxw(4);l.Q6J("ngClass",l.DdM(5,hI)),l.xp6(1),l.Q6J("ngIf",t.maximizeIcon&&!t.maximizeIconTemplate&&!t.minimizeIconTemplate),l.xp6(1),l.Q6J("ngIf",!t.maximizeIcon),l.xp6(1),l.Q6J("ngIf",!t.maximized),l.xp6(1),l.Q6J("ngIf",t.maximized)}}function fI(n,e){if(1&n&&l._UZ(0,"span",27),2&n){const t=l.oxw(6);l.Q6J("ngClass",t.closeIcon)}}function pI(n,e){1&n&&l._UZ(0,"TimesIcon",24),2&n&&l.Q6J("styleClass","p-dialog-header-close-icon")}function mI(n,e){if(1&n&&(l.ynx(0),l.YNc(1,fI,1,1,"span",26),l.YNc(2,pI,1,1,"TimesIcon",23),l.BQk()),2&n){const t=l.oxw(5);l.xp6(1),l.Q6J("ngIf",t.closeIcon),l.xp6(1),l.Q6J("ngIf",!t.closeIcon)}}function gI(n,e){}function _I(n,e){1&n&&l.YNc(0,gI,0,0,"ng-template")}function yI(n,e){if(1&n&&(l.TgZ(0,"span"),l.YNc(1,_I,1,0,null,9),l.qZA()),2&n){const t=l.oxw(5);l.xp6(1),l.Q6J("ngTemplateOutlet",t.closeIconTemplate)}}const vI=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function II(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"button",25),l.NdJ("click",function(r){l.CHM(t);const s=l.oxw(4);return l.KtG(s.close(r))})("keydown.enter",function(r){l.CHM(t);const s=l.oxw(4);return l.KtG(s.close(r))}),l.YNc(1,mI,3,2,"ng-container",21),l.YNc(2,yI,2,1,"span",21),l.qZA()}if(2&n){const t=l.oxw(4);l.Q6J("ngClass",l.DdM(5,vI)),l.uIk("aria-label",t.closeAriaLabel)("tabindex",t.closeTabindex),l.xp6(1),l.Q6J("ngIf",!t.closeIconTemplate),l.xp6(1),l.Q6J("ngIf",t.closeIconTemplate)}}function wI(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"div",12,13),l.NdJ("mousedown",function(r){l.CHM(t);const s=l.oxw(3);return l.KtG(s.initDrag(r))}),l.YNc(2,J1,2,2,"span",14),l.YNc(3,X1,2,1,"span",14),l.YNc(4,eI,1,0,"ng-container",9),l.TgZ(5,"div",15),l.YNc(6,dI,5,6,"button",16),l.YNc(7,II,3,6,"button",17),l.qZA()()}if(2&n){const t=l.oxw(3);l.xp6(2),l.Q6J("ngIf",!t.headerFacet&&!t.headerTemplate),l.xp6(1),l.Q6J("ngIf",t.headerFacet),l.xp6(1),l.Q6J("ngTemplateOutlet",t.headerTemplate),l.xp6(2),l.Q6J("ngIf",t.maximizable),l.xp6(1),l.Q6J("ngIf",t.closable)}}function TI(n,e){1&n&&l.GkF(0)}function EI(n,e){1&n&&l.GkF(0)}function bI(n,e){if(1&n&&(l.TgZ(0,"div",28,29),l.Hsn(2,2),l.YNc(3,EI,1,0,"ng-container",9),l.qZA()),2&n){const t=l.oxw(3);l.xp6(3),l.Q6J("ngTemplateOutlet",t.footerTemplate)}}const CI=function(n,e,t,i){return{"p-dialog p-component":!0,"p-dialog-rtl":n,"p-dialog-draggable":e,"p-dialog-resizable":t,"p-dialog-maximized":i}},xI=function(n,e){return{transform:n,transition:e}},SI=function(n){return{value:"visible",params:n}};function AI(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"div",3,4),l.NdJ("@animation.start",function(r){l.CHM(t);const s=l.oxw(2);return l.KtG(s.onAnimationStart(r))})("@animation.done",function(r){l.CHM(t);const s=l.oxw(2);return l.KtG(s.onAnimationEnd(r))}),l.YNc(2,Y1,1,0,"div",5),l.YNc(3,wI,8,5,"div",6),l.TgZ(4,"div",7,8),l.Hsn(6),l.YNc(7,TI,1,0,"ng-container",9),l.qZA(),l.YNc(8,bI,4,1,"div",10),l.qZA()}if(2&n){const t=l.oxw(2);l.Tol(t.styleClass),l.Q6J("ngClass",l.l5B(15,CI,t.rtl,t.draggable,t.resizable,t.maximized))("ngStyle",t.style)("pFocusTrapDisabled",!1===t.focusTrap)("@animation",l.VKq(23,SI,l.WLB(20,xI,t.transformOptions,t.transitionOptions))),l.uIk("aria-labelledby",t.id+"-label"),l.xp6(2),l.Q6J("ngIf",t.resizable),l.xp6(1),l.Q6J("ngIf",t.showHeader),l.xp6(1),l.Tol(t.contentStyleClass),l.Q6J("ngClass","p-dialog-content")("ngStyle",t.contentStyle),l.xp6(3),l.Q6J("ngTemplateOutlet",t.contentTemplate),l.xp6(1),l.Q6J("ngIf",t.footerFacet||t.footerTemplate)}}const kI=function(n,e,t,i,r,s,a,d,f,m){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":n,"p-dialog-mask-scrollblocker":e,"p-dialog-left":t,"p-dialog-right":i,"p-dialog-top":r,"p-dialog-top-left":s,"p-dialog-top-right":a,"p-dialog-bottom":d,"p-dialog-bottom-left":f,"p-dialog-bottom-right":m}};function DI(n,e){if(1&n&&(l.TgZ(0,"div",1),l.YNc(1,AI,9,25,"div",2),l.qZA()),2&n){const t=l.oxw();l.Tol(t.maskStyleClass),l.Q6J("ngClass",l.rFY(4,kI,[t.modal,t.modal||t.blockScroll,"left"===t.position,"right"===t.position,"top"===t.position,"topleft"===t.position||"top-left"===t.position,"topright"===t.position||"top-right"===t.position,"bottom"===t.position,"bottomleft"===t.position||"bottom-left"===t.position,"bottomright"===t.position||"bottom-right"===t.position])),l.xp6(1),l.Q6J("ngIf",t.visible)}}const OI=["*",[["p-header"]],[["p-footer"]]],NI=["*","p-header","p-footer"],RI=(0,et.oQ)([(0,et.oB)({transform:"{{transform}}",opacity:0}),(0,et.jt)("{{transition}}")]),PI=(0,et.oQ)([(0,et.jt)("{{transition}}",(0,et.oB)({transform:"{{transform}}",opacity:0}))]);let MI=(()=>{var n;class e{get positionLeft(){return 0}set positionLeft(i){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(i){console.log("positionTop property is deprecated.")}get responsive(){return!1}set responsive(i){console.log("Responsive property is deprecated.")}get breakpoint(){return 649}set breakpoint(i){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}constructor(i,r,s,a,d,f,m){(0,E.Z)(this,"document",void 0),(0,E.Z)(this,"platformId",void 0),(0,E.Z)(this,"el",void 0),(0,E.Z)(this,"renderer",void 0),(0,E.Z)(this,"zone",void 0),(0,E.Z)(this,"cd",void 0),(0,E.Z)(this,"config",void 0),(0,E.Z)(this,"header",void 0),(0,E.Z)(this,"draggable",!0),(0,E.Z)(this,"resizable",!0),(0,E.Z)(this,"contentStyle",void 0),(0,E.Z)(this,"contentStyleClass",void 0),(0,E.Z)(this,"modal",void 0),(0,E.Z)(this,"closeOnEscape",!0),(0,E.Z)(this,"dismissableMask",void 0),(0,E.Z)(this,"rtl",void 0),(0,E.Z)(this,"closable",!0),(0,E.Z)(this,"appendTo",void 0),(0,E.Z)(this,"breakpoints",void 0),(0,E.Z)(this,"styleClass",void 0),(0,E.Z)(this,"maskStyleClass",void 0),(0,E.Z)(this,"showHeader",!0),(0,E.Z)(this,"blockScroll",!1),(0,E.Z)(this,"autoZIndex",!0),(0,E.Z)(this,"baseZIndex",0),(0,E.Z)(this,"minX",0),(0,E.Z)(this,"minY",0),(0,E.Z)(this,"focusOnShow",!0),(0,E.Z)(this,"maximizable",void 0),(0,E.Z)(this,"keepInViewport",!0),(0,E.Z)(this,"focusTrap",!0),(0,E.Z)(this,"transitionOptions","150ms cubic-bezier(0, 0, 0.2, 1)"),(0,E.Z)(this,"closeIcon",void 0),(0,E.Z)(this,"closeAriaLabel",void 0),(0,E.Z)(this,"closeTabindex","-1"),(0,E.Z)(this,"minimizeIcon",void 0),(0,E.Z)(this,"maximizeIcon",void 0),(0,E.Z)(this,"headerFacet",void 0),(0,E.Z)(this,"footerFacet",void 0),(0,E.Z)(this,"templates",void 0),(0,E.Z)(this,"headerViewChild",void 0),(0,E.Z)(this,"contentViewChild",void 0),(0,E.Z)(this,"footerViewChild",void 0),(0,E.Z)(this,"onShow",new l.vpe),(0,E.Z)(this,"onHide",new l.vpe),(0,E.Z)(this,"visibleChange",new l.vpe),(0,E.Z)(this,"onResizeInit",new l.vpe),(0,E.Z)(this,"onResizeEnd",new l.vpe),(0,E.Z)(this,"onDragEnd",new l.vpe),(0,E.Z)(this,"onMaximize",new l.vpe),(0,E.Z)(this,"headerTemplate",void 0),(0,E.Z)(this,"contentTemplate",void 0),(0,E.Z)(this,"footerTemplate",void 0),(0,E.Z)(this,"maximizeIconTemplate",void 0),(0,E.Z)(this,"closeIconTemplate",void 0),(0,E.Z)(this,"minimizeIconTemplate",void 0),(0,E.Z)(this,"_visible",void 0),(0,E.Z)(this,"maskVisible",void 0),(0,E.Z)(this,"container",void 0),(0,E.Z)(this,"wrapper",void 0),(0,E.Z)(this,"dragging",void 0),(0,E.Z)(this,"documentDragListener",void 0),(0,E.Z)(this,"documentDragEndListener",void 0),(0,E.Z)(this,"resizing",void 0),(0,E.Z)(this,"documentResizeListener",void 0),(0,E.Z)(this,"documentResizeEndListener",void 0),(0,E.Z)(this,"documentEscapeListener",void 0),(0,E.Z)(this,"maskClickListener",void 0),(0,E.Z)(this,"lastPageX",void 0),(0,E.Z)(this,"lastPageY",void 0),(0,E.Z)(this,"preventVisibleChangePropagation",void 0),(0,E.Z)(this,"maximized",void 0),(0,E.Z)(this,"preMaximizeContentHeight",void 0),(0,E.Z)(this,"preMaximizeContainerWidth",void 0),(0,E.Z)(this,"preMaximizeContainerHeight",void 0),(0,E.Z)(this,"preMaximizePageX",void 0),(0,E.Z)(this,"preMaximizePageY",void 0),(0,E.Z)(this,"id",(0,Gr.Th)()),(0,E.Z)(this,"_style",{}),(0,E.Z)(this,"_position","center"),(0,E.Z)(this,"originalStyle",void 0),(0,E.Z)(this,"transformOptions","scale(0.7)"),(0,E.Z)(this,"styleElement",void 0),(0,E.Z)(this,"window",void 0),this.document=i,this.platformId=r,this.el=s,this.renderer=a,this.zone=d,this.cd=f,this.config=m,this.window=this.document.defaultView}ngAfterContentInit(){this.templates.forEach(i=>{switch(i.getType()){case"header":this.headerTemplate=i.template;break;case"content":default:this.contentTemplate=i.template;break;case"footer":this.footerTemplate=i.template;break;case"closeicon":this.closeIconTemplate=i.template;break;case"maximizeicon":this.maximizeIconTemplate=i.template;break;case"minimizeicon":this.minimizeIconTemplate=i.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}get visible(){return this._visible}set visible(i){this._visible=i,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(i){i&&(this._style={...i},this.originalStyle=i)}get position(){return this._position}set position(i){switch(this._position=i,i){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}focus(){let i=Ke.p.findSingle(this.container,"[autofocus]");i&&this.zone.runOutsideAngular(()=>{setTimeout(()=>i.focus(),5)})}close(i){this.visibleChange.emit(!1),i.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",i=>{this.wrapper&&this.wrapper.isSameNode(i.target)&&this.close(i)})),this.modal&&Ke.p.addClass(this.document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&Ke.p.removeClass(this.document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?Ke.p.addClass(this.document.body,"p-overflow-hidden"):Ke.p.removeClass(this.document.body,"p-overflow-hidden")),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(Gr.P9.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if((0,v.NF)(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let i="";for(let r in this.breakpoints)i+=`\n                        @media screen and (max-width: ${r}) {\n                            .p-dialog[${this.id}] {\n                                width: ${this.breakpoints[r]} !important;\n                            }\n                        }\n                    `;this.renderer.setProperty(this.styleElement,"innerHTML",i)}}initDrag(i){Ke.p.hasClass(i.target,"p-dialog-header-icon")||Ke.p.hasClass(i.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=i.pageX,this.lastPageY=i.pageY,this.container.style.margin="0",Ke.p.addClass(this.document.body,"p-unselectable-text"))}onKeydown(i){if(this.focusTrap&&9===i.which){i.preventDefault();let r=Ke.p.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let s=r.indexOf(r[0].ownerDocument.activeElement);i.shiftKey?-1==s||0===s?r[r.length-1].focus():r[s-1].focus():-1==s||s===r.length-1?r[0].focus():r[s+1].focus()}else r[0].focus()}}onDrag(i){if(this.dragging){let r=Ke.p.getOuterWidth(this.container),s=Ke.p.getOuterHeight(this.container),a=i.pageX-this.lastPageX,d=i.pageY-this.lastPageY,f=this.container.getBoundingClientRect(),m=f.left+a,g=f.top+d,y=Ke.p.getViewport();this.container.style.position="fixed",this.keepInViewport?(m>=this.minX&&m+r<y.width&&(this._style.left=m+"px",this.lastPageX=i.pageX,this.container.style.left=m+"px"),g>=this.minY&&g+s<y.height&&(this._style.top=g+"px",this.lastPageY=i.pageY,this.container.style.top=g+"px")):(this.lastPageX=i.pageX,this.container.style.left=m+"px",this.lastPageY=i.pageY,this.container.style.top=g+"px")}}endDrag(i){this.dragging&&(this.dragging=!1,Ke.p.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(i))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(i){this.resizable&&(this.resizing=!0,this.lastPageX=i.pageX,this.lastPageY=i.pageY,Ke.p.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(i))}onResize(i){if(this.resizing){let r=i.pageX-this.lastPageX,s=i.pageY-this.lastPageY,a=Ke.p.getOuterWidth(this.container),d=Ke.p.getOuterHeight(this.container),f=Ke.p.getOuterHeight(this.contentViewChild.nativeElement),m=a+r,g=d+s,y=this.container.style.minWidth,C=this.container.style.minHeight,N=this.container.getBoundingClientRect(),Z=Ke.p.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(m+=r,g+=s),(!y||m>parseInt(y))&&N.left+m<Z.width&&(this._style.width=m+"px",this.container.style.width=this._style.width),(!C||g>parseInt(C))&&N.top+g<Z.height&&(this.contentViewChild.nativeElement.style.height=f+g-d+"px",this._style.height&&(this._style.height=g+"px",this.container.style.height=this._style.height)),this.lastPageX=i.pageX,this.lastPageY=i.pageY}}resizeEnd(i){this.resizing&&(this.resizing=!1,Ke.p.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(i))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",r=>{27==r.which&&this.close(r)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?this.renderer.appendChild(this.document.body,this.wrapper):Ke.p.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(i){switch(i.toState){case"visible":this.container=i.element,this.wrapper=this.container.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&Ke.p.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&Ke.p.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(i){switch(i.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(Ke.p.removeClass(this.document.body,"p-overflow-hidden"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&Ke.p.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&Gr.P9.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)(l.Y36(v.K0),l.Y36(l.Lbi),l.Y36(l.SBq),l.Y36(l.Qsj),l.Y36(l.R0b),l.Y36(l.sBO),l.Y36(R.b4))}),(0,E.Z)(e,"\u0275cmp",l.Xpm({type:n,selectors:[["p-dialog"]],contentQueries:function(i,r,s){if(1&i&&(l.Suo(s,R.h4,5),l.Suo(s,R.$_,5),l.Suo(s,R.jx,4)),2&i){let a;l.iGM(a=l.CRH())&&(r.headerFacet=a.first),l.iGM(a=l.CRH())&&(r.footerFacet=a.first),l.iGM(a=l.CRH())&&(r.templates=a)}},viewQuery:function(i,r){if(1&i&&(l.Gf(K1,5),l.Gf(W1,5),l.Gf(Q1,5)),2&i){let s;l.iGM(s=l.CRH())&&(r.headerViewChild=s.first),l.iGM(s=l.CRH())&&(r.contentViewChild=s.first),l.iGM(s=l.CRH())&&(r.footerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:NI,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(i,r){1&i&&(l.F$t(OI),l.YNc(0,DI,2,15,"div",0)),2&i&&l.Q6J("ngIf",r.maskVisible)},dependencies:function(){return[v.mk,v.O5,v.tP,v.PC,$1,Nu.H,Ru.q,G_,q_]},styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[(0,et.X$)("animation",[(0,et.eR)("void => visible",[(0,et._7)(RI)]),(0,et.eR)("visible => void",[(0,et._7)(PI)])])]},changeDetection:0})),e})(),LI=(()=>{var n;class e{}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({imports:[v.ez,H1,Nu.T,Ru.q,G_,q_,R.m8]})),e})();var Ph=q(5829);function FI(n,e){if(1&n&&(l.TgZ(0,"div")(1,"span",6),l._uU(2),l.qZA()()),2&n){const t=l.oxw();l.xp6(2),l.hij(" ",t.stageLevel.value," ")}}function VI(n,e){if(1&n&&l._uU(0),2&n){const t=l.oxw();l.hij(" ",t.stageLevel.value," ")}}function UI(n,e){1&n&&(l.TgZ(0,"span",9),l._UZ(1,"i",10),l.qZA())}function zI(n,e){if(1&n&&(l.TgZ(0,"div",7),l.YNc(1,UI,2,0,"span",8),l.qZA()),2&n){const t=l.oxw();l.xp6(1),l.Q6J("ngForOf",t.stars)}}function ZI(n,e){1&n&&(l.TgZ(0,"span",12),l._UZ(1,"i",10),l.qZA())}function BI(n,e){if(1&n&&(l.TgZ(0,"div"),l.YNc(1,ZI,2,0,"span",11),l.qZA()),2&n){const t=l.oxw(2);l.xp6(1),l.Q6J("ngForOf",t.stars)}}function GI(n,e){1&n&&(l.TgZ(0,"span",14),l._UZ(1,"i",15),l.qZA())}function qI(n,e){if(1&n&&l.YNc(0,GI,2,0,"span",13),2&n){const t=l.oxw(2);l.Q6J("ngForOf",t.stars)}}function jI(n,e){if(1&n&&(l.TgZ(0,"div",7),l.YNc(1,BI,2,1,"div",2),l.YNc(2,qI,1,1,"ng-template",null,3,l.W1O),l.qZA()),2&n){const t=l.MAs(3),i=l.oxw();l.xp6(1),l.Q6J("ngIf",i.stageLevel.completed)("ngIfElse",t)}}const $I=function(n,e){return{"stage-level-number-unselected":n,"stage-level-number-selected":e}};let HI=(()=>{var n;class e{constructor(){this.stars=new Array(1,2,3)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=l.Xpm({type:n,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:9,vars:8,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[4,"ngIf","ngIfElse"],["NOT_COMPLETED",""],["style","display: flex; justify-content: center;",4,"ngIf","ngIfElse"],["STAGE_LEVEL_NOT_SELECTED",""],[1,"stage-level-completed-value"],[2,"display","flex","justify-content","center"],["class","stage-level-asterisk-selected",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],["class","stage-level-asterisk-unselected stage-level-completed",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-unselected","stage-level-completed"],["class","stage-level-asterisk-unselected",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-unselected"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(i,r){if(1&i&&(l.TgZ(0,"div",0)(1,"div",1),l.YNc(2,FI,3,1,"div",2),l.YNc(3,VI,1,1,"ng-template",null,3,l.W1O),l.qZA(),l.TgZ(5,"div"),l.YNc(6,zI,2,1,"div",4),l.YNc(7,jI,4,2,"ng-template",null,5,l.W1O),l.qZA()()),2&i){const s=l.MAs(4),a=l.MAs(8);l.xp6(1),l.Q6J("ngClass",l.WLB(5,$I,!r.stageLevel.selected,r.stageLevel.selected)),l.xp6(1),l.Q6J("ngIf",r.stageLevel.completed)("ngIfElse",s),l.xp6(4),l.Q6J("ngIf",r.stageLevel.selected)("ngIfElse",a)}},dependencies:[v.mk,v.sg,v.O5,Ph.oO],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]}),e})();function KI(n,e){1&n&&(l.TgZ(0,"div")(1,"span",3),l._uU(2,"No stage levels defined!"),l.qZA()())}const WI=function(n){return{"border-bottom":n}};function QI(n,e){if(1&n&&(l.TgZ(0,"div",6),l._UZ(1,"app-stage-level",7),l.qZA()),2&n){const t=e.$implicit;l.Q6J("ngStyle",l.VKq(2,WI,t.selected?"none":"1px solid #d4d4d4")),l.xp6(1),l.Q6J("stageLevel",t)}}function YI(n,e){if(1&n&&(l.TgZ(0,"div",4),l.YNc(1,QI,2,4,"div",5),l.qZA()),2&n){const t=l.oxw();l.xp6(1),l.Q6J("ngForOf",t.stageLevels)}}let JI=(()=>{var n;class e{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=l.Xpm({type:n,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:4,vars:2,consts:[[1,"game-stage-level-layout"],[4,"ngIf","ngIfElse"],["HAS_STAGE_LEVELS",""],[1,"warning-message"],[1,"stage-levels"],["class","stage-level",3,"ngStyle",4,"ngFor","ngForOf"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(i,r){if(1&i&&(l.TgZ(0,"div",0),l.YNc(1,KI,3,0,"div",1),l.YNc(2,YI,2,1,"ng-template",null,2,l.W1O),l.qZA()),2&i){const s=l.MAs(3);l.xp6(1),l.Q6J("ngIf",r.NO_STAGE_LEVELS)("ngIfElse",s)}},dependencies:[v.sg,v.O5,v.PC,Ph.Zl,HI],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]}),e})();class j_{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}}class $_{constructor(e,t,i){this.operands=e,this.operator=t,this.result=i}}var Bp=q(430),XI=q(6550);const H_=function(n){return{"background-color":n}};function ew(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"button",8),l.NdJ("click",function(){l.CHM(t);const r=l.oxw().$implicit,s=l.oxw();return l.KtG(s.onOperandButtonClick(r))}),l._uU(1),l.qZA()}if(2&n){const t=l.oxw().$implicit;l.Q6J("disabled",t.disabled)("ngStyle",l.VKq(4,H_,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",t.disabled||t.selected?"operator-content-button-disabled":"operator-content-button"),l.xp6(1),l.hij("",t.value," ")}}function tw(n,e){if(1&n&&(l.ynx(0),l.YNc(1,ew,2,6,"button",7),l.BQk()),2&n){const t=e.index;l.xp6(1),l.Q6J("ngIf",t<3)}}function nw(n,e){if(1&n){const t=l.EpF();l.TgZ(0,"button",8),l.NdJ("click",function(){l.CHM(t);const r=l.oxw().$implicit,s=l.oxw();return l.KtG(s.onOperandButtonClick(r))}),l._uU(1),l.qZA()}if(2&n){const t=l.oxw().$implicit;l.Q6J("disabled",t.disabled)("ngStyle",l.VKq(4,H_,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",t.disabled||t.selected?"operator-content-button-disabled":"operator-content-button"),l.xp6(1),l.hij("",t.value," ")}}function iw(n,e){if(1&n&&(l.ynx(0),l.YNc(1,nw,2,6,"button",7),l.BQk()),2&n){const t=e.index;l.xp6(1),l.Q6J("ngIf",t>2)}}function rw(n,e){if(1&n){const t=l.EpF();l.ynx(0),l.TgZ(1,"button",9),l.NdJ("click",function(){const s=l.CHM(t).$implicit,a=l.oxw();return l.KtG(a.onOperatorButtonClick(s))}),l._UZ(2,"mat-icon",10),l.qZA(),l.BQk()}if(2&n){const t=e.$implicit,i=e.index;l.xp6(1),l.Q6J("ngClass",0===i?"revert-button":"arithmetic-operation-button"),l.xp6(1),l.s9C("svgIcon",t.icon)}}let sw=(()=>{var n;class e{constructor(i,r){this.operators=new Array({selected:!1,caption:X.OPERATOR_REV,operator:X.OPERATOR_REV,icon:"revert"},{selected:!1,caption:X.OPERATOR_ADD,operator:X.OPERATOR_ADD,icon:"addition"},{selected:!1,caption:X.OPERATOR_SUB,operator:X.OPERATOR_SUB,icon:"substraction"},{selected:!1,caption:X.OPERATOR_MUL,operator:X.OPERATOR_MUL,icon:"multiplication"},{selected:!1,caption:X.OPERATOR_DIV,operator:X.OPERATOR_DIV,icon:"division"}),this.onExpectedResultReached=new l.vpe,this.onInvalidOperationExecuted=new l.vpe,i.addSvgIcon("revert",r.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),i.addSvgIcon("addition",r.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),i.addSvgIcon("substraction",r.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),i.addSvgIcon("multiplication",r.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),i.addSvgIcon("division",r.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(i=>i.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(i=>{i.selected=!1})}isTheExpectedResultReached(i){return this.gameParameters.result===i}addStateToHistory(i){this.history.push(i)}clearSelectionOfOperators(){this.operators.forEach(i=>{i.selected=!1})}addGameOperationToOperationHistory(i){this.operationHistory?.push(i)}ngOnInit(){this.history=new j_,this.operationHistory=new j_}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(i=>{i.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(i){if(i.selected=!i.selected,!i.selected){if(this.selectedOperandB&&this.selectedOperandB.id===i.id)return this.selectedOperandB.selected=!1,void(this.selectedOperandB=null);if(this.selectedOperandA&&this.selectedOperandA.id===i.id)return this.selectedOperandA.selected=!1,void(this.selectedOperandA=null)}this.selectedOperandA?this.selectedOperandA.id!==i.id&&(this.selectedOperandB||(this.selectedOperandB=i)):this.selectedOperandA=i;var r=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!r)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&r){let s=Fe.cloneGameParameters(this.gameParameters),a=Fe.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,r.operator);if(this.addStateToHistory(s),a===Number.MIN_VALUE)this.onInvalidOperationExecuted.emit(a);else{let d=new Array(this.selectedOperandA.value,this.selectedOperandB.value),f=new $_(d,r.operator,a);this.addGameOperationToOperationHistory(f),this.isTheExpectedResultReached(a)&&this.onExpectedResultReached.emit(this.operationHistory),i.value=a,this.gameParameters.operands.find(g=>g.id==this.selectedOperandA.id).disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${i.value} Selected ${i.selected}`)}onOperatorButtonClick(i){if(this.selectedOperandA||i.operator===X.OPERATOR_REV){if(i.selected=!i.selected,i.operator===X.OPERATOR_REV){this.revertLastOperation();let r=Fe.cloneGameParameters(this.gameParameters),s=new Array;r.operands.forEach(d=>{s.push(d.value)});let a=new $_(s,i.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(a)}console.log(`Caption ${i.caption} Selected ${i.selected}`)}else i.selected=!1}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}}return(n=e).\u0275fac=function(i){return new(i||n)(l.Y36(Bp.jv),l.Y36(XI.H7))},n.\u0275cmp=l.Xpm({type:n,selectors:[["app-game-arithmetic-operations"]],inputs:{gameParameters:"gameParameters"},outputs:{onExpectedResultReached:"onExpectedResultReached",onInvalidOperationExecuted:"onInvalidOperationExecuted"},decls:13,vars:4,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],[4,"ngFor","ngForOf"],[1,"operators-container"],["type","button","class","operand",3,"disabled","ngStyle","ngClass","click",4,"ngIf"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass","click"],["type","button",1,"operator-content",3,"ngClass","click"],[1,"operator-content-icon",3,"svgIcon"]],template:function(i,r){1&i&&(l.TgZ(0,"div",0)(1,"div",1),l._uU(2,"Use the any combination of number to reach the target:"),l.qZA(),l.TgZ(3,"div")(4,"label",2),l._uU(5),l.qZA()(),l.TgZ(6,"div",3)(7,"div",4),l.YNc(8,tw,2,1,"ng-container",5),l.qZA(),l.TgZ(9,"div",4),l.YNc(10,iw,2,1,"ng-container",5),l.qZA()(),l.TgZ(11,"div",6),l.YNc(12,rw,3,2,"ng-container",5),l.qZA()()),2&i&&(l.xp6(5),l.Oqu(r.gameParameters.result),l.xp6(3),l.Q6J("ngForOf",r.gameParameters.operands),l.xp6(2),l.Q6J("ngForOf",r.gameParameters.operands),l.xp6(2),l.Q6J("ngForOf",r.operators))},dependencies:[v.mk,v.sg,v.O5,v.PC,Ph.oO,Ph.Zl,Bp.Hw],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:7px}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;padding:32px 23px 30px 20px;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"]}),e})();const ow=["arithmeticOperations"];function aw(n,e){if(1&n&&(l.TgZ(0,"li",15),l._uU(1),l.qZA()),2&n){const t=e.$implicit;l.xp6(1),l.hij(" ",t," ")}}function cw(n,e){if(1&n&&(l.TgZ(0,"li",15),l._uU(1),l.qZA()),2&n){const t=e.$implicit;l.xp6(1),l.hij(" ",t," ")}}const uw=[{path:"digits/digits-game",component:(()=>{var n;class e{constructor(i,r,s,a){this.messageService=i,this.cookieService=r,this.clipboardService=s,this.numbersFirestoreService=a,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new ke,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw"}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(i){let r="Completed! Executed Operations:\n",s=i.size()-1;for(;s>=0;){const a=i.peekBy(s);r+=s+1+". "+a?.operands[0]+" "+a?.operator+" "+a?.operands[1]+" = "+a?.result+"\n",--s}return r}createSummaryOfTHeOperations(i,r){let s=this.stageLevels[i].value+" -> ";for(this.gameCompletedModalMessages=[];r.size()>0;){const a=r.pop();this.gameCompletedModalMessages.push(a?.operands[0]+" "+a.operator+" "+a?.operands[1]+" = "+a?.result),s+=""+a?.operator}return s+="\n",s}showSuccessMessage(i){this.messageService.add({severity:"success",summary:"Congratulation!",detail:i})}showErrorMessage(i){this.messageService.add({severity:"error",summary:"Error!",detail:i})}setupStages(){let i=0;this.gameParameters.forEach(r=>{this.stageLevels[i].value=r.result,++i})}storeGameStateToCookie(){let i=new B;i.storeDate=new Date,i.stageIndex=this.stageIndex,i.stageLevels=this.stageLevels,i.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,i.gameParameters=this.gameParameters;let r=i.cookieData2Text(),s=new Date;s.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,r,s)}restoreGameStateFromCookie(){let r,i=this.cookieService.get(this.COOKIE_LK_DIGITS);return i&&""!=i?(r=new B,r=r.text2CookieData(i)):(console.log("INFO: Unable to retrieve the Game State"),r=null),r}mapPuzzleDataToGameParameters(i){i.stages.forEach(r=>{let s=this.gameParameters.find(a=>a.stageIndex===r.stageIndex);if(s){s.result=r.expectedValue;let a=0;s.operands.forEach(f=>{f.value=r.operands[a],a++}),this.initializeStageLevels(),this.stageLevels.find(f=>f.index===r.stageIndex)}})}mapGameParametersToPuzzleData(i){let r=new Pe;return r.day=new Date,r.day.setHours(23,59,59,999),i.forEach(s=>{let a=new Zt;a.stageIndex=s.stageIndex,a.expectedValue=s.result;let d=new Array;s.operands.forEach(f=>{d.push(f.value)}),a.operands=d,r.stages.push(a)}),r}isDateSame(i,r){return i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()&&i.getDate()===r.getDate()}updatePuzzleDataInDb(i){this.firestorePuzzleData.data=JSON.stringify(i),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(r=>console.log(r))}createPuzzleDataInDb(i){this.numbersFirestoreService.create(i).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){let i=navigator.language;return void 0!==this.firestorePuzzleDataItems.find(s=>s.locale===i)}upsertGameDataInDb(i){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(i);else{const r=new Ve;r.locale=navigator.language,r.data=JSON.stringify(i),this.createPuzzleDataInDb(r)}}allGameCompleted(){let i=!0;return this.stageLevels.forEach(r=>{i=i&&r.completed}),i}collectAllOperations(){let i=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(i){let r="Genius!\n";this.allGameCompletedModalMessage=[],this.stageLevels.forEach(s=>{r+=s.summary,this.allGameCompletedModalMessage.push(s.summary)}),this.clipboardService.copy(r),this.allGameCompletedModalVisible=!0}return i}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let i=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(i)}loadGameDataFromDB(){let i=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe((0,ae.U)(r=>r.map(s=>({id:s.payload.doc.id,...s.payload.doc.data()})))).subscribe(r=>{this.firestorePuzzleDataItems=r;let s=r.find(a=>a.locale===i);s&&(this.firestorePuzzleData=s)})}ngOnInit(){this.initializeStageLevels();let i=this.restoreGameStateFromCookie();if(i){console.log("INFO: Game state restored from cookie");const r=new Date(i.storeDate);if(this.isDateSame(r,new Date))this.stageIndex=i.stageIndex,this.stageLevels=i.stageLevels,this.gameParameters=i.gameParameters,this.setupStages(),i.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.loadGameDataFromDB(),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let s=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+s),this.upsertGameDataInDb(s)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();let r=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe((0,ae.U)(s=>s.map(a=>({id:a.payload.doc.id,...a.payload.doc.data()})))).subscribe(s=>{this.firestorePuzzleDataItems=s;let a=s.find(d=>d.locale===r);if(a){this.firestorePuzzleData=a,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");const d=new Date,f=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(f,d))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let m=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(m)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let d=this.mapGameParametersToPuzzleData(this.gameParameters);const f=new Ve;f.locale=navigator.language,f.data=JSON.stringify(d),this.createPuzzleDataInDb(f)}})}}onExpectedResultReached(i){const r=this.formatOperations(i),s=this.createSummaryOfTHeOperations(this.stageIndex,i);this.stageLevels[this.stageIndex].summary=s,this.clipboardService.copy(r),this.showSuccessMessage("You are reach the expected result!"),this.gameCompletedModalVisible=!0,this.stageToCompleted()}onGameCompletedHide(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}onInvalidOperationExecuted(i){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(i)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}}return(n=e).\u0275fac=function(i){return new(i||n)(l.Y36(R.ez),l.Y36(ne),l.Y36(Bt),l.Y36(Z_))},n.\u0275cmp=l.Xpm({type:n,selectors:[["app-digits-game"]],viewQuery:function(i,r){if(1&i&&l.Gf(ow,7),2&i){let s;l.iGM(s=l.CRH())&&(r.arithmeticComponent=s.first)}},features:[l._Bn([R.ez,ne])],decls:31,vars:15,consts:[[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"gameParameters","onExpectedResultReached","onInvalidOperationExecuted"],["arithmeticOperations",""],["id","splashscreen","header","Welcome to the Numbers Game",3,"visible","modal","visibleChange"],["id","gameCompleted","header","Game Completed",3,"visible","modal","visibleChange","onHide"],["class","li-no-bullet",4,"ngFor","ngForOf"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visible","modal","closable","visibleChange"],[1,"li-no-bullet"]],template:function(i,r){1&i&&(l.TgZ(0,"div",0),l._UZ(1,"p-toast",1),l.TgZ(2,"div",2),l._uU(3," This is a daily numbers puzzle, similar to the "),l.TgZ(4,"a",3),l._uU(5,"NY Times Digits"),l.qZA(),l._uU(6,", which unfortunately discontinued at August 8, 2023 "),l.qZA(),l.TgZ(7,"div",4)(8,"div",5),l.NdJ("click",function(){return r.onDeleteCookie()}),l._uU(9," Numbers "),l.qZA(),l.TgZ(10,"div",6),l.NdJ("click",function(){return r.onUpdatePuzzleData()}),l._uU(11),l.ALo(12,"date"),l.qZA()(),l.TgZ(13,"div",7),l._UZ(14,"app-game-stage-levels",8),l.qZA(),l.TgZ(15,"div")(16,"app-game-arithmetic-operations",9,10),l.NdJ("onExpectedResultReached",function(a){return r.onExpectedResultReached(a)})("onInvalidOperationExecuted",function(a){return r.onInvalidOperationExecuted(a)}),l.qZA()()(),l.TgZ(18,"p-dialog",11),l.NdJ("visibleChange",function(a){return r.splashVisible=a}),l.TgZ(19,"p"),l._uU(20,'"Numbers" game is a prototype only!'),l.qZA(),l.TgZ(21,"p"),l._uU(22,"I'm open for any feedback! (ujtordaikovari@gmail.com) "),l.qZA()(),l.TgZ(23,"p-dialog",12),l.NdJ("visibleChange",function(a){return r.gameCompletedModalVisible=a})("onHide",function(){return r.onGameCompletedHide()}),l.TgZ(24,"div"),l._uU(25," Your solution: "),l.YNc(26,aw,2,1,"li",13),l.qZA()(),l.TgZ(27,"p-dialog",14),l.NdJ("visibleChange",function(a){return r.allGameCompletedModalVisible=a}),l.TgZ(28,"div"),l._uU(29," Congratulation! Your Solutions: "),l.YNc(30,cw,2,1,"li",13),l.qZA()()),2&i&&(l.xp6(11),l.hij(" ",l.xi3(12,12,r.currentDate,"MM/dd/yyyy")," "),l.xp6(3),l.Q6J("stageLevels",r.stageLevels),l.xp6(2),l.Q6J("gameParameters",r.gameParameters[r.stageIndex]),l.xp6(2),l.Q6J("visible",r.splashVisible)("modal",!0),l.xp6(5),l.Q6J("visible",r.gameCompletedModalVisible)("modal",!0),l.xp6(3),l.Q6J("ngForOf",r.gameCompletedModalMessages),l.xp6(1),l.Q6J("visible",r.allGameCompletedModalVisible)("modal",!0)("closable",!1),l.xp6(3),l.Q6J("ngForOf",r.allGameCompletedModalMessage))},dependencies:[v.sg,q1,MI,JI,sw,v.uU],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:100vw;width:50vw;position:absolute;inset:0;margin:auto;background:rgba(235,249,253,.25);border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:101vh;width:101vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]}),e})()}];let lw=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=l.oAB({type:n}),n.\u0275inj=l.cJS({imports:[v.ez,te.Bz.forChild(uw),te.Bz]}),e})();var hw=q(9814);let kw=(()=>{var n;class e{}return n=e,(0,E.Z)(e,"\u0275fac",function(i){return new(i||n)}),(0,E.Z)(e,"\u0275mod",l.oAB({type:n})),(0,E.Z)(e,"\u0275inj",l.cJS({imports:[v.ez,Nu.T,Vp,Up,zp,Zp,Ru.q]})),e})();var Dw=q(2340);let Ow=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=l.oAB({type:n}),n.\u0275inj=l.cJS({providers:[Z_],imports:[v.ez,te.Bz,j1,kw,lw,hw.o9,Bp.Ps,Ue,bn.initializeApp(Dw.N.firebasePuzzleData),x1,LI]}),e})()},6101:(qr,Ut,q)=>{q.d(Ut,{Z:()=>Zt});var v=q(2090),te=q(4859),R=q(7212),X=q(1877);class vt{constructor(ge,_e){this._delegate=ge,this.firebase=_e,(0,R._addComponent)(ge,new te.wA("app-compat",()=>this,"PUBLIC")),this.container=ge.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ge){this._delegate.automaticDataCollectionEnabled=ge}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ge=>{this._delegate.checkDestroyed(),ge()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,R.deleteApp)(this._delegate)))}_getService(ge,_e=R._DEFAULT_ENTRY_NAME){var Bt;this._delegate.checkDestroyed();const an=this._delegate.container.getProvider(ge);return!an.isInitialized()&&"EXPLICIT"===(null===(Bt=an.getComponent())||void 0===Bt?void 0:Bt.instantiationMode)&&an.initialize(),an.getImmediate({identifier:_e})}_removeServiceInstance(ge,_e=R._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ge).clearInstance(_e)}_addComponent(ge){(0,R._addComponent)(this._delegate,ge)}_addOrOverwriteComponent(ge){(0,R._addOrOverwriteComponent)(this._delegate,ge)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Fe=new v.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),B=function ke(){const Ve=function zt(Ve){const ge={},_e={__esModule:!0,initializeApp:function Rt(we,Pt={}){const F=R.initializeApp(we,Pt);if((0,v.r3)(ge,F.name))return ge[F.name];const nt=new Ve(F,_e);return ge[F.name]=nt,nt},app:an,registerVersion:R.registerVersion,setLogLevel:R.setLogLevel,onLog:R.onLog,apps:null,SDK_VERSION:R.SDK_VERSION,INTERNAL:{registerComponent:function E(we){const Pt=we.name,F=Pt.replace("-compat","");if(R._registerComponent(we)&&"PUBLIC"===we.type){const nt=(ct=an())=>{if("function"!=typeof ct[F])throw Fe.create("invalid-app-argument",{appName:Pt});return ct[F]()};void 0!==we.serviceProps&&(0,v.ZB)(nt,we.serviceProps),_e[F]=nt,Ve.prototype[F]=function(...ct){return this._getService.bind(this,Pt).apply(this,we.multipleInstances?ct:[])}}return"PUBLIC"===we.type?_e[F]:null},removeApp:function Bt(we){delete ge[we]},useAsService:function cn(we,Pt){return"serverAuth"===Pt?null:Pt},modularAPIs:R}};function an(we){if(!(0,v.r3)(ge,we=we||R._DEFAULT_ENTRY_NAME))throw Fe.create("no-app",{appName:we});return ge[we]}return _e.default=_e,Object.defineProperty(_e,"apps",{get:function Ue(){return Object.keys(ge).map(we=>ge[we])}}),an.App=Ve,_e}(vt);return Ve.INTERNAL=Object.assign(Object.assign({},Ve.INTERNAL),{createFirebaseNamespace:ke,extendNamespace:function ge(_e){(0,v.ZB)(Ve,_e)},createSubscribe:v.ne,ErrorFactory:v.LL,deepExtend:v.ZB}),Ve}(),l=new X.Yd("@firebase/app-compat");if((0,v.jU)()&&void 0!==self.firebase){l.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ve=self.firebase.SDK_VERSION;Ve&&Ve.indexOf("LITE")>=0&&l.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Zt=B;!function Pe(Ve){(0,R.registerVersion)("@firebase/app-compat","0.2.13",Ve)}()},7212:(qr,Ut,q)=>{q.r(Ut),q.d(Ut,{FirebaseError:()=>X.ZR,SDK_VERSION:()=>Hr,_DEFAULT_ENTRY_NAME:()=>En,_addComponent:()=>xt,_addOrOverwriteComponent:()=>Bn,_apps:()=>Kt,_clearComponents:()=>bn,_components:()=>Pn,_getProvider:()=>ci,_registerComponent:()=>Mn,_removeServiceInstance:()=>$r,deleteApp:()=>Wt,getApp:()=>Gn,getApps:()=>qn,initializeApp:()=>fo,onLog:()=>Kr,registerVersion:()=>it,setLogLevel:()=>Lt});var v=q(5861),te=q(4859),R=q(1877),X=q(2090);const vt=(P,k)=>k.some(z=>P instanceof z);let tt,Fe;const B=new WeakMap,l=new WeakMap,ne=new WeakMap,ae=new WeakMap,Pe=new WeakMap;let ge={get(P,k,z){if(P instanceof IDBTransaction){if("done"===k)return l.get(P);if("objectStoreNames"===k)return P.objectStoreNames||ne.get(P);if("store"===k)return z.objectStoreNames[1]?void 0:z.objectStore(z.objectStoreNames[0])}return Rt(P[k])},set:(P,k,z)=>(P[k]=z,!0),has:(P,k)=>P instanceof IDBTransaction&&("done"===k||"store"===k)||k in P};function an(P){return"function"==typeof P?function Bt(P){return P!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ke(){return Fe||(Fe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(P)?function(...k){return P.apply(Ue(this),k),Rt(B.get(this))}:function(...k){return Rt(P.apply(Ue(this),k))}:function(k,...z){const se=P.call(Ue(this),k,...z);return ne.set(se,k.sort?k.sort():[k]),Rt(se)}}(P):(P instanceof IDBTransaction&&function Ve(P){if(l.has(P))return;const k=new Promise((z,se)=>{const S=()=>{P.removeEventListener("complete",me),P.removeEventListener("error",Te),P.removeEventListener("abort",Te)},me=()=>{z(),S()},Te=()=>{se(P.error||new DOMException("AbortError","AbortError")),S()};P.addEventListener("complete",me),P.addEventListener("error",Te),P.addEventListener("abort",Te)});l.set(P,k)}(P),vt(P,function zt(){return tt||(tt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(P,ge):P)}function Rt(P){if(P instanceof IDBRequest)return function Zt(P){const k=new Promise((z,se)=>{const S=()=>{P.removeEventListener("success",me),P.removeEventListener("error",Te)},me=()=>{z(Rt(P.result)),S()},Te=()=>{se(P.error),S()};P.addEventListener("success",me),P.addEventListener("error",Te)});return k.then(z=>{z instanceof IDBCursor&&B.set(z,P)}).catch(()=>{}),Pe.set(k,P),k}(P);if(ae.has(P))return ae.get(P);const k=an(P);return k!==P&&(ae.set(P,k),Pe.set(k,P)),k}const Ue=P=>Pe.get(P),we=["get","getKey","getAll","getAllKeys","count"],Pt=["put","add","delete","clear"],F=new Map;function nt(P,k){if(!(P instanceof IDBDatabase)||k in P||"string"!=typeof k)return;if(F.get(k))return F.get(k);const z=k.replace(/FromIndex$/,""),se=k!==z,S=Pt.includes(z);if(!(z in(se?IDBIndex:IDBObjectStore).prototype)||!S&&!we.includes(z))return;const me=function(){var Te=(0,v.Z)(function*(he,...dt){const ut=this.transaction(he,S?"readwrite":"readonly");let j=ut.store;return se&&(j=j.index(dt.shift())),(yield Promise.all([j[z](...dt),S&&ut.done]))[0]});return function(dt){return Te.apply(this,arguments)}}();return F.set(k,me),me}!function _e(P){ge=P(ge)}(P=>({...P,get:(k,z,se)=>nt(k,z)||P.get(k,z,se),has:(k,z)=>!!nt(k,z)||P.has(k,z)}));class ct{constructor(k){this.container=k}getPlatformInfoString(){return this.container.getProviders().map(z=>{if(function Nn(P){const k=P.getComponent();return"VERSION"===k?.type}(z)){const se=z.getImmediate();return`${se.library}/${se.version}`}return null}).filter(z=>z).join(" ")}}const oi="@firebase/app",vn=new R.Yd("@firebase/app"),En="[DEFAULT]",Ri={[oi]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Kt=new Map,Pn=new Map;function xt(P,k){try{P.container.addComponent(k)}catch(z){vn.debug(`Component ${k.name} failed to register with FirebaseApp ${P.name}`,z)}}function Bn(P,k){P.container.addOrOverwriteComponent(k)}function Mn(P){const k=P.name;if(Pn.has(k))return vn.debug(`There were multiple attempts to register component ${k}.`),!1;Pn.set(k,P);for(const z of Kt.values())xt(z,P);return!0}function ci(P,k){const z=P.container.getProvider("heartbeat").getImmediate({optional:!0});return z&&z.triggerHeartbeat(),P.container.getProvider(k)}function $r(P,k,z=En){ci(P,k).clearInstance(z)}function bn(){Pn.clear()}const hn=new X.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class fr{constructor(k,z,se){this._isDeleted=!1,this._options=Object.assign({},k),this._config=Object.assign({},z),this._name=z.name,this._automaticDataCollectionEnabled=z.automaticDataCollectionEnabled,this._container=se,this.container.addComponent(new te.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(k){this.checkDestroyed(),this._automaticDataCollectionEnabled=k}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(k){this._isDeleted=k}checkDestroyed(){if(this.isDeleted)throw hn.create("app-deleted",{appName:this._name})}}const Hr="9.23.0";function fo(P,k={}){let z=P;"object"!=typeof k&&(k={name:k});const se=Object.assign({name:En,automaticDataCollectionEnabled:!1},k),S=se.name;if("string"!=typeof S||!S)throw hn.create("bad-app-name",{appName:String(S)});if(z||(z=(0,X.aH)()),!z)throw hn.create("no-options");const me=Kt.get(S);if(me){if((0,X.vZ)(z,me.options)&&(0,X.vZ)(se,me.config))return me;throw hn.create("duplicate-app",{appName:S})}const Te=new te.H0(S);for(const dt of Pn.values())Te.addComponent(dt);const he=new fr(z,se,Te);return Kt.set(S,he),he}function Gn(P=En){const k=Kt.get(P);if(!k&&P===En&&(0,X.aH)())return fo();if(!k)throw hn.create("no-app",{appName:P});return k}function qn(){return Array.from(Kt.values())}function Wt(P){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,v.Z)(function*(P){const k=P.name;Kt.has(k)&&(Kt.delete(k),yield Promise.all(P.container.getProviders().map(z=>z.delete())),P.isDeleted=!0)})).apply(this,arguments)}function it(P,k,z){var se;let S=null!==(se=Ri[P])&&void 0!==se?se:P;z&&(S+=`-${z}`);const me=S.match(/\s|\//),Te=k.match(/\s|\//);if(me||Te){const he=[`Unable to register library "${S}" with version "${k}":`];return me&&he.push(`library name "${S}" contains illegal characters (whitespace or "/")`),me&&Te&&he.push("and"),Te&&he.push(`version name "${k}" contains illegal characters (whitespace or "/")`),void vn.warn(he.join(" "))}Mn(new te.wA(`${S}-version`,()=>({library:S,version:k}),"VERSION"))}function Kr(P,k){if(null!==P&&"function"!=typeof P)throw hn.create("invalid-log-argument");(0,R.Am)(P,k)}function Lt(P){(0,R.Ub)(P)}const po="firebase-heartbeat-database",Cn=1,T="firebase-heartbeat-store";let I=null;function b(){return I||(I=function E(P,k,{blocked:z,upgrade:se,blocking:S,terminated:me}={}){const Te=indexedDB.open(P,k),he=Rt(Te);return se&&Te.addEventListener("upgradeneeded",dt=>{se(Rt(Te.result),dt.oldVersion,dt.newVersion,Rt(Te.transaction),dt)}),z&&Te.addEventListener("blocked",dt=>z(dt.oldVersion,dt.newVersion,dt)),he.then(dt=>{me&&dt.addEventListener("close",()=>me()),S&&dt.addEventListener("versionchange",ut=>S(ut.oldVersion,ut.newVersion,ut))}).catch(()=>{}),he}(po,Cn,{upgrade:(P,k)=>{0===k&&P.createObjectStore(T)}}).catch(P=>{throw hn.create("idb-open",{originalErrorMessage:P.message})})),I}function D(){return(D=(0,v.Z)(function*(P){try{return yield(yield b()).transaction(T).objectStore(T).get(Ae(P))}catch(k){if(k instanceof X.ZR)vn.warn(k.message);else{const z=hn.create("idb-get",{originalErrorMessage:k?.message});vn.warn(z.message)}}})).apply(this,arguments)}function ee(P,k){return ue.apply(this,arguments)}function ue(){return(ue=(0,v.Z)(function*(P,k){try{const se=(yield b()).transaction(T,"readwrite");yield se.objectStore(T).put(k,Ae(P)),yield se.done}catch(z){if(z instanceof X.ZR)vn.warn(z.message);else{const se=hn.create("idb-set",{originalErrorMessage:z?.message});vn.warn(se.message)}}})).apply(this,arguments)}function Ae(P){return`${P.name}!${P.options.appId}`}class It{constructor(k){this.container=k,this._heartbeatsCache=null;const z=this.container.getProvider("app").getImmediate();this._storage=new Mi(z),this._heartbeatsCachePromise=this._storage.read().then(se=>(this._heartbeatsCache=se,se))}triggerHeartbeat(){var k=this;return(0,v.Z)(function*(){const se=k.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),S=Ee();if(null===k._heartbeatsCache&&(k._heartbeatsCache=yield k._heartbeatsCachePromise),k._heartbeatsCache.lastSentHeartbeatDate!==S&&!k._heartbeatsCache.heartbeats.some(me=>me.date===S))return k._heartbeatsCache.heartbeats.push({date:S,agent:se}),k._heartbeatsCache.heartbeats=k._heartbeatsCache.heartbeats.filter(me=>{const Te=new Date(me.date).valueOf();return Date.now()-Te<=2592e6}),k._storage.overwrite(k._heartbeatsCache)})()}getHeartbeatsHeader(){var k=this;return(0,v.Z)(function*(){if(null===k._heartbeatsCache&&(yield k._heartbeatsCachePromise),null===k._heartbeatsCache||0===k._heartbeatsCache.heartbeats.length)return"";const z=Ee(),{heartbeatsToSend:se,unsentEntries:S}=function Yt(P,k=1024){const z=[];let se=P.slice();for(const S of P){const me=z.find(Te=>Te.agent===S.agent);if(me){if(me.dates.push(S.date),jn(z)>k){me.dates.pop();break}}else if(z.push({agent:S.agent,dates:[S.date]}),jn(z)>k){z.pop();break}se=se.slice(1)}return{heartbeatsToSend:z,unsentEntries:se}}(k._heartbeatsCache.heartbeats),me=(0,X.L)(JSON.stringify({version:2,heartbeats:se}));return k._heartbeatsCache.lastSentHeartbeatDate=z,S.length>0?(k._heartbeatsCache.heartbeats=S,yield k._storage.overwrite(k._heartbeatsCache)):(k._heartbeatsCache.heartbeats=[],k._storage.overwrite(k._heartbeatsCache)),me})()}}function Ee(){return(new Date).toISOString().substring(0,10)}class Mi{constructor(k){this.app=k,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,v.Z)(function*(){return!!(0,X.hl)()&&(0,X.eu)().then(()=>!0).catch(()=>!1)})()}read(){var k=this;return(0,v.Z)(function*(){return(yield k._canUseIndexedDBPromise)&&(yield function M(P){return D.apply(this,arguments)}(k.app))||{heartbeats:[]}})()}overwrite(k){var z=this;return(0,v.Z)(function*(){var se;if(yield z._canUseIndexedDBPromise){const me=yield z.read();return ee(z.app,{lastSentHeartbeatDate:null!==(se=k.lastSentHeartbeatDate)&&void 0!==se?se:me.lastSentHeartbeatDate,heartbeats:k.heartbeats})}})()}add(k){var z=this;return(0,v.Z)(function*(){var se;if(yield z._canUseIndexedDBPromise){const me=yield z.read();return ee(z.app,{lastSentHeartbeatDate:null!==(se=k.lastSentHeartbeatDate)&&void 0!==se?se:me.lastSentHeartbeatDate,heartbeats:[...me.heartbeats,...k.heartbeats]})}})()}}function jn(P){return(0,X.L)(JSON.stringify({version:2,heartbeats:P})).length}!function $a(P){Mn(new te.wA("platform-logger",k=>new ct(k),"PRIVATE")),Mn(new te.wA("heartbeat",k=>new It(k),"PRIVATE")),it(oi,"0.9.13",P),it(oi,"0.9.13","esm2017"),it("fire-js","")}("")},8463:(qr,Ut,q)=>{q.r(Ut);var v=q(5861),te=q(6101),R=q(2090),X=q(7212),vt=q(655),tt=q(1877),Fe=q(4859);const ke={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const Zt=function ae(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},Ve=function Pe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ge=new R.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Bt=new tt.Yd("@firebase/auth");function Rt(u,...o){Bt.logLevel<=tt.in.ERROR&&Bt.error(`Auth (${X.SDK_VERSION}): ${u}`,...o)}function Ue(u,...o){throw Pt(u,...o)}function E(u,...o){return Pt(u,...o)}function cn(u,o,c){const h=Object.assign(Object.assign({},Ve()),{[o]:c});return new R.LL("auth","Firebase",h).create(o,{appName:u.name})}function we(u,o,c){if(!(o instanceof c))throw c.name!==o.constructor.name&&Ue(u,"argument-error"),cn(u,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Pt(u,...o){if("string"!=typeof u){const c=o[0],h=[...o.slice(1)];return h[0]&&(h[0].appName=u.name),u._errorFactory.create(c,...h)}return ge.create(u,...o)}function F(u,o,...c){if(!u)throw Pt(o,...c)}function nt(u){const o="INTERNAL ASSERTION FAILED: "+u;throw Rt(o),new Error(o)}function ct(u,o){u||nt(o)}function Nn(){var u;return typeof self<"u"&&(null===(u=self.location)||void 0===u?void 0:u.href)||""}function oi(){return"http:"===hr()||"https:"===hr()}function hr(){var u;return typeof self<"u"&&(null===(u=self.location)||void 0===u?void 0:u.protocol)||null}class un{constructor(o,c){this.shortDelay=o,this.longDelay=c,ct(c>o,"Short delay should be less than long delay!"),this.isMobile=(0,R.uI)()||(0,R.b$)()}get(){return function vn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(oi()||(0,R.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function In(u,o){ct(u.emulator,"Emulator should always be set here");const{url:c}=u.emulator;return o?`${c}${o.startsWith("/")?o.slice(1):o}`:c}class ai{static initialize(o,c,h){this.fetchImpl=o,c&&(this.headersImpl=c),h&&(this.responseImpl=h)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ga={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},uo=new un(3e4,6e4);function De(u,o){return u.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:u.tenantId}):o}function Me(u,o,c,h){return Di.apply(this,arguments)}function Di(){return(Di=(0,v.Z)(function*(u,o,c,h,p={}){return wn(u,p,(0,v.Z)(function*(){let _={},w={};h&&("GET"===o?w=h:_={body:JSON.stringify(h)});const x=(0,R.xO)(Object.assign({key:u.config.apiKey},w)).slice(1),V=yield u._getAdditionalHeaders();return V["Content-Type"]="application/json",u.languageCode&&(V["X-Firebase-Locale"]=u.languageCode),ai.fetch()(Rn(u,u.config.apiHost,c,x),Object.assign({method:o,headers:V,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function wn(u,o,c){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,v.Z)(function*(u,o,c){u._canInitEmulator=!1;const h=Object.assign(Object.assign({},Ga),o);try{const p=new lo(u),_=yield Promise.race([c(),p.promise]);p.clearNetworkTimeout();const w=yield _.json();if("needConfirmation"in w)throw Ht(u,"account-exists-with-different-credential",w);if(_.ok&&!("errorMessage"in w))return w;{const x=_.ok?w.errorMessage:w.error.message,[V,G]=x.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===V)throw Ht(u,"credential-already-in-use",w);if("EMAIL_EXISTS"===V)throw Ht(u,"email-already-in-use",w);if("USER_DISABLED"===V)throw Ht(u,"user-disabled",w);const Y=h[V]||V.toLowerCase().replace(/[_\s]+/g,"-");if(G)throw cn(u,Y,G);Ue(u,Y)}}catch(p){if(p instanceof R.ZR)throw p;Ue(u,"network-request-failed",{message:String(p)})}})).apply(this,arguments)}function ln(u,o,c,h){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,v.Z)(function*(u,o,c,h,p={}){const _=yield Me(u,o,c,h,p);return"mfaPendingCredential"in _&&Ue(u,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function Rn(u,o,c,h){const p=`${o}${c}?${h}`;return u.config.emulator?In(u.config,p):`${u.config.apiScheme}://${p}`}class lo{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((c,h)=>{this.timer=setTimeout(()=>h(E(this.auth,"network-request-failed")),uo.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ht(u,o,c){const h={appName:u.name};c.email&&(h.email=c.email),c.phoneNumber&&(h.phoneNumber=c.phoneNumber);const p=E(u,o,h);return p.customData._tokenResponse=c,p}function dr(){return(dr=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Oi(){return(Oi=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Ni(){return(Ni=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function Ct(u){if(u)try{const o=new Date(Number(u));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function En(){return(En=(0,v.Z)(function*(u,o=!1){const c=(0,R.m9)(u),h=yield c.getIdToken(o),p=Kt(h);F(p&&p.exp&&p.auth_time&&p.iat,c.auth,"internal-error");const _="object"==typeof p.firebase?p.firebase:void 0,w=_?.sign_in_provider;return{claims:p,token:h,authTime:Ct(Ri(p.auth_time)),issuedAtTime:Ct(Ri(p.iat)),expirationTime:Ct(Ri(p.exp)),signInProvider:w||null,signInSecondFactor:_?.sign_in_second_factor||null}})).apply(this,arguments)}function Ri(u){return 1e3*Number(u)}function Kt(u){const[o,c,h]=u.split(".");if(void 0===o||void 0===c||void 0===h)return Rt("JWT malformed, contained fewer than 3 sections"),null;try{const p=(0,R.tV)(c);return p?JSON.parse(p):(Rt("Failed to decode base64 JWT payload"),null)}catch(p){return Rt("Caught error parsing JWT payload as JSON",p?.toString()),null}}function xt(u,o){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,v.Z)(function*(u,o,c=!1){if(c)return o;try{return yield o}catch(h){throw h instanceof R.ZR&&function Mn({code:u}){return"auth/user-disabled"===u||"auth/user-token-expired"===u}(h)&&u.auth.currentUser===u&&(yield u.auth.signOut()),h}})).apply(this,arguments)}class ci{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var c;if(o){const h=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),h}{this.errorBackoff=3e4;const p=(null!==(c=this.user.stsTokenManager.expirationTime)&&void 0!==c?c:0)-Date.now()-3e5;return Math.max(0,p)}}schedule(o=!1){var c=this;if(!this.isRunning)return;const h=this.getInterval(o);this.timerId=setTimeout((0,v.Z)(function*(){yield c.iteration()}),h)}iteration(){var o=this;return(0,v.Z)(function*(){try{yield o.user.getIdToken(!0)}catch(c){return void("auth/network-request-failed"===c?.code&&o.schedule(!0))}o.schedule()})()}}class $r{constructor(o,c){this.createdAt=o,this.lastLoginAt=c,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ct(this.lastLoginAt),this.creationTime=Ct(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function bn(u){return Pi.apply(this,arguments)}function Pi(){return Pi=(0,v.Z)(function*(u){var o;const c=u.auth,h=yield u.getIdToken(),p=yield xt(u,function ho(u,o){return Ni.apply(this,arguments)}(c,{idToken:h}));F(p?.users.length,c,"internal-error");const _=p.users[0];u._notifyReloadListener(_);const w=null!==(o=_.providerUserInfo)&&void 0!==o&&o.length?function fo(u){return u.map(o=>{var{providerId:c}=o,h=(0,vt._T)(o,["providerId"]);return{providerId:c,uid:h.rawId||"",displayName:h.displayName||null,email:h.email||null,phoneNumber:h.phoneNumber||null,photoURL:h.photoUrl||null}})}(_.providerUserInfo):[],x=function Hr(u,o){return[...u.filter(h=>!o.some(p=>p.providerId===h.providerId)),...o]}(u.providerData,w),Y=!!u.isAnonymous&&!(u.email&&_.passwordHash||x?.length),J={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:x,metadata:new $r(_.createdAt,_.lastLoginAt),isAnonymous:Y};Object.assign(u,J)}),Pi.apply(this,arguments)}function fr(){return(fr=(0,v.Z)(function*(u){const o=(0,R.m9)(u);yield bn(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function qn(){return(qn=(0,v.Z)(function*(u,o){const c=yield wn(u,{},(0,v.Z)(function*(){const h=(0,R.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:p,apiKey:_}=u.config,w=Rn(u,p,"/v1/token",`key=${_}`),x=yield u._getAdditionalHeaders();return x["Content-Type"]="application/x-www-form-urlencoded",ai.fetch()(w,{method:"POST",headers:x,body:h})}));return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}})).apply(this,arguments)}class Wt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){F(o.idToken,"internal-error"),F(typeof o.idToken<"u","internal-error"),F(typeof o.refreshToken<"u","internal-error");const c="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function Pn(u){const o=Kt(u);return F(o,"internal-error"),F(typeof o.exp<"u","internal-error"),F(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,c)}getToken(o,c=!1){var h=this;return(0,v.Z)(function*(){return F(!h.accessToken||h.refreshToken,o,"user-token-expired"),c||!h.accessToken||h.isExpired?h.refreshToken?(yield h.refresh(o,h.refreshToken),h.accessToken):null:h.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,c){var h=this;return(0,v.Z)(function*(){const{accessToken:p,refreshToken:_,expiresIn:w}=yield function Gn(u,o){return qn.apply(this,arguments)}(o,c);h.updateTokensAndExpiration(p,_,Number(w))})()}updateTokensAndExpiration(o,c,h){this.refreshToken=c||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*h}static fromJSON(o,c){const{refreshToken:h,accessToken:p,expirationTime:_}=c,w=new Wt;return h&&(F("string"==typeof h,"internal-error",{appName:o}),w.refreshToken=h),p&&(F("string"==typeof p,"internal-error",{appName:o}),w.accessToken=p),_&&(F("number"==typeof _,"internal-error",{appName:o}),w.expirationTime=_),w}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new Wt,this.toJSON())}_performRefresh(){return nt("not implemented")}}function Qt(u,o){F("string"==typeof u||typeof u>"u","internal-error",{appName:o})}class it{constructor(o){var{uid:c,auth:h,stsTokenManager:p}=o,_=(0,vt._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ci(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=c,this.auth=h,this.stsTokenManager=p,this.accessToken=p.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new $r(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(o){var c=this;return(0,v.Z)(function*(){const h=yield xt(c,c.stsTokenManager.getToken(c.auth,o));return F(h,c.auth,"internal-error"),c.accessToken!==h&&(c.accessToken=h,yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)),h})()}getIdTokenResult(o){return function jr(u){return En.apply(this,arguments)}(this,o)}reload(){return function hn(u){return fr.apply(this,arguments)}(this)}_assign(o){this!==o&&(F(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(c=>Object.assign({},c)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const c=new it(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return c.metadata._copy(this.metadata),c}_onReload(o){F(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,c=!1){var h=this;return(0,v.Z)(function*(){let p=!1;o.idToken&&o.idToken!==h.stsTokenManager.accessToken&&(h.stsTokenManager.updateFromServerResponse(o),p=!0),c&&(yield bn(h)),yield h.auth._persistUserIfCurrent(h),p&&h.auth._notifyListenersIfCurrent(h)})()}delete(){var o=this;return(0,v.Z)(function*(){const c=yield o.getIdToken();return yield xt(o,function qa(u,o){return dr.apply(this,arguments)}(o.auth,{idToken:c})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,c){var h,p,_,w,x,V,G,Y;const J=null!==(h=c.displayName)&&void 0!==h?h:void 0,Re=null!==(p=c.email)&&void 0!==p?p:void 0,qt=null!==(_=c.phoneNumber)&&void 0!==_?_:void 0,nr=null!==(w=c.photoURL)&&void 0!==w?w:void 0,Gs=null!==(x=c.tenantId)&&void 0!==x?x:void 0,ya=null!==(V=c._redirectEventId)&&void 0!==V?V:void 0,Kc=null!==(G=c.createdAt)&&void 0!==G?G:void 0,Un=null!==(Y=c.lastLoginAt)&&void 0!==Y?Y:void 0,{uid:va,emailVerified:ir,isAnonymous:Wc,providerData:qs,stsTokenManager:js}=c;F(va&&js,o,"internal-error");const Qc=Wt.fromJSON(this.name,js);F("string"==typeof va,o,"internal-error"),Qt(J,o.name),Qt(Re,o.name),F("boolean"==typeof ir,o,"internal-error"),F("boolean"==typeof Wc,o,"internal-error"),Qt(qt,o.name),Qt(nr,o.name),Qt(Gs,o.name),Qt(ya,o.name),Qt(Kc,o.name),Qt(Un,o.name);const si=new it({uid:va,auth:o,email:Re,emailVerified:ir,displayName:J,isAnonymous:Wc,photoURL:nr,phoneNumber:qt,tenantId:Gs,stsTokenManager:Qc,createdAt:Kc,lastLoginAt:Un});return qs&&Array.isArray(qs)&&(si.providerData=qs.map(jt=>Object.assign({},jt))),ya&&(si._redirectEventId=ya),si}static _fromIdTokenResponse(o,c,h=!1){return(0,v.Z)(function*(){const p=new Wt;p.updateFromServerResponse(c);const _=new it({uid:c.localId,auth:o,stsTokenManager:p,isAnonymous:h});return yield bn(_),_})()}}const Kr=new Map;function Lt(u){ct(u instanceof Function,"Expected a class definition");let o=Kr.get(u);return o?(ct(o instanceof u,"Instance stored in cache mismatched with class"),o):(o=new u,Kr.set(u,o),o)}const Cn=(()=>{class u{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,v.Z)(function*(){return!0})()}_set(c,h){var p=this;return(0,v.Z)(function*(){p.storage[c]=h})()}_get(c){var h=this;return(0,v.Z)(function*(){const p=h.storage[c];return void 0===p?null:p})()}_remove(c){var h=this;return(0,v.Z)(function*(){delete h.storage[c]})()}_addListener(c,h){}_removeListener(c,h){}}return u.type="NONE",u})();function T(u,o,c){return`firebase:${u}:${o}:${c}`}class I{constructor(o,c,h){this.persistence=o,this.auth=c,this.userKey=h;const{config:p,name:_}=this.auth;this.fullUserKey=T(this.userKey,p.apiKey,_),this.fullPersistenceKey=T("persistence",p.apiKey,_),this.boundEventHandler=c._onStorageEvent.bind(c),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,v.Z)(function*(){const c=yield o.persistence._get(o.fullUserKey);return c?it._fromJSON(o.auth,c):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var c=this;return(0,v.Z)(function*(){if(c.persistence===o)return;const h=yield c.getCurrentUser();return yield c.removeCurrentUser(),c.persistence=o,h?c.setCurrentUser(h):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,c,h="authUser"){return(0,v.Z)(function*(){if(!c.length)return new I(Lt(Cn),o,h);const p=(yield Promise.all(c.map(function(){var G=(0,v.Z)(function*(Y){if(yield Y._isAvailable())return Y});return function(Y){return G.apply(this,arguments)}}()))).filter(G=>G);let _=p[0]||Lt(Cn);const w=T(h,o.config.apiKey,o.name);let x=null;for(const G of c)try{const Y=yield G._get(w);if(Y){const J=it._fromJSON(o,Y);G!==_&&(x=J),_=G;break}}catch{}const V=p.filter(G=>G._shouldAllowMigration);return _._shouldAllowMigration&&V.length?(_=V[0],x&&(yield _._set(w,x.toJSON())),yield Promise.all(c.map(function(){var G=(0,v.Z)(function*(Y){if(Y!==_)try{yield Y._remove(w)}catch{}});return function(Y){return G.apply(this,arguments)}}())),new I(_,o,h)):new I(_,o,h)})()}}function b(u){const o=u.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(ue(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(M(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(St(o))return"Blackberry";if(ht(o))return"Webos";if(D(o))return"Safari";if((o.includes("chrome/")||ee(o))&&!o.includes("edge/"))return"Chrome";if(Ae(o))return"Android";{const h=u.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===h?.length)return h[1]}return"Other"}function M(u=(0,R.z$)()){return/firefox\//i.test(u)}function D(u=(0,R.z$)()){const o=u.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function ee(u=(0,R.z$)()){return/crios\//i.test(u)}function ue(u=(0,R.z$)()){return/iemobile/i.test(u)}function Ae(u=(0,R.z$)()){return/android/i.test(u)}function St(u=(0,R.z$)()){return/blackberry/i.test(u)}function ht(u=(0,R.z$)()){return/webos/i.test(u)}function It(u=(0,R.z$)()){return/iphone|ipad|ipod/i.test(u)||/macintosh/i.test(u)&&/mobile/i.test(u)}function jn(u=(0,R.z$)()){return It(u)||Ae(u)||ht(u)||St(u)||/windows phone/i.test(u)||ue(u)}function P(u,o=[]){let c;switch(u){case"Browser":c=b((0,R.z$)());break;case"Worker":c=`${b((0,R.z$)())}-${u}`;break;default:c=u}const h=o.length?o.join(","):"FirebaseCore-web";return`${c}/JsCore/${X.SDK_VERSION}/${h}`}function z(){return(z=(0,v.Z)(function*(u){return(yield Me(u,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function se(u,o){return S.apply(this,arguments)}function S(){return(S=(0,v.Z)(function*(u,o){return Me(u,"GET","/v2/recaptchaConfig",De(u,o))})).apply(this,arguments)}function me(u){return void 0!==u&&void 0!==u.getResponse}function Te(u){return void 0!==u&&void 0!==u.enterprise}class he{constructor(o){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.emailPasswordEnabled=o.recaptchaEnforcementState.some(c=>"EMAIL_PASSWORD_PROVIDER"===c.provider&&"OFF"!==c.enforcementState)}}function ut(u){return new Promise((o,c)=>{const h=document.createElement("script");h.setAttribute("src",u),h.onload=o,h.onerror=p=>{const _=E("internal-error");_.customData=p,c(_)},h.type="text/javascript",h.charset="UTF-8",function dt(){var u,o;return null!==(o=null===(u=document.getElementsByTagName("head"))||void 0===u?void 0:u[0])&&void 0!==o?o:document}().appendChild(h)})}function j(u){return`__${u}${Math.floor(1e6*Math.random())}`}class pr{constructor(o){this.type="recaptcha-enterprise",this.auth=We(o)}verify(o="verify",c=!1){var h=this;return(0,v.Z)(function*(){function _(){return _=(0,v.Z)(function*(x){if(!c){if(null==x.tenantId&&null!=x._agentRecaptchaConfig)return x._agentRecaptchaConfig.siteKey;if(null!=x.tenantId&&void 0!==x._tenantRecaptchaConfigs[x.tenantId])return x._tenantRecaptchaConfigs[x.tenantId].siteKey}return new Promise(function(){var V=(0,v.Z)(function*(G,Y){se(x,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(J=>{if(void 0!==J.recaptchaKey){const Re=new he(J);return null==x.tenantId?x._agentRecaptchaConfig=Re:x._tenantRecaptchaConfigs[x.tenantId]=Re,G(Re.siteKey)}Y(new Error("recaptcha Enterprise site key undefined"))}).catch(J=>{Y(J)})});return function(G,Y){return V.apply(this,arguments)}}())}),_.apply(this,arguments)}function w(x,V,G){const Y=window.grecaptcha;Te(Y)?Y.enterprise.ready(()=>{Y.enterprise.execute(x,{action:o}).then(J=>{V(J)}).catch(()=>{V("NO_RECAPTCHA")})}):G(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((x,V)=>{(function p(x){return _.apply(this,arguments)})(h.auth).then(G=>{if(!c&&Te(window.grecaptcha))w(G,x,V);else{if(typeof window>"u")return void V(new Error("RecaptchaVerifier is only supported in browser"));ut("https://www.google.com/recaptcha/enterprise.js?render="+G).then(()=>{w(G,x,V)}).catch(Y=>{V(Y)})}}).catch(G=>{V(G)})})})()}}function ui(u,o,c){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,v.Z)(function*(u,o,c,h=!1){const p=new pr(u);let _;try{_=yield p.verify(c)}catch{_=yield p.verify(c,!0)}const w=Object.assign({},o);return Object.assign(w,h?{captchaResp:_}:{captchaResponse:_}),Object.assign(w,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(w,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),w})).apply(this,arguments)}class Mh{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,c){const h=_=>new Promise((w,x)=>{try{w(o(_))}catch(V){x(V)}});h.onAbort=c,this.queue.push(h);const p=this.queue.length-1;return()=>{this.queue[p]=()=>Promise.resolve()}}runMiddleware(o){var c=this;return(0,v.Z)(function*(){if(c.auth.currentUser===o)return;const h=[];try{for(const p of c.queue)yield p(o),p.onAbort&&h.push(p.onAbort)}catch(p){h.reverse();for(const _ of h)try{_()}catch{}throw c.auth._errorFactory.create("login-blocked",{originalMessage:p?.message})}})()}}class Lh{constructor(o,c,h,p){this.app=o,this.heartbeatServiceProvider=c,this.appCheckServiceProvider=h,this.config=p,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new At(this),this.idTokenSubscription=new At(this),this.beforeStateQueue=new Mh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ge,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=p.sdkClientVersion}_initializeWithPersistence(o,c){var h=this;return c&&(this._popupRedirectResolver=Lt(c)),this._initializationPromise=this.queue((0,v.Z)(function*(){var p,_;if(!h._deleted&&(h.persistenceManager=yield I.create(h,o),!h._deleted)){if(null!==(p=h._popupRedirectResolver)&&void 0!==p&&p._shouldInitProactively)try{yield h._popupRedirectResolver._initialize(h)}catch{}yield h.initializeCurrentUser(c),h.lastNotifiedUid=(null===(_=h.currentUser)||void 0===_?void 0:_.uid)||null,!h._deleted&&(h._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,v.Z)(function*(){if(o._deleted)return;const c=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||c){if(o.currentUser&&c&&o.currentUser.uid===c.uid)return o._currentUser._assign(c),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(c,!0)}})()}initializeCurrentUser(o){var c=this;return(0,v.Z)(function*(){var h;const p=yield c.assertedPersistence.getCurrentUser();let _=p,w=!1;if(o&&c.config.authDomain){yield c.getOrInitRedirectPersistenceManager();const x=null===(h=c.redirectUser)||void 0===h?void 0:h._redirectEventId,V=_?._redirectEventId,G=yield c.tryRedirectSignIn(o);(!x||x===V)&&G?.user&&(_=G.user,w=!0)}if(!_)return c.directlySetCurrentUser(null);if(!_._redirectEventId){if(w)try{yield c.beforeStateQueue.runMiddleware(_)}catch(x){_=p,c._popupRedirectResolver._overrideRedirectResult(c,()=>Promise.reject(x))}return _?c.reloadAndSetCurrentUserOrClear(_):c.directlySetCurrentUser(null)}return F(c._popupRedirectResolver,c,"argument-error"),yield c.getOrInitRedirectPersistenceManager(),c.redirectUser&&c.redirectUser._redirectEventId===_._redirectEventId?c.directlySetCurrentUser(_):c.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(o){var c=this;return(0,v.Z)(function*(){let h=null;try{h=yield c._popupRedirectResolver._completeRedirectFn(c,o,!0)}catch{yield c._setRedirectUser(null)}return h})()}reloadAndSetCurrentUserOrClear(o){var c=this;return(0,v.Z)(function*(){try{yield bn(o)}catch(h){if("auth/network-request-failed"!==h?.code)return c.directlySetCurrentUser(null)}return c.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function co(){if(typeof navigator>"u")return null;const u=navigator;return u.languages&&u.languages[0]||u.language||null}()}_delete(){var o=this;return(0,v.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var c=this;return(0,v.Z)(function*(){const h=o?(0,R.m9)(o):null;return h&&F(h.auth.config.apiKey===c.config.apiKey,c,"invalid-user-token"),c._updateCurrentUser(h&&h._clone(c))})()}_updateCurrentUser(o,c=!1){var h=this;return(0,v.Z)(function*(){if(!h._deleted)return o&&F(h.tenantId===o.tenantId,h,"tenant-id-mismatch"),c||(yield h.beforeStateQueue.runMiddleware(o)),h.queue((0,v.Z)(function*(){yield h.directlySetCurrentUser(o),h.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,v.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var c=this;return this.queue((0,v.Z)(function*(){yield c.assertedPersistence.setPersistence(Lt(o))}))}initializeRecaptchaConfig(){var o=this;return(0,v.Z)(function*(){const c=yield se(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),h=new he(c);null==o.tenantId?o._agentRecaptchaConfig=h:o._tenantRecaptchaConfigs[o.tenantId]=h,h.emailPasswordEnabled&&new pr(o).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new R.LL("auth","Firebase",o())}onAuthStateChanged(o,c,h){return this.registerStateListener(this.authStateSubscription,o,c,h)}beforeAuthStateChanged(o,c){return this.beforeStateQueue.pushCallback(o,c)}onIdTokenChanged(o,c,h){return this.registerStateListener(this.idTokenSubscription,o,c,h)}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,c){var h=this;return(0,v.Z)(function*(){const p=yield h.getOrInitRedirectPersistenceManager(c);return null===o?p.removeCurrentUser():p.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var c=this;return(0,v.Z)(function*(){if(!c.redirectPersistenceManager){const h=o&&Lt(o)||c._popupRedirectResolver;F(h,c,"argument-error"),c.redirectPersistenceManager=yield I.create(c,[Lt(h._redirectPersistence)],"redirectUser"),c.redirectUser=yield c.redirectPersistenceManager.getCurrentUser()}return c.redirectPersistenceManager})()}_redirectUserForId(o){var c=this;return(0,v.Z)(function*(){var h,p;return c._isInitialized&&(yield c.queue((0,v.Z)(function*(){}))),(null===(h=c._currentUser)||void 0===h?void 0:h._redirectEventId)===o?c._currentUser:(null===(p=c.redirectUser)||void 0===p?void 0:p._redirectEventId)===o?c.redirectUser:null})()}_persistUserIfCurrent(o){var c=this;return(0,v.Z)(function*(){if(o===c.currentUser)return c.queue((0,v.Z)(function*(){return c.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,c;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const h=null!==(c=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==c?c:null;this.lastNotifiedUid!==h&&(this.lastNotifiedUid=h,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,c,h,p){if(this._deleted)return()=>{};const _="function"==typeof c?c:c.next.bind(c),w=this._isInitialized?Promise.resolve():this._initializationPromise;return F(w,this,"internal-error"),w.then(()=>_(this.currentUser)),"function"==typeof c?o.addObserver(c,h,p):o.addObserver(c)}directlySetCurrentUser(o){var c=this;return(0,v.Z)(function*(){c.currentUser&&c.currentUser!==o&&c._currentUser._stopProactiveRefresh(),o&&c.isProactiveRefreshEnabled&&o._startProactiveRefresh(),c.currentUser=o,o?yield c.assertedPersistence.setCurrentUser(o):yield c.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return F(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=P(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,v.Z)(function*(){var c;const h={"X-Client-Version":o.clientVersion};o.app.options.appId&&(h["X-Firebase-gmpid"]=o.app.options.appId);const p=yield null===(c=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getHeartbeatsHeader();p&&(h["X-Firebase-Client"]=p);const _=yield o._getAppCheckToken();return _&&(h["X-Firebase-AppCheck"]=_),h})()}_getAppCheckToken(){var o=this;return(0,v.Z)(function*(){var c;const h=yield null===(c=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getToken();return h?.error&&function an(u,...o){Bt.logLevel<=tt.in.WARN&&Bt.warn(`Auth (${X.SDK_VERSION}): ${u}`,...o)}(`Error while retrieving App Check token: ${h.error}`),h?.token})()}}function We(u){return(0,R.m9)(u)}class At{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,R.ne)(c=>this.observer=c)}get next(){return F(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Pu(u){const o=u.indexOf(":");return o<0?"":u.substr(0,o+1)}function _o(u){if(!u)return null;const o=Number(u);return isNaN(o)?null:o}class rt{constructor(o,c){this.providerId=o,this.signInMethod=c}toJSON(){return nt("not implemented")}_getIdTokenResponse(o){return nt("not implemented")}_linkToIdToken(o,c){return nt("not implemented")}_getReauthenticationResolver(o){return nt("not implemented")}}function Fu(u,o){return Li.apply(this,arguments)}function Li(){return(Li=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:resetPassword",De(u,o))})).apply(this,arguments)}function Qr(u,o){return dn.apply(this,arguments)}function dn(){return(dn=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Wa(){return(Wa=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:update",De(u,o))})).apply(this,arguments)}function Qa(u,o){return li.apply(this,arguments)}function li(){return(li=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithPassword",De(u,o))})).apply(this,arguments)}function Yr(u,o){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:sendOobCode",De(u,o))})).apply(this,arguments)}function Ya(){return(Ya=(0,v.Z)(function*(u,o){return Yr(u,o)})).apply(this,arguments)}function yo(u,o){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,v.Z)(function*(u,o){return Yr(u,o)})).apply(this,arguments)}function es(u,o){return ts.apply(this,arguments)}function ts(){return(ts=(0,v.Z)(function*(u,o){return Yr(u,o)})).apply(this,arguments)}function ns(){return(ns=(0,v.Z)(function*(u,o){return Yr(u,o)})).apply(this,arguments)}function Xa(){return(Xa=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithEmailLink",De(u,o))})).apply(this,arguments)}function ec(){return(ec=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithEmailLink",De(u,o))})).apply(this,arguments)}class Hn extends rt{constructor(o,c,h,p=null){super("password",h),this._email=o,this._password=c,this._tenantId=p}static _fromEmailAndPassword(o,c){return new Hn(o,c,"password")}static _fromEmailAndCode(o,c,h=null){return new Hn(o,c,"emailLink",h)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o;if(c?.email&&c?.password){if("password"===c.signInMethod)return this._fromEmailAndPassword(c.email,c.password);if("emailLink"===c.signInMethod)return this._fromEmailAndCode(c.email,c.password,c.tenantId)}return null}_getIdTokenResponse(o){var c=this;return(0,v.Z)(function*(){var h;switch(c.signInMethod){case"password":const p={returnSecureToken:!0,email:c._email,password:c._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(h=o._getRecaptchaConfig())&&void 0!==h&&h.emailPasswordEnabled){const _=yield ui(o,p,"signInWithPassword");return Qa(o,_)}return Qa(o,p).catch(function(){var _=(0,v.Z)(function*(w){if("auth/missing-recaptcha-token"===w.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const x=yield ui(o,p,"signInWithPassword");return Qa(o,x)}return Promise.reject(w)});return function(w){return _.apply(this,arguments)}}());case"emailLink":return function Uu(u,o){return Xa.apply(this,arguments)}(o,{email:c._email,oobCode:c._password});default:Ue(o,"internal-error")}})()}_linkToIdToken(o,c){var h=this;return(0,v.Z)(function*(){switch(h.signInMethod){case"password":return Qr(o,{idToken:c,returnSecureToken:!0,email:h._email,password:h._password});case"emailLink":return function is(u,o){return ec.apply(this,arguments)}(o,{idToken:c,email:h._email,oobCode:h._password});default:Ue(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function Kn(u,o){return tc.apply(this,arguments)}function tc(){return(tc=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithIdp",De(u,o))})).apply(this,arguments)}class fn extends rt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const c=new fn(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(c.idToken=o.idToken),o.accessToken&&(c.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(c.nonce=o.nonce),o.pendingToken&&(c.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(c.accessToken=o.oauthToken,c.secret=o.oauthTokenSecret):Ue("argument-error"),c}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:p}=c,_=(0,vt._T)(c,["providerId","signInMethod"]);if(!h||!p)return null;const w=new fn(h,p);return w.idToken=_.idToken||void 0,w.accessToken=_.accessToken||void 0,w.secret=_.secret,w.nonce=_.nonce,w.pendingToken=_.pendingToken||null,w}_getIdTokenResponse(o){return Kn(o,this.buildRequest())}_linkToIdToken(o,c){const h=this.buildRequest();return h.idToken=c,Kn(o,h)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,Kn(o,c)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const c={};this.idToken&&(c.id_token=this.idToken),this.accessToken&&(c.access_token=this.accessToken),this.secret&&(c.oauth_token_secret=this.secret),c.providerId=this.providerId,this.nonce&&!this.pendingToken&&(c.nonce=this.nonce),o.postBody=(0,R.xO)(c)}return o}}function Io(){return(Io=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:sendVerificationCode",De(u,o))})).apply(this,arguments)}function wo(){return(wo=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithPhoneNumber",De(u,o))})).apply(this,arguments)}function rs(){return(rs=(0,v.Z)(function*(u,o){const c=yield ln(u,"POST","/v1/accounts:signInWithPhoneNumber",De(u,o));if(c.temporaryProof)throw Ht(u,"account-exists-with-different-credential",c);return c})).apply(this,arguments)}const nc={USER_NOT_FOUND:"user-not-found"};function ss(){return(ss=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithPhoneNumber",De(u,Object.assign(Object.assign({},o),{operation:"REAUTH"})),nc)})).apply(this,arguments)}class hi extends rt{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,c){return new hi({verificationId:o,verificationCode:c})}static _fromTokenResponse(o,c){return new hi({phoneNumber:o,temporaryProof:c})}_getIdTokenResponse(o){return function zu(u,o){return wo.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,c){return function To(u,o){return rs.apply(this,arguments)}(o,Object.assign({idToken:c},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function ic(u,o){return ss.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:c,verificationId:h,verificationCode:p}=this.params;return o&&c?{temporaryProof:o,phoneNumber:c}:{sessionInfo:h,code:p}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:c,verificationCode:h,phoneNumber:p,temporaryProof:_}=o;return h||c||p||_?new hi({verificationId:c,verificationCode:h,phoneNumber:p,temporaryProof:_}):null}}class mr{constructor(o){var c,h,p,_,w,x;const V=(0,R.zd)((0,R.pd)(o)),G=null!==(c=V.apiKey)&&void 0!==c?c:null,Y=null!==(h=V.oobCode)&&void 0!==h?h:null,J=function Zu(u){switch(u){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(p=V.mode)&&void 0!==p?p:null);F(G&&Y&&J,"argument-error"),this.apiKey=G,this.operation=J,this.code=Y,this.continueUrl=null!==(_=V.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(w=V.languageCode)&&void 0!==w?w:null,this.tenantId=null!==(x=V.tenantId)&&void 0!==x?x:null}static parseLink(o){const c=function Vh(u){const o=(0,R.zd)((0,R.pd)(u)).link,c=o?(0,R.zd)((0,R.pd)(o)).deep_link_id:null,h=(0,R.zd)((0,R.pd)(u)).deep_link_id;return(h?(0,R.zd)((0,R.pd)(h)).link:null)||h||c||o||u}(o);try{return new mr(c)}catch{return null}}}let os=(()=>{class u{constructor(){this.providerId=u.PROVIDER_ID}static credential(c,h){return Hn._fromEmailAndPassword(c,h)}static credentialWithLink(c,h){const p=mr.parseLink(h);return F(p,"argument-error"),Hn._fromEmailAndCode(c,p.code,p.tenantId)}}return u.PROVIDER_ID="password",u.EMAIL_PASSWORD_SIGN_IN_METHOD="password",u.EMAIL_LINK_SIGN_IN_METHOD="emailLink",u})();class Ln{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class gr extends Ln{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class di extends gr{static credentialFromJSON(o){const c="string"==typeof o?JSON.parse(o):o;return F("providerId"in c&&"signInMethod"in c,"argument-error"),fn._fromParams(c)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return F(o.idToken||o.accessToken,"argument-error"),fn._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return di.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return di.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:c,oauthAccessToken:h,oauthTokenSecret:p,pendingToken:_,nonce:w,providerId:x}=o;if(!h&&!p&&!c&&!_||!x)return null;try{return new di(x)._credential({idToken:c,accessToken:h,nonce:w,pendingToken:_})}catch{return null}}}let Eo=(()=>{class u extends gr{constructor(){super("facebook.com")}static credential(c){return fn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.FACEBOOK_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return u.credentialFromTaggedObject(c)}static credentialFromError(c){return u.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return u.credential(c.oauthAccessToken)}catch{return null}}}return u.FACEBOOK_SIGN_IN_METHOD="facebook.com",u.PROVIDER_ID="facebook.com",u})(),bo=(()=>{class u extends gr{constructor(){super("google.com"),this.addScope("profile")}static credential(c,h){return fn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.GOOGLE_SIGN_IN_METHOD,idToken:c,accessToken:h})}static credentialFromResult(c){return u.credentialFromTaggedObject(c)}static credentialFromError(c){return u.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:h,oauthAccessToken:p}=c;if(!h&&!p)return null;try{return u.credential(h,p)}catch{return null}}}return u.GOOGLE_SIGN_IN_METHOD="google.com",u.PROVIDER_ID="google.com",u})(),ft=(()=>{class u extends gr{constructor(){super("github.com")}static credential(c){return fn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.GITHUB_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return u.credentialFromTaggedObject(c)}static credentialFromError(c){return u.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return u.credential(c.oauthAccessToken)}catch{return null}}}return u.GITHUB_SIGN_IN_METHOD="github.com",u.PROVIDER_ID="github.com",u})();class Wn extends rt{constructor(o,c){super(o,o),this.pendingToken=c}_getIdTokenResponse(o){return Kn(o,this.buildRequest())}_linkToIdToken(o,c){const h=this.buildRequest();return h.idToken=c,Kn(o,h)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,Kn(o,c)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:p,pendingToken:_}=c;return h&&p&&_&&h===p?new Wn(h,_):null}static _create(o,c){return new Wn(o,c)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Co extends Ln{constructor(o){F(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return Co.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return Co.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const c=Wn.fromJSON(o);return F(c,"argument-error"),c}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:c,providerId:h}=o;if(!c||!h)return null;try{return Wn._create(h,c)}catch{return null}}}let Bu=(()=>{class u extends gr{constructor(){super("twitter.com")}static credential(c,h){return fn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.TWITTER_SIGN_IN_METHOD,oauthToken:c,oauthTokenSecret:h})}static credentialFromResult(c){return u.credentialFromTaggedObject(c)}static credentialFromError(c){return u.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthAccessToken:h,oauthTokenSecret:p}=c;if(!h||!p)return null;try{return u.credential(h,p)}catch{return null}}}return u.TWITTER_SIGN_IN_METHOD="twitter.com",u.PROVIDER_ID="twitter.com",u})();function xo(u,o){return So.apply(this,arguments)}function So(){return(So=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signUp",De(u,o))})).apply(this,arguments)}class pn{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,c,h,p=!1){return(0,v.Z)(function*(){const _=yield it._fromIdTokenResponse(o,h,p),w=Gu(h);return new pn({user:_,providerId:w,_tokenResponse:h,operationType:c})})()}static _forOperation(o,c,h){return(0,v.Z)(function*(){yield o._updateTokensIfNecessary(h,!0);const p=Gu(h);return new pn({user:o,providerId:p,_tokenResponse:h,operationType:c})})()}}function Gu(u){return u.providerId?u.providerId:"phoneNumber"in u?"phone":null}function Fi(){return(Fi=(0,v.Z)(function*(u){var o;const c=We(u);if(yield c._initializationPromise,null!==(o=c.currentUser)&&void 0!==o&&o.isAnonymous)return new pn({user:c.currentUser,providerId:null,operationType:"signIn"});const h=yield xo(c,{returnSecureToken:!0}),p=yield pn._fromIdTokenResponse(c,"signIn",h,!0);return yield c._updateCurrentUser(p.user),p})).apply(this,arguments)}class fi extends R.ZR{constructor(o,c,h,p){var _;super(c.code,c.message),this.operationType=h,this.user=p,Object.setPrototypeOf(this,fi.prototype),this.customData={appName:o.name,tenantId:null!==(_=o.tenantId)&&void 0!==_?_:void 0,_serverResponse:c.customData._serverResponse,operationType:h}}static _fromErrorAndOperation(o,c,h,p){return new fi(o,c,h,p)}}function Ao(u,o,c,h){return("reauthenticate"===o?c._getReauthenticationResolver(u):c._getIdTokenResponse(u)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?fi._fromErrorAndOperation(u,_,o,h):_})}function sc(u){return new Set(u.map(({providerId:o})=>o).filter(o=>!!o))}function _r(){return _r=(0,v.Z)(function*(u,o){const c=(0,R.m9)(u);yield us(!0,c,o);const{providerUserInfo:h}=yield function Mt(u,o){return Oi.apply(this,arguments)}(c.auth,{idToken:yield c.getIdToken(),deleteProvider:[o]}),p=sc(h||[]);return c.providerData=c.providerData.filter(_=>p.has(_.providerId)),p.has("phone")||(c.phoneNumber=null),yield c.auth._persistUserIfCurrent(c),c}),_r.apply(this,arguments)}function as(u,o){return cs.apply(this,arguments)}function cs(){return(cs=(0,v.Z)(function*(u,o,c=!1){const h=yield xt(u,o._linkToIdToken(u.auth,yield u.getIdToken()),c);return pn._forOperation(u,"link",h)})).apply(this,arguments)}function us(u,o,c){return oc.apply(this,arguments)}function oc(){return(oc=(0,v.Z)(function*(u,o,c){yield bn(o);const p=!1===u?"provider-already-linked":"no-such-provider";F(sc(o.providerData).has(c)===u,o.auth,p)})).apply(this,arguments)}function yr(u,o){return ko.apply(this,arguments)}function ko(){return(ko=(0,v.Z)(function*(u,o,c=!1){const{auth:h}=u,p="reauthenticate";try{const _=yield xt(u,Ao(h,p,o,u),c);F(_.idToken,h,"internal-error");const w=Kt(_.idToken);F(w,h,"internal-error");const{sub:x}=w;return F(u.uid===x,h,"user-mismatch"),pn._forOperation(u,p,_)}catch(_){throw"auth/user-not-found"===_?.code&&Ue(h,"user-mismatch"),_}})).apply(this,arguments)}function ac(u,o){return Do.apply(this,arguments)}function Do(){return(Do=(0,v.Z)(function*(u,o,c=!1){const h="signIn",p=yield Ao(u,h,o),_=yield pn._fromIdTokenResponse(u,h,p);return c||(yield u._updateCurrentUser(_.user)),_})).apply(this,arguments)}function Vi(u,o){return cc.apply(this,arguments)}function cc(){return(cc=(0,v.Z)(function*(u,o){return ac(We(u),o)})).apply(this,arguments)}function qu(u,o){return pi.apply(this,arguments)}function pi(){return(pi=(0,v.Z)(function*(u,o){const c=(0,R.m9)(u);return yield us(!1,c,o.providerId),as(c,o)})).apply(this,arguments)}function ju(u,o){return uc.apply(this,arguments)}function uc(){return(uc=(0,v.Z)(function*(u,o){return yr((0,R.m9)(u),o)})).apply(this,arguments)}function Oo(){return(Oo=(0,v.Z)(function*(u,o){return ln(u,"POST","/v1/accounts:signInWithCustomToken",De(u,o))})).apply(this,arguments)}function Ro(){return Ro=(0,v.Z)(function*(u,o){const c=We(u),h=yield function Ui(u,o){return Oo.apply(this,arguments)}(c,{token:o,returnSecureToken:!0}),p=yield pn._fromIdTokenResponse(c,"signIn",h);return yield c._updateCurrentUser(p.user),p}),Ro.apply(this,arguments)}class Qn{constructor(o,c){this.factorId=o,this.uid=c.mfaEnrollmentId,this.enrollmentTime=new Date(c.enrolledAt).toUTCString(),this.displayName=c.displayName}static _fromServerResponse(o,c){return"phoneInfo"in c?Po._fromServerResponse(o,c):"totpInfo"in c?Dt._fromServerResponse(o,c):Ue(o,"internal-error")}}class Po extends Qn{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,c){return new Po(c)}}class Dt extends Qn{constructor(o){super("totp",o)}static _fromServerResponse(o,c){return new Dt(c)}}function zi(u,o,c){var h;F((null===(h=c.url)||void 0===h?void 0:h.length)>0,u,"invalid-continue-uri"),F(typeof c.dynamicLinkDomain>"u"||c.dynamicLinkDomain.length>0,u,"invalid-dynamic-link-domain"),o.continueUrl=c.url,o.dynamicLinkDomain=c.dynamicLinkDomain,o.canHandleCodeInApp=c.handleCodeInApp,c.iOS&&(F(c.iOS.bundleId.length>0,u,"missing-ios-bundle-id"),o.iOSBundleId=c.iOS.bundleId),c.android&&(F(c.android.packageName.length>0,u,"missing-android-pkg-name"),o.androidInstallApp=c.android.installApp,o.androidMinimumVersionCode=c.android.minimumVersion,o.androidPackageName=c.android.packageName)}function vr(){return vr=(0,v.Z)(function*(u,o,c){var h;const p=We(u),_={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};if(null!==(h=p._getRecaptchaConfig())&&void 0!==h&&h.emailPasswordEnabled){const w=yield ui(p,_,"getOobCode",!0);c&&zi(p,w,c),yield yo(p,w)}else c&&zi(p,_,c),yield yo(p,_).catch(function(){var w=(0,v.Z)(function*(x){if("auth/missing-recaptcha-token"!==x.code)return Promise.reject(x);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const V=yield ui(p,_,"getOobCode",!0);c&&zi(p,V,c),yield yo(p,V)}});return function(x){return w.apply(this,arguments)}}())}),vr.apply(this,arguments)}function hs(){return(hs=(0,v.Z)(function*(u,o,c){yield Fu((0,R.m9)(u),{oobCode:o,newPassword:c})})).apply(this,arguments)}function Mo(){return Mo=(0,v.Z)(function*(u,o){yield function Ka(u,o){return Wa.apply(this,arguments)}((0,R.m9)(u),{oobCode:o})}),Mo.apply(this,arguments)}function Ir(u,o){return ds.apply(this,arguments)}function ds(){return(ds=(0,v.Z)(function*(u,o){const c=(0,R.m9)(u),h=yield Fu(c,{oobCode:o}),p=h.requestType;switch(F(p,c,"internal-error"),p){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":F(h.newEmail,c,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":F(h.mfaInfo,c,"internal-error");default:F(h.email,c,"internal-error")}let _=null;return h.mfaInfo&&(_=Qn._fromServerResponse(We(c),h.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.newEmail:h.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.email:h.newEmail)||null,multiFactorInfo:_},operation:p}})).apply(this,arguments)}function fs(){return(fs=(0,v.Z)(function*(u,o){const{data:c}=yield Ir((0,R.m9)(u),o);return c.email})).apply(this,arguments)}function Zi(){return Zi=(0,v.Z)(function*(u,o,c){var h;const p=We(u),_={returnSecureToken:!0,email:o,password:c,clientType:"CLIENT_TYPE_WEB"};let w;if(null!==(h=p._getRecaptchaConfig())&&void 0!==h&&h.emailPasswordEnabled){const G=yield ui(p,_,"signUpPassword");w=xo(p,G)}else w=xo(p,_).catch(function(){var G=(0,v.Z)(function*(Y){if("auth/missing-recaptcha-token"===Y.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const J=yield ui(p,_,"signUpPassword");return xo(p,J)}return Promise.reject(Y)});return function(Y){return G.apply(this,arguments)}}());const x=yield w.catch(G=>Promise.reject(G)),V=yield pn._fromIdTokenResponse(p,"signIn",x);return yield p._updateCurrentUser(V.user),V}),Zi.apply(this,arguments)}function ps(){return ps=(0,v.Z)(function*(u,o,c){var h;const p=We(u),_={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};function w(x,V){F(V.handleCodeInApp,p,"argument-error"),V&&zi(p,x,V)}if(null!==(h=p._getRecaptchaConfig())&&void 0!==h&&h.emailPasswordEnabled){const x=yield ui(p,_,"getOobCode",!0);w(x,c),yield es(p,x)}else w(_,c),yield es(p,_).catch(function(){var x=(0,v.Z)(function*(V){if("auth/missing-recaptcha-token"!==V.code)return Promise.reject(V);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const G=yield ui(p,_,"getOobCode",!0);w(G,c),yield es(p,G)}});return function(V){return x.apply(this,arguments)}}())}),ps.apply(this,arguments)}function Vo(){return(Vo=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u),p=os.credentialWithLink(o,c||Nn());return F(p._tenantId===(h.tenantId||null),h,"tenant-id-mismatch"),Vi(h,p)})).apply(this,arguments)}function Uo(){return(Uo=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:createAuthUri",De(u,o))})).apply(this,arguments)}function Bi(){return Bi=(0,v.Z)(function*(u,o){const h={identifier:o,continueUri:oi()?Nn():"http://localhost"},{signinMethods:p}=yield function Wu(u,o){return Uo.apply(this,arguments)}((0,R.m9)(u),h);return p||[]}),Bi.apply(this,arguments)}function wr(){return wr=(0,v.Z)(function*(u,o){const c=(0,R.m9)(u),p={requestType:"VERIFY_EMAIL",idToken:yield u.getIdToken()};o&&zi(c.auth,p,o);const{email:_}=yield function Vu(u,o){return Ya.apply(this,arguments)}(c.auth,p);_!==u.email&&(yield u.reload())}),wr.apply(this,arguments)}function Yn(){return Yn=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield u.getIdToken(),newEmail:o};c&&zi(h.auth,_,c);const{email:w}=yield function Ja(u,o){return ns.apply(this,arguments)}(h.auth,_);w!==u.email&&(yield u.reload())}),Yn.apply(this,arguments)}function fc(){return(fc=(0,v.Z)(function*(u,o){return Me(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function zo(){return zo=(0,v.Z)(function*(u,{displayName:o,photoURL:c}){if(void 0===o&&void 0===c)return;const h=(0,R.m9)(u),_={idToken:yield h.getIdToken(),displayName:o,photoUrl:c,returnSecureToken:!0},w=yield xt(h,function dc(u,o){return fc.apply(this,arguments)}(h.auth,_));h.displayName=w.displayName||null,h.photoURL=w.photoUrl||null;const x=h.providerData.find(({providerId:V})=>"password"===V);x&&(x.displayName=h.displayName,x.photoURL=h.photoURL),yield h._updateTokensIfNecessary(w)}),zo.apply(this,arguments)}function mi(u,o,c){return xn.apply(this,arguments)}function xn(){return(xn=(0,v.Z)(function*(u,o,c){const{auth:h}=u,_={idToken:yield u.getIdToken(),returnSecureToken:!0};o&&(_.email=o),c&&(_.password=c);const w=yield xt(u,Qr(h,_));yield u._updateTokensIfNecessary(w,!0)})).apply(this,arguments)}class Jn{constructor(o,c,h={}){this.isNewUser=o,this.providerId=c,this.profile=h}}class pc extends Jn{constructor(o,c,h,p){super(o,c,h),this.username=p}}class Be extends Jn{constructor(o,c){super(o,"facebook.com",c)}}class Bo extends pc{constructor(o,c){super(o,"github.com",c,"string"==typeof c?.login?c?.login:null)}}class gs extends Jn{constructor(o,c){super(o,"google.com",c)}}class _s extends pc{constructor(o,c,h){super(o,"twitter.com",c,h)}}function $h(u){const{user:o,_tokenResponse:c}=u;return o.isAnonymous&&!c?{providerId:null,isNewUser:!1,profile:null}:function Zo(u){var o,c;if(!u)return null;const{providerId:h}=u,p=u.rawUserInfo?JSON.parse(u.rawUserInfo):{},_=u.isNewUser||"identitytoolkit#SignupNewUserResponse"===u.kind;if(!h&&u?.idToken){const w=null===(c=null===(o=Kt(u.idToken))||void 0===o?void 0:o.firebase)||void 0===c?void 0:c.sign_in_provider;if(w)return new Jn(_,"anonymous"!==w&&"custom"!==w?w:null)}if(!h)return null;switch(h){case"facebook.com":return new Be(_,p);case"github.com":return new Bo(_,p);case"google.com":return new gs(_,p);case"twitter.com":return new _s(_,p,u.screenName||null);case"custom":case"anonymous":return new Jn(_,null);default:return new Jn(_,h,p)}}(c)}class mn{constructor(o,c,h){this.type=o,this.credential=c,this.auth=h}static _fromIdtoken(o,c){return new mn("enroll",o,c)}static _fromMfaPendingCredential(o){return new mn("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var c,h;if(o?.multiFactorSession){if(null!==(c=o.multiFactorSession)&&void 0!==c&&c.pendingCredential)return mn._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(h=o.multiFactorSession)&&void 0!==h&&h.idToken)return mn._fromIdtoken(o.multiFactorSession.idToken)}return null}}class mc{constructor(o,c,h){this.session=o,this.hints=c,this.signInResolver=h}static _fromError(o,c){const h=We(o),p=c.customData._serverResponse,_=(p.mfaInfo||[]).map(x=>Qn._fromServerResponse(h,x));F(p.mfaPendingCredential,h,"internal-error");const w=mn._fromMfaPendingCredential(p.mfaPendingCredential);return new mc(w,_,function(){var x=(0,v.Z)(function*(V){const G=yield V._process(h,w);delete p.mfaInfo,delete p.mfaPendingCredential;const Y=Object.assign(Object.assign({},p),{idToken:G.idToken,refreshToken:G.refreshToken});switch(c.operationType){case"signIn":const J=yield pn._fromIdTokenResponse(h,c.operationType,Y);return yield h._updateCurrentUser(J.user),J;case"reauthenticate":return F(c.user,h,"internal-error"),pn._forOperation(c.user,c.operationType,Y);default:Ue(h,"internal-error")}});return function(V){return x.apply(this,arguments)}}())}resolveSignIn(o){var c=this;return(0,v.Z)(function*(){return c.signInResolver(o)})()}}class ys{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(c=>{c.mfaInfo&&(this.enrolledFactors=c.mfaInfo.map(h=>Qn._fromServerResponse(o.auth,h)))})}static _fromUser(o){return new ys(o)}getSession(){var o=this;return(0,v.Z)(function*(){return mn._fromIdtoken(yield o.user.getIdToken(),o.user.auth)})()}enroll(o,c){var h=this;return(0,v.Z)(function*(){const p=o,_=yield h.getSession(),w=yield xt(h.user,p._process(h.user.auth,_,c));return yield h.user._updateTokensIfNecessary(w),h.user.reload()})()}unenroll(o){var c=this;return(0,v.Z)(function*(){const h="string"==typeof o?o:o.uid,p=yield c.user.getIdToken();try{const _=yield xt(c.user,function gc(u,o){return Me(u,"POST","/v2/accounts/mfaEnrollment:withdraw",De(u,o))}(c.user.auth,{idToken:p,mfaEnrollmentId:h}));c.enrolledFactors=c.enrolledFactors.filter(({uid:w})=>w!==h),yield c.user._updateTokensIfNecessary(_),yield c.user.reload()}catch(_){throw _}})()}}const jo=new WeakMap,$o="__sak";class tl{constructor(o,c){this.storageRetriever=o,this.type=c}_isAvailable(){try{return this.storage?(this.storage.setItem($o,"1"),this.storage.removeItem($o),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,c){return this.storage.setItem(o,JSON.stringify(c)),Promise.resolve()}_get(o){const c=this.storage.getItem(o);return Promise.resolve(c?JSON.parse(c):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const qi=(()=>{class u extends tl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(c,h)=>this.onStorageEvent(c,h),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function td(){const u=(0,R.z$)();return D(u)||It(u)}()&&function $a(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=jn(),this._shouldAllowMigration=!0}forAllChangedKeys(c){for(const h of Object.keys(this.listeners)){const p=this.storage.getItem(h),_=this.localCache[h];p!==_&&c(h,_,p)}}onStorageEvent(c,h=!1){if(!c.key)return void this.forAllChangedKeys((x,V,G)=>{this.notifyListeners(x,G)});const p=c.key;if(h?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const x=this.storage.getItem(p);if(c.newValue!==x)null!==c.newValue?this.storage.setItem(p,c.newValue):this.storage.removeItem(p);else if(this.localCache[p]===c.newValue&&!h)return}const _=()=>{const x=this.storage.getItem(p);!h&&this.localCache[p]===x||this.notifyListeners(p,x)},w=this.storage.getItem(p);!function Mi(){return(0,R.w1)()&&10===document.documentMode}()||w===c.newValue||c.newValue===c.oldValue?_():setTimeout(_,10)}notifyListeners(c,h){this.localCache[c]=h;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(h&&JSON.parse(h))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((c,h,p)=>{this.onStorageEvent(new StorageEvent("storage",{key:c,oldValue:h,newValue:p}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(c,h){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[c]||(this.listeners[c]=new Set,this.localCache[c]=this.storage.getItem(c)),this.listeners[c].add(h)}_removeListener(c,h){this.listeners[c]&&(this.listeners[c].delete(h),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(c,h){var p=()=>super._set,_=this;return(0,v.Z)(function*(){yield p().call(_,c,h),_.localCache[c]=JSON.stringify(h)})()}_get(c){var h=()=>super._get,p=this;return(0,v.Z)(function*(){const _=yield h().call(p,c);return p.localCache[c]=JSON.stringify(_),_})()}_remove(c){var h=()=>super._remove,p=this;return(0,v.Z)(function*(){yield h().call(p,c),delete p.localCache[c]})()}}return u.type="LOCAL",u})(),Xn=(()=>{class u extends tl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(c,h){}_removeListener(c,h){}}return u.type="SESSION",u})();let Is=(()=>{class u{constructor(c){this.eventTarget=c,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(c){const h=this.receivers.find(_=>_.isListeningto(c));if(h)return h;const p=new u(c);return this.receivers.push(p),p}isListeningto(c){return this.eventTarget===c}handleEvent(c){var h=this;return(0,v.Z)(function*(){const p=c,{eventId:_,eventType:w,data:x}=p.data,V=h.handlersMap[w];if(!V?.size)return;p.ports[0].postMessage({status:"ack",eventId:_,eventType:w});const G=Array.from(V).map(function(){var J=(0,v.Z)(function*(Re){return Re(p.origin,x)});return function(Re){return J.apply(this,arguments)}}()),Y=yield function vs(u){return Promise.all(u.map(function(){var o=(0,v.Z)(function*(c){try{return{fulfilled:!0,value:yield c}}catch(h){return{fulfilled:!1,reason:h}}});return function(c){return o.apply(this,arguments)}}()))}(G);p.ports[0].postMessage({status:"done",eventId:_,eventType:w,response:Y})})()}_subscribe(c,h){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[c]||(this.handlersMap[c]=new Set),this.handlersMap[c].add(h)}_unsubscribe(c,h){this.handlersMap[c]&&h&&this.handlersMap[c].delete(h),(!h||0===this.handlersMap[c].size)&&delete this.handlersMap[c],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return u.receivers=[],u})();function ws(u="",o=10){let c="";for(let h=0;h<o;h++)c+=Math.floor(10*Math.random());return u+c}class Qe{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,c,h=50){var p=this;return(0,v.Z)(function*(){const _=typeof MessageChannel<"u"?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let w,x;return new Promise((V,G)=>{const Y=ws("",20);_.port1.start();const J=setTimeout(()=>{G(new Error("unsupported_event"))},h);x={messageChannel:_,onMessage(Re){const qt=Re;if(qt.data.eventId===Y)switch(qt.data.status){case"ack":clearTimeout(J),w=setTimeout(()=>{G(new Error("timeout"))},3e3);break;case"done":clearTimeout(w),V(qt.data.response);break;default:clearTimeout(J),clearTimeout(w),G(new Error("invalid_response"))}}},p.handlers.add(x),_.port1.addEventListener("message",x.onMessage),p.target.postMessage({eventType:o,eventId:Y,data:c},[_.port2])}).finally(()=>{x&&p.removeMessageHandler(x)})})()}}function st(){return window}function _c(){return typeof st().WorkerGlobalScope<"u"&&"function"==typeof st().importScripts}function Wo(){return(Wo=(0,v.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Ts="firebaseLocalStorageDb",tn="firebaseLocalStorage",yc="fbase_key";class Es{constructor(o){this.request=o}toPromise(){return new Promise((o,c)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{c(this.request.error)})})}}function bs(u,o){return u.transaction([tn],o?"readwrite":"readonly").objectStore(tn)}function ji(){const u=indexedDB.open(Ts,1);return new Promise((o,c)=>{u.addEventListener("error",()=>{c(u.error)}),u.addEventListener("upgradeneeded",()=>{const h=u.result;try{h.createObjectStore(tn,{keyPath:yc})}catch(p){c(p)}}),u.addEventListener("success",(0,v.Z)(function*(){const h=u.result;h.objectStoreNames.contains(tn)?o(h):(h.close(),yield function vc(){const u=indexedDB.deleteDatabase(Ts);return new Es(u).toPromise()}(),o(yield ji()))}))})}function Ic(u,o,c){return Cs.apply(this,arguments)}function Cs(){return(Cs=(0,v.Z)(function*(u,o,c){const h=bs(u,!0).put({[yc]:o,value:c});return new Es(h).toPromise()})).apply(this,arguments)}function Yo(){return(Yo=(0,v.Z)(function*(u,o){const c=bs(u,!1).get(o),h=yield new Es(c).toPromise();return void 0===h?null:h.value})).apply(this,arguments)}function xs(u,o){const c=bs(u,!0).delete(o);return new Es(c).toPromise()}const $i=(()=>{class u{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var c=this;return(0,v.Z)(function*(){return c.db||(c.db=yield ji()),c.db})()}_withRetries(c){var h=this;return(0,v.Z)(function*(){let p=0;for(;;)try{const _=yield h._openDb();return yield c(_)}catch(_){if(p++>3)throw _;h.db&&(h.db.close(),h.db=void 0)}})()}initializeServiceWorkerMessaging(){var c=this;return(0,v.Z)(function*(){return _c()?c.initializeReceiver():c.initializeSender()})()}initializeReceiver(){var c=this;return(0,v.Z)(function*(){c.receiver=Is._getInstance(function rl(){return _c()?self:null}()),c.receiver._subscribe("keyChanged",function(){var h=(0,v.Z)(function*(p,_){return{keyProcessed:(yield c._poll()).includes(_.key)}});return function(p,_){return h.apply(this,arguments)}}()),c.receiver._subscribe("ping",function(){var h=(0,v.Z)(function*(p,_){return["keyChanged"]});return function(p,_){return h.apply(this,arguments)}}())})()}initializeSender(){var c=this;return(0,v.Z)(function*(){var h,p;if(c.activeServiceWorker=yield function rd(){return Wo.apply(this,arguments)}(),!c.activeServiceWorker)return;c.sender=new Qe(c.activeServiceWorker);const _=yield c.sender._send("ping",{},800);_&&null!==(h=_[0])&&void 0!==h&&h.fulfilled&&null!==(p=_[0])&&void 0!==p&&p.value.includes("keyChanged")&&(c.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(c){var h=this;return(0,v.Z)(function*(){if(h.sender&&h.activeServiceWorker&&function il(){var u;return(null===(u=navigator?.serviceWorker)||void 0===u?void 0:u.controller)||null}()===h.activeServiceWorker)try{yield h.sender._send("keyChanged",{key:c},h.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,v.Z)(function*(){try{if(!indexedDB)return!1;const c=yield ji();return yield Ic(c,$o,"1"),yield xs(c,$o),!0}catch{}return!1})()}_withPendingWrite(c){var h=this;return(0,v.Z)(function*(){h.pendingWrites++;try{yield c()}finally{h.pendingWrites--}})()}_set(c,h){var p=this;return(0,v.Z)(function*(){return p._withPendingWrite((0,v.Z)(function*(){return yield p._withRetries(_=>Ic(_,c,h)),p.localCache[c]=h,p.notifyServiceWorker(c)}))})()}_get(c){var h=this;return(0,v.Z)(function*(){const p=yield h._withRetries(_=>function Qo(u,o){return Yo.apply(this,arguments)}(_,c));return h.localCache[c]=p,p})()}_remove(c){var h=this;return(0,v.Z)(function*(){return h._withPendingWrite((0,v.Z)(function*(){return yield h._withRetries(p=>xs(p,c)),delete h.localCache[c],h.notifyServiceWorker(c)}))})()}_poll(){var c=this;return(0,v.Z)(function*(){const h=yield c._withRetries(w=>{const x=bs(w,!1).getAll();return new Es(x).toPromise()});if(!h)return[];if(0!==c.pendingWrites)return[];const p=[],_=new Set;for(const{fbase_key:w,value:x}of h)_.add(w),JSON.stringify(c.localCache[w])!==JSON.stringify(x)&&(c.notifyListeners(w,x),p.push(w));for(const w of Object.keys(c.localCache))c.localCache[w]&&!_.has(w)&&(c.notifyListeners(w,null),p.push(w));return p})()}notifyListeners(c,h){this.localCache[c]=h;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(h)}startPolling(){var c=this;this.stopPolling(),this.pollTimer=setInterval((0,v.Z)(function*(){return c._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(c,h){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[c]||(this.listeners[c]=new Set,this._get(c)),this.listeners[c].add(h)}_removeListener(c,h){this.listeners[c]&&(this.listeners[c].delete(h),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return u.type="LOCAL",u})(),Ss=1e12;class ul{constructor(o){this.auth=o,this.counter=Ss,this._widgets=new Map}render(o,c){const h=this.counter;return this._widgets.set(h,new Hi(o,this.auth.name,c||{})),this.counter++,h}reset(o){var c;const h=o||Ss;null===(c=this._widgets.get(h))||void 0===c||c.delete(),this._widgets.delete(h)}getResponse(o){var c;return(null===(c=this._widgets.get(o||Ss))||void 0===c?void 0:c.getResponse())||""}execute(o){var c=this;return(0,v.Z)(function*(){var h;return null===(h=c._widgets.get(o||Ss))||void 0===h||h.execute(),""})()}}class Hi{constructor(o,c,h){this.params=h,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const p="string"==typeof o?document.getElementById(o):o;F(p,"argument-error",{appName:c}),this.container=p,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function ll(u){const o=[],c="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let h=0;h<u;h++)o.push(c.charAt(Math.floor(62*Math.random())));return o.join("")}(50);const{callback:o,"expired-callback":c}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,c)try{c()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const ea=j("rcb"),hl=new un(3e4,6e4);class ta{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=st().grecaptcha)||void 0===o||!o.render)}load(o,c=""){return F(function nn(u){return u.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(u)}(c),o,"argument-error"),this.shouldResolveImmediately(c)&&me(st().grecaptcha)?Promise.resolve(st().grecaptcha):new Promise((h,p)=>{const _=st().setTimeout(()=>{p(E(o,"network-request-failed"))},hl.get());st()[ea]=()=>{st().clearTimeout(_),delete st()[ea];const x=st().grecaptcha;if(!x||!me(x))return void p(E(o,"internal-error"));const V=x.render;x.render=(G,Y)=>{const J=V(G,Y);return this.counter++,J},this.hostLanguage=c,h(x)},ut(`https://www.google.com/recaptcha/api.js??${(0,R.xO)({onload:ea,render:"explicit",hl:c})}`).catch(()=>{clearTimeout(_),p(E(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var c;return!(null===(c=st().grecaptcha)||void 0===c||!c.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class fl{load(o){return(0,v.Z)(function*(){return new ul(o)})()}clearedOneInstance(){}}const Ec="recaptcha",Tr={theme:"light",type:"image"};class od{constructor(o,c=Object.assign({},Tr),h){this.parameters=c,this.type=Ec,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=We(h),this.isInvisible="invisible"===this.parameters.size,F(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const p="string"==typeof o?document.getElementById(o):o;F(p,this.auth,"argument-error"),this.container=p,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new fl:new ta,this.validateStartingState()}verify(){var o=this;return(0,v.Z)(function*(){o.assertNotDestroyed();const c=yield o.render(),h=o.getAssertedRecaptcha();return h.getResponse(c)||new Promise(_=>{const w=x=>{x&&(o.tokenChangeListeners.delete(w),_(x))};o.tokenChangeListeners.add(w),o.isInvisible&&h.execute(c)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){F(!this.parameters.sitekey,this.auth,"argument-error"),F(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),F(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return c=>{if(this.tokenChangeListeners.forEach(h=>h(c)),"function"==typeof o)o(c);else if("string"==typeof o){const h=st()[o];"function"==typeof h&&h(c)}}}assertNotDestroyed(){F(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,v.Z)(function*(){if(yield o.init(),!o.widgetId){let c=o.container;if(!o.isInvisible){const h=document.createElement("div");c.appendChild(h),c=h}o.widgetId=o.getAssertedRecaptcha().render(c,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,v.Z)(function*(){F(oi()&&!_c(),o.auth,"internal-error"),yield function Sn(){let u=null;return new Promise(o=>{"complete"!==document.readyState?(u=()=>o(),window.addEventListener("load",u)):o()}).catch(o=>{throw u&&window.removeEventListener("load",u),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const c=yield function k(u){return z.apply(this,arguments)}(o.auth);F(c,o.auth,"internal-error"),o.parameters.sitekey=c})()}getAssertedRecaptcha(){return F(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class As{constructor(o,c){this.verificationId=o,this.onConfirmation=c}confirm(o){const c=hi._fromVerification(this.verificationId,o);return this.onConfirmation(c)}}function bc(){return(bc=(0,v.Z)(function*(u,o,c){const h=We(u),p=yield ei(h,o,(0,R.m9)(c));return new As(p,_=>Vi(h,_))})).apply(this,arguments)}function gn(){return(gn=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u);yield us(!1,h,"phone");const p=yield ei(h.auth,o,(0,R.m9)(c));return new As(p,_=>qu(h,_))})).apply(this,arguments)}function ks(){return(ks=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u),p=yield ei(h.auth,o,(0,R.m9)(c));return new As(p,_=>ju(h,_))})).apply(this,arguments)}function ei(u,o,c){return Ds.apply(this,arguments)}function Ds(){return Ds=(0,v.Z)(function*(u,o,c){var h;const p=yield c.verify();try{let _;if(F("string"==typeof p,u,"argument-error"),F(c.type===Ec,u,"argument-error"),_="string"==typeof o?{phoneNumber:o}:o,"session"in _){const w=_.session;if("phoneNumber"in _)return F("enroll"===w.type,u,"internal-error"),(yield function Ju(u,o){return Me(u,"POST","/v2/accounts/mfaEnrollment:start",De(u,o))}(u,{idToken:w.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:p}})).phoneSessionInfo.sessionInfo;{F("signin"===w.type,u,"internal-error");const x=(null===(h=_.multiFactorHint)||void 0===h?void 0:h.uid)||_.multiFactorUid;return F(x,u,"missing-multi-factor-info"),(yield function al(u,o){return Me(u,"POST","/v2/accounts/mfaSignIn:start",De(u,o))}(u,{mfaPendingCredential:w.credential,mfaEnrollmentId:x,phoneSignInInfo:{recaptchaToken:p}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:w}=yield function Fh(u,o){return Io.apply(this,arguments)}(u,{phoneNumber:_.phoneNumber,recaptchaToken:p});return w}}finally{c._reset()}}),Ds.apply(this,arguments)}function An(){return(An=(0,v.Z)(function*(u,o){yield as((0,R.m9)(u),o)})).apply(this,arguments)}let Ft=(()=>{class u{constructor(c){this.providerId=u.PROVIDER_ID,this.auth=We(c)}verifyPhoneNumber(c,h){return ei(this.auth,c,(0,R.m9)(h))}static credential(c,h){return hi._fromVerification(c,h)}static credentialFromResult(c){return u.credentialFromTaggedObject(c)}static credentialFromError(c){return u.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{phoneNumber:h,temporaryProof:p}=c;return h&&p?hi._fromTokenResponse(h,p):null}}return u.PROVIDER_ID="phone",u.PHONE_SIGN_IN_METHOD="phone",u})();function qe(u,o){return o?Lt(o):(F(u._popupRedirectResolver,u,"argument-error"),u._popupRedirectResolver)}class Er extends rt{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return Kn(o,this._buildIdpRequest())}_linkToIdToken(o,c){return Kn(o,this._buildIdpRequest(c))}_getReauthenticationResolver(o){return Kn(o,this._buildIdpRequest())}_buildIdpRequest(o){const c={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(c.idToken=o),c}}function na(u){return ac(u.auth,new Er(u),u.bypassAuthState)}function Os(u){const{auth:o,user:c}=u;return F(c,o,"internal-error"),yr(c,new Er(u),u.bypassAuthState)}function ia(u){return ra.apply(this,arguments)}function ra(){return(ra=(0,v.Z)(function*(u){const{auth:o,user:c}=u;return F(c,o,"internal-error"),as(c,new Er(u),u.bypassAuthState)})).apply(this,arguments)}class Ki{constructor(o,c,h,p,_=!1){this.auth=o,this.resolver=h,this.user=p,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(c)?c:[c]}execute(){var o=this;return new Promise(function(){var c=(0,v.Z)(function*(h,p){o.pendingPromise={resolve:h,reject:p};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(_){o.reject(_)}});return function(h,p){return c.apply(this,arguments)}}())}onAuthEvent(o){var c=this;return(0,v.Z)(function*(){const{urlResponse:h,sessionId:p,postBody:_,tenantId:w,error:x,type:V}=o;if(x)return void c.reject(x);const G={auth:c.auth,requestUri:h,sessionId:p,tenantId:w||void 0,postBody:_||void 0,user:c.user,bypassAuthState:c.bypassAuthState};try{c.resolve(yield c.getIdpTask(V)(G))}catch(Y){c.reject(Y)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return na;case"linkViaPopup":case"linkViaRedirect":return ia;case"reauthViaPopup":case"reauthViaRedirect":return Os;default:Ue(this.auth,"internal-error")}}resolve(o){ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ad=new un(2e3,1e4);function Ns(){return(Ns=(0,v.Z)(function*(u,o,c){const h=We(u);we(u,o,Ln);const p=qe(h,c);return new br(h,"signInViaPopup",o,p).executeNotNull()})).apply(this,arguments)}function xc(){return(xc=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u);we(h.auth,o,Ln);const p=qe(h.auth,c);return new br(h.auth,"reauthViaPopup",o,p,h).executeNotNull()})).apply(this,arguments)}function Sc(){return(Sc=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u);we(h.auth,o,Ln);const p=qe(h.auth,c);return new br(h.auth,"linkViaPopup",o,p,h).executeNotNull()})).apply(this,arguments)}let br=(()=>{class u extends Ki{constructor(c,h,p,_,w){super(c,h,_,w),this.provider=p,this.authWindow=null,this.pollId=null,u.currentPopupAction&&u.currentPopupAction.cancel(),u.currentPopupAction=this}executeNotNull(){var c=this;return(0,v.Z)(function*(){const h=yield c.execute();return F(h,c.auth,"internal-error"),h})()}onExecution(){var c=this;return(0,v.Z)(function*(){ct(1===c.filter.length,"Popup operations only handle one event");const h=ws();c.authWindow=yield c.resolver._openPopup(c.auth,c.provider,c.filter[0],h),c.authWindow.associatedEvent=h,c.resolver._originValidation(c.auth).catch(p=>{c.reject(p)}),c.resolver._isIframeWebStorageSupported(c.auth,p=>{p||c.reject(E(c.auth,"web-storage-unsupported"))}),c.pollUserCancellation()})()}get eventId(){var c;return(null===(c=this.authWindow)||void 0===c?void 0:c.associatedEvent)||null}cancel(){this.reject(E(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,u.currentPopupAction=null}pollUserCancellation(){const c=()=>{var h,p;this.pollId=null!==(p=null===(h=this.authWindow)||void 0===h?void 0:h.window)&&void 0!==p&&p.closed?window.setTimeout(()=>{this.pollId=null,this.reject(E(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(c,ad.get())};c()}}return u.currentPopupAction=null,u})();const ld="pendingRedirect",Rs=new Map;class Cr extends Ki{constructor(o,c,h=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],c,void 0,h),this.eventId=null}execute(){var o=()=>super.execute,c=this;return(0,v.Z)(function*(){let h=Rs.get(c.auth._key());if(!h){try{const _=(yield function _l(u,o){return lt.apply(this,arguments)}(c.resolver,c.auth))?yield o().call(c):null;h=()=>Promise.resolve(_)}catch(p){h=()=>Promise.reject(p)}Rs.set(c.auth._key(),h)}return c.bypassAuthState||Rs.set(c.auth._key(),()=>Promise.resolve(null)),h()})()}onAuthEvent(o){var c=()=>super.onAuthEvent,h=this;return(0,v.Z)(function*(){if("signInViaRedirect"===o.type)return c().call(h,o);if("unknown"!==o.type){if(o.eventId){const p=yield h.auth._redirectUserForId(o.eventId);if(p)return h.user=p,c().call(h,o);h.resolve(null)}}else h.resolve(null)})()}onExecution(){return(0,v.Z)(function*(){})()}cleanUp(){}}function lt(){return(lt=(0,v.Z)(function*(u,o){const c=Ye(o),h=U(u);if(!(yield h._isAvailable()))return!1;const p="true"===(yield h._get(c));return yield h._remove(c),p})).apply(this,arguments)}function gi(u,o){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,v.Z)(function*(u,o){return U(u)._set(Ye(o),"true")})).apply(this,arguments)}function kc(u,o){Rs.set(u._key(),o)}function U(u){return Lt(u._redirectPersistence)}function Ye(u){return T(ld,u.config.apiKey,u.name)}function _n(u,o,c){return function Dc(u,o,c){return Q.apply(this,arguments)}(u,o,c)}function Q(){return(Q=(0,v.Z)(function*(u,o,c){const h=We(u);we(u,o,Ln),yield h._initializationPromise;const p=qe(h,c);return yield gi(p,h),p._openRedirect(h,o,"signInViaRedirect")})).apply(this,arguments)}function ie(u,o,c){return function hd(u,o,c){return H.apply(this,arguments)}(u,o,c)}function H(){return(H=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u);we(h.auth,o,Ln),yield h.auth._initializationPromise;const p=qe(h.auth,c);yield gi(p,h.auth);const _=yield vl(h);return p._openRedirect(h.auth,o,"reauthViaRedirect",_)})).apply(this,arguments)}function O(u,o,c){return function L(u,o,c){return ot.apply(this,arguments)}(u,o,c)}function ot(){return(ot=(0,v.Z)(function*(u,o,c){const h=(0,R.m9)(u);we(h.auth,o,Ln),yield h.auth._initializationPromise;const p=qe(h.auth,c);yield us(!1,h,o.providerId),yield gi(p,h.auth);const _=yield vl(h);return p._openRedirect(h.auth,o,"linkViaRedirect",_)})).apply(this,arguments)}function Oc(){return(Oc=(0,v.Z)(function*(u,o){return yield We(u)._initializationPromise,sa(u,o,!1)})).apply(this,arguments)}function sa(u,o){return Nc.apply(this,arguments)}function Nc(){return(Nc=(0,v.Z)(function*(u,o,c=!1){const h=We(u),p=qe(h,o),w=yield new Cr(h,p,c).execute();return w&&!c&&(delete w.user._redirectEventId,yield h._persistUserIfCurrent(w.user),yield h._setRedirectUser(null,o)),w})).apply(this,arguments)}function vl(u){return Rc.apply(this,arguments)}function Rc(){return(Rc=(0,v.Z)(function*(u){const o=ws(`${u.uid}:::`);return u._redirectEventId=o,yield u.auth._setRedirectUser(u),yield u.auth._persistUserIfCurrent(u),o})).apply(this,arguments)}class wl{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let c=!1;return this.consumers.forEach(h=>{this.isEventForConsumer(o,h)&&(c=!0,this.sendToConsumer(o,h),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function El(u){switch(u.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tl(u);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,c||(this.queuedRedirectEvent=o,c=!0)),c}sendToConsumer(o,c){var h;if(o.error&&!Tl(o)){const p=(null===(h=o.error.code)||void 0===h?void 0:h.split("auth/")[1])||"internal-error";c.onError(E(this.auth,p))}else c.onAuthEvent(o)}isEventForConsumer(o,c){const h=null===c.eventId||!!o.eventId&&o.eventId===c.eventId;return c.filter.includes(o.type)&&h}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(dd(o))}saveEventToCache(o){this.cachedEventUids.add(dd(o)),this.lastProcessedEventTime=Date.now()}}function dd(u){return[u.type,u.eventId,u.sessionId,u.tenantId].filter(o=>o).join("-")}function Tl({type:u,error:o}){return"unknown"===u&&"auth/no-auth-event"===o?.code}function ce(u){return _i.apply(this,arguments)}function _i(){return(_i=(0,v.Z)(function*(u,o={}){return Me(u,"GET","/v1/projects",o)})).apply(this,arguments)}const bl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ge=/^https?/;function Wi(){return(Wi=(0,v.Z)(function*(u){if(u.config.emulator)return;const{authorizedDomains:o}=yield ce(u);for(const c of o)try{if(be(c))return}catch{}Ue(u,"unauthorized-domain")})).apply(this,arguments)}function be(u){const o=Nn(),{protocol:c,hostname:h}=new URL(o);if(u.startsWith("chrome-extension://")){const w=new URL(u);return""===w.hostname&&""===h?"chrome-extension:"===c&&u.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===c&&w.hostname===h}if(!Ge.test(c))return!1;if(bl.test(u))return h===u;const p=u.replace(/\./g,"\\.");return new RegExp("^(.+\\."+p+"|"+p+")$","i").test(h)}const fd=new un(3e4,6e4);function je(){const u=st().___jsl;if(u?.H)for(const o of Object.keys(u.H))if(u.H[o].r=u.H[o].r||[],u.H[o].L=u.H[o].L||[],u.H[o].r=[...u.H[o].L],u.CP)for(let c=0;c<u.CP.length;c++)u.CP[c]=null}let Qi=null;const Yi=new un(5e3,15e3),pd="__/auth/iframe",oa="emulator/auth/iframe",md={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ps=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Cl(u){const o=u.config;F(o.authDomain,u,"auth-domain-config-required");const c=o.emulator?In(o,oa):`https://${u.config.authDomain}/${pd}`,h={apiKey:o.apiKey,appName:u.name,v:X.SDK_VERSION},p=Ps.get(u.config.apiHost);p&&(h.eid=p);const _=u._getFrameworks();return _.length&&(h.fw=_.join(",")),`${c}?${(0,R.xO)(h).slice(1)}`}function Gt(){return Gt=(0,v.Z)(function*(u){const o=yield function Pc(u){return Qi=Qi||function K(u){return new Promise((o,c)=>{var h,p,_;function w(){je(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{je(),c(E(u,"network-request-failed"))},timeout:fd.get()})}if(null!==(p=null===(h=st().gapi)||void 0===h?void 0:h.iframes)&&void 0!==p&&p.Iframe)o(gapi.iframes.getContext());else{if(null===(_=st().gapi)||void 0===_||!_.load){const x=j("iframefcb");return st()[x]=()=>{gapi.load?w():c(E(u,"network-request-failed"))},ut(`https://apis.google.com/js/api.js?onload=${x}`).catch(V=>c(V))}w()}}).catch(o=>{throw Qi=null,o})}(u),Qi}(u),c=st().gapi;return F(c,u,"internal-error"),o.open({where:document.body,url:Cl(u),messageHandlersFilter:c.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:md,dontclear:!0},h=>new Promise(function(){var p=(0,v.Z)(function*(_,w){yield h.restyle({setHideOnLeave:!1});const x=E(u,"network-request-failed"),V=st().setTimeout(()=>{w(x)},Yi.get());function G(){st().clearTimeout(V),_(h)}h.ping(G).then(G,()=>{w(x)})});return function(_,w){return p.apply(this,arguments)}}()))}),Gt.apply(this,arguments)}const Mc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class A{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const gd="__/auth/handler",Ms="emulator/auth/handler",vi=encodeURIComponent("fac");function Fc(u,o,c,h,p,_){return ti.apply(this,arguments)}function ti(){return(ti=(0,v.Z)(function*(u,o,c,h,p,_){F(u.config.authDomain,u,"auth-domain-config-required"),F(u.config.apiKey,u,"invalid-api-key");const w={apiKey:u.config.apiKey,appName:u.name,authType:c,redirectUrl:h,v:X.SDK_VERSION,eventId:p};if(o instanceof Ln){o.setDefaultLanguage(u.languageCode),w.providerId=o.providerId||"",(0,R.xb)(o.getCustomParameters())||(w.customParameters=JSON.stringify(o.getCustomParameters()));for(const[Y,J]of Object.entries(_||{}))w[Y]=J}if(o instanceof gr){const Y=o.getScopes().filter(J=>""!==J);Y.length>0&&(w.scopes=Y.join(","))}u.tenantId&&(w.tid=u.tenantId);const x=w;for(const Y of Object.keys(x))void 0===x[Y]&&delete x[Y];const V=yield u._getAppCheckToken(),G=V?`#${vi}=${encodeURIComponent(V)}`:"";return`${function kl({config:u}){return u.emulator?In(u,Ms):`https://${u.authDomain}/${gd}`}(u)}?${(0,R.xO)(x).slice(1)}${G}`})).apply(this,arguments)}const Ls="webStorageSupport",Dl=class _d{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xn,this._completeRedirectFn=sa,this._overrideRedirectResult=kc}_openPopup(o,c,h,p){var _=this;return(0,v.Z)(function*(){var w;ct(null===(w=_.eventManagers[o._key()])||void 0===w?void 0:w.manager,"_initialize() not called before _openPopup()");const x=yield Fc(o,c,h,Nn(),p);return function aa(u,o,c,h=500,p=600){const _=Math.max((window.screen.availHeight-p)/2,0).toString(),w=Math.max((window.screen.availWidth-h)/2,0).toString();let x="";const V=Object.assign(Object.assign({},Mc),{width:h.toString(),height:p.toString(),top:_,left:w}),G=(0,R.z$)().toLowerCase();c&&(x=ee(G)?"_blank":c),M(G)&&(o=o||"http://localhost",V.scrollbars="yes");const Y=Object.entries(V).reduce((Re,[qt,nr])=>`${Re}${qt}=${nr},`,"");if(function Yt(u=(0,R.z$)()){var o;return It(u)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(G)&&"_self"!==x)return function kn(u,o){const c=document.createElement("a");c.href=u,c.target=o;const h=document.createEvent("MouseEvent");h.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),c.dispatchEvent(h)}(o||"",x),new A(null);const J=window.open(o||"",x,Y);F(J,u,"popup-blocked");try{J.focus()}catch{}return new A(J)}(o,x,ws())})()}_openRedirect(o,c,h,p){var _=this;return(0,v.Z)(function*(){return yield _._originValidation(o),function id(u){st().location.href=u}(yield Fc(o,c,h,Nn(),p)),new Promise(()=>{})})()}_initialize(o){const c=o._key();if(this.eventManagers[c]){const{manager:p,promise:_}=this.eventManagers[c];return p?Promise.resolve(p):(ct(_,"If manager is not set, promise should be"),_)}const h=this.initAndGetManager(o);return this.eventManagers[c]={promise:h},h.catch(()=>{delete this.eventManagers[c]}),h}initAndGetManager(o){var c=this;return(0,v.Z)(function*(){const h=yield function xl(u){return Gt.apply(this,arguments)}(o),p=new wl(o);return h.register("authEvent",_=>(F(_?.authEvent,o,"invalid-auth-event"),{status:p.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),c.eventManagers[o._key()]={manager:p},c.iframes[o._key()]=h,p})()}_isIframeWebStorageSupported(o,c){this.iframes[o._key()].send(Ls,{type:Ls},p=>{var _;const w=null===(_=p?.[0])||void 0===_?void 0:_[Ls];void 0!==w&&c(!!w),Ue(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function re(u){return Wi.apply(this,arguments)}(o)),this.originValidationPromises[c]}get _shouldInitProactively(){return jn()||D()||It()}};class rn{constructor(o){this.factorId=o}_process(o,c,h){switch(c.type){case"enroll":return this._finalizeEnroll(o,c.credential,h);case"signin":return this._finalizeSignIn(o,c.credential);default:return nt("unexpected MultiFactorSessionType")}}}class Ji extends rn{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new Ji(o)}_finalizeEnroll(o,c,h){return function Xh(u,o){return Me(u,"POST","/v2/accounts/mfaEnrollment:finalize",De(u,o))}(o,{idToken:c,displayName:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,c){return function wc(u,o){return Me(u,"POST","/v2/accounts/mfaSignIn:finalize",De(u,o))}(o,{mfaPendingCredential:c,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Fs=(()=>{class u{constructor(){}static assertion(c){return Ji._fromCredential(c)}}return u.FACTOR_ID="phone",u})();var Dn="@firebase/auth";class ca{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var c=this;return(0,v.Z)(function*(){return c.assertAuthConfigured(),yield c.auth._initializationPromise,c.auth.currentUser?{accessToken:yield c.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const c=this.auth.onIdTokenChanged(h=>{o(h?.stsTokenManager.accessToken||null)});this.internalListeners.set(o,c),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const c=this.internalListeners.get(o);c&&(this.internalListeners.delete(o),c(),this.updateProactiveRefresh())}assertAuthConfigured(){F(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Xi(){return window}(0,R.Pz)("authIdTokenMaxAge"),function vd(u){(0,X._registerComponent)(new Fe.wA("auth",(o,{options:c})=>{const h=o.getProvider("app").getImmediate(),p=o.getProvider("heartbeat"),_=o.getProvider("app-check-internal"),{apiKey:w,authDomain:x}=h.options;F(w&&!w.includes(":"),"invalid-api-key",{appName:h.name});const V={apiKey:w,authDomain:x,clientPlatform:u,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:P(u)},G=new Lh(h,p,_,V);return function wt(u,o){const c=o?.persistence||[],h=(Array.isArray(c)?c:[c]).map(Lt);o?.errorMap&&u._updateErrorMap(o.errorMap),u._initializeWithPersistence(h,o?.popupRedirectResolver)}(G,c),G},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,c,h)=>{o.getProvider("auth-internal").initialize()})),(0,X._registerComponent)(new Fe.wA("auth-internal",o=>{const c=We(o.getProvider("auth").getImmediate());return new ca(c)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,X.registerVersion)(Dn,"0.23.2",function Nl(u){switch(u){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(u)),(0,X.registerVersion)(Dn,"0.23.2","esm2017")}("Browser");function Uc(){return Uc=(0,v.Z)(function*(u,o,c){var h;const{BuildInfo:p}=Xi();ct(o.sessionId,"AuthEvent did not contain a session ID");const _=yield function Ad(u){return ua.apply(this,arguments)}(o.sessionId),w={};return It()?w.ibi=p.packageName:Ae()?w.apn=p.packageName:Ue(u,"operation-not-supported-in-this-environment"),p.displayName&&(w.appDisplayName=p.displayName),w.sessionId=_,Fc(u,c,o.type,void 0,null!==(h=o.eventId)&&void 0!==h?h:void 0,w)}),Uc.apply(this,arguments)}function zc(){return(zc=(0,v.Z)(function*(u){const{BuildInfo:o}=Xi(),c={};It()?c.iosBundleId=o.packageName:Ae()?c.androidPackageName=o.packageName:Ue(u,"operation-not-supported-in-this-environment"),yield ce(u,c)})).apply(this,arguments)}function Zc(){return(Zc=(0,v.Z)(function*(u,o,c){const{cordova:h}=Xi();let p=()=>{};try{yield new Promise((_,w)=>{let x=null;function V(){var J;_();const Re=null===(J=h.plugins.browsertab)||void 0===J?void 0:J.close;"function"==typeof Re&&Re(),"function"==typeof c?.close&&c.close()}function G(){x||(x=window.setTimeout(()=>{w(E(u,"redirect-cancelled-by-user"))},2e3))}function Y(){"visible"===document?.visibilityState&&G()}o.addPassiveListener(V),document.addEventListener("resume",G,!1),Ae()&&document.addEventListener("visibilitychange",Y,!1),p=()=>{o.removePassiveListener(V),document.removeEventListener("resume",G,!1),document.removeEventListener("visibilitychange",Y,!1),x&&window.clearTimeout(x)}})}finally{p()}})).apply(this,arguments)}function ua(){return(ua=(0,v.Z)(function*(u){const o=function Ml(u){if(ct(/[0-9a-zA-Z]+/.test(u),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(u);const o=new ArrayBuffer(u.length),c=new Uint8Array(o);for(let h=0;h<u.length;h++)c[h]=u.charCodeAt(h);return c}(u),c=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(c)).map(p=>p.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Bc extends wl{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(c=>c(o)),super.onEvent(o)}initialized(){var o=this;return(0,v.Z)(function*(){yield o.initPromise})()}}function ni(u){return la.apply(this,arguments)}function la(){return(la=(0,v.Z)(function*(u){const o=yield pt()._get(Le(u));return o&&(yield pt()._remove(Le(u))),o})).apply(this,arguments)}function ha(){const u=[];for(let c=0;c<20;c++){const h=Math.floor(62*Math.random());u.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(h))}return u.join("")}function pt(){return Lt(qi)}function Le(u){return T("authEvent",u.config.apiKey,u.name)}function Ot(u){if(!u?.includes("?"))return{};const[o,...c]=u.split("?");return(0,R.zd)(c.join("?"))}const mt=class Dd{constructor(){this._redirectPersistence=Xn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=sa,this._overrideRedirectResult=kc}_initialize(o){var c=this;return(0,v.Z)(function*(){const h=o._key();let p=c.eventManagers.get(h);return p||(p=new Bc(o),c.eventManagers.set(h,p),c.attachCallbackListeners(o,p)),p})()}_openPopup(o){Ue(o,"operation-not-supported-in-this-environment")}_openRedirect(o,c,h,p){var _=this;return(0,v.Z)(function*(){!function Pl(u){var o,c,h,p,_,w,x,V,G,Y;const J=Xi();F("function"==typeof(null===(o=J?.universalLinks)||void 0===o?void 0:o.subscribe),u,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),F(typeof(null===(c=J?.BuildInfo)||void 0===c?void 0:c.packageName)<"u",u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),F("function"==typeof(null===(_=null===(p=null===(h=J?.cordova)||void 0===h?void 0:h.plugins)||void 0===p?void 0:p.browsertab)||void 0===_?void 0:_.openUrl),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),F("function"==typeof(null===(V=null===(x=null===(w=J?.cordova)||void 0===w?void 0:w.plugins)||void 0===x?void 0:x.browsertab)||void 0===V?void 0:V.isAvailable),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),F("function"==typeof(null===(Y=null===(G=J?.cordova)||void 0===G?void 0:G.InAppBrowser)||void 0===Y?void 0:Y.open),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const w=yield _._initialize(o);yield w.initialized(),w.resetRedirect(),function Ac(){Rs.clear()}(),yield _._originValidation(o);const x=function Et(u,o,c=null){return{type:o,eventId:c,urlResponse:null,sessionId:ha(),postBody:null,tenantId:u.tenantId,error:E(u,"no-auth-event")}}(o,h,p);yield function Ll(u,o){return pt()._set(Le(u),o)}(o,x);const V=yield function bd(u,o,c){return Uc.apply(this,arguments)}(o,x,c),G=yield function xd(u){const{cordova:o}=Xi();return new Promise(c=>{o.plugins.browsertab.isAvailable(h=>{let p=null;h?o.plugins.browsertab.openUrl(u):p=o.InAppBrowser.open(u,function Ee(u=(0,R.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(u)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(u)}()?"_blank":"_system","location=yes"),c(p)})})}(V);return function Sd(u,o,c){return Zc.apply(this,arguments)}(o,w,G)})()}_isIframeWebStorageSupported(o,c){throw new Error("Method not implemented.")}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function Cd(u){return zc.apply(this,arguments)}(o)),this.originValidationPromises[c]}attachCallbackListeners(o,c){const{universalLinks:h,handleOpenURL:p,BuildInfo:_}=Xi(),w=setTimeout((0,v.Z)(function*(){yield ni(o),c.onEvent(Ul())}),500),x=function(){var Y=(0,v.Z)(function*(J){clearTimeout(w);const Re=yield ni(o);let qt=null;Re&&J?.url&&(qt=function ze(u,o){var c,h;const p=function xr(u){const o=Ot(u),c=o.link?decodeURIComponent(o.link):void 0,h=Ot(c).link,p=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return Ot(p).link||p||h||c||u}(o);if(p.includes("/__/auth/callback")){const _=Ot(p),w=_.firebaseError?function Fl(u){try{return JSON.parse(u)}catch{return null}}(decodeURIComponent(_.firebaseError)):null,x=null===(h=null===(c=w?.code)||void 0===c?void 0:c.split("auth/"))||void 0===h?void 0:h[1],V=x?E(x):null;return V?{type:u.type,eventId:u.eventId,tenantId:u.tenantId,error:V,urlResponse:null,sessionId:null,postBody:null}:{type:u.type,eventId:u.eventId,tenantId:u.tenantId,sessionId:u.sessionId,urlResponse:p,postBody:null}}return null}(Re,J.url)),c.onEvent(qt||Ul())});return function(Re){return Y.apply(this,arguments)}}();typeof h<"u"&&"function"==typeof h.subscribe&&h.subscribe(null,x);const V=p,G=`${_.packageName.toLowerCase()}://`;Xi().handleOpenURL=function(){var Y=(0,v.Z)(function*(J){if(J.toLowerCase().startsWith(G)&&x({url:J}),"function"==typeof V)try{V(J)}catch(Re){console.error(Re)}});return function(J){return Y.apply(this,arguments)}}()}};function Ul(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:E("no-auth-event")}}function wi(){var u;return(null===(u=self?.location)||void 0===u?void 0:u.protocol)||null}function zl(u=(0,R.z$)()){return!("file:"!==wi()&&"ionic:"!==wi()&&"capacitor:"!==wi()||!u.toLowerCase().match(/iphone|ipad|ipod|android/))}function On(){try{const u=self.localStorage,o=ws();if(u)return u.setItem(o,"1"),u.removeItem(o),!function bi(u=(0,R.z$)()){return function Ei(){return(0,R.w1)()&&11===document?.documentMode}()||function fa(u=(0,R.z$)()){return/Edge\/\d+/.test(u)}(u)}()||(0,R.hl)()}catch{return er()&&(0,R.hl)()}return!1}function er(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Vn(){return(function Us(){return"http:"===wi()||"https:"===wi()}()||(0,R.ru)()||zl())&&!function Ti(){return(0,R.b$)()||(0,R.UG)()}()&&On()&&!er()}function Gc(){return zl()&&typeof document<"u"}function zs(){return(zs=(0,v.Z)(function*(){return!!Gc()&&new Promise(u=>{const o=setTimeout(()=>{u(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),u(!0)})})})).apply(this,arguments)}const gt={LOCAL:"local",NONE:"none",SESSION:"session"},tr=F,Ar="persistence";function ma(u){return kr.apply(this,arguments)}function kr(){return(kr=(0,v.Z)(function*(u){yield u._initializationPromise;const o=qc(),c=T(Ar,u.config.apiKey,u.name);o&&o.setItem(c,u._getPersistence())})).apply(this,arguments)}function qc(){var u;try{return(null===(u=function pa(){return typeof window<"u"?window:null}())||void 0===u?void 0:u.sessionStorage)||null}catch{return null}}const Od=F;class Ci{constructor(){this.browserResolver=Lt(Dl),this.cordovaResolver=Lt(mt),this.underlyingResolver=null,this._redirectPersistence=Xn,this._completeRedirectFn=sa,this._overrideRedirectResult=kc}_initialize(o){var c=this;return(0,v.Z)(function*(){return yield c.selectUnderlyingResolver(),c.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,c,h,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(o,c,h,p)})()}_openRedirect(o,c,h,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(o,c,h,p)})()}_isIframeWebStorageSupported(o,c){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,c)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Gc()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Od(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,v.Z)(function*(){if(o.underlyingResolver)return;const c=yield function Sr(){return zs.apply(this,arguments)}();o.underlyingResolver=c?o.cordovaResolver:o.browserResolver})()}}function jc(u){return u.unwrap()}function Nt(u){return Ze(u)}function Ze(u){const{_tokenResponse:o}=u instanceof R.ZR?u.customData:u;if(!o)return null;if(!(u instanceof R.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return Ft.credentialFromResult(u);const c=o.providerId;if(!c||c===ke.PASSWORD)return null;let h;switch(c){case ke.GOOGLE:h=bo;break;case ke.FACEBOOK:h=Eo;break;case ke.GITHUB:h=ft;break;case ke.TWITTER:h=Bu;break;default:const{oauthIdToken:p,oauthAccessToken:_,oauthTokenSecret:w,pendingToken:x,nonce:V}=o;return _||w||p||x?x?c.startsWith("saml.")?Wn._create(c,x):fn._fromParams({providerId:c,signInMethod:c,pendingToken:x,idToken:p,accessToken:_}):new di(c).credential({idToken:p,accessToken:_,rawNonce:V}):null}return u instanceof R.ZR?h.credentialFromError(u):h.credentialFromResult(u)}function at(u,o){return o.catch(c=>{throw c instanceof R.ZR&&function Gl(u,o){var c;const h=null===(c=o.customData)||void 0===c?void 0:c._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new Dr(u,function Jh(u,o){var c;const h=(0,R.m9)(u),p=o;return F(o.customData.operationType,h,"argument-error"),F(null===(c=p.customData._serverResponse)||void 0===c?void 0:c.mfaPendingCredential,h,"argument-error"),mc._fromError(h,p)}(u,o));else if(h){const p=Ze(o),_=o;p&&(_.credential=p,_.tenantId=h.tenantId||void 0,_.email=h.email||void 0,_.phoneNumber=h.phoneNumber||void 0)}}(u,c),c}).then(c=>{const p=c.user;return{operationType:c.operationType,credential:Nt(c),additionalUserInfo:$h(c),user:ri.getOrCreate(p)}})}function ga(u,o){return _a.apply(this,arguments)}function _a(){return(_a=(0,v.Z)(function*(u,o){const c=yield o;return{verificationId:c.verificationId,confirm:h=>at(u,c.confirm(h))}})).apply(this,arguments)}class Dr{constructor(o,c){this.resolver=c,this.auth=function Bl(u){return u.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return at(jc(this.auth),this.resolver.resolveSignIn(o))}}class ri{constructor(o){this._delegate=o,this.multiFactor=function el(u){const o=(0,R.m9)(u);return jo.has(o)||jo.set(o,ys._fromUser(o)),jo.get(o)}(o)}static getOrCreate(o){return ri.USER_MAP.has(o)||ri.USER_MAP.set(o,new ri(o)),ri.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var c=this;return(0,v.Z)(function*(){return at(c.auth,qu(c._delegate,o))})()}linkWithPhoneNumber(o,c){var h=this;return(0,v.Z)(function*(){return ga(h.auth,function Cc(u,o,c){return gn.apply(this,arguments)}(h._delegate,o,c))})()}linkWithPopup(o){var c=this;return(0,v.Z)(function*(){return at(c.auth,function gl(u,o,c){return Sc.apply(this,arguments)}(c._delegate,o,Ci))})()}linkWithRedirect(o){var c=this;return(0,v.Z)(function*(){return yield ma(We(c.auth)),O(c._delegate,o,Ci)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var c=this;return(0,v.Z)(function*(){return at(c.auth,ju(c._delegate,o))})()}reauthenticateWithPhoneNumber(o,c){return ga(this.auth,function pl(u,o,c){return ks.apply(this,arguments)}(this._delegate,o,c))}reauthenticateWithPopup(o){return at(this.auth,function ud(u,o,c){return xc.apply(this,arguments)}(this._delegate,o,Ci))}reauthenticateWithRedirect(o){var c=this;return(0,v.Z)(function*(){return yield ma(We(c.auth)),ie(c._delegate,o,Ci)})()}sendEmailVerification(o){return function Qu(u,o){return wr.apply(this,arguments)}(this._delegate,o)}unlink(o){var c=this;return(0,v.Z)(function*(){return yield function Zh(u,o){return _r.apply(this,arguments)}(c._delegate,o),c})()}updateEmail(o){return function Yu(u,o){return mi((0,R.m9)(u),o,null)}(this._delegate,o)}updatePassword(o){return function jh(u,o){return mi((0,R.m9)(u),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function ml(u,o){return An.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function qh(u,o){return zo.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,c){return function ms(u,o,c){return Yn.apply(this,arguments)}(this._delegate,o,c)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ri.USER_MAP=new WeakMap;const Or=F;let ye=(()=>{class u{constructor(c,h){if(this.app=c,h.isInitialized())return this._delegate=h.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:p}=c.options;Or(p,"invalid-api-key",{appName:c.name}),Or(p,"invalid-api-key",{appName:c.name});const _=typeof window<"u"?Ci:void 0;this._delegate=h.initialize({options:{persistence:Nr(p,c.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap(Zt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ri.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(c){this._delegate.languageCode=c}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(c){this._delegate.tenantId=c}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(c,h){!function $n(u,o,c){const h=We(u);F(h._canInitEmulator,h,"emulator-config-failed"),F(/^https?:\/\//.test(o),h,"invalid-emulator-scheme");const p=!!c?.disableWarnings,_=Pu(o),{host:w,port:x}=function Mu(u){const o=Pu(u),c=/(\/\/)?([^?#/]+)/.exec(u.substr(o.length));if(!c)return{host:"",port:null};const h=c[2].split("@").pop()||"",p=/^(\[[^\]]+\])(:|$)/.exec(h);if(p){const _=p[1];return{host:_,port:_o(h.substr(_.length+1))}}{const[_,w]=h.split(":");return{host:_,port:_o(w)}}}(o);h.config.emulator={url:`${_}//${w}${null===x?"":`:${x}`}/`},h.settings.appVerificationDisabledForTesting=!0,h.emulatorConfig=Object.freeze({host:w,port:x,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:p})}),p||function Lu(){function u(){const o=document.createElement("p"),c=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",c.position="fixed",c.width="100%",c.backgroundColor="#ffffff",c.border=".1em solid #000000",c.color="#b50000",c.bottom="0px",c.left="0px",c.margin="0px",c.zIndex="10000",c.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",u):u())}()}(this._delegate,c,h)}applyActionCode(c){return function Hu(u,o){return Mo.apply(this,arguments)}(this._delegate,c)}checkActionCode(c){return Ir(this._delegate,c)}confirmPasswordReset(c,h){return function $u(u,o,c){return hs.apply(this,arguments)}(this._delegate,c,h)}createUserWithEmailAndPassword(c,h){var p=this;return(0,v.Z)(function*(){return at(p._delegate,function Lo(u,o,c){return Zi.apply(this,arguments)}(p._delegate,c,h))})()}fetchProvidersForEmail(c){return this.fetchSignInMethodsForEmail(c)}fetchSignInMethodsForEmail(c){return function Gh(u,o){return Bi.apply(this,arguments)}(this._delegate,c)}isSignInWithEmailLink(c){return function Fo(u,o){const c=mr.parseLink(o);return"EMAIL_SIGNIN"===c?.operation}(0,c)}getRedirectResult(){var c=this;return(0,v.Z)(function*(){Or(Vn(),c._delegate,"operation-not-supported-in-this-environment");const h=yield function yl(u,o){return Oc.apply(this,arguments)}(c._delegate,Ci);return h?at(c._delegate,Promise.resolve(h)):{credential:null,user:null}})()}addFrameworkForLogging(c){!function Ii(u,o){We(u)._logFramework(o)}(this._delegate,c)}onAuthStateChanged(c,h,p){const{next:_,error:w,complete:x}=Oe(c,h,p);return this._delegate.onAuthStateChanged(_,w,x)}onIdTokenChanged(c,h,p){const{next:_,error:w,complete:x}=Oe(c,h,p);return this._delegate.onIdTokenChanged(_,w,x)}sendSignInLinkToEmail(c,h){return function Bh(u,o,c){return ps.apply(this,arguments)}(this._delegate,c,h)}sendPasswordResetEmail(c,h){return function ls(u,o,c){return vr.apply(this,arguments)}(this._delegate,c,h||void 0)}setPersistence(c){var h=this;return(0,v.Z)(function*(){let p;switch(function Zl(u,o){tr(Object.values(gt).includes(o),u,"invalid-persistence-type"),(0,R.b$)()?tr(o!==gt.SESSION,u,"unsupported-persistence-type"):(0,R.UG)()?tr(o===gt.NONE,u,"unsupported-persistence-type"):er()?tr(o===gt.NONE||o===gt.LOCAL&&(0,R.hl)(),u,"unsupported-persistence-type"):tr(o===gt.NONE||On(),u,"unsupported-persistence-type")}(h._delegate,c),c){case gt.SESSION:p=Xn;break;case gt.LOCAL:p=(yield Lt($i)._isAvailable())?$i:qi;break;case gt.NONE:p=Cn;break;default:return Ue("argument-error",{appName:h._delegate.name})}return h._delegate.setPersistence(p)})()}signInAndRetrieveDataWithCredential(c){return this.signInWithCredential(c)}signInAnonymously(){return at(this._delegate,function zh(u){return Fi.apply(this,arguments)}(this._delegate))}signInWithCredential(c){return at(this._delegate,Vi(this._delegate,c))}signInWithCustomToken(c){return at(this._delegate,function No(u,o){return Ro.apply(this,arguments)}(this._delegate,c))}signInWithEmailAndPassword(c,h){return at(this._delegate,function Ku(u,o,c){return Vi((0,R.m9)(u),os.credential(o,c))}(this._delegate,c,h))}signInWithEmailLink(c,h){return at(this._delegate,function hc(u,o,c){return Vo.apply(this,arguments)}(this._delegate,c,h))}signInWithPhoneNumber(c,h){return ga(this._delegate,function Ne(u,o,c){return bc.apply(this,arguments)}(this._delegate,c,h))}signInWithPopup(c){var h=this;return(0,v.Z)(function*(){return Or(Vn(),h._delegate,"operation-not-supported-in-this-environment"),at(h._delegate,function cd(u,o,c){return Ns.apply(this,arguments)}(h._delegate,c,Ci))})()}signInWithRedirect(c){var h=this;return(0,v.Z)(function*(){return Or(Vn(),h._delegate,"operation-not-supported-in-this-environment"),yield ma(h._delegate),_n(h._delegate,c,Ci)})()}updateCurrentUser(c){return this._delegate.updateCurrentUser(c)}verifyPasswordResetCode(c){return function lc(u,o){return fs.apply(this,arguments)}(this._delegate,c)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return u.Persistence=gt,u})();function Oe(u,o,c){let h=u;"function"!=typeof u&&({next:h,error:o,complete:c}=u);const p=h;return{next:w=>p(w&&ri.getOrCreate(w)),error:o,complete:c}}function Nr(u,o){const c=function Zs(u,o){const c=qc();if(!c)return[];const h=T(Ar,u,o);switch(c.getItem(h)){case gt.NONE:return[Cn];case gt.LOCAL:return[$i,Xn];case gt.SESSION:return[Xn];default:return[]}}(u,o);if(typeof self<"u"&&!c.includes($i)&&c.push($i),typeof window<"u")for(const h of[qi,Xn])c.includes(h)||c.push(h);return c.includes(Cn)||c.push(Cn),c}class Bs{constructor(){this.providerId="phone",this._delegate=new Ft(jc(te.Z.auth()))}static credential(o,c){return Ft.credential(o,c)}verifyPhoneNumber(o,c){return this._delegate.verifyPhoneNumber(o,c)}unwrap(){return this._delegate}}Bs.PHONE_SIGN_IN_METHOD=Ft.PHONE_SIGN_IN_METHOD,Bs.PROVIDER_ID=Ft.PROVIDER_ID;const $c=F;class ql{constructor(o,c,h=te.Z.app()){var p;$c(null===(p=h.options)||void 0===p?void 0:p.apiKey,"invalid-api-key",{appName:h.name}),this._delegate=new od(o,c,h.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function jl(u){u.INTERNAL.registerComponent(new Fe.wA("auth-compat",o=>{const c=o.getProvider("app-compat").getImmediate(),h=o.getProvider("auth");return new ye(c,h)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:os,FacebookAuthProvider:Eo,GithubAuthProvider:ft,GoogleAuthProvider:bo,OAuthProvider:di,SAMLAuthProvider:Co,PhoneAuthProvider:Bs,PhoneMultiFactorGenerator:Fs,RecaptchaVerifier:ql,TwitterAuthProvider:Bu,Auth:ye,AuthCredential:rt,Error:R.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),u.registerVersion("@firebase/auth-compat","0.4.2")}(te.Z)},4859:(qr,Ut,q)=>{q.d(Ut,{H0:()=>zt,wA:()=>R});var v=q(5861),te=q(2090);class R{constructor(B,l,ne){this.name=B,this.instanceFactory=l,this.type=ne,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(B){return this.instantiationMode=B,this}setMultipleInstances(B){return this.multipleInstances=B,this}setServiceProps(B){return this.serviceProps=B,this}setInstanceCreatedCallback(B){return this.onInstanceCreated=B,this}}const X="[DEFAULT]";class vt{constructor(B,l){this.name=B,this.container=l,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(B){const l=this.normalizeInstanceIdentifier(B);if(!this.instancesDeferred.has(l)){const ne=new te.BH;if(this.instancesDeferred.set(l,ne),this.isInitialized(l)||this.shouldAutoInitialize())try{const ae=this.getOrInitializeService({instanceIdentifier:l});ae&&ne.resolve(ae)}catch{}}return this.instancesDeferred.get(l).promise}getImmediate(B){var l;const ne=this.normalizeInstanceIdentifier(B?.identifier),ae=null!==(l=B?.optional)&&void 0!==l&&l;if(!this.isInitialized(ne)&&!this.shouldAutoInitialize()){if(ae)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ne})}catch(Pe){if(ae)return null;throw Pe}}getComponent(){return this.component}setComponent(B){if(B.name!==this.name)throw Error(`Mismatching Component ${B.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=B,this.shouldAutoInitialize()){if(function Fe(ke){return"EAGER"===ke.instantiationMode}(B))try{this.getOrInitializeService({instanceIdentifier:X})}catch{}for(const[l,ne]of this.instancesDeferred.entries()){const ae=this.normalizeInstanceIdentifier(l);try{const Pe=this.getOrInitializeService({instanceIdentifier:ae});ne.resolve(Pe)}catch{}}}}clearInstance(B=X){this.instancesDeferred.delete(B),this.instancesOptions.delete(B),this.instances.delete(B)}delete(){var B=this;return(0,v.Z)(function*(){const l=Array.from(B.instances.values());yield Promise.all([...l.filter(ne=>"INTERNAL"in ne).map(ne=>ne.INTERNAL.delete()),...l.filter(ne=>"_delete"in ne).map(ne=>ne._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(B=X){return this.instances.has(B)}getOptions(B=X){return this.instancesOptions.get(B)||{}}initialize(B={}){const{options:l={}}=B,ne=this.normalizeInstanceIdentifier(B.instanceIdentifier);if(this.isInitialized(ne))throw Error(`${this.name}(${ne}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ae=this.getOrInitializeService({instanceIdentifier:ne,options:l});for(const[Pe,Zt]of this.instancesDeferred.entries())ne===this.normalizeInstanceIdentifier(Pe)&&Zt.resolve(ae);return ae}onInit(B,l){var ne;const ae=this.normalizeInstanceIdentifier(l),Pe=null!==(ne=this.onInitCallbacks.get(ae))&&void 0!==ne?ne:new Set;Pe.add(B),this.onInitCallbacks.set(ae,Pe);const Zt=this.instances.get(ae);return Zt&&B(Zt,ae),()=>{Pe.delete(B)}}invokeOnInitCallbacks(B,l){const ne=this.onInitCallbacks.get(l);if(ne)for(const ae of ne)try{ae(B,l)}catch{}}getOrInitializeService({instanceIdentifier:B,options:l={}}){let ne=this.instances.get(B);if(!ne&&this.component&&(ne=this.component.instanceFactory(this.container,{instanceIdentifier:(ke=B,ke===X?void 0:ke),options:l}),this.instances.set(B,ne),this.instancesOptions.set(B,l),this.invokeOnInitCallbacks(ne,B),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,B,ne)}catch{}var ke;return ne||null}normalizeInstanceIdentifier(B=X){return this.component?this.component.multipleInstances?B:X:B}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class zt{constructor(B){this.name=B,this.providers=new Map}addComponent(B){const l=this.getProvider(B.name);if(l.isComponentSet())throw new Error(`Component ${B.name} has already been registered with ${this.name}`);l.setComponent(B)}addOrOverwriteComponent(B){this.getProvider(B.name).isComponentSet()&&this.providers.delete(B.name),this.addComponent(B)}getProvider(B){if(this.providers.has(B))return this.providers.get(B);const l=new vt(B,this);return this.providers.set(B,l),l}getProviders(){return Array.from(this.providers.values())}}},1877:(qr,Ut,q)=>{q.d(Ut,{Am:()=>ke,Ub:()=>zt,Yd:()=>Fe,in:()=>te});const v=[];var te=(()=>((te=te||{})[te.DEBUG=0]="DEBUG",te[te.VERBOSE=1]="VERBOSE",te[te.INFO=2]="INFO",te[te.WARN=3]="WARN",te[te.ERROR=4]="ERROR",te[te.SILENT=5]="SILENT",te))();const R={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},X=te.INFO,vt={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},tt=(B,l,...ne)=>{if(l<B.logLevel)return;const ae=(new Date).toISOString(),Pe=vt[l];if(!Pe)throw new Error(`Attempted to log a message with an invalid logType (value: ${l})`);console[Pe](`[${ae}]  ${B.name}:`,...ne)};class Fe{constructor(l){this.name=l,this._logLevel=X,this._logHandler=tt,this._userLogHandler=null,v.push(this)}get logLevel(){return this._logLevel}set logLevel(l){if(!(l in te))throw new TypeError(`Invalid value "${l}" assigned to \`logLevel\``);this._logLevel=l}setLogLevel(l){this._logLevel="string"==typeof l?R[l]:l}get logHandler(){return this._logHandler}set logHandler(l){if("function"!=typeof l)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=l}get userLogHandler(){return this._userLogHandler}set userLogHandler(l){this._userLogHandler=l}debug(...l){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...l),this._logHandler(this,te.DEBUG,...l)}log(...l){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...l),this._logHandler(this,te.VERBOSE,...l)}info(...l){this._userLogHandler&&this._userLogHandler(this,te.INFO,...l),this._logHandler(this,te.INFO,...l)}warn(...l){this._userLogHandler&&this._userLogHandler(this,te.WARN,...l),this._logHandler(this,te.WARN,...l)}error(...l){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...l),this._logHandler(this,te.ERROR,...l)}}function zt(B){v.forEach(l=>{l.setLogLevel(B)})}function ke(B,l){for(const ne of v){let ae=null;l&&l.level&&(ae=R[l.level]),ne.userLogHandler=null===B?null:(Pe,Zt,...Ve)=>{const ge=Ve.map(_e=>{if(null==_e)return null;if("string"==typeof _e)return _e;if("number"==typeof _e||"boolean"==typeof _e)return _e.toString();if(_e instanceof Error)return _e.message;try{return JSON.stringify(_e)}catch{return null}}).filter(_e=>_e).join(" ");Zt>=(ae??Pe.logLevel)&&B({level:te[Zt].toLowerCase(),message:ge,args:Ve,type:Pe.name})}}}},5861:(qr,Ut,q)=>{function v(R,X,vt,tt,Fe,zt,ke){try{var B=R[zt](ke),l=B.value}catch(ne){return void vt(ne)}B.done?X(l):Promise.resolve(l).then(tt,Fe)}function te(R){return function(){var X=this,vt=arguments;return new Promise(function(tt,Fe){var zt=R.apply(X,vt);function ke(l){v(zt,tt,Fe,ke,B,"next",l)}function B(l){v(zt,tt,Fe,ke,B,"throw",l)}ke(void 0)})}}q.d(Ut,{Z:()=>te})}}]);