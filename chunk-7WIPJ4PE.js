import{a as Am}from"./chunk-4WOZYAGK.js";import{a as er,b as Hm}from"./chunk-KBP4LB4L.js";import{a as Vm,b as Om,c as Mm}from"./chunk-JPIT6QQQ.js";import{I as Qs,K as Ws,L as Xi,M as Nm,N as Tt,O as _n,P as qm,R as It,S as Um,T as fi,X as Gm,Y as jm,Z as Km}from"./chunk-IT3SYL6R.js";import{B as Ys,C as Zs,I as tt,J as Yi,L as mi,M as ct,N as Bm,R as Zi,a as yo,b as bo,c as Rc,d as Js,e as Vc,f as Oc,j as Mc,l as Fm,m as Lm,p as Nc,q as $m,s as zm,u as Xs}from"./chunk-7AWS6BT3.js";import{h as km,m as _o}from"./chunk-BRUBZK7G.js";import{c as pi,d as Mn,f as Zt,g as go,h as gn,i as kc,j as Dm,k as Dc,l as Rm}from"./chunk-S35HUXPS.js";import{$b as gm,B as um,Bc as Em,C as po,Ca as Je,Cc as Pc,Da as et,Dc as Cm,Ec as xm,Gc as Ks,Jb as Z,Kb as V,L as hm,Ma as Wt,Mc as he,N as dm,Nb as mo,Nc as $t,Ob as Ie,Pb as Dt,Q as Fs,Qb as ui,R as Ls,Rb as Rt,Sb as Vt,T as Ac,Tb as F,Ub as $,V as $s,Vb as Q,W as ci,Wb as bt,Wc as Qi,X as Sc,Xb as vt,Yb as Lt,Zb as Ke,ac as Ae,ba as Oe,bc as _m,bd as zt,c as Ki,ca as $e,cc as G,cd as Sm,db as fm,dc as qs,dd as Wi,ea as Ze,ec as fo,ed as Yt,f as Hi,fc as ym,fd as Ji,ga as ne,gb as R,gc as He,ha as je,hb as ft,hc as mn,hd as Pm,i as Ms,ia as pm,ic as be,j as cm,jc as ve,jd as lt,l as ho,ld as di,m as Ns,mc as bm,md as Hs,n as Vn,nc as me,o as On,oc as fn,pc as St,qa as zs,qc as Us,ra as ae,rc as Gs,s as Ye,sa as le,sc as js,ta as yt,tb as de,tc as Xt,ua as ye,ub as ze,uc as vm,vb as Bs,vc as wt,wb as xe,wc as hi,xb as Jt,xc as wm,ya as mm,yb as X,yc as Tm,zc as Im}from"./chunk-MP4GGJGU.js";import{a as Qm,b as Fc,c as Wm,d as vo,e as Lc,f as ea,g as Jm,h as Xm,i as $c,j as Pe,k as gi,l as en,m as ta,n as wo,o as Ym,p as Zm,q as Nn,r as Et}from"./chunk-SJNFS36Q.js";import{a as Ft,b as Cc,e as xc,f as P}from"./chunk-KT3CPUTC.js";var To=class{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}};var fe=(()=>{class n{static{this.OPERATOR_REV="\xAB"}static{this.OPERATOR_ADD="+"}static{this.OPERATOR_SUB="-"}static{this.OPERATOR_MUL="\xD7"}static{this.OPERATOR_DIV="/"}}return n})();var tr=class{constructor(e,t,i,r){this.id=e,this.selected=t,this.disabled=i,this.value=r}};var nr=class{constructor(){this.operands=[]}};var Bt=class{static evaluate(e,t,i){let r=Number.MIN_VALUE;switch(i){case fe.OPERATOR_ADD:{r=e+t;break}case fe.OPERATOR_SUB:{r=e>=t?e-t:Number.MIN_VALUE;break}case fe.OPERATOR_DIV:{r=e%t==0?e/t:Number.MIN_VALUE;break}case fe.OPERATOR_MUL:{r=e*t;break}}return r}static cloneGameParameters(e){let t=new nr;return t.result=e.result,e.operands.forEach(i=>{let r=new tr(i.id,!1,!1,-1);Object.assign(r,i),t.operands.push(r)}),t}};var Io=class{constructor(e,t,i){this.operands=e,this.operator=t,this.result=i}};var ef=pi("operandButtonAnimationMove",[go("buttonFromA",Zt({left:"{{ posALeft }}",top:"{{ posATop }}",width:"90px",height:"90px"}),{params:{posALeft:"1025px",posATop:"219px"}}),go("buttonToB",Zt({left:"{{ posBLeft }}",top:"{{ posBTop }}",width:"90px",height:"90px"}),{params:{posBLeft:"805px",posBTop:"324px"}}),gn("* => buttonToB",Mn("1.5s"))]);var tf=(n,e)=>e.id,tb=n=>({"background-color":n});function nb(n,e){if(n&1){let t=Ke();F(0,"button",10),Ae("click",function(){let r=ae(t).$implicit,o=G();return le(o.onOperandButtonClick(r))}),me(1),$()}if(n&2){let t=e.$implicit;V("disabled",t.disabled)("ngStyle",wt(4,tb,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",!t.disabled&&!t.selected?"operator-content-button":"operator-content-button-disabled"),R(),St("",t.value," ")}}function ib(n,e){if(n&1){let t=Ke();F(0,"button",11),Ae("click",function(){let r=ae(t).$implicit,o=G();return le(o.onOperatorButtonClick(r))}),Q(1,"mat-icon",12),$()}if(n&2){let t=e.$implicit,i=e.$index;V("ngClass",i===0?"revert-button":"arithmetic-operation-button"),R(),ym("svgIcon",t.icon)}}var na=(()=>{class n{constructor(t,i){this.githubLogoPath="assets/logos/GitHub-Mark-32px.png",this.operators=new Array({id:0,selected:!1,caption:fe.OPERATOR_REV,operator:fe.OPERATOR_REV,icon:"revert"},{id:1,selected:!1,caption:fe.OPERATOR_ADD,operator:fe.OPERATOR_ADD,icon:"addition"},{id:2,selected:!1,caption:fe.OPERATOR_SUB,operator:fe.OPERATOR_SUB,icon:"substraction"},{id:3,selected:!1,caption:fe.OPERATOR_MUL,operator:fe.OPERATOR_MUL,icon:"multiplication"},{id:4,selected:!1,caption:fe.OPERATOR_DIV,operator:fe.OPERATOR_DIV,icon:"division"}),this.expectedResultReached=new Je,this.invalidOperationExecuted=new Je,t.addSvgIcon("revert",i.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),t.addSvgIcon("addition",i.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),t.addSvgIcon("substraction",i.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),t.addSvgIcon("multiplication",i.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),t.addSvgIcon("division",i.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(t=>t.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(t=>{t.selected=!1})}isTheExpectedResultReached(t){return this.gameParameters.result===t}addStateToHistory(t){this.history.push(t)}clearSelectionOfOperators(){this.operators.forEach(t=>{t.selected=!1})}addGameOperationToOperationHistory(t){this.operationHistory?.push(t)}captureAnimationTriggerStartEvent(t){console.log("Animation trigger start ",t)}captureAnimationTriggerDoneEvent(t){console.log("Animation trigger done ",t)}ngOnInit(){this.history=new To,this.operationHistory=new To}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(t=>{t.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(t){if(t.selected=!t.selected,!t.selected){if(this.selectedOperandB&&this.selectedOperandB.id===t.id){this.selectedOperandB.selected=!1,this.selectedOperandB=null;return}else if(this.selectedOperandA&&this.selectedOperandA.id===t.id){this.selectedOperandA.selected=!1,this.selectedOperandA=null;return}}this.selectedOperandA?this.selectedOperandA.id!==t.id&&(this.selectedOperandB||(this.selectedOperandB=t)):this.selectedOperandA=t;let i=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!i)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&i){let r=Bt.cloneGameParameters(this.gameParameters),o=Bt.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,i.operator);if(this.addStateToHistory(r),o===Number.MIN_VALUE)this.invalidOperationExecuted.emit(o);else{let s=new Array(this.selectedOperandA.value,this.selectedOperandB.value),l=new Io(s,i.operator,o);this.addGameOperationToOperationHistory(l),this.isTheExpectedResultReached(o)&&this.expectedResultReached.emit(this.operationHistory),t.value=o;let c=this.gameParameters.operands.find(h=>h.id==this.selectedOperandA.id);c.disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${t.value} Selected ${t.selected}`)}onOperatorButtonClick(t){if(!this.selectedOperandA&&t.operator!==fe.OPERATOR_REV){t.selected=!1;return}if(t.selected=!t.selected,t.operator===fe.OPERATOR_REV){this.revertLastOperation();let i=Bt.cloneGameParameters(this.gameParameters),r=new Array;i.operands.forEach(s=>{r.push(s.value)});let o=new Io(r,t.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(o)}console.log(`Caption ${t.caption} Selected ${t.selected}`)}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}static{this.\u0275fac=function(i){return new(i||n)(ft(Vm),ft(km))}}static{this.\u0275cmp=de({type:n,selectors:[["app-game-arithmetic-operations"]],hostVars:1,hostBindings:function(i,r){i&1&&_m("@operandButtonAnimationMove.start",function(s){return r.captureAnimationTriggerStartEvent(s)})("@operandButtonAnimationMove.done",function(s){return r.captureAnimationTriggerDoneEvent(s)}),i&2&&gm("@operandButtonAnimationMove",r.operandButtonAnimation)},inputs:{gameParameters:"gameParameters"},outputs:{expectedResultReached:"expectedResultReached",invalidOperationExecuted:"invalidOperationExecuted"},decls:15,vars:2,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass"],[1,"operators-container"],["type","button",1,"operator-content",3,"ngClass"],["href","https://github.com/lkovari/LKovariHome/tree/master/src/app/digits/digits-game.component.ts"],["width","16","height","16",3,"src"],["type","button",1,"operand",3,"click","disabled","ngStyle","ngClass"],["type","button",1,"operator-content",3,"click","ngClass"],[1,"operator-content-icon",3,"svgIcon"]],template:function(i,r){i&1&&(F(0,"div",0)(1,"div",1),me(2,"Use the any combination of number to reach the target:"),$(),F(3,"div")(4,"label",2),me(5),$()(),F(6,"div",3)(7,"div",4),Rt(8,nb,2,6,"button",5,tf),$()(),F(10,"div",6),Rt(11,ib,2,2,"button",7,tf),$(),F(13,"a",8),Q(14,"img",9),$()()),i&2&&(R(5),fn(r.gameParameters.result),R(3),Vt(r.gameParameters.operands),R(3),Vt(r.operators),R(3),V("src",r.githubLogoPath,fm))},dependencies:[Yt,Xi,Qs,Ws,zt,Om],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{justify-content:center;display:flex;flex-direction:row;flex-wrap:wrap;width:371px;margin:7px auto}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"],data:{animation:[ef]}})}}return n})();var ia=class{constructor(){this.numbers=[]}generateNumber(e,t){let i=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(i)>=0;)i=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(i)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}};var ra=class{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){let e=this.generateNumber(0,4),t=fe.OPERATOR_ADD;switch(e){case 0:{t=fe.OPERATOR_ADD;break}case 1:{t=fe.OPERATOR_SUB;break}case 2:{t=fe.OPERATOR_MUL;break}case 3:{t=fe.OPERATOR_DIV;break}}return t}checkExecuteDivision(e,t){return e%t===0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let i=t;return e<t&&(i=t-1),this.operands.splice(e,1),i}calculateResult(e){let t=this.operands.length,i=0,r=0,o=this.generateNumber(3,5),s=Number.MIN_VALUE;for(;r<o&&e.length>1;){let l=this.choiceRandomOperation(),c=this.generateNumber(0,t-1);for(s===Number.MIN_VALUE&&(s=this.generateNumber(0,t-1));s===c;)c=this.generateNumber(0,t-1);switch(l){case fe.OPERATOR_ADD:{e[s]=Bt.evaluate(e[s],e[c],l),s=this.removeOperandByIndex(c,s),--t,++r;break}case fe.OPERATOR_SUB:{if(this.checkExecuteSubstraction(e[s],e[c]))e[s]=Bt.evaluate(e[s],e[c],l),s=this.removeOperandByIndex(c,s),--t,++r;else continue;break}case fe.OPERATOR_MUL:{e[s]=Bt.evaluate(e[s],e[c],l),s=this.removeOperandByIndex(c,s),--t,++r;break}case fe.OPERATOR_DIV:{if(this.checkExecuteDivision(e[s],e[c]))e[s]=Bt.evaluate(e[s],e[c],l),s=this.removeOperandByIndex(c,s),--t,++r;else continue;break}}}return i=e[s],i}generateGameParameter(e){let t=new ia;switch(e){case 0:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break}case 1:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break}case 2:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break}case 3:{t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break}case 4:{t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25);break}}let i=t.getGeneratedNumbers();i=i.sort((p,f)=>p-f);let r=new Array(i[0],i[1],i[2],i[3],i[4],i[5]);this.operands=new Array(i[0],i[1],i[2],i[3],i[4],i[5]),t.clearGeneratedNumbers();let o=0,s=0;switch(e){case 0:{o=30,s=100;break}case 1:{o=50,s=150;break}case 2:{o=100,s=200;break}case 3:{o=300,s=400;break}case 4:{o=400,s=550;break}}let l=this.calculateResult(this.operands);for(;o>l||l>s;)this.operands=new Array(i[0],i[1],i[2],i[3],i[4],i[5]),l=this.calculateResult(this.operands);let c=new nr;c.result=l;let h=0;return r.forEach(p=>{let f=new tr(h,!1,!1,p);c.operands.push(f),++h}),c}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){let i=this.generateGameParameter(t);i.stageIndex=t,e.push(i)}return e=e.sort((t,i)=>t.result-i.result),e}};var Eo=class{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}};var oa=(()=>{class n{constructor(t,i){this.document=t,this.platformId=i,this.documentIsAccessible=di(this.platformId)}static getCookieRegExp(t){let i=t.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+i+"|;\\s*"+i+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(t){try{return decodeURIComponent(t)}catch{return t}}check(t){return this.documentIsAccessible?(t=encodeURIComponent(t),n.getCookieRegExp(t).test(this.document.cookie)):!1}get(t){if(this.documentIsAccessible&&this.check(t)){t=encodeURIComponent(t);let r=n.getCookieRegExp(t).exec(this.document.cookie);return r[1]?n.safeDecodeURIComponent(r[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let t={},i=this.document;return i.cookie&&i.cookie!==""&&i.cookie.split(";").forEach(r=>{let[o,s]=r.split("=");t[n.safeDecodeURIComponent(o.replace(/^ /,""))]=n.safeDecodeURIComponent(s)}),t}set(t,i,r,o,s,l,c,h){if(!this.documentIsAccessible)return;if(typeof r=="number"||r instanceof Date||o||s||l||c){let _={expires:r,path:o,domain:s,secure:l,sameSite:c||"Lax",partitioned:h};this.set(t,i,_);return}let p=encodeURIComponent(t)+"="+encodeURIComponent(i)+";",f=r||{};if(f.expires)if(typeof f.expires=="number"){let _=new Date(new Date().getTime()+f.expires*1e3*60*60*24);p+="expires="+_.toUTCString()+";"}else p+="expires="+f.expires.toUTCString()+";";f.path&&(p+="path="+f.path+";"),f.domain&&(p+="domain="+f.domain+";"),f.secure===!1&&f.sameSite==="None"&&(f.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${t} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),f.secure&&(p+="secure;"),f.sameSite||(f.sameSite="Lax"),p+="sameSite="+f.sameSite+";",f.partitioned&&(p+="Partitioned;"),this.document.cookie=p}delete(t,i,r,o,s="Lax"){if(!this.documentIsAccessible)return;let l=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(t,"",{expires:l,path:i,domain:r,secure:o,sameSite:s})}deleteAll(t,i,r,o="Lax"){if(!this.documentIsAccessible)return;let s=this.getAll();for(let l in s)s.hasOwnProperty(l)&&this.delete(l,t,i,r,o)}static{this.\u0275fac=function(i){return new(i||n)(ne(Qi),ne(Wt))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var sa=class{constructor(){this.stages=[]}};var aa=class{constructor(){this.operands=[]}};var Co=class{};var la=(()=>{class n extends It{static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["CheckIcon"]],features:[xe],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0),Q(1,"path",1),$()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return n})();var ca=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["ExclamationTriangleIcon"]],features:[xe],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1)(3,"path",2)(4,"path",3),$(),F(5,"defs")(6,"clipPath",4),Q(7,"rect",5),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(5),V("id",r.pathId))},encapsulation:2})}return n})();var ua=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["InfoCircleIcon"]],features:[xe],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1),$(),F(3,"defs")(4,"clipPath",2),Q(5,"rect",3),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(3),V("id",r.pathId))},encapsulation:2})}return n})();var rf=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["SpinnerIcon"]],features:[xe],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1),$(),F(3,"defs")(4,"clipPath",2),Q(5,"rect",3),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(3),V("id",r.pathId))},encapsulation:2})}return n})();var ha=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["TimesCircleIcon"]],features:[xe],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1),$(),F(3,"defs")(4,"clipPath",2),Q(5,"rect",3),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(3),V("id",r.pathId))},encapsulation:2})}return n})();var of=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["WindowMaximizeIcon"]],features:[xe],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1),$(),F(3,"defs")(4,"clipPath",2),Q(5,"rect",3),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(3),V("id",r.pathId))},encapsulation:2})}return n})();var sf=(()=>{class n extends It{pathId;ngOnInit(){this.pathId="url(#"+tt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["WindowMinimizeIcon"]],features:[xe],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,r){i&1&&(yt(),F(0,"svg",0)(1,"g"),Q(2,"path",1),$(),F(3,"defs")(4,"clipPath",2),Q(5,"rect",3),$()()()),i&2&&(Ie(r.getClassNames()),Z("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),R(),Z("clip-path",r.pathId),R(3),V("id",r.pathId))},encapsulation:2})}return n})();var ob=({dt:n})=>`
.p-button {
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    color: ${n("button.primary.color")};
    background: ${n("button.primary.background")};
    border: 1px solid ${n("button.primary.border.color")};
    padding-block: ${n("button.padding.y")};
    padding-inline: ${n("button.padding.x")};
    font-size: 1rem;
    font-family: inherit;
    font-feature-settings: inherit;
    transition: background ${n("button.transition.duration")}, color ${n("button.transition.duration")}, border-color ${n("button.transition.duration")},
            outline-color ${n("button.transition.duration")}, box-shadow ${n("button.transition.duration")};
    border-radius: ${n("button.border.radius")};
    outline-color: transparent;
    gap: ${n("button.gap")};
}

.p-button:disabled {
    cursor: default;
}

.p-button-icon-right {
    order: 1;
}

.p-button-icon-right:dir(rtl) {
    order: -1;
}

.p-button:not(.p-button-vertical) .p-button-icon:not(.p-button-icon-right):dir(rtl) {
    order: 1;
}

.p-button-icon-bottom {
    order: 2;
}

.p-button-icon-only {
    width: ${n("button.icon.only.width")};
    padding-inline-start: 0;
    padding-inline-end: 0;
    gap: 0;
}

.p-button-icon-only.p-button-rounded {
    border-radius: 50%;
    height: ${n("button.icon.only.width")};
}

.p-button-icon-only .p-button-label {
    visibility: hidden;
    width: 0;
}

.p-button-sm {
    font-size: ${n("button.sm.font.size")};
    padding-block: ${n("button.sm.padding.y")};
    padding-inline: ${n("button.sm.padding.x")};
}

.p-button-sm .p-button-icon {
    font-size: ${n("button.sm.font.size")};
}

.p-button-lg {
    font-size: ${n("button.lg.font.size")};
    padding-block: ${n("button.lg.padding.y")};
    padding-inline: ${n("button.lg.padding.x")};
}

.p-button-lg .p-button-icon {
    font-size: ${n("button.lg.font.size")};
}

.p-button-vertical {
    flex-direction: column;
}

.p-button-label {
    font-weight: ${n("button.label.font.weight")};
}

.p-button-fluid {
    width: 100%;
}

.p-button-fluid.p-button-icon-only {
    width: ${n("button.icon.only.width")};
}

.p-button:not(:disabled):hover {
    background: ${n("button.primary.hover.background")};
    border: 1px solid ${n("button.primary.hover.border.color")};
    color: ${n("button.primary.hover.color")};
}

.p-button:not(:disabled):active {
    background: ${n("button.primary.active.background")};
    border: 1px solid ${n("button.primary.active.border.color")};
    color: ${n("button.primary.active.color")};
}

.p-button:focus-visible {
    box-shadow: ${n("button.primary.focus.ring.shadow")};
    outline: ${n("button.focus.ring.width")} ${n("button.focus.ring.style")} ${n("button.primary.focus.ring.color")};
    outline-offset: ${n("button.focus.ring.offset")};
}

.p-button .p-badge {
    min-width: ${n("button.badge.size")};
    height: ${n("button.badge.size")};
    line-height: ${n("button.badge.size")};
}

.p-button-raised {
    box-shadow: ${n("button.raised.shadow")};
}

.p-button-rounded {
    border-radius: ${n("button.rounded.border.radius")};
}

.p-button-secondary {
    background: ${n("button.secondary.background")};
    border: 1px solid ${n("button.secondary.border.color")};
    color: ${n("button.secondary.color")};
}

.p-button-secondary:not(:disabled):hover {
    background: ${n("button.secondary.hover.background")};
    border: 1px solid ${n("button.secondary.hover.border.color")};
    color: ${n("button.secondary.hover.color")};
}

.p-button-secondary:not(:disabled):active {
    background: ${n("button.secondary.active.background")};
    border: 1px solid ${n("button.secondary.active.border.color")};
    color: ${n("button.secondary.active.color")};
}

.p-button-secondary:focus-visible {
    outline-color: ${n("button.secondary.focus.ring.color")};
    box-shadow: ${n("button.secondary.focus.ring.shadow")};
}

.p-button-success {
    background: ${n("button.success.background")};
    border: 1px solid ${n("button.success.border.color")};
    color: ${n("button.success.color")};
}

.p-button-success:not(:disabled):hover {
    background: ${n("button.success.hover.background")};
    border: 1px solid ${n("button.success.hover.border.color")};
    color: ${n("button.success.hover.color")};
}

.p-button-success:not(:disabled):active {
    background: ${n("button.success.active.background")};
    border: 1px solid ${n("button.success.active.border.color")};
    color: ${n("button.success.active.color")};
}

.p-button-success:focus-visible {
    outline-color: ${n("button.success.focus.ring.color")};
    box-shadow: ${n("button.success.focus.ring.shadow")};
}

.p-button-info {
    background: ${n("button.info.background")};
    border: 1px solid ${n("button.info.border.color")};
    color: ${n("button.info.color")};
}

.p-button-info:not(:disabled):hover {
    background: ${n("button.info.hover.background")};
    border: 1px solid ${n("button.info.hover.border.color")};
    color: ${n("button.info.hover.color")};
}

.p-button-info:not(:disabled):active {
    background: ${n("button.info.active.background")};
    border: 1px solid ${n("button.info.active.border.color")};
    color: ${n("button.info.active.color")};
}

.p-button-info:focus-visible {
    outline-color: ${n("button.info.focus.ring.color")};
    box-shadow: ${n("button.info.focus.ring.shadow")};
}

.p-button-warn {
    background: ${n("button.warn.background")};
    border: 1px solid ${n("button.warn.border.color")};
    color: ${n("button.warn.color")};
}

.p-button-warn:not(:disabled):hover {
    background: ${n("button.warn.hover.background")};
    border: 1px solid ${n("button.warn.hover.border.color")};
    color: ${n("button.warn.hover.color")};
}

.p-button-warn:not(:disabled):active {
    background: ${n("button.warn.active.background")};
    border: 1px solid ${n("button.warn.active.border.color")};
    color: ${n("button.warn.active.color")};
}

.p-button-warn:focus-visible {
    outline-color: ${n("button.warn.focus.ring.color")};
    box-shadow: ${n("button.warn.focus.ring.shadow")};
}

.p-button-help {
    background: ${n("button.help.background")};
    border: 1px solid ${n("button.help.border.color")};
    color: ${n("button.help.color")};
}

.p-button-help:not(:disabled):hover {
    background: ${n("button.help.hover.background")};
    border: 1px solid ${n("button.help.hover.border.color")};
    color: ${n("button.help.hover.color")};
}

.p-button-help:not(:disabled):active {
    background: ${n("button.help.active.background")};
    border: 1px solid ${n("button.help.active.border.color")};
    color: ${n("button.help.active.color")};
}

.p-button-help:focus-visible {
    outline-color: ${n("button.help.focus.ring.color")};
    box-shadow: ${n("button.help.focus.ring.shadow")};
}

.p-button-danger {
    background: ${n("button.danger.background")};
    border: 1px solid ${n("button.danger.border.color")};
    color: ${n("button.danger.color")};
}

.p-button-danger:not(:disabled):hover {
    background: ${n("button.danger.hover.background")};
    border: 1px solid ${n("button.danger.hover.border.color")};
    color: ${n("button.danger.hover.color")};
}

.p-button-danger:not(:disabled):active {
    background: ${n("button.danger.active.background")};
    border: 1px solid ${n("button.danger.active.border.color")};
    color: ${n("button.danger.active.color")};
}

.p-button-danger:focus-visible {
    outline-color: ${n("button.danger.focus.ring.color")};
    box-shadow: ${n("button.danger.focus.ring.shadow")};
}

.p-button-contrast {
    background: ${n("button.contrast.background")};
    border: 1px solid ${n("button.contrast.border.color")};
    color: ${n("button.contrast.color")};
}

.p-button-contrast:not(:disabled):hover {
    background: ${n("button.contrast.hover.background")};
    border: 1px solid ${n("button.contrast.hover.border.color")};
    color: ${n("button.contrast.hover.color")};
}

.p-button-contrast:not(:disabled):active {
    background: ${n("button.contrast.active.background")};
    border: 1px solid ${n("button.contrast.active.border.color")};
    color: ${n("button.contrast.active.color")};
}

.p-button-contrast:focus-visible {
    outline-color: ${n("button.contrast.focus.ring.color")};
    box-shadow: ${n("button.contrast.focus.ring.shadow")};
}

.p-button-outlined {
    background: transparent;
    border-color: ${n("button.outlined.primary.border.color")};
    color: ${n("button.outlined.primary.color")};
}

.p-button-outlined:not(:disabled):hover {
    background: ${n("button.outlined.primary.hover.background")};
    border-color: ${n("button.outlined.primary.border.color")};
    color: ${n("button.outlined.primary.color")};
}

.p-button-outlined:not(:disabled):active {
    background: ${n("button.outlined.primary.active.background")};
    border-color: ${n("button.outlined.primary.border.color")};
    color: ${n("button.outlined.primary.color")};
}

.p-button-outlined.p-button-secondary {
    border-color: ${n("button.outlined.secondary.border.color")};
    color: ${n("button.outlined.secondary.color")};
}

.p-button-outlined.p-button-secondary:not(:disabled):hover {
    background: ${n("button.outlined.secondary.hover.background")};
    border-color: ${n("button.outlined.secondary.border.color")};
    color: ${n("button.outlined.secondary.color")};
}

.p-button-outlined.p-button-secondary:not(:disabled):active {
    background: ${n("button.outlined.secondary.active.background")};
    border-color: ${n("button.outlined.secondary.border.color")};
    color: ${n("button.outlined.secondary.color")};
}

.p-button-outlined.p-button-success {
    border-color: ${n("button.outlined.success.border.color")};
    color: ${n("button.outlined.success.color")};
}

.p-button-outlined.p-button-success:not(:disabled):hover {
    background: ${n("button.outlined.success.hover.background")};
    border-color: ${n("button.outlined.success.border.color")};
    color: ${n("button.outlined.success.color")};
}

.p-button-outlined.p-button-success:not(:disabled):active {
    background: ${n("button.outlined.success.active.background")};
    border-color: ${n("button.outlined.success.border.color")};
    color: ${n("button.outlined.success.color")};
}

.p-button-outlined.p-button-info {
    border-color: ${n("button.outlined.info.border.color")};
    color: ${n("button.outlined.info.color")};
}

.p-button-outlined.p-button-info:not(:disabled):hover {
    background: ${n("button.outlined.info.hover.background")};
    border-color: ${n("button.outlined.info.border.color")};
    color: ${n("button.outlined.info.color")};
}

.p-button-outlined.p-button-info:not(:disabled):active {
    background: ${n("button.outlined.info.active.background")};
    border-color: ${n("button.outlined.info.border.color")};
    color: ${n("button.outlined.info.color")};
}

.p-button-outlined.p-button-warn {
    border-color: ${n("button.outlined.warn.border.color")};
    color: ${n("button.outlined.warn.color")};
}

.p-button-outlined.p-button-warn:not(:disabled):hover {
    background: ${n("button.outlined.warn.hover.background")};
    border-color: ${n("button.outlined.warn.border.color")};
    color: ${n("button.outlined.warn.color")};
}

.p-button-outlined.p-button-warn:not(:disabled):active {
    background: ${n("button.outlined.warn.active.background")};
    border-color: ${n("button.outlined.warn.border.color")};
    color: ${n("button.outlined.warn.color")};
}

.p-button-outlined.p-button-help {
    border-color: ${n("button.outlined.help.border.color")};
    color: ${n("button.outlined.help.color")};
}

.p-button-outlined.p-button-help:not(:disabled):hover {
    background: ${n("button.outlined.help.hover.background")};
    border-color: ${n("button.outlined.help.border.color")};
    color: ${n("button.outlined.help.color")};
}

.p-button-outlined.p-button-help:not(:disabled):active {
    background: ${n("button.outlined.help.active.background")};
    border-color: ${n("button.outlined.help.border.color")};
    color: ${n("button.outlined.help.color")};
}

.p-button-outlined.p-button-danger {
    border-color: ${n("button.outlined.danger.border.color")};
    color: ${n("button.outlined.danger.color")};
}

.p-button-outlined.p-button-danger:not(:disabled):hover {
    background: ${n("button.outlined.danger.hover.background")};
    border-color: ${n("button.outlined.danger.border.color")};
    color: ${n("button.outlined.danger.color")};
}

.p-button-outlined.p-button-danger:not(:disabled):active {
    background: ${n("button.outlined.danger.active.background")};
    border-color: ${n("button.outlined.danger.border.color")};
    color: ${n("button.outlined.danger.color")};
}

.p-button-outlined.p-button-contrast {
    border-color: ${n("button.outlined.contrast.border.color")};
    color: ${n("button.outlined.contrast.color")};
}

.p-button-outlined.p-button-contrast:not(:disabled):hover {
    background: ${n("button.outlined.contrast.hover.background")};
    border-color: ${n("button.outlined.contrast.border.color")};
    color: ${n("button.outlined.contrast.color")};
}

.p-button-outlined.p-button-contrast:not(:disabled):active {
    background: ${n("button.outlined.contrast.active.background")};
    border-color: ${n("button.outlined.contrast.border.color")};
    color: ${n("button.outlined.contrast.color")};
}

.p-button-outlined.p-button-plain {
    border-color: ${n("button.outlined.plain.border.color")};
    color: ${n("button.outlined.plain.color")};
}

.p-button-outlined.p-button-plain:not(:disabled):hover {
    background: ${n("button.outlined.plain.hover.background")};
    border-color: ${n("button.outlined.plain.border.color")};
    color: ${n("button.outlined.plain.color")};
}

.p-button-outlined.p-button-plain:not(:disabled):active {
    background: ${n("button.outlined.plain.active.background")};
    border-color: ${n("button.outlined.plain.border.color")};
    color: ${n("button.outlined.plain.color")};
}

.p-button-text {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.primary.color")};
}

.p-button-text:not(:disabled):hover {
    background: ${n("button.text.primary.hover.background")};
    border-color: transparent;
    color: ${n("button.text.primary.color")};
}

.p-button-text:not(:disabled):active {
    background: ${n("button.text.primary.active.background")};
    border-color: transparent;
    color: ${n("button.text.primary.color")};
}

.p-button-text.p-button-secondary {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.secondary.color")};
}

.p-button-text.p-button-secondary:not(:disabled):hover {
    background: ${n("button.text.secondary.hover.background")};
    border-color: transparent;
    color: ${n("button.text.secondary.color")};
}

.p-button-text.p-button-secondary:not(:disabled):active {
    background: ${n("button.text.secondary.active.background")};
    border-color: transparent;
    color: ${n("button.text.secondary.color")};
}

.p-button-text.p-button-success {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.success.color")};
}

.p-button-text.p-button-success:not(:disabled):hover {
    background: ${n("button.text.success.hover.background")};
    border-color: transparent;
    color: ${n("button.text.success.color")};
}

.p-button-text.p-button-success:not(:disabled):active {
    background: ${n("button.text.success.active.background")};
    border-color: transparent;
    color: ${n("button.text.success.color")};
}

.p-button-text.p-button-info {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.info.color")};
}

.p-button-text.p-button-info:not(:disabled):hover {
    background: ${n("button.text.info.hover.background")};
    border-color: transparent;
    color: ${n("button.text.info.color")};
}

.p-button-text.p-button-info:not(:disabled):active {
    background: ${n("button.text.info.active.background")};
    border-color: transparent;
    color: ${n("button.text.info.color")};
}

.p-button-text.p-button-warn {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.warn.color")};
}

.p-button-text.p-button-warn:not(:disabled):hover {
    background: ${n("button.text.warn.hover.background")};
    border-color: transparent;
    color: ${n("button.text.warn.color")};
}

.p-button-text.p-button-warn:not(:disabled):active {
    background: ${n("button.text.warn.active.background")};
    border-color: transparent;
    color: ${n("button.text.warn.color")};
}

.p-button-text.p-button-help {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.help.color")};
}

.p-button-text.p-button-help:not(:disabled):hover {
    background: ${n("button.text.help.hover.background")};
    border-color: transparent;
    color: ${n("button.text.help.color")};
}

.p-button-text.p-button-help:not(:disabled):active {
    background: ${n("button.text.help.active.background")};
    border-color: transparent;
    color: ${n("button.text.help.color")};
}

.p-button-text.p-button-danger {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.danger.color")};
}

.p-button-text.p-button-danger:not(:disabled):hover {
    background: ${n("button.text.danger.hover.background")};
    border-color: transparent;
    color: ${n("button.text.danger.color")};
}

.p-button-text.p-button-danger:not(:disabled):active {
    background: ${n("button.text.danger.active.background")};
    border-color: transparent;
    color: ${n("button.text.danger.color")};
}

.p-button-text.p-button-plain {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.plain.color")};
}

.p-button-text.p-button-plain:not(:disabled):hover {
    background: ${n("button.text.plain.hover.background")};
    border-color: transparent;
    color: ${n("button.text.plain.color")};
}

.p-button-text.p-button-plain:not(:disabled):active {
    background: ${n("button.text.plain.active.background")};
    border-color: transparent;
    color: ${n("button.text.plain.color")};
}

.p-button-text.p-button-contrast {
    background: transparent;
    border-color: transparent;
    color: ${n("button.text.contrast.color")};
}

.p-button-text.p-button-contrast:not(:disabled):hover {
    background: ${n("button.text.contrast.hover.background")};
    border-color: transparent;
    color: ${n("button.text.contrast.color")};
}

.p-button-text.p-button-contrast:not(:disabled):active {
    background: ${n("button.text.contrast.active.background")};
    border-color: transparent;
    color: ${n("button.text.contrast.color")};
}

.p-button-link {
    background: transparent;
    border-color: transparent;
    color: ${n("button.link.color")};
}

.p-button-link:not(:disabled):hover {
    background: transparent;
    border-color: transparent;
    color: ${n("button.link.hover.color")};
}

.p-button-link:not(:disabled):hover .p-button-label {
    text-decoration: underline;
}

.p-button-link:not(:disabled):active {
    background: transparent;
    border-color: transparent;
    color: ${n("button.link.active.color")};
}

/* For PrimeNG */
.p-button-icon-right {
    order: 1;
}

p-button[iconpos='right'] spinnericon {
    order: 1;
}
`,sb={root:({instance:n,props:e})=>["p-button p-component",{"p-button-icon-only":n.hasIcon&&!e.label&&!e.badge,"p-button-vertical":(e.iconPos==="top"||e.iconPos==="bottom")&&e.label,"p-button-loading":e.loading,"p-button-link":e.link,[`p-button-${e.severity}`]:e.severity,"p-button-raised":e.raised,"p-button-rounded":e.rounded,"p-button-text":e.text,"p-button-outlined":e.outlined,"p-button-sm":e.size==="small","p-button-lg":e.size==="large","p-button-plain":e.plain,"p-button-fluid":e.fluid}],loadingIcon:"p-button-loading-icon",icon:({props:n})=>["p-button-icon",{[`p-button-icon-${n.iconPos}`]:n.label}],label:"p-button-label"},af=(()=>{class n extends Zi{name="button";theme=ob;classes=sb;static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275prov=Oe({token:n,factory:n.\u0275fac})}return n})();var ab=["content"],lb=["loading"],cb=["icon"],ub=["*"],cf=n=>({class:n});function hb(n,e){n&1&&Lt(0)}function db(n,e){if(n&1&&Q(0,"span",8),n&2){let t=G(3);V("ngClass",t.iconClass()),Z("aria-hidden",!0)("data-pc-section","loadingicon")}}function pb(n,e){if(n&1&&Q(0,"SpinnerIcon",9),n&2){let t=G(3);V("styleClass",t.spinnerIconClass())("spin",!0),Z("aria-hidden",!0)("data-pc-section","loadingicon")}}function mb(n,e){if(n&1&&(bt(0),X(1,db,1,3,"span",6)(2,pb,1,4,"SpinnerIcon",7),vt()),n&2){let t=G(2);R(),V("ngIf",t.loadingIcon),R(),V("ngIf",!t.loadingIcon)}}function fb(n,e){}function gb(n,e){if(n&1&&X(0,fb,0,0,"ng-template",10),n&2){let t=G(2);V("ngIf",t.loadingIconTemplate||t._loadingIconTemplate)}}function _b(n,e){if(n&1&&(bt(0),X(1,mb,3,2,"ng-container",2)(2,gb,1,1,null,5),vt()),n&2){let t=G();R(),V("ngIf",!t.loadingIconTemplate&&!t._loadingIconTemplate),R(),V("ngTemplateOutlet",t.loadingIconTemplate||t._loadingIconTemplate)("ngTemplateOutletContext",wt(3,cf,t.iconClass()))}}function yb(n,e){if(n&1&&Q(0,"span",8),n&2){let t=G(2);Ie(t.icon),V("ngClass",t.iconClass()),Z("data-pc-section","icon")}}function bb(n,e){}function vb(n,e){if(n&1&&X(0,bb,0,0,"ng-template",10),n&2){let t=G(2);V("ngIf",!t.icon&&(t.iconTemplate||t._iconTemplate))}}function wb(n,e){if(n&1&&(bt(0),X(1,yb,1,4,"span",11)(2,vb,1,1,null,5),vt()),n&2){let t=G();R(),V("ngIf",t.icon&&!t.iconTemplate&&!t._iconTemplate),R(),V("ngTemplateOutlet",t.iconTemplate||t._iconTemplate)("ngTemplateOutletContext",wt(3,cf,t.iconClass()))}}function Tb(n,e){if(n&1&&(F(0,"span",12),me(1),$()),n&2){let t=G();Z("aria-hidden",t.icon&&!t.label)("data-pc-section","label"),R(),fn(t.label)}}function Ib(n,e){if(n&1&&Q(0,"p-badge",13),n&2){let t=G();V("value",t.badge)("severity",t.badgeSeverity)}}var xo=(()=>{class n extends _n{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;variant;style;styleClass;badgeClass;badgeSeverity="secondary";ariaLabel;autofocus;fluid;onClick=new Je;onFocus=new Je;onBlur=new Je;contentTemplate;loadingIconTemplate;iconTemplate;_buttonProps;get buttonProps(){return this._buttonProps}set buttonProps(t){this._buttonProps=t,t&&typeof t=="object"&&Object.entries(t).forEach(([i,r])=>this[`_${i}`]!==r&&(this[`_${i}`]=r))}get hasFluid(){let i=this.el.nativeElement.closest("p-fluid");return Zs(this.fluid)?!!i:this.fluid}_componentStyle=je(af);templates;_contentTemplate;_iconTemplate;_loadingIconTemplate;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;case"icon":this.iconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}ngOnChanges(t){super.ngOnChanges(t);let{buttonProps:i}=t;if(i){let r=i.currentValue;for(let o in r)this[o]=r[o]}}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,t])=>!!t).reduce((t,[i])=>t+` ${i}`,"p-button-loading-icon")}iconClass(){return{[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]:this.loading,"p-button-icon":!0,"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label}}get buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate||this._loadingIconTemplate)&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&this.iconPos==="left","p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text||this.variant=="text","p-button-outlined":this.outlined||this.variant=="outlined","p-button-sm":this.size==="small","p-button-lg":this.size==="large","p-button-plain":this.plain,"p-button-fluid":this.hasFluid,[`${this.styleClass}`]:this.styleClass}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["p-button"]],contentQueries:function(i,r,o){if(i&1&&(He(o,ab,5),He(o,lb,5),He(o,cb,5),He(o,mi,4)),i&2){let s;be(s=ve())&&(r.contentTemplate=s.first),be(s=ve())&&(r.loadingIconTemplate=s.first),be(s=ve())&&(r.iconTemplate=s.first),be(s=ve())&&(r.templates=s)}},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[2,"disabled","disabled",he],loading:[2,"loading","loading",he],loadingIcon:"loadingIcon",raised:[2,"raised","raised",he],rounded:[2,"rounded","rounded",he],text:[2,"text","text",he],plain:[2,"plain","plain",he],severity:"severity",outlined:[2,"outlined","outlined",he],link:[2,"link","link",he],tabindex:[2,"tabindex","tabindex",$t],size:"size",variant:"variant",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",badgeSeverity:"badgeSeverity",ariaLabel:"ariaLabel",autofocus:[2,"autofocus","autofocus",he],fluid:[2,"fluid","fluid",he],buttonProps:"buttonProps"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},features:[Xt([af]),Jt,xe,zs],ngContentSelectors:ub,decls:7,vars:14,consts:[["pRipple","",3,"click","focus","blur","ngStyle","disabled","ngClass","pAutoFocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"value","severity",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[3,"ngIf"],[3,"class","ngClass",4,"ngIf"],[1,"p-button-label"],[3,"value","severity"]],template:function(i,r){i&1&&(qs(),F(0,"button",0),Ae("click",function(s){return r.onClick.emit(s)})("focus",function(s){return r.onFocus.emit(s)})("blur",function(s){return r.onBlur.emit(s)}),fo(1),X(2,hb,1,0,"ng-container",1)(3,_b,3,5,"ng-container",2)(4,wb,3,5,"ng-container",2)(5,Tb,2,3,"span",3)(6,Ib,1,2,"p-badge",4),$()),i&2&&(V("ngStyle",r.style)("disabled",r.disabled||r.loading)("ngClass",r.buttonClass)("pAutoFocus",r.autofocus),Z("type",r.type)("aria-label",r.ariaLabel)("data-pc-name","button")("data-pc-section","root")("tabindex",r.tabindex),R(2),V("ngTemplateOutlet",r.contentTemplate||r._contentTemplate),R(),V("ngIf",r.loading),R(),V("ngIf",!r.loading),R(),V("ngIf",!r.contentTemplate&&!r._contentTemplate&&r.label),R(),V("ngIf",!r.contentTemplate&&!r._contentTemplate&&r.badge))},dependencies:[lt,zt,Wi,Ji,Yt,Um,Hm,rf,Km,jm,ct],encapsulation:2,changeDetection:0})}return n})(),uf=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ze({type:n});static \u0275inj=$e({imports:[lt,xo,ct,ct]})}return n})();var Eb=({dt:n})=>`
.p-toast {
    width: ${n("toast.width")};
    white-space: pre-line;
    word-break: break-word;
}

.p-toast-message {
    margin: 0 0 1rem 0;
}

.p-toast-message-icon {
    flex-shrink: 0;
    font-size: ${n("toast.icon.size")};
    width: ${n("toast.icon.size")};
    height: ${n("toast.icon.size")};
}

.p-toast-message-content {
    display: flex;
    align-items: flex-start;
    padding: ${n("toast.content.padding")};
    gap: ${n("toast.content.gap")};
}

.p-toast-message-text {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    gap: ${n("toast.text.gap")};
}

.p-toast-summary {
    font-weight: ${n("toast.summary.font.weight")};
    font-size: ${n("toast.summary.font.size")};
}

.p-toast-detail {
    font-weight: ${n("toast.detail.font.weight")};
    font-size: ${n("toast.detail.font.size")};
}

.p-toast-close-button {
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    cursor: pointer;
    background: transparent;
    transition: background ${n("toast.transition.duration")}, color ${n("toast.transition.duration")}, outline-color ${n("toast.transition.duration")}, box-shadow ${n("toast.transition.duration")};
    outline-color: transparent;
    color: inherit;
    width: ${n("toast.close.button.width")};
    height: ${n("toast.close.button.height")};
    border-radius: ${n("toast.close.button.border.radius")};
    margin: -25% 0 0 0;
    right: -25%;
    padding: 0;
    border: none;
    user-select: none;
}

.p-toast-close-button:dir(rtl) {
    margin: -25% 0 0 auto;
    left: -25%;
    right: auto;
}

.p-toast-message-info,
.p-toast-message-success,
.p-toast-message-warn,
.p-toast-message-error,
.p-toast-message-secondary,
.p-toast-message-contrast {
    border-width: ${n("toast.border.width")};
    border-style: solid;
    backdrop-filter: blur(${n("toast.blur")});
    border-radius: ${n("toast.border.radius")};
}

.p-toast-close-icon {
    font-size: ${n("toast.close.icon.size")};
    width: ${n("toast.close.icon.size")};
    height: ${n("toast.close.icon.size")};
}

.p-toast-close-button:focus-visible {
    outline-width: ${n("focus.ring.width")};
    outline-style: ${n("focus.ring.style")};
    outline-offset: ${n("focus.ring.offset")};
}

.p-toast-message-info {
    background: ${n("toast.info.background")};
    border-color: ${n("toast.info.border.color")};
    color: ${n("toast.info.color")};
    box-shadow: ${n("toast.info.shadow")};
}

.p-toast-message-info .p-toast-detail {
    color: ${n("toast.info.detail.color")};
}

.p-toast-message-info .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.info.close.button.focus.ring.color")};
    box-shadow: ${n("toast.info.close.button.focus.ring.shadow")};
}

.p-toast-message-info .p-toast-close-button:hover {
    background: ${n("toast.info.close.button.hover.background")};
}

.p-toast-message-success {
    background: ${n("toast.success.background")};
    border-color: ${n("toast.success.border.color")};
    color: ${n("toast.success.color")};
    box-shadow: ${n("toast.success.shadow")};
}

.p-toast-message-success .p-toast-detail {
    color: ${n("toast.success.detail.color")};
}

.p-toast-message-success .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.success.close.button.focus.ring.color")};
    box-shadow: ${n("toast.success.close.button.focus.ring.shadow")};
}

.p-toast-message-success .p-toast-close-button:hover {
    background: ${n("toast.success.close.button.hover.background")};
}

.p-toast-message-warn {
    background: ${n("toast.warn.background")};
    border-color: ${n("toast.warn.border.color")};
    color: ${n("toast.warn.color")};
    box-shadow: ${n("toast.warn.shadow")};
}

.p-toast-message-warn .p-toast-detail {
    color: ${n("toast.warn.detail.color")};
}

.p-toast-message-warn .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.warn.close.button.focus.ring.color")};
    box-shadow: ${n("toast.warn.close.button.focus.ring.shadow")};
}

.p-toast-message-warn .p-toast-close-button:hover {
    background: ${n("toast.warn.close.button.hover.background")};
}

.p-toast-message-error {
    background: ${n("toast.error.background")};
    border-color: ${n("toast.error.border.color")};
    color: ${n("toast.error.color")};
    box-shadow: ${n("toast.error.shadow")};
}

.p-toast-message-error .p-toast-detail {
    color: ${n("toast.error.detail.color")};
}

.p-toast-message-error .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.error.close.button.focus.ring.color")};
    box-shadow: ${n("toast.error.close.button.focus.ring.shadow")};
}

.p-toast-message-error .p-toast-close-button:hover {
    background: ${n("toast.error.close.button.hover.background")};
}

.p-toast-message-secondary {
    background: ${n("toast.secondary.background")};
    border-color: ${n("toast.secondary.border.color")};
    color: ${n("toast.secondary.color")};
    box-shadow: ${n("toast.secondary.shadow")};
}

.p-toast-message-secondary .p-toast-detail {
    color: ${n("toast.secondary.detail.color")};
}

.p-toast-message-secondary .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.secondary.close.button.focus.ring.color")};
    box-shadow: ${n("toast.secondary.close.button.focus.ring.shadow")};
}

.p-toast-message-secondary .p-toast-close-button:hover {
    background: ${n("toast.secondary.close.button.hover.background")};
}

.p-toast-message-contrast {
    background: ${n("toast.contrast.background")};
    border-color: ${n("toast.contrast.border.color")};
    color: ${n("toast.contrast.color")};
    box-shadow: ${n("toast.contrast.shadow")};
}

.p-toast-message-contrast .p-toast-detail {
    color: ${n("toast.contrast.detail.color")};
}

.p-toast-message-contrast .p-toast-close-button:focus-visible {
    outline-color: ${n("toast.contrast.close.button.focus.ring.color")};
    box-shadow: ${n("toast.contrast.close.button.focus.ring.shadow")};
}

.p-toast-message-contrast .p-toast-close-button:hover {
    background: ${n("toast.contrast.close.button.hover.background")};
}

.p-toast-top-center {
    transform: translateX(-50%);
}

.p-toast-bottom-center {
    transform: translateX(-50%);
}

.p-toast-center {
    min-width: 20vw;
    transform: translate(-50%, -50%);
}

.p-toast-message-enter-from {
    opacity: 0;
    transform: translateY(50%);
}

.p-toast-message-leave-from {
    max-height: 1000px;
}

.p-toast .p-toast-message.p-toast-message-leave-to {
    max-height: 0;
    opacity: 0;
    margin-bottom: 0;
    overflow: hidden;
}

.p-toast-message-enter-active {
    transition: transform 0.3s, opacity 0.3s;
}

.p-toast-message-leave-active {
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1), opacity 0.3s, margin-bottom 0.3s;
}
`,Cb={root:({instance:n})=>{let{_position:e}=n;return{position:"fixed",top:e==="top-right"||e==="top-left"||e==="top-center"?"20px":e==="center"?"50%":null,right:(e==="top-right"||e==="bottom-right")&&"20px",bottom:(e==="bottom-left"||e==="bottom-right"||e==="bottom-center")&&"20px",left:e==="top-left"||e==="bottom-left"?"20px":e==="center"||e==="top-center"||e==="bottom-center"?"50%":null}}},xb={root:({instance:n})=>({"p-toast p-component":!0,[`p-toast-${n._position}`]:!!n._position}),message:({instance:n})=>({"p-toast-message":!0,"p-toast-message-info":n.message.severity==="info"||n.message.severity===void 0,"p-toast-message-warn":n.message.severity==="warn","p-toast-message-error":n.message.severity==="error","p-toast-message-success":n.message.severity==="success","p-toast-message-secondary":n.message.severity==="secondary","p-toast-message-contrast":n.message.severity==="contrast"}),messageContent:"p-toast-message-content",messageIcon:({instance:n})=>({"p-toast-message-icon":!0,[`pi ${n.message.icon}`]:!!n.message.icon}),messageText:"p-toast-message-text",summary:"p-toast-summary",detail:"p-toast-detail",closeButton:"p-toast-close-button",closeIcon:({instance:n})=>({"p-toast-close-icon":!0,[`pi ${n.message.closeIcon}`]:!!n.message.closeIcon})},pa=(()=>{class n extends Zi{name="toast";theme=Eb;classes=xb;inlineStyles=Cb;static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275prov=Oe({token:n,factory:n.\u0275fac})}return n})();var hf=["container"],Ab=(n,e,t,i)=>({showTransformParams:n,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:i}),Sb=n=>({value:"visible",params:n}),Pb=(n,e)=>({$implicit:n,closeFn:e}),kb=n=>({$implicit:n});function Db(n,e){n&1&&Lt(0)}function Rb(n,e){if(n&1&&X(0,Db,1,0,"ng-container",3),n&2){let t=G();V("ngTemplateOutlet",t.headlessTemplate)("ngTemplateOutletContext",hi(2,Pb,t.message,t.onCloseIconClick))}}function Vb(n,e){if(n&1&&Q(0,"span",4),n&2){let t=G(3);V("ngClass",t.cx("messageIcon"))}}function Ob(n,e){n&1&&Q(0,"CheckIcon"),n&2&&Z("aria-hidden",!0)("data-pc-section","icon")}function Mb(n,e){n&1&&Q(0,"InfoCircleIcon"),n&2&&Z("aria-hidden",!0)("data-pc-section","icon")}function Nb(n,e){n&1&&Q(0,"TimesCircleIcon"),n&2&&Z("aria-hidden",!0)("data-pc-section","icon")}function Fb(n,e){n&1&&Q(0,"ExclamationTriangleIcon"),n&2&&Z("aria-hidden",!0)("data-pc-section","icon")}function Lb(n,e){n&1&&Q(0,"InfoCircleIcon"),n&2&&Z("aria-hidden",!0)("data-pc-section","icon")}function $b(n,e){if(n&1&&(F(0,"span",4),X(1,Ob,1,2,"CheckIcon")(2,Mb,1,2,"InfoCircleIcon")(3,Nb,1,2,"TimesCircleIcon")(4,Fb,1,2,"ExclamationTriangleIcon")(5,Lb,1,2,"InfoCircleIcon"),$()),n&2){let t,i=G(3);V("ngClass",i.cx("messageIcon")),Z("aria-hidden",!0)("data-pc-section","icon"),R(),Dt((t=i.message.severity)==="success"?1:t==="info"?2:t==="error"?3:t==="warn"?4:5)}}function zb(n,e){if(n&1&&(bt(0),X(1,Vb,1,1,"span",7)(2,$b,6,4,"span",7),F(3,"div",4)(4,"div",4),me(5),$(),F(6,"div",4),me(7),$()(),vt()),n&2){let t=G(2);R(),V("ngIf",t.message.icon),R(),V("ngIf",!t.message.icon),R(),V("ngClass",t.cx("messageText")),Z("data-pc-section","text"),R(),V("ngClass",t.cx("summary")),Z("data-pc-section","summary"),R(),St(" ",t.message.summary," "),R(),V("ngClass",t.cx("detail")),Z("data-pc-section","detail"),R(),fn(t.message.detail)}}function Bb(n,e){n&1&&Lt(0)}function qb(n,e){if(n&1&&Q(0,"span",4),n&2){let t=G(4);V("ngClass",t.cx("closeIcon"))}}function Ub(n,e){if(n&1&&X(0,qb,1,1,"span",7),n&2){let t=G(3);V("ngIf",t.message.closeIcon)}}function Gb(n,e){if(n&1&&Q(0,"TimesIcon",4),n&2){let t=G(3);V("ngClass",t.cx("closeIcon")),Z("aria-hidden",!0)("data-pc-section","closeicon")}}function jb(n,e){if(n&1){let t=Ke();F(0,"p-button",8),Ae("onClick",function(r){ae(t);let o=G(2);return le(o.onCloseIconClick(r))})("keydown.enter",function(r){ae(t);let o=G(2);return le(o.onCloseIconClick(r))}),X(1,Ub,1,1,"span",4)(2,Gb,1,3,"TimesIcon",4),$()}if(n&2){let t=G(2);V("styleClass",t.cx("closeButton")),Z("ariaLabel",t.closeAriaLabel)("data-pc-section","closebutton"),R(),Dt(t.message.closeIcon?1:2)}}function Kb(n,e){if(n&1&&(F(0,"div",4),X(1,zb,8,10,"ng-container",5)(2,Bb,1,0,"ng-container",3)(3,jb,3,4,"p-button",6),$()),n&2){let t=G();Ie(t.message==null?null:t.message.contentStyleClass),V("ngClass",t.cx("messageContent")),Z("data-pc-section","content"),R(),V("ngIf",!t.template),R(),V("ngTemplateOutlet",t.template)("ngTemplateOutletContext",wt(8,kb,t.message)),R(),Dt((t.message==null?null:t.message.closable)!==!1?3:-1)}}var Hb=["message"],Qb=["headless"];function Wb(n,e){if(n&1){let t=Ke();F(0,"p-toastItem",3),Ae("onClose",function(r){ae(t);let o=G();return le(o.onMessageClose(r))})("@toastAnimation.start",function(r){ae(t);let o=G();return le(o.onAnimationStart(r))})("@toastAnimation.done",function(r){ae(t);let o=G();return le(o.onAnimationEnd(r))}),$()}if(n&2){let t=e.$implicit,i=e.index,r=G();V("message",t)("index",i)("life",r.life)("template",r.template||r._template)("headlessTemplate",r.headlessTemplate||r._headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}var Jb=(()=>{class n extends _n{zone;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new Je;containerViewChild;_componentStyle=je(pa);timeout;constructor(t){super(),this.zone=t}ngAfterViewInit(){super.ngAfterViewInit(),this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=t=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout(),super.ngOnDestroy()}static \u0275fac=function(i){return new(i||n)(ft(et))};static \u0275cmp=de({type:n,selectors:[["p-toastItem"]],viewQuery:function(i,r){if(i&1&&mn(hf,5),i&2){let o;be(o=ve())&&(r.containerViewChild=o.first)}},inputs:{message:"message",index:[2,"index","index",$t],life:[2,"life","life",$t],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[Xt([pa]),Jt,xe],decls:4,vars:15,consts:[["container",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[3,"ngClass","class"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[4,"ngIf"],["rounded","","text","",3,"styleClass"],[3,"ngClass",4,"ngIf"],["rounded","","text","",3,"onClick","keydown.enter","styleClass"]],template:function(i,r){if(i&1){let o=Ke();F(0,"div",1,0),Ae("mouseenter",function(){return ae(o),le(r.onMouseEnter())})("mouseleave",function(){return ae(o),le(r.onMouseLeave())}),X(2,Rb,1,5,"ng-container")(3,Kb,4,10,"div",2),$()}i&2&&(Ie(r.message==null?null:r.message.styleClass),V("ngClass",r.cx("message"))("@messageState",wt(13,Sb,Tm(8,Ab,r.showTransformOptions,r.hideTransformOptions,r.showTransitionOptions,r.hideTransitionOptions))),Z("id",r.message==null?null:r.message.id)("data-pc-name","toast")("data-pc-section","root"),R(2),Dt(r.headlessTemplate?2:3))},dependencies:[lt,zt,Wi,Ji,la,ca,ua,er,ha,xo,ct],encapsulation:2,data:{animation:[pi("messageState",[go("visible",Zt({transform:"translateY(0)",opacity:1})),gn("void => *",[Zt({transform:"{{showTransformParams}}",opacity:0}),Mn("{{showTransitionParams}}")]),gn("* => void",[Mn("{{hideTransitionParams}}",Zt({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return n})(),zc=(()=>{class n extends _n{key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new Je;template;headlessTemplate;containerViewChild;messageSubscription;clearSubscription;messages;messagesArchieve;_position="top-right";messageService=je(Yi);_componentStyle=je(pa);styleElement;id=tt("pn_id_");templates;ngOnInit(){super.ngOnInit(),this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){let i=t.filter(r=>this.canAdd(r));this.add(i)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}_template;_headlessTemplate;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"message":this._template=t.template;break;case"headless":this._headlessTemplate=t.template;break;default:this._template=t.template;break}})}ngAfterViewInit(){super.ngAfterViewInit(),this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let i=this.key===t.key;return i&&this.preventOpenDuplicates&&(i=!this.containsMessage(this.messages,t)),i&&this.preventDuplicates&&(i=!this.containsMessage(this.messagesArchieve,t)),i}containsMessage(t,i){return t?t.find(r=>r.summary===i.summary&&r.detail==i.detail&&r.severity===i.severity)!=null:!1}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){t.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&fi.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){t.toState==="void"&&this.autoZIndex&&Zs(this.messages)&&fi.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let i in this.breakpoints){let r="";for(let o in this.breakpoints[i])r+=o+":"+this.breakpoints[i][o]+" !important;";t+=`
                    @media screen and (max-width: ${i}) {
                        .p-toast[${this.id}] {
                           ${r}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",t),Ys(this.styleElement,"nonce",this.config?.csp()?.nonce)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&fi.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle(),super.ngOnDestroy()}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["p-toast"]],contentQueries:function(i,r,o){if(i&1&&(He(o,Hb,5),He(o,Qb,5),He(o,mi,4)),i&2){let s;be(s=ve())&&(r.template=s.first),be(s=ve())&&(r.headlessTemplate=s.first),be(s=ve())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&mn(hf,5),i&2){let o;be(o=ve())&&(r.containerViewChild=o.first)}},inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",he],baseZIndex:[2,"baseZIndex","baseZIndex",$t],life:[2,"life","life",$t],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",he],preventDuplicates:[2,"preventDuplicates","preventDuplicates",he],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[Xt([pa]),Jt,xe],decls:3,vars:7,consts:[["container",""],[3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(i,r){i&1&&(F(0,"div",1,0),X(2,Wb,1,10,"p-toastItem",2),$()),i&2&&(mo(r.style),Ie(r.styleClass),V("ngClass",r.cx("root"))("ngStyle",r.sx("root")),R(2),V("ngForOf",r.messages))},dependencies:[lt,zt,Sm,Yt,Jb,ct],encapsulation:2,data:{animation:[pi("toastAnimation",[gn(":enter, :leave",[Rm("@*",Dm())])])]},changeDetection:0})}return n})(),ma=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ze({type:n});static \u0275inj=$e({imports:[zc,ct,ct]})}return n})();var fa=(()=>{class n{constructor(){this.subjectItemUpdate=new Hi}updatePerformedItem(t){this.subjectItemUpdate.next(t)}getUpdatedStageLevel(){return this.subjectItemUpdate.asObservable()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Yb=(n,e)=>({"stage-level-number-unselected":n,"stage-level-number-selected":e});function Zb(n,e){if(n&1){let t=Ke();F(0,"div",4),Ae("click",function(){ae(t);let r=G();return le(r.stageClick())}),F(1,"span",5),me(2),$()()}if(n&2){let t=G();R(2),St(" ",t.stageLevel.value," ")}}function e1(n,e){if(n&1&&(bt(0,2),me(1),vt()),n&2){let t=G();R(),St(" ",t.stageLevel.value," ")}}function t1(n,e){n&1&&(F(0,"span",6),Q(1,"i",7),$())}function n1(n,e){if(n&1&&(F(0,"div",3),Rt(1,t1,2,0,"span",6,ui),$()),n&2){let t=G();R(),Vt(t.stars)}}function i1(n,e){n&1&&(F(0,"span",8),Q(1,"i",7),$())}function r1(n,e){if(n&1){let t=Ke();F(0,"div",4),Ae("click",function(){ae(t);let r=G(2);return le(r.stageClick())}),Rt(1,i1,2,0,"span",8,ui),$()}if(n&2){let t=G(2);R(),Vt(t.stars)}}function o1(n,e){n&1&&(F(0,"span",9),Q(1,"i",10),$())}function s1(n,e){if(n&1&&Rt(0,o1,2,0,"span",9,ui),n&2){let t=G(2);Vt(t.stars)}}function a1(n,e){if(n&1&&(F(0,"div",3),X(1,r1,3,0,"div")(2,s1,2,0),$()),n&2){let t=G();R(),Dt(t.stageLevel.completed?1:2)}}var ga=(()=>{class n{constructor(t){this.stageCommunicationService=t,this.stars=new Array(1,2,3)}stageClick(){this.stageCommunicationService.updatePerformedItem(this.stageLevel),console.log("Stage Clicked")}static{this.\u0275fac=function(i){return new(i||n)(ft(fa))}}static{this.\u0275cmp=de({type:n,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:7,vars:6,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[1,"disable-stage-click"],[2,"display","flex","justify-content","center"],[3,"click"],[1,"stage-level-completed-value","enable-stage-click"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],[1,"stage-level-asterisk-unselected","stage-level-completed","enable-stage-click"],[1,"stage-level-asterisk-unselected","disable-stage-click"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(i,r){i&1&&(F(0,"div",0)(1,"div",1),X(2,Zb,3,1,"div")(3,e1,2,1,"ng-container",2),$(),F(4,"div"),X(5,n1,3,0,"div",3)(6,a1,3,1,"div",3),$()()),i&2&&(R(),V("ngClass",hi(3,Yb,!r.stageLevel.selected,r.stageLevel.selected)),R(),Dt(r.stageLevel.completed?2:3),R(3),Dt(r.stageLevel.selected?5:6))},dependencies:[zt,Xi,Qs],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .enable-stage-click[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.stage-level-layout[_ngcontent-%COMP%]   .disable-stage-click[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]})}}return n})();var l1=(n,e)=>e.index,c1=n=>({"border-bottom":n});function u1(n,e){n&1&&(F(0,"div")(1,"span",2),me(2,"No stage levels defined!"),$()())}function h1(n,e){if(n&1&&(F(0,"div",3),Q(1,"app-stage-level",4),$()),n&2){let t=e.$implicit;V("ngStyle",wt(2,c1,t.selected?"none":"1px solid #d4d4d4")),R(),V("stageLevel",t)}}function d1(n,e){if(n&1&&(F(0,"div",1),Rt(1,h1,2,4,"div",3,l1),$()),n&2){let t=G();R(),Vt(t.stageLevels)}}var _a=(()=>{class n{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1,this.stageLevels=new Array}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=de({type:n,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:3,vars:1,consts:[[1,"game-stage-level-layout"],[1,"stage-levels"],[1,"warning-message"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(i,r){i&1&&(F(0,"div",0),X(1,u1,3,0,"div")(2,d1,3,0,"div",1),$()),i&2&&(R(),Dt(r.NO_STAGE_LEVELS?1:2))},dependencies:[Yt,Xi,Ws,ga],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]})}}return n})();var pf=(()=>{class n extends _n{pFocusTrapDisabled=!1;platformId=je(Wt);document=je(Qi);firstHiddenFocusableElement;lastHiddenFocusableElement;ngOnInit(){super.ngOnInit(),di(this.platformId)&&!this.pFocusTrapDisabled&&!this.firstHiddenFocusableElement&&!this.lastHiddenFocusableElement&&this.createHiddenFocusableElements()}ngOnChanges(t){super.ngOnChanges(t),t.pFocusTrapDisabled&&di(this.platformId)&&(t.pFocusTrapDisabled.currentValue?this.removeHiddenFocusableElements():this.createHiddenFocusableElements())}removeHiddenFocusableElements(){this.firstHiddenFocusableElement&&this.firstHiddenFocusableElement.parentNode&&this.firstHiddenFocusableElement.parentNode.removeChild(this.firstHiddenFocusableElement),this.lastHiddenFocusableElement&&this.lastHiddenFocusableElement.parentNode&&this.lastHiddenFocusableElement.parentNode.removeChild(this.lastHiddenFocusableElement)}getComputedSelector(t){return`:not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])${t??""}`}createHiddenFocusableElements(){let t="0",i=r=>Lm("span",{class:"p-hidden-accessible p-hidden-focusable",tabindex:t,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:r?.bind(this)});this.firstHiddenFocusableElement=i(this.onFirstHiddenElementFocus),this.lastHiddenFocusableElement=i(this.onLastHiddenElementFocus),this.firstHiddenFocusableElement.setAttribute("data-pc-section","firstfocusableelement"),this.lastHiddenFocusableElement.setAttribute("data-pc-section","lastfocusableelement"),this.el.nativeElement.prepend(this.firstHiddenFocusableElement),this.el.nativeElement.append(this.lastHiddenFocusableElement)}onFirstHiddenElementFocus(t){let{currentTarget:i,relatedTarget:r}=t,o=r===this.lastHiddenFocusableElement||!this.el.nativeElement?.contains(r)?$m(i.parentElement,":not(.p-hidden-focusable)"):this.lastHiddenFocusableElement;Nc(o)}onLastHiddenElementFocus(t){let{currentTarget:i,relatedTarget:r}=t,o=r===this.firstHiddenFocusableElement||!this.el.nativeElement?.contains(r)?zm(i.parentElement,":not(.p-hidden-focusable)"):this.firstHiddenFocusableElement;Nc(o)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275dir=Bs({type:n,selectors:[["","pFocusTrap",""]],inputs:{pFocusTrapDisabled:[2,"pFocusTrapDisabled","pFocusTrapDisabled",he]},features:[Jt,xe,zs]})}return n})();var p1=({dt:n})=>`
.p-dialog {
    max-height: 90%;
    transform: scale(1);
    border-radius: ${n("dialog.border.radius")};
    box-shadow: ${n("dialog.shadow")};
    background: ${n("dialog.background")};
    border: 1px solid ${n("dialog.border.color")};
    color: ${n("dialog.color")};
    display: flex;
    flex-direction: column;
    pointer-events: auto
}

.p-dialog-content {
    overflow-y: auto;
    padding: ${n("dialog.content.padding")};
    flex-grow: 1;
}

.p-dialog-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    padding: ${n("dialog.header.padding")};
}

.p-dialog-title {
    font-weight: ${n("dialog.title.font.weight")};
    font-size: ${n("dialog.title.font.size")};
}

.p-dialog-footer {
    flex-shrink: 0;
    padding: ${n("dialog.footer.padding")};
    display: flex;
    justify-content: flex-end;
    gap: ${n("dialog.footer.gap")};
}

.p-dialog-header-actions {
    display: flex;
    align-items: center;
    gap: ${n("dialog.header.gap")};
}

.p-dialog-enter-active {
    transition: all 150ms cubic-bezier(0, 0, 0.2, 1);
}

.p-dialog-leave-active {
    transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
}

.p-dialog-enter-from,
.p-dialog-leave-to {
    opacity: 0;
    transform: scale(0.7);
}

.p-dialog-top .p-dialog,
.p-dialog-bottom .p-dialog,
.p-dialog-left .p-dialog,
.p-dialog-right .p-dialog,
.p-dialog-topleft .p-dialog,
.p-dialog-topright .p-dialog,
.p-dialog-bottomleft .p-dialog,
.p-dialog-bottomright .p-dialog {
    margin: 0.75rem;
    transform: translate3d(0px, 0px, 0px);
}

.p-dialog-top .p-dialog-enter-active,
.p-dialog-top .p-dialog-leave-active,
.p-dialog-bottom .p-dialog-enter-active,
.p-dialog-bottom .p-dialog-leave-active,
.p-dialog-left .p-dialog-enter-active,
.p-dialog-left .p-dialog-leave-active,
.p-dialog-right .p-dialog-enter-active,
.p-dialog-right .p-dialog-leave-active,
.p-dialog-topleft .p-dialog-enter-active,
.p-dialog-topleft .p-dialog-leave-active,
.p-dialog-topright .p-dialog-enter-active,
.p-dialog-topright .p-dialog-leave-active,
.p-dialog-bottomleft .p-dialog-enter-active,
.p-dialog-bottomleft .p-dialog-leave-active,
.p-dialog-bottomright .p-dialog-enter-active,
.p-dialog-bottomright .p-dialog-leave-active {
    transition: all 0.3s ease-out;
}

.p-dialog-top .p-dialog-enter-from,
.p-dialog-top .p-dialog-leave-to {
    transform: translate3d(0px, -100%, 0px);
}

.p-dialog-bottom .p-dialog-enter-from,
.p-dialog-bottom .p-dialog-leave-to {
    transform: translate3d(0px, 100%, 0px);
}

.p-dialog-left .p-dialog-enter-from,
.p-dialog-left .p-dialog-leave-to,
.p-dialog-topleft .p-dialog-enter-from,
.p-dialog-topleft .p-dialog-leave-to,
.p-dialog-bottomleft .p-dialog-enter-from,
.p-dialog-bottomleft .p-dialog-leave-to {
    transform: translate3d(-100%, 0px, 0px);
}

.p-dialog-right .p-dialog-enter-from,
.p-dialog-right .p-dialog-leave-to,
.p-dialog-topright .p-dialog-enter-from,
.p-dialog-topright .p-dialog-leave-to,
.p-dialog-bottomright .p-dialog-enter-from,
.p-dialog-bottomright .p-dialog-leave-to {
    transform: translate3d(100%, 0px, 0px);
}

.p-dialog-left:dir(rtl) .p-dialog-enter-from,
.p-dialog-left:dir(rtl) .p-dialog-leave-to,
.p-dialog-topleft:dir(rtl) .p-dialog-enter-from,
.p-dialog-topleft:dir(rtl) .p-dialog-leave-to,
.p-dialog-bottomleft:dir(rtl) .p-dialog-enter-from,
.p-dialog-bottomleft:dir(rtl) .p-dialog-leave-to {
    transform: translate3d(100%, 0px, 0px);
}

.p-dialog-right:dir(rtl) .p-dialog-enter-from,
.p-dialog-right:dir(rtl) .p-dialog-leave-to,
.p-dialog-topright:dir(rtl) .p-dialog-enter-from,
.p-dialog-topright:dir(rtl) .p-dialog-leave-to,
.p-dialog-bottomright:dir(rtl) .p-dialog-enter-from,
.p-dialog-bottomright:dir(rtl) .p-dialog-leave-to {
    transform: translate3d(-100%, 0px, 0px);
}

.p-dialog-maximized {
    width: 100vw !important;
    height: 100vh !important;
    top: 0px !important;
    left: 0px !important;
    max-height: 100%;
    height: 100%;
    border-radius: 0;
}

.p-dialog-maximized .p-dialog-content {
    flex-grow: 1;
}

.p-overlay-mask:dir(rtl) {
    flex-direction: row-reverse;
}

/* For PrimeNG */

.p-dialog .p-resizable-handle {
    position: absolute;
    font-size: 0.1px;
    display: block;
    cursor: se-resize;
    width: 12px;
    height: 12px;
    right: 1px;
    bottom: 1px;
}

.p-confirm-dialog .p-dialog-content {
    display: flex;
    align-items: center;
}
`,m1={mask:({instance:n})=>({position:"fixed",height:"100%",width:"100%",left:0,top:0,display:"flex",justifyContent:n.position==="left"||n.position==="topleft"||n.position==="bottomleft"?"flex-start":n.position==="right"||n.position==="topright"||n.position==="bottomright"?"flex-end":"center",alignItems:n.position==="top"||n.position==="topleft"||n.position==="topright"?"flex-start":n.position==="bottom"||n.position==="bottomleft"||n.position==="bottomright"?"flex-end":"center",pointerEvents:n.modal?"auto":"none"}),root:{display:"flex",flexDirection:"column",pointerEvents:"auto"}},f1={mask:({instance:n})=>{let t=["left","right","top","topleft","topright","bottom","bottomleft","bottomright"].find(i=>i===n.position);return{"p-dialog-mask":!0,"p-overlay-mask p-overlay-mask-enter":n.modal,[`p-dialog-${t}`]:t}},root:({instance:n})=>({"p-dialog p-component":!0,"p-dialog-maximized":n.maximizable&&n.maximized}),header:"p-dialog-header",title:"p-dialog-title",resizeHandle:"p-resizable-handle",headerActions:"p-dialog-header-actions",pcMaximizeButton:"p-dialog-maximize-button",pcCloseButton:"p-dialog-close-button",content:"p-dialog-content",footer:"p-dialog-footer"},mf=(()=>{class n extends Zi{name="dialog";theme=p1;classes=f1;inlineStyles=m1;static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275prov=Oe({token:n,factory:n.\u0275fac})}return n})();var g1=["header"],ff=["content"],gf=["footer"],_1=["closeicon"],y1=["maximizeicon"],b1=["minimizeicon"],v1=["headless"],w1=["titlebar"],T1=["*",[["p-footer"]]],I1=["*","p-footer"],E1=(n,e,t)=>({position:"fixed",height:"100%",width:"100%",left:0,top:0,display:"flex","justify-content":n,"align-items":e,"pointer-events":t}),C1=n=>({"p-dialog p-component":!0,"p-dialog-maximized":n}),x1=()=>({display:"flex","flex-direction":"column","pointer-events":"auto"}),A1=(n,e)=>({transform:n,transition:e}),S1=n=>({value:"visible",params:n});function P1(n,e){n&1&&Lt(0)}function k1(n,e){if(n&1&&(bt(0),X(1,P1,1,0,"ng-container",11),vt()),n&2){let t=G(3);R(),V("ngTemplateOutlet",t._headlessTemplate||t.headlessTemplate||t.headlessT)}}function D1(n,e){if(n&1){let t=Ke();F(0,"div",19),Ae("mousedown",function(r){ae(t);let o=G(4);return le(o.initResize(r))}),$()}if(n&2){let t=G(4);V("ngClass",t.cx("resizeHandle"))}}function R1(n,e){if(n&1&&(F(0,"span",20),me(1),$()),n&2){let t=G(4);V("id",t.ariaLabelledBy)("ngClass",t.cx("title")),R(),fn(t.header)}}function V1(n,e){n&1&&Lt(0)}function O1(n,e){if(n&1&&Q(0,"span",15),n&2){let t=G(5);V("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function M1(n,e){n&1&&Q(0,"WindowMaximizeIcon")}function N1(n,e){n&1&&Q(0,"WindowMinimizeIcon")}function F1(n,e){if(n&1&&(bt(0),X(1,M1,1,0,"WindowMaximizeIcon",22)(2,N1,1,0,"WindowMinimizeIcon",22),vt()),n&2){let t=G(5);R(),V("ngIf",!t.maximized&&!t._maximizeiconTemplate&&!t.maximizeIconTemplate&&!t.maximizeIconT),R(),V("ngIf",t.maximized&&!t._minimizeiconTemplate&&!t.minimizeIconTemplate&&!t.minimizeIconT)}}function L1(n,e){}function $1(n,e){n&1&&X(0,L1,0,0,"ng-template")}function z1(n,e){if(n&1&&(bt(0),X(1,$1,1,0,null,11),vt()),n&2){let t=G(5);R(),V("ngTemplateOutlet",t._maximizeiconTemplate||t.maximizeIconTemplate||t.maximizeIconT)}}function B1(n,e){}function q1(n,e){n&1&&X(0,B1,0,0,"ng-template")}function U1(n,e){if(n&1&&(bt(0),X(1,q1,1,0,null,11),vt()),n&2){let t=G(5);R(),V("ngTemplateOutlet",t._minimizeiconTemplate||t.minimizeIconTemplate||t.minimizeIconT)}}function G1(n,e){if(n&1){let t=Ke();F(0,"p-button",21),Ae("onClick",function(){ae(t);let r=G(4);return le(r.maximize())})("keydown.enter",function(){ae(t);let r=G(4);return le(r.maximize())}),X(1,O1,1,1,"span",18)(2,F1,3,2,"ng-container",22)(3,z1,2,1,"ng-container",22)(4,U1,2,1,"ng-container",22),$()}if(n&2){let t=G(4);V("styleClass",t.cx("pcMaximizeButton"))("tabindex",t.maximizable?"0":"-1")("ariaLabel",t.maximizeLabel)("buttonProps",t.maximizeButtonProps),R(),V("ngIf",t.maximizeIcon&&!t._maximizeiconTemplate&&!t._minimizeiconTemplate),R(),V("ngIf",!t.maximizeIcon&&!(t.maximizeButtonProps!=null&&t.maximizeButtonProps.icon)),R(),V("ngIf",!t.maximized),R(),V("ngIf",t.maximized)}}function j1(n,e){if(n&1&&Q(0,"span",15),n&2){let t=G(7);V("ngClass",t.closeIcon)}}function K1(n,e){n&1&&Q(0,"TimesIcon")}function H1(n,e){if(n&1&&(bt(0),X(1,j1,1,1,"span",18)(2,K1,1,0,"TimesIcon",22),vt()),n&2){let t=G(6);R(),V("ngIf",t.closeIcon),R(),V("ngIf",!t.closeIcon)}}function Q1(n,e){}function W1(n,e){n&1&&X(0,Q1,0,0,"ng-template")}function J1(n,e){if(n&1&&(F(0,"span"),X(1,W1,1,0,null,11),$()),n&2){let t=G(6);R(),V("ngTemplateOutlet",t._closeiconTemplate||t.closeIconTemplate||t.closeIconT)}}function X1(n,e){if(n&1&&X(0,H1,3,2,"ng-container",22)(1,J1,2,1,"span",22),n&2){let t=G(5);V("ngIf",!t._closeiconTemplate&&!t.closeIconTemplate&&!t.closeIconT&&!(t.closeButtonProps!=null&&t.closeButtonProps.icon)),R(),V("ngIf",t._closeiconTemplate||t.closeIconTemplate||t.closeIconT)}}function Y1(n,e){if(n&1){let t=Ke();F(0,"p-button",23),Ae("onClick",function(r){ae(t);let o=G(4);return le(o.close(r))})("keydown.enter",function(r){ae(t);let o=G(4);return le(o.close(r))}),X(1,X1,2,2,"ng-template",null,4,Pc),$()}if(n&2){let t=G(4);V("styleClass",t.cx("pcCloseButton"))("ariaLabel",t.closeAriaLabel)("tabindex",t.closeTabindex)("buttonProps",t.closeButtonProps)}}function Z1(n,e){n&1&&Lt(0)}function ev(n,e){n&1&&Lt(0)}function tv(n,e){if(n&1&&(F(0,"div",15,5),fo(2,1),X(3,ev,1,0,"ng-container",11),$()),n&2){let t=G(4);V("ngClass",t.cx("footer")),R(3),V("ngTemplateOutlet",t._footerTemplate||t.footerTemplate||t.footerT)}}function nv(n,e){if(n&1){let t=Ke();X(0,D1,1,1,"div",12),F(1,"div",13,2),Ae("mousedown",function(r){ae(t);let o=G(3);return le(o.initDrag(r))}),X(3,R1,2,3,"span",14)(4,V1,1,0,"ng-container",11),F(5,"div",15),X(6,G1,5,8,"p-button",16)(7,Y1,3,4,"p-button",17),$()(),F(8,"div",7,3),fo(10),X(11,Z1,1,0,"ng-container",11),$(),X(12,tv,4,2,"div",18)}if(n&2){let t=G(3);V("ngIf",t.resizable),R(),V("ngClass",t.cx("header")),R(2),V("ngIf",!t._headerTemplate&&!t.headerTemplate&&!t.headerT),R(),V("ngTemplateOutlet",t._headerTemplate||t.headerTemplate||t.headerT),R(),V("ngClass",t.cx("headerActions")),R(),V("ngIf",t.maximizable),R(),V("ngIf",t.closable),R(),Ie(t.contentStyleClass),V("ngClass",t.cx("content"))("ngStyle",t.contentStyle),Z("data-pc-section","content"),R(3),V("ngTemplateOutlet",t._contentTemplate||t.contentTemplate||t.contentT),R(),V("ngIf",t._footerTemplate||t.footerTemplate||t.footerT)}}function iv(n,e){if(n&1){let t=Ke();F(0,"div",9,0),Ae("@animation.start",function(r){ae(t);let o=G(2);return le(o.onAnimationStart(r))})("@animation.done",function(r){ae(t);let o=G(2);return le(o.onAnimationEnd(r))}),X(2,k1,2,1,"ng-container",10)(3,nv,13,14,"ng-template",null,1,Pc),$()}if(n&2){let t=bm(4),i=G(2);mo(i.style),Ie(i.styleClass),V("ngClass",wt(13,C1,i.maximizable&&i.maximized))("ngStyle",vm(15,x1))("pFocusTrapDisabled",i.focusTrap===!1)("@animation",wt(19,S1,hi(16,A1,i.transformOptions,i.transitionOptions))),Z("role",i.role)("aria-labelledby",i.ariaLabelledBy)("aria-modal",!0),R(2),V("ngIf",i._headlessTemplate||i.headlessTemplate||i.headlessT)("ngIfElse",t)}}function rv(n,e){if(n&1&&(F(0,"div",7),X(1,iv,5,21,"div",8),$()),n&2){let t=G();mo(t.maskStyle),Ie(t.maskStyleClass),V("ngClass",t.maskClass)("ngStyle",wm(7,E1,t.position==="left"||t.position==="topleft"||t.position==="bottomleft"?"flex-start":t.position==="right"||t.position==="topright"||t.position==="bottomright"?"flex-end":"center",t.position==="top"||t.position==="topleft"||t.position==="topright"?"flex-start":t.position==="bottom"||t.position==="bottomleft"||t.position==="bottomright"?"flex-end":"center",t.modal?"auto":"none")),R(),V("ngIf",t.visible)}}var ov=kc([Zt({transform:"{{transform}}",opacity:0}),Mn("{{transition}}")]),sv=kc([Mn("{{transition}}",Zt({transform:"{{transform}}",opacity:0}))]),Bc=(()=>{class n extends _n{header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(t){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(t){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(t){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;maskStyle;showHeader=!0;get breakpoint(){return 649}set breakpoint(t){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="0";minimizeIcon;maximizeIcon;closeButtonProps={severity:"secondary",text:!0,rounded:!0};maximizeButtonProps={severity:"secondary",text:!0,rounded:!0};get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(t){t&&(this._style=Ft({},t),this.originalStyle=t)}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)";break}}role="dialog";onShow=new Je;onHide=new Je;visibleChange=new Je;onResizeInit=new Je;onResizeEnd=new Je;onDragEnd=new Je;onMaximize=new Je;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;closeIconTemplate;maximizeIconTemplate;minimizeIconTemplate;headlessTemplate;_headerTemplate;_contentTemplate;_footerTemplate;_closeiconTemplate;_maximizeiconTemplate;_minimizeiconTemplate;_headlessTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy=this.getAriaLabelledBy();documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=tt("pn_id_");_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;_componentStyle=je(mf);headerT;contentT;footerT;closeIconT;maximizeIconT;minimizeIconT;headlessT;get maximizeLabel(){return this.config.getTranslation(Bm.ARIA).maximizeLabel}zone=je(et);get maskClass(){let i=["left","right","top","topleft","topright","bottom","bottomleft","bottomright"].find(r=>r===this.position);return{"p-dialog-mask":!0,"p-overlay-mask p-overlay-mask-enter":this.modal||this.dismissableMask,[`p-dialog-${i}`]:i}}ngOnInit(){super.ngOnInit(),this.breakpoints&&this.createStyle()}templates;ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerT=t.template;break;case"content":this.contentT=t.template;break;case"footer":this.footerT=t.template;break;case"closeicon":this.closeIconT=t.template;break;case"maximizeicon":this.maximizeIconT=t.template;break;case"minimizeicon":this.minimizeIconT=t.template;break;case"headless":this.headlessT=t.template;break;default:this.contentT=t.template;break}})}getAriaLabelledBy(){return this.header!==null?tt("pn_id_")+"_header":null}parseDurationToMilliseconds(t){let i=/([\d\.]+)(ms|s)\b/g,r=0,o;for(;(o=i.exec(t))!==null;){let s=parseFloat(o[1]),l=o[2];l==="ms"?r+=s:l==="s"&&(r+=s*1e3)}if(r!==0)return r}_focus(t){if(t){let i=this.parseDurationToMilliseconds(this.transitionOptions),r=qm.getFocusableElements(t);if(r&&r.length>0)return this.zone.runOutsideAngular(()=>{setTimeout(()=>r[0].focus(),i||5)}),!0}return!1}focus(t){let i=this._focus(t);i||(i=this._focus(this.footerViewChild?.nativeElement),i||(i=this._focus(this.headerViewChild?.nativeElement),i||this._focus(this.contentViewChild?.nativeElement)))}close(t){this.visibleChange.emit(!1),t.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)})),this.modal&&Rc()}disableModality(){if(this.wrapper){this.dismissableMask&&this.unbindMaskClickListener();let t=document.querySelectorAll(".p-dialog-mask-scrollblocker");this.modal&&t&&t.length==1&&Vc(),this.cd.destroyed||this.cd.detectChanges()}}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?Rc():Vc()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(fi.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(di(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let i in this.breakpoints)t+=`
                        @media screen and (max-width: ${i}) {
                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {
                                width: ${this.breakpoints[i]} !important;
                            }
                        }
                    `;this.renderer.setProperty(this.styleElement,"innerHTML",t),Ys(this.styleElement,"nonce",this.config?.csp()?.nonce)}}initDrag(t){yo(t.target,"p-dialog-maximize-icon")||yo(t.target,"p-dialog-header-close-icon")||yo(t.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,this.container.style.margin="0",bo(this.document.body,"p-unselectable-text"))}onDrag(t){if(this.dragging){let i=Mc(this.container),r=Xs(this.container),o=t.pageX-this.lastPageX,s=t.pageY-this.lastPageY,l=this.container.getBoundingClientRect(),c=getComputedStyle(this.container),h=parseFloat(c.marginLeft),p=parseFloat(c.marginTop),f=l.left+o-h,_=l.top+s-p,E=Oc();this.container.style.position="fixed",this.keepInViewport?(f>=this.minX&&f+i<E.width&&(this._style.left=`${f}px`,this.lastPageX=t.pageX,this.container.style.left=`${f}px`),_>=this.minY&&_+r<E.height&&(this._style.top=`${_}px`,this.lastPageY=t.pageY,this.container.style.top=`${_}px`)):(this.lastPageX=t.pageX,this.container.style.left=`${f}px`,this.lastPageY=t.pageY,this.container.style.top=`${_}px`)}}endDrag(t){this.dragging&&(this.dragging=!1,Js(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(t))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(t){this.resizable&&(this.resizing=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,bo(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(t))}onResize(t){if(this.resizing){let i=t.pageX-this.lastPageX,r=t.pageY-this.lastPageY,o=Mc(this.container),s=Xs(this.container),l=Xs(this.contentViewChild?.nativeElement),c=o+i,h=s+r,p=this.container.style.minWidth,f=this.container.style.minHeight,_=this.container.getBoundingClientRect(),E=Oc();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(c+=i,h+=r),(!p||c>parseInt(p))&&_.left+c<E.width&&(this._style.width=c+"px",this.container.style.width=this._style.width),(!f||h>parseInt(f))&&_.top+h<E.height&&(this.contentViewChild.nativeElement.style.height=l+h-s+"px",this._style.height&&(this._style.height=h+"px",this.container.style.height=this._style.height)),this.lastPageX=t.pageX,this.lastPageY=t.pageY}}resizeEnd(t){this.resizing&&(this.resizing=!1,Js(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(t))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.document.defaultView,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.document.defaultView,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.document.defaultView,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.document.defaultView,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){let t=this.el?this.el.nativeElement.ownerDocument:"document";this.documentEscapeListener=this.renderer.listen(t,"keydown",i=>{i.key=="Escape"&&this.close(i)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.wrapper):Fm(this.appendTo,this.wrapper))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&bo(this.wrapper,"p-overlay-mask-leave");break}}onAnimationEnd(t){switch(t.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({});break}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(this.document.body.style.removeProperty("--scrollbar;-width"),this.maximized=!1),this.modal&&this.disableModality(),yo(this.document.body,"p-overflow-hidden")&&Js(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&fi.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?Ft({},this.originalStyle):{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle(),super.ngOnDestroy()}static \u0275fac=(()=>{let t;return function(r){return(t||(t=ye(n)))(r||n)}})();static \u0275cmp=de({type:n,selectors:[["p-dialog"]],contentQueries:function(i,r,o){if(i&1&&(He(o,g1,4),He(o,ff,4),He(o,gf,4),He(o,_1,4),He(o,y1,4),He(o,b1,4),He(o,v1,4),He(o,mi,4)),i&2){let s;be(s=ve())&&(r._headerTemplate=s.first),be(s=ve())&&(r._contentTemplate=s.first),be(s=ve())&&(r._footerTemplate=s.first),be(s=ve())&&(r._closeiconTemplate=s.first),be(s=ve())&&(r._maximizeiconTemplate=s.first),be(s=ve())&&(r._minimizeiconTemplate=s.first),be(s=ve())&&(r._headlessTemplate=s.first),be(s=ve())&&(r.templates=s)}},viewQuery:function(i,r){if(i&1&&(mn(w1,5),mn(ff,5),mn(gf,5)),i&2){let o;be(o=ve())&&(r.headerViewChild=o.first),be(o=ve())&&(r.contentViewChild=o.first),be(o=ve())&&(r.footerViewChild=o.first)}},inputs:{header:"header",draggable:[2,"draggable","draggable",he],resizable:[2,"resizable","resizable",he],positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:[2,"modal","modal",he],closeOnEscape:[2,"closeOnEscape","closeOnEscape",he],dismissableMask:[2,"dismissableMask","dismissableMask",he],rtl:[2,"rtl","rtl",he],closable:[2,"closable","closable",he],responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",maskStyle:"maskStyle",showHeader:[2,"showHeader","showHeader",he],breakpoint:"breakpoint",blockScroll:[2,"blockScroll","blockScroll",he],autoZIndex:[2,"autoZIndex","autoZIndex",he],baseZIndex:[2,"baseZIndex","baseZIndex",$t],minX:[2,"minX","minX",$t],minY:[2,"minY","minY",$t],focusOnShow:[2,"focusOnShow","focusOnShow",he],maximizable:[2,"maximizable","maximizable",he],keepInViewport:[2,"keepInViewport","keepInViewport",he],focusTrap:[2,"focusTrap","focusTrap",he],transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",closeButtonProps:"closeButtonProps",maximizeButtonProps:"maximizeButtonProps",visible:"visible",style:"style",position:"position",role:"role",headerTemplate:[0,"content","headerTemplate"],contentTemplate:"contentTemplate",footerTemplate:"footerTemplate",closeIconTemplate:"closeIconTemplate",maximizeIconTemplate:"maximizeIconTemplate",minimizeIconTemplate:"minimizeIconTemplate",headlessTemplate:"headlessTemplate"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},features:[Xt([mf]),Jt,xe],ngContentSelectors:I1,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["titlebar",""],["content",""],["icon",""],["footer",""],[3,"ngClass","class","ngStyle","style",4,"ngIf"],[3,"ngClass","ngStyle"],["pFocusTrap","",3,"class","ngClass","ngStyle","style","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","",3,"ngClass","ngStyle","pFocusTrapDisabled"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],["style","z-index: 90;",3,"ngClass","mousedown",4,"ngIf"],[3,"mousedown","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"ngClass"],[3,"styleClass","tabindex","ariaLabel","buttonProps","onClick","keydown.enter",4,"ngIf"],[3,"styleClass","ariaLabel","tabindex","buttonProps","onClick","keydown.enter",4,"ngIf"],[3,"ngClass",4,"ngIf"],[2,"z-index","90",3,"mousedown","ngClass"],[3,"id","ngClass"],[3,"onClick","keydown.enter","styleClass","tabindex","ariaLabel","buttonProps"],[4,"ngIf"],[3,"onClick","keydown.enter","styleClass","ariaLabel","tabindex","buttonProps"]],template:function(i,r){i&1&&(qs(T1),X(0,rv,2,11,"div",6)),i&2&&V("ngIf",r.maskVisible)},dependencies:[lt,zt,Wi,Ji,Yt,xo,pf,er,of,sf,ct],encapsulation:2,data:{animation:[pi("animation",[gn("void => visible",[Dc(ov)]),gn("visible => void",[Dc(sv)])])]},changeDetection:0})}return n})(),ya=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ze({type:n});static \u0275inj=$e({imports:[Bc,ct,ct]})}return n})();var _f=new Ze("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var yf=(()=>{class n{constructor(t,i,r){this.ngZone=t,this.document=i,this.window=r,this.copySubject=new Hi,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});let i=this.copyFromContent(t);return i?this.pushCopyResponse({content:t,isSuccess:i}):this.pushCopyResponse({isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,i=!0){try{this.selectTarget(t);let r=this.copyText();return this.clearSelection(i?t:void 0,this.window),r&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){let t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,i=this.document.body){if(this.tempTextArea&&!i.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{i.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;let r=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),r}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,i){t&&t.focus(),i.getSelection()?.removeAllRanges()}createTempTextArea(t,i){let r=t.documentElement.getAttribute("dir")==="rtl",o;o=t.createElement("textarea"),o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[r?"right":"left"]="-9999px";let s=i.pageYOffset||t.documentElement.scrollTop;return o.style.top=s+"px",o.setAttribute("readonly",""),o}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return n.\u0275fac=function(t){return new(t||n)(ne(et),ne(Qi),ne(_f,8))},n.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var bf=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ze({type:n}),n.\u0275inj=$e({imports:[lt]}),n})();var cv="firebase",uv="11.1.0";Nn(cv,uv,"app");var Ao=new Cm("ANGULARFIRE2_VERSION");var hv=(n,e)=>{let t=e?[e]:Zm(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(s=>{i.includes(s)||i.push(s)})}),i},_i=class{constructor(){return hv(dv)}},dv="app-check",ba=class{zone;delegate;constructor(e,t=cm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,o=function(s){r?r.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,i)}},va=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=je(et);this.outsideAngular=t.runOutsideAngular(()=>new ba(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ba(typeof Zone>"u"?void 0:Zone.current,Ms))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fv=new Map,gv={activated:!1,tokenObservers:[]},_v={initialized:!1,enabled:!1};function qt(n){return fv.get(n)||Object.assign({},gv)}function Cf(){return _v}var yv="https://content-firebaseappcheck.googleapis.com/v1";var bv="exchangeDebugToken",wf={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},T2=24*60*60*1e3;var Uc=class{constructor(e,t,i,r,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=r,r>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return P(this,null,function*(){this.stop();try{this.pending=new Fc,this.pending.promise.catch(t=>{}),yield vv(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Fc,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function vv(n){return new Promise(e=>{setTimeout(e,n)})}var wv={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Fn=new Xm("appCheck","AppCheck",wv);function xf(n){if(!qt(n).activated)throw Fn.create("use-before-activation",{appName:n.name})}function Af(i,r){return P(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let E=yield s.getHeartbeatsHeader();E&&(o["X-Firebase-Client"]=E)}let l={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,l)}catch(E){throw Fn.create("fetch-network-error",{originalErrorMessage:E?.message})}if(c.status!==200)throw Fn.create("fetch-status-error",{httpStatus:c.status});let h;try{h=yield c.json()}catch(E){throw Fn.create("fetch-parse-error",{originalErrorMessage:E?.message})}let p=h.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Fn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});let f=Number(p[1])*1e3,_=Date.now();return{token:h.token,expireTimeMillis:_+f,issuedAtTimeMillis:_}})}function Sf(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${yv}/projects/${t}/apps/${i}:${bv}?key=${r}`,body:{debug_token:e}}}var Tv="firebase-app-check-database",Iv=1,Gc="firebase-app-check-store";var wa=null;function Ev(){return wa||(wa=new Promise((n,e)=>{try{let t=indexedDB.open(Tv,Iv);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Fn.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(Gc,{keyPath:"compositeKey"})}}}catch(t){e(Fn.create("storage-open",{originalErrorMessage:t?.message}))}}),wa)}function Cv(n,e){return xv(Av(n),e)}function xv(n,e){return P(this,null,function*(){let i=(yield Ev()).transaction(Gc,"readwrite"),o=i.objectStore(Gc).put({compositeKey:n,value:e});return new Promise((s,l)=>{o.onsuccess=c=>{s()},i.onerror=c=>{var h;l(Fn.create("storage-set",{originalErrorMessage:(h=c.target.error)===null||h===void 0?void 0:h.message}))}})})}function Av(n){return`${n.options.appId}-${n.name}`}var jc=new ta("@firebase/app-check");function qc(n,e){return ea()?Cv(n,e).catch(t=>{jc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Pf(){return Cf().enabled}function kf(){return P(this,null,function*(){let n=Cf();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Sv={error:"UNKNOWN_ERROR"};function Pv(n){return Qm.encodeString(JSON.stringify(n),!1)}function Kc(n,e=!1){return P(this,null,function*(){let t=n.app;xf(t);let i=qt(t),r=i.token,o;if(r&&!So(r)&&(i.token=void 0,r=void 0),!r){let c=yield i.cachedTokenPromise;c&&(So(c)?r=c:yield qc(t,void 0))}if(!e&&r&&So(r))return{token:r.token};let s=!1;if(Pf()){i.exchangeTokenPromise||(i.exchangeTokenPromise=Af(Sf(t,yield kf()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),s=!0);let c=yield i.exchangeTokenPromise;return yield qc(t,c),i.token=c,{token:c.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),s=!0),r=yield qt(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?jc.warn(c.message):jc.error(c),o=c}let l;return r?o?So(r)?l={token:r.token,internalError:o}:l=If(o):(l={token:r.token},i.token=r,yield qc(t,r)):l=If(o),s&&Vv(t,l),l})}function kv(n){return P(this,null,function*(){let e=n.app;xf(e);let{provider:t}=qt(e);if(Pf()){let i=yield kf(),{token:r}=yield Af(Sf(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function Dv(n,e,t,i){let{app:r}=n,o=qt(r),s={next:t,error:i,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&So(o.token)){let l=o.token;Promise.resolve().then(()=>{t({token:l.token}),Tf(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Tf(n))}function Df(n,e){let t=qt(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function Tf(n){let{app:e}=n,t=qt(e),i=t.tokenRefresher;i||(i=Rv(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function Rv(n){let{app:e}=n;return new Uc(()=>P(this,null,function*(){let t=qt(e),i;if(t.token?i=yield Kc(n,!0):i=yield Kc(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=qt(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},wf.RETRIAL_MIN_WAIT,wf.RETRIAL_MAX_WAIT)}function Vv(n,e){let t=qt(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function So(n){return n.expireTimeMillis-Date.now()>0}function If(n){return{token:Pv(Sv),error:n}}var Hc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=qt(this.app);for(let t of e)Df(this.app,t.next);return Promise.resolve()}};function Ov(n,e){return new Hc(n,e)}function Mv(n){return{getToken:e=>Kc(n,e),getLimitedUseToken:()=>kv(n),addTokenListener:e=>Dv(n,"INTERNAL",e),removeTokenListener:e=>Df(n.app,e)}}var Nv="@firebase/app-check",Fv="0.8.10";var Lv="app-check",Ef="app-check-internal";function $v(){wo(new gi(Lv,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Ov(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Ef).initialize()})),wo(new gi(Ef,n=>{let e=n.getProvider("app-check").getImmediate();return Mv(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Nn(Nv,Fv)}$v();var zv=["localhost","0.0.0.0","127.0.0.1"],O2=typeof window<"u"&&zv.includes(window.location.hostname);var Bv="firebase",qv="11.1.0";Et.registerVersion(Bv,qv,"app-compat");var Uv=["ngOnDestroy"],Of=(n,e,t,i={})=>new Proxy(n,{get:(r,o)=>t.runOutsideAngular(()=>{if(n[o])return i?.spy?.get&&i.spy.get(o,n[o]),n[o];if(Uv.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(l=>{let c=l?.[o];return typeof c=="function"?c.bind(l):c?.then?c.then(h=>t.run(()=>h)):t.run(()=>c)});return new Proxy(()=>{},{get:(l,c)=>s[c],apply:(l,c,h)=>s.then(p=>{let f=p?.(...h);return i?.spy?.apply&&i.spy.apply(o,h,f),f})})})});var Ta=class{constructor(e){return e}},ir=new Ze("angularfire2.app.options"),rr=new Ze("angularfire2.app.name");function Po(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let s=Et.apps.filter(l=>l&&l.name===r.name)[0]||e.runOutsideAngular(()=>Et.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let l=!!module.hot;Gv("error",`${s.name} Firebase App already initialized with different options${l?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Ta(s)}var Gv=(n,...e)=>{Ks()&&typeof console<"u"&&console[n](...e)},jv={provide:Ta,useFactory:Po,deps:[ir,et,[new pm,rr]]},Mf=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:ir,useValue:t},{provide:rr,useValue:i}]}}constructor(t){Et.registerVersion("angularfire",Ao.full,"core"),Et.registerVersion("angularfire",Ao.full,"app-compat"),Et.registerVersion("angular",xm.full,t.toString())}static \u0275fac=function(i){return new(i||n)(ne(Wt))};static \u0275mod=ze({type:n});static \u0275inj=$e({providers:[jv]})}return n})();function Ia(n,e,t,i,r){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(l=>l[0]===n)||[];if(o)return Kv(r,s)||(Vf("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Hv?" You may need to reload as Firebase is not HMR aware.":""}`),Vf("warn",{is:r,was:s})),o;{let l=i();return globalThis.\u0275AngularfireInstanceCache.push([n,l,r]),l}}function Kv(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var Hv=typeof module<"u"&&!!module.hot,Vf=(n,...e)=>{Ks()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Qc=new Ze("angularfire2.auth.use-emulator"),Wc=new Ze("angularfire2.auth.settings"),Jc=new Ze("angularfire2.auth.tenant-id"),Xc=new Ze("angularfire2.auth.langugage-code"),Yc=new Ze("angularfire2.auth.use-device-language"),Zc=new Ze("angularfire.auth.persistence"),eu=(n,e,t,i,r,o,s,l)=>Ia(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),i&&(c.tenantId=i),c.languageCode=r,o&&c.useDeviceLanguage(),s)for(let[h,p]of Object.entries(s))c.settings[h]=p;return l&&c.setPersistence(l),c},[t,i,r,o,s,l]),Nf=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,o,s,l,c,h,p,f,_,E){let O=new Hi,N=On(void 0).pipe(ho(s.outsideAngular),ci(()=>o.runOutsideAngular(()=>import("./chunk-AUKDSXV6.js"))),Ye(()=>Po(t,o,i)),Ye(k=>eu(k,o,l,h,p,f,c,_)),Ac({bufferSize:1,refCount:!1}));if(Hs(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=On(null);else{N.pipe(dm()).subscribe();let k=N.pipe(ci(z=>z.getRedirectResult().then(J=>J,()=>null)),Tt(),Ac({bufferSize:1,refCount:!1})),H=N.pipe(ci(z=>new Ki(J=>({unsubscribe:o.runOutsideAngular(()=>z.onAuthStateChanged(ee=>J.next(ee),ee=>J.error(ee),()=>J.complete()))})))),W=N.pipe(ci(z=>new Ki(J=>({unsubscribe:o.runOutsideAngular(()=>z.onIdTokenChanged(ee=>J.next(ee),ee=>J.error(ee),()=>J.complete()))}))));this.authState=k.pipe(Sc(H),Ns(s.outsideAngular),ho(s.insideAngular)),this.user=k.pipe(Sc(W),Ns(s.outsideAngular),ho(s.insideAngular)),this.idToken=this.user.pipe(ci(z=>z?Vn(z.getIdToken()):On(null))),this.idTokenResult=this.user.pipe(ci(z=>z?Vn(z.getIdTokenResult()):On(null))),this.credential=um(k,O,this.authState.pipe(po(z=>!z))).pipe(Ye(z=>z?.user?z:null),Ns(s.outsideAngular),ho(s.insideAngular))}return Of(this,N,o,{spy:{apply:(k,H,W)=>{(k.startsWith("signIn")||k.startsWith("createUser"))&&W.then(z=>O.next(z))}}})}static \u0275fac=function(i){return new(i||n)(ne(ir),ne(rr,8),ne(Wt),ne(et),ne(va),ne(Qc,8),ne(Wc,8),ne(Jc,8),ne(Xc,8),ne(Yc,8),ne(Zc,8),ne(_i,8))};static \u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var Ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lf={};var Ln,tu;(function(){var n;function e(v,g){function b(){}b.prototype=g.prototype,v.D=g.prototype,v.prototype=new b,v.prototype.constructor=v,v.C=function(w,T,C){for(var y=Array(arguments.length-2),hn=2;hn<arguments.length;hn++)y[hn-2]=arguments[hn];return g.prototype[T].apply(w,y)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(v,g,b){b||(b=0);var w=Array(16);if(typeof g=="string")for(var T=0;16>T;++T)w[T]=g.charCodeAt(b++)|g.charCodeAt(b++)<<8|g.charCodeAt(b++)<<16|g.charCodeAt(b++)<<24;else for(T=0;16>T;++T)w[T]=g[b++]|g[b++]<<8|g[b++]<<16|g[b++]<<24;g=v.g[0],b=v.g[1],T=v.g[2];var C=v.g[3],y=g+(C^b&(T^C))+w[0]+3614090360&4294967295;g=b+(y<<7&4294967295|y>>>25),y=C+(T^g&(b^T))+w[1]+3905402710&4294967295,C=g+(y<<12&4294967295|y>>>20),y=T+(b^C&(g^b))+w[2]+606105819&4294967295,T=C+(y<<17&4294967295|y>>>15),y=b+(g^T&(C^g))+w[3]+3250441966&4294967295,b=T+(y<<22&4294967295|y>>>10),y=g+(C^b&(T^C))+w[4]+4118548399&4294967295,g=b+(y<<7&4294967295|y>>>25),y=C+(T^g&(b^T))+w[5]+1200080426&4294967295,C=g+(y<<12&4294967295|y>>>20),y=T+(b^C&(g^b))+w[6]+2821735955&4294967295,T=C+(y<<17&4294967295|y>>>15),y=b+(g^T&(C^g))+w[7]+4249261313&4294967295,b=T+(y<<22&4294967295|y>>>10),y=g+(C^b&(T^C))+w[8]+1770035416&4294967295,g=b+(y<<7&4294967295|y>>>25),y=C+(T^g&(b^T))+w[9]+2336552879&4294967295,C=g+(y<<12&4294967295|y>>>20),y=T+(b^C&(g^b))+w[10]+4294925233&4294967295,T=C+(y<<17&4294967295|y>>>15),y=b+(g^T&(C^g))+w[11]+2304563134&4294967295,b=T+(y<<22&4294967295|y>>>10),y=g+(C^b&(T^C))+w[12]+1804603682&4294967295,g=b+(y<<7&4294967295|y>>>25),y=C+(T^g&(b^T))+w[13]+4254626195&4294967295,C=g+(y<<12&4294967295|y>>>20),y=T+(b^C&(g^b))+w[14]+2792965006&4294967295,T=C+(y<<17&4294967295|y>>>15),y=b+(g^T&(C^g))+w[15]+1236535329&4294967295,b=T+(y<<22&4294967295|y>>>10),y=g+(T^C&(b^T))+w[1]+4129170786&4294967295,g=b+(y<<5&4294967295|y>>>27),y=C+(b^T&(g^b))+w[6]+3225465664&4294967295,C=g+(y<<9&4294967295|y>>>23),y=T+(g^b&(C^g))+w[11]+643717713&4294967295,T=C+(y<<14&4294967295|y>>>18),y=b+(C^g&(T^C))+w[0]+3921069994&4294967295,b=T+(y<<20&4294967295|y>>>12),y=g+(T^C&(b^T))+w[5]+3593408605&4294967295,g=b+(y<<5&4294967295|y>>>27),y=C+(b^T&(g^b))+w[10]+38016083&4294967295,C=g+(y<<9&4294967295|y>>>23),y=T+(g^b&(C^g))+w[15]+3634488961&4294967295,T=C+(y<<14&4294967295|y>>>18),y=b+(C^g&(T^C))+w[4]+3889429448&4294967295,b=T+(y<<20&4294967295|y>>>12),y=g+(T^C&(b^T))+w[9]+568446438&4294967295,g=b+(y<<5&4294967295|y>>>27),y=C+(b^T&(g^b))+w[14]+3275163606&4294967295,C=g+(y<<9&4294967295|y>>>23),y=T+(g^b&(C^g))+w[3]+4107603335&4294967295,T=C+(y<<14&4294967295|y>>>18),y=b+(C^g&(T^C))+w[8]+1163531501&4294967295,b=T+(y<<20&4294967295|y>>>12),y=g+(T^C&(b^T))+w[13]+2850285829&4294967295,g=b+(y<<5&4294967295|y>>>27),y=C+(b^T&(g^b))+w[2]+4243563512&4294967295,C=g+(y<<9&4294967295|y>>>23),y=T+(g^b&(C^g))+w[7]+1735328473&4294967295,T=C+(y<<14&4294967295|y>>>18),y=b+(C^g&(T^C))+w[12]+2368359562&4294967295,b=T+(y<<20&4294967295|y>>>12),y=g+(b^T^C)+w[5]+4294588738&4294967295,g=b+(y<<4&4294967295|y>>>28),y=C+(g^b^T)+w[8]+2272392833&4294967295,C=g+(y<<11&4294967295|y>>>21),y=T+(C^g^b)+w[11]+1839030562&4294967295,T=C+(y<<16&4294967295|y>>>16),y=b+(T^C^g)+w[14]+4259657740&4294967295,b=T+(y<<23&4294967295|y>>>9),y=g+(b^T^C)+w[1]+2763975236&4294967295,g=b+(y<<4&4294967295|y>>>28),y=C+(g^b^T)+w[4]+1272893353&4294967295,C=g+(y<<11&4294967295|y>>>21),y=T+(C^g^b)+w[7]+4139469664&4294967295,T=C+(y<<16&4294967295|y>>>16),y=b+(T^C^g)+w[10]+3200236656&4294967295,b=T+(y<<23&4294967295|y>>>9),y=g+(b^T^C)+w[13]+681279174&4294967295,g=b+(y<<4&4294967295|y>>>28),y=C+(g^b^T)+w[0]+3936430074&4294967295,C=g+(y<<11&4294967295|y>>>21),y=T+(C^g^b)+w[3]+3572445317&4294967295,T=C+(y<<16&4294967295|y>>>16),y=b+(T^C^g)+w[6]+76029189&4294967295,b=T+(y<<23&4294967295|y>>>9),y=g+(b^T^C)+w[9]+3654602809&4294967295,g=b+(y<<4&4294967295|y>>>28),y=C+(g^b^T)+w[12]+3873151461&4294967295,C=g+(y<<11&4294967295|y>>>21),y=T+(C^g^b)+w[15]+530742520&4294967295,T=C+(y<<16&4294967295|y>>>16),y=b+(T^C^g)+w[2]+3299628645&4294967295,b=T+(y<<23&4294967295|y>>>9),y=g+(T^(b|~C))+w[0]+4096336452&4294967295,g=b+(y<<6&4294967295|y>>>26),y=C+(b^(g|~T))+w[7]+1126891415&4294967295,C=g+(y<<10&4294967295|y>>>22),y=T+(g^(C|~b))+w[14]+2878612391&4294967295,T=C+(y<<15&4294967295|y>>>17),y=b+(C^(T|~g))+w[5]+4237533241&4294967295,b=T+(y<<21&4294967295|y>>>11),y=g+(T^(b|~C))+w[12]+1700485571&4294967295,g=b+(y<<6&4294967295|y>>>26),y=C+(b^(g|~T))+w[3]+2399980690&4294967295,C=g+(y<<10&4294967295|y>>>22),y=T+(g^(C|~b))+w[10]+4293915773&4294967295,T=C+(y<<15&4294967295|y>>>17),y=b+(C^(T|~g))+w[1]+2240044497&4294967295,b=T+(y<<21&4294967295|y>>>11),y=g+(T^(b|~C))+w[8]+1873313359&4294967295,g=b+(y<<6&4294967295|y>>>26),y=C+(b^(g|~T))+w[15]+4264355552&4294967295,C=g+(y<<10&4294967295|y>>>22),y=T+(g^(C|~b))+w[6]+2734768916&4294967295,T=C+(y<<15&4294967295|y>>>17),y=b+(C^(T|~g))+w[13]+1309151649&4294967295,b=T+(y<<21&4294967295|y>>>11),y=g+(T^(b|~C))+w[4]+4149444226&4294967295,g=b+(y<<6&4294967295|y>>>26),y=C+(b^(g|~T))+w[11]+3174756917&4294967295,C=g+(y<<10&4294967295|y>>>22),y=T+(g^(C|~b))+w[2]+718787259&4294967295,T=C+(y<<15&4294967295|y>>>17),y=b+(C^(T|~g))+w[9]+3951481745&4294967295,v.g[0]=v.g[0]+g&4294967295,v.g[1]=v.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,v.g[2]=v.g[2]+T&4294967295,v.g[3]=v.g[3]+C&4294967295}i.prototype.u=function(v,g){g===void 0&&(g=v.length);for(var b=g-this.blockSize,w=this.B,T=this.h,C=0;C<g;){if(T==0)for(;C<=b;)r(this,v,C),C+=this.blockSize;if(typeof v=="string"){for(;C<g;)if(w[T++]=v.charCodeAt(C++),T==this.blockSize){r(this,w),T=0;break}}else for(;C<g;)if(w[T++]=v[C++],T==this.blockSize){r(this,w),T=0;break}}this.h=T,this.o+=g},i.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var g=1;g<v.length-8;++g)v[g]=0;var b=8*this.o;for(g=v.length-8;g<v.length;++g)v[g]=b&255,b/=256;for(this.u(v),v=Array(16),g=b=0;4>g;++g)for(var w=0;32>w;w+=8)v[b++]=this.g[g]>>>w&255;return v};function o(v,g){var b=l;return Object.prototype.hasOwnProperty.call(b,v)?b[v]:b[v]=g(v)}function s(v,g){this.h=g;for(var b=[],w=!0,T=v.length-1;0<=T;T--){var C=v[T]|0;w&&C==g||(b[T]=C,w=!1)}this.g=b}var l={};function c(v){return-128<=v&&128>v?o(v,function(g){return new s([g|0],0>g?-1:0)}):new s([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return f;if(0>v)return k(h(-v));for(var g=[],b=1,w=0;v>=b;w++)g[w]=v/b|0,b*=4294967296;return new s(g,0)}function p(v,g){if(v.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(v.charAt(0)=="-")return k(p(v.substring(1),g));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=h(Math.pow(g,8)),w=f,T=0;T<v.length;T+=8){var C=Math.min(8,v.length-T),y=parseInt(v.substring(T,T+C),g);8>C?(C=h(Math.pow(g,C)),w=w.j(C).add(h(y))):(w=w.j(b),w=w.add(h(y)))}return w}var f=c(0),_=c(1),E=c(16777216);n=s.prototype,n.m=function(){if(N(this))return-k(this).m();for(var v=0,g=1,b=0;b<this.g.length;b++){var w=this.i(b);v+=(0<=w?w:4294967296+w)*g,g*=4294967296}return v},n.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(O(this))return"0";if(N(this))return"-"+k(this).toString(v);for(var g=h(Math.pow(v,6)),b=this,w="";;){var T=J(b,g).g;b=H(b,T.j(g));var C=((0<b.g.length?b.g[0]:b.h)>>>0).toString(v);if(b=T,O(b))return C+w;for(;6>C.length;)C="0"+C;w=C+w}},n.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function O(v){if(v.h!=0)return!1;for(var g=0;g<v.g.length;g++)if(v.g[g]!=0)return!1;return!0}function N(v){return v.h==-1}n.l=function(v){return v=H(this,v),N(v)?-1:O(v)?0:1};function k(v){for(var g=v.g.length,b=[],w=0;w<g;w++)b[w]=~v.g[w];return new s(b,~v.h).add(_)}n.abs=function(){return N(this)?k(this):this},n.add=function(v){for(var g=Math.max(this.g.length,v.g.length),b=[],w=0,T=0;T<=g;T++){var C=w+(this.i(T)&65535)+(v.i(T)&65535),y=(C>>>16)+(this.i(T)>>>16)+(v.i(T)>>>16);w=y>>>16,C&=65535,y&=65535,b[T]=y<<16|C}return new s(b,b[b.length-1]&-2147483648?-1:0)};function H(v,g){return v.add(k(g))}n.j=function(v){if(O(this)||O(v))return f;if(N(this))return N(v)?k(this).j(k(v)):k(k(this).j(v));if(N(v))return k(this.j(k(v)));if(0>this.l(E)&&0>v.l(E))return h(this.m()*v.m());for(var g=this.g.length+v.g.length,b=[],w=0;w<2*g;w++)b[w]=0;for(w=0;w<this.g.length;w++)for(var T=0;T<v.g.length;T++){var C=this.i(w)>>>16,y=this.i(w)&65535,hn=v.i(T)>>>16,Kr=v.i(T)&65535;b[2*w+2*T]+=y*Kr,W(b,2*w+2*T),b[2*w+2*T+1]+=C*Kr,W(b,2*w+2*T+1),b[2*w+2*T+1]+=y*hn,W(b,2*w+2*T+1),b[2*w+2*T+2]+=C*hn,W(b,2*w+2*T+2)}for(w=0;w<g;w++)b[w]=b[2*w+1]<<16|b[2*w];for(w=g;w<2*g;w++)b[w]=0;return new s(b,0)};function W(v,g){for(;(v[g]&65535)!=v[g];)v[g+1]+=v[g]>>>16,v[g]&=65535,g++}function z(v,g){this.g=v,this.h=g}function J(v,g){if(O(g))throw Error("division by zero");if(O(v))return new z(f,f);if(N(v))return g=J(k(v),g),new z(k(g.g),k(g.h));if(N(g))return g=J(v,k(g)),new z(k(g.g),g.h);if(30<v.g.length){if(N(v)||N(g))throw Error("slowDivide_ only works with positive integers.");for(var b=_,w=g;0>=w.l(v);)b=ee(b),w=ee(w);var T=te(b,1),C=te(w,1);for(w=te(w,2),b=te(b,2);!O(w);){var y=C.add(w);0>=y.l(v)&&(T=T.add(b),C=y),w=te(w,1),b=te(b,1)}return g=H(v,T.j(g)),new z(T,g)}for(T=f;0<=v.l(g);){for(b=Math.max(1,Math.floor(v.m()/g.m())),w=Math.ceil(Math.log(b)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),C=h(b),y=C.j(g);N(y)||0<y.l(v);)b-=w,C=h(b),y=C.j(g);O(C)&&(C=_),T=T.add(C),v=H(v,y)}return new z(T,v)}n.A=function(v){return J(this,v).h},n.and=function(v){for(var g=Math.max(this.g.length,v.g.length),b=[],w=0;w<g;w++)b[w]=this.i(w)&v.i(w);return new s(b,this.h&v.h)},n.or=function(v){for(var g=Math.max(this.g.length,v.g.length),b=[],w=0;w<g;w++)b[w]=this.i(w)|v.i(w);return new s(b,this.h|v.h)},n.xor=function(v){for(var g=Math.max(this.g.length,v.g.length),b=[],w=0;w<g;w++)b[w]=this.i(w)^v.i(w);return new s(b,this.h^v.h)};function ee(v){for(var g=v.g.length+1,b=[],w=0;w<g;w++)b[w]=v.i(w)<<1|v.i(w-1)>>>31;return new s(b,v.h)}function te(v,g){var b=g>>5;g%=32;for(var w=v.g.length-b,T=[],C=0;C<w;C++)T[C]=0<g?v.i(C+b)>>>g|v.i(C+b+1)<<32-g:v.i(C+b);return new s(T,v.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,tu=Lf.Md5=i,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=h,s.fromString=p,Ln=Lf.Integer=s}).apply(typeof Ff<"u"?Ff:typeof self<"u"?self:typeof window<"u"?window:{});var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yn={};var nu,Wv,or,iu,ko,Ca,ru,ou,su;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,u,d){return a==Array.prototype||a==Object.prototype||(a[u]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ea=="object"&&Ea];for(var u=0;u<a.length;++u){var d=a[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var i=t(this);function r(a,u){if(u)e:{var d=i;a=a.split(".");for(var m=0;m<a.length-1;m++){var I=a[m];if(!(I in d))break e;d=d[I]}a=a[a.length-1],m=d[a],u=u(m),u!=m&&u!=null&&e(d,a,{configurable:!0,writable:!0,value:u})}}function o(a,u){a instanceof String&&(a+="");var d=0,m=!1,I={next:function(){if(!m&&d<a.length){var A=d++;return{value:u(A,a[A]),done:!1}}return m=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}r("Array.prototype.values",function(a){return a||function(){return o(this,function(u,d){return d})}});var s=s||{},l=this||self;function c(a){var u=typeof a;return u=u!="object"?u:a?Array.isArray(a)?"array":u:"null",u=="array"||u=="object"&&typeof a.length=="number"}function h(a){var u=typeof a;return u=="object"&&a!=null||u=="function"}function p(a,u,d){return a.call.apply(a.bind,arguments)}function f(a,u,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,m),a.apply(u,I)}}return function(){return a.apply(u,arguments)}}function _(a,u,d){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:f,_.apply(null,arguments)}function E(a,u){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function O(a,u){function d(){}d.prototype=u.prototype,a.aa=u.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,I,A){for(var L=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)L[_e-2]=arguments[_e];return u.prototype[I].apply(m,L)}}function N(a){let u=a.length;if(0<u){let d=Array(u);for(let m=0;m<u;m++)d[m]=a[m];return d}return[]}function k(a,u){for(let d=1;d<arguments.length;d++){let m=arguments[d];if(c(m)){let I=a.length||0,A=m.length||0;a.length=I+A;for(let L=0;L<A;L++)a[I+L]=m[L]}else a.push(m)}}class H{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function W(a){return/^[\s\xa0]*$/.test(a)}function z(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function J(a){return J[" "](a),a}J[" "]=function(){};var ee=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function te(a,u,d){for(let m in a)u.call(d,a[m],m,a)}function v(a,u){for(let d in a)u.call(void 0,a[d],d,a)}function g(a){let u={};for(let d in a)u[d]=a[d];return u}let b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(a,u){let d,m;for(let I=1;I<arguments.length;I++){m=arguments[I];for(d in m)a[d]=m[d];for(let A=0;A<b.length;A++)d=b[A],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function T(a){var u=1;a=a.split(":");let d=[];for(;0<u&&a.length;)d.push(a.shift()),u--;return a.length&&d.push(a.join(":")),d}function C(a){l.setTimeout(()=>{throw a},0)}function y(){var a=ec;let u=null;return a.g&&(u=a.g,a.g=a.g.next,a.g||(a.h=null),u.next=null),u}class hn{constructor(){this.h=this.g=null}add(u,d){let m=Kr.get();m.set(u,d),this.h?this.h.next=m:this.g=m,this.h=m}}var Kr=new H(()=>new wy,a=>a.reset());class wy{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Hr,Qr=!1,ec=new hn,lp=()=>{let a=l.Promise.resolve(void 0);Hr=()=>{a.then(Ty)}};var Ty=()=>{for(var a;a=y();){try{a.h.call(a.g)}catch(d){C(d)}var u=Kr;u.j(a),100>u.h&&(u.h++,a.next=u.g,u.g=a)}Qr=!1};function Pn(){this.s=this.s,this.C=this.C}Pn.prototype.s=!1,Pn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Pn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function rt(a,u){this.type=a,this.g=this.target=u,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var Iy=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,u=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};l.addEventListener("test",d,u),l.removeEventListener("test",d,u)}catch{}return a}();function Wr(a,u){if(rt.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=u,u=a.relatedTarget){if(ee){e:{try{J(u.nodeName);var I=!0;break e}catch{}I=!1}I||(u=null)}}else d=="mouseover"?u=a.fromElement:d=="mouseout"&&(u=a.toElement);this.relatedTarget=u,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Ey[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Wr.aa.h.call(this)}}O(Wr,rt);var Ey={2:"touch",3:"pen",4:"mouse"};Wr.prototype.h=function(){Wr.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Jr="closure_listenable_"+(1e6*Math.random()|0),Cy=0;function xy(a,u,d,m,I){this.listener=a,this.proxy=null,this.src=u,this.type=d,this.capture=!!m,this.ha=I,this.key=++Cy,this.da=this.fa=!1}function ys(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function bs(a){this.src=a,this.g={},this.h=0}bs.prototype.add=function(a,u,d,m,I){var A=a.toString();a=this.g[A],a||(a=this.g[A]=[],this.h++);var L=nc(a,u,m,I);return-1<L?(u=a[L],d||(u.fa=!1)):(u=new xy(u,this.src,A,!!m,I),u.fa=d,a.push(u)),u};function tc(a,u){var d=u.type;if(d in a.g){var m=a.g[d],I=Array.prototype.indexOf.call(m,u,void 0),A;(A=0<=I)&&Array.prototype.splice.call(m,I,1),A&&(ys(u),a.g[d].length==0&&(delete a.g[d],a.h--))}}function nc(a,u,d,m){for(var I=0;I<a.length;++I){var A=a[I];if(!A.da&&A.listener==u&&A.capture==!!d&&A.ha==m)return I}return-1}var ic="closure_lm_"+(1e6*Math.random()|0),rc={};function cp(a,u,d,m,I){if(m&&m.once)return hp(a,u,d,m,I);if(Array.isArray(u)){for(var A=0;A<u.length;A++)cp(a,u[A],d,m,I);return null}return d=lc(d),a&&a[Jr]?a.K(u,d,h(m)?!!m.capture:!!m,I):up(a,u,d,!1,m,I)}function up(a,u,d,m,I,A){if(!u)throw Error("Invalid event type");var L=h(I)?!!I.capture:!!I,_e=sc(a);if(_e||(a[ic]=_e=new bs(a)),d=_e.add(u,d,m,L,A),d.proxy)return d;if(m=Ay(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)Iy||(I=L),I===void 0&&(I=!1),a.addEventListener(u.toString(),m,I);else if(a.attachEvent)a.attachEvent(pp(u.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function Ay(){function a(d){return u.call(a.src,a.listener,d)}let u=Sy;return a}function hp(a,u,d,m,I){if(Array.isArray(u)){for(var A=0;A<u.length;A++)hp(a,u[A],d,m,I);return null}return d=lc(d),a&&a[Jr]?a.L(u,d,h(m)?!!m.capture:!!m,I):up(a,u,d,!0,m,I)}function dp(a,u,d,m,I){if(Array.isArray(u))for(var A=0;A<u.length;A++)dp(a,u[A],d,m,I);else m=h(m)?!!m.capture:!!m,d=lc(d),a&&a[Jr]?(a=a.i,u=String(u).toString(),u in a.g&&(A=a.g[u],d=nc(A,d,m,I),-1<d&&(ys(A[d]),Array.prototype.splice.call(A,d,1),A.length==0&&(delete a.g[u],a.h--)))):a&&(a=sc(a))&&(u=a.g[u.toString()],a=-1,u&&(a=nc(u,d,m,I)),(d=-1<a?u[a]:null)&&oc(d))}function oc(a){if(typeof a!="number"&&a&&!a.da){var u=a.src;if(u&&u[Jr])tc(u.i,a);else{var d=a.type,m=a.proxy;u.removeEventListener?u.removeEventListener(d,m,a.capture):u.detachEvent?u.detachEvent(pp(d),m):u.addListener&&u.removeListener&&u.removeListener(m),(d=sc(u))?(tc(d,a),d.h==0&&(d.src=null,u[ic]=null)):ys(a)}}}function pp(a){return a in rc?rc[a]:rc[a]="on"+a}function Sy(a,u){if(a.da)a=!0;else{u=new Wr(u,this);var d=a.listener,m=a.ha||a.src;a.fa&&oc(a),a=d.call(m,u)}return a}function sc(a){return a=a[ic],a instanceof bs?a:null}var ac="__closure_events_fn_"+(1e9*Math.random()>>>0);function lc(a){return typeof a=="function"?a:(a[ac]||(a[ac]=function(u){return a.handleEvent(u)}),a[ac])}function ot(){Pn.call(this),this.i=new bs(this),this.M=this,this.F=null}O(ot,Pn),ot.prototype[Jr]=!0,ot.prototype.removeEventListener=function(a,u,d,m){dp(this,a,u,d,m)};function pt(a,u){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=u.type||u,typeof u=="string")u=new rt(u,a);else if(u instanceof rt)u.target=u.target||a;else{var I=u;u=new rt(m,a),w(u,I)}if(I=!0,d)for(var A=d.length-1;0<=A;A--){var L=u.g=d[A];I=vs(L,m,!0,u)&&I}if(L=u.g=a,I=vs(L,m,!0,u)&&I,I=vs(L,m,!1,u)&&I,d)for(A=0;A<d.length;A++)L=u.g=d[A],I=vs(L,m,!1,u)&&I}ot.prototype.N=function(){if(ot.aa.N.call(this),this.i){var a=this.i,u;for(u in a.g){for(var d=a.g[u],m=0;m<d.length;m++)ys(d[m]);delete a.g[u],a.h--}}this.F=null},ot.prototype.K=function(a,u,d,m){return this.i.add(String(a),u,!1,d,m)},ot.prototype.L=function(a,u,d,m){return this.i.add(String(a),u,!0,d,m)};function vs(a,u,d,m){if(u=a.i.g[String(u)],!u)return!0;u=u.concat();for(var I=!0,A=0;A<u.length;++A){var L=u[A];if(L&&!L.da&&L.capture==d){var _e=L.listener,Xe=L.ha||L.src;L.fa&&tc(a.i,L),I=_e.call(Xe,m)!==!1&&I}}return I&&!m.defaultPrevented}function mp(a,u,d){if(typeof a=="function")d&&(a=_(a,d));else if(a&&typeof a.handleEvent=="function")a=_(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:l.setTimeout(a,u||0)}function fp(a){a.g=mp(()=>{a.g=null,a.i&&(a.i=!1,fp(a))},a.l);let u=a.h;a.h=null,a.m.apply(null,u)}class Py extends Pn{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:fp(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xr(a){Pn.call(this),this.h=a,this.g={}}O(Xr,Pn);var gp=[];function _p(a){te(a.g,function(u,d){this.g.hasOwnProperty(d)&&oc(u)},a),a.g={}}Xr.prototype.N=function(){Xr.aa.N.call(this),_p(this)},Xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cc=l.JSON.stringify,ky=l.JSON.parse,Dy=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function uc(){}uc.prototype.h=null;function yp(a){return a.h||(a.h=a.i())}function bp(){}var Yr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hc(){rt.call(this,"d")}O(hc,rt);function dc(){rt.call(this,"c")}O(dc,rt);var oi={},vp=null;function ws(){return vp=vp||new ot}oi.La="serverreachability";function wp(a){rt.call(this,oi.La,a)}O(wp,rt);function Zr(a){let u=ws();pt(u,new wp(u))}oi.STAT_EVENT="statevent";function Tp(a,u){rt.call(this,oi.STAT_EVENT,a),this.stat=u}O(Tp,rt);function mt(a){let u=ws();pt(u,new Tp(u,a))}oi.Ma="timingevent";function Ip(a,u){rt.call(this,oi.Ma,a),this.size=u}O(Ip,rt);function eo(a,u){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},u)}function to(){this.g=!0}to.prototype.xa=function(){this.g=!1};function Ry(a,u,d,m,I,A){a.info(function(){if(a.g)if(A)for(var L="",_e=A.split("&"),Xe=0;Xe<_e.length;Xe++){var ue=_e[Xe].split("=");if(1<ue.length){var st=ue[0];ue=ue[1];var at=st.split("_");L=2<=at.length&&at[1]=="type"?L+(st+"="+ue+"&"):L+(st+"=redacted&")}}else L=null;else L=A;return"XMLHTTP REQ ("+m+") [attempt "+I+"]: "+u+`
`+d+`
`+L})}function Vy(a,u,d,m,I,A,L){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+I+"]: "+u+`
`+d+`
`+A+" "+L})}function qi(a,u,d,m){a.info(function(){return"XMLHTTP TEXT ("+u+"): "+My(a,d)+(m?" "+m:"")})}function Oy(a,u){a.info(function(){return"TIMEOUT: "+u})}to.prototype.info=function(){};function My(a,u){if(!a.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var I=m[1];if(Array.isArray(I)&&!(1>I.length)){var A=I[0];if(A!="noop"&&A!="stop"&&A!="close")for(var L=1;L<I.length;L++)I[L]=""}}}}return cc(d)}catch{return u}}var Ts={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ep={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},pc;function Is(){}O(Is,uc),Is.prototype.g=function(){return new XMLHttpRequest},Is.prototype.i=function(){return{}},pc=new Is;function kn(a,u,d,m){this.j=a,this.i=u,this.l=d,this.R=m||1,this.U=new Xr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cp}function Cp(){this.i=null,this.g="",this.h=!1}var xp={},mc={};function fc(a,u,d){a.L=1,a.v=As(dn(u)),a.m=d,a.P=!0,Ap(a,null)}function Ap(a,u){a.F=Date.now(),Es(a),a.A=dn(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),Bp(d.i,"t",m),a.C=0,d=a.j.J,a.h=new Cp,a.g=om(a.j,d?u:null,!a.m),0<a.O&&(a.M=new Py(_(a.Y,a,a.g),a.O)),u=a.U,d=a.g,m=a.ca;var I="readystatechange";Array.isArray(I)||(I&&(gp[0]=I.toString()),I=gp);for(var A=0;A<I.length;A++){var L=cp(d,I[A],m||u.handleEvent,!1,u.h||u);if(!L)break;u.g[L.key]=L}u=a.H?g(a.H):{},a.m?(a.u||(a.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,u)):(a.u="GET",a.g.ea(a.A,a.u,null,u)),Zr(),Ry(a.i,a.u,a.A,a.l,a.R,a.m)}kn.prototype.ca=function(a){a=a.target;let u=this.M;u&&pn(a)==3?u.j():this.Y(a)},kn.prototype.Y=function(a){try{if(a==this.g)e:{let at=pn(this.g);var u=this.g.Ba();let ji=this.g.Z();if(!(3>at)&&(at!=3||this.g&&(this.h.h||this.g.oa()||Qp(this.g)))){this.J||at!=4||u==7||(u==8||0>=ji?Zr(3):Zr(2)),gc(this);var d=this.g.Z();this.X=d;t:if(Sp(this)){var m=Qp(this.g);a="";var I=m.length,A=pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){si(this),no(this);var L="";break t}this.h.i=new l.TextDecoder}for(u=0;u<I;u++)this.h.h=!0,a+=this.h.i.decode(m[u],{stream:!(A&&u==I-1)});m.length=0,this.h.g+=a,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=d==200,Vy(this.i,this.u,this.A,this.l,this.R,at,d),this.o){if(this.T&&!this.K){t:{if(this.g){var _e,Xe=this.g;if((_e=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(_e)){var ue=_e;break t}}ue=null}if(d=ue)qi(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_c(this,d);else{this.o=!1,this.s=3,mt(12),si(this),no(this);break e}}if(this.P){d=!0;let Nt;for(;!this.J&&this.C<L.length;)if(Nt=Ny(this,L),Nt==mc){at==4&&(this.s=4,mt(14),d=!1),qi(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==xp){this.s=4,mt(15),qi(this.i,this.l,L,"[Invalid Chunk]"),d=!1;break}else qi(this.i,this.l,Nt,null),_c(this,Nt);if(Sp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),at!=4||L.length!=0||this.h.h||(this.s=1,mt(16),d=!1),this.o=this.o&&d,!d)qi(this.i,this.l,L,"[Invalid Chunked Response]"),si(this),no(this);else if(0<L.length&&!this.W){this.W=!0;var st=this.j;st.g==this&&st.ba&&!st.M&&(st.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Ic(st),st.M=!0,mt(11))}}else qi(this.i,this.l,L,null),_c(this,L);at==4&&si(this),this.o&&!this.J&&(at==4?tm(this.j,this):(this.o=!1,Es(this)))}else Zy(this.g),d==400&&0<L.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),si(this),no(this)}}}catch{}finally{}};function Sp(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Ny(a,u){var d=a.C,m=u.indexOf(`
`,d);return m==-1?mc:(d=Number(u.substring(d,m)),isNaN(d)?xp:(m+=1,m+d>u.length?mc:(u=u.slice(m,m+d),a.C=m+d,u)))}kn.prototype.cancel=function(){this.J=!0,si(this)};function Es(a){a.S=Date.now()+a.I,Pp(a,a.I)}function Pp(a,u){if(a.B!=null)throw Error("WatchDog timer not null");a.B=eo(_(a.ba,a),u)}function gc(a){a.B&&(l.clearTimeout(a.B),a.B=null)}kn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(Oy(this.i,this.A),this.L!=2&&(Zr(),mt(17)),si(this),this.s=2,no(this)):Pp(this,this.S-a)};function no(a){a.j.G==0||a.J||tm(a.j,a)}function si(a){gc(a);var u=a.M;u&&typeof u.ma=="function"&&u.ma(),a.M=null,_p(a.U),a.g&&(u=a.g,a.g=null,u.abort(),u.ma())}function _c(a,u){try{var d=a.j;if(d.G!=0&&(d.g==a||yc(d.h,a))){if(!a.K&&yc(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(u)}catch{m=null}if(Array.isArray(m)&&m.length==3){var I=m;if(I[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Rs(d),ks(d);else break e;Tc(d),mt(18)}}else d.za=I[1],0<d.za-d.T&&37500>I[2]&&d.F&&d.v==0&&!d.C&&(d.C=eo(_(d.Za,d),6e3));if(1>=Rp(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else li(d,11)}else if((a.K||d.g==a)&&Rs(d),!W(u))for(I=d.Da.g.parse(u),u=0;u<I.length;u++){let ue=I[u];if(d.T=ue[0],ue=ue[1],d.G==2)if(ue[0]=="c"){d.K=ue[1],d.ia=ue[2];let st=ue[3];st!=null&&(d.la=st,d.j.info("VER="+d.la));let at=ue[4];at!=null&&(d.Aa=at,d.j.info("SVER="+d.Aa));let ji=ue[5];ji!=null&&typeof ji=="number"&&0<ji&&(m=1.5*ji,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;let Nt=a.g;if(Nt){let Os=Nt.g?Nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Os){var A=m.h;A.g||Os.indexOf("spdy")==-1&&Os.indexOf("quic")==-1&&Os.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(bc(A,A.h),A.h=null))}if(m.D){let Ec=Nt.g?Nt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(m.ya=Ec,Te(m.I,m.D,Ec))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var L=a;if(m.qa=rm(m,m.J?m.ia:null,m.W),L.K){Vp(m.h,L);var _e=L,Xe=m.L;Xe&&(_e.I=Xe),_e.B&&(gc(_e),Es(_e)),m.g=L}else Zp(m);0<d.i.length&&Ds(d)}else ue[0]!="stop"&&ue[0]!="close"||li(d,7);else d.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?li(d,7):wc(d):ue[0]!="noop"&&d.l&&d.l.ta(ue),d.v=0)}}Zr(4)}catch{}}var Fy=class{constructor(a,u){this.g=a,this.map=u}};function kp(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dp(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Rp(a){return a.h?1:a.g?a.g.size:0}function yc(a,u){return a.h?a.h==u:a.g?a.g.has(u):!1}function bc(a,u){a.g?a.g.add(u):a.h=u}function Vp(a,u){a.h&&a.h==u?a.h=null:a.g&&a.g.has(u)&&a.g.delete(u)}kp.prototype.cancel=function(){if(this.i=Op(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Op(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let u=a.i;for(let d of a.g.values())u=u.concat(d.D);return u}return N(a.i)}function Ly(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var u=[],d=a.length,m=0;m<d;m++)u.push(a[m]);return u}u=[],d=0;for(m in a)u[d++]=a[m];return u}function $y(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var u=[];a=a.length;for(var d=0;d<a;d++)u.push(d);return u}u=[],d=0;for(let m in a)u[d++]=m;return u}}}function Mp(a,u){if(a.forEach&&typeof a.forEach=="function")a.forEach(u,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,u,void 0);else for(var d=$y(a),m=Ly(a),I=m.length,A=0;A<I;A++)u.call(void 0,m[A],d&&d[A],a)}var Np=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zy(a,u){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),I=null;if(0<=m){var A=a[d].substring(0,m);I=a[d].substring(m+1)}else A=a[d];u(A,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function ai(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ai){this.h=a.h,Cs(this,a.j),this.o=a.o,this.g=a.g,xs(this,a.s),this.l=a.l;var u=a.i,d=new oo;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),Fp(this,d),this.m=a.m}else a&&(u=String(a).match(Np))?(this.h=!1,Cs(this,u[1]||"",!0),this.o=io(u[2]||""),this.g=io(u[3]||"",!0),xs(this,u[4]),this.l=io(u[5]||"",!0),Fp(this,u[6]||"",!0),this.m=io(u[7]||"")):(this.h=!1,this.i=new oo(null,this.h))}ai.prototype.toString=function(){var a=[],u=this.j;u&&a.push(ro(u,Lp,!0),":");var d=this.g;return(d||u=="file")&&(a.push("//"),(u=this.o)&&a.push(ro(u,Lp,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(ro(d,d.charAt(0)=="/"?Uy:qy,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",ro(d,jy)),a.join("")};function dn(a){return new ai(a)}function Cs(a,u,d){a.j=d?io(u,!0):u,a.j&&(a.j=a.j.replace(/:$/,""))}function xs(a,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);a.s=u}else a.s=null}function Fp(a,u,d){u instanceof oo?(a.i=u,Ky(a.i,a.h)):(d||(u=ro(u,Gy)),a.i=new oo(u,a.h))}function Te(a,u,d){a.i.set(u,d)}function As(a){return Te(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function io(a,u){return a?u?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ro(a,u,d){return typeof a=="string"?(a=encodeURI(a).replace(u,By),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function By(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Lp=/[#\/\?@]/g,qy=/[#\?:]/g,Uy=/[#\?]/g,Gy=/[#\?@]/g,jy=/#/g;function oo(a,u){this.h=this.g=null,this.i=a||null,this.j=!!u}function Dn(a){a.g||(a.g=new Map,a.h=0,a.i&&zy(a.i,function(u,d){a.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}n=oo.prototype,n.add=function(a,u){Dn(this),this.i=null,a=Ui(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(u),this.h+=1,this};function $p(a,u){Dn(a),u=Ui(a,u),a.g.has(u)&&(a.i=null,a.h-=a.g.get(u).length,a.g.delete(u))}function zp(a,u){return Dn(a),u=Ui(a,u),a.g.has(u)}n.forEach=function(a,u){Dn(this),this.g.forEach(function(d,m){d.forEach(function(I){a.call(u,I,m,this)},this)},this)},n.na=function(){Dn(this);let a=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let m=0;m<u.length;m++){let I=a[m];for(let A=0;A<I.length;A++)d.push(u[m])}return d},n.V=function(a){Dn(this);let u=[];if(typeof a=="string")zp(this,a)&&(u=u.concat(this.g.get(Ui(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)u=u.concat(a[d])}return u},n.set=function(a,u){return Dn(this),this.i=null,a=Ui(this,a),zp(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[u]),this.h+=1,this},n.get=function(a,u){return a?(a=this.V(a),0<a.length?String(a[0]):u):u};function Bp(a,u,d){$p(a,u),0<d.length&&(a.i=null,a.g.set(Ui(a,u),N(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var m=u[d];let A=encodeURIComponent(String(m)),L=this.V(m);for(m=0;m<L.length;m++){var I=A;L[m]!==""&&(I+="="+encodeURIComponent(String(L[m]))),a.push(I)}}return this.i=a.join("&")};function Ui(a,u){return u=String(u),a.j&&(u=u.toLowerCase()),u}function Ky(a,u){u&&!a.j&&(Dn(a),a.i=null,a.g.forEach(function(d,m){var I=m.toLowerCase();m!=I&&($p(this,m),Bp(this,I,d))},a)),a.j=u}function Hy(a,u){let d=new to;if(l.Image){let m=new Image;m.onload=E(Rn,d,"TestLoadImage: loaded",!0,u,m),m.onerror=E(Rn,d,"TestLoadImage: error",!1,u,m),m.onabort=E(Rn,d,"TestLoadImage: abort",!1,u,m),m.ontimeout=E(Rn,d,"TestLoadImage: timeout",!1,u,m),l.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else u(!1)}function Qy(a,u){let d=new to,m=new AbortController,I=setTimeout(()=>{m.abort(),Rn(d,"TestPingServer: timeout",!1,u)},1e4);fetch(a,{signal:m.signal}).then(A=>{clearTimeout(I),A.ok?Rn(d,"TestPingServer: ok",!0,u):Rn(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(I),Rn(d,"TestPingServer: error",!1,u)})}function Rn(a,u,d,m,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),m(d)}catch{}}function Wy(){this.g=new Dy}function Jy(a,u,d){let m=d||"";try{Mp(a,function(I,A){let L=I;h(I)&&(L=cc(I)),u.push(m+A+"="+encodeURIComponent(L))})}catch(I){throw u.push(m+"type="+encodeURIComponent("_badmap")),I}}function so(a){this.l=a.Ub||null,this.j=a.eb||!1}O(so,uc),so.prototype.g=function(){return new Ss(this.l,this.j)},so.prototype.i=function(a){return function(){return a}}({});function Ss(a,u){ot.call(this),this.D=a,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}O(Ss,ot),n=Ss.prototype,n.open=function(a,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=u,this.readyState=1,lo(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(u.body=a),(this.D||l).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,lo(this)),this.g&&(this.readyState=3,lo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qp(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function qp(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var u=a.value?a.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!a.done}))&&(this.response=this.responseText+=u)}a.done?ao(this):lo(this),this.readyState==3&&qp(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,ao(this))},n.Qa=function(a){this.g&&(this.response=a,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(a){a.readyState=4,a.l=null,a.j=null,a.v=null,lo(a)}n.setRequestHeader=function(a,u){this.u.append(a,u)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=u.next();return a.join(`\r
`)};function lo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Up(a){let u="";return te(a,function(d,m){u+=m,u+=":",u+=d,u+=`\r
`}),u}function vc(a,u,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=Up(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):Te(a,u,d))}function Re(a){ot.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}O(Re,ot);var Xy=/^https?$/i,Yy=["POST","PUT"];n=Re.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,u,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);u=u?u.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():pc.g(),this.v=this.o?yp(this.o):yp(pc),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(u,String(a),!0),this.B=!1}catch(A){Gp(this,A);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var I in m)d.set(I,m[I]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let A of m.keys())d.set(A,m.get(A));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(A=>A.toLowerCase()=="content-type"),I=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Yy,u,void 0))||m||I||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,L]of d)this.g.setRequestHeader(A,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Hp(this),this.u=!0,this.g.send(a),this.u=!1}catch(A){Gp(this,A)}};function Gp(a,u){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=u,a.m=5,jp(a),Ps(a)}function jp(a){a.A||(a.A=!0,pt(a,"complete"),pt(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,pt(this,"complete"),pt(this,"abort"),Ps(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ps(this,!0)),Re.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Kp(this):this.bb())},n.bb=function(){Kp(this)};function Kp(a){if(a.h&&typeof s<"u"&&(!a.v[1]||pn(a)!=4||a.Z()!=2)){if(a.u&&pn(a)==4)mp(a.Ea,0,a);else if(pt(a,"readystatechange"),pn(a)==4){a.h=!1;try{let L=a.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var m;if(m=L===0){var I=String(a.D).match(Np)[1]||null;!I&&l.self&&l.self.location&&(I=l.self.location.protocol.slice(0,-1)),m=!Xy.test(I?I.toLowerCase():"")}d=m}if(d)pt(a,"complete"),pt(a,"success");else{a.m=6;try{var A=2<pn(a)?a.g.statusText:""}catch{A=""}a.l=A+" ["+a.Z()+"]",jp(a)}}finally{Ps(a)}}}}function Ps(a,u){if(a.g){Hp(a);let d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,u||pt(a,"ready");try{d.onreadystatechange=m}catch{}}}function Hp(a){a.I&&(l.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function pn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<pn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var u=this.g.responseText;return a&&u.indexOf(a)==0&&(u=u.substring(a.length)),ky(u)}};function Qp(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Zy(a){let u={};a=(a.g&&2<=pn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(W(a[m]))continue;var d=T(a[m]);let I=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let A=u[I]||[];u[I]=A,A.push(d)}v(u,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(a,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||u}function Wp(a){this.Aa=0,this.i=[],this.j=new to,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=co("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=co("baseRetryDelayMs",5e3,a),this.cb=co("retryDelaySeedMs",1e4,a),this.Wa=co("forwardChannelMaxRetries",2,a),this.wa=co("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new kp(a&&a.concurrentRequestLimit),this.Da=new Wy,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Wp.prototype,n.la=8,n.G=1,n.connect=function(a,u,d,m){mt(0),this.W=a,this.H=u||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=rm(this,null,this.W),Ds(this)};function wc(a){if(Jp(a),a.G==3){var u=a.U++,d=dn(a.I);if(Te(d,"SID",a.K),Te(d,"RID",u),Te(d,"TYPE","terminate"),uo(a,d),u=new kn(a,a.j,u),u.L=2,u.v=As(dn(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=u.v,d=!0),d||(u.g=om(u.j,null),u.g.ea(u.v)),u.F=Date.now(),Es(u)}im(a)}function ks(a){a.g&&(Ic(a),a.g.cancel(),a.g=null)}function Jp(a){ks(a),a.u&&(l.clearTimeout(a.u),a.u=null),Rs(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Ds(a){if(!Dp(a.h)&&!a.s){a.s=!0;var u=a.Ga;Hr||lp(),Qr||(Hr(),Qr=!0),ec.add(u,a),a.B=0}}function eb(a,u){return Rp(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=u.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=eo(_(a.Ga,a,u),nm(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let I=new kn(this,this.j,a),A=this.o;if(this.S&&(A?(A=g(A),w(A,this.S)):A=this.S),this.m!==null||this.O||(I.H=A,A=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(u+=m,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=Yp(this,I,u),d=dn(this.I),Te(d,"RID",a),Te(d,"CVER",22),this.D&&Te(d,"X-HTTP-Session-Id",this.D),uo(this,d),A&&(this.O?u="headers="+encodeURIComponent(String(Up(A)))+"&"+u:this.m&&vc(d,this.m,A)),bc(this.h,I),this.Ua&&Te(d,"TYPE","init"),this.P?(Te(d,"$req",u),Te(d,"SID","null"),I.T=!0,fc(I,d,null)):fc(I,d,u),this.G=2}}else this.G==3&&(a?Xp(this,a):this.i.length==0||Dp(this.h)||Xp(this))};function Xp(a,u){var d;u?d=u.l:d=a.U++;let m=dn(a.I);Te(m,"SID",a.K),Te(m,"RID",d),Te(m,"AID",a.T),uo(a,m),a.m&&a.o&&vc(m,a.m,a.o),d=new kn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),u&&(a.i=u.D.concat(a.i)),u=Yp(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),bc(a.h,d),fc(d,m,u)}function uo(a,u){a.H&&te(a.H,function(d,m){Te(u,m,d)}),a.l&&Mp({},function(d,m){Te(u,m,d)})}function Yp(a,u,d){d=Math.min(a.i.length,d);var m=a.l?_(a.l.Na,a.l,a):null;e:{var I=a.i;let A=-1;for(;;){let L=["count="+d];A==-1?0<d?(A=I[0].g,L.push("ofs="+A)):A=0:L.push("ofs="+A);let _e=!0;for(let Xe=0;Xe<d;Xe++){let ue=I[Xe].g,st=I[Xe].map;if(ue-=A,0>ue)A=Math.max(0,I[Xe].g-100),_e=!1;else try{Jy(st,L,"req"+ue+"_")}catch{m&&m(st)}}if(_e){m=L.join("&");break e}}}return a=a.i.splice(0,d),u.D=a,m}function Zp(a){if(!a.g&&!a.u){a.Y=1;var u=a.Fa;Hr||lp(),Qr||(Hr(),Qr=!0),ec.add(u,a),a.v=0}}function Tc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=eo(_(a.Fa,a),nm(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,em(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=eo(_(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),ks(this),em(this))};function Ic(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function em(a){a.g=new kn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var u=dn(a.qa);Te(u,"RID","rpc"),Te(u,"SID",a.K),Te(u,"AID",a.T),Te(u,"CI",a.F?"0":"1"),!a.F&&a.ja&&Te(u,"TO",a.ja),Te(u,"TYPE","xmlhttp"),uo(a,u),a.m&&a.o&&vc(u,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=As(dn(u)),d.m=null,d.P=!0,Ap(d,a)}n.Za=function(){this.C!=null&&(this.C=null,ks(this),Tc(this),mt(19))};function Rs(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function tm(a,u){var d=null;if(a.g==u){Rs(a),Ic(a),a.g=null;var m=2}else if(yc(a.h,u))d=u.D,Vp(a.h,u),m=1;else return;if(a.G!=0){if(u.o)if(m==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var I=a.B;m=ws(),pt(m,new Ip(m,d)),Ds(a)}else Zp(a);else if(I=u.s,I==3||I==0&&0<u.X||!(m==1&&eb(a,u)||m==2&&Tc(a)))switch(d&&0<d.length&&(u=a.h,u.i=u.i.concat(d)),I){case 1:li(a,5);break;case 4:li(a,10);break;case 3:li(a,6);break;default:li(a,2)}}}function nm(a,u){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*u}function li(a,u){if(a.j.info("Error code "+u),u==2){var d=_(a.fb,a),m=a.Xa;let I=!m;m=new ai(m||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Cs(m,"https"),As(m),I?Hy(m.toString(),d):Qy(m.toString(),d)}else mt(2);a.G=0,a.l&&a.l.sa(u),im(a),Jp(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function im(a){if(a.G=0,a.ka=[],a.l){let u=Op(a.h);(u.length!=0||a.i.length!=0)&&(k(a.ka,u),k(a.ka,a.i),a.h.i.length=0,N(a.i),a.i.length=0),a.l.ra()}}function rm(a,u,d){var m=d instanceof ai?dn(d):new ai(d);if(m.g!="")u&&(m.g=u+"."+m.g),xs(m,m.s);else{var I=l.location;m=I.protocol,u=u?u+"."+I.hostname:I.hostname,I=+I.port;var A=new ai(null);m&&Cs(A,m),u&&(A.g=u),I&&xs(A,I),d&&(A.l=d),m=A}return d=a.D,u=a.ya,d&&u&&Te(m,d,u),Te(m,"VER",a.la),uo(a,m),m}function om(a,u,d){if(u&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=a.Ca&&!a.pa?new Re(new so({eb:d})):new Re(a.pa),u.Ha(a.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sm(){}n=sm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Vs(){}Vs.prototype.g=function(a,u){return new At(a,u)};function At(a,u){ot.call(this),this.g=new Wp(u),this.l=a,this.h=u&&u.messageUrlParams||null,a=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(a?a["X-WebChannel-Content-Type"]=u.messageContentType:a={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(a?a["X-WebChannel-Client-Profile"]=u.va:a={"X-WebChannel-Client-Profile":u.va}),this.g.S=a,(a=u&&u.Sb)&&!W(a)&&(this.g.m=a),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!W(u)&&(this.g.D=u,a=this.h,a!==null&&u in a&&(a=this.h,u in a&&delete a[u])),this.j=new Gi(this)}O(At,ot),At.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},At.prototype.close=function(){wc(this.g)},At.prototype.o=function(a){var u=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=cc(a),a=d);u.i.push(new Fy(u.Ya++,a)),u.G==3&&Ds(u)},At.prototype.N=function(){this.g.l=null,delete this.j,wc(this.g),delete this.g,At.aa.N.call(this)};function am(a){hc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var u=a.__sm__;if(u){e:{for(let d in u){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,u=u!==null&&a in u?u[a]:void 0),this.data=u}else this.data=a}O(am,hc);function lm(){dc.call(this),this.status=1}O(lm,dc);function Gi(a){this.g=a}O(Gi,sm),Gi.prototype.ua=function(){pt(this.g,"a")},Gi.prototype.ta=function(a){pt(this.g,new am(a))},Gi.prototype.sa=function(a){pt(this.g,new lm)},Gi.prototype.ra=function(){pt(this.g,"b")},Vs.prototype.createWebChannel=Vs.prototype.g,At.prototype.send=At.prototype.o,At.prototype.open=At.prototype.m,At.prototype.close=At.prototype.close,su=yn.createWebChannelTransport=function(){return new Vs},ou=yn.getStatEventTarget=function(){return ws()},ru=yn.Event=oi,Ca=yn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ts.NO_ERROR=0,Ts.TIMEOUT=8,Ts.HTTP_ERROR=6,ko=yn.ErrorCode=Ts,Ep.COMPLETE="complete",iu=yn.EventType=Ep,bp.EventType=Yr,Yr.OPEN="a",Yr.CLOSE="b",Yr.ERROR="c",Yr.MESSAGE="d",ot.prototype.listen=ot.prototype.K,or=yn.WebChannel=bp,Wv=yn.FetchXmlHttpFactory=so,Re.prototype.listenOnce=Re.prototype.L,Re.prototype.getLastError=Re.prototype.Ka,Re.prototype.getLastErrorCode=Re.prototype.Ba,Re.prototype.getStatus=Re.prototype.Z,Re.prototype.getResponseJson=Re.prototype.Oa,Re.prototype.getResponseText=Re.prototype.oa,Re.prototype.send=Re.prototype.ea,Re.prototype.setWithCredentials=Re.prototype.Ha,nu=yn.XhrIo=Re}).apply(typeof Ea<"u"?Ea:typeof self<"u"?self:typeof window<"u"?window:{});var $f="@firebase/firestore";var Ue=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ue.UNAUTHENTICATED=new Ue(null),Ue.GOOGLE_CREDENTIALS=new Ue("google-credentials-uid"),Ue.FIRST_PARTY=new Ue("first-party-uid"),Ue.MOCK_USER=new Ue("mock-user");var Nr="11.0.2";var jn=new ta("@firebase/firestore");function ur(){return jn.logLevel}function Bg(n){jn.setLogLevel(n)}function M(n,...e){if(jn.logLevel<=en.DEBUG){let t=e.map(ud);jn.debug(`Firestore (${Nr}): ${n}`,...t)}}function Me(n,...e){if(jn.logLevel<=en.ERROR){let t=e.map(ud);jn.error(`Firestore (${Nr}): ${n}`,...t)}}function Ut(n,...e){if(jn.logLevel<=en.WARN){let t=e.map(ud);jn.warn(`Firestore (${Nr}): ${n}`,...t)}}function ud(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${Nr}) INTERNAL ASSERTION FAILED: `+n;throw Me(e),new Error(e)}function j(n,e){n||U()}function qg(n,e){n||U()}function B(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Jm{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Qe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Fa=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},du=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ue.UNAUTHENTICATED))}shutdown(){}},pu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},mu=class{constructor(e){this.t=e,this.currentUser=Ue.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){j(this.o===void 0);let i=this.i,r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve(),o=new Qe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qe,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>P(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},l=c=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?l(c):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qe)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(j(typeof i.accessToken=="string"),new Fa(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return j(e===null||typeof e=="string"),new Ue(e)}},fu=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Ue.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},gu=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new fu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ue.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_u=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},yu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){j(this.o===void 0);let i=o=>{o.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,M("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};let r=o=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?r(o):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(j(typeof t.token=="string"),this.R=t.token,new _u(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Jv(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var La=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=Jv(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<t&&(i+=e.charAt(r[o]%e.length))}return i}};function Y(n,e){return n<e?-1:n>e?1:0}function br(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function Ug(n){return n+"\0"}var ke=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var K=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ke(0,0))}static max(){return new n(new ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var $a=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&U(),i===void 0?i=e.length-t:i>e.length-t&&U(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let o=e.get(r),s=t.get(r);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},se=class n extends $a{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new D(S.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},Xv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ne=class n extends $a{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return Xv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,o=()=>{if(i.length===0)throw new D(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},s=!1;for(;r<e.length;){let l=e[r];if(l==="\\"){if(r+1===e.length)throw new D(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new D(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else l==="`"?(s=!s,r++):l!=="."||s?(i+=l,r++):(o(),r++)}if(o(),s)throw new D(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var q=class n{constructor(e){this.path=e}static fromPath(e){return new n(se.fromString(e))}static fromName(e){return new n(se.fromString(e).popFirst(5))}static empty(){return new n(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new se(e.slice()))}};var vr=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};function bu(n){return n.fields.find(e=>e.kind===2)}function bi(n){return n.fields.filter(e=>e.kind!==2)}vr.UNKNOWN_ID=-1;var gr=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var qo=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ot.min())}};function Gg(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=K.fromTimestamp(i===1e9?new ke(t+1,0):new ke(t,i));return new Ot(r,q.empty(),e)}function jg(n){return new Ot(n.readTime,n.key,-1)}var Ot=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(K.min(),q.empty(),-1)}static max(){return new n(K.max(),q.empty(),-1)}};function hd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:Y(n.largestBatchId,e.largestBatchId))}var Kg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",za=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ti(n){return P(this,null,function*(){if(n.code!==S.FAILED_PRECONDITION||n.message!==Kg)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,o=0,s=!1;e.forEach(l=>{++r,l.next(()=>{++o,s&&o===r&&t()},c=>i(c))}),s=!0,o===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,o)=>{i.push(t.call(this,r,o))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let o=e.length,s=new Array(o),l=0;for(let c=0;c<o;c++){let h=c;t(e[h]).next(p=>{s[h]=p,++l,l===o&&i(s)},p=>r(p))}})}static doWhile(e,t){return new n((i,r)=>{let o=()=>{e()===!0?t().next(()=>{o()},r):i()};o()})}};var Ba=class n{static open(e,t,i,r){try{return new n(t,e.transaction(r,i))}catch(o){throw new Ci(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Qe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ci(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{let r=dd(i.target.error);this.V.reject(new Ci(e,r))}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(M("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new wu(t)}},Kn=class n{static delete(e){return M("SimpleDb","Removing database:",e),vi(window.indexedDB.deleteDatabase(e)).toPromise()}static p(){if(!ea())return!1;if(n.S())return!0;let e=vo(),t=n.D(e),i=0<t&&t<10,r=Hg(e),o=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static S(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static C(e,t){return e.store(t)}static D(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.F=i,n.D(vo())===12.2&&Me("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}M(e){return P(this,null,function*(){return this.db||(M("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=o=>{let s=o.target.result;t(s)},r.onblocked=()=>{i(new Ci(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=o=>{let s=o.target.error;s.name==="VersionError"?i(new D(S.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?i(new D(S.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):i(new Ci(e,s))},r.onupgradeneeded=o=>{M("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.F.O(s,r.transaction,o.oldVersion,this.version).next(()=>{M("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){return P(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let l=Ba.open(this.db,e,o?"readonly":"readwrite",i),c=r(l).next(h=>(l.g(),h)).catch(h=>(l.abort(h),x.reject(h))).toPromise();return c.catch(()=>{}),yield l.m,c}catch(l){let c=l,h=c.name!=="FirebaseError"&&s<3;if(M("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function Hg(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var vu=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return vi(this.B.delete())}},Ci=class extends D{constructor(e,t){super(S.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function ni(n){return n.name==="IndexedDbTransactionError"}var wu=class{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(M("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(M("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),vi(i)}add(e){return M("SimpleDb","ADD",this.store.name,e,e),vi(this.store.add(e))}get(e){return vi(this.store.get(e)).next(t=>(t===void 0&&(t=null),M("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return M("SimpleDb","DELETE",this.store.name,e),vi(this.store.delete(e))}count(){return M("SimpleDb","COUNT",this.store.name),vi(this.store.count())}U(e,t){let i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let o=r.getAll(i.range);return new x((s,l)=>{o.onerror=c=>{l(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(i),s=[];return this.W(o,(l,c)=>{s.push(c)}).next(()=>s)}}G(e,t){let i=this.store.getAll(e,t===null?void 0:t);return new x((r,o)=>{i.onerror=s=>{o(s.target.error)},i.onsuccess=s=>{r(s.target.result)}})}j(e,t){M("SimpleDb","DELETE ALL",this.store.name);let i=this.options(e,t);i.H=!1;let r=this.cursor(i);return this.W(r,(o,s,l)=>l.delete())}J(e,t){let i;t?i=e:(i={},t=e);let r=this.cursor(i);return this.W(r,t)}Y(e){let t=this.cursor({});return new x((i,r)=>{t.onerror=o=>{let s=dd(o.target.error);r(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(l=>{l?s.continue():i()}):i()}})}W(e,t){let i=[];return new x((r,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let l=s.target.result;if(!l)return void r();let c=new vu(l),h=t(l.primaryKey,l.value,c);if(h instanceof x){let p=h.catch(f=>(c.done(),x.reject(f)));i.push(p)}c.isDone?r():c.K===null?l.continue():l.continue(c.K)}}).next(()=>x.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function vi(n){return new x((e,t)=>{n.onsuccess=i=>{let r=i.target.result;e(r)},n.onerror=i=>{let r=dd(i.target.error);t(r)}})}var zf=!1;function dd(n){let e=Kn.D(vo());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let i=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zf||(zf=!0,setTimeout(()=>{throw i},0)),i}}return n}var Tu=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){M("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>P(this,null,function*(){this.task=null;try{M("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){ni(t)?M("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield ti(t)}yield this.X(6e4)}))}},Iu=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return P(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let i=new Set,r=t,o=!0;return x.doWhile(()=>o===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!i.has(s))return M("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,r).next(l=>{r-=l,i.add(s)});o=!1})).next(()=>t-r)}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(r,o)).next(l=>(M("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>s.size)}))}re(e,t){let i=e;return t.changes.forEach((r,o)=>{let s=jg(o);hd(s,i)>0&&(i=s)}),new Ot(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Pt=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function us(n){return n==null}function Uo(n){return n===0&&1/n==-1/0}function Qg(n){return typeof n=="number"&&Number.isInteger(n)&&!Uo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function dt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Bf(e)),e=Yv(n.get(t),e);return Bf(e)}function Yv(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let o=n.charAt(r);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function Bf(n){return n+""}function tn(n){let e=n.length;if(j(e>=2),e===2)return j(n.charAt(0)===""&&n.charAt(1)===""),se.emptyPath();let t=e-2,i=[],r="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&U(),n.charAt(s+1)){case"":let l=n.substring(o,s),c;r.length===0?c=l:(r+=l,c=r,r=""),i.push(c);break;case"":r+=n.substring(o,s),r+="\0";break;case"":r+=n.substring(o,s+1);break;default:U()}o=s+2}return new se(i)}var qf=["userId","batchId"];function Da(n,e){return[n,dt(e)]}function Wg(n,e,t){return[n,dt(e),t]}var Zv={},ew=["prefixPath","collectionGroup","readTime","documentId"],tw=["prefixPath","collectionGroup","documentId"],nw=["collectionGroup","readTime","prefixPath","documentId"],iw=["canonicalId","targetId"],rw=["targetId","path"],ow=["path","targetId"],sw=["collectionId","parent"],aw=["indexId","uid"],lw=["uid","sequenceNumber"],cw=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uw=["indexId","uid","orderedDocumentKey"],hw=["userId","collectionPath","documentId"],dw=["userId","collectionPath","largestBatchId"],pw=["userId","collectionGroup","largestBatchId"],Jg=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mw=[...Jg,"documentOverlays"],Xg=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Yg=Xg,pd=[...Yg,"indexConfiguration","indexState","indexEntries"],fw=pd,gw=[...pd,"globals"];var Go=class extends za{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function We(n,e){let t=B(n);return Kn.C(t._e,e)}function Uf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ii(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Zg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ce=class n{constructor(e,t){this.comparator=e,this.root=t||rn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fr(this.root,e,this.comparator,!1)}getReverseIterator(){return new fr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fr(this.root,e,this.comparator,!0)}},fr=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},rn=class n{constructor(e,t,i,r,o){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,o){return new n(e??this.key,t??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,o=i(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,i),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,i,r,o){return this}insert(e,t,i){return new rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ge=class n{constructor(e){this.comparator=e,this.data=new Ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qa(this.data.getIterator())}getIteratorFrom(e){return new qa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},qa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function sr(n){return n.hasNext()?n.getNext():void 0}var kt=class n{constructor(e){this.fields=e,e.sort(Ne.comparator)}static empty(){return new n([])}unionWith(e){let t=new ge(Ne.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return br(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var Ua=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function e_(){return typeof atob<"u"}var Le=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ua("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let o="";for(let s=0;s<r.length;++s)o+=String.fromCharCode(r[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Le.EMPTY_BYTE_STRING=new Le("");var _w=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wn(n){if(j(!!n),typeof n=="string"){let e=0,t=_w.exec(n);if(j(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Se(n.seconds),nanos:Se(n.nanos)}}function Se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Tn(n){return typeof n=="string"?Le.fromBase64String(n):Le.fromUint8Array(n)}function Ml(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Nl(n){let e=n.mapValue.fields.__previous_value__;return Ml(e)?Nl(e):e}function jo(n){let e=wn(n.mapValue.fields.__local_write_time__.timestampValue);return new ke(e.seconds,e.nanos)}var Eu=class{constructor(e,t,i,r,o,s,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}},Hn=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Un={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ra={nullValue:"NULL_VALUE"};function Qn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ml(n)?4:t_(n)?9007199254740991:Fl(n)?10:11:U()}function an(n,e){if(n===e)return!0;let t=Qn(n);if(t!==Qn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jo(n).isEqual(jo(e));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;let s=wn(r.timestampValue),l=wn(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,o){return Tn(r.bytesValue).isEqual(Tn(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,o){return Se(r.geoPointValue.latitude)===Se(o.geoPointValue.latitude)&&Se(r.geoPointValue.longitude)===Se(o.geoPointValue.longitude)}(n,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return Se(r.integerValue)===Se(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){let s=Se(r.doubleValue),l=Se(o.doubleValue);return s===l?Uo(s)===Uo(l):isNaN(s)&&isNaN(l)}return!1}(n,e);case 9:return br(n.arrayValue.values||[],e.arrayValue.values||[],an);case 10:case 11:return function(r,o){let s=r.mapValue.fields||{},l=o.mapValue.fields||{};if(Uf(s)!==Uf(l))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!an(s[c],l[c])))return!1;return!0}(n,e);default:return U()}}function Ko(n,e){return(n.values||[]).find(t=>an(t,e))!==void 0}function Wn(n,e){if(n===e)return 0;let t=Qn(n),i=Qn(e);if(t!==i)return Y(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Y(n.booleanValue,e.booleanValue);case 2:return function(o,s){let l=Se(o.integerValue||o.doubleValue),c=Se(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return Gf(n.timestampValue,e.timestampValue);case 4:return Gf(jo(n),jo(e));case 5:return Y(n.stringValue,e.stringValue);case 6:return function(o,s){let l=Tn(o),c=Tn(s);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let l=o.split("/"),c=s.split("/");for(let h=0;h<l.length&&h<c.length;h++){let p=Y(l[h],c[h]);if(p!==0)return p}return Y(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let l=Y(Se(o.latitude),Se(s.latitude));return l!==0?l:Y(Se(o.longitude),Se(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return jf(n.arrayValue,e.arrayValue);case 10:return function(o,s){var l,c,h,p;let f=o.fields||{},_=s.fields||{},E=(l=f.value)===null||l===void 0?void 0:l.arrayValue,O=(c=_.value)===null||c===void 0?void 0:c.arrayValue,N=Y(((h=E?.values)===null||h===void 0?void 0:h.length)||0,((p=O?.values)===null||p===void 0?void 0:p.length)||0);return N!==0?N:jf(E,O)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Un.mapValue&&s===Un.mapValue)return 0;if(o===Un.mapValue)return 1;if(s===Un.mapValue)return-1;let l=o.fields||{},c=Object.keys(l),h=s.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let f=0;f<c.length&&f<p.length;++f){let _=Y(c[f],p[f]);if(_!==0)return _;let E=Wn(l[c[f]],h[p[f]]);if(E!==0)return E}return Y(c.length,p.length)}(n.mapValue,e.mapValue);default:throw U()}}function Gf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Y(n,e);let t=wn(n),i=wn(e),r=Y(t.seconds,i.seconds);return r!==0?r:Y(t.nanos,i.nanos)}function jf(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let o=Wn(t[r],i[r]);if(o)return o}return Y(t.length,i.length)}function wr(n){return Cu(n)}function Cu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=wn(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Tn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let o of t.values||[])r?r=!1:i+=",",i+=Cu(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",o=!0;for(let s of i)o?o=!1:r+=",",r+=`${s}:${Cu(t.fields[s])}`;return r+"}"}(n.mapValue):U()}function Va(n){switch(Qn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Nl(n);return e?16+Va(e):16;case 5:return 2*n.stringValue.length;case 6:return Tn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,o)=>r+Va(o),0)}(n.arrayValue);case 10:case 11:return function(i){let r=0;return ii(i.fields,(o,s)=>{r+=o.length+Va(s)}),r}(n.mapValue);default:throw U()}}function xi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function xu(n){return!!n&&"integerValue"in n}function Ho(n){return!!n&&"arrayValue"in n}function Kf(n){return!!n&&"nullValue"in n}function Hf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Oa(n){return!!n&&"mapValue"in n}function Fl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Fo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ii(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Fo(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function t_(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var n_={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function yw(n){return"nullValue"in n?Ra:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xi(Hn.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Fl(n)?n_:{mapValue:{}}:U()}function bw(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xi(Hn.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?n_:"mapValue"in n?Fl(n)?{mapValue:{}}:Un:U()}function Qf(n,e){let t=Wn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Wf(n,e){let t=Wn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var ht=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Oa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fo(t)}setAll(e){let t=Ne.emptyPath(),i={},r=[];e.forEach((s,l)=>{if(!t.isImmediateParentOf(l)){let c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=l.popLast()}s?i[l.lastSegment()]=Fo(s):r.push(l.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,i,r)}delete(e){let t=this.field(e.popLast());Oa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return an(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Oa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ii(t,(r,o)=>e[r]=o);for(let r of i)delete e[r]}clone(){return new n(Fo(this.value))}};function i_(n){let e=[];return ii(n.fields,(t,i)=>{let r=new Ne([t]);if(Oa(i)){let o=i_(i.mapValue).fields;if(o.length===0)e.push(r);else for(let s of o)e.push(r.child(s))}else e.push(r)}),new kt(e)}var Ge=class n{constructor(e,t,i,r,o,s,l){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new n(e,0,K.min(),K.min(),K.min(),ht.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,K.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,K.min(),K.min(),ht.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,K.min(),K.min(),ht.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ln=class{constructor(e,t){this.position=e,this.inclusive=t}};function Jf(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let o=e[r],s=n.position[r];if(o.field.isKeyField()?i=q.comparator(q.fromName(s.referenceValue),t.key):i=Wn(s,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function Xf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!an(n.position[t],e.position[t]))return!1;return!0}var Ai=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function vw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ga=class{},re=class n extends Ga{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Pu(e,t,i):t==="array-contains"?new Ru(e,i):t==="in"?new ja(e,i):t==="not-in"?new Vu(e,i):t==="array-contains-any"?new Ou(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new ku(e,i):new Du(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Wn(t,this.value)):t!==null&&Qn(this.value)===Qn(t)&&this.matchesComparison(Wn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},pe=class n extends Ga{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Tr(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Tr(n){return n.op==="and"}function Au(n){return n.op==="or"}function md(n){return r_(n)&&Tr(n)}function r_(n){for(let e of n.filters)if(e instanceof pe)return!1;return!0}function Su(n){if(n instanceof re)return n.field.canonicalString()+n.op.toString()+wr(n.value);if(md(n))return n.filters.map(e=>Su(e)).join(",");{let e=n.filters.map(t=>Su(t)).join(",");return`${n.op}(${e})`}}function o_(n,e){return n instanceof re?function(i,r){return r instanceof re&&i.op===r.op&&i.field.isEqual(r.field)&&an(i.value,r.value)}(n,e):n instanceof pe?function(i,r){return r instanceof pe&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((o,s,l)=>o&&o_(s,r.filters[l]),!0):!1}(n,e):void U()}function s_(n,e){let t=n.filters.concat(e);return pe.create(t,n.op)}function a_(n){return n instanceof re?function(t){return`${t.field.canonicalString()} ${t.op} ${wr(t.value)}`}(n):n instanceof pe?function(t){return t.op.toString()+" {"+t.getFilters().map(a_).join(" ,")+"}"}(n):"Filter"}var Pu=class extends re{constructor(e,t,i){super(e,t,i),this.key=q.fromName(i.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},ku=class extends re{constructor(e,t){super(e,"in",t),this.keys=l_("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Du=class extends re{constructor(e,t){super(e,"not-in",t),this.keys=l_("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function l_(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>q.fromName(i.referenceValue))}var Ru=class extends re{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ho(t)&&Ko(t.arrayValue,this.value)}},ja=class extends re{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ko(this.value.arrayValue,t)}},Vu=class extends re{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ko(this.value.arrayValue,t)}},Ou=class extends re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ho(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Ko(this.value.arrayValue,i))}};var Mu=class{constructor(e,t=null,i=[],r=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=s,this.endAt=l,this.ue=null}};function Nu(n,e=null,t=[],i=[],r=null,o=null,s=null){return new Mu(n,e,t,i,r,o,s)}function Si(n){let e=B(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Su(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),us(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>wr(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>wr(i)).join(",")),e.ue=t}return e.ue}function hs(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!vw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!o_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Xf(n.startAt,e.startAt)&&Xf(n.endAt,e.endAt)}function Ka(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ha(n,e){return n.filters.filter(t=>t instanceof re&&t.field.isEqual(e))}function Yf(n,e,t){let i=Ra,r=!0;for(let o of Ha(n,e)){let s=Ra,l=!0;switch(o.op){case"<":case"<=":s=yw(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,l=!1;break;case"!=":case"not-in":s=Ra}Qf({value:i,inclusive:r},{value:s,inclusive:l})<0&&(i=s,r=l)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];Qf({value:i,inclusive:r},{value:s,inclusive:t.inclusive})<0&&(i=s,r=t.inclusive);break}}return{value:i,inclusive:r}}function Zf(n,e,t){let i=Un,r=!0;for(let o of Ha(n,e)){let s=Un,l=!0;switch(o.op){case">=":case">":s=bw(o.value),l=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,l=!1;break;case"!=":case"not-in":s=Un}Wf({value:i,inclusive:r},{value:s,inclusive:l})>0&&(i=s,r=l)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];Wf({value:i,inclusive:r},{value:s,inclusive:t.inclusive})>0&&(i=s,r=t.inclusive);break}}return{value:i,inclusive:r}}var Gt=class{constructor(e,t=null,i=[],r=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function c_(n,e,t,i,r,o,s,l){return new Gt(n,e,t,i,r,o,s,l)}function Fr(n){return new Gt(n)}function eg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function fd(n){return n.collectionGroup!==null}function _r(n){let e=B(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new ge(Ne.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Ai(o,i))}),t.has(Ne.keyField().canonicalString())||e.ce.push(new Ai(Ne.keyField(),i))}return e.ce}function gt(n){let e=B(n);return e.le||(e.le=ww(e,_r(n))),e.le}function ww(n,e){if(n.limitType==="F")return Nu(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let o=r.dir==="desc"?"asc":"desc";return new Ai(r.field,o)});let t=n.endAt?new ln(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ln(n.startAt.position,n.startAt.inclusive):null;return Nu(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Fu(n,e){let t=n.filters.concat([e]);return new Gt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Qa(n,e,t){return new Gt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ds(n,e){return hs(gt(n),gt(e))&&n.limitType===e.limitType}function u_(n){return`${Si(gt(n))}|lt:${n.limitType}`}function hr(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>a_(r)).join(", ")}]`),us(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>wr(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>wr(r)).join(",")),`Target(${i})`}(gt(n))}; limitType=${n.limitType})`}function ps(n,e){return e.isFoundDocument()&&function(i,r){let o=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):q.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,e)&&function(i,r){for(let o of _r(i))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let o of i.filters)if(!o.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(s,l,c){let h=Jf(s,l,c);return s.inclusive?h<=0:h<0}(i.startAt,_r(i),r)||i.endAt&&!function(s,l,c){let h=Jf(s,l,c);return s.inclusive?h>=0:h>0}(i.endAt,_r(i),r))}(n,e)}function h_(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function d_(n){return(e,t)=>{let i=!1;for(let r of _r(n)){let o=Tw(r,e,t);if(o!==0)return o;i=i||r.field.isKeyField()}return 0}}function Tw(n,e,t){let i=n.field.isKeyField()?q.comparator(e.key,t.key):function(o,s,l){let c=s.data.field(o),h=l.data.field(o);return c!==null&&h!==null?Wn(c,h):U()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return U()}}var jt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,o]of i)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ii(this.inner,(t,i)=>{for(let[r,o]of i)e(r,o)})}isEmpty(){return Zg(this.inner)}size(){return this.innerSize}};var Iw=new Ce(q.comparator);function xt(){return Iw}var p_=new Ce(q.comparator);function Mo(...n){let e=p_;for(let t of n)e=e.insert(t.key,t);return e}function m_(n){let e=p_;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function nn(){return Lo()}function f_(){return Lo()}function Lo(){return new jt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Ew=new Ce(q.comparator),Cw=new ge(q.comparator);function ie(...n){let e=Cw;for(let t of n)e=e.add(t);return e}var xw=new ge(Y);function gd(){return xw}function _d(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uo(e)?"-0":e}}function g_(n){return{integerValue:""+n}}function __(n,e){return Qg(e)?g_(e):_d(n,e)}var Ir=class{constructor(){this._=void 0}};function Aw(n,e,t){return n instanceof Jn?function(r,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Ml(o)&&(o=Nl(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof In?b_(n,e):n instanceof En?v_(n,e):function(r,o){let s=y_(r,o),l=tg(s)+tg(r.Pe);return xu(s)&&xu(r.Pe)?g_(l):_d(r.serializer,l)}(n,e)}function Sw(n,e,t){return n instanceof In?b_(n,e):n instanceof En?v_(n,e):t}function y_(n,e){return n instanceof Xn?function(i){return xu(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}var Jn=class extends Ir{},In=class extends Ir{constructor(e){super(),this.elements=e}};function b_(n,e){let t=w_(e);for(let i of n.elements)t.some(r=>an(r,i))||t.push(i);return{arrayValue:{values:t}}}var En=class extends Ir{constructor(e){super(),this.elements=e}};function v_(n,e){let t=w_(e);for(let i of n.elements)t=t.filter(r=>!an(r,i));return{arrayValue:{values:t}}}var Xn=class extends Ir{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function tg(n){return Se(n.integerValue||n.doubleValue)}function w_(n){return Ho(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Pi=class{constructor(e,t){this.field=e,this.transform=t}};function Pw(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof In&&r instanceof In||i instanceof En&&r instanceof En?br(i.elements,r.elements,an):i instanceof Xn&&r instanceof Xn?an(i.Pe,r.Pe):i instanceof Jn&&r instanceof Jn}(n.transform,e.transform)}var Lu=class{constructor(e,t){this.version=e,this.transformResults=t}},Ve=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ma(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Er=class{};function T_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zn(n.key,Ve.none()):new Yn(n.key,n.data,Ve.none());{let t=n.data,i=ht.empty(),r=new ge(Ne.comparator);for(let o of e.fields)if(!r.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?i.delete(o):i.set(o,s),r=r.add(o)}return new Kt(n.key,i,new kt(r.toArray()),Ve.none())}}function kw(n,e,t){n instanceof Yn?function(r,o,s){let l=r.value.clone(),c=ig(r.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Kt?function(r,o,s){if(!Ma(r.precondition,o))return void o.convertToUnknownDocument(s.version);let l=ig(r.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(I_(r)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function $o(n,e,t,i){return n instanceof Yn?function(o,s,l,c){if(!Ma(o.precondition,s))return l;let h=o.value.clone(),p=rg(o.fieldTransforms,c,s);return h.setAll(p),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),null}(n,e,t,i):n instanceof Kt?function(o,s,l,c){if(!Ma(o.precondition,s))return l;let h=rg(o.fieldTransforms,c,s),p=s.data;return p.setAll(I_(o)),p.setAll(h),s.convertToFoundDocument(s.version,p).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,i):function(o,s,l){return Ma(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(n,e,t)}function Dw(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),o=y_(i.transform,r||null);o!=null&&(t===null&&(t=ht.empty()),t.set(i.field,o))}return t||null}function ng(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&br(i,r,(o,s)=>Pw(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Yn=class extends Er{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Kt=class extends Er{constructor(e,t,i,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function I_(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function ig(n,e,t){let i=new Map;j(n.length===t.length);for(let r=0;r<t.length;r++){let o=n[r],s=o.transform,l=e.data.field(o.field);i.set(o.field,Sw(s,l,t[r]))}return i}function rg(n,e,t){let i=new Map;for(let r of n){let o=r.transform,s=t.data.field(r.field);i.set(r.field,Aw(o,s,e))}return i}var Zn=class extends Er{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Qo=class extends Er{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Wo=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let o=this.mutations[r];o.key.isEqual(e.key)&&kw(o,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=$o(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=$o(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=f_();return this.mutations.forEach(r=>{let o=e.get(r.key),s=o.overlayedDocument,l=this.applyToLocalView(s,o.mutatedFields);l=t.has(r.key)?null:l;let c=T_(s,l);c!==null&&i.set(r.key,c),s.isValidDocument()||s.convertToNoDocument(K.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&br(this.mutations,e.mutations,(t,i)=>ng(t,i))&&br(this.baseMutations,e.baseMutations,(t,i)=>ng(t,i))}},$u=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){j(e.mutations.length===i.length);let r=function(){return Ew}(),o=e.mutations;for(let s=0;s<o.length;s++)r=r.insert(o[s].key,i[s].version);return new n(e,t,i,r)}};var Jo=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var zu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Be,oe;function E_(n){switch(n){default:return U();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0}}function C_(n){if(n===void 0)return Me("GRPC error has no .code"),S.UNKNOWN;switch(n){case Be.OK:return S.OK;case Be.CANCELLED:return S.CANCELLED;case Be.UNKNOWN:return S.UNKNOWN;case Be.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case Be.INTERNAL:return S.INTERNAL;case Be.UNAVAILABLE:return S.UNAVAILABLE;case Be.UNAUTHENTICATED:return S.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case Be.NOT_FOUND:return S.NOT_FOUND;case Be.ALREADY_EXISTS:return S.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return S.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case Be.ABORTED:return S.ABORTED;case Be.OUT_OF_RANGE:return S.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return S.UNIMPLEMENTED;case Be.DATA_LOSS:return S.DATA_LOSS;default:return U()}}(oe=Be||(Be={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var og=null;function x_(){return new TextEncoder}var Rw=new Ln([4294967295,4294967295],0);function sg(n){let e=x_().encode(n),t=new tu;return t.update(e),new Uint8Array(t.digest())}function ag(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ln([t,i],0),new Ln([r,o],0)]}var Bu=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ei(`Invalid padding: ${t}`);if(i<0)throw new Ei(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ei(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ei(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Ln.fromNumber(this.Te)}Ee(e,t,i){let r=e.add(t.multiply(Ln.fromNumber(i)));return r.compare(Rw)===1&&(r=new Ln([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=sg(e),[i,r]=ag(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(i,r,o);if(!this.de(s))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,r,t);return i.forEach(l=>s.insert(l)),s}insert(e){if(this.Te===0)return;let t=sg(e),[i,r]=ag(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(i,r,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Ei=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Xo=class n{constructor(e,t,i,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Yo.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(K.min(),r,new Ce(Y),xt(),ie())}},Yo=class n{constructor(e,t,i,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,ie(),ie(),ie())}};var yr=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},Wa=class{constructor(e,t){this.targetId=e,this.me=t}},Ja=class{constructor(e,t,i=Le.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Xa=class{constructor(){this.fe=0,this.ge=lg(),this.pe=Le.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ie(),t=ie(),i=ie();return this.ge.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:U()}}),new Yo(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=lg()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,j(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},qu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=xt(),this.qe=xa(),this.Qe=xa(),this.Ke=new Ce(Y)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.je(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.De(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.je(r)&&t(r)})}Je(e){let t=e.targetId,i=e.me.count,r=this.Ye(t);if(r){let o=r.target;if(Ka(o))if(i===0){let s=new q(o.path);this.We(t,s,Ge.newNoDocument(s,K.min()))}else j(i===1);else{let s=this.Ze(t);if(s!==i){let l=this.Xe(e),c=l?this.et(l,e,s):1;if(c!==0){this.He(t);let h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,h)}og?.tt(function(p,f,_,E,O){var N,k,H,W,z,J;let ee={localCacheCount:p,existenceFilterCount:f.count,databaseId:_.database,projectId:_.projectId},te=f.unchangedNames;return te&&(ee.bloomFilter={applied:O===0,hashCount:(N=te?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(W=(H=(k=te?.bits)===null||k===void 0?void 0:k.bitmap)===null||H===void 0?void 0:H.length)!==null&&W!==void 0?W:0,padding:(J=(z=te?.bits)===null||z===void 0?void 0:z.padding)!==null&&J!==void 0?J:0,mightContain:v=>{var g;return(g=E?.mightContain(v))!==null&&g!==void 0&&g}}),ee}(s,e.me,this.Le.nt(),l,c))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=t,s,l;try{s=Tn(i).toUint8Array()}catch(c){if(c instanceof Ua)return Ut("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Bu(s,r,o)}catch(c){return Ut(c instanceof Ei?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Te===0?null:l}et(e,t,i){return t.me.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(o=>{let s=this.Le.nt(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.We(t,o,null),r++)}),r}it(e){let t=new Map;this.Be.forEach((o,s)=>{let l=this.Ye(s);if(l){if(o.current&&Ka(l.target)){let c=new q(l.target.path);this.st(c).has(s)||this.ot(s,c)||this.We(s,c,Ge.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let i=ie();this.Qe.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{let h=this.Ye(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(i=i.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let r=new Xo(e,t,this.Ke,this.ke,i);return this.ke=xt(),this.qe=xa(),this.Qe=xa(),this.Ke=new Ce(Y),r}Ue(e,t){if(!this.je(e))return;let i=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,i){if(!this.je(e))return;let r=this.ze(e);this.ot(e,t)?r.Fe(t,1):r.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Be.get(e);return t||(t=new Xa,this.Be.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new ge(Y),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ge(Y),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new Xa),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function xa(){return new Ce(q.comparator)}function lg(){return new Ce(q.comparator)}var Vw={asc:"ASCENDING",desc:"DESCENDING"},Ow={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mw={and:"AND",or:"OR"},Uu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Gu(n,e){return n.useProto3Json||us(e)?e:{value:e}}function Cr(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Nw(n,e){return Cr(n,e.toTimestamp())}function Fe(n){return j(!!n),K.fromTimestamp(function(t){let i=wn(t);return new ke(i.seconds,i.nanos)}(n))}function yd(n,e){return ju(n,e).canonicalString()}function ju(n,e){let t=function(r){return new se(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function S_(n){let e=se.fromString(n);return j(L_(e)),e}function Zo(n,e){return yd(n.databaseId,e.path)}function on(n,e){let t=S_(e);if(t.get(1)!==n.databaseId.projectId)throw new D(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(D_(t))}function P_(n,e){return yd(n.databaseId,e)}function k_(n){let e=S_(n);return e.length===4?se.emptyPath():D_(e)}function Ku(n){return new se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D_(n){return j(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function cg(n,e,t){return{name:Zo(n,e),fields:t.value.mapValue.fields}}function R_(n,e,t){let i=on(n,e.name),r=Fe(e.updateTime),o=e.createTime?Fe(e.createTime):K.min(),s=new ht({mapValue:{fields:e.fields}}),l=Ge.newFoundDocument(i,r,o,s);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Fw(n,e){return"found"in e?function(i,r){j(!!r.found),r.found.name,r.found.updateTime;let o=on(i,r.found.name),s=Fe(r.found.updateTime),l=r.found.createTime?Fe(r.found.createTime):K.min(),c=new ht({mapValue:{fields:r.found.fields}});return Ge.newFoundDocument(o,s,l,c)}(n,e):"missing"in e?function(i,r){j(!!r.missing),j(!!r.readTime);let o=on(i,r.missing),s=Fe(r.readTime);return Ge.newNoDocument(o,s)}(n,e):U()}function Lw(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=function(h,p){return h.useProto3Json?(j(p===void 0||typeof p=="string"),Le.fromBase64String(p||"")):(j(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Le.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(h){let p=h.code===void 0?S.UNKNOWN:C_(h.code);return new D(p,h.message||"")}(s);t=new Ja(i,r,o,l||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=on(n,i.document.name),o=Fe(i.document.updateTime),s=i.document.createTime?Fe(i.document.createTime):K.min(),l=new ht({mapValue:{fields:i.document.fields}}),c=Ge.newFoundDocument(r,o,s,l),h=i.targetIds||[],p=i.removedTargetIds||[];t=new yr(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=on(n,i.document),o=i.readTime?Fe(i.readTime):K.min(),s=Ge.newNoDocument(r,o),l=i.removedTargetIds||[];t=new yr([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=on(n,i.document),o=i.removedTargetIds||[];t=new yr([],o,r,null)}else{if(!("filter"in e))return U();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:o}=i,s=new zu(r,o),l=i.targetId;t=new Wa(l,s)}}return t}function es(n,e){let t;if(e instanceof Yn)t={update:cg(n,e.key,e.value)};else if(e instanceof Zn)t={delete:Zo(n,e.key)};else if(e instanceof Kt)t={update:cg(n,e.key,e.data),updateMask:Gw(e.fieldMask)};else{if(!(e instanceof Qo))return U();t={verify:Zo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(o,s){let l=s.transform;if(l instanceof Jn)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof In)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof En)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xn)return{fieldPath:s.field.canonicalString(),increment:l.Pe};throw U()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:Nw(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:U()}(n,e.precondition)),t}function Hu(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Ve.updateTime(Fe(o.updateTime)):o.exists!==void 0?Ve.exists(o.exists):Ve.none()}(e.currentDocument):Ve.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,l){let c=null;if("setToServerValue"in l)j(l.setToServerValue==="REQUEST_TIME"),c=new Jn;else if("appendMissingElements"in l){let p=l.appendMissingElements.values||[];c=new In(p)}else if("removeAllFromArray"in l){let p=l.removeAllFromArray.values||[];c=new En(p)}else"increment"in l?c=new Xn(s,l.increment):U();let h=Ne.fromServerFormat(l.fieldPath);return new Pi(h,c)}(n,r)):[];if(e.update){e.update.name;let r=on(n,e.update.name),o=new ht({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let h=c.fieldPaths||[];return new kt(h.map(p=>Ne.fromServerFormat(p)))}(e.updateMask);return new Kt(r,o,s,t,i)}return new Yn(r,o,t,i)}if(e.delete){let r=on(n,e.delete);return new Zn(r,t)}if(e.verify){let r=on(n,e.verify);return new Qo(r,t)}return U()}function $w(n,e){return n&&n.length>0?(j(e!==void 0),n.map(t=>function(r,o){let s=r.updateTime?Fe(r.updateTime):Fe(o);return s.isEqual(K.min())&&(s=Fe(o)),new Lu(s,r.transformResults||[])}(t,e))):[]}function V_(n,e){return{documents:[P_(n,e.path)]}}function O_(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=P_(n,r);let o=function(h){if(h.length!==0)return F_(pe.create(h,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:dr(_.field),direction:Bw(_.dir)}}(p))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let l=Gu(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ct:t,parent:r}}function M_(n){let e=k_(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){j(i===1);let p=t.from[0];p.allDescendants?r=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(f){let _=N_(f);return _ instanceof pe&&md(_)?_.getFilters():[_]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(_=>function(O){return new Ai(pr(O.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(O.direction))}(_))}(t.orderBy));let l=null;t.limit&&(l=function(f){let _;return _=typeof f=="object"?f.value:f,us(_)?null:_}(t.limit));let c=null;t.startAt&&(c=function(f){let _=!!f.before,E=f.values||[];return new ln(E,_)}(t.startAt));let h=null;return t.endAt&&(h=function(f){let _=!f.before,E=f.values||[];return new ln(E,_)}(t.endAt)),c_(e,r,s,o,l,"F",c,h)}function zw(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function N_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=pr(t.unaryFilter.field);return re.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=pr(t.unaryFilter.field);return re.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=pr(t.unaryFilter.field);return re.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=pr(t.unaryFilter.field);return re.create(s,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(n):n.fieldFilter!==void 0?function(t){return re.create(pr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pe.create(t.compositeFilter.filters.map(i=>N_(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return U()}}(t.compositeFilter.op))}(n):U()}function Bw(n){return Vw[n]}function qw(n){return Ow[n]}function Uw(n){return Mw[n]}function dr(n){return{fieldPath:n.canonicalString()}}function pr(n){return Ne.fromServerFormat(n.fieldPath)}function F_(n){return n instanceof re?function(t){if(t.op==="=="){if(Hf(t.value))return{unaryFilter:{field:dr(t.field),op:"IS_NAN"}};if(Kf(t.value))return{unaryFilter:{field:dr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hf(t.value))return{unaryFilter:{field:dr(t.field),op:"IS_NOT_NAN"}};if(Kf(t.value))return{unaryFilter:{field:dr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dr(t.field),op:qw(t.op),value:t.value}}}(n):n instanceof pe?function(t){let i=t.getFilters().map(r=>F_(r));return i.length===1?i[0]:{compositeFilter:{op:Uw(t.op),filters:i}}}(n):U()}function Gw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function L_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var xr=class n{constructor(e,t,i,r,o=K.min(),s=K.min(),l=Le.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ya=class{constructor(e){this.ht=e}};function jw(n,e){let t;if(e.document)t=R_(n.ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let i=q.fromSegments(e.noDocument.path),r=Di(e.noDocument.readTime);t=Ge.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return U();{let i=q.fromSegments(e.unknownDocument.path),r=Di(e.unknownDocument.version);t=Ge.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(r){let o=new ke(r[0],r[1]);return K.fromTimestamp(o)}(e.readTime)),t}function ug(n,e){let t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Za(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(o,s){return{name:Zo(o,s.key),fields:s.data.value.mapValue.fields,updateTime:Cr(o,s.version.toTimestamp()),createTime:Cr(o,s.createTime.toTimestamp())}}(n.ht,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:ki(e.version)};else{if(!e.isUnknownDocument())return U();i.unknownDocument={path:t.path.toArray(),version:ki(e.version)}}return i}function Za(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ki(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Di(n){let e=new ke(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function wi(n,e){let t=(e.baseMutations||[]).map(o=>Hu(n.ht,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let l=e.mutations[o+1];s.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let i=e.mutations.map(o=>Hu(n.ht,o)),r=ke.fromMillis(e.localWriteTimeMs);return new Wo(e.batchId,r,t,i)}function No(n){let e=Di(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Di(n.lastLimboFreeSnapshotVersion):K.min(),i;return i=function(o){return o.documents!==void 0}(n.query)?function(o){return j(o.documents.length===1),gt(Fr(k_(o.documents[0])))}(n.query):function(o){return gt(M_(o))}(n.query),new xr(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Le.fromBase64String(n.resumeToken))}function $_(n,e){let t=ki(e.snapshotVersion),i=ki(e.lastLimboFreeSnapshotVersion),r;r=Ka(e.target)?V_(n.ht,e.target):O_(n.ht,e.target).ct;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Si(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function bd(n){let e=M_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Qa(e,e.limit,"L"):e}function au(n,e){return new Jo(e.largestBatchId,Hu(n.ht,e.overlayMutation))}function hg(n,e){let t=e.path.lastSegment();return[n,dt(e.path.popLast()),t]}function dg(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:ki(i.readTime),documentKey:dt(i.documentKey.path),largestBatchId:i.largestBatchId}}var Qu=class{getBundleMetadata(e,t){return pg(e).get(t).next(i=>{if(i)return function(o){return{id:o.bundleId,createTime:Di(o.createTime),version:o.version}}(i)})}saveBundleMetadata(e,t){return pg(e).put(function(r){return{bundleId:r.id,createTime:ki(Fe(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return mg(e).get(t).next(i=>{if(i)return function(o){return{name:o.name,query:bd(o.bundledQuery),readTime:Di(o.readTime)}}(i)})}saveNamedQuery(e,t){return mg(e).put(function(r){return{name:r.name,readTime:ki(Fe(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function pg(n){return We(n,"bundles")}function mg(n){return We(n,"namedQueries")}var el=class n{constructor(e,t){this.serializer=e,this.userId=t}static Pt(e,t){let i=t.uid||"";return new n(e,i)}getOverlay(e,t){return Do(e).get(hg(this.userId,t)).next(i=>i?au(this.serializer,i):null)}getOverlays(e,t){let i=nn();return x.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){let r=[];return i.forEach((o,s)=>{let l=new Jo(t,s);r.push(this.Tt(e,l))}),x.waitFor(r)}removeOverlaysForBatchId(e,t,i){let r=new Set;t.forEach(s=>r.add(dt(s.getCollectionPath())));let o=[];return r.forEach(s=>{let l=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,i+1],!1,!0);o.push(Do(e).j("collectionPathOverlayIndex",l))}),x.waitFor(o)}getOverlaysForCollection(e,t,i){let r=nn(),o=dt(t),s=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Do(e).U("collectionPathOverlayIndex",s).next(l=>{for(let c of l){let h=au(this.serializer,c);r.set(h.getKey(),h)}return r})}getOverlaysForCollectionGroup(e,t,i,r){let o=nn(),s,l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Do(e).J({index:"collectionGroupOverlayIndex",range:l},(c,h,p)=>{let f=au(this.serializer,h);o.size()<r||f.largestBatchId===s?(o.set(f.getKey(),f),s=f.largestBatchId):p.done()}).next(()=>o)}Tt(e,t){return Do(e).put(function(r,o,s){let[l,c,h]=hg(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:h,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:es(r.ht,s.mutation)}}(this.serializer,this.userId,t))}};function Do(n){return We(n,"documentOverlays")}var Wu=class{It(e){return We(e,"globals")}getSessionToken(e){return this.It(e).get("sessionToken").next(t=>{let i=t?.value;return i?Le.fromUint8Array(i):Le.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.It(e).put({name:"sessionToken",value:t.toUint8Array()})}};var bn=class{constructor(){}Et(e,t){this.dt(e,t),t.At()}dt(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(Se(e.integerValue));else if("doubleValue"in e){let i=Se(e.doubleValue);isNaN(i)?this.Rt(t,13):(this.Rt(t,15),Uo(i)?t.Vt(0):t.Vt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Rt(t,20),typeof i=="string"&&(i=wn(i)),t.ft(`${i.seconds||""}`),t.Vt(i.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(Tn(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.Rt(t,45),t.Vt(i.latitude||0),t.Vt(i.longitude||0)}else"mapValue"in e?t_(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):Fl(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):U()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let i=e.fields||{};this.Rt(t,55);for(let r of Object.keys(i))this.gt(r,t),this.dt(i[r],t)}bt(e,t){var i,r;let o=e.fields||{};this.Rt(t,53);let s="value",l=((r=(i=o[s].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.Rt(t,15),t.Vt(Se(l)),this.gt(s,t),this.dt(o[s],t)}vt(e,t){let i=e.values||[];this.Rt(t,50);for(let r of i)this.dt(r,t)}St(e,t){this.Rt(t,37),q.fromName(e).path.forEach(i=>{this.Rt(t,60),this.Ct(i,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};bn.Ft=new bn;function Kw(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function fg(n){let e=64-function(i){let r=0;for(let o=0;o<8;++o){let s=Kw(255&i[o]);if(r+=s,s!==8)break}return r}(n);return Math.ceil(e/8)}var Ju=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Mt(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.xt(i.value),i=t.next();this.Ot()}Nt(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.Lt(i.value),i=t.next();this.Bt()}kt(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.xt(i);else if(i<2048)this.xt(960|i>>>6),this.xt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.xt(480|i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i);else{let r=t.codePointAt(0);this.xt(240|r>>>18),this.xt(128|63&r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r)}}this.Ot()}qt(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.Lt(i);else if(i<2048)this.Lt(960|i>>>6),this.Lt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Lt(480|i>>>12),this.Lt(128|63&i>>>6),this.Lt(128|63&i);else{let r=t.codePointAt(0);this.Lt(240|r>>>18),this.Lt(128|63&r>>>12),this.Lt(128|63&r>>>6),this.Lt(128|63&r)}}this.Bt()}Qt(e){let t=this.Kt(e),i=fg(t);this.$t(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Ut(e){let t=this.Kt(e),i=fg(t);this.$t(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Wt(){this.Gt(255),this.Gt(255)}zt(){this.jt(255),this.jt(255)}reset(){this.position=0}seed(e){this.$t(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ht(){return this.buffer.slice(0,this.position)}Kt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}xt(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Lt(e){let t=255&e;t===0?(this.jt(0),this.jt(255)):t===255?(this.jt(255),this.jt(0)):this.jt(e)}Ot(){this.Gt(0),this.Gt(1)}Bt(){this.jt(0),this.jt(1)}Gt(e){this.$t(1),this.buffer[this.position++]=e}jt(e){this.$t(1),this.buffer[this.position++]=~e}$t(e){let t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},Xu=class{constructor(e){this.Jt=e}wt(e){this.Jt.Mt(e)}ft(e){this.Jt.kt(e)}Vt(e){this.Jt.Qt(e)}At(){this.Jt.Wt()}},Yu=class{constructor(e){this.Jt=e}wt(e){this.Jt.Nt(e)}ft(e){this.Jt.qt(e)}Vt(e){this.Jt.Ut(e)}At(){this.Jt.zt()}},Ti=class{constructor(){this.Jt=new Ju,this.Yt=new Xu(this.Jt),this.Zt=new Yu(this.Jt)}seed(e){this.Jt.seed(e)}Xt(e){return e===0?this.Yt:this.Zt}Ht(){return this.Jt.Ht()}reset(){this.Jt.reset()}};var Ii=class n{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}en(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function $n(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=gg(n.arrayValue,e.arrayValue),t!==0?t:(t=gg(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function gg(n,e){for(let t=0;t<n.length&&t<e.length;++t){let i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}var tl=class{constructor(e){this.tn=new ge((t,i)=>Ne.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.nn=e.orderBy,this.rn=[];for(let t of e.filters){let i=t;i.isInequality()?this.tn=this.tn.add(i):this.rn.push(i)}}get sn(){return this.tn.size>1}on(e){if(j(e.collectionGroup===this.collectionId),this.sn)return!1;let t=bu(e);if(t!==void 0&&!this._n(t))return!1;let i=bi(e),r=new Set,o=0,s=0;for(;o<i.length&&this._n(i[o]);++o)r=r.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.tn.size>0){let l=this.tn.getIterator().getNext();if(!r.has(l.field.canonicalString())){let c=i[o];if(!this.an(l,c)||!this.un(this.nn[s++],c))return!1}++o}for(;o<i.length;++o){let l=i[o];if(s>=this.nn.length||!this.un(this.nn[s++],l))return!1}return!0}cn(){if(this.sn)return null;let e=new ge(Ne.comparator),t=[];for(let i of this.rn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new gr(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new gr(i.field,0))}for(let i of this.nn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new gr(i.field,i.dir==="asc"?0:1)));return new vr(vr.UNKNOWN_ID,this.collectionId,t,qo.empty())}_n(e){for(let t of this.rn)if(this.an(t,e))return!0;return!1}an(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}un(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function z_(n){var e,t;if(j(n instanceof re||n instanceof pe),n instanceof re){if(n instanceof ja){let r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>re.create(n.field,"==",o)))||[];return pe.create(r,"or")}return n}let i=n.filters.map(r=>z_(r));return pe.create(i,n.op)}function Hw(n){if(n.getFilters().length===0)return[];let e=th(z_(n));return j(B_(e)),Zu(e)||eh(e)?[e]:e.getFilters()}function Zu(n){return n instanceof re}function eh(n){return n instanceof pe&&md(n)}function B_(n){return Zu(n)||eh(n)||function(t){if(t instanceof pe&&Au(t)){for(let i of t.getFilters())if(!Zu(i)&&!eh(i))return!1;return!0}return!1}(n)}function th(n){if(j(n instanceof re||n instanceof pe),n instanceof re)return n;if(n.filters.length===1)return th(n.filters[0]);let e=n.filters.map(i=>th(i)),t=pe.create(e,n.op);return t=nl(t),B_(t)?t:(j(t instanceof pe),j(Tr(t)),j(t.filters.length>1),t.filters.reduce((i,r)=>vd(i,r)))}function vd(n,e){let t;return j(n instanceof re||n instanceof pe),j(e instanceof re||e instanceof pe),t=n instanceof re?e instanceof re?function(r,o){return pe.create([r,o],"and")}(n,e):_g(n,e):e instanceof re?_g(e,n):function(r,o){if(j(r.filters.length>0&&o.filters.length>0),Tr(r)&&Tr(o))return s_(r,o.getFilters());let s=Au(r)?r:o,l=Au(r)?o:r,c=s.filters.map(h=>vd(h,l));return pe.create(c,"or")}(n,e),nl(t)}function _g(n,e){if(Tr(e))return s_(e,n.getFilters());{let t=e.filters.map(i=>vd(n,i));return pe.create(t,"or")}}function nl(n){if(j(n instanceof re||n instanceof pe),n instanceof re)return n;let e=n.getFilters();if(e.length===1)return nl(e[0]);if(r_(n))return n;let t=e.map(r=>nl(r)),i=[];return t.forEach(r=>{r instanceof re?i.push(r):r instanceof pe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:pe.create(i,n.op)}var nh=class{constructor(){this.ln=new ts}addToCollectionParentIndex(e,t){return this.ln.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Ot.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Ot.min())}updateCollectionGroup(e,t,i){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},ts=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new ge(se.comparator),o=!r.has(i);return this.index[t]=r.add(i),o}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new ge(se.comparator)).toArray()}};var Aa=new Uint8Array(0),ih=class{constructor(e,t){this.databaseId=t,this.hn=new ts,this.Pn=new jt(i=>Si(i),(i,r)=>hs(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.hn.has(t)){let i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.hn.add(t)});let o={collectionId:i,parent:dt(r)};return yg(e).put(o)}return x.resolve()}getCollectionParents(e,t){let i=[],r=IDBKeyRange.bound([t,""],[Ug(t),""],!1,!0);return yg(e).U(r).next(o=>{for(let s of o){if(s.collectionId!==t)break;i.push(tn(s.parent))}return i})}addFieldIndex(e,t){let i=Ro(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete r.indexId;let o=i.add(r);if(t.indexState){let s=lr(e);return o.next(l=>{s.put(dg(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let i=Ro(e),r=lr(e),o=ar(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ro(e),i=ar(e),r=lr(e);return t.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(e,t){return x.forEach(this.Tn(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){let o=new tl(i).cn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let i=ar(e),r=!0,o=new Map;return x.forEach(this.Tn(t),s=>this.In(e,s).next(l=>{r&&(r=!!l),o.set(s,l)})).next(()=>{if(r){let s=ie(),l=[];return x.forEach(o,(c,h)=>{M("IndexedDbIndexManager",`Using index ${function(z){return`id=${z.indexId}|cg=${z.collectionGroup}|f=${z.fields.map(J=>`${J.fieldPath}:${J.kind}`).join(",")}`}(c)} to execute ${Si(t)}`);let p=function(z,J){let ee=bu(J);if(ee===void 0)return null;for(let te of Ha(z,ee.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(h,c),f=function(z,J){let ee=new Map;for(let te of bi(J))for(let v of Ha(z,te.fieldPath))switch(v.op){case"==":case"in":ee.set(te.fieldPath.canonicalString(),v.value);break;case"not-in":case"!=":return ee.set(te.fieldPath.canonicalString(),v.value),Array.from(ee.values())}return null}(h,c),_=function(z,J){let ee=[],te=!0;for(let v of bi(J)){let g=v.kind===0?Yf(z,v.fieldPath,z.startAt):Zf(z,v.fieldPath,z.startAt);ee.push(g.value),te&&(te=g.inclusive)}return new ln(ee,te)}(h,c),E=function(z,J){let ee=[],te=!0;for(let v of bi(J)){let g=v.kind===0?Zf(z,v.fieldPath,z.endAt):Yf(z,v.fieldPath,z.endAt);ee.push(g.value),te&&(te=g.inclusive)}return new ln(ee,te)}(h,c),O=this.En(c,h,_),N=this.En(c,h,E),k=this.dn(c,h,f),H=this.An(c.indexId,p,O,_.inclusive,N,E.inclusive,k);return x.forEach(H,W=>i.G(W,t.limit).next(z=>{z.forEach(J=>{let ee=q.fromSegments(J.documentKey);s.has(ee)||(s=s.add(ee),l.push(ee))})}))}).next(()=>l)}return x.resolve(null)})}Tn(e){let t=this.Pn.get(e);return t||(e.filters.length===0?t=[e]:t=Hw(pe.create(e.filters,"and")).map(i=>Nu(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.Pn.set(e,t),t)}An(e,t,i,r,o,s,l){let c=(t!=null?t.length:1)*Math.max(i.length,o.length),h=c/(t!=null?t.length:1),p=[];for(let f=0;f<c;++f){let _=t?this.Rn(t[f/h]):Aa,E=this.Vn(e,_,i[f%h],r),O=this.mn(e,_,o[f%h],s),N=l.map(k=>this.Vn(e,_,k,!0));p.push(...this.createRange(E,O,N))}return p}Vn(e,t,i,r){let o=new Ii(e,q.empty(),t,i);return r?o:o.en()}mn(e,t,i,r){let o=new Ii(e,q.empty(),t,i);return r?o.en():o}In(e,t){let i=new tl(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(o=>{let s=null;for(let l of o)i.on(l)&&(!s||l.fields.length>s.fields.length)&&(s=l);return s})}getIndexType(e,t){let i=2,r=this.Tn(t);return x.forEach(r,o=>this.In(e,o).next(s=>{s?i!==0&&s.fields.length<function(c){let h=new ge(Ne.comparator),p=!1;for(let f of c.filters)for(let _ of f.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?p=!0:h=h.add(_.field));for(let f of c.orderBy)f.field.isKeyField()||(h=h.add(f.field));return h.size+(p?1:0)}(o)&&(i=1):i=0})).next(()=>function(s){return s.limit!==null}(t)&&r.length>1&&i===2?1:i)}fn(e,t){let i=new Ti;for(let r of bi(e)){let o=t.data.field(r.fieldPath);if(o==null)return null;let s=i.Xt(r.kind);bn.Ft.Et(o,s)}return i.Ht()}Rn(e){let t=new Ti;return bn.Ft.Et(e,t.Xt(0)),t.Ht()}gn(e,t){let i=new Ti;return bn.Ft.Et(xi(this.databaseId,t),i.Xt(function(o){let s=bi(o);return s.length===0?0:s[s.length-1].kind}(e))),i.Ht()}dn(e,t,i){if(i===null)return[];let r=[];r.push(new Ti);let o=0;for(let s of bi(e)){let l=i[o++];for(let c of r)if(this.pn(t,s.fieldPath)&&Ho(l))r=this.yn(r,s,l);else{let h=c.Xt(s.kind);bn.Ft.Et(l,h)}}return this.wn(r)}En(e,t,i){return this.dn(e,t,i.position)}wn(e){let t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Ht();return t}yn(e,t,i){let r=[...e],o=[];for(let s of i.arrayValue.values||[])for(let l of r){let c=new Ti;c.seed(l.Ht()),bn.Ft.Et(s,c.Xt(t.kind)),o.push(c)}return o}pn(e,t){return!!e.filters.find(i=>i instanceof re&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){let i=Ro(e),r=lr(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next(o=>{let s=[];return x.forEach(o,l=>r.get([l.indexId,this.uid]).next(c=>{s.push(function(p,f){let _=f?new qo(f.sequenceNumber,new Ot(Di(f.readTime),new q(tn(f.documentKey)),f.largestBatchId)):qo.empty(),E=p.fields.map(([O,N])=>new gr(Ne.fromServerFormat(O),N));return new vr(p.indexId,p.collectionGroup,E,_)}(l,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{let o=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return o!==0?o:Y(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){let r=Ro(e),o=lr(e);return this.Sn(e).next(s=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>x.forEach(l,c=>o.put(dg(c.indexId,this.uid,s,i)))))}updateIndexEntries(e,t){let i=new Map;return x.forEach(t,(r,o)=>{let s=i.get(r.collectionGroup);return(s?x.resolve(s):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(i.set(r.collectionGroup,l),x.forEach(l,c=>this.bn(e,r,c).next(h=>{let p=this.Dn(o,c);return h.isEqual(p)?x.resolve():this.vn(e,o,c,h,p)}))))})}Cn(e,t,i,r){return ar(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(i,t.key),documentKey:t.key.path.toArray()})}Fn(e,t,i,r){return ar(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(i,t.key),t.key.path.toArray()])}bn(e,t,i){let r=ar(e),o=new ge($n);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.gn(i,t)])},(s,l)=>{o=o.add(new Ii(i.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>o)}Dn(e,t){let i=new ge($n),r=this.fn(t,e);if(r==null)return i;let o=bu(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Ho(s))for(let l of s.arrayValue.values||[])i=i.add(new Ii(t.indexId,e.key,this.Rn(l),r))}else i=i.add(new Ii(t.indexId,e.key,Aa,r));return i}vn(e,t,i,r,o){M("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(c,h,p,f,_){let E=c.getIterator(),O=h.getIterator(),N=sr(E),k=sr(O);for(;N||k;){let H=!1,W=!1;if(N&&k){let z=p(N,k);z<0?W=!0:z>0&&(H=!0)}else N!=null?W=!0:H=!0;H?(f(k),k=sr(O)):W?(_(N),N=sr(E)):(N=sr(E),k=sr(O))}}(r,o,$n,l=>{s.push(this.Cn(e,t,i,l))},l=>{s.push(this.Fn(e,t,i,l))}),x.waitFor(s)}Sn(e){let t=1;return lr(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,o)=>{o.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((s,l)=>$n(s,l)).filter((s,l,c)=>!l||$n(s,c[l-1])!==0);let r=[];r.push(e);for(let s of i){let l=$n(s,e),c=$n(s,t);if(l===0)r[0]=e.en();else if(l>0&&c<0)r.push(s),r.push(s.en());else if(c>0)break}r.push(t);let o=[];for(let s=0;s<r.length;s+=2){if(this.Mn(r[s],r[s+1]))return[];let l=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,Aa,[]],c=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,Aa,[]];o.push(IDBKeyRange.bound(l,c))}return o}Mn(e,t){return $n(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(bg)}getMinOffset(e,t){return x.mapArray(this.Tn(t),i=>this.In(e,i).next(r=>r||U())).next(bg)}};function yg(n){return We(n,"collectionParents")}function ar(n){return We(n,"indexEntries")}function Ro(n){return We(n,"indexConfiguration")}function lr(n){return We(n,"indexState")}function bg(n){j(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;hd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ot(e.readTime,e.documentKey,t)}var vg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ct=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}};function q_(n,e,t){let i=n.store("mutations"),r=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),l=0,c=i.J({range:s},(p,f,_)=>(l++,_.delete()));o.push(c.next(()=>{j(l===1)}));let h=[];for(let p of t.mutations){let f=Wg(e,p.key.path,t.batchId);o.push(r.delete(f)),h.push(p.key)}return x.waitFor(o).next(()=>h)}function il(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw U();e=n.noDocument}return JSON.stringify(e).length}Ct.DEFAULT_COLLECTION_PERCENTILE=10,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ct.DEFAULT=new Ct(41943040,Ct.DEFAULT_COLLECTION_PERCENTILE,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ct.DISABLED=new Ct(-1,0,0);var rl=class n{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.xn={}}static Pt(e,t,i,r){j(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,i,r)}checkEmpty(e){let t=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).J({index:"userMutationsIndex",range:i},(r,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,i,r){let o=mr(e),s=zn(e);return s.add({}).next(l=>{j(typeof l=="number");let c=new Wo(l,t,i,r),h=function(E,O,N){let k=N.baseMutations.map(W=>es(E.ht,W)),H=N.mutations.map(W=>es(E.ht,W));return{userId:O,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:k,mutations:H}}(this.serializer,this.userId,c),p=[],f=new ge((_,E)=>Y(_.canonicalString(),E.canonicalString()));for(let _ of r){let E=Wg(this.userId,_.key.path,l);f=f.add(_.key.path.popLast()),p.push(s.put(h)),p.push(o.put(E,Zv))}return f.forEach(_=>{p.push(this.indexManager.addToCollectionParentIndex(e,_))}),e.addOnCommittedListener(()=>{this.xn[l]=c.keys()}),x.waitFor(p).next(()=>c)})}lookupMutationBatch(e,t){return zn(e).get(t).next(i=>i?(j(i.userId===this.userId),wi(this.serializer,i)):null)}On(e,t){return this.xn[t]?x.resolve(this.xn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){let r=i.keys();return this.xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]),o=null;return zn(e).J({index:"userMutationsIndex",range:r},(s,l,c)=>{l.userId===this.userId&&(j(l.batchId>=i),o=wi(this.serializer,l)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=-1;return zn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,o,s)=>{i=o.batchId,s.done()}).next(()=>i)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).U("userMutationsIndex",t).next(i=>i.map(r=>wi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let i=Da(this.userId,t.path),r=IDBKeyRange.lowerBound(i),o=[];return mr(e).J({range:r},(s,l,c)=>{let[h,p,f]=s,_=tn(p);if(h===this.userId&&t.path.isEqual(_))return zn(e).get(f).next(E=>{if(!E)throw U();j(E.userId===this.userId),o.push(wi(this.serializer,E))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ge(Y),r=[];return t.forEach(o=>{let s=Da(this.userId,o.path),l=IDBKeyRange.lowerBound(s),c=mr(e).J({range:l},(h,p,f)=>{let[_,E,O]=h,N=tn(E);_===this.userId&&o.path.isEqual(N)?i=i.add(O):f.done()});r.push(c)}),x.waitFor(r).next(()=>this.Nn(e,i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=Da(this.userId,i),s=IDBKeyRange.lowerBound(o),l=new ge(Y);return mr(e).J({range:s},(c,h,p)=>{let[f,_,E]=c,O=tn(_);f===this.userId&&i.isPrefixOf(O)?O.length===r&&(l=l.add(E)):p.done()}).next(()=>this.Nn(e,l))}Nn(e,t){let i=[],r=[];return t.forEach(o=>{r.push(zn(e).get(o).next(s=>{if(s===null)throw U();j(s.userId===this.userId),i.push(wi(this.serializer,s))}))}),x.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return q_(e._e,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Ln(t.batchId)}),x.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Ln(e){delete this.xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let i=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),r=[];return mr(e).J({range:i},(o,s,l)=>{if(o[0]===this.userId){let c=tn(o[1]);r.push(c)}else l.done()}).next(()=>{j(r.length===0)})})}containsKey(e,t){return U_(e,this.userId,t)}Bn(e){return G_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function U_(n,e,t){let i=Da(e,t.path),r=i[1],o=IDBKeyRange.lowerBound(i),s=!1;return mr(n).J({range:o,H:!0},(l,c,h)=>{let[p,f,_]=l;p===e&&f===r&&(s=!0),h.done()}).next(()=>s)}function zn(n){return We(n,"mutations")}function mr(n){return We(n,"documentMutations")}function G_(n){return We(n,"mutationQueues")}var Ar=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};var rh=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Kn(e).next(t=>{let i=new Ar(t.highestTargetId);return t.highestTargetId=i.next(),this.$n(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Kn(e).next(t=>K.fromTimestamp(new ke(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Kn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Kn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.$n(e,r)))}addTargetData(e,t){return this.Un(e,t).next(()=>this.Kn(e).next(i=>(i.targetCount+=1,this.Wn(t,i),this.$n(e,i))))}updateTargetData(e,t){return this.Un(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>cr(e).delete(t.targetId)).next(()=>this.Kn(e)).next(i=>(j(i.targetCount>0),i.targetCount-=1,this.$n(e,i)))}removeTargets(e,t,i){let r=0,o=[];return cr(e).J((s,l)=>{let c=No(l);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(r++,o.push(this.removeTargetData(e,c)))}).next(()=>x.waitFor(o)).next(()=>r)}forEachTarget(e,t){return cr(e).J((i,r)=>{let o=No(r);t(o)})}Kn(e){return wg(e).get("targetGlobalKey").next(t=>(j(t!==null),t))}$n(e,t){return wg(e).put("targetGlobalKey",t)}Un(e,t){return cr(e).put($_(this.serializer,t))}Wn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Kn(e).next(t=>t.targetCount)}getTargetData(e,t){let i=Si(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),o=null;return cr(e).J({range:r,index:"queryTargetsIndex"},(s,l,c)=>{let h=No(l);hs(t,h.target)&&(o=h,c.done())}).next(()=>o)}addMatchingKeys(e,t,i){let r=[],o=Bn(e);return t.forEach(s=>{let l=dt(s.path);r.push(o.put({targetId:i,path:l})),r.push(this.referenceDelegate.addReference(e,i,s))}),x.waitFor(r)}removeMatchingKeys(e,t,i){let r=Bn(e);return x.forEach(t,o=>{let s=dt(o.path);return x.waitFor([r.delete([i,s]),this.referenceDelegate.removeReference(e,i,o)])})}removeMatchingKeysForTargetId(e,t){let i=Bn(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){let i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Bn(e),o=ie();return r.J({range:i,H:!0},(s,l,c)=>{let h=tn(s[1]),p=new q(h);o=o.add(p)}).next(()=>o)}containsKey(e,t){let i=dt(t.path),r=IDBKeyRange.bound([i],[Ug(i)],!1,!0),o=0;return Bn(e).J({index:"documentTargetsIndex",H:!0,range:r},([s,l],c,h)=>{s!==0&&(o++,h.done())}).next(()=>o>0)}ut(e,t){return cr(e).get(t).next(i=>i?No(i):null)}};function cr(n){return We(n,"targets")}function wg(n){return We(n,"targetGlobal")}function Bn(n){return We(n,"targetDocuments")}function Tg([n,e],[t,i]){let r=Y(n,t);return r===0?Y(e,i):r}var oh=class{constructor(e){this.Gn=e,this.buffer=new ge(Tg),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();Tg(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},ol=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){M("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>P(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ni(t)?M("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield ti(t)}yield this.Yn(3e5)}))}},sh=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return x.resolve(Pt.oe);let i=new oh(t);return this.Zn.forEachTarget(e,r=>i.Hn(r.sequenceNumber)).next(()=>this.Zn.er(e,r=>i.Hn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(vg)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vg):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let i,r,o,s,l,c,h,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,s=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(i=f,l=Date.now(),this.removeTargets(e,i,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(f=>(h=Date.now(),ur()<=en.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-p}ms
	Determined least recently used ${r} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(h-c)+`ms
Total Duration: ${h-p}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:f})))}};function j_(n,e){return new sh(n,e)}var ah=class{constructor(e,t){this.db=e,this.garbageCollector=j_(this,t)}Xn(e){let t=this.nr(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}er(e,t){return this.rr(e,(i,r)=>t(r))}addReference(e,t,i){return Sa(e,i)}removeReference(e,t,i){return Sa(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Sa(e,t)}ir(e,t){return function(r,o){let s=!1;return G_(r).Y(l=>U_(r,l,o).next(c=>(c&&(s=!0),x.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],o=0;return this.rr(e,(s,l)=>{if(l<=t){let c=this.ir(e,s).next(h=>{if(!h)return o++,i.getEntry(e,s).next(()=>(i.removeEntry(s,K.min()),Bn(e).delete(function(f){return[0,dt(f.path)]}(s))))});r.push(c)}}).next(()=>x.waitFor(r)).next(()=>i.apply(e)).next(()=>o)}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Sa(e,t)}rr(e,t){let i=Bn(e),r,o=Pt.oe;return i.J({index:"documentTargetsIndex"},([s,l],{path:c,sequenceNumber:h})=>{s===0?(o!==Pt.oe&&t(new q(tn(r)),o),o=h,r=c):o=Pt.oe}).next(()=>{o!==Pt.oe&&t(new q(tn(r)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Sa(n,e){return Bn(n).put(function(i,r){return{targetId:0,path:dt(i.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}var sl=class{constructor(){this.changes=new jt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ge.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?x.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var lh=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return yi(e).put(i)}removeEntry(e,t,i){return yi(e).delete(function(o,s){let l=o.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Za(s),l[l.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.sr(e,i)))}getEntry(e,t){let i=Ge.newInvalidDocument(t);return yi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(r,o)=>{i=this._r(t,o)}).next(()=>i)}ar(e,t){let i={size:0,document:Ge.newInvalidDocument(t)};return yi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Vo(t))},(r,o)=>{i={document:this._r(t,o),size:il(o)}}).next(()=>i)}getEntries(e,t){let i=xt();return this.ur(e,t,(r,o)=>{let s=this._r(r,o);i=i.insert(r,s)}).next(()=>i)}cr(e,t){let i=xt(),r=new Ce(q.comparator);return this.ur(e,t,(o,s)=>{let l=this._r(o,s);i=i.insert(o,l),r=r.insert(o,il(s))}).next(()=>({documents:i,lr:r}))}ur(e,t,i){if(t.isEmpty())return x.resolve();let r=new ge(Cg);t.forEach(c=>r=r.add(c));let o=IDBKeyRange.bound(Vo(r.first()),Vo(r.last())),s=r.getIterator(),l=s.getNext();return yi(e).J({index:"documentKeyIndex",range:o},(c,h,p)=>{let f=q.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&Cg(l,f)<0;)i(l,null),l=s.getNext();l&&l.isEqual(f)&&(i(l,h),l=s.hasNext()?s.getNext():null),l?p.$(Vo(l)):p.done()}).next(()=>{for(;l;)i(l,null),l=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,o){let s=t.path,l=[s.popLast().toArray(),s.lastSegment(),Za(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return yi(e).U(IDBKeyRange.bound(l,c,!0)).next(h=>{o?.incrementDocumentReadCount(h.length);let p=xt();for(let f of h){let _=this._r(q.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);_.isFoundDocument()&&(ps(t,_)||r.has(_.key))&&(p=p.insert(_.key,_))}return p})}getAllFromCollectionGroup(e,t,i,r){let o=xt(),s=Eg(t,i),l=Eg(t,Ot.max());return yi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,l,!0)},(c,h,p)=>{let f=this._r(q.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);o=o.insert(f.key,f),o.size===r&&p.done()}).next(()=>o)}newChangeBuffer(e){return new ch(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Ig(e).get("remoteDocumentGlobalKey").next(t=>(j(!!t),t))}sr(e,t){return Ig(e).put("remoteDocumentGlobalKey",t)}_r(e,t){if(t){let i=jw(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(K.min())))return i}return Ge.newInvalidDocument(e)}};function K_(n){return new lh(n)}var ch=class extends sl{constructor(e,t){super(),this.hr=e,this.trackRemovals=t,this.Pr=new jt(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){let t=[],i=0,r=new ge((o,s)=>Y(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let l=this.Pr.get(o);if(t.push(this.hr.removeEntry(e,o,l.readTime)),s.isValidDocument()){let c=ug(this.hr.serializer,s);r=r.add(o.path.popLast());let h=il(c);i+=h-l.size,t.push(this.hr.addEntry(e,o,c))}else if(i-=l.size,this.trackRemovals){let c=ug(this.hr.serializer,s.convertToNoDocument(K.min()));t.push(this.hr.addEntry(e,o,c))}}),r.forEach(o=>{t.push(this.hr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.hr.updateMetadata(e,i)),x.waitFor(t)}getFromCache(e,t){return this.hr.ar(e,t).next(i=>(this.Pr.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.hr.cr(e,t).next(({documents:i,lr:r})=>(r.forEach((o,s)=>{this.Pr.set(o,{size:s,readTime:i.get(o).readTime})}),i))}};function Ig(n){return We(n,"remoteDocumentGlobal")}function yi(n){return We(n,"remoteDocumentsV14")}function Vo(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Eg(n,e){let t=e.documentKey.path.toArray();return[n,Za(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Cg(n,e){let t=n.path.toArray(),i=e.path.toArray(),r=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(r=Y(t[o],i[o]),r)return r;return r=Y(t.length,i.length),r||(r=Y(t[t.length-2],i[i.length-2]),r||Y(t[t.length-1],i[i.length-1]))}var uh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var al=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&$o(i.mutation,r,kt.empty(),ke.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ie()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ie()){let r=nn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(o=>{let s=Mo();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let i=nn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ie()))}populateOverlays(e,t,i){let r=[];return i.forEach(o=>{t.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((s,l)=>{t.set(s,l)})})}computeViews(e,t,i,r){let o=xt(),s=Lo(),l=function(){return Lo()}();return t.forEach((c,h)=>{let p=i.get(h.key);r.has(h.key)&&(p===void 0||p.mutation instanceof Kt)?o=o.insert(h.key,h):p!==void 0?(s.set(h.key,p.mutation.getFieldMask()),$o(p.mutation,h,p.mutation.getFieldMask(),ke.now())):s.set(h.key,kt.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((h,p)=>s.set(h,p)),t.forEach((h,p)=>{var f;return l.set(h,new uh(p,(f=s.get(h))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,t){let i=Lo(),r=new Ce((s,l)=>s-l),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let l of s)l.keys().forEach(c=>{let h=t.get(c);if(h===null)return;let p=i.get(c)||kt.empty();p=l.applyToLocalView(h,p),i.set(c,p);let f=(r.get(l.batchId)||ie()).add(c);r=r.insert(l.batchId,f)})}).next(()=>{let s=[],l=r.getReverseIterator();for(;l.hasNext();){let c=l.getNext(),h=c.key,p=c.value,f=f_();p.forEach(_=>{if(!o.has(_)){let E=T_(t.get(_),i.get(_));E!==null&&f.set(_,E),o=o.add(_)}}),s.push(this.documentOverlayCache.saveOverlays(e,h,f))}return x.waitFor(s)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(s){return q.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(o=>{let s=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-o.size):x.resolve(nn()),l=-1,c=o;return s.next(h=>x.forEach(h,(p,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),o.get(p)?x.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,c,h,ie())).next(p=>({batchId:l,changes:m_(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(i=>{let r=Mo();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let o=t.collectionGroup,s=Mo();return this.indexManager.getCollectionParents(e,o).next(l=>x.forEach(l,c=>{let h=function(f,_){return new Gt(_,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next(p=>{p.forEach((f,_)=>{s=s.insert(f,_)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,r))).next(s=>{o.forEach((c,h)=>{let p=h.getKey();s.get(p)===null&&(s=s.insert(p,Ge.newInvalidDocument(p)))});let l=Mo();return s.forEach((c,h)=>{let p=o.get(c);p!==void 0&&$o(p.mutation,h,kt.empty(),ke.now()),ps(t,h)&&(l=l.insert(c,h))}),l})}};var hh=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return x.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Fe(r.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(r){return{name:r.name,query:bd(r.bundledQuery),readTime:Fe(r.readTime)}}(t)),x.resolve()}};var dh=class{constructor(){this.overlays=new Ce(q.comparator),this.Er=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let i=nn();return x.forEach(t,r=>this.getOverlay(e,r).next(o=>{o!==null&&i.set(r,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,o)=>{this.Tt(e,t,o)}),x.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Er.get(i);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.Er.delete(i)),x.resolve()}getOverlaysForCollection(e,t,i){let r=nn(),o=t.length+1,s=new q(t.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){let c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===o&&c.largestBatchId>i&&r.set(c.getKey(),c)}return x.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let o=new Ce((h,p)=>h-p),s=this.overlays.getIterator();for(;s.hasNext();){let h=s.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let p=o.get(h.largestBatchId);p===null&&(p=nn(),o=o.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}let l=nn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=r)););return x.resolve(l)}Tt(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let s=this.Er.get(r.largestBatchId).delete(i.key);this.Er.set(r.largestBatchId,s)}this.overlays=this.overlays.insert(i.key,new Jo(t,i));let o=this.Er.get(t);o===void 0&&(o=ie(),this.Er.set(t,o)),this.Er.set(t,o.add(i.key))}};var ph=class{constructor(){this.sessionToken=Le.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var ns=class{constructor(){this.dr=new ge(qe.Ar),this.Rr=new ge(qe.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,t){let i=new qe(e,t);this.dr=this.dr.add(i),this.Rr=this.Rr.add(i)}mr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.gr(new qe(e,t))}pr(e,t){e.forEach(i=>this.removeReference(i,t))}yr(e){let t=new q(new se([])),i=new qe(t,e),r=new qe(t,e+1),o=[];return this.Rr.forEachInRange([i,r],s=>{this.gr(s),o.push(s.key)}),o}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new q(new se([])),i=new qe(t,e),r=new qe(t,e+1),o=ie();return this.Rr.forEachInRange([i,r],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new qe(e,0),i=this.dr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},qe=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return q.comparator(e.key,t.key)||Y(e.br,t.br)}static Vr(e,t){return Y(e.br,t.br)||q.comparator(e.key,t.key)}};var mh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new ge(qe.Ar)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let o=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Wo(o,t,i,r);this.mutationQueue.push(s);for(let l of r)this.vr=this.vr.add(new qe(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return x.resolve(s)}lookupMutationBatch(e,t){return x.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.Fr(i),o=r<0?0:r;return x.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new qe(t,0),r=new qe(t,Number.POSITIVE_INFINITY),o=[];return this.vr.forEachInRange([i,r],s=>{let l=this.Cr(s.br);o.push(l)}),x.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ge(Y);return t.forEach(r=>{let o=new qe(r,0),s=new qe(r,Number.POSITIVE_INFINITY);this.vr.forEachInRange([o,s],l=>{i=i.add(l.br)})}),x.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,o=i;q.isDocumentKey(o)||(o=o.child(""));let s=new qe(new q(o),0),l=new ge(Y);return this.vr.forEachWhile(c=>{let h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(l=l.add(c.br)),!0)},s),x.resolve(this.Mr(l))}Mr(e){let t=[];return e.forEach(i=>{let r=this.Cr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){j(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return x.forEach(t.mutations,r=>{let o=new qe(r.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.vr=i})}Ln(e){}containsKey(e,t){let i=new qe(t,0),r=this.vr.firstAfterOrEqual(i);return x.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var fh=class{constructor(e){this.Nr=e,this.docs=function(){return new Ce(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),o=r?r.size:0,s=this.Nr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return x.resolve(i?i.document.mutableCopy():Ge.newInvalidDocument(t))}getEntries(e,t){let i=xt();return t.forEach(r=>{let o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():Ge.newInvalidDocument(r))}),x.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let o=xt(),s=t.path,l=new q(s.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){let{key:h,value:{document:p}}=c.getNext();if(!s.isPrefixOf(h.path))break;h.path.length>s.length+1||hd(jg(p),i)<=0||(r.has(p.key)||ps(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return x.resolve(o)}getAllFromCollectionGroup(e,t,i,r){U()}Lr(e,t){return x.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new gh(this)}getSize(e){return x.resolve(this.size)}},gh=class extends sl{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.hr.addEntry(e,r)):this.hr.removeEntry(i)}),x.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var _h=class{constructor(e){this.persistence=e,this.Br=new jt(t=>Si(t),hs),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.kr=0,this.qr=new ns,this.targetCount=0,this.Qr=Ar.qn()}forEachTarget(e,t){return this.Br.forEach((i,r)=>t(r)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.kr&&(this.kr=t),x.resolve()}Un(e){this.Br.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new Ar(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Un(t),x.resolve()}removeTargetData(e,t){return this.Br.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,i){let r=0,o=[];return this.Br.forEach((s,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.Br.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),x.waitFor(o).next(()=>r)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let i=this.Br.get(t)||null;return x.resolve(i)}addMatchingKeys(e,t,i){return this.qr.mr(t,i),x.resolve()}removeMatchingKeys(e,t,i){this.qr.pr(t,i);let r=this.persistence.referenceDelegate,o=[];return r&&t.forEach(s=>{o.push(r.markPotentiallyOrphaned(e,s))}),x.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let i=this.qr.Sr(t);return x.resolve(i)}containsKey(e,t){return x.resolve(this.qr.containsKey(t))}};var is=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Pt(0),this.Ur=!1,this.Ur=!0,this.Wr=new ph,this.referenceDelegate=e(this),this.Gr=new _h(this),this.indexManager=new nh,this.remoteDocumentCache=function(r){return new fh(r)}(i=>this.referenceDelegate.zr(i)),this.serializer=new Ya(t),this.jr=new hh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Kr[e.toKey()];return i||(i=new mh(t,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,i){M("MemoryPersistence","Starting transaction:",e);let r=new yh(this.$r.next());return this.referenceDelegate.Hr(),i(r).next(o=>this.referenceDelegate.Jr(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Yr(e,t){return x.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,t)))}},yh=class extends za{constructor(e){super(),this.currentSequenceNumber=e}},ll=class n{constructor(e){this.persistence=e,this.Zr=new ns,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw U()}addReference(e,t,i){return this.Zr.addReference(i,t),this.ti.delete(i.toString()),x.resolve()}removeReference(e,t,i){return this.Zr.removeReference(i,t),this.ti.add(i.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),x.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(r=>this.ti.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(o=>this.ti.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.ti,i=>{let r=q.fromPath(i);return this.ni(e,r).next(o=>{o||t.removeEntry(r,K.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(i=>{i?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return x.or([()=>x.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},cl=class n{constructor(e,t){this.persistence=e,this.ri=new jt(i=>dt(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=j_(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return x.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}er(e,t){return x.forEach(this.ri,(i,r)=>this.ir(e,i,r).next(o=>o?x.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0,r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.Lr(e,s=>this.ir(e,s,t).next(l=>{l||(i++,o.removeEntry(s,K.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),x.resolve()}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),x.resolve()}removeReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),x.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),x.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Va(e.data.value)),t}ir(e,t,i){return x.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let r=this.ri.get(t);return x.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var bh=class{constructor(e){this.serializer=e}O(e,t,i,r){let o=new Ba("createOrUpgrade",t);i<1&&r>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qf,{unique:!0}),c.createObjectStore("documentMutations")}(e),xg(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=x.resolve();return i<3&&r>=3&&(i!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),xg(e)),s=s.next(()=>function(c){let h=c.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return h.put("targetGlobalKey",p)}(o))),i<4&&r>=4&&(i!==0&&(s=s.next(()=>function(c,h){return h.store("mutations").U().next(p=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qf,{unique:!0});let f=h.store("mutations"),_=p.map(E=>f.put(E));return x.waitFor(_)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),i<5&&r>=5&&(s=s.next(()=>this.ii(o))),i<6&&r>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.si(o)))),i<7&&r>=7&&(s=s.next(()=>this.oi(o))),i<8&&r>=8&&(s=s.next(()=>this._i(e,o))),i<9&&r>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&r>=10&&(s=s.next(()=>this.ai(o))),i<11&&r>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(s=s.next(()=>{(function(c){let h=c.createObjectStore("documentOverlays",{keyPath:hw});h.createIndex("collectionPathOverlayIndex",dw,{unique:!1}),h.createIndex("collectionGroupOverlayIndex",pw,{unique:!1})})(e)})),i<13&&r>=13&&(s=s.next(()=>function(c){let h=c.createObjectStore("remoteDocumentsV14",{keyPath:ew});h.createIndex("documentKeyIndex",tw),h.createIndex("collectionGroupIndex",nw)}(e)).next(()=>this.ui(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(s=s.next(()=>this.ci(e,o))),i<15&&r>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:aw}).createIndex("sequenceNumberIndex",lw,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:cw}).createIndex("documentKeyIndex",uw,{unique:!1})}(e))),i<16&&r>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),i<17&&r>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}si(e){let t=0;return e.store("remoteDocuments").J((i,r)=>{t+=il(r)}).next(()=>{let i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}ii(e){let t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next(r=>x.forEach(r,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",s).next(l=>x.forEach(l,c=>{j(c.userId===o.userId);let h=wi(this.serializer,c);return q_(e,o.userId,h).next(()=>{})}))}))}oi(e){let t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{let o=[];return i.J((s,l)=>{let c=new se(s),h=function(f){return[0,dt(f)]}(c);o.push(t.get(h).next(p=>p?x.resolve():(f=>t.put({targetId:0,path:dt(f),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>x.waitFor(o))})}_i(e,t){e.createObjectStore("collectionParents",{keyPath:sw});let i=t.store("collectionParents"),r=new ts,o=s=>{if(r.add(s)){let l=s.lastSegment(),c=s.popLast();return i.put({collectionId:l,parent:dt(c)})}};return t.store("remoteDocuments").J({H:!0},(s,l)=>{let c=new se(s);return o(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,l,c],h)=>{let p=tn(l);return o(p.popLast())}))}ai(e){let t=e.store("targets");return t.J((i,r)=>{let o=No(r),s=$_(this.serializer,o);return t.put(s)})}ui(e,t){let i=t.store("remoteDocuments"),r=[];return i.J((o,s)=>{let l=t.store("remoteDocumentsV14"),c=function(f){return f.document?new q(se.fromString(f.document.name).popFirst(5)):f.noDocument?q.fromSegments(f.noDocument.path):f.unknownDocument?q.fromSegments(f.unknownDocument.path):U()}(s).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};r.push(l.put(h))}).next(()=>x.waitFor(r))}ci(e,t){let i=t.store("mutations"),r=K_(this.serializer),o=new is(ll.ei,this.serializer.ht);return i.U().next(s=>{let l=new Map;return s.forEach(c=>{var h;let p=(h=l.get(c.userId))!==null&&h!==void 0?h:ie();wi(this.serializer,c).keys().forEach(f=>p=p.add(f)),l.set(c.userId,p)}),x.forEach(l,(c,h)=>{let p=new Ue(h),f=el.Pt(this.serializer,p),_=o.getIndexManager(p),E=rl.Pt(p,this.serializer,_,o.referenceDelegate);return new al(r,E,f,_).recalculateAndSaveOverlaysForDocumentKeys(new Go(t,Pt.oe),c).next()})})}};function xg(n){n.createObjectStore("targetDocuments",{keyPath:rw}).createIndex("documentTargetsIndex",ow,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",iw,{unique:!0}),n.createObjectStore("targetGlobal")}var lu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vh=class n{constructor(e,t,i,r,o,s,l,c,h,p,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.li=o,this.window=s,this.document=l,this.hi=h,this.Pi=p,this.Ti=f,this.$r=null,this.Ur=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ii=null,this.inForeground=!1,this.Ei=null,this.di=null,this.Ai=Number.NEGATIVE_INFINITY,this.Ri=_=>Promise.resolve(),!n.p())throw new D(S.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ah(this,r),this.Vi=t+"main",this.serializer=new Ya(c),this.mi=new Kn(this.Vi,this.Ti,new bh(this.serializer)),this.Wr=new Wu,this.Gr=new rh(this.referenceDelegate,this.serializer),this.remoteDocumentCache=K_(this.serializer),this.jr=new Qu,this.window&&this.window.localStorage?this.fi=this.window.localStorage:(this.fi=null,p===!1&&Me("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(S.FAILED_PRECONDITION,lu);return this.pi(),this.yi(),this.wi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Gr.getHighestSequenceNumber(e))}).then(e=>{this.$r=new Pt(e,this.hi)}).then(()=>{this.Ur=!0}).catch(e=>(this.mi&&this.mi.close(),Promise.reject(e)))}Si(e){return this.Ri=t=>P(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.mi.L(t=>P(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.li.enqueueAndForget(()=>P(this,null,function*(){this.started&&(yield this.gi())})))}gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Pa(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.bi(e).next(t=>{t||(this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)))})}).next(()=>this.Di(e)).next(t=>this.isPrimary&&!t?this.vi(e).next(()=>!1):!!t&&this.Ci(e).next(()=>!0))).catch(e=>{if(ni(e))return M("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return M("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.li.enqueueRetryable(()=>this.Ri(e)),this.isPrimary=e})}bi(e){return Oo(e).get("owner").next(t=>x.resolve(this.Fi(t)))}Mi(e){return Pa(e).delete(this.clientId)}xi(){return P(this,null,function*(){if(this.isPrimary&&!this.Oi(this.Ai,18e5)){this.Ai=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let i=We(t,"clientMetadata");return i.U().next(r=>{let o=this.Ni(r,18e5),s=r.filter(l=>o.indexOf(l)===-1);return x.forEach(s,l=>i.delete(l.clientId)).next(()=>s)})}).catch(()=>[]);if(this.fi)for(let t of e)this.fi.removeItem(this.Li(t.clientId))}})}wi(){this.di=this.li.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.gi().then(()=>this.xi()).then(()=>this.wi()))}Fi(e){return!!e&&e.ownerId===this.clientId}Di(e){return this.Pi?x.resolve(!0):Oo(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Bi(t.ownerId)){if(this.Fi(t)&&this.networkEnabled)return!0;if(!this.Fi(t)){if(!t.allowTabSynchronization)throw new D(S.FAILED_PRECONDITION,lu);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pa(e).U().next(i=>this.Ni(i,5e3).find(r=>{if(this.clientId!==r.clientId){let o=!this.networkEnabled&&r.networkEnabled,s=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(o||s&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&M("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return P(this,null,function*(){this.Ur=!1,this.ki(),this.di&&(this.di.cancel(),this.di=null),this.qi(),this.Qi(),yield this.mi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Go(e,Pt.oe);return this.vi(t).next(()=>this.Mi(t))}),this.mi.close(),this.Ki()})}Ni(e,t){return e.filter(i=>this.Oi(i.updateTimeMs,t)&&!this.Bi(i.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Pa(e).U().next(t=>this.Ni(t,18e5).map(i=>i.clientId)))}get started(){return this.Ur}getGlobalsCache(){return this.Wr}getMutationQueue(e,t){return rl.Pt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ih(e,this.serializer.ht.databaseId)}getDocumentOverlayCache(e){return el.Pt(this.serializer,e)}getBundleCache(){return this.jr}runTransaction(e,t,i){M("IndexedDbPersistence","Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?gw:c===16?fw:c===15?pd:c===14?Yg:c===13?Xg:c===12?mw:c===11?Jg:void U()}(this.Ti),s;return this.mi.runTransaction(e,r,o,l=>(s=new Go(l,this.$r?this.$r.next():Pt.oe),t==="readwrite-primary"?this.bi(s).next(c=>!!c||this.Di(s)).next(c=>{if(!c)throw Me(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.li.enqueueRetryable(()=>this.Ri(!1)),new D(S.FAILED_PRECONDITION,Kg);return i(s)}).next(c=>this.Ci(s).next(()=>c)):this.Ui(s).next(()=>i(s)))).then(l=>(s.raiseOnCommittedEvent(),l))}Ui(e){return Oo(e).get("owner").next(t=>{if(t!==null&&this.Oi(t.leaseTimestampMs,5e3)&&!this.Bi(t.ownerId)&&!this.Fi(t)&&!(this.Pi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new D(S.FAILED_PRECONDITION,lu)})}Ci(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oo(e).put("owner",t)}static p(){return Kn.p()}vi(e){let t=Oo(e);return t.get("owner").next(i=>this.Fi(i)?(M("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Oi(e,t){let i=Date.now();return!(e<i-t)&&(!(e>i)||(Me(`Detected an update time that is in the future: ${e} > ${i}`),!1))}pi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ei=()=>{this.li.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.gi()))},this.document.addEventListener("visibilitychange",this.Ei),this.inForeground=this.document.visibilityState==="visible")}qi(){this.Ei&&(this.document.removeEventListener("visibilitychange",this.Ei),this.Ei=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ii=()=>{this.ki();let t=/(?:Version|Mobile)\/1[456]/;Lc()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.li.enterRestrictedMode(!0),this.li.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ii))}Qi(){this.Ii&&(this.window.removeEventListener("pagehide",this.Ii),this.Ii=null)}Bi(e){var t;try{let i=((t=this.fi)===null||t===void 0?void 0:t.getItem(this.Li(e)))!==null;return M("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Me("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}ki(){if(this.fi)try{this.fi.setItem(this.Li(this.clientId),String(Date.now()))}catch(e){Me("Failed to set zombie client id.",e)}}Ki(){if(this.fi)try{this.fi.removeItem(this.Li(this.clientId))}catch{}}Li(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Oo(n){return We(n,"owner")}function Pa(n){return We(n,"clientMetadata")}function wd(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var wh=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Wi=i,this.Gi=r}static zi(e,t){let i=ie(),r=ie();for(let o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new n(e,t.fromCache,i,r)}};var Th=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ul=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return Lc()?8:Hg(vo())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,i,r){let o={result:null};return this.Xi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.es(e,t,r,i).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new Th;return this.ts(e,t,s).next(l=>{if(o.result=l,this.Hi)return this.ns(e,t,s,l.size)})}).next(()=>o.result)}ns(e,t,i,r){return i.documentReadCount<this.Ji?(ur()<=en.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",hr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),x.resolve()):(ur()<=en.DEBUG&&M("QueryEngine","Query:",hr(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Yi*r?(ur()<=en.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",hr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gt(t))):x.resolve())}Xi(e,t){if(eg(t))return x.resolve(null);let i=gt(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Qa(t,null,"F"),i=gt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{let s=ie(...o);return this.Zi.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,i).next(c=>{let h=this.rs(t,l);return this.ss(t,h,s,c.readTime)?this.Xi(e,Qa(t,null,"F")):this.os(e,h,t,c)}))})))}es(e,t,i,r){return eg(t)||r.isEqual(K.min())?x.resolve(null):this.Zi.getDocuments(e,i).next(o=>{let s=this.rs(t,o);return this.ss(t,s,i,r)?x.resolve(null):(ur()<=en.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),hr(t)),this.os(e,s,t,Gg(r,-1)).next(l=>l))})}rs(e,t){let i=new ge(d_(e));return t.forEach((r,o)=>{ps(e,o)&&(i=i.add(o))}),i}ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}ts(e,t,i){return ur()<=en.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",hr(t)),this.Zi.getDocumentsMatchingQuery(e,t,Ot.min(),i)}os(e,t,i,r){return this.Zi.getDocumentsMatchingQuery(e,i,r).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Ih=class{constructor(e,t,i,r){this.persistence=e,this._s=t,this.serializer=r,this.us=new Ce(Y),this.cs=new jt(o=>Si(o),hs),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new al(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function H_(n,e,t,i){return new Ih(n,e,t,i)}function Q_(n,e){return P(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,t.Ps(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let s=[],l=[],c=ie();for(let h of r){s.push(h.batchId);for(let p of h.mutations)c=c.add(p.key)}for(let h of o){l.push(h.batchId);for(let p of h.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(i,c).next(h=>({Ts:h,removedBatchIds:s,addedBatchIds:l}))})})})}function Qw(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),o=t.hs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){let f=h.batch,_=f.keys(),E=x.resolve();return _.forEach(O=>{E=E.next(()=>p.getEntry(c,O)).next(N=>{let k=h.docVersions.get(O);j(k!==null),N.version.compareTo(k)<0&&(f.applyToRemoteDocument(N,h),N.isValidDocument()&&(N.setReadTime(h.commitVersion),p.addEntry(N)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(l){let c=ie();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function W_(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function Ww(n,e){let t=B(n),i=e.snapshotVersion,r=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.hs.newChangeBuffer({trackRemovals:!0});r=t.us;let l=[];e.targetChanges.forEach((p,f)=>{let _=r.get(f);if(!_)return;l.push(t.Gr.removeMatchingKeys(o,p.removedDocuments,f).next(()=>t.Gr.addMatchingKeys(o,p.addedDocuments,f)));let E=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?E=E.withResumeToken(Le.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,i)),r=r.insert(f,E),function(N,k,H){return N.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0}(_,E,p)&&l.push(t.Gr.updateTargetData(o,E))});let c=xt(),h=ie();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),l.push(J_(o,s,e.documentUpdates).next(p=>{c=p.Is,h=p.Es})),!i.isEqual(K.min())){let p=t.Gr.getLastRemoteSnapshotVersion(o).next(f=>t.Gr.setTargetsMetadata(o,o.currentSequenceNumber,i));l.push(p)}return x.waitFor(l).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,h)).next(()=>c)}).then(o=>(t.us=r,o))}function J_(n,e,t){let i=ie(),r=ie();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let s=xt();return t.forEach((l,c)=>{let h=o.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(l)),c.isNoDocument()&&c.version.isEqual(K.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):M("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Is:s,Es:r}})}function Jw(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Sr(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Gr.getTargetData(i,e).next(o=>o?(r=o,x.resolve(r)):t.Gr.allocateTargetId(i).next(s=>(r=new xr(e,s,"TargetPurposeListen",i.currentSequenceNumber),t.Gr.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.us.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.us=t.us.insert(i.targetId,i),t.cs.set(e,i.targetId)),i})}function Pr(n,e,t){return P(this,null,function*(){let i=B(n),r=i.us.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",o,s=>i.persistence.referenceDelegate.removeTarget(s,r)))}catch(s){if(!ni(s))throw s;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}i.us=i.us.remove(e),i.cs.delete(r.target)})}function hl(n,e,t){let i=B(n),r=K.min(),o=ie();return i.persistence.runTransaction("Execute query","readwrite",s=>function(c,h,p){let f=B(c),_=f.cs.get(p);return _!==void 0?x.resolve(f.us.get(_)):f.Gr.getTargetData(h,p)}(i,s,gt(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>i._s.getDocumentsMatchingQuery(s,e,t?r:K.min(),t?o:ie())).next(l=>(Z_(i,h_(e),l),{documents:l,ds:o})))}function X_(n,e){let t=B(n),i=B(t.Gr),r=t.us.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",o=>i.ut(o,e).next(s=>s?s.target:null))}function Y_(n,e){let t=B(n),i=t.ls.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.hs.getAllFromCollectionGroup(r,e,Gg(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Z_(t,e,r),r))}function Z_(n,e,t){let i=n.ls.get(e)||K.min();t.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.ls.set(e,i)}function Xw(n,e,t,i){return P(this,null,function*(){let r=B(n),o=ie(),s=xt();for(let h of t){let p=e.As(h.metadata.name);h.document&&(o=o.add(p));let f=e.Rs(h);f.setReadTime(e.Vs(h.metadata.readTime)),s=s.insert(p,f)}let l=r.hs.newChangeBuffer({trackRemovals:!0}),c=yield Sr(r,function(p){return gt(Fr(se.fromString(`__bundle__/docs/${p}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",h=>J_(h,l,s).next(p=>(l.apply(h),p)).next(p=>r.Gr.removeMatchingKeysForTargetId(h,c.targetId).next(()=>r.Gr.addMatchingKeys(h,o,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(h,p.Is,p.Es)).next(()=>p.Is)))})}function Yw(i,r){return P(this,arguments,function*(n,e,t=ie()){let o=yield Sr(n,gt(bd(e.bundledQuery))),s=B(n);return s.persistence.runTransaction("Save named query","readwrite",l=>{let c=Fe(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.jr.saveNamedQuery(l,e);let h=o.withResumeToken(Le.EMPTY_BYTE_STRING,c);return s.us=s.us.insert(h.targetId,h),s.Gr.updateTargetData(l,h).next(()=>s.Gr.removeMatchingKeysForTargetId(l,o.targetId)).next(()=>s.Gr.addMatchingKeys(l,t,o.targetId)).next(()=>s.jr.saveNamedQuery(l,e))})})}function Ag(n,e){return`firestore_clients_${n}_${e}`}function Sg(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function cu(n,e){return`firestore_targets_${n}_${e}`}var dl=class n{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static fs(e,t,i){let r=JSON.parse(i),o,s=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(o=new D(r.error.code,r.error.message))),s?new n(e,t,r.state,o):(Me("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},zo=class n{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static fs(e,t){let i=JSON.parse(t),r,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(r=new D(i.error.code,i.error.message))),o?new n(e,i.state,r):(Me("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}gs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},pl=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static fs(e,t){let i=JSON.parse(t),r=typeof i=="object"&&i.activeTargetIds instanceof Array,o=gd();for(let s=0;r&&s<i.activeTargetIds.length;++s)r=Qg(i.activeTargetIds[s]),o=o.add(i.activeTargetIds[s]);return r?new n(e,o):(Me("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Eh=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static fs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Me("SharedClientState",`Failed to parse online state: ${e}`),null)}},rs=class{constructor(){this.activeTargetIds=gd()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Bo=class{constructor(e,t,i,r,o){this.window=e,this.li=t,this.persistenceKey=i,this.ws=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ss=this.bs.bind(this),this.Ds=new Ce(Y),this.started=!1,this.vs=[];let s=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Cs=Ag(this.persistenceKey,this.ws),this.Fs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ds=this.Ds.insert(this.ws,new rs),this.Ms=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.xs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Os=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Ns=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Ls=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ss)}static p(e){return!(!e||!e.localStorage)}start(){return P(this,null,function*(){let e=yield this.syncEngine.$i();for(let i of e){if(i===this.ws)continue;let r=this.getItem(Ag(this.persistenceKey,i));if(r){let o=pl.fs(i,r);o&&(this.Ds=this.Ds.insert(o.clientId,o))}}this.Bs();let t=this.storage.getItem(this.Ns);if(t){let i=this.ks(t);i&&this.qs(i)}for(let i of this.vs)this.bs(i);this.vs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Fs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Qs(this.Ds)}isActiveQueryTarget(e){let t=!1;return this.Ds.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ks(e,"pending")}updateMutationState(e,t,i){this.Ks(e,t,i),this.$s(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(cu(this.persistenceKey,e));if(r){let o=zo.fs(e,r);o&&(i=o.state)}}return t&&this.Us.ps(e),this.Bs(),i}removeLocalQueryTarget(e){this.Us.ys(e),this.Bs()}isLocalQueryTarget(e){return this.Us.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cu(this.persistenceKey,e))}updateQueryState(e,t,i){this.Ws(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.$s(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Gs(e)}notifyBundleLoaded(e){this.zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ss),this.removeItem(this.Cs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return M("SharedClientState","READ",e,t),t}setItem(e,t){M("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){M("SharedClientState","REMOVE",e),this.storage.removeItem(e)}bs(e){let t=e;if(t.storageArea===this.storage){if(M("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Cs)return void Me("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.li.enqueueRetryable(()=>P(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ms.test(t.key)){if(t.newValue==null){let i=this.js(t.key);return this.Hs(i,null)}{let i=this.Js(t.key,t.newValue);if(i)return this.Hs(i.clientId,i)}}else if(this.xs.test(t.key)){if(t.newValue!==null){let i=this.Ys(t.key,t.newValue);if(i)return this.Zs(i)}}else if(this.Os.test(t.key)){if(t.newValue!==null){let i=this.Xs(t.key,t.newValue);if(i)return this.eo(i)}}else if(t.key===this.Ns){if(t.newValue!==null){let i=this.ks(t.newValue);if(i)return this.qs(i)}}else if(t.key===this.Fs){let i=function(o){let s=Pt.oe;if(o!=null)try{let l=JSON.parse(o);j(typeof l=="number"),s=l}catch(l){Me("SharedClientState","Failed to read sequence number from WebStorage",l)}return s}(t.newValue);i!==Pt.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Ls){let i=this.no(t.newValue);yield Promise.all(i.map(r=>this.syncEngine.ro(r)))}}}else this.vs.push(t)}))}}get Us(){return this.Ds.get(this.ws)}Bs(){this.setItem(this.Cs,this.Us.gs())}Ks(e,t,i){let r=new dl(this.currentUser,e,t,i),o=Sg(this.persistenceKey,this.currentUser,e);this.setItem(o,r.gs())}$s(e){let t=Sg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Gs(e){let t={clientId:this.ws,onlineState:e};this.storage.setItem(this.Ns,JSON.stringify(t))}Ws(e,t,i){let r=cu(this.persistenceKey,e),o=new zo(e,t,i);this.setItem(r,o.gs())}zs(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Ls,t)}js(e){let t=this.Ms.exec(e);return t?t[1]:null}Js(e,t){let i=this.js(e);return pl.fs(i,t)}Ys(e,t){let i=this.xs.exec(e),r=Number(i[1]),o=i[2]!==void 0?i[2]:null;return dl.fs(new Ue(o),r,t)}Xs(e,t){let i=this.Os.exec(e),r=Number(i[1]);return zo.fs(r,t)}ks(e){return Eh.fs(e)}no(e){return JSON.parse(e)}Zs(e){return P(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.io(e.batchId,e.state,e.error);M("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}eo(e){return this.syncEngine.so(e.targetId,e.state,e.error)}Hs(e,t){let i=t?this.Ds.insert(e,t):this.Ds.remove(e),r=this.Qs(this.Ds),o=this.Qs(i),s=[],l=[];return o.forEach(c=>{r.has(c)||s.push(c)}),r.forEach(c=>{o.has(c)||l.push(c)}),this.syncEngine.oo(s,l).then(()=>{this.Ds=i})}qs(e){this.Ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Qs(e){let t=gd();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}},ml=class{constructor(){this._o=new rs,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,i){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new rs,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ch=class{uo(e){}shutdown(){}};var fl=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ka=null;function uu(){return ka===null?ka=function(){return 268435456+Math.round(2147483648*Math.random())}():ka++,"0x"+ka.toString(16)}var Zw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var xh=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var ut="WebChannelConnection",Ah=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+t.host,this.Mo=`projects/${r}/databases/${o}`,this.xo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Oo(t,i,r,o,s){let l=uu(),c=this.No(t,i.toUriEncodedString());M("RestConnection",`Sending RPC '${t}' ${l}:`,c,r);let h={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(h,o,s),this.Bo(t,c,h,r).then(p=>(M("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Ut("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",c,"request:",r),p})}ko(t,i,r,o,s,l){return this.Oo(t,i,r,o,s)}Lo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((o,s)=>t[s]=o),r&&r.headers.forEach((o,s)=>t[s]=o)}No(t,i){let r=Zw[t];return`${this.Fo}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,t,i,r){let o=uu();return new Promise((s,l)=>{let c=new nu;c.setWithCredentials(!0),c.listenOnce(iu.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ko.NO_ERROR:let p=c.getResponseJson();M(ut,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),s(p);break;case ko.TIMEOUT:M(ut,`RPC '${e}' ${o} timed out`),l(new D(S.DEADLINE_EXCEEDED,"Request time out"));break;case ko.HTTP_ERROR:let f=c.getStatus();if(M(ut,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);let E=_?.error;if(E&&E.status&&E.message){let O=function(k){let H=k.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(H)>=0?H:S.UNKNOWN}(E.status);l(new D(O,E.message))}else l(new D(S.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new D(S.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{M(ut,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(r);M(ut,`RPC '${e}' ${o} sending request:`,r),c.send(t,"POST",h,i,15)})}qo(e,t,i){let r=uu(),o=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=su(),l=ou(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Lo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;let p=o.join("");M(ut,`Creating RPC '${e}' stream ${r}: ${p}`,c);let f=s.createWebChannel(p,c),_=!1,E=!1,O=new xh({Eo:k=>{E?M(ut,`Not sending because RPC '${e}' stream ${r} is closed:`,k):(_||(M(ut,`Opening RPC '${e}' stream ${r} transport.`),f.open(),_=!0),M(ut,`RPC '${e}' stream ${r} sending:`,k),f.send(k))},Ao:()=>f.close()}),N=(k,H,W)=>{k.listen(H,z=>{try{W(z)}catch(J){setTimeout(()=>{throw J},0)}})};return N(f,or.EventType.OPEN,()=>{E||(M(ut,`RPC '${e}' stream ${r} transport opened.`),O.So())}),N(f,or.EventType.CLOSE,()=>{E||(E=!0,M(ut,`RPC '${e}' stream ${r} transport closed`),O.Do())}),N(f,or.EventType.ERROR,k=>{E||(E=!0,Ut(ut,`RPC '${e}' stream ${r} transport errored:`,k),O.Do(new D(S.UNAVAILABLE,"The operation could not be completed")))}),N(f,or.EventType.MESSAGE,k=>{var H;if(!E){let W=k.data[0];j(!!W);let z=W,J=z?.error||((H=z[0])===null||H===void 0?void 0:H.error);if(J){M(ut,`RPC '${e}' stream ${r} received error:`,J);let ee=J.status,te=function(b){let w=Be[b];if(w!==void 0)return C_(w)}(ee),v=J.message;te===void 0&&(te=S.INTERNAL,v="Unknown error status: "+ee+" with message "+J.message),E=!0,O.Do(new D(te,v)),f.close()}else M(ut,`RPC '${e}' stream ${r} received:`,W),O.vo(W)}}),N(l,ru.STAT_EVENT,k=>{k.stat===Ca.PROXY?M(ut,`RPC '${e}' stream ${r} detected buffering proxy`):k.stat===Ca.NOPROXY&&M(ut,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{O.bo()},0),O}};function e0(){return typeof window<"u"?window:null}function Na(){return typeof document<"u"?document:null}function ms(n){return new Uu(n,!0)}var os=class{constructor(e,t,i=1e3,r=1.5,o=6e4){this.li=e,this.timerId=t,this.Qo=i,this.Ko=r,this.$o=o,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),r=Math.max(0,t-i);r>0&&M("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,r,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var gl=class{constructor(e,t,i,r,o,s,l,c){this.li=e,this.Yo=i,this.Zo=r,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new os(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return P(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return P(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return P(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(Me(t.toString()),Me("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Xo===t&&this.I_(i,r)},i=>{e(()=>{let r=new D(S.UNKNOWN,"Fetching auth token failed: "+i.message);return this.E_(r)})})}I_(e,t){let i=this.T_(this.Xo);this.stream=this.d_(e,t),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(r=>{i(()=>this.E_(r))}),this.stream.onMessage(r=>{i(()=>++this.n_==1?this.A_(r):this.onNext(r))})}o_(){this.state=5,this.r_.jo(()=>P(this,null,function*(){this.state=0,this.start()}))}E_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Sh=class extends gl{constructor(e,t,i,r,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}d_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=Lw(this.serializer,e),i=function(o){if(!("targetChange"in o))return K.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?K.min():s.readTime?Fe(s.readTime):K.min()}(e);return this.listener.R_(t,i)}V_(e){let t={};t.database=Ku(this.serializer),t.addTarget=function(o,s){let l,c=s.target;if(l=Ka(c)?{documents:V_(o,c)}:{query:O_(o,c).ct},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=A_(o,s.resumeToken);let h=Gu(o,s.expectedCount);h!==null&&(l.expectedCount=h)}else if(s.snapshotVersion.compareTo(K.min())>0){l.readTime=Cr(o,s.snapshotVersion.toTimestamp());let h=Gu(o,s.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);let i=zw(this.serializer,e);i&&(t.labels=i),this.c_(t)}m_(e){let t={};t.database=Ku(this.serializer),t.removeTarget=e,this.c_(t)}},Ph=class extends gl{constructor(e,t,i,r,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,s),this.serializer=o}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,t){return this.connection.qo("Write",e,t)}A_(e){return j(!!e.streamToken),this.lastStreamToken=e.streamToken,j(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=$w(e.writeResults,e.commitTime),i=Fe(e.commitTime);return this.listener.y_(i,t)}w_(){let e={};e.database=Ku(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>es(this.serializer,i))};this.c_(t)}};var kh=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.S_=!1}b_(){if(this.S_)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,i,r){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Oo(e,ju(t,i),r,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(S.UNKNOWN,o.toString())})}ko(e,t,i,r,o){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.ko(e,ju(t,i),r,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(S.UNKNOWN,s.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},Dh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Me(t),this.C_=!1):M("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var Rh=class{constructor(e,t,i,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=o,this.Q_.uo(s=>{i.enqueueAndForget(()=>P(this,null,function*(){ri(this)&&(M("RemoteStore","Restarting streams for network reachability change."),yield function(c){return P(this,null,function*(){let h=B(c);h.k_.add(4),yield Lr(h),h.K_.set("Unknown"),h.k_.delete(4),yield fs(h)})}(this))}))}),this.K_=new Dh(i,r)}};function fs(n){return P(this,null,function*(){if(ri(n))for(let e of n.q_)yield e(!0)})}function Lr(n){return P(this,null,function*(){for(let e of n.q_)yield e(!1)})}function Ll(n,e){let t=B(n);t.B_.has(e.targetId)||(t.B_.set(e.targetId,e),Ed(t)?Id(t):zr(t).s_()&&Td(t,e))}function kr(n,e){let t=B(n),i=zr(t);t.B_.delete(e),i.s_()&&t0(t,e),t.B_.size===0&&(i.s_()?i.a_():ri(t)&&t.K_.set("Unknown"))}function Td(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zr(n).V_(e)}function t0(n,e){n.U_.xe(e),zr(n).m_(e)}function Id(n){n.U_=new qu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.B_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),zr(n).start(),n.K_.F_()}function Ed(n){return ri(n)&&!zr(n).i_()&&n.B_.size>0}function ri(n){return B(n).k_.size===0}function n0(n){n.U_=void 0}function eT(n){return P(this,null,function*(){n.K_.set("Online")})}function tT(n){return P(this,null,function*(){n.B_.forEach((e,t)=>{Td(n,e)})})}function nT(n,e){return P(this,null,function*(){n0(n),Ed(n)?(n.K_.O_(e),Id(n)):n.K_.set("Unknown")})}function iT(n,e,t){return P(this,null,function*(){if(n.K_.set("Online"),e instanceof Ja&&e.state===2&&e.cause)try{yield function(r,o){return P(this,null,function*(){let s=o.cause;for(let l of o.targetIds)r.B_.has(l)&&(yield r.remoteSyncer.rejectListen(l,s),r.B_.delete(l),r.U_.removeTarget(l))})}(n,e)}catch(i){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield _l(n,i)}else if(e instanceof yr?n.U_.$e(e):e instanceof Wa?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(K.min()))try{let i=yield W_(n.localStore);t.compareTo(i)>=0&&(yield function(o,s){let l=o.U_.it(s);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){let p=o.B_.get(h);p&&o.B_.set(h,p.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,h)=>{let p=o.B_.get(c);if(!p)return;o.B_.set(c,p.withResumeToken(Le.EMPTY_BYTE_STRING,p.snapshotVersion)),t0(o,c);let f=new xr(p.target,c,h,p.sequenceNumber);Td(o,f)}),o.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(i){M("RemoteStore","Failed to raise snapshot:",i),yield _l(n,i)}})}function _l(n,e,t){return P(this,null,function*(){if(!ni(e))throw e;n.k_.add(1),yield Lr(n),n.K_.set("Offline"),t||(t=()=>W_(n.localStore)),n.asyncQueue.enqueueRetryable(()=>P(this,null,function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield fs(n)}))})}function i0(n,e){return e().catch(t=>_l(n,t,e))}function $r(n){return P(this,null,function*(){let e=B(n),t=ei(e),i=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;rT(e);)try{let r=yield Jw(e.localStore,i);if(r===null){e.L_.length===0&&t.a_();break}i=r.batchId,oT(e,r)}catch(r){yield _l(e,r)}r0(e)&&o0(e)})}function rT(n){return ri(n)&&n.L_.length<10}function oT(n,e){n.L_.push(e);let t=ei(n);t.s_()&&t.f_&&t.g_(e.mutations)}function r0(n){return ri(n)&&!ei(n).i_()&&n.L_.length>0}function o0(n){ei(n).start()}function sT(n){return P(this,null,function*(){ei(n).w_()})}function aT(n){return P(this,null,function*(){let e=ei(n);for(let t of n.L_)e.g_(t.mutations)})}function lT(n,e,t){return P(this,null,function*(){let i=n.L_.shift(),r=$u.from(i,e,t);yield i0(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield $r(n)})}function cT(n,e){return P(this,null,function*(){e&&ei(n).f_&&(yield function(i,r){return P(this,null,function*(){if(function(s){return E_(s)&&s!==S.ABORTED}(r.code)){let o=i.L_.shift();ei(i).__(),yield i0(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,r)),yield $r(i)}})}(n,e)),r0(n)&&o0(n)})}function Pg(n,e){return P(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");let i=ri(t);t.k_.add(3),yield Lr(t),i&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield fs(t)})}function Vh(n,e){return P(this,null,function*(){let t=B(n);e?(t.k_.delete(2),yield fs(t)):e||(t.k_.add(2),yield Lr(t),t.K_.set("Unknown"))})}function zr(n){return n.W_||(n.W_=function(t,i,r){let o=B(t);return o.b_(),new Sh(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(n.datastore,n.asyncQueue,{Ro:eT.bind(null,n),mo:tT.bind(null,n),po:nT.bind(null,n),R_:iT.bind(null,n)}),n.q_.push(e=>P(this,null,function*(){e?(n.W_.__(),Ed(n)?Id(n):n.K_.set("Unknown")):(yield n.W_.stop(),n0(n))}))),n.W_}function ei(n){return n.G_||(n.G_=function(t,i,r){let o=B(t);return o.b_(),new Ph(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:sT.bind(null,n),po:cT.bind(null,n),p_:aT.bind(null,n),y_:lT.bind(null,n)}),n.q_.push(e=>P(this,null,function*(){e?(n.G_.__(),yield $r(n)):(yield n.G_.stop(),n.L_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.L_.length} pending writes`),n.L_=[]))}))),n.G_}var Oh=class n{constructor(e,t,i,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Qe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,o){let s=Date.now()+i,l=new n(e,t,s,r,o);return l.start(i),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Br(n,e){if(Me("AsyncQueue",`${e}: ${n}`),ni(n))return new D(S.UNAVAILABLE,`${e}: ${n}`);throw n}var yl=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||q.comparator(t.key,i.key):(t,i)=>q.comparator(t.key,i.key),this.keyedMap=Mo(),this.sortedSet=new Ce(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var bl=class{constructor(){this.z_=new Ce(q.comparator)}track(e){let t=e.doc.key,i=this.z_.get(t);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(t,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(t):e.type===1&&i.type===2?this.z_=this.z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):U():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,i)=>{e.push(i)}),e}},Dr=class n{constructor(e,t,i,r,o,s,l,c,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,o){let s=[];return t.forEach(l=>{s.push({type:0,doc:l})}),new n(e,t,yl.emptySet(t),s,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ds(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var Mh=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},Nh=class{constructor(){this.queries=kg(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,i){let r=B(t),o=r.queries;r.queries=kg(),o.forEach((s,l)=>{for(let c of l.J_)c.onError(i)})})(this,new D(S.ABORTED,"Firestore shutting down"))}};function kg(){return new jt(n=>u_(n),ds)}function Cd(n,e){return P(this,null,function*(){let t=B(n),i=3,r=e.query,o=t.queries.get(r);o?!o.Y_()&&e.Z_()&&(i=2):(o=new Mh,i=e.Z_()?0:1);try{switch(i){case 0:o.H_=yield t.onListen(r,!0);break;case 1:o.H_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(s){let l=Br(s,`Initialization of query '${hr(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,o),o.J_.push(e),e.ea(t.onlineState),o.H_&&e.ta(o.H_)&&Ad(t)})}function xd(n,e){return P(this,null,function*(){let t=B(n),i=e.query,r=3,o=t.queries.get(i);if(o){let s=o.J_.indexOf(e);s>=0&&(o.J_.splice(s,1),o.J_.length===0?r=e.Z_()?0:1:!o.Y_()&&e.Z_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function uT(n,e){let t=B(n),i=!1;for(let r of e){let o=r.query,s=t.queries.get(o);if(s){for(let l of s.J_)l.ta(r)&&(i=!0);s.H_=r}}i&&Ad(t)}function hT(n,e,t){let i=B(n),r=i.queries.get(e);if(r)for(let o of r.J_)o.onError(t);i.queries.delete(e)}function Ad(n){n.X_.forEach(e=>{e.next()})}var Fh,Dg;(Dg=Fh||(Fh={})).na="default",Dg.Cache="cache";var ss=class{constructor(e,t,i){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Dr(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let i=t!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=Dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Fh.Cache}};var Lh=class{constructor(e,t){this.ca=e,this.byteLength=t}la(){return"metadata"in this.ca}};var vl=class{constructor(e){this.serializer=e}As(e){return on(this.serializer,e)}Rs(e){return e.metadata.exists?R_(this.serializer,e.document,!1):Ge.newNoDocument(this.As(e.metadata.name),this.Vs(e.metadata.readTime))}Vs(e){return Fe(e)}},$h=class{constructor(e,t,i){this.ha=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=s0(e)}Pa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ca.namedQuery)this.queries.push(e.ca.namedQuery);else if(e.ca.documentMetadata){this.documents.push({metadata:e.ca.documentMetadata}),e.ca.documentMetadata.exists||++t;let i=se.fromString(e.ca.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.ca.document&&(this.documents[this.documents.length-1].document=e.ca.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ta(e){let t=new Map,i=new vl(this.serializer);for(let r of e)if(r.metadata.queries){let o=i.As(r.metadata.name);for(let s of r.metadata.queries){let l=(t.get(s)||ie()).add(o);t.set(s,l)}}return t}complete(){return P(this,null,function*(){let e=yield Xw(this.localStore,new vl(this.serializer),this.documents,this.ha.id),t=this.Ta(this.documents);for(let i of this.queries)yield Yw(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ia:this.collectionGroups,Ea:e}})}};function s0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var wl=class{constructor(e){this.key=e}},Tl=class{constructor(e){this.key=e}},Il=class{constructor(e,t){this.query=e,this.da=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=ie(),this.mutatedKeys=ie(),this.Va=d_(e),this.ma=new yl(this.Va)}get fa(){return this.da}ga(e,t){let i=t?t.pa:new bl,r=t?t.ma:this.ma,o=t?t.mutatedKeys:this.mutatedKeys,s=r,l=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((p,f)=>{let _=r.get(p),E=ps(this.query,f)?f:null,O=!!_&&this.mutatedKeys.has(_.key),N=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations),k=!1;_&&E?_.data.isEqual(E.data)?O!==N&&(i.track({type:3,doc:E}),k=!0):this.ya(_,E)||(i.track({type:2,doc:E}),k=!0,(c&&this.Va(E,c)>0||h&&this.Va(E,h)<0)&&(l=!0)):!_&&E?(i.track({type:0,doc:E}),k=!0):_&&!E&&(i.track({type:1,doc:_}),k=!0,(c||h)&&(l=!0)),k&&(E?(s=s.add(E),o=N?o.add(p):o.delete(p)):(s=s.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let p=this.query.limitType==="F"?s.last():s.first();s=s.delete(p.key),o=o.delete(p.key),i.track({type:1,doc:p})}return{ma:s,pa:i,ss:l,mutatedKeys:o}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let o=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let s=e.pa.j_();s.sort((p,f)=>function(E,O){let N=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return N(E)-N(O)}(p.type,f.type)||this.Va(p.doc,f.doc)),this.wa(i),r=r!=null&&r;let l=t&&!r?this.Sa():[],c=this.Ra.size===0&&this.current&&!r?1:0,h=c!==this.Aa;return this.Aa=c,s.length!==0||h?{snapshot:new Dr(this.query,e.ma,o,s,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:l}:{ba:l}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new bl,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.da=this.da.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.da=this.da.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=ie(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});let t=[];return e.forEach(i=>{this.Ra.has(i)||t.push(new Tl(i))}),this.Ra.forEach(i=>{e.has(i)||t.push(new wl(i))}),t}va(e){this.da=e.ds,this.Ra=ie();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return Dr.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},zh=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},Bh=class{constructor(e){this.key=e,this.Fa=!1}},qh=class{constructor(e,t,i,r,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ma={},this.xa=new jt(l=>u_(l),ds),this.Oa=new Map,this.Na=new Set,this.La=new Ce(q.comparator),this.Ba=new Map,this.ka=new ns,this.qa={},this.Qa=new Map,this.Ka=Ar.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function dT(n,e,t=!0){return P(this,null,function*(){let i=$l(n),r,o=i.xa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.Ca()):r=yield a0(i,e,t,!0),r})}function pT(n,e){return P(this,null,function*(){let t=$l(n);yield a0(t,e,!0,!1)})}function a0(n,e,t,i){return P(this,null,function*(){let r=yield Sr(n.localStore,gt(e)),o=r.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),l;return i&&(l=yield Sd(n,e,o,s==="current",r.resumeToken)),n.isPrimaryClient&&t&&Ll(n.remoteStore,r),l})}function Sd(n,e,t,i,r){return P(this,null,function*(){n.Ua=(f,_,E)=>function(N,k,H,W){return P(this,null,function*(){let z=k.view.ga(H);z.ss&&(z=yield hl(N.localStore,k.query,!1).then(({documents:v})=>k.view.ga(v,z)));let J=W&&W.targetChanges.get(k.targetId),ee=W&&W.targetMismatches.get(k.targetId)!=null,te=k.view.applyChanges(z,N.isPrimaryClient,J,ee);return Uh(N,k.targetId,te.ba),te.snapshot})}(n,f,_,E);let o=yield hl(n.localStore,e,!0),s=new Il(e,o.ds),l=s.ga(o.documents),c=Yo.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=s.applyChanges(l,n.isPrimaryClient,c);Uh(n,t,h.ba);let p=new zh(e,t,s);return n.xa.set(e,p),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),h.snapshot})}function mT(n,e,t){return P(this,null,function*(){let i=B(n),r=i.xa.get(e),o=i.Oa.get(r.targetId);if(o.length>1)return i.Oa.set(r.targetId,o.filter(s=>!ds(s,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Pr(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&kr(i.remoteStore,r.targetId),Rr(i,r.targetId)}).catch(ti))):(Rr(i,r.targetId),yield Pr(i.localStore,r.targetId,!0))})}function fT(n,e){return P(this,null,function*(){let t=B(n),i=t.xa.get(e),r=t.Oa.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),kr(t.remoteStore,i.targetId))})}function gT(n,e,t){return P(this,null,function*(){let i=Rd(n);try{let r=yield function(s,l){let c=B(s),h=ke.now(),p=l.reduce((E,O)=>E.add(O.key),ie()),f,_;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let O=xt(),N=ie();return c.hs.getEntries(E,p).next(k=>{O=k,O.forEach((H,W)=>{W.isValidDocument()||(N=N.add(H))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,O)).next(k=>{f=k;let H=[];for(let W of l){let z=Dw(W,f.get(W.key).overlayedDocument);z!=null&&H.push(new Kt(W.key,z,i_(z.value.mapValue),Ve.exists(!0)))}return c.mutationQueue.addMutationBatch(E,h,H,l)}).next(k=>{_=k;let H=k.applyToLocalDocumentSet(f,N);return c.documentOverlayCache.saveOverlays(E,k.batchId,H)})}).then(()=>({batchId:_.batchId,changes:m_(f)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,l,c){let h=s.qa[s.currentUser.toKey()];h||(h=new Ce(Y)),h=h.insert(l,c),s.qa[s.currentUser.toKey()]=h}(i,r.batchId,t),yield An(i,r.changes),yield $r(i.remoteStore)}catch(r){let o=Br(r,"Failed to persist write");t.reject(o)}})}function l0(n,e){return P(this,null,function*(){let t=B(n);try{let i=yield Ww(t.localStore,e);e.targetChanges.forEach((r,o)=>{let s=t.Ba.get(o);s&&(j(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?s.Fa=!0:r.modifiedDocuments.size>0?j(s.Fa):r.removedDocuments.size>0&&(j(s.Fa),s.Fa=!1))}),yield An(t,i,e)}catch(i){yield ti(i)}})}function Rg(n,e,t){let i=B(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.xa.forEach((o,s)=>{let l=s.view.ea(e);l.snapshot&&r.push(l.snapshot)}),function(s,l){let c=B(s);c.onlineState=l;let h=!1;c.queries.forEach((p,f)=>{for(let _ of f.J_)_.ea(l)&&(h=!0)}),h&&Ad(c)}(i.eventManager,e),r.length&&i.Ma.R_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function _T(n,e,t){return P(this,null,function*(){let i=B(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Ba.get(e),o=r&&r.key;if(o){let s=new Ce(q.comparator);s=s.insert(o,Ge.newNoDocument(o,K.min()));let l=ie().add(o),c=new Xo(K.min(),new Map,new Ce(Y),s,l);yield l0(i,c),i.La=i.La.remove(o),i.Ba.delete(e),Dd(i)}else yield Pr(i.localStore,e,!1).then(()=>Rr(i,e,t)).catch(ti)})}function yT(n,e){return P(this,null,function*(){let t=B(n),i=e.batch.batchId;try{let r=yield Qw(t.localStore,e);kd(t,i,null),Pd(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield An(t,r)}catch(r){yield ti(r)}})}function bT(n,e,t){return P(this,null,function*(){let i=B(n);try{let r=yield function(s,l){let c=B(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(f=>(j(f!==null),p=f.keys(),c.mutationQueue.removeMutationBatch(h,f))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(i.localStore,e);kd(i,e,t),Pd(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield An(i,r)}catch(r){yield ti(r)}})}function vT(n,e){return P(this,null,function*(){let t=B(n);ri(t.remoteStore)||M("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield function(s){let l=B(s);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>l.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(i===-1)return void e.resolve();let r=t.Qa.get(i)||[];r.push(e),t.Qa.set(i,r)}catch(i){let r=Br(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function Pd(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function kd(n,e,t){let i=B(n),r=i.qa[i.currentUser.toKey()];if(r){let o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),i.qa[i.currentUser.toKey()]=r}}function Rr(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Oa.get(e))n.xa.delete(i),t&&n.Ma.Wa(i,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(i=>{n.ka.containsKey(i)||c0(n,i)})}function c0(n,e){n.Na.delete(e.path.canonicalString());let t=n.La.get(e);t!==null&&(kr(n.remoteStore,t),n.La=n.La.remove(e),n.Ba.delete(t),Dd(n))}function Uh(n,e,t){for(let i of t)i instanceof wl?(n.ka.addReference(i.key,e),wT(n,i)):i instanceof Tl?(M("SyncEngine","Document no longer in limbo: "+i.key),n.ka.removeReference(i.key,e),n.ka.containsKey(i.key)||c0(n,i.key)):U()}function wT(n,e){let t=e.key,i=t.path.canonicalString();n.La.get(t)||n.Na.has(i)||(M("SyncEngine","New document in limbo: "+t),n.Na.add(i),Dd(n))}function Dd(n){for(;n.Na.size>0&&n.La.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new q(se.fromString(e)),i=n.Ka.next();n.Ba.set(i,new Bh(t)),n.La=n.La.insert(t,i),Ll(n.remoteStore,new xr(gt(Fr(t.path)),i,"TargetPurposeLimboResolution",Pt.oe))}}function An(n,e,t){return P(this,null,function*(){let i=B(n),r=[],o=[],s=[];i.xa.isEmpty()||(i.xa.forEach((l,c)=>{s.push(i.Ua(c,e,t).then(h=>{var p;if((h||t)&&i.isPrimaryClient){let f=h?!h.fromCache:(p=t?.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;i.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(h){r.push(h);let f=wh.zi(c.targetId,h);o.push(f)}}))}),yield Promise.all(s),i.Ma.R_(r),yield function(c,h){return P(this,null,function*(){let p=B(c);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>x.forEach(h,_=>x.forEach(_.Wi,E=>p.persistence.referenceDelegate.addReference(f,_.targetId,E)).next(()=>x.forEach(_.Gi,E=>p.persistence.referenceDelegate.removeReference(f,_.targetId,E)))))}catch(f){if(!ni(f))throw f;M("LocalStore","Failed to update sequence numbers: "+f)}for(let f of h){let _=f.targetId;if(!f.fromCache){let E=p.us.get(_),O=E.snapshotVersion,N=E.withLastLimboFreeSnapshotVersion(O);p.us=p.us.insert(_,N)}}})}(i.localStore,o))})}function TT(n,e){return P(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());let i=yield Q_(t.localStore,e);t.currentUser=e,function(o,s){o.Qa.forEach(l=>{l.forEach(c=>{c.reject(new D(S.CANCELLED,s))})}),o.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield An(t,i.Ts)}})}function IT(n,e){let t=B(n),i=t.Ba.get(e);if(i&&i.Fa)return ie().add(i.key);{let r=ie(),o=t.Oa.get(e);if(!o)return r;for(let s of o){let l=t.xa.get(s);r=r.unionWith(l.view.fa)}return r}}function ET(n,e){return P(this,null,function*(){let t=B(n),i=yield hl(t.localStore,e.query,!0),r=e.view.va(i);return t.isPrimaryClient&&Uh(t,e.targetId,r.ba),r})}function CT(n,e){return P(this,null,function*(){let t=B(n);return Y_(t.localStore,e).then(i=>An(t,i))})}function xT(n,e,t,i){return P(this,null,function*(){let r=B(n),o=yield function(l,c){let h=B(l),p=B(h.mutationQueue);return h.persistence.runTransaction("Lookup mutation documents","readonly",f=>p.On(f,c).next(_=>_?h.localDocuments.getDocuments(f,_):x.resolve(null)))}(r.localStore,e);o!==null?(t==="pending"?yield $r(r.remoteStore):t==="acknowledged"||t==="rejected"?(kd(r,e,i||null),Pd(r,e),function(l,c){B(B(l).mutationQueue).Ln(c)}(r.localStore,e)):U(),yield An(r,o)):M("SyncEngine","Cannot apply mutation batch with id: "+e)})}function AT(n,e){return P(this,null,function*(){let t=B(n);if($l(t),Rd(t),e===!0&&t.$a!==!0){let i=t.sharedClientState.getAllActiveQueryTargets(),r=yield Vg(t,i.toArray());t.$a=!0,yield Vh(t.remoteStore,!0);for(let o of r)Ll(t.remoteStore,o)}else if(e===!1&&t.$a!==!1){let i=[],r=Promise.resolve();t.Oa.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?i.push(s):r=r.then(()=>(Rr(t,s),Pr(t.localStore,s,!0))),kr(t.remoteStore,s)}),yield r,yield Vg(t,i),function(s){let l=B(s);l.Ba.forEach((c,h)=>{kr(l.remoteStore,h)}),l.ka.wr(),l.Ba=new Map,l.La=new Ce(q.comparator)}(t),t.$a=!1,yield Vh(t.remoteStore,!1)}})}function Vg(n,e,t){return P(this,null,function*(){let i=B(n),r=[],o=[];for(let s of e){let l,c=i.Oa.get(s);if(c&&c.length!==0){l=yield Sr(i.localStore,gt(c[0]));for(let h of c){let p=i.xa.get(h),f=yield ET(i,p);f.snapshot&&o.push(f.snapshot)}}else{let h=yield X_(i.localStore,s);l=yield Sr(i.localStore,h),yield Sd(i,u0(h),s,!1,l.resumeToken)}r.push(l)}return i.Ma.R_(o),r})}function u0(n){return c_(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function ST(n){return function(t){return B(B(t).persistence).$i()}(B(n).localStore)}function PT(n,e,t,i){return P(this,null,function*(){let r=B(n);if(r.$a)return void M("SyncEngine","Ignoring unexpected query state notification.");let o=r.Oa.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield Y_(r.localStore,h_(o[0])),l=Xo.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Le.EMPTY_BYTE_STRING);yield An(r,s,l);break}case"rejected":yield Pr(r.localStore,e,!0),Rr(r,e,i);break;default:U()}})}function kT(n,e,t){return P(this,null,function*(){let i=$l(n);if(i.$a){for(let r of e){if(i.Oa.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){M("SyncEngine","Adding an already active target "+r);continue}let o=yield X_(i.localStore,r),s=yield Sr(i.localStore,o);yield Sd(i,u0(o),s.targetId,!1,s.resumeToken),Ll(i.remoteStore,s)}for(let r of t)i.Oa.has(r)&&(yield Pr(i.localStore,r,!1).then(()=>{kr(i.remoteStore,r),Rr(i,r)}).catch(ti))}})}function $l(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=l0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_T.bind(null,e),e.Ma.R_=uT.bind(null,e.eventManager),e.Ma.Wa=hT.bind(null,e.eventManager),e}function Rd(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bT.bind(null,e),e}function DT(n,e,t){let i=B(n);(function(o,s,l){return P(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(E,O){let N=B(E),k=Fe(O.createTime);return N.persistence.runTransaction("hasNewerBundle","readonly",H=>N.jr.getBundleMetadata(H,O.id)).then(H=>!!H&&H.createTime.compareTo(k)>=0)}(o.localStore,c))return yield s.close(),l._completeWith(function(E){return{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}}(c)),Promise.resolve(new Set);l._updateProgress(s0(c));let h=new $h(c,o.localStore,s.serializer),p=yield s.Ga();for(;p;){let _=yield h.Pa(p);_&&l._updateProgress(_),p=yield s.Ga()}let f=yield h.complete();return yield An(o,f.Ea,void 0),yield function(E,O){let N=B(E);return N.persistence.runTransaction("Save bundle","readwrite",k=>N.jr.saveBundleMetadata(k,O))}(o.localStore,c),l._completeWith(f.progress),Promise.resolve(f.Ia)}catch(c){return Ut("SyncEngine",`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}})})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}var Vd=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return P(this,null,function*(){this.serializer=ms(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,i){return null}Ya(t,i){return null}Ha(t){return H_(this.persistence,new ul,t.initialUser,this.serializer)}ja(t){return new is(ll.ei,this.serializer)}za(t){return new ml}terminate(){return P(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Gh=class extends Vd{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){j(this.persistence.referenceDelegate instanceof cl);let i=this.persistence.referenceDelegate.garbageCollector;return new ol(i,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?Ct.withCacheSize(this.cacheSizeBytes):Ct.DEFAULT;return new is(i=>cl.ei(i,t),this.serializer)}},El=class n extends Vd{constructor(e,t,i){super(),this.Za=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){yield xc(n.prototype,this,"initialize").call(this,e),yield this.Za.initialize(this,e),yield Rd(this.Za.syncEngine),yield $r(this.Za.remoteStore),yield this.persistence.Si(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}Ha(e){return H_(this.persistence,new ul,e.initialUser,this.serializer)}Ja(e,t){let i=this.persistence.referenceDelegate.garbageCollector;return new ol(i,e.asyncQueue,t)}Ya(e,t){let i=new Iu(t,this.persistence);return new Tu(e.asyncQueue,i)}ja(e){let t=wd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Ct.withCacheSize(this.cacheSizeBytes):Ct.DEFAULT;return new vh(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,e0(),Na(),this.serializer,this.sharedClientState,!!this.forceOwnership)}za(e){return new ml}},jh=class n extends El{constructor(e,t){super(e,t,!1),this.Za=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return P(this,null,function*(){yield xc(n.prototype,this,"initialize").call(this,e);let t=this.Za.syncEngine;this.sharedClientState instanceof Bo&&(this.sharedClientState.syncEngine={io:xT.bind(null,t),so:PT.bind(null,t),oo:kT.bind(null,t),$i:ST.bind(null,t),ro:CT.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Si(i=>P(this,null,function*(){yield AT(this.Za.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}za(e){let t=e0();if(!Bo.p(t))throw new D(S.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=wd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Bo(t,e.asyncQueue,i,e.clientId,e.initialUser)}},Od=(()=>{class n{initialize(t,i){return P(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Rg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=TT.bind(null,this.syncEngine),yield Vh(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Nh}()}createDatastore(t){let i=ms(t.databaseInfo.databaseId),r=function(s){return new Ah(s)}(t.databaseInfo);return function(s,l,c,h){return new kh(s,l,c,h)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,o,s,l,c){return new Rh(r,o,s,l,c)}(this.localStore,this.datastore,t.asyncQueue,i=>Rg(this.syncEngine,i,0),function(){return fl.p()?new fl:new Ch}())}createSyncEngine(t,i){return function(o,s,l,c,h,p,f){let _=new qh(o,s,l,c,h,p);return f&&(_.$a=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return P(this,null,function*(){var t,i;yield function(o){return P(this,null,function*(){let s=B(o);M("RemoteStore","RemoteStore shutting down."),s.k_.add(5),yield Lr(s),s.Q_.shutdown(),s.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();function Og(n,e=10240){let t=0;return{read(){return P(this,null,function*(){if(t<n.byteLength){let r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})},cancel(){return P(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Vr=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Me("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Kh=class{constructor(e,t){this.tu=e,this.serializer=t,this.metadata=new Qe,this.buffer=new Uint8Array,this.nu=function(){return new TextDecoder("utf-8")}(),this.ru().then(i=>{i&&i.la()?this.metadata.resolve(i.ca.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.ca)}`))},i=>this.metadata.reject(i))}close(){return this.tu.cancel()}getMetadata(){return P(this,null,function*(){return this.metadata.promise})}Ga(){return P(this,null,function*(){return yield this.getMetadata(),this.ru()})}ru(){return P(this,null,function*(){let e=yield this.iu();if(e===null)return null;let t=this.nu.decode(e),i=Number(t);isNaN(i)&&this.su(`length string (${t}) is not valid number`);let r=yield this.ou(i);return new Lh(JSON.parse(r),e.length+i)})}_u(){return this.buffer.findIndex(e=>e===123)}iu(){return P(this,null,function*(){for(;this._u()<0&&!(yield this.au()););if(this.buffer.length===0)return null;let e=this._u();e<0&&this.su("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}ou(e){return P(this,null,function*(){for(;this.buffer.length<e;)(yield this.au())&&this.su("Reached the end of bundle when more is expected.");let t=this.nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}su(e){throw this.tu.cancel(),new Error(`Invalid bundle format: ${e}`)}au(){return P(this,null,function*(){let e=yield this.tu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Hh=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new D(S.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(r,o){return P(this,null,function*(){let s=B(r),l={documents:o.map(f=>Zo(s.serializer,f))},c=yield s.ko("BatchGetDocuments",s.serializer.databaseId,se.emptyPath(),l,o.length),h=new Map;c.forEach(f=>{let _=Fw(s.serializer,f);h.set(_.key.toString(),_)});let p=[];return o.forEach(f=>{let _=h.get(f.toString());j(!!_),p.push(_)}),p})}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Zn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{let r=q.fromPath(i);this.mutations.push(new Qo(r,this.precondition(r)))}),yield function(i,r){return P(this,null,function*(){let o=B(i),s={writes:r.map(l=>es(o.serializer,l))};yield o.Oo("Commit",o.serializer.databaseId,se.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw U();t=K.min()}let i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new D(S.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Ve.exists(!1):Ve.updateTime(t):Ve.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new D(S.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ve.updateTime(t)}return Ve.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Qh=class{constructor(e,t,i,r,o){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=o,this.uu=i.maxAttempts,this.r_=new os(this.asyncQueue,"transaction_retry")}cu(){this.uu-=1,this.lu()}lu(){this.r_.jo(()=>P(this,null,function*(){let e=new Hh(this.datastore),t=this.hu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.Pu(r)}))}).catch(i=>{this.Pu(i)})}))}hu(e){try{let t=this.updateFunction(e);return!us(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Pu(e){this.uu>0&&this.Tu(e)?(this.uu-=1,this.asyncQueue.enqueueAndForget(()=>(this.lu(),Promise.resolve()))):this.deferred.reject(e)}Tu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!E_(t)}return!1}};var Wh=class{constructor(e,t,i,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Ue.UNAUTHENTICATED,this.clientId=La.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,s=>P(this,null,function*(){M("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(i,s=>(M("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Qe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Br(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function hu(n,e){return P(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>P(this,null,function*(){i.isEqual(r)||(yield Q_(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Mg(n,e){return P(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Md(n);M("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Pg(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>Pg(e.remoteStore,r)),n._onlineComponents=e})}function Md(n){return P(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield hu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===S.FAILED_PRECONDITION||r.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Ut("Error using user provided cache. Falling back to memory cache: "+t),yield hu(n,new Vd)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield hu(n,new Gh(void 0));return n._offlineComponents})}function zl(n){return P(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield Mg(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield Mg(n,new Od))),n._onlineComponents})}function h0(n){return Md(n).then(e=>e.persistence)}function Nd(n){return Md(n).then(e=>e.localStore)}function d0(n){return zl(n).then(e=>e.remoteStore)}function Fd(n){return zl(n).then(e=>e.syncEngine)}function RT(n){return zl(n).then(e=>e.datastore)}function Or(n){return P(this,null,function*(){let e=yield zl(n),t=e.eventManager;return t.onListen=dT.bind(null,e.syncEngine),t.onUnlisten=mT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fT.bind(null,e.syncEngine),t})}function VT(n){return n.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield h0(n),t=yield d0(n);return e.setNetworkEnabled(!0),function(r){let o=B(r);return o.k_.delete(0),fs(o)}(t)}))}function OT(n){return n.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield h0(n),t=yield d0(n);return e.setNetworkEnabled(!1),function(r){return P(this,null,function*(){let o=B(r);o.k_.add(0),yield Lr(o),o.K_.set("Offline")})}(t)}))}function MT(n,e){let t=new Qe;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,o,s){return P(this,null,function*(){try{let l=yield function(h,p){let f=B(h);return f.persistence.runTransaction("read document","readonly",_=>f.localDocuments.getDocument(_,p))}(r,o);l.isFoundDocument()?s.resolve(l):l.isNoDocument()?s.resolve(null):s.reject(new D(S.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){let c=Br(l,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield Nd(n),e,t)})),t.promise}function p0(n,e,t={}){let i=new Qe;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(o,s,l,c,h){let p=new Vr({next:_=>{p.eu(),s.enqueueAndForget(()=>xd(o,f));let E=_.docs.has(l);!E&&_.fromCache?h.reject(new D(S.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&c&&c.source==="server"?h.reject(new D(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),f=new ss(Fr(l.path),p,{includeMetadataChanges:!0,ua:!0});return Cd(o,f)}(yield Or(n),n.asyncQueue,e,t,i)})),i.promise}function NT(n,e){let t=new Qe;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,o,s){return P(this,null,function*(){try{let l=yield hl(r,o,!0),c=new Il(o,l.ds),h=c.ga(l.documents),p=c.applyChanges(h,!1);s.resolve(p.snapshot)}catch(l){let c=Br(l,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield Nd(n),e,t)})),t.promise}function m0(n,e,t={}){let i=new Qe;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(o,s,l,c,h){let p=new Vr({next:_=>{p.eu(),s.enqueueAndForget(()=>xd(o,f)),_.fromCache&&c.source==="server"?h.reject(new D(S.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),f=new ss(l,p,{includeMetadataChanges:!0,ua:!0});return Cd(o,f)}(yield Or(n),n.asyncQueue,e,t,i)})),i.promise}function FT(n,e){let t=new Vr(e);return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,o){B(r).X_.add(o),o.next()}(yield Or(n),t)})),()=>{t.eu(),n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,o){B(r).X_.delete(o)}(yield Or(n),t)}))}}function LT(n,e,t,i){let r=function(s,l){let c;return c=typeof s=="string"?x_().encode(s):s,function(p,f){return new Kh(p,f)}(function(p,f){if(p instanceof Uint8Array)return Og(p,f);if(p instanceof ArrayBuffer)return Og(new Uint8Array(p),f);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),l)}(t,ms(e));n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){DT(yield Fd(n),r,i)}))}function $T(n,e){return n.asyncQueue.enqueue(()=>P(this,null,function*(){return function(i,r){let o=B(i);return o.persistence.runTransaction("Get named query","readonly",s=>o.jr.getNamedQuery(s,r))}(yield Nd(n),e)}))}function f0(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Ng=new Map;function Ld(n,e,t){if(!t)throw new D(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $d(n,e,t,i){if(e===!0&&i===!0)throw new D(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Fg(n){if(!q.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Lg(n){if(q.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Bl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U()}function ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Bl(n);throw new D(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function g0(n,e){if(e<=0)throw new D(S.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Cl=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new D(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$d("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f0((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ri=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cl({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cl(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new du;switch(i.type){case"firstParty":return new gu(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new D(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return P(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=Ng.get(t);i&&(M("ComponentProvider","Removing Datastore"),Ng.delete(t),i.terminate())}(this),Promise.resolve()}};function _0(n,e,t,i={}){var r;let o=(n=ce(n,Ri))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Ut("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),i.mockUserToken){let l,c;if(typeof i.mockUserToken=="string")l=i.mockUserToken,c=Ue.MOCK_USER;else{l=Wm(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new D(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ue(h)}n._authCredentials=new pu(new Fa(l,c))}}var nt=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},we=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},sn=class n extends nt{constructor(e,t,i){super(e,t,Fr(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new we(this.firestore,null,new q(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function zd(n,e,...t){if(n=Pe(n),Ld("collection","path",e),n instanceof Ri){let i=se.fromString(e,...t);return Lg(i),new sn(n,null,i)}{if(!(n instanceof we||n instanceof sn))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(se.fromString(e,...t));return Lg(i),new sn(n.firestore,null,i)}}function y0(n,e){if(n=ce(n,Ri),Ld("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(S.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new nt(n,null,function(i){return new Gt(se.emptyPath(),i)}(e))}function gs(n,e,...t){if(n=Pe(n),arguments.length===1&&(e=La.newId()),Ld("doc","path",e),n instanceof Ri){let i=se.fromString(e,...t);return Fg(i),new we(n,null,new q(i))}{if(!(n instanceof we||n instanceof sn))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(se.fromString(e,...t));return Fg(i),new we(n.firestore,n instanceof sn?n.converter:null,new q(i))}}function Bd(n,e){return n=Pe(n),e=Pe(e),(n instanceof we||n instanceof sn)&&(e instanceof we||e instanceof sn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function qd(n,e){return n=Pe(n),e=Pe(e),n instanceof nt&&e instanceof nt&&n.firestore===e.firestore&&ds(n._query,e._query)&&n.converter===e.converter}var xl=class{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new os(this,"async_queue_retry"),this.fu=()=>{let i=Na();i&&M("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;let t=Na();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;let t=Na();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});let t=new Qe;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return P(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!ni(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;let r=function(s){let l=s.message||"";return s.stack&&(l=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),l}(i);throw Me("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Ru=!1,i))));return this.gu=t,t}enqueueAfterDelay(e,t,i){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let r=Oh.createAndSchedule(this,e,t,i,o=>this.Su(o));return this.du.push(r),r}pu(){this.Au&&U()}verifyOperationInProgress(){}bu(){return P(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.du)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.du.indexOf(e);this.du.splice(t,1)}};function Jh(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let o of i)if(o in r&&typeof r[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Xh=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Qe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var b0=-1,De=class extends Ri{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new xl,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return P(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xl(e),this._firestoreClient=void 0,yield e}})}};function it(n){if(n._terminated)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||v0(n),n._firestoreClient}function v0(n){var e,t,i;let r=n._freezeSettings(),o=function(l,c,h,p){return new Eu(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,f0(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new Wh(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(l){let c=l?._online.build();return{_offline:l?._offline.build(c),_online:c}}(n._componentsProvider))}function w0(n,e){Ut("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return I0(n,Od.provider,{build:i=>new El(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function T0(n){return P(this,null,function*(){Ut("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();I0(n,Od.provider,{build:t=>new jh(t,e.cacheSizeBytes)})})}function I0(n,e,t){if((n=ce(n,De))._firestoreClient||n._terminated)throw new D(S.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new D(S.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},v0(n)}function E0(n){if(n._initialized&&!n._terminated)throw new D(S.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Qe;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{yield function(i){return P(this,null,function*(){if(!Kn.p())return Promise.resolve();let r=i+"main";yield Kn.delete(r)})}(wd(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function C0(n){return function(t){let i=new Qe;return t.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return vT(yield Fd(t),i)})),i.promise}(it(n=ce(n,De)))}function x0(n){return VT(it(n=ce(n,De)))}function A0(n){return OT(it(n=ce(n,De)))}function S0(n,e){let t=it(n=ce(n,De)),i=new Xh;return LT(t,n._databaseId,e,i),i}function P0(n,e){return $T(it(n=ce(n,De)),e).then(t=>t?new nt(n,null,t.query):null)}var cn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Le.fromBase64String(e))}catch(t){throw new D(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Le.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ht=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Cn=class{constructor(e){this._methodName=e}};var Vi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}};var as=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(this._values,e._values)}};var zT=/^__.*__$/,Yh=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Kt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yn(e,this.data,t,this.fieldTransforms)}},Al=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Kt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function k0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var Sl=class n{constructor(e,t,i,r,o,s){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,o===void 0&&this.Fu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.xu({path:i,Nu:!1});return r.Lu(e),r}Bu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.xu({path:i,Nu:!1});return r.Fu(),r}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Pl(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(k0(this.Mu)&&zT.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},Zh=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ms(e)}$u(e,t,i,r=!1){return new Sl({Mu:e,methodName:t,Ku:i,path:Ne.emptyPath(),Nu:!1,Qu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ni(n){let e=n._freezeSettings(),t=ms(n._databaseId);return new Zh(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ql(n,e,t,i,r,o={}){let s=n.$u(o.merge||o.mergeFields?2:0,e,t,r);jd("Data must be an object, but it was:",s,i);let l=V0(i,s),c,h;if(o.merge)c=new kt(s.fieldMask),h=s.fieldTransforms;else if(o.mergeFields){let p=[];for(let f of o.mergeFields){let _=rd(e,f,t);if(!s.contains(_))throw new D(S.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);M0(p,_)||p.push(_)}c=new kt(p),h=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,h=s.fieldTransforms;return new Yh(new ht(l),c,h)}var ls=class n extends Cn{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function D0(n,e,t){return new Sl({Mu:3,Ku:e.settings.Ku,methodName:n._methodName,Nu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var ed=class n extends Cn{_toFieldTransform(e){return new Pi(e.path,new Jn)}isEqual(e){return e instanceof n}},td=class n extends Cn{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=D0(this,e,!0),i=this.Uu.map(o=>Fi(o,t)),r=new In(i);return new Pi(e.path,r)}isEqual(e){return e instanceof n&&$c(this.Uu,e.Uu)}},nd=class n extends Cn{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){let t=D0(this,e,!0),i=this.Uu.map(o=>Fi(o,t)),r=new En(i);return new Pi(e.path,r)}isEqual(e){return e instanceof n&&$c(this.Uu,e.Uu)}},id=class n extends Cn{constructor(e,t){super(e),this.Wu=t}_toFieldTransform(e){let t=new Xn(e.serializer,__(e.serializer,this.Wu));return new Pi(e.path,t)}isEqual(e){return e instanceof n&&this.Wu===e.Wu}};function Ud(n,e,t,i){let r=n.$u(1,e,t);jd("Data must be an object, but it was:",r,i);let o=[],s=ht.empty();ii(i,(c,h)=>{let p=Kd(e,c,t);h=Pe(h);let f=r.Bu(p);if(h instanceof ls)o.push(p);else{let _=Fi(h,f);_!=null&&(o.push(p),s.set(p,_))}});let l=new kt(o);return new Al(s,l,r.fieldTransforms)}function Gd(n,e,t,i,r,o){let s=n.$u(1,e,t),l=[rd(e,i,t)],c=[r];if(o.length%2!=0)throw new D(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)l.push(rd(e,o[_])),c.push(o[_+1]);let h=[],p=ht.empty();for(let _=l.length-1;_>=0;--_)if(!M0(h,l[_])){let E=l[_],O=c[_];O=Pe(O);let N=s.Bu(E);if(O instanceof ls)h.push(E);else{let k=Fi(O,N);k!=null&&(h.push(E),p.set(E,k))}}let f=new kt(h);return new Al(p,f,s.fieldTransforms)}function R0(n,e,t,i=!1){return Fi(t,n.$u(i?4:3,e))}function Fi(n,e){if(O0(n=Pe(n)))return jd("Unsupported field value:",e,n),V0(n,e);if(n instanceof Cn)return function(i,r){if(!k0(r.Mu))throw r.qu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.qu(`${i._methodName}() is not currently supported inside arrays`);let o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(i,r){let o=[],s=0;for(let l of i){let c=Fi(l,r.ku(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(i,r){if((i=Pe(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return __(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let o=ke.fromDate(i);return{timestampValue:Cr(r.serializer,o)}}if(i instanceof ke){let o=new ke(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Cr(r.serializer,o)}}if(i instanceof Vi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof cn)return{bytesValue:A_(r.serializer,i._byteString)};if(i instanceof we){let o=r.databaseId,s=i.firestore._databaseId;if(!s.isEqual(o))throw r.qu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:yd(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof as)return function(s,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw l.qu("VectorValues must only contain numeric values.");return _d(l.serializer,c)})}}}}}}(i,r);throw r.qu(`Unsupported field value: ${Bl(i)}`)}(n,e)}function V0(n,e){let t={};return Zg(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(n,(i,r)=>{let o=Fi(r,e.Ou(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function O0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ke||n instanceof Vi||n instanceof cn||n instanceof we||n instanceof Cn||n instanceof as)}function jd(n,e,t){if(!O0(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=Bl(t);throw i==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+i)}}function rd(n,e,t){if((e=Pe(e))instanceof Ht)return e._internalPath;if(typeof e=="string")return Kd(n,e);throw Pl("Field path arguments must be of type string or ",n,!1,void 0,t)}var BT=new RegExp("[~\\*/\\[\\]]");function Kd(n,e,t){if(e.search(BT)>=0)throw Pl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ht(...e.split("."))._internalPath}catch{throw Pl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Pl(n,e,t,i,r){let o=i&&!i.isEmpty(),s=r!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${i}`),s&&(c+=` in document ${r}`),c+=")"),new D(S.INVALID_ARGUMENT,l+n+c)}function M0(n,e){return n.some(t=>t.isEqual(e))}var Oi=class{constructor(e,t,i,r,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new we(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new od(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ul("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},od=class extends Oi{data(){return super.data()}};function Ul(n,e){return typeof e=="string"?Kd(n,e):e instanceof Ht?e._internalPath:e._delegate._internalPath}function N0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var cs=class{},Mi=class extends cs{};function Sn(n,e,...t){let i=[];e instanceof cs&&i.push(e),i=i.concat(t),function(o){let s=o.filter(c=>c instanceof sd).length,l=o.filter(c=>c instanceof kl).length;if(s>1||s>0&&l>0)throw new D(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let r of i)n=r._apply(n);return n}var kl=class n extends Mi{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return K0(e._query,t),new nt(e.firestore,e.converter,Fu(e._query,t))}_parse(e){let t=Ni(e.firestore);return function(o,s,l,c,h,p,f){let _;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new D(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){zg(f,p);let E=[];for(let O of f)E.push($g(c,o,O));_={arrayValue:{values:E}}}else _=$g(c,o,f)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||zg(f,p),_=R0(l,s,f,p==="in"||p==="not-in");return re.create(h,p,_)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function F0(n,e,t){let i=e,r=Ul("where",n);return kl._create(r,i,t)}var sd=class n extends cs{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:pe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,o){let s=r,l=o.getFlattenedFilters();for(let c of l)K0(s,c),s=Fu(s,c)}(e._query,t),new nt(e.firestore,e.converter,Fu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ad=class n extends Mi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(r,o,s){if(r.startAt!==null)throw new D(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new D(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ai(o,s)}(e._query,this._field,this._direction);return new nt(e.firestore,e.converter,function(r,o){let s=r.explicitOrderBy.concat([o]);return new Gt(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}};function L0(n,e="asc"){let t=e,i=Ul("orderBy",n);return ad._create(i,t)}var Dl=class n extends Mi{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new nt(e.firestore,e.converter,Qa(e._query,this._limit,this._limitType))}};function $0(n){return g0("limit",n),Dl._create("limit",n,"F")}function z0(n){return g0("limitToLast",n),Dl._create("limitToLast",n,"L")}var Rl=class n extends Mi{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=j0(e,this.type,this._docOrFields,this._inclusive);return new nt(e.firestore,e.converter,function(r,o){return new Gt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,o,r.endAt)}(e._query,t))}};function B0(...n){return Rl._create("startAt",n,!0)}function q0(...n){return Rl._create("startAfter",n,!1)}var Vl=class n extends Mi{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=j0(e,this.type,this._docOrFields,this._inclusive);return new nt(e.firestore,e.converter,function(r,o){return new Gt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,o)}(e._query,t))}};function U0(...n){return Vl._create("endBefore",n,!1)}function G0(...n){return Vl._create("endAt",n,!0)}function j0(n,e,t,i){if(t[0]=Pe(t[0]),t[0]instanceof Oi)return function(o,s,l,c,h){if(!c)throw new D(S.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);let p=[];for(let f of _r(o))if(f.field.isKeyField())p.push(xi(s,c.key));else{let _=c.data.field(f.field);if(Ml(_))throw new D(S.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(_===null){let E=f.field.canonicalString();throw new D(S.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}p.push(_)}return new ln(p,h)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Ni(n.firestore);return function(s,l,c,h,p,f){let _=s.explicitOrderBy;if(p.length>_.length)throw new D(S.INVALID_ARGUMENT,`Too many arguments provided to ${h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let E=[];for(let O=0;O<p.length;O++){let N=p[O];if(_[O].field.isKeyField()){if(typeof N!="string")throw new D(S.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${h}(), but got a ${typeof N}`);if(!fd(s)&&N.indexOf("/")!==-1)throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${h}() must be a plain document ID, but '${N}' contains a slash.`);let k=s.path.child(se.fromString(N));if(!q.isDocumentKey(k))throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${h}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);let H=new q(k);E.push(xi(l,H))}else{let k=R0(c,h,N);E.push(k)}}return new ln(E,f)}(n._query,n.firestore._databaseId,r,e,t,i)}}function $g(n,e,t){if(typeof(t=Pe(t))=="string"){if(t==="")throw new D(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fd(e)&&t.indexOf("/")!==-1)throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(se.fromString(t));if(!q.isDocumentKey(i))throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return xi(n,new q(i))}if(t instanceof we)return xi(n,t._key);throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bl(t)}.`)}function zg(n,e){if(!Array.isArray(n)||n.length===0)throw new D(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function K0(n,e){let t=function(r,o){for(let s of r)for(let l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new D(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Mr=class{convertValue(e,t="none"){switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return ii(e,(r,o)=>{i[r]=this.convertValue(o,t)}),i}convertVectorValue(e){var t,i,r;let o=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(s=>Se(s.doubleValue));return new as(o)}convertGeoPoint(e){return new Vi(Se(e.latitude),Se(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Nl(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(jo(e));default:return null}}convertTimestamp(e){let t=wn(e);return new ke(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=se.fromString(e);j(L_(i));let r=new Hn(i.get(1),i.get(3)),o=new q(i.popFirst(5));return r.isEqual(t)||Me(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Gl(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var ld=class extends Mr{constructor(e){super(),this.firestore=e}convertBytes(e){return new cn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new we(this.firestore,null,t)}};var vn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Mt=class extends Oi{constructor(e,t,i,r,o,s){super(e,t,i,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Gn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Ul("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},Gn=class extends Mt{data(e={}){return super.data(e)}},Qt=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new vn(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Gn(this._firestore,this._userDataWriter,i.key,i,new vn(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(l=>{let c=new Gn(r._firestore,r._userDataWriter,l.doc.key,l.doc,new vn(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{let c=new Gn(r._firestore,r._userDataWriter,l.doc.key,l.doc,new vn(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),h=-1,p=-1;return l.type!==0&&(h=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),p=s.indexOf(l.doc.key)),{type:qT(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function qT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}function Hd(n,e){return n instanceof Mt&&e instanceof Mt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Qt&&e instanceof Qt&&n._firestore===e._firestore&&qd(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function H0(n){n=ce(n,we);let e=ce(n.firestore,De);return p0(it(e),n._key).then(t=>Xd(e,n,t))}var xn=class extends Mr{constructor(e){super(),this.firestore=e}convertBytes(e){return new cn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new we(this.firestore,null,t)}};function Q0(n){n=ce(n,we);let e=ce(n.firestore,De),t=it(e),i=new xn(e);return MT(t,n._key).then(r=>new Mt(e,i,n._key,r,new vn(r!==null&&r.hasLocalMutations,!0),n.converter))}function W0(n){n=ce(n,we);let e=ce(n.firestore,De);return p0(it(e),n._key,{source:"server"}).then(t=>Xd(e,n,t))}function J0(n){n=ce(n,nt);let e=ce(n.firestore,De),t=it(e),i=new xn(e);return N0(n._query),m0(t,n._query).then(r=>new Qt(e,i,n,r))}function X0(n){n=ce(n,nt);let e=ce(n.firestore,De),t=it(e),i=new xn(e);return NT(t,n._query).then(r=>new Qt(e,i,n,r))}function Y0(n){n=ce(n,nt);let e=ce(n.firestore,De),t=it(e),i=new xn(e);return m0(t,n._query,{source:"server"}).then(r=>new Qt(e,i,n,r))}function Qd(n,e,t){n=ce(n,we);let i=ce(n.firestore,De),r=Gl(n.converter,e,t);return qr(i,[ql(Ni(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Ve.none())])}function Wd(n,e,t,...i){n=ce(n,we);let r=ce(n.firestore,De),o=Ni(r),s;return s=typeof(e=Pe(e))=="string"||e instanceof Ht?Gd(o,"updateDoc",n._key,e,t,i):Ud(o,"updateDoc",n._key,e),qr(r,[s.toMutation(n._key,Ve.exists(!0))])}function Z0(n){return qr(ce(n.firestore,De),[new Zn(n._key,Ve.none())])}function ey(n,e){let t=ce(n.firestore,De),i=gs(n),r=Gl(n.converter,e);return qr(t,[ql(Ni(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Ve.exists(!1))]).then(()=>i)}function Jd(n,...e){var t,i,r;n=Pe(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Jh(e[s])||(o=e[s],s++);let l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Jh(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(i=f.error)===null||i===void 0?void 0:i.bind(f),e[s+2]=(r=f.complete)===null||r===void 0?void 0:r.bind(f)}let c,h,p;if(n instanceof we)h=ce(n.firestore,De),p=Fr(n._key.path),c={next:f=>{e[s]&&e[s](Xd(h,n,f))},error:e[s+1],complete:e[s+2]};else{let f=ce(n,nt);h=ce(f.firestore,De),p=f._query;let _=new xn(h);c={next:E=>{e[s]&&e[s](new Qt(h,_,f,E))},error:e[s+1],complete:e[s+2]},N0(n._query)}return function(_,E,O,N){let k=new Vr(N),H=new ss(E,k,O);return _.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Cd(yield Or(_),H)})),()=>{k.eu(),_.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return xd(yield Or(_),H)}))}}(it(h),p,l,c)}function ty(n,e){return FT(it(n=ce(n,De)),Jh(e)?e:{next:e})}function qr(n,e){return function(i,r){let o=new Qe;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return gT(yield Fd(i),r,o)})),o.promise}(it(n),e)}function Xd(n,e,t){let i=t.docs.get(e._key),r=new xn(n);return new Mt(n,r,e._key,i,new vn(t.hasPendingWrites,t.fromCache),e.converter)}var UT={maxAttempts:5};var Ol=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ni(e)}set(e,t,i){this._verifyNotCommitted();let r=qn(e,this._firestore),o=Gl(r.converter,t,i),s=ql(this._dataReader,"WriteBatch.set",r._key,o,r.converter!==null,i);return this._mutations.push(s.toMutation(r._key,Ve.none())),this}update(e,t,i,...r){this._verifyNotCommitted();let o=qn(e,this._firestore),s;return s=typeof(t=Pe(t))=="string"||t instanceof Ht?Gd(this._dataReader,"WriteBatch.update",o._key,t,i,r):Ud(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Ve.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=qn(e,this._firestore);return this._mutations=this._mutations.concat(new Zn(t._key,Ve.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(S.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function qn(n,e){if((n=Pe(n)).firestore!==e)throw new D(S.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var cd=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=Ni(t)}get(t){let i=qn(t,this._firestore),r=new ld(this._firestore);return this._transaction.lookup([i._key]).then(o=>{if(!o||o.length!==1)return U();let s=o[0];if(s.isFoundDocument())return new Oi(this._firestore,r,s.key,s,i.converter);if(s.isNoDocument())return new Oi(this._firestore,r,i._key,null,i.converter);throw U()})}set(t,i,r){let o=qn(t,this._firestore),s=Gl(o.converter,i,r),l=ql(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,r);return this._transaction.set(o._key,l),this}update(t,i,r,...o){let s=qn(t,this._firestore),l;return l=typeof(i=Pe(i))=="string"||i instanceof Ht?Gd(this._dataReader,"Transaction.update",s._key,i,r,o):Ud(this._dataReader,"Transaction.update",s._key,i),this._transaction.update(s._key,l),this}delete(t){let i=qn(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=qn(e,this._firestore),i=new xn(this._firestore);return super.get(e).then(r=>new Mt(this._firestore,i,t._key,r._document,new vn(!1,!1),t.converter))}};function ny(n,e,t){n=ce(n,De);let i=Object.assign(Object.assign({},UT),t);return function(o){if(o.maxAttempts<1)throw new D(S.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(o,s,l){let c=new Qe;return o.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){let h=yield RT(o);new Qh(o.asyncQueue,h,l,s,c).cu()})),c.promise}(it(n),r=>e(new cd(n,r)),i)}function iy(){return new ls("deleteField")}function ry(){return new ed("serverTimestamp")}function oy(...n){return new td("arrayUnion",n)}function sy(...n){return new nd("arrayRemove",n)}function ay(n){return new id("increment",n)}(function(e,t=!0){(function(r){Nr=r})(Ym),wo(new gi("firestore",(i,{instanceIdentifier:r,options:o})=>{let s=i.getProvider("app").getImmediate(),l=new De(new mu(i.getProvider("auth-internal")),new yu(i.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new D(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hn(h.options.projectId,p)}(s,r),s);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Nn($f,"4.7.5",e),Nn($f,"4.7.5","esm2017")})();var GT="@firebase/firestore-compat",jT="0.3.40";function ip(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function ly(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function cy(){if(!e_())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}var jl=class n{constructor(e){this._delegate=e}static fromBase64String(e){return cy(),new n(cn.fromBase64String(e))}static fromUint8Array(e){return ly(),new n(cn.fromUint8Array(e))}toBase64(){return cy(),this._delegate.toBase64()}toUint8Array(){return ly(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Yd(n){return KT(n,["next","error","complete"])}function KT(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var Zd=class{enableIndexedDbPersistence(e,t){return w0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return T0(e._delegate)}clearIndexedDbPersistence(e){return E0(e._delegate)}},Kl=class{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Hn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ut("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){_0(this._delegate,e,t,i)}enableNetwork(){return x0(this._delegate)}disableNetwork(){return A0(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,$d("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return C0(this._delegate)}onSnapshotsInSync(e){return ty(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jr(this,zd(this._delegate,e))}catch(t){throw _t(t,"collection()","Firestore.collection()")}}doc(e){try{return new un(this,gs(this._delegate,e))}catch(t){throw _t(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Bi(this,y0(this._delegate,e))}catch(t){throw _t(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return ny(this._delegate,t=>e(new Hl(this,t)))}batch(){return it(this._delegate),new Ql(new Ol(this._delegate,e=>qr(this._delegate,e)))}loadBundle(e){return S0(this._delegate,e)}namedQuery(e){return P0(this._delegate,e).then(t=>t?new Bi(this,t):null)}},Ur=class extends Mr{constructor(e){super(),this.firestore=e}convertBytes(e){return new jl(new cn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return un.forKey(t,this.firestore,null)}};function HT(n){Bg(n)}var Hl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}get(e){let t=Li(e);return this._delegate.get(t).then(i=>new $i(this._firestore,new Mt(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){let r=Li(e);return i?(ip("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let o=Li(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...r),this}delete(e){let t=Li(e);return this._delegate.delete(t),this}},Ql=class{constructor(e){this._delegate=e}set(e,t,i){let r=Li(e);return i?(ip("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let o=Li(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...r),this}delete(e){let t=Li(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Gr=class n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){let i=new Gn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zi(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let i=n.INSTANCES,r=i.get(e);r||(r=new WeakMap,i.set(e,r));let o=r.get(t);return o||(o=new n(e,new Ur(e),t),r.set(t,o)),o}};Gr.INSTANCES=new WeakMap;var un=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}static forPath(e,t,i){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new we(t._delegate,i,new q(e)))}static forKey(e,t,i){return new n(t,new we(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new jr(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jr(this.firestore,zd(this._delegate,e))}catch(t){throw _t(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Pe(e),e instanceof we?Bd(this._delegate,e):!1}set(e,t){t=ip("DocumentReference.set",t);try{return t?Qd(this._delegate,e,t):Qd(this._delegate,e)}catch(i){throw _t(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?Wd(this._delegate,e):Wd(this._delegate,e,t,...i)}catch(r){throw _t(r,"updateDoc()","DocumentReference.update()")}}delete(){return Z0(this._delegate)}onSnapshot(...e){let t=uy(e),i=hy(e,r=>new $i(this.firestore,new Mt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Jd(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=Q0(this._delegate):e?.source==="server"?t=W0(this._delegate):t=H0(this._delegate),t.then(i=>new $i(this.firestore,new Mt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function _t(n,e,t){return n.message=n.message.replace(e,t),n}function uy(n){for(let e of n)if(typeof e=="object"&&!Yd(e))return e;return{}}function hy(n,e){var t,i;let r;return Yd(n[0])?r=n[0]:Yd(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:o=>{r.next&&r.next(e(o))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var $i=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new un(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Hd(this._delegate,e._delegate)}},zi=class extends $i{data(e){let t=this._delegate.data(e);return this._delegate._converter||qg(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Bi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}where(e,t,i){try{return new n(this.firestore,Sn(this._delegate,F0(e,t,i)))}catch(r){throw _t(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Sn(this._delegate,L0(e,t)))}catch(i){throw _t(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Sn(this._delegate,$0(e)))}catch(t){throw _t(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Sn(this._delegate,z0(e)))}catch(t){throw _t(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Sn(this._delegate,B0(...e)))}catch(t){throw _t(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Sn(this._delegate,q0(...e)))}catch(t){throw _t(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Sn(this._delegate,U0(...e)))}catch(t){throw _t(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Sn(this._delegate,G0(...e)))}catch(t){throw _t(t,"endAt()","Query.endAt()")}}isEqual(e){return qd(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=X0(this._delegate):e?.source==="server"?t=Y0(this._delegate):t=J0(this._delegate),t.then(i=>new _s(this.firestore,new Qt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){let t=uy(e),i=hy(e,r=>new _s(this.firestore,new Qt(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Jd(this._delegate,t,i)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},ep=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},_s=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Bi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new ep(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new zi(this._firestore,i))})}isEqual(e){return Hd(this._delegate,e._delegate)}},jr=class n extends Bi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new un(this.firestore,e):null}doc(e){try{return e===void 0?new un(this.firestore,gs(this._delegate)):new un(this.firestore,gs(this._delegate,e))}catch(t){throw _t(t,"doc()","CollectionReference.doc()")}}add(e){return ey(this._delegate,e).then(t=>new un(this.firestore,t))}isEqual(e){return Bd(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Li(n){return ce(n,we)}var tp=class n{constructor(...e){this._delegate=new Ht(...e)}static documentId(){return new n(Ne.keyField().canonicalString())}isEqual(e){return e=Pe(e),e instanceof Ht?this._delegate._internalPath.isEqual(e._internalPath):!1}};var np=class n{static serverTimestamp(){let e=ry();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=iy();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=oy(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=sy(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=ay(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var QT={Firestore:Kl,GeoPoint:Vi,Timestamp:ke,Blob:jl,Transaction:Hl,WriteBatch:Ql,DocumentReference:un,DocumentSnapshot:$i,Query:Bi,QueryDocumentSnapshot:zi,QuerySnapshot:_s,CollectionReference:jr,FieldPath:tp,FieldValue:np,setLogLevel:HT,CACHE_SIZE_UNLIMITED:b0};function WT(n,e){n.INTERNAL.registerComponent(new gi("firestore-compat",t=>{let i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},QT)))}function JT(n){WT(n,(e,t)=>new Kl(e,t,new Zd)),n.registerVersion(GT,jT)}JT(Et);function XT(n,e=Ms){return new Ki(t=>{let i;return e!=null?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}function dy(n,e){return XT(n,e)}function YT(n,e){return dy(n,e).pipe($s(void 0),Fs(),Ye(t=>{let[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function sp(n,e){return dy(n,e).pipe(Ye(t=>({payload:t,type:"query"})))}var Wl=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let i=this.ref.collection(e),{ref:r,query:o}=_y(i,t);return new Xl(r,o,this.afs)}snapshotChanges(){return YT(this.ref,this.afs.schedulers.outsideAngular).pipe(Tt())}valueChanges(e={}){return this.snapshotChanges().pipe(Ye(({payload:t})=>e.idField?Cc(Ft({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Vn(this.ref.get(e)).pipe(Tt())}};function Jl(n,e){return sp(n,e).pipe($s(void 0),Fs(),Ye(t=>{let[i,r]=t,o=r.payload.docChanges(),s=o.map(l=>({type:l.type,payload:l}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,c)=>{let h=o.find(f=>f.doc.ref.isEqual(l.ref)),p=i?.payload.docs.find(f=>f.ref.isEqual(l.ref));h&&JSON.stringify(h.doc.metadata)===JSON.stringify(l.metadata)||!h&&p&&JSON.stringify(p.metadata)===JSON.stringify(l.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:l}})}),s}))}function py(n,e,t){return Jl(n,t).pipe(Ls((i,r)=>ZT(i,r.map(o=>o.payload),e),[]),hm(),Ye(i=>i.map(r=>({type:r.type,payload:r}))))}function ZT(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=eI(n,i))}),n}function rp(n,e,t,...i){let r=n.slice();return r.splice(e,t,...i),r}function eI(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return rp(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return rp(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return rp(n,e.oldIndex,1);break}return n}function my(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Xl=class{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=Jl(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Ye(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe($s(void 0),Fs(),po(([i,r])=>r.length>0||!i),Ye(([,i])=>i),Tt())}auditTrail(e){return this.stateChanges(e).pipe(Ls((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=my(e);return py(this.query,t,this.afs.schedulers.outsideAngular).pipe(Tt())}valueChanges(e={}){return sp(this.query,this.afs.schedulers.outsideAngular).pipe(Ye(t=>t.payload.docs.map(i=>e.idField?Cc(Ft({},i.data()),{[e.idField]:i.id}):i.data())),Tt())}get(e){return Vn(this.query.get(e)).pipe(Tt())}add(e){return this.ref.add(e)}doc(e){return new Wl(this.ref.doc(e),this.afs)}},op=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Jl(this.query,this.afs.schedulers.outsideAngular).pipe(Tt()):Jl(this.query,this.afs.schedulers.outsideAngular).pipe(Ye(t=>t.filter(i=>e.indexOf(i.type)>-1)),po(t=>t.length>0),Tt())}auditTrail(e){return this.stateChanges(e).pipe(Ls((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=my(e);return py(this.query,t,this.afs.schedulers.outsideAngular).pipe(Tt())}valueChanges(e={}){return sp(this.query,this.afs.schedulers.outsideAngular).pipe(Ye(i=>i.payload.docs.map(r=>e.idField?Ft({[e.idField]:r.id},r.data()):r.data())),Tt())}get(e){return Vn(this.query.get(e)).pipe(Tt())}},fy=new Ze("angularfire2.enableFirestorePersistence"),gy=new Ze("angularfire2.firestore.persistenceSettings"),tI=new Ze("angularfire2.firestore.settings"),nI=new Ze("angularfire2.firestore.use-emulator");function _y(n,e=t=>t){return{query:e(n),ref:n}}var ap=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,o,s,l,c,h,p,f,_,E,O,N,k,H,W){this.schedulers=c;let z=Po(t,l,i),J=p;f&&eu(z,l,_,O,N,k,E,H),[this.firestore,this.persistenceEnabled$]=Ia(`${z.name}.firestore`,"AngularFirestore",z.name,()=>{let ee=l.runOutsideAngular(()=>z.firestore());if(o&&ee.settings(o),J&&ee.useEmulator(...J),r&&!Hs(s)){let te=()=>{try{return Vn(ee.enablePersistence(h||void 0).then(()=>!0,()=>!1))}catch(v){return typeof console<"u"&&console.warn(v),On(!1)}};return[ee,l.runOutsideAngular(te)]}else return[ee,On(!1)]},[o,J,r])}collection(t,i){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:o,query:s}=_y(r,i),l=je(et).run(()=>o);return new Xl(l,s,this)}collectionGroup(t,i){let r=i||(s=>s),o=this.firestore.collectionGroup(t);return new op(r(o),this)}doc(t){let i;typeof t=="string"?i=this.firestore.doc(t):i=t;let r=je(et).run(()=>i);return new Wl(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(ne(ir),ne(rr,8),ne(fy,8),ne(tI,8),ne(Wt),ne(et),ne(va),ne(gy,8),ne(nI,8),ne(Nf,8),ne(Qc,8),ne(Wc,8),ne(Jc,8),ne(Xc,8),ne(Yc,8),ne(Zc,8),ne(_i,8))};static \u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),yy=(()=>{class n{constructor(){Et.registerVersion("angularfire",Ao.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:fy,useValue:!0},{provide:gy,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ze({type:n});static \u0275inj=$e({providers:[ap]})}return n})();var Yl=(()=>{class n{constructor(t){this.db=t,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(t){return this.puzzleDataRef.add(Ft({},t))}update(t,i){return this.puzzleDataRef.doc(t).update(i)}delete(t){return this.puzzleDataRef.doc(t).delete()}static{this.\u0275fac=function(i){return new(i||n)(ne(ap))}}static{this.\u0275prov=Oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var oI=["arithmeticOperations"];function sI(n,e){if(n&1&&(F(0,"li",13),me(1),$()),n&2){let t=e.$implicit;R(),St(" ",t," ")}}function aI(n,e){if(n&1&&(F(0,"li",13),me(1),$()),n&2){let t=e.$implicit;R(),St(" ",t," ")}}var Zl=(()=>{class n{constructor(t,i,r,o,s){this.messageService=t,this.cookieService=i,this.clipboardService=r,this.numbersFirestoreService=o,this.stageCommunicationService=s,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new ra,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw",this.destroyRef=je(mm),this.defaultGameParameters={result:0,operands:[],stageIndex:0},this.updateStageLevel=this.stageCommunicationService.getUpdatedStageLevel().pipe(Nm(this.destroyRef)).subscribe({next:l=>{console.log("StageLevel updated "+l.index)},error:l=>console.error("StageLevel updated "+l),complete:()=>console.info("StageLevel updated Complete")})}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(t){let i=`Completed! Executed Operations:
`,r=t.size()-1;for(;r>=0;){let o=t.peekBy(r);i+=r+1+". "+o?.operands[0]+" "+o?.operator+" "+o?.operands[1]+" = "+o?.result+`
`,--r}return i}createSummaryOfTHeOperations(t,i){let r=this.stageLevels[t].value+" -> ";for(this.gameCompletedModalMessages=[];i.size()>0;){let o=i.pop();this.gameCompletedModalMessages.push(o?.operands[0]+" "+o.operator+" "+o?.operands[1]+" = "+o?.result),r+=""+o?.operator}return r+=`
`,r}showSuccessMessage(t){this.messageService.add({severity:"success",summary:"Congratulation!",detail:t})}showErrorMessage(t){this.messageService.add({severity:"error",summary:"Error!",detail:t})}setupStages(){let t=0;this.gameParameters.forEach(i=>{this.stageLevels[t].value=i.result,++t})}storeGameStateToCookie(){let t=new Eo;t.storeDate=new Date,t.stageIndex=this.stageIndex,t.stageLevels=this.stageLevels,t.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,t.gameParameters=this.gameParameters;let i=t.cookieData2Text(),r=new Date;r.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,i,r)}restoreGameStateFromCookie(){let t=this.cookieService.get(this.COOKIE_LK_DIGITS),i;return!t||t==""?(console.log("INFO: Unable to retrieve the Game State"),i=null):(i=new Eo,i=i.text2CookieData(t)),i}mapPuzzleDataToGameParameters(t){t.stages.forEach(i=>{let r=this.gameParameters.find(o=>o.stageIndex===i.stageIndex);if(r){r.result=i.expectedValue;let o=0;r.operands.forEach(l=>{l.value=i.operands[o],o++}),this.initializeStageLevels();let s=this.stageLevels.find(l=>l.index===i.stageIndex);s&&s.value==i.expectedValue}})}mapGameParametersToPuzzleData(t){let i=new sa;return i.day=new Date,i.day.setHours(23,59,59,999),t.forEach(r=>{let o=new aa;o.stageIndex=r.stageIndex,o.expectedValue=r.result;let s=new Array;r.operands.forEach(l=>{s.push(l.value)}),o.operands=s,i.stages.push(o)}),i}isDateSame(t,i){return t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}updatePuzzleDataInDb(t){this.firestorePuzzleData.data=JSON.stringify(t),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(i=>console.log(i))}createPuzzleDataInDb(t){this.numbersFirestoreService.create(t).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){let t=navigator.language;return this.firestorePuzzleDataItems.find(r=>r.locale===t)!==void 0}upsertGameDataInDb(t){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(t);else{let i=new Co;i.locale=navigator.language,i.data=JSON.stringify(t),this.createPuzzleDataInDb(i)}}allGameCompleted(){let t=!0;return this.stageLevels.forEach(i=>{t=t&&i.completed}),t}collectAllOperations(){let t=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(t){let i=`Genius!
`;this.allGameCompletedModalMessage=[],this.stageLevels.forEach(r=>{i+=r.summary,this.allGameCompletedModalMessage.push(r.summary)}),this.clipboardService.copy(i),this.storeGameStateToCookie(),this.allGameCompletedModalVisible=!0}return t}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let t=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(t)}ngOnInit(){console.log(`Browser locale: ${navigator.language}`),this.initializeStageLevels();let t=this.restoreGameStateFromCookie();if(t){console.log("INFO: Game state restored from cookie");let i=new Date(t.storeDate);if(this.isDateSame(i,new Date))this.stageIndex=t.stageIndex,this.stageLevels=t.stageLevels,this.gameParameters=t.gameParameters,this.setupStages(),t.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let r=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+r),this.upsertGameDataInDb(r)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();let i=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe(Ye(r=>r.map(o=>Ft({id:o.payload.doc.id},o.payload.doc.data())))).subscribe(r=>{this.firestorePuzzleDataItems=r;let o=r.find(s=>s.locale===i);if(o){this.firestorePuzzleData=o,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");let s=new Date,l=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(l,s))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let c=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(c)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let s=this.mapGameParametersToPuzzleData(this.gameParameters),l=new Co;l.locale=navigator.language,l.data=JSON.stringify(s),this.createPuzzleDataInDb(l)}})}}ngOnDestroy(){this.updateStageLevel.unsubscribe()}expectedResultReached(t){let i=this.formatOperations(t),r=this.createSummaryOfTHeOperations(this.stageIndex,t);this.stageLevels[this.stageIndex].summary=r,this.clipboardService.copy(i),this.showSuccessMessage("You are reach the expected result!"),this.stageToCompleted(),this.reachedValue=this.gameParameters[this.stageIndex].result,this.gameCompletedModalVisible=!0}hideGameCompletedDialog(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}invalidOperationExecuted(t){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(t)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}static{this.\u0275fac=function(i){return new(i||n)(ft(Yi),ft(oa),ft(yf),ft(Yl),ft(fa))}}static{this.\u0275cmp=de({type:n,selectors:[["app-digits-game"]],viewQuery:function(i,r){if(i&1&&mn(oI,7),i&2){let o;be(o=ve())&&(r.arithmeticComponent=o.first)}},features:[Xt([Yi,oa])],decls:31,vars:14,consts:[["arithmeticOperations",""],[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"expectedResultReached","invalidOperationExecuted","gameParameters"],["id","splashscreen","header","Welcome to the Numbers Puzzle Game",3,"visibleChange","visible","modal"],["id","gameCompleted","header","Game Completed",3,"visibleChange","onHide","visible","modal"],[1,"li-no-bullet"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visibleChange","visible","modal","closable"]],template:function(i,r){if(i&1){let o=Ke();F(0,"div",1),Q(1,"p-toast",2),F(2,"div",3),me(3," This is a daily numbers puzzle, similar to the "),F(4,"a",4),me(5,"NY Times Digits"),$(),me(6,", which unfortunately discontinued at August 8, 2023 "),$(),F(7,"div",5)(8,"div",6),Ae("click",function(){return ae(o),le(r.onDeleteCookie())}),me(9," Numbers "),$(),F(10,"div",7),Ae("click",function(){return ae(o),le(r.onUpdatePuzzleData())}),me(11),Im(12,"date"),$()(),F(13,"div",8),Q(14,"app-game-stage-levels",9),$(),F(15,"div")(16,"app-game-arithmetic-operations",10,0),Ae("expectedResultReached",function(l){return ae(o),le(r.expectedResultReached(l))})("invalidOperationExecuted",function(l){return ae(o),le(r.invalidOperationExecuted(l))}),$()()(),F(18,"p-dialog",11),js("visibleChange",function(l){return ae(o),Gs(r.splashVisible,l)||(r.splashVisible=l),le(l)}),F(19,"p"),me(20,"It can improves your arithmetic combination ability."),$()(),F(21,"p-dialog",12),js("visibleChange",function(l){return ae(o),Gs(r.gameCompletedModalVisible,l)||(r.gameCompletedModalVisible=l),le(l)}),Ae("onHide",function(){return ae(o),le(r.hideGameCompletedDialog())}),F(22,"div"),me(23),Rt(24,sI,2,1,"li",13,ui),$()(),F(26,"p-dialog",14),js("visibleChange",function(l){return ae(o),Gs(r.allGameCompletedModalVisible,l)||(r.allGameCompletedModalVisible=l),le(l)}),F(27,"div"),me(28," Congratulation! Your Solutions: "),Rt(29,aI,2,1,"li",13,ui),$()()}if(i&2){let o;R(11),St(" ",Em(12,11,r.currentDate,"MM/dd/yyyy")," "),R(3),V("stageLevels",r.stageLevels),R(2),V("gameParameters",(o=r.gameParameters[r.stageIndex])!==null&&o!==void 0?o:r.defaultGameParameters),R(2),Us("visible",r.splashVisible),V("modal",!0),R(3),Us("visible",r.gameCompletedModalVisible),V("modal",!0),R(2),St(" Target ",r.reachedValue,". Your solution: "),R(),Vt(r.gameCompletedModalMessages),R(2),Us("visible",r.allGameCompletedModalVisible),V("modal",!0)("closable",!1),R(3),Vt(r.allGameCompletedModalMessage)}},dependencies:[ma,zc,_a,na,ya,Bc,Pm],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:50vw;position:absolute;inset:0;margin:auto;background:#ebf9fd40;border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:90vh;width:99vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}.digits-game-layout[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]})}}return n})();var lI=[{path:"digits/digits-game",component:Zl}],by=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ze({type:n})}static{this.\u0275inj=$e({imports:[lt,_o.forChild(lI),_o]})}}return n})();var vy=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ze({type:n});static \u0275inj=$e({imports:[lt,la,ua,ha,ca,er,uf,ct,ct]})}return n})();var $A=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ze({type:n})}static{this.\u0275inj=$e({providers:[Yl],imports:[lt,_o,ma,vy,by,Gm,Mm,bf,Mf.initializeApp(Am.firebasePuzzleData),yy,ya,Zl,_a,ga,na]})}}return n})();export{$A as DigitsModule};
