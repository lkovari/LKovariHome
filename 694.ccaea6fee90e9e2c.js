"use strict";(self.webpackChunkLKovariHome=self.webpackChunkLKovariHome||[]).push([[694],{9058:(no,Kt,H)=>{H.d(Kt,{BH:()=>Pe,G6:()=>Qt,L:()=>ze,LL:()=>Re,Pz:()=>Le,Sg:()=>Sr,UG:()=>M,ZB:()=>ie,ZR:()=>Ce,aH:()=>Et,b$:()=>An,eu:()=>$i,hl:()=>$n,jU:()=>Je,m9:()=>Vr,ne:()=>cn,pd:()=>Ji,r3:()=>ft,ru:()=>nt,tV:()=>B,uI:()=>wt,vZ:()=>Ot,w1:()=>sr,xO:()=>Yi,xb:()=>oi,z$:()=>Ee,zd:()=>gn});const te=function(A){const E=[];let b=0;for(let N=0;N<A.length;N++){let x=A.charCodeAt(N);x<128?E[b++]=x:x<2048?(E[b++]=x>>6|192,E[b++]=63&x|128):55296==(64512&x)&&N+1<A.length&&56320==(64512&A.charCodeAt(N+1))?(x=65536+((1023&x)<<10)+(1023&A.charCodeAt(++N)),E[b++]=x>>18|240,E[b++]=x>>12&63|128,E[b++]=x>>6&63|128,E[b++]=63&x|128):(E[b++]=x>>12|224,E[b++]=x>>6&63|128,E[b++]=63&x|128)}return E},Tt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,E){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const b=E?this.byteToCharMapWebSafe_:this.byteToCharMap_,N=[];for(let x=0;x<A.length;x+=3){const Q=A[x],ue=x+1<A.length,ge=ue?A[x+1]:0,Nt=x+2<A.length,Xe=Nt?A[x+2]:0;let zt=(15&ge)<<2|Xe>>6,vn=63&Xe;Nt||(vn=64,ue||(zt=64)),N.push(b[Q>>2],b[(3&Q)<<4|ge>>4],b[zt],b[vn])}return N.join("")},encodeString(A,E){return this.HAS_NATIVE_SUPPORT&&!E?btoa(A):this.encodeByteArray(te(A),E)},decodeString(A,E){return this.HAS_NATIVE_SUPPORT&&!E?atob(A):function(A){const E=[];let b=0,N=0;for(;b<A.length;){const x=A[b++];if(x<128)E[N++]=String.fromCharCode(x);else if(x>191&&x<224){const Q=A[b++];E[N++]=String.fromCharCode((31&x)<<6|63&Q)}else if(x>239&&x<365){const Nt=((7&x)<<18|(63&A[b++])<<12|(63&A[b++])<<6|63&A[b++])-65536;E[N++]=String.fromCharCode(55296+(Nt>>10)),E[N++]=String.fromCharCode(56320+(1023&Nt))}else{const Q=A[b++],ue=A[b++];E[N++]=String.fromCharCode((15&x)<<12|(63&Q)<<6|63&ue)}}return E.join("")}(this.decodeStringToByteArray(A,E))},decodeStringToByteArray(A,E){this.init_();const b=E?this.charToByteMapWebSafe_:this.charToByteMap_,N=[];for(let x=0;x<A.length;){const Q=b[A.charAt(x++)],ge=x<A.length?b[A.charAt(x)]:0;++x;const Xe=x<A.length?b[A.charAt(x)]:64;++x;const ye=x<A.length?b[A.charAt(x)]:64;if(++x,null==Q||null==ge||null==Xe||null==ye)throw new Ye;N.push(Q<<2|ge>>4),64!==Xe&&(N.push(ge<<4&240|Xe>>2),64!==ye&&N.push(Xe<<6&192|ye))}return N},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class Ye extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ze=function(A){return function(A){const E=te(A);return Tt.encodeByteArray(E,!0)}(A).replace(/\./g,"")},B=function(A){try{return Tt.decodeString(A,!0)}catch(E){console.error("base64Decode failed: ",E)}return null};function ie(A,E){if(!(E instanceof Object))return E;switch(E.constructor){case Date:return new Date(E.getTime());case Object:void 0===A&&(A={});break;case Array:A=[];break;default:return E}for(const b in E)!E.hasOwnProperty(b)||!ae(b)||(A[b]=ie(A[b],E[b]));return A}function ae(A){return"__proto__"!==A}const Ie=()=>{try{return function ke(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if(typeof document>"u")return;let A;try{A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const E=A&&B(A[1]);return E&&JSON.parse(E)})()}catch(A){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${A}`)}},Et=()=>{var A;return null===(A=Ie())||void 0===A?void 0:A.config},Le=A=>{var E;return null===(E=Ie())||void 0===E?void 0:E[`_${A}`]};class Pe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((E,b)=>{this.resolve=E,this.reject=b})}wrapCallback(E){return(b,N)=>{b?this.reject(b):this.resolve(N),"function"==typeof E&&(this.promise.catch(()=>{}),1===E.length?E(b):E(b,N))}}}function Sr(A,E){if(A.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const N=E||"demo-project",x=A.iat||0,Q=A.sub||A.user_id;if(!Q)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ue=Object.assign({iss:`https://securetoken.google.com/${N}`,aud:N,iat:x,exp:x+3600,auth_time:x,sub:Q,user_id:Q,firebase:{sign_in_provider:"custom",identities:{}}},A);return[ze(JSON.stringify({alg:"none",type:"JWT"})),ze(JSON.stringify(ue)),""].join(".")}function Ee(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function wt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ee())}function M(){var A;const E=null===(A=Ie())||void 0===A?void 0:A.forceEnvironment;if("node"===E)return!0;if("browser"===E)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Je(){return"object"==typeof self&&self.self===self}function nt(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id}function An(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function sr(){const A=Ee();return A.indexOf("MSIE ")>=0||A.indexOf("Trident/")>=0}function Qt(){return!M()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $n(){try{return"object"==typeof indexedDB}catch{return!1}}function $i(){return new Promise((A,E)=>{try{let b=!0;const N="validate-browser-context-for-indexeddb-analytics-module",x=self.indexedDB.open(N);x.onsuccess=()=>{x.result.close(),b||self.indexedDB.deleteDatabase(N),A(!0)},x.onupgradeneeded=()=>{b=!1},x.onerror=()=>{var Q;E((null===(Q=x.error)||void 0===Q?void 0:Q.message)||"")}}catch(b){E(b)}})}class Ce extends Error{constructor(E,b,N){super(b),this.code=E,this.customData=N,this.name="FirebaseError",Object.setPrototypeOf(this,Ce.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Re.prototype.create)}}class Re{constructor(E,b,N){this.service=E,this.serviceName=b,this.errors=N}create(E,...b){const N=b[0]||{},x=`${this.service}/${E}`,Q=this.errors[E],ue=Q?function an(A,E){return A.replace(xr,(b,N)=>{const x=E[N];return null!=x?String(x):`<${N}?>`})}(Q,N):"Error";return new Ce(x,`${this.serviceName}: ${ue} (${x}).`,N)}}const xr=/\{\$([^}]+)}/g;function ft(A,E){return Object.prototype.hasOwnProperty.call(A,E)}function oi(A){for(const E in A)if(Object.prototype.hasOwnProperty.call(A,E))return!1;return!0}function Ot(A,E){if(A===E)return!0;const b=Object.keys(A),N=Object.keys(E);for(const x of b){if(!N.includes(x))return!1;const Q=A[x],ue=E[x];if(kr(Q)&&kr(ue)){if(!Ot(Q,ue))return!1}else if(Q!==ue)return!1}for(const x of N)if(!b.includes(x))return!1;return!0}function kr(A){return null!==A&&"object"==typeof A}function Yi(A){const E=[];for(const[b,N]of Object.entries(A))Array.isArray(N)?N.forEach(x=>{E.push(encodeURIComponent(b)+"="+encodeURIComponent(x))}):E.push(encodeURIComponent(b)+"="+encodeURIComponent(N));return E.length?"&"+E.join("&"):""}function gn(A){const E={};return A.replace(/^\?/,"").split("&").forEach(N=>{if(N){const[x,Q]=N.split("=");E[decodeURIComponent(x)]=decodeURIComponent(Q)}}),E}function Ji(A){const E=A.indexOf("?");if(!E)return"";const b=A.indexOf("#",E);return A.substring(E,b>0?b:void 0)}function cn(A,E){const b=new _n(A,E);return b.subscribe.bind(b)}class _n{constructor(E,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{E(this)}).catch(N=>{this.error(N)})}next(E){this.forEachObserver(b=>{b.next(E)})}error(E){this.forEachObserver(b=>{b.error(E)}),this.close(E)}complete(){this.forEachObserver(E=>{E.complete()}),this.close()}subscribe(E,b,N){let x;if(void 0===E&&void 0===b&&void 0===N)throw new Error("Missing Observer.");x=function Or(A,E){if("object"!=typeof A||null===A)return!1;for(const b of E)if(b in A&&"function"==typeof A[b])return!0;return!1}(E,["next","error","complete"])?E:{next:E,error:b,complete:N},void 0===x.next&&(x.next=ar),void 0===x.error&&(x.error=ar),void 0===x.complete&&(x.complete=ar);const Q=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?x.error(this.finalError):x.complete()}catch{}}),this.observers.push(x),Q}unsubscribeOne(E){void 0===this.observers||void 0===this.observers[E]||(delete this.observers[E],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(E){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,E)}sendOne(E,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[E])try{b(this.observers[E])}catch(N){typeof console<"u"&&console.error&&console.error(N)}})}close(E){this.finalized||(this.finalized=!0,void 0!==E&&(this.finalError=E),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ar(){}function Vr(A){return A&&A._delegate?A._delegate:A}},8694:(no,Kt,H)=>{H.r(Kt),H.d(Kt,{DigitsModule:()=>xE});var v=H(6814),fe=H(2236),k=H(5219);let te=(()=>{class n{static#e=this.OPERATOR_REV="\xab";static#t=this.OPERATOR_ADD="+";static#n=this.OPERATOR_SUB="-";static#r=this.OPERATOR_MUL="\xd7";static#i=this.OPERATOR_DIV="/"}return n})();class Ut{constructor(e,t,r,i){this.id=e,this.selected=t,this.disabled=r,this.value=i}}class Tt{constructor(){this.operands=[]}}class Ye{static evaluate(e,t,r){var i=Number.MIN_VALUE;switch(r){case te.OPERATOR_ADD:i=e+t;break;case te.OPERATOR_SUB:i=e>=t?e-t:Number.MIN_VALUE;break;case te.OPERATOR_DIV:i=e%t==0?e/t:Number.MIN_VALUE;break;case te.OPERATOR_MUL:i=e*t}return i}static cloneGameParameters(e){let t=new Tt;return t.result=e.result,e.operands.forEach(r=>{let i=new Ut(r.id,!1,!1,-1);Object.assign(i,r),t.operands.push(i)}),t}}class wn{constructor(){this.numbers=[]}generateNumber(e,t){let r=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(r)>=0;)r=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(r)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}}class ze{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){let e=this.generateNumber(0,4),t=te.OPERATOR_ADD;switch(e){case 0:t=te.OPERATOR_ADD;break;case 1:t=te.OPERATOR_SUB;break;case 2:t=te.OPERATOR_MUL;break;case 0:t=te.OPERATOR_DIV}return t}checkExecuteDivision(e,t){return e%t==0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let r=t;return e<t&&(r=t-1),this.operands.splice(e,1),r}calculateResult(e){let t=this.operands.length,r=0,i=0,s=this.generateNumber(3,5),a=Number.MIN_VALUE;for(;i<s&&e.length>1;){let h=this.choiceRandomOperation(),f=this.generateNumber(0,t-1);for(a===Number.MIN_VALUE&&(a=this.generateNumber(0,t-1));a===f;)f=this.generateNumber(0,t-1);switch(h){case te.OPERATOR_ADD:e[a]=Ye.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case te.OPERATOR_SUB:if(!this.checkExecuteSubstraction(e[a],e[f]))continue;e[a]=Ye.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case te.OPERATOR_MUL:e[a]=Ye.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case te.OPERATOR_DIV:if(!this.checkExecuteDivision(e[a],e[f]))continue;e[a]=Ye.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i}}return r=e[a],r}generateGameParameter(e){let t=new wn;switch(e){case 0:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break;case 1:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break;case 2:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 3:t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 4:t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25)}let r=t.getGeneratedNumbers();r=r.sort((g,y)=>g-y);let i=new Array(r[0],r[1],r[2],r[3],r[4],r[5]);this.operands=new Array(r[0],r[1],r[2],r[3],r[4],r[5]),t.clearGeneratedNumbers();let s=0,a=0;switch(e){case 0:s=30,a=100;break;case 1:s=50,a=150;break;case 2:s=100,a=200;break;case 3:s=300,a=400;break;case 4:s=400,a=550}let h=this.calculateResult(this.operands);for(;s>h||h>a;)this.operands=new Array(r[0],r[1],r[2],r[3],r[4],r[5]),h=this.calculateResult(this.operands);let f=new Tt;f.result=h;let m=0;return i.forEach(g=>{let y=new Ut(m,!1,!1,g);f.operands.push(y),++m}),f}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){let r=this.generateGameParameter(t);r.stageIndex=t,e.push(r)}return e=e.sort((t,r)=>t.result-r.result),e}}class B{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}}var d=H(9212);let ie=(()=>{class n{constructor(t,r){this.document=t,this.platformId=r,this.documentIsAccessible=(0,v.NF)(this.platformId)}static getCookieRegExp(t){const r=t.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+r+"|;\\s*"+r+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(t){try{return decodeURIComponent(t)}catch{return t}}check(t){return!!this.documentIsAccessible&&(t=encodeURIComponent(t),n.getCookieRegExp(t).test(this.document.cookie))}get(t){if(this.documentIsAccessible&&this.check(t)){t=encodeURIComponent(t);const i=n.getCookieRegExp(t).exec(this.document.cookie);return i[1]?n.safeDecodeURIComponent(i[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const t={},r=this.document;return r.cookie&&""!==r.cookie&&r.cookie.split(";").forEach(i=>{const[s,a]=i.split("=");t[n.safeDecodeURIComponent(s.replace(/^ /,""))]=n.safeDecodeURIComponent(a)}),t}set(t,r,i,s,a,h,f){if(!this.documentIsAccessible)return;if("number"==typeof i||i instanceof Date||s||a||h||f)return void this.set(t,r,{expires:i,path:s,domain:a,secure:h,sameSite:f||"Lax"});let m=encodeURIComponent(t)+"="+encodeURIComponent(r)+";";const g=i||{};g.expires&&(m+="number"==typeof g.expires?"expires="+new Date((new Date).getTime()+1e3*g.expires*60*60*24).toUTCString()+";":"expires="+g.expires.toUTCString()+";"),g.path&&(m+="path="+g.path+";"),g.domain&&(m+="domain="+g.domain+";"),!1===g.secure&&"None"===g.sameSite&&(g.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${t} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),g.secure&&(m+="secure;"),g.sameSite||(g.sameSite="Lax"),m+="sameSite="+g.sameSite+";",this.document.cookie=m}delete(t,r,i,s,a="Lax"){this.documentIsAccessible&&this.set(t,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:r,domain:i,secure:s,sameSite:a})}deleteAll(t,r,i,s="Lax"){if(!this.documentIsAccessible)return;const a=this.getAll();for(const h in a)a.hasOwnProperty(h)&&this.delete(h,t,r,i,s)}static#e=this.\u0275fac=function(r){return new(r||n)(d.LFG(v.K0),d.LFG(d.Lbi))};static#t=this.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ae=H(7398);class ke{constructor(){this.stages=[]}}class xt{constructor(){this.operands=[]}}class Me{}const ve=new d.OlP("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var Ie=H(8645);let Dt=(()=>{class n{constructor(t,r,i){this.ngZone=t,this.document=r,this.window=i,this.copySubject=new Ie.x,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});const r=this.copyFromContent(t);return this.pushCopyResponse(r?{content:t,isSuccess:r}:{isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,r=!0){try{this.selectTarget(t);const i=this.copyText();return this.clearSelection(r?t:void 0,this.window),i&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){const t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,r=this.document.body){if(this.tempTextArea&&!r.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{r.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;const i=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),i}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,r){t&&t.focus(),r.getSelection()?.removeAllRanges()}createTempTextArea(t,r){const i="rtl"===t.documentElement.getAttribute("dir");let s;return s=t.createElement("textarea"),s.style.fontSize="12pt",s.style.border="0",s.style.padding="0",s.style.margin="0",s.style.position="absolute",s.style[i?"right":"left"]="-9999px",s.style.top=(r.pageYOffset||t.documentElement.scrollTop)+"px",s.setAttribute("readonly",""),s}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return n.\u0275fac=function(t){return new(t||n)(d.LFG(d.R0b),d.LFG(v.K0),d.LFG(ve,8))},n.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Le=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=d.oAB({type:n}),n.\u0275inj=d.cJS({imports:[v.ez]}),n})();var Pe=H(534);(0,Pe.registerVersion)("firebase","10.7.1","app");var wt=H(1954),Je=H(2631);const An=new class nt extends Je.v{}(class M extends wt.o{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}});var sr=H(6321),bn=H(9397),Pr=H(5137),Qt=H(3093);const $n=new d.GfV("ANGULARFIRE2_VERSION");class Ce{constructor(){return((n,e)=>{const t=(0,Pe.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r})(Re)}}const Re="app-check";function an(){}class xr{zone;delegate;constructor(e,t=An){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(a){i.runGuarded(()=>{e.apply(this,[a])})},t,r)}}class or{zone;task=null;constructor(e){this.zone=e}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",an,{},an,an)),t.pipe((0,bn.b)({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Yt=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new xr(Zone.current)),this.insideAngular=t.run(()=>new xr(Zone.current,sr.z)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(d.LFG(d.R0b))};static \u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ft(n){return function Qi(n){return function(t){return(t=t.lift(new or(n.ngZone))).pipe((0,Pr.R)(n.outsideAngular),(0,Qt.Q)(n.insideAngular))}}(function kt(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}())(n)}var Ot=H(3106);Ot.Z.registerVersion("firebase","10.7.1","app-compat");const Yi=["ngOnDestroy"];class Bt{constructor(e){return e}}const cn=new d.OlP("angularfire2.app.options"),_n=new d.OlP("angularfire2.app.name");function Sn(n,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const a=Ot.Z.apps.filter(h=>h&&h.name===i.name)[0]||e.runOutsideAngular(()=>Ot.Z.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(a.options)){const h=!!module.hot;Or("error",`${a.name} Firebase App already initialized with different options${h?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Bt(a)}const Or=(n,...e)=>{(0,d.X6Q)()&&typeof console<"u"&&console[n](...e)},ar={provide:Bt,useFactory:Sn,deps:[cn,d.R0b,[new d.FiY,_n]]};let ci=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:cn,useValue:t},{provide:_n,useValue:r}]}}constructor(t){Ot.Z.registerVersion("angularfire",$n.full,"core"),Ot.Z.registerVersion("angularfire",$n.full,"app-compat"),Ot.Z.registerVersion("angular",d.q4F.full,t.toString())}static \u0275fac=function(r){return new(r||n)(d.LFG(d.Lbi))};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({providers:[ar]})}return n})();function Rn(n,e,t,r,i){const[,s,a]=globalThis.\u0275AngularfireInstanceCache.find(h=>h[0]===n)||[];if(s)return function Nr(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(i,a)||(Jt("error",`${e} was already initialized on the ${t} Firebase App with different settings.${ln?" You may need to reload as Firebase is not HMR aware.":""}`),Jt("warn",{is:i,was:a})),s;{const h=r();return globalThis.\u0275AngularfireInstanceCache.push([n,h,i]),h}}const ln=typeof module<"u"&&!!module.hot,Jt=(n,...e)=>{(0,d.X6Q)()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[],H(6230);var Pn=H(2096),li=H(5592),yn=H(2459),Hn=H(3019),At=H(4664),Kn=H(940),ui=H(1374),ro=H(4674);function di(n,e){return(0,ro.m)(e)?(0,At.w)(()=>n,e):(0,At.w)(()=>n)}var Vr=H(2181);const E=new d.OlP("angularfire2.auth.use-emulator"),b=new d.OlP("angularfire2.auth.settings"),N=new d.OlP("angularfire2.auth.tenant-id"),x=new d.OlP("angularfire2.auth.langugage-code"),Q=new d.OlP("angularfire2.auth.use-device-language"),ue=new d.OlP("angularfire.auth.persistence"),ge=(n,e,t,r,i,s,a,h)=>Rn(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),r&&(f.tenantId=r),f.languageCode=i,s&&f.useDeviceLanguage(),a)for(const[m,g]of Object.entries(a))f.settings[m]=g;return h&&f.setPersistence(h),f},[t,r,i,s,a,h]);let Nt=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,a,h,f,m,g,y,w,R){const z=new Ie.x,q=(0,Pn.of)(void 0).pipe((0,Qt.Q)(a.outsideAngular),(0,At.w)(()=>s.runOutsideAngular(()=>Promise.resolve().then(H.bind(H,6230)))),(0,ae.U)(()=>Sn(t,s,r)),(0,ae.U)(G=>ge(G,s,h,m,g,y,f,w)),(0,Kn.d)({bufferSize:1,refCount:!1}));if((0,v.PM)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Pn.of)(null);else{q.pipe((0,ui.P)()).subscribe();const G=q.pipe((0,At.w)(K=>K.getRedirectResult().then(ce=>ce,()=>null)),ft,(0,Kn.d)({bufferSize:1,refCount:!1})),se=q.pipe((0,At.w)(K=>new li.y(ce=>({unsubscribe:s.runOutsideAngular(()=>K.onAuthStateChanged(_e=>ce.next(_e),_e=>ce.error(_e),()=>ce.complete()))})))),oe=q.pipe((0,At.w)(K=>new li.y(ce=>({unsubscribe:s.runOutsideAngular(()=>K.onIdTokenChanged(_e=>ce.next(_e),_e=>ce.error(_e),()=>ce.complete()))}))));this.authState=G.pipe(di(se),(0,Pr.R)(a.outsideAngular),(0,Qt.Q)(a.insideAngular)),this.user=G.pipe(di(oe),(0,Pr.R)(a.outsideAngular),(0,Qt.Q)(a.insideAngular)),this.idToken=this.user.pipe((0,At.w)(K=>K?(0,yn.D)(K.getIdToken()):(0,Pn.of)(null))),this.idTokenResult=this.user.pipe((0,At.w)(K=>K?(0,yn.D)(K.getIdTokenResult()):(0,Pn.of)(null))),this.credential=(0,Hn.T)(G,z,this.authState.pipe((0,Vr.h)(K=>!K))).pipe((0,ae.U)(K=>K?.user?K:null),(0,Pr.R)(a.outsideAngular),(0,Qt.Q)(a.insideAngular))}return((n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(Yi.indexOf(s)>-1)return()=>{};const a=e.toPromise().then(h=>{const f=h?.[s];return"function"==typeof f?f.bind(h):f?.then?f.then(m=>t.run(()=>m)):t.run(()=>f)});return new Proxy(()=>{},{get:(h,f)=>a[f],apply:(h,f,m)=>a.then(g=>{const y=g?.(...m);return r?.spy?.apply&&r.spy.apply(s,m,y),y})})})}))(this,q,s,{spy:{apply:(G,se,oe)=>{(G.startsWith("signIn")||G.startsWith("createUser"))&&oe.then(K=>z.next(K))}}})}static \u0275fac=function(r){return new(r||n)(d.LFG(cn),d.LFG(_n,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(Yt),d.LFG(E,8),d.LFG(b,8),d.LFG(N,8),d.LFG(x,8),d.LFG(Q,8),d.LFG(ue,8),d.LFG(Ce,8))};static \u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var rt=H(7921),ye=H(9360),zt=H(8251);function vn(){return(0,ye.e)((n,e)=>{let t,r=!1;n.subscribe((0,zt.x)(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var F,xn=H(6699),io=H(3997),I=H(5861),P=H(4537),L=H(7879),Z=H(9058),he=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},de={},et=et||{},ee=he||self;function un(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Dn(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Ua="closure_uid_"+(1e9*Math.random()>>>0),Ba=0;function Fd(n,e,t){return n.call.apply(n.bind,arguments)}function Ud(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function bt(n,e,t){return(bt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Fd:Ud).apply(null,arguments)}function Oe(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ot(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),h=2;h<arguments.length;h++)a[h-2]=arguments[h];return e.prototype[i].apply(r,a)}}function cr(){this.s=this.s,this.o=this.o}cr.prototype.s=!1,cr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Ld(n){Object.prototype.hasOwnProperty.call(n,Ua)&&n[Ua]||(n[Ua]=++Ba)}(this)},cr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ga=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function qa(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function zl(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(un(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function Ct(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Ct.prototype.h=function(){this.defaultPrevented=!0};var Gl=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};ee.addEventListener("test",t,e),ee.removeEventListener("test",t,e)}catch{}return n}();function hi(n){return/^[\s\xa0]*$/.test(n)}function fi(){var n=ee.navigator;return n&&(n=n.userAgent)?n:""}function Gt(n){return-1!=fi().indexOf(n)}function es(n){return es[" "](n),n}es[" "]=function(){};var $a,n,Za=Gt("Opera"),pi=Gt("Trident")||Gt("MSIE"),ql=Gt("Edge"),so=ql||pi,Wa=Gt("Gecko")&&!(-1!=fi().toLowerCase().indexOf("webkit")&&!Gt("Edge"))&&!(Gt("Trident")||Gt("MSIE"))&&!Gt("Edge"),zd=-1!=fi().toLowerCase().indexOf("webkit")&&!Gt("Edge");function ja(){var n=ee.document;return n?n.documentMode:void 0}e:{var lr="",oo=(n=fi(),Wa?/rv:([^\);]+)(\)|;)/.exec(n):ql?/Edge\/([\d\.]+)/.exec(n):pi?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):zd?/WebKit\/(\S+)/.exec(n):Za?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(oo&&(lr=oo?oo[1]:""),pi){var ts=ja();if(null!=ts&&ts>parseFloat(lr)){$a=String(ts);break e}}$a=lr}var Gd=ee.document&&pi&&(ja()||parseInt($a,10))||void 0;function Mr(n,e){if(Ct.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Wa){e:{try{es(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:qd[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Mr.$.h.call(this)}}ot(Mr,Ct);var qd={2:"touch",3:"pen",4:"mouse"};Mr.prototype.h=function(){Mr.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Lr="closure_listenable_"+(1e6*Math.random()|0),Zd=0;function Ka(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++Zd,this.fa=this.ia=!1}function Fr(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function ns(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function co(n){const e={};for(const t in n)e[t]=n[t];return e}const Zl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lo(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<Zl.length;s++)t=Zl[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function uo(n){this.src=n,this.g={},this.h=0}function rs(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=Ga(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Fr(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Qa(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}uo.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var a=Qa(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):((e=new Ka(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var is="closure_lm_"+(1e6*Math.random()|0),Ya={};function ho(n,e,t,r,i){if(r&&r.once)return mi(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)ho(n,e[s],t,r,i);return null}return t=ec(t),n&&n[Lr]?n.O(e,t,Dn(r)?!!r.capture:!!r,i):Wl(n,e,t,!1,r,i)}function Wl(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=Dn(i)?!!i.capture:!!i,h=Xa(n);if(h||(n[is]=h=new uo(n)),(t=h.add(e,t,r,a,s)).proxy)return t;if(r=function Ja(){const e=On;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Gl||(i=a),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(jl(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function mi(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)mi(n,e[s],t,r,i);return null}return t=ec(t),n&&n[Lr]?n.P(e,t,Dn(r)?!!r.capture:!!r,i):Wl(n,e,t,!0,r,i)}function kn(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)kn(n,e[s],t,r,i);else r=Dn(r)?!!r.capture:!!r,t=ec(t),n&&n[Lr]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Qa(s=n.g[e],t,r,i))&&(Fr(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=Xa(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Qa(e,t,r,i)),(t=-1<n?e[n]:null)&&ss(t))}function ss(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Lr])rs(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(jl(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Xa(e))?(rs(t,n),0==t.h&&(t.src=null,e[is]=null)):Fr(n)}}}function jl(n){return n in Ya?Ya[n]:Ya[n]="on"+n}function On(n,e){if(n.fa)n=!0;else{e=new Mr(e,this);var t=n.listener,r=n.la||n.src;n.ia&&ss(n),n=t.call(r,e)}return n}function Xa(n){return(n=n[is])instanceof uo?n:null}var os="__closure_events_fn_"+(1e9*Math.random()>>>0);function ec(n){return"function"==typeof n?n:(n[os]||(n[os]=function(e){return n.handleEvent(e)}),n[os])}function it(){cr.call(this),this.i=new uo(this),this.S=this,this.J=null}function yt(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new Ct(e,n);else if(e instanceof Ct)e.target=e.target||n;else{var i=e;lo(e=new Ct(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=gi(a,r,!0,e)&&i}if(i=gi(a=e.g=n,r,!0,e)&&i,i=gi(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=gi(a=e.g=t[s],r,!1,e)&&i}function gi(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var h=a.listener,f=a.la||a.src;a.ia&&rs(n.i,a),i=!1!==h.call(f,r)&&i}}return i&&!r.defaultPrevented}ot(it,cr),it.prototype[Lr]=!0,it.prototype.removeEventListener=function(n,e,t,r){kn(this,n,e,t,r)},it.prototype.N=function(){if(it.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Fr(t[r]);delete n.g[e],n.h--}}this.J=null},it.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},it.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var tc=ee.JSON.stringify;function nc(){var n=ur;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var $l=new class jd{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new $d,n=>n.reset());class $d{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function as(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Hp(n){ee.setTimeout(()=>{throw n},0)}let Br,Xt=!1,ur=new class Ur{constructor(){this.h=this.g=null}add(e,t){const r=$l.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},zr=()=>{const n=ee.Promise.resolve(void 0);Br=()=>{n.then(Hl)}};var Hl=()=>{for(var n;n=nc();){try{n.h.call(n.g)}catch(t){Hp(t)}var e=$l;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Xt=!1};function cs(n,e){it.call(this),this.h=n||1,this.g=e||ee,this.j=bt(this.qb,this),this.l=Date.now()}function fo(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function rc(n,e,t){if("function"==typeof n)t&&(n=bt(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=bt(n.handleEvent,n)}return 2147483647<Number(e)?-1:ee.setTimeout(n,e||0)}function Gr(n){n.g=rc(()=>{n.g=null,n.i&&(n.i=!1,Gr(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ot(cs,it),(F=cs.prototype).ga=!1,F.T=null,F.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),yt(this,"tick"),this.ga&&(fo(this),this.start()))}},F.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},F.N=function(){cs.$.N.call(this),fo(this),delete this.g};class Hd extends cr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Gr(this)}N(){super.N(),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dr(n){cr.call(this),this.h=n,this.g={}}ot(dr,cr);var ic=[];function sc(n,e,t,r){Array.isArray(t)||(t&&(ic[0]=t.toString()),t=ic);for(var i=0;i<t.length;i++){var s=ho(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function po(n){ns(n.g,function(e,t){this.g.hasOwnProperty(t)&&ss(e)},n),n.g={}}function Vt(){this.g=!0}function hr(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Ql(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return tc(t)}catch{return e}}(n,t)+(r?" "+r:"")})}dr.prototype.N=function(){dr.$.N.call(this),po(this)},dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vt.prototype.Ea=function(){this.g=!1},Vt.prototype.info=function(){};var fr={},Yl=null;function _i(){return Yl=Yl||new it}function go(n){Ct.call(this,fr.Ta,n)}function qr(n){const e=_i();yt(e,new go(e))}function ls(n,e){Ct.call(this,fr.STAT_EVENT,n),this.stat=e}function vt(n){const e=_i();yt(e,new ls(e,n))}function oc(n,e){Ct.call(this,fr.Ua,n),this.size=e}function Zr(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){n()},e)}fr.Ta="serverreachability",ot(go,Ct),fr.STAT_EVENT="statevent",ot(ls,Ct),fr.Ua="timingevent",ot(oc,Ct);var us={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},_o={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function yi(){}function ac(){}yi.prototype.h=null;var cc,Wr={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function vo(){Ct.call(this,"d")}function ds(){Ct.call(this,"c")}function vi(){}function hs(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new dr(this),this.P=fs,this.V=new cs(n=so?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Io}function Io(){this.i=null,this.g="",this.h=!1}ot(vo,Ct),ot(ds,Ct),ot(vi,yi),vi.prototype.g=function(){return new XMLHttpRequest},vi.prototype.i=function(){return{}},cc=new vi;var fs=45e3,To={},ps={};function Ii(n,e,t){n.L=1,n.A=Ti(In(e)),n.u=t,n.S=!0,Eo(n,null)}function Eo(n,e){n.G=Date.now(),ms(n),n.B=In(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),fc(t.i,"t",r),n.o=0,t=n.l.J,n.h=new Io,n.g=Es(n.l,t?e:null,!n.u),0<n.O&&(n.M=new Hd(bt(n.Pa,n,n.g),n.O)),sc(n.U,n.g,"readystatechange",n.nb),e=n.I?co(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),qr(),function Kl(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",h=s.split("&"),f=0;f<h.length;f++){var m=h[f].split("=");if(1<m.length){var g=m[0];m=m[1];var y=g.split("_");a=2<=y.length&&"type"==y[1]?a+(g+"=")+m+"&":a+(g+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+a})}(n.j,n.v,n.B,n.m,n.W,n.u)}function wo(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function Jl(n,e,t){let i,r=!0;for(;!n.J&&n.o<t.length;){if(i=lc(n,t),i==ps){4==e&&(n.s=4,vt(14),r=!1),hr(n.j,n.m,null,"[Incomplete Response]");break}if(i==To){n.s=4,vt(15),hr(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}hr(n.j,n.m,i,null),gs(n,i)}wo(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=e||0!=t.length||n.h.h||(n.s=1,vt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Ts(e),e.M=!0,vt(11))):(hr(n.j,n.m,t,"[Invalid Chunked Response]"),pr(n),jr(n))}function lc(n,e){var t=n.o,r=e.indexOf("\n",t);return-1==r?ps:(t=Number(e.substring(t,r)),isNaN(t)?To:(r+=1)+t>e.length?ps:(e=e.slice(r,r+t),n.o=r+t,e))}function ms(n){n.Y=Date.now()+n.P,Ao(n,n.P)}function Ao(n,e){if(null!=n.C)throw Error("WatchDog timer not null");n.C=Zr(bt(n.lb,n),e)}function bo(n){n.C&&(ee.clearTimeout(n.C),n.C=null)}function jr(n){0==n.l.H||n.J||wc(n.l,n)}function pr(n){bo(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,fo(n.V),po(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function gs(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||mc(t.i,n)))if(!n.K&&mc(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Lo(t),Tn(t)}Ec(t),vt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Zr(bt(t.ib,t),6e3));if(1>=ru(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Vn(t,11)}else if((n.K||t.g==n)&&Lo(t),!hi(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let m=i[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const g=m[3];null!=g&&(t.ra=g,t.l.info("VER="+t.ra));const y=m[4];null!=y&&(t.Ga=y,t.l.info("SVER="+t.Ga));const w=m[5];null!=w&&"number"==typeof w&&0<w&&(t.L=r=1.5*w,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const R=n.g;if(R){const z=R.g?R.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(z){var s=r.i;s.g||-1==z.indexOf("spdy")&&-1==z.indexOf("quic")&&-1==z.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(gc(s,s.h),s.h=null))}if(r.F){const q=R.g?R.g.getResponseHeader("X-HTTP-Session-Id"):null;q&&(r.Da=q,Fe(r.I,r.F,q))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var a=n;if((r=t).wa=Ai(r,r.J?r.pa:null,r.Y),a.K){rh(r.i,a);var h=a,f=r.L;f&&h.setTimeout(f),h.C&&(bo(h),ms(h)),r.g=a}else Mo(r);0<t.j.length&&Vo(t)}else"stop"!=m[0]&&"close"!=m[0]||Vn(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?Vn(t,7):uu(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}qr()}catch{}}function Xl(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(un(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function uc(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(un(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function Qd(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(un(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(F=hs.prototype).setTimeout=function(n){this.P=n},F.nb=function(n){n=n.target;const e=this.M;e&&3==en(n)?e.l():this.Pa(n)},F.Pa=function(n){try{if(n==this.g)e:{const g=en(this.g);var e=this.g.Ia();if(this.g.da(),!(3>g)&&(3!=g||so||this.g&&(this.h.h||this.g.ja()||Ic(this.g)))){this.J||4!=g||7==e||qr(),bo(this);var t=this.g.da();this.ca=t;t:if(wo(this)){var r=Ic(this.g);n="";var i=r.length,s=4==en(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){pr(this),jr(this);var a="";break t}this.h.i=new ee.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=200==t,function Kd(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+a})}(this.j,this.v,this.B,this.m,this.W,g,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var h,f=this.g;if((h=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!hi(h)){var m=h;break t}}m=null}if(!(t=m)){this.i=!1,this.s=3,vt(12),pr(this),jr(this);break e}hr(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gs(this,t)}this.S?(Jl(this,g,a),so&&this.i&&3==g&&(sc(this.U,this.V,"tick",this.mb),this.V.start())):(hr(this.j,this.m,a,null),gs(this,a)),4==g&&pr(this),this.i&&!this.J&&(4==g?wc(this.l,this):(this.i=!1,ms(this)))}else(function uh(n){const e={};n=(n.g&&2<=en(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(hi(n[r]))continue;var t=as(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function Wd(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<a.indexOf("Unknown SID")?(this.s=3,vt(12)):(this.s=0,vt(13)),pr(this),jr(this)}}}catch{}},F.mb=function(){if(this.g){var n=en(this.g),e=this.g.ja();this.o<e.length&&(bo(this),Jl(this,n,e),this.i&&4!=n&&ms(this))}},F.cancel=function(){this.J=!0,pr(this)},F.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function mo(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(qr(),vt(17)),pr(this),this.s=2,jr(this)):Ao(this,this.Y-n)};var Co=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $r(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof $r){this.h=n.h,So(this,n.j),this.s=n.s,this.g=n.g,Ro(this,n.m),this.l=n.l;var e=n.i,t=new ys;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Po(this,t),this.o=n.o}else n&&(e=String(n).match(Co))?(this.h=!1,So(this,e[1]||"",!0),this.s=_s(e[2]||""),this.g=_s(e[3]||"",!0),Ro(this,e[4]),this.l=_s(e[5]||"",!0),Po(this,e[6]||"",!0),this.o=_s(e[7]||"")):(this.h=!1,this.i=new ys(null,this.h))}function In(n){return new $r(n)}function So(n,e,t){n.j=t?_s(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Ro(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Po(n,e,t){e instanceof ys?(n.i=e,function th(n,e){e&&!n.j&&(Nn(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(eu(this,r),fc(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Hr(e,eh)),n.i=new ys(e,n.h))}function Fe(n,e,t){n.i.set(e,t)}function Ti(n){return Fe(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function _s(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Hr(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Jd),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Jd(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}$r.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Hr(e,xo,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Hr(e,xo,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Hr(t,"/"==t.charAt(0)?dc:Xd,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Hr(t,hc)),n.join("")};var xo=/[#\/\?@]/g,Xd=/[#\?:]/g,dc=/[#\?]/g,eh=/[#\?@]/g,hc=/#/g;function ys(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Nn(n){n.g||(n.g=new Map,n.h=0,n.i&&function Yd(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function eu(n,e){Nn(n),e=mr(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function tu(n,e){return Nn(n),e=mr(n,e),n.g.has(e)}function fc(n,e,t){eu(n,e),0<t.length&&(n.i=null,n.g.set(mr(n,e),qa(t)),n.h+=t.length)}function mr(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}(F=ys.prototype).add=function(n,e){Nn(this),this.i=null,n=mr(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},F.forEach=function(n,e){Nn(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},F.ta=function(){Nn(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},F.Z=function(n){Nn(this);let e=[];if("string"==typeof n)tu(this,n)&&(e=e.concat(this.g.get(mr(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},F.set=function(n,e){return Nn(this),this.i=null,tu(this,n=mr(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},F.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},F.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};var Ei=class{constructor(n,e){this.g=n,this.map=e}};function pc(n){this.l=n||nh,n=ee.PerformanceNavigationTiming?0<(n=ee.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(ee.g&&ee.g.Ka&&ee.g.Ka()&&ee.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var nh=10;function nu(n){return!!n.h||!!n.g&&n.g.size>=n.j}function ru(n){return n.h?1:n.g?n.g.size:0}function mc(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function gc(n,e){n.g?n.g.add(e):n.h=e}function rh(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function ih(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return qa(n.i)}pc.prototype.cancel=function(){if(this.i=ih(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var Kp=class{stringify(n){return ee.JSON.stringify(n,void 0)}parse(n){return ee.JSON.parse(n,void 0)}};function _c(){this.g=new Kp}function sh(n,e,t){const r=t||"";try{Xl(n,function(i,s){let a=i;Dn(i)&&(a=tc(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function yc(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Do(n){this.l=n.ec||null,this.j=n.ob||!1}function vc(n,e){it.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=iu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ot(Do,yi),Do.prototype.g=function(){return new vc(this.l,this.j)},Do.prototype.i=function(n){return function(){return n}}({}),ot(vc,it);var iu=0;function ah(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function ko(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Kr(n)}function Kr(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(F=vc.prototype).open=function(n,e){if(this.readyState!=iu)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Kr(this)},F.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||ee).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},F.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ko(this)),this.readyState=iu},F.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Kr(this)),this.g&&(this.readyState=3,Kr(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ee.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ah(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},F.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?ko(this):Kr(this),3==this.readyState&&ah(this)}},F.Za=function(n){this.g&&(this.response=this.responseText=n,ko(this))},F.Ya=function(n){this.g&&(this.response=n,ko(this))},F.ka=function(){this.g&&ko(this)},F.setRequestHeader=function(n,e){this.v.append(n,e)},F.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},F.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(vc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Qr=ee.JSON.parse;function Ge(n){it.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=su,this.L=this.M=!1}ot(Ge,it);var su="",ch=/^https?$/i,lh=["POST","PUT"];function ou(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,au(n),wi(n)}function au(n){n.F||(n.F=!0,yt(n,"complete"),yt(n,"error"))}function Oo(n){if(n.h&&typeof et<"u"&&(!n.C[1]||4!=en(n)||2!=n.da()))if(n.v&&4==en(n))rc(n.La,0,n);else if(yt(n,"readystatechange"),4==en(n)){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===a){var i=String(n.I).match(Co)[1]||null;!i&&ee.self&&ee.self.location&&(i=ee.self.location.protocol.slice(0,-1)),r=!ch.test(i?i.toLowerCase():"")}t=r}if(t)yt(n,"complete"),yt(n,"success");else{n.m=6;try{var s=2<en(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",au(n)}}finally{wi(n)}}}function wi(n,e){if(n.g){cu(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||yt(n,"ready");try{t.onreadystatechange=r}catch{}}}function cu(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(ee.clearTimeout(n.A),n.A=null)}function en(n){return n.g?n.g.readyState:0}function Ic(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case su:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function lu(n){let e="";return ns(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function Tc(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=lu(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Fe(n,e,t))}function No(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function vs(n){this.Ga=0,this.j=[],this.l=new Vt,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=No("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=No("baseRetryDelayMs",5e3,n),this.hb=No("retryDelaySeedMs",1e4,n),this.eb=No("forwardChannelMaxRetries",2,n),this.xa=No("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new pc(n&&n.concurrentRequestLimit),this.Ja=new _c,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function uu(n){if(du(n),3==n.H){var e=n.W++,t=In(n.I);if(Fe(t,"SID",n.K),Fe(t,"RID",e),Fe(t,"TYPE","terminate"),qe(n,t),(e=new hs(n,n.l,e)).L=2,e.A=Ti(In(t)),t=!1,ee.navigator&&ee.navigator.sendBeacon)try{t=ee.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&ee.Image&&((new Image).src=e.A,t=!0),t||(e.g=Es(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ms(e)}Ac(n)}function Tn(n){n.g&&(Ts(n),n.g.cancel(),n.g=null)}function du(n){Tn(n),n.u&&(ee.clearTimeout(n.u),n.u=null),Lo(n),n.i.cancel(),n.m&&("number"==typeof n.m&&ee.clearTimeout(n.m),n.m=null)}function Vo(n){if(!nu(n.i)&&!n.m){n.m=!0;var e=n.Na;Br||zr(),Xt||(Br(),Xt=!0),ur.add(e,n),n.C=0}}function hu(n,e){var t;t=e?e.m:n.W++;const r=In(n.I);Fe(r,"SID",n.K),Fe(r,"RID",t),Fe(r,"AID",n.V),qe(n,r),n.o&&n.s&&Tc(r,n.o,n.s),t=new hs(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=fu(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),gc(n.i,t),Ii(t,r,e)}function qe(n,e){n.na&&ns(n.na,function(t,r){Fe(e,r,t)}),n.h&&Xl({},function(t,r){Fe(e,r,t)})}function fu(n,e,t){t=Math.min(n.j.length,t);var r=n.h?bt(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];-1==s?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let h=!0;for(let f=0;f<t;f++){let m=i[f].g;const g=i[f].map;if(m-=s,0>m)s=Math.max(0,i[f].g-100),h=!1;else try{sh(g,a,"req"+m+"_")}catch{r&&r(g)}}if(h){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Mo(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Br||zr(),Xt||(Br(),Xt=!0),ur.add(e,n),n.A=0}}function Ec(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=Zr(bt(n.Ma,n),mu(n,n.A)),n.A++,0))}function Ts(n){null!=n.B&&(ee.clearTimeout(n.B),n.B=null)}function pu(n){n.g=new hs(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=In(n.wa);Fe(e,"RID","rpc"),Fe(e,"SID",n.K),Fe(e,"AID",n.V),Fe(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Fe(e,"TO",n.qa),Fe(e,"TYPE","xmlhttp"),qe(n,e),n.o&&n.s&&Tc(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Ti(In(e)),t.u=null,t.S=!0,Eo(t,n)}function Lo(n){null!=n.v&&(ee.clearTimeout(n.v),n.v=null)}function wc(n,e){var t=null;if(n.g==e){Lo(n),Ts(n),n.g=null;var r=2}else{if(!mc(n.i,e))return;t=e.F,rh(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;yt(r=_i(),new oc(r,t)),Vo(n)}else Mo(n);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function Is(n,e){return!(ru(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=Zr(bt(n.Na,n,e),mu(n,n.C)),n.C++,0)))}(n,e)||2==r&&Ec(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Vn(n,5);break;case 4:Vn(n,10);break;case 3:Vn(n,6);break;default:Vn(n,2)}}function mu(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Vn(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=bt(n.pb,n);t||(t=new $r("//www.google.com/images/cleardot.gif"),ee.location&&"http"==ee.location.protocol||So(t,"https"),Ti(t)),function oh(n,e){const t=new Vt;if(ee.Image){const r=new Image;r.onload=Oe(yc,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Oe(yc,t,r,"TestLoadImage: error",!1,e),r.onabort=Oe(yc,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Oe(yc,t,r,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else vt(2);n.H=0,n.h&&n.h.za(e),Ac(n),du(n)}function Ac(n){if(n.H=0,n.ma=[],n.h){const e=ih(n.i);(0!=e.length||0!=n.j.length)&&(zl(n.ma,e),zl(n.ma,n.j),n.i.i.length=0,qa(n.j),n.j.length=0),n.h.ya()}}function Ai(n,e,t){var r=t instanceof $r?In(t):new $r(t);if(""!=r.g)e&&(r.g=e+"."+r.g),Ro(r,r.m);else{var i=ee.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new $r(null);r&&So(s,r),e&&(s.g=e),i&&Ro(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&Fe(r,t,e),Fe(r,"VER",n.ra),qe(n,r),r}function Es(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ge(n.Ha&&!n.va?new Do({ob:t}):n.va)).Oa(n.J),e}function gu(){}function bi(){if(pi&&!(10<=Number(Gd)))throw Error("Environmental error: no available transport.")}function qt(n,e){it.call(this),this.g=new vs(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!hi(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!hi(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new gr(this)}function Fo(n){vo.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function _u(){ds.call(this),this.status=1}function gr(n){this.g=n}function En(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function bc(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],a=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;a=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(a<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(e=t+((a=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function Ne(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(F=Ge.prototype).Oa=function(n){this.M=n},F.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():cc.g(),this.C=function yo(n){return n.h||(n.h=n.i())}(this.u?this.u:cc),this.g.onreadystatechange=bt(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void ou(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=ee.FormData&&n instanceof ee.FormData,!(0<=Ga(lh,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{cu(this),0<this.B&&((this.L=function Qp(n){return pi&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=bt(this.ua,this)):this.A=rc(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){ou(this,s)}},F.ua=function(){typeof et<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yt(this,"timeout"),this.abort(8))},F.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,yt(this,"complete"),yt(this,"abort"),wi(this))},F.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wi(this,!0)),Ge.$.N.call(this)},F.La=function(){this.s||(this.G||this.v||this.l?Oo(this):this.kb())},F.kb=function(){Oo(this)},F.isActive=function(){return!!this.g},F.da=function(){try{return 2<en(this)?this.g.status:-1}catch{return-1}},F.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},F.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Qr(e)}},F.Ia=function(){return this.m},F.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(F=vs.prototype).ra=8,F.H=1,F.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new hs(this,this.l,n);let s=this.s;if(this.U&&(s?(s=co(s),lo(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=fu(this,i,e),Fe(t=In(this.I),"RID",n),Fe(t,"CVER",22),this.F&&Fe(t,"X-HTTP-Session-Id",this.F),qe(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(lu(s)))+"&"+e:this.o&&Tc(t,this.o,s)),gc(this.i,i),this.bb&&Fe(t,"TYPE","init"),this.P?(Fe(t,"$req",e),Fe(t,"SID","null"),i.aa=!0,Ii(i,t,null)):Ii(i,t,e),this.H=2}}else 3==this.H&&(n?hu(this,n):0==this.j.length||nu(this.i)||hu(this))},F.Ma=function(){if(this.u=null,pu(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=Zr(bt(this.jb,this),n)}},F.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,vt(10),Tn(this),pu(this))},F.ib=function(){null!=this.v&&(this.v=null,Tn(this),Ec(this),vt(19))},F.pb=function(n){n?(this.l.info("Successfully pinged google.com"),vt(2)):(this.l.info("Failed to ping google.com"),vt(1))},F.isActive=function(){return!!this.h&&this.h.isActive(this)},(F=gu.prototype).Ba=function(){},F.Aa=function(){},F.za=function(){},F.ya=function(){},F.isActive=function(){return!0},F.Va=function(){},bi.prototype.g=function(n,e){return new qt(n,e)},ot(qt,it),qt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;vt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=Ai(n,null,n.Y),Vo(n)},qt.prototype.close=function(){uu(this.g)},qt.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=tc(n),n=t);e.j.push(new Ei(e.fb++,n)),3==e.H&&Vo(e)},qt.prototype.N=function(){this.g.h=null,delete this.j,uu(this.g),delete this.g,qt.$.N.call(this)},ot(Fo,vo),ot(_u,ds),ot(gr,gu),gr.prototype.Ba=function(){yt(this.g,"a")},gr.prototype.Aa=function(n){yt(this.g,new Fo(n))},gr.prototype.za=function(n){yt(this.g,new _u)},gr.prototype.ya=function(){yt(this.g,"b")},ot(En,function yu(){this.blockSize=-1}),En.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},En.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)bc(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){bc(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){bc(this,r),i=0;break}}this.h=i,this.i+=e},En.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var Ci={};function Cc(n){return-128<=n&&128>n?function Bd(n,e){var t=Ci;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new Ne([0|e],0>e?-1:0)}):new Ne([0|n],0>n?-1:0)}function Mn(n){if(isNaN(n)||!isFinite(n))return Si;if(0>n)return at(Mn(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Sc;return new Ne(e,0)}var Sc=4294967296,Si=Cc(0),Ri=Cc(1),Iu=Cc(16777216);function Qn(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function dn(n){return-1==n.h}function at(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ne(t,~n.h).add(Ri)}function Uo(n,e){return n.add(at(e))}function Bo(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function ws(n,e){this.g=n,this.h=e}function zo(n,e){if(Qn(e))throw Error("division by zero");if(Qn(n))return new ws(Si,Si);if(dn(n))return e=zo(at(n),e),new ws(at(e.g),at(e.h));if(dn(e))return e=zo(n,at(e)),new ws(at(e.g),e.h);if(30<n.g.length){if(dn(n)||dn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Ri,r=e;0>=r.X(n);)t=Tu(t),r=Tu(r);var i=Yr(t,1),s=Yr(r,1);for(r=Yr(r,2),t=Yr(t,2);!Qn(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=Yr(r,1),t=Yr(t,1)}return e=Uo(n,i.R(e)),new ws(i,e)}for(i=Si;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),a=(s=Mn(t)).R(e);dn(a)||0<a.X(n);)a=(s=Mn(t-=r)).R(e);Qn(s)&&(s=Ri),i=i.add(s),n=Uo(n,a)}return new ws(i,n)}function Tu(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ne(t,n.h)}function Yr(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ne(i,n.h)}(F=Ne.prototype).ea=function(){if(dn(this))return-at(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Sc+r)*e,e*=Sc}return n},F.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Qn(this))return"0";if(dn(this))return"-"+at(this).toString(n);for(var e=Mn(Math.pow(n,6)),t=this,r="";;){var i=zo(t,e).g,s=((0<(t=Uo(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(Qn(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},F.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},F.X=function(n){return dn(n=Uo(this,n))?-1:Qn(n)?0:1},F.abs=function(){return dn(this)?at(this):this},F.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,t[i]=(a&=65535)<<16|(s&=65535)}return new Ne(t,-2147483648&t[t.length-1]?-1:0)},F.R=function(n){if(Qn(this)||Qn(n))return Si;if(dn(this))return dn(n)?at(this).R(at(n)):at(at(this).R(n));if(dn(n))return at(this.R(at(n)));if(0>this.X(Iu)&&0>n.X(Iu))return Mn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=65535&this.D(r),h=n.D(i)>>>16,f=65535&n.D(i);t[2*r+2*i]+=a*f,Bo(t,2*r+2*i),t[2*r+2*i+1]+=s*f,Bo(t,2*r+2*i+1),t[2*r+2*i+1]+=a*h,Bo(t,2*r+2*i+1),t[2*r+2*i+2]+=s*h,Bo(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ne(t,0)},F.gb=function(n){return zo(this,n).h},F.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ne(t,this.h&n.h)},F.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ne(t,this.h|n.h)},F.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ne(t,this.h^n.h)},bi.prototype.createWebChannel=bi.prototype.g,qt.prototype.send=qt.prototype.u,qt.prototype.open=qt.prototype.m,qt.prototype.close=qt.prototype.close,us.NO_ERROR=0,us.TIMEOUT=8,us.HTTP_ERROR=6,_o.COMPLETE="complete",ac.EventType=Wr,Wr.OPEN="a",Wr.CLOSE="b",Wr.ERROR="c",Wr.MESSAGE="d",it.prototype.listen=it.prototype.O,Ge.prototype.listenOnce=Ge.prototype.P,Ge.prototype.getLastError=Ge.prototype.Sa,Ge.prototype.getLastErrorCode=Ge.prototype.Ia,Ge.prototype.getStatus=Ge.prototype.da,Ge.prototype.getResponseJson=Ge.prototype.Wa,Ge.prototype.getResponseText=Ge.prototype.ja,Ge.prototype.send=Ge.prototype.ha,Ge.prototype.setWithCredentials=Ge.prototype.Oa,En.prototype.digest=En.prototype.l,En.prototype.reset=En.prototype.reset,En.prototype.update=En.prototype.j,Ne.prototype.add=Ne.prototype.add,Ne.prototype.multiply=Ne.prototype.R,Ne.prototype.modulo=Ne.prototype.gb,Ne.prototype.compare=Ne.prototype.X,Ne.prototype.toNumber=Ne.prototype.ea,Ne.prototype.toString=Ne.prototype.toString,Ne.prototype.getBits=Ne.prototype.D,Ne.fromNumber=Mn,Ne.fromString=function vu(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return at(vu(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Mn(Math.pow(e,8)),r=Si,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Mn(Math.pow(e,s)),r=r.R(s).add(Mn(a))):r=(r=r.R(t)).add(Mn(a))}return r};var dh=de.createWebChannelTransport=function(){return new bi},hh=de.getStatEventTarget=function(){return _i()},Rc=de.ErrorCode=us,Pc=de.EventType=_o,fh=de.Event=fr,Go=de.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Pi=(de.FetchXmlHttpFactory=Do,de.WebChannel=ac),ph=de.XhrIo=Ge,xc=de.Md5=En,Yn=de.Integer=Ne;const qo="@firebase/firestore";class pt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pt.UNAUTHENTICATED=new pt(null),pt.GOOGLE_CREDENTIALS=new pt("google-credentials-uid"),pt.FIRST_PARTY=new pt("first-party-uid"),pt.MOCK_USER=new pt("mock-user");let _r="10.7.0";const hn=new L.Yd("@firebase/firestore");function fn(){return hn.logLevel}function U(n,...e){if(hn.logLevel<=L.in.DEBUG){const t=e.map(As);hn.debug(`Firestore (${_r}): ${n}`,...t)}}function tt(n,...e){if(hn.logLevel<=L.in.ERROR){const t=e.map(As);hn.error(`Firestore (${_r}): ${n}`,...t)}}function Zt(n,...e){if(hn.logLevel<=L.in.WARN){const t=e.map(As);hn.warn(`Firestore (${_r}): ${n}`,...t)}}function As(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Y(n="Unexpected state"){const e=`FIRESTORE (${_r}) INTERNAL ASSERTION FAILED: `+n;throw tt(e),new Error(e)}function ne(n,e){n||Y()}function W(n,e){return n}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class V extends Z.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ct{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Zo{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(pt.UNAUTHENTICATED))}shutdown(){}}class gh{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class bs{constructor(e){this.t=e,this.currentUser=pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let a=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ct,e.enqueueRetryable(()=>s(this.currentUser))};const h=()=>{const m=a;e.enqueueRetryable((0,I.Z)(function*(){yield m.promise,yield s(r.currentUser)}))},f=m=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ct)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne("string"==typeof r.accessToken),new Zo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ne(null===e||"string"==typeof e),new pt(e)}}class _h{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=pt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class yh{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new _h(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Wo{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Oc{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{null!=s.error&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ne("string"==typeof t.token),this.R=t.token,new Wo(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function vh(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class jo{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=vh(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function le(n,e){return n<e?-1:n>e?1:0}function Jr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function wu(n){return n+"\0"}class Ze{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Ze(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Ze(0,0))}static max(){return new re(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Cs{constructor(e,t,r){void 0===t?t=0:t>e.length&&Y(),void 0===r?r=e.length-t:r>e.length-t&&Y(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Cs.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Cs?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ae extends Cs{construct(e,t,r){return new Ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new V(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Ae(t)}static emptyPath(){return new Ae([])}}const Nc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ue extends Cs{construct(e,t,r){return new Ue(e,t,r)}static isValidIdentifier(e){return Nc.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ue.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ue(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new V(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new V(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new V(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else"`"===h?(a=!a,i++):"."!==h||a?(r+=h,i++):(s(),i++)}if(s(),a)throw new V(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ue(t)}static emptyPath(){return new Ue([])}}class ${constructor(e){this.path=e}static fromPath(e){return new $(Ae.fromString(e))}static fromName(e){return new $(Ae.fromString(e).popFirst(5))}static empty(){return new $(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ae.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new Ae(e.slice()))}}class yr{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Vc(n){return n.fields.find(e=>2===e.kind)}function Jn(n){return n.fields.filter(e=>2!==e.kind)}yr.UNKNOWN_ID=-1;class Xn{constructor(e,t){this.fieldPath=e,this.kind=t}}class vr{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new vr(0,Wt.min())}}function bu(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=re.fromTimestamp(1e9===r?new Ze(t+1,0):new Ze(t,r));return new Wt(i,$.empty(),e)}function Mc(n){return new Wt(n.readTime,n.key,-1)}class Wt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Wt(re.min(),$.empty(),-1)}static max(){return new Wt(re.max(),$.empty(),-1)}}function Ho(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=$.comparator(n.documentKey,e.documentKey),0!==t?t:le(n.largestBatchId,e.largestBatchId))}const Cu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ln(n){return Fc.apply(this,arguments)}function Fc(){return Fc=(0,I.Z)(function*(n){if(n.code!==D.FAILED_PRECONDITION||n.message!==Cu)throw n;U("LocalStore","Unexpectedly lost primary lease")}),Fc.apply(this,arguments)}class S{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new S((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof S?t:S.resolve(t)}catch(t){return S.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):S.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):S.reject(t)}static resolve(e){return new S((t,r)=>{t(e)})}static reject(e){return new S((t,r)=>{r(e)})}static waitFor(e){return new S((t,r)=>{let i=0,s=0,a=!1;e.forEach(h=>{++i,h.next(()=>{++s,a&&s===i&&t()},f=>r(f))}),a=!0,s===i&&t()})}static or(e){let t=S.resolve(!1);for(const r of e)t=t.next(i=>i?S.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new S((r,i)=>{const s=e.length,a=new Array(s);let h=0;for(let f=0;f<s;f++){const m=f;t(e[m]).next(g=>{a[m]=g,++h,h===s&&r(a)},g=>i(g))}})}static doWhile(e,t){return new S((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Ko{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ct,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ss(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Uc(r.target.error);this.V.reject(new Ss(e,i))}}static open(e,t,r,i){try{return new Ko(t,e.transaction(i,r))}catch(s){throw new Ss(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Th(t)}}class tn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===tn.S((0,Z.z$)())&&tt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),Fn(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,Z.hl)())return!1;if(tn.C())return!0;const e=(0,Z.z$)(),t=tn.S(e),r=0<t&&t<10,i=tn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,I.Z)(function*(){return t.db||(U("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=a=>{r(a.target.result)},s.onblocked=()=>{i(new Ss(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const h=a.target.error;i("VersionError"===h.name?new V(D.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new V(D.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new Ss(e,h))},s.onupgradeneeded=a=>{U("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',a.oldVersion),t.p.N(a.target.result,s.transaction,a.oldVersion,t.version).next(()=>{U("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,I.Z)(function*(){const a="readonly"===t;let h=0;for(;;){++h;try{s.db=yield s.O(e);const f=Ko.open(s.db,e,a?"readonly":"readwrite",r),m=i(f).next(g=>(f.g(),g)).catch(g=>(f.abort(g),S.reject(g))).toPromise();return m.catch(()=>{}),yield f.m,m}catch(f){const m=f,g="FirebaseError"!==m.name&&h<3;if(U("SimpleDb","Transaction failed with error:",m.message,"Retrying:",g),s.close(),!g)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ih{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Fn(this.k.delete())}}class Ss extends V{constructor(e,t){super(D.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function er(n){return"IndexedDbTransactionError"===n.name}class Th{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Fn(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),Fn(this.store.add(e))}get(e){return Fn(this.store.get(e)).next(t=>(void 0===t&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),Fn(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),Fn(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(a,h)=>{s.push(h)}).next(()=>s)}{const i=this.store.getAll(r.range);return new S((s,a)=>{i.onerror=h=>{a(h.target.error)},i.onsuccess=h=>{s(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new S((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){U("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,h)=>h.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new S((r,i)=>{t.onerror=s=>{const a=Uc(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(h=>{h?a.continue():r()}):r()}})}G(e,t){const r=[];return new S((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const h=a.target.result;if(!h)return void i();const f=new Ih(h),m=t(h.primaryKey,h.value,f);if(m instanceof S){const g=m.catch(y=>(f.done(),S.reject(y)));r.push(g)}f.isDone?i():null===f.$?h.continue():h.continue(f.$)}}).next(()=>S.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Fn(n){return new S((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Uc(r.target.error);t(i)}})}let Su=!1;function Uc(n){const e=tn.S((0,Z.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new V("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Su||(Su=!0,setTimeout(()=>{throw r},0)),r}}return n}class Eh{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;U("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,I.Z)(function*(){t.task=null;try{U("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(r){er(r)?U("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Ln(r)}yield t.ee(6e4)}))}}class wh{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,I.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.ne(r,e))})()}ne(e,t){const r=new Set;let i=t,s=!0;return S.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(null!==a&&!r.has(a))return U("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(h=>{i-=h,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(h=>(U("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=Mc(s);Ho(a,r)>0&&(r=a)}),new Wt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let nn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function Rs(n){return null==n}function Ps(n){return 0===n&&1/n==-1/0}function Ru(n){return"number"==typeof n&&Number.isInteger(n)&&!Ps(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function mt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Pu(e)),e=Ah(n.get(t),e);return Pu(e)}function Ah(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function Pu(n){return n+"\x01\x01"}function Un(n){const e=n.length;if(ne(e>=2),2===e)return ne("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Ae.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("\x01",s);switch((a<0||a>t)&&Y(),n.charAt(a+1)){case"\x01":const h=n.substring(s,a);let f;0===i.length?f=h:(i+=h,f=i,i=""),r.push(f);break;case"\x10":i+=n.substring(s,a),i+="\0";break;case"\x11":i+=n.substring(s,a+1);break;default:Y()}s=a+2}return new Ae(r)}const xu=["userId","batchId"];function Qo(n,e){return[n,mt(e)]}function Bc(n,e,t){return[n,mt(e),t]}const bh={},Ch=["prefixPath","collectionGroup","readTime","documentId"],Sh=["prefixPath","collectionGroup","documentId"],Rh=["collectionGroup","readTime","prefixPath","documentId"],Ph=["canonicalId","targetId"],zc=["targetId","path"],Gc=["path","targetId"],xh=["collectionId","parent"],qc=["indexId","uid"],Dh=["uid","sequenceNumber"],Du=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kh=["indexId","uid","orderedDocumentKey"],Zc=["userId","collectionPath","documentId"],Oh=["userId","collectionPath","largestBatchId"],Jp=["userId","collectionGroup","largestBatchId"],Yo=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ku=[...Yo,"documentOverlays"],xs=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Wc=xs,Ou=[...Wc,"indexConfiguration","indexState","indexEntries"];class jc extends Lc{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function gt(n,e){const t=W(n);return tn.M(t.ae,e)}function Nu(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ir(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Vu(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ve{constructor(e,t){this.comparator=e,this.root=t||St.EMPTY}insert(e,t){return new Ve(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new Ve(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jo(this.root,e,this.comparator,!0)}}class Jo{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??St.RED,this.left=i??St.EMPTY,this.right=s??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new St(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return St.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();const e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1,St.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(e,t,r,i,s){return this}insert(e,t,r){return new St(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class be{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mu(this.data.getIterator())}getIteratorFrom(e){return new Mu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof be)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new be(this.comparator);return t.data=e,t}}class Mu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xi(n){return n.hasNext()?n.getNext():void 0}class Rt{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new Rt([])}unionWith(e){let t=new be(Ue.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Rt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jr(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Lu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Lu("Invalid base64 string: "+s):s}}(e);return new lt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new lt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lt.EMPTY_BYTE_STRING=new lt("");const Nh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bn(n){if(ne(!!n),"string"==typeof n){let e=0;const t=Nh.exec(n);if(ne(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(n.seconds),nanos:Ke(n.nanos)}}function Ke(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function tr(n){return"string"==typeof n?lt.fromBase64String(n):lt.fromUint8Array(n)}function Di(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Xo(n){const e=n.mapValue.fields.__previous_value__;return Di(e)?Xo(e):e}function Ds(n){const e=Bn(n.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}class Vh{constructor(e,t,r,i,s,a,h,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m}}class Tr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Tr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Tr&&e.projectId===this.projectId&&e.database===this.database}}const Er={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ks={nullValue:"NULL_VALUE"};function zn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Di(n)?4:Uu(n)?9007199254740991:10:Y()}function Gn(n,e){if(n===e)return!0;const t=zn(n);if(t!==zn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ds(n).isEqual(Ds(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Bn(i.timestampValue),h=Bn(s.timestampValue);return a.seconds===h.seconds&&a.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,tr(n.bytesValue).isEqual(tr(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Ke(i.doubleValue),h=Ke(s.doubleValue);return a===h?Ps(a)===Ps(h):isNaN(a)&&isNaN(h)}return!1}(n,e);case 9:return Jr(n.arrayValue.values||[],e.arrayValue.values||[],Gn);case 10:return function(i,s){const a=i.mapValue.fields||{},h=s.mapValue.fields||{};if(Nu(a)!==Nu(h))return!1;for(const f in a)if(a.hasOwnProperty(f)&&(void 0===h[f]||!Gn(a[f],h[f])))return!1;return!0}(n,e);default:return Y()}var s}function Os(n,e){return void 0!==(n.values||[]).find(t=>Gn(t,e))}function qn(n,e){if(n===e)return 0;const t=zn(n),r=zn(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(s,a){const h=Ke(s.integerValue||s.doubleValue),f=Ke(a.integerValue||a.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(n,e);case 3:return ea(n.timestampValue,e.timestampValue);case 4:return ea(Ds(n),Ds(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(s,a){const h=tr(s),f=tr(a);return h.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const h=s.split("/"),f=a.split("/");for(let m=0;m<h.length&&m<f.length;m++){const g=le(h[m],f[m]);if(0!==g)return g}return le(h.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const h=le(Ke(s.latitude),Ke(a.latitude));return 0!==h?h:le(Ke(s.longitude),Ke(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const h=s.values||[],f=a.values||[];for(let m=0;m<h.length&&m<f.length;++m){const g=qn(h[m],f[m]);if(g)return g}return le(h.length,f.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Er.mapValue&&a===Er.mapValue)return 0;if(s===Er.mapValue)return 1;if(a===Er.mapValue)return-1;const h=s.fields||{},f=Object.keys(h),m=a.fields||{},g=Object.keys(m);f.sort(),g.sort();for(let y=0;y<f.length&&y<g.length;++y){const w=le(f[y],g[y]);if(0!==w)return w;const R=qn(h[f[y]],m[g[y]]);if(0!==R)return R}return le(f.length,g.length)}(n.mapValue,e.mapValue);default:throw Y()}}function ea(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return le(n,e);const t=Bn(n),r=Bn(e),i=le(t.seconds,r.seconds);return 0!==i?i:le(t.nanos,r.nanos)}function ki(n){return Hc(n)}function Hc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Bn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?tr(n.bytesValue).toBase64():"referenceValue"in n?$.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Hc(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Hc(t.fields[a])}`;return i+"}"}(n.mapValue):Y()}function ei(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Kc(n){return!!n&&"integerValue"in n}function Ns(n){return!!n&&"arrayValue"in n}function Qc(n){return!!n&&"nullValue"in n}function Fu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ta(n){return!!n&&"mapValue"in n}function Vs(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ir(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Vs(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vs(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Uu(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Ms(n){return"nullValue"in n?ks:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ei(Tr.empty(),$.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Y()}function Mh(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ei(Tr.empty(),$.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Er:Y()}function Yc(n,e){const t=qn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Bu(n,e){const t=qn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ta(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vs(t)}setAll(e){let t=Ue.emptyPath(),r={},i=[];e.forEach((a,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,i),r={},i=[],t=h.popLast()}a?r[h.lastSegment()]=Vs(a):i.push(h.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());ta(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ta(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ir(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new It(Vs(this.value))}}function zu(n){const e=[];return Ir(n.fields,(t,r)=>{const i=new Ue([t]);if(ta(r)){const s=zu(r.mapValue).fields;if(0===s.length)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Rt(e)}class Be{constructor(e,t,r,i,s,a,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=h}static newInvalidDocument(e){return new Be(e,0,re.min(),re.min(),re.min(),It.empty(),0)}static newFoundDocument(e,t,r,i){return new Be(e,1,t,re.min(),r,i,0)}static newNoDocument(e,t){return new Be(e,2,t,re.min(),re.min(),It.empty(),0)}static newUnknownDocument(e,t){return new Be(e,3,t,re.min(),re.min(),It.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class nr{constructor(e,t){this.position=e,this.inclusive=t}}function na(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(r=s.field.isKeyField()?$.comparator($.fromName(a.referenceValue),t.key):qn(a,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function ra(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gn(n.position[t],e.position[t]))return!1;return!0}class Oi{constructor(e,t="asc"){this.field=e,this.dir=t}}function Lh(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ia{}class Te extends ia{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new wr(e,t,r):"array-contains"===t?new Uh(e,r):"in"===t?new el(e,r):"not-in"===t?new jt(e,r):"array-contains-any"===t?new tl(e,r):new Te(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Zu(e,r):new Fh(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(qn(t,this.value)):null!==t&&zn(this.value)===zn(t)&&this.matchesComparison(qn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class me extends ia{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new me(e,t)}matches(e){return Zn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Zn(n){return"and"===n.op}function sa(n){return"or"===n.op}function Jc(n){return oa(n)&&Zn(n)}function oa(n){for(const e of n.filters)if(e instanceof me)return!1;return!0}function Ls(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+ki(n.value);if(Jc(n))return n.filters.map(e=>Ls(e)).join(",");{const e=n.filters.map(t=>Ls(t)).join(",");return`${n.op}(${e})`}}function Gu(n,e){return n instanceof Te?(r=n,(i=e)instanceof Te&&r.op===i.op&&r.field.isEqual(i.field)&&Gn(r.value,i.value)):n instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,a,h)=>s&&Gu(a,i.filters[h]),!0)}(n,e):void Y();var r,i}function Xc(n,e){const t=n.filters.concat(e);return me.create(t,n.op)}function qu(n){return n instanceof Te?`${(t=n).field.canonicalString()} ${t.op} ${ki(t.value)}`:n instanceof me?function(t){return t.op.toString()+" {"+t.getFilters().map(qu).join(" ,")+"}"}(n):"Filter";var t}class wr extends Te{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){const t=$.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zu extends Te{constructor(e,t){super(e,"in",t),this.keys=Wu(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Fh extends Te{constructor(e,t){super(e,"not-in",t),this.keys=Wu(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Wu(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}class Uh extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ns(t)&&Os(t.arrayValue,this.value)}}class el extends Te{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Os(this.value.arrayValue,t)}}class jt extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(Os(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Os(this.value.arrayValue,t)}}class tl extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ns(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Os(this.value.arrayValue,r))}}class nl{constructor(e,t=null,r=[],i=[],s=null,a=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=h,this.ce=null}}function rl(n,e=null,t=[],r=[],i=null,s=null,a=null){return new nl(n,e,t,r,i,s,a)}function Mt(n){const e=W(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ls(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Rs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ki(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ki(r)).join(",")),e.ce=t}return e.ce}function rr(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Lh(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Gu(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ra(n.startAt,e.startAt)&&ra(n.endAt,e.endAt)}function Fs(n){return $.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Us(n,e){return n.filters.filter(t=>t instanceof Te&&t.field.isEqual(e))}function ju(n,e,t){let r=ks,i=!0;for(const s of Us(n,e)){let a=ks,h=!0;switch(s.op){case"<":case"<=":a=Ms(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,h=!1;break;case"!=":case"not-in":a=ks}Yc({value:r,inclusive:i},{value:a,inclusive:h})<0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Yc({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}function aa(n,e,t){let r=Er,i=!0;for(const s of Us(n,e)){let a=Er,h=!0;switch(s.op){case">=":case">":a=Mh(s.value),h=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,h=!1;break;case"!=":case"not-in":a=Er}Bu({value:r,inclusive:i},{value:a,inclusive:h})>0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Bu({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}class ir{constructor(e,t=null,r=[],i=[],s=null,a="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=h,this.endAt=f,this.le=null,this.he=null,this.Pe=null}}function $u(n,e,t,r,i,s,a,h){return new ir(n,e,t,r,i,s,a,h)}function Ni(n){return new ir(n)}function Hu(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function l(n){return null!==n.collectionGroup}function o(n){const e=W(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let h=new be(Ue.comparator);return a.filters.forEach(f=>{f.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Oi(s,r))}),t.has(Ue.keyField().canonicalString())||e.le.push(new Oi(Ue.keyField(),r))}return e.le}function c(n){const e=W(n);return e.he||(e.he=function u(n,e){if("F"===n.limitType)return rl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new Oi(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new nr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new nr(n.startAt.position,n.startAt.inclusive):null;return rl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,o(n))),e.he}function p(n,e){const t=n.filters.concat([e]);return new ir(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function _(n,e,t){return new ir(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function T(n,e){return rr(c(n),c(e))&&n.limitType===e.limitType}function C(n){return`${Mt(c(n))}|lt:${n.limitType}`}function O(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>qu(i)).join(", ")}]`),Rs(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(a=i).field.canonicalString()} (${a.dir})`;var a}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ki(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ki(i)).join(",")),`Target(${r})`}(c(n))}; limitType=${n.limitType})`}function j(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of o(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(a,h,f){const m=na(a,h,f);return a.inclusive?m<=0:m<0}(r.startAt,o(r),i)||r.endAt&&!function(a,h,f){const m=na(a,h,f);return a.inclusive?m>=0:m>0}(r.endAt,o(r),i)));var r,i}function J(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function X(n){return(e,t)=>{let r=!1;for(const i of o(n)){const s=je(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function je(n,e,t){const r=n.field.isKeyField()?$.comparator(e.key,t.key):function(s,a,h){const f=a.data.field(s),m=h.data.field(s);return null!==f&&null!==m?qn(f,m):Y()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}class ut{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ir(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Vu(this.inner)}size(){return this.innerSize}}const ca=new Ve($.comparator);function Lt(){return ca}const la=new Ve($.comparator);function Vi(...n){let e=la;for(const t of n)e=e.insert(t.key,t);return e}function il(n){let e=la;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function pn(){return Mi()}function sl(){return Mi()}function Mi(){return new ut(n=>n.toString(),(n,e)=>n.isEqual(e))}const ol=new Ve($.comparator),Ku=new be($.comparator);function pe(...n){let e=Ku;for(const t of n)e=e.add(t);return e}const al=new be(le);function cl(){return al}function Xp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ps(e)?"-0":e}}function em(n){return{integerValue:""+n}}function tm(n,e){return Ru(e)?em(e):Xp(n,e)}class Qu{constructor(){this._=void 0}}function J_(n,e,t){return n instanceof ua?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Di(s)&&(s=Xo(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Bs?rm(n,e):n instanceof zs?im(n,e):function(i,s){const a=nm(i,s),h=sm(a)+sm(i.Ie);return Kc(a)&&Kc(i.Ie)?em(h):Xp(i.serializer,h)}(n,e)}function X_(n,e,t){return n instanceof Bs?rm(n,e):n instanceof zs?im(n,e):t}function nm(n,e){return n instanceof da?Kc(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class ua extends Qu{}class Bs extends Qu{constructor(e){super(),this.elements=e}}function rm(n,e){const t=om(e);for(const r of n.elements)t.some(i=>Gn(i,r))||t.push(r);return{arrayValue:{values:t}}}class zs extends Qu{constructor(e){super(),this.elements=e}}function im(n,e){let t=om(e);for(const r of n.elements)t=t.filter(i=>!Gn(i,r));return{arrayValue:{values:t}}}class da extends Qu{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function sm(n){return Ke(n.integerValue||n.doubleValue)}function om(n){return Ns(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ll{constructor(e,t){this.field=e,this.transform=t}}class ty{constructor(e,t){this.version=e,this.transformResults=t}}class Qe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qe}static exists(e){return new Qe(void 0,e)}static updateTime(e){return new Qe(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yu(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Ju{}function am(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new fa(n.key,Qe.none()):new ha(n.key,n.data,Qe.none());{const t=n.data,r=It.empty();let i=new be(Ue.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);null===a&&s.length>1&&(s=s.popLast(),a=t.field(s)),null===a?r.delete(s):r.set(s,a),i=i.add(s)}return new ti(n.key,r,new Rt(i.toArray()),Qe.none())}}function ny(n,e,t){n instanceof ha?function(i,s,a){const h=i.value.clone(),f=um(i.fieldTransforms,s,a.transformResults);h.setAll(f),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):n instanceof ti?function(i,s,a){if(!Yu(i.precondition,s))return void s.convertToUnknownDocument(a.version);const h=um(i.fieldTransforms,s,a.transformResults),f=s.data;f.setAll(lm(i)),f.setAll(h),s.convertToFoundDocument(a.version,f).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function ul(n,e,t,r){return n instanceof ha?function(s,a,h,f){if(!Yu(s.precondition,a))return h;const m=s.value.clone(),g=dm(s.fieldTransforms,f,a);return m.setAll(g),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof ti?function(s,a,h,f){if(!Yu(s.precondition,a))return h;const m=dm(s.fieldTransforms,f,a),g=a.data;return g.setAll(lm(s)),g.setAll(m),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null===h?null:h.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(n,e,t,r):(h=t,Yu(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):h);var a,h}function ry(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=nm(r.transform,i||null);null!=s&&(null===t&&(t=It.empty()),t.set(r.field,s))}return t||null}function cm(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&Jr(r,i,(s,a)=>function ey(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof Bs&&i instanceof Bs||r instanceof zs&&i instanceof zs?Jr(r.elements,i.elements,Gn):r instanceof da&&i instanceof da?Gn(r.Ie,i.Ie):r instanceof ua&&i instanceof ua);var r,i}(s,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class ha extends Ju{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ti extends Ju{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function lm(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function um(n,e,t){const r=new Map;ne(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,h=e.data.field(s.field);r.set(s.field,X_(a,h,t[i]))}return r}function dm(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,J_(s,a,e))}return r}class fa extends Ju{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bh extends Ju{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class zh{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ny(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ul(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ul(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sl();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let h=this.applyToLocalView(a,s.mutatedFields);h=t.has(i.key)?null:h;const f=am(a,h);null!==f&&r.set(i.key,f),a.isValidDocument()||a.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&Jr(this.mutations,e.mutations,(t,r)=>cm(t,r))&&Jr(this.baseMutations,e.baseMutations,(t,r)=>cm(t,r))}}class Gh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ne(e.mutations.length===r.length);let i=ol;const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Gh(e,t,r,i)}}class qh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class sy{constructor(e,t){this.count=e,this.unchangedNames=t}}var _t,Se;function hm(n){switch(n){default:return Y();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function fm(n){if(void 0===n)return tt("GRPC error has no .code"),D.UNKNOWN;switch(n){case _t.OK:return D.OK;case _t.CANCELLED:return D.CANCELLED;case _t.UNKNOWN:return D.UNKNOWN;case _t.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case _t.INTERNAL:return D.INTERNAL;case _t.UNAVAILABLE:return D.UNAVAILABLE;case _t.UNAUTHENTICATED:return D.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case _t.NOT_FOUND:return D.NOT_FOUND;case _t.ALREADY_EXISTS:return D.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return D.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case _t.ABORTED:return D.ABORTED;case _t.OUT_OF_RANGE:return D.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return D.UNIMPLEMENTED;case _t.DATA_LOSS:return D.DATA_LOSS;default:return Y()}}(Se=_t||(_t={}))[Se.OK=0]="OK",Se[Se.CANCELLED=1]="CANCELLED",Se[Se.UNKNOWN=2]="UNKNOWN",Se[Se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Se[Se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Se[Se.NOT_FOUND=5]="NOT_FOUND",Se[Se.ALREADY_EXISTS=6]="ALREADY_EXISTS",Se[Se.PERMISSION_DENIED=7]="PERMISSION_DENIED",Se[Se.UNAUTHENTICATED=16]="UNAUTHENTICATED",Se[Se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Se[Se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Se[Se.ABORTED=10]="ABORTED",Se[Se.OUT_OF_RANGE=11]="OUT_OF_RANGE",Se[Se.UNIMPLEMENTED=12]="UNIMPLEMENTED",Se[Se.INTERNAL=13]="INTERNAL",Se[Se.UNAVAILABLE=14]="UNAVAILABLE",Se[Se.DATA_LOSS=15]="DATA_LOSS";function pm(){return new TextEncoder}const oy=new Yn([4294967295,4294967295],0);function mm(n){const e=pm().encode(n),t=new xc;return t.update(e),new Uint8Array(t.digest())}function gm(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Yn([t,r],0),new Yn([i,s],0)]}class Zh{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new dl(`Invalid padding: ${t}`);if(r<0)throw new dl(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new dl(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new dl(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Yn.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Yn.fromNumber(r)));return 1===i.compare(oy)&&(i=new Yn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=mm(e),[r,i]=gm(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Zh(s,i,t);return r.forEach(h=>a.insert(h)),a}insert(e){if(0===this.Te)return;const t=mm(e),[r,i]=gm(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class dl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hl{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,fl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new hl(re.min(),i,new Ve(le),Lt(),pe())}}class fl{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new fl(r,t,pe(),pe(),pe())}}class ed{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class _m{constructor(e,t){this.targetId=e,this.fe=t}}class ym{constructor(e,t,r=lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class vm{constructor(){this.ge=0,this.pe=Tm(),this.ye=lt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=pe(),t=pe(),r=pe();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new fl(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=Tm()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,ne(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class ay{constructor(e){this.Le=e,this.ke=new Map,this.qe=Lt(),this.Qe=Im(),this.Ke=new Ve(le)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:Y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(Fs(s))if(0===r){const a=new $(s.path);this.We(t,a,Be.newNoDocument(a,re.min()))}else ne(1===r);else{const a=this.Ze(t);if(a!==r){const h=this.Xe(e),f=h?this.et(h,e,a):1;0!==f&&(this.He(t),this.Ke=this.Ke.insert(t,2===f?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,h;try{a=tr(r).toUint8Array()}catch(f){if(f instanceof Lu)return Zt("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Zh(a,i,s)}catch(f){return Zt(f instanceof dl?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return 0===h.Te?null:h}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),h=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(h)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const h=this.Ye(a);if(h){if(s.current&&Fs(h.target)){const f=new $(h.target.path);null!==this.qe.get(f)||this.st(a,f)||this.We(a,f,Be.newNoDocument(f,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=pe();this.Qe.forEach((s,a)=>{let h=!0;a.forEachWhile(f=>{const m=this.Ye(f);return!m||"TargetPurposeLimboResolution"===m.purpose||(h=!1,!1)}),h&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new hl(e,t,this.Ke,this.qe,r);return this.qe=Lt(),this.Qe=Im(),this.Ke=new Ve(le),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new vm,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new be(le),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||U("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new vm),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Im(){return new Ve($.comparator)}function Tm(){return new Ve($.comparator)}const cy={asc:"ASCENDING",desc:"DESCENDING"},ly={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uy={and:"AND",or:"OR"};class dy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Wh(n,e){return n.useProto3Json||Rs(e)?e:{value:e}}function pa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Em(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hy(n,e){return pa(n,e.toTimestamp())}function dt(n){return ne(!!n),re.fromTimestamp(function(t){const r=Bn(t);return new Ze(r.seconds,r.nanos)}(n))}function jh(n,e){return(r=n,new Ae(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function wm(n){const e=Ae.fromString(n);return ne(km(e)),e}function pl(n,e){return jh(n.databaseId,e.path)}function Ar(n,e){const t=wm(e);if(t.get(1)!==n.databaseId.projectId)throw new V(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(bm(t))}function $h(n,e){return jh(n.databaseId,e)}function Am(n){const e=wm(n);return 4===e.length?Ae.emptyPath():bm(e)}function ml(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bm(n){return ne(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Cm(n,e,t){return{name:pl(n,e),fields:t.value.mapValue.fields}}function Sm(n,e,t){const r=Ar(n,e.name),i=dt(e.updateTime),s=e.createTime?dt(e.createTime):re.min(),a=new It({mapValue:{fields:e.fields}}),h=Be.newFoundDocument(r,i,s,a);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function gl(n,e){let t;if(e instanceof ha)t={update:Cm(n,e.key,e.value)};else if(e instanceof fa)t={delete:pl(n,e.key)};else if(e instanceof ti)t={update:Cm(n,e.key,e.data),updateMask:Iy(e.fieldMask)};else{if(!(e instanceof Bh))return Y();t={verify:pl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const h=a.transform;if(h instanceof ua)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Bs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof zs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof da)return{fieldPath:a.field.canonicalString(),increment:h.Ie};throw Y()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:hy(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Y()),t;var s}function Hh(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Qe.updateTime(dt(s.updateTime)):void 0!==s.exists?Qe.exists(s.exists):Qe.none():Qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,h){let f=null;"setToServerValue"in h?(ne("REQUEST_TIME"===h.setToServerValue),f=new ua):"appendMissingElements"in h?f=new Bs(h.appendMissingElements.values||[]):"removeAllFromArray"in h?f=new zs(h.removeAllFromArray.values||[]):"increment"in h?f=new da(a,h.increment):Y();const m=Ue.fromServerFormat(h.fieldPath);return new ll(m,f)}(n,i)):[];var s;if(e.update){const i=Ar(n,e.update.name),s=new It({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=new Rt((e.updateMask.fieldPaths||[]).map(g=>Ue.fromServerFormat(g)));return new ti(i,s,a,t,r)}return new ha(i,s,t,r)}if(e.delete){const i=Ar(n,e.delete);return new fa(i,t)}if(e.verify){const i=Ar(n,e.verify);return new Bh(i,t)}return Y()}function Rm(n,e){return{documents:[$h(n,e.path)]}}function Kh(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=$h(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=$h(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(f){if(0!==f.length)return Dm(me.create(f,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(f){if(0!==f.length)return f.map(m=>{return{field:Li((y=m).field),direction:_y(y.dir)};var y})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Wh(n,e.limit);return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(f=e.startAt).inclusive,values:f.position}),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),t;var f}function Pm(n){let e=Am(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ne(1===r);const g=t.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=function(y){const w=xm(y);return w instanceof me&&Jc(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=t.orderBy.map(w=>{return new Oi(ma((z=w).field),function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(z.direction));var z}));let h=null;t.limit&&(h=function(y){let w;return w="object"==typeof y?y.value:y,Rs(w)?null:w}(t.limit));let f=null;var y;t.startAt&&(f=new nr((y=t.startAt).values||[],!!y.before));let m=null;return t.endAt&&(m=function(y){return new nr(y.values||[],!y.before)}(t.endAt)),$u(e,i,a,s,h,"F",f,m)}function xm(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ma(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ma(t.unaryFilter.field);return Te.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ma(t.unaryFilter.field);return Te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ma(t.unaryFilter.field);return Te.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}(n):void 0!==n.fieldFilter?Te.create(ma((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return me.create(t.compositeFilter.filters.map(r=>xm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y()}}(t.compositeFilter.op))}(n):Y();var t}function _y(n){return cy[n]}function yy(n){return ly[n]}function vy(n){return uy[n]}function Li(n){return{fieldPath:n.canonicalString()}}function ma(n){return Ue.fromServerFormat(n.fieldPath)}function Dm(n){return n instanceof Te?function(t){if("=="===t.op){if(Fu(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NAN"}};if(Qc(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fu(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NOT_NAN"}};if(Qc(t.value))return{unaryFilter:{field:Li(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Li(t.field),op:yy(t.op),value:t.value}}}(n):n instanceof me?function(t){const r=t.getFilters().map(i=>Dm(i));return 1===r.length?r[0]:{compositeFilter:{op:vy(t.op),filters:r}}}(n):Y()}function Iy(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function km(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ni{constructor(e,t,r,i,s=re.min(),a=re.min(),h=lt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new ni(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ni(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ni(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Om{constructor(e){this.ut=e}}function Nm(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:td(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:pl(s=n.ut,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:pa(s,a.version.toTimestamp()),createTime:pa(s,a.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Gs(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:t.path.toArray(),version:Gs(e.version)}}var s,a;return r}function td(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Gs(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function qs(n){const e=new Ze(n.seconds,n.nanoseconds);return re.fromTimestamp(e)}function Zs(n,e){const t=(e.baseMutations||[]).map(s=>Hh(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>Hh(n.ut,s)),i=Ze.fromMillis(e.localWriteTimeMs);return new zh(e.batchId,i,t,r)}function _l(n){const e=qs(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?qs(n.lastLimboFreeSnapshotVersion):re.min();let r;return r=void 0!==n.query.documents?(ne(1===(s=n.query).documents.length),c(Ni(Am(s.documents[0])))):function(s){return c(Pm(s))}(n.query),new ni(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,lt.fromBase64String(n.resumeToken));var s}function Vm(n,e){const t=Gs(e.snapshotVersion),r=Gs(e.lastLimboFreeSnapshotVersion);let i;i=Fs(e.target)?Rm(n.ut,e.target):Kh(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Mt(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Qh(n){const e=Pm({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?_(e,e.limit,"L"):e}function Yh(n,e){return new qh(e.largestBatchId,Hh(n.ut,e.overlayMutation))}function Mm(n,e){const t=e.path.lastSegment();return[n,mt(e.path.popLast()),t]}function Lm(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Gs(r.readTime),documentKey:mt(r.documentKey.path),largestBatchId:r.largestBatchId}}class Ey{getBundleMetadata(e,t){return Fm(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:qs(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return Fm(e).put({bundleId:(i=t).id,createTime:Gs(dt(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return Um(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:Qh(s.bundledQuery),readTime:qs(s.readTime)};var s})}saveNamedQuery(e,t){return Um(e).put({name:(i=t).name,readTime:Gs(dt(i.readTime)),bundledQuery:i.bundledQuery});var i}}function Fm(n){return gt(n,"bundles")}function Um(n){return gt(n,"namedQueries")}class nd{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new nd(e,t.uid||"")}getOverlay(e,t){return yl(e).get(Mm(this.userId,t)).next(r=>r?Yh(this.serializer,r):null)}getOverlays(e,t){const r=pn();return S.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const h=new qh(t,a);i.push(this.lt(e,h))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(mt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const h=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(yl(e).H("collectionPathOverlayIndex",h))}),S.waitFor(s)}getOverlaysForCollection(e,t,r){const i=pn(),s=mt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return yl(e).W("collectionPathOverlayIndex",a).next(h=>{for(const f of h){const m=Yh(this.serializer,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=pn();let a;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return yl(e).Y({index:"collectionGroupOverlayIndex",range:h},(f,m,g)=>{const y=Yh(this.serializer,m);s.size()<i||y.largestBatchId===a?(s.set(y.getKey(),y),a=y.largestBatchId):g.done()}).next(()=>s)}lt(e,t){return yl(e).put(function(i,s,a){const[h,f,m]=Mm(s,a.mutation.key);return{userId:s,collectionPath:f,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:gl(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function yl(n){return gt(n,"documentOverlays")}class Ws{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Ke(e.integerValue));else if("doubleValue"in e){const r=Ke(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),Ps(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(tr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?Uu(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):Y()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),$.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function wy(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Bm(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=wy(255&r[s]);if(i+=a,8!==a)break}return i}(n);return Math.ceil(e/8)}Ws.St=new Ws;class Ay{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=Bm(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=Bm(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class by{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Cy{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class vl{constructor(){this.Wt=new Ay,this.Gt=new by(this.Wt),this.zt=new Cy(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class js{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new js(this.indexId,this.documentKey,this.arrayValue,r)}}function Fi(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=zm(n.arrayValue,e.arrayValue),0!==t?t:(t=zm(n.directionalValue,e.directionalValue),0!==t?t:$.comparator(n.documentKey,e.documentKey)))}function zm(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Gm{constructor(e){this.Jt=new be((t,r)=>Ue.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(ne(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Vc(e);if(void 0!==t&&!this.tn(t))return!1;const r=Jn(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const h=this.Jt.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=r[s];if(!this.nn(h,f)||!this.rn(this.Yt[a++],f))return!1}++s}for(;s<r.length;++s)if(a>=this.Yt.length||!this.rn(this.Yt[a++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new be(Ue.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Xn(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Xn(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Xn(r.field,"asc"===r.dir?0:1)));return new yr(yr.UNKNOWN_ID,this.collectionId,t,vr.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function qm(n){var e,t;if(ne(n instanceof Te||n instanceof me),n instanceof Te){if(n instanceof el){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Te.create(n.field,"==",s)))||[];return me.create(i,"or")}return n}const r=n.filters.map(i=>qm(i));return me.create(r,n.op)}function Sy(n){if(0===n.getFilters().length)return[];const e=ef(qm(n));return ne(Zm(e)),Jh(e)||Xh(e)?[e]:e.getFilters()}function Jh(n){return n instanceof Te}function Xh(n){return n instanceof me&&Jc(n)}function Zm(n){return Jh(n)||Xh(n)||function(t){if(t instanceof me&&sa(t)){for(const r of t.getFilters())if(!Jh(r)&&!Xh(r))return!1;return!0}return!1}(n)}function ef(n){if(ne(n instanceof Te||n instanceof me),n instanceof Te)return n;if(1===n.filters.length)return ef(n.filters[0]);const e=n.filters.map(r=>ef(r));let t=me.create(e,n.op);return t=rd(t),Zm(t)?t:(ne(t instanceof me),ne(Zn(t)),ne(t.filters.length>1),t.filters.reduce((r,i)=>tf(r,i)))}function tf(n,e){let t;return ne(n instanceof Te||n instanceof me),ne(e instanceof Te||e instanceof me),t=n instanceof Te?e instanceof Te?me.create([n,e],"and"):Wm(n,e):e instanceof Te?Wm(e,n):function(i,s){if(ne(i.filters.length>0&&s.filters.length>0),Zn(i)&&Zn(s))return Xc(i,s.getFilters());const a=sa(i)?i:s,h=sa(i)?s:i,f=a.filters.map(m=>tf(m,h));return me.create(f,"or")}(n,e),rd(t)}function Wm(n,e){if(Zn(e))return Xc(e,n.getFilters());{const t=e.filters.map(r=>tf(n,r));return me.create(t,"or")}}function rd(n){if(ne(n instanceof Te||n instanceof me),n instanceof Te)return n;const e=n.getFilters();if(1===e.length)return rd(e[0]);if(oa(n))return n;const t=e.map(i=>rd(i)),r=[];return t.forEach(i=>{i instanceof Te?r.push(i):i instanceof me&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:me.create(r,n.op)}class Ry{constructor(){this.on=new nf}addToCollectionParentIndex(e,t){return this.on.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(Wt.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(Wt.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}}class nf{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new be(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new be(Ae.comparator)).toArray()}}const id=new Uint8Array(0);class Py{constructor(e,t){this.user=e,this.databaseId=t,this._n=new nf,this.an=new ut(r=>Mt(r),(r,i)=>rr(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:mt(i)};return jm(e).put(s)}return S.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[wu(t),""],!1,!0);return jm(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Un(a.parent))}return r})}addFieldIndex(e,t){const r=Il(e),i={indexId:(h=t).indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])};var h;delete i.indexId;const s=r.add(i);if(t.indexState){const a=_a(e);return s.next(h=>{a.put(Lm(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Il(e),i=_a(e),s=ga(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Il(e),r=ga(e),i=_a(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return S.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new Gm(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=ga(e);let i=!0;const s=new Map;return S.forEach(this.un(t),a=>this.cn(e,a).next(h=>{i&&(i=!!h),s.set(a,h)})).next(()=>{if(i){let a=pe();const h=[];return S.forEach(s,(f,m)=>{var K;U("IndexedDbIndexManager",`Using index ${K=f,`id=${K.indexId}|cg=${K.collectionGroup}|f=${K.fields.map(ce=>`${ce.fieldPath}:${ce.kind}`).join(",")}`} to execute ${Mt(t)}`);const g=function(K,ce){const _e=Vc(ce);if(void 0===_e)return null;for(const De of Us(K,_e.fieldPath))switch(De.op){case"array-contains-any":return De.value.arrayValue.values||[];case"array-contains":return[De.value]}return null}(m,f),y=function(K,ce){const _e=new Map;for(const De of Jn(ce))for(const ht of Us(K,De.fieldPath))switch(ht.op){case"==":case"in":_e.set(De.fieldPath.canonicalString(),ht.value);break;case"not-in":case"!=":return _e.set(De.fieldPath.canonicalString(),ht.value),Array.from(_e.values())}return null}(m,f),w=function(K,ce){const _e=[];let De=!0;for(const ht of Jn(ce)){const jn=0===ht.kind?ju(K,ht.fieldPath,K.startAt):aa(K,ht.fieldPath,K.startAt);_e.push(jn.value),De&&(De=jn.inclusive)}return new nr(_e,De)}(m,f),R=function(K,ce){const _e=[];let De=!0;for(const ht of Jn(ce)){const jn=0===ht.kind?aa(K,ht.fieldPath,K.endAt):ju(K,ht.fieldPath,K.endAt);_e.push(jn.value),De&&(De=jn.inclusive)}return new nr(_e,De)}(m,f),z=this.ln(f,m,w),q=this.ln(f,m,R),G=this.hn(f,m,y),se=this.Pn(f.indexId,g,z,w.inclusive,q,R.inclusive,G);return S.forEach(se,oe=>r.j(oe,t.limit).next(K=>{K.forEach(ce=>{const _e=$.fromSegments(ce.documentKey);a.has(_e)||(a=a.add(_e),h.push(_e))})}))}).next(()=>h)}return S.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:Sy(me.create(e.filters,"and")).map(r=>rl(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,h){const f=(null!=t?t.length:1)*Math.max(r.length,s.length),m=f/(null!=t?t.length:1),g=[];for(let y=0;y<f;++y){const w=t?this.In(t[y/m]):id,R=this.Tn(e,w,r[y%m],i),z=this.En(e,w,s[y%m],a),q=h.map(G=>this.Tn(e,w,G,!0));g.push(...this.createRange(R,z,q))}return g}Tn(e,t,r,i){const s=new js(e,$.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new js(e,$.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new Gm(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const h of s)r.en(h)&&(!a||h.fields.length>a.fields.length)&&(a=h);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return S.forEach(i,s=>this.cn(e,s).next(a=>{a?0!==r&&a.fields.length<function(f){let m=new be(Ue.comparator),g=!1;for(const y of f.filters)for(const w of y.getFlattenedFilters())w.field.isKeyField()||("array-contains"===w.op||"array-contains-any"===w.op?g=!0:m=m.add(w.field));for(const y of f.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(g?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}dn(e,t){const r=new vl;for(const i of Jn(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const a=r.jt(i.kind);Ws.St.ht(s,a)}return r.Ut()}In(e){const t=new vl;return Ws.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new vl;return Ws.St.ht(ei(this.databaseId,t),r.jt(function(s){const a=Jn(s);return 0===a.length?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(null===r)return[];let i=[];i.push(new vl);let s=0;for(const a of Jn(e)){const h=r[s++];for(const f of i)if(this.Rn(t,a.fieldPath)&&Ns(h))i=this.Vn(i,a,h);else{const m=f.jt(a.kind);Ws.St.ht(h,m)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const h of i){const f=new vl;f.seed(h.Ut()),Ws.St.ht(a,f.jt(t.kind)),s.push(f)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof Te&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Il(e),i=_a(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return S.forEach(s,h=>i.get([h.indexId,this.uid]).next(f=>{a.push(function(g,y){const w=y?new vr(y.sequenceNumber,new Wt(qs(y.readTime),new $(Un(y.documentKey)),y.largestBatchId)):vr.empty(),R=g.fields.map(([z,q])=>new Xn(Ue.fromServerFormat(z),q));return new yr(g.indexId,g.collectionGroup,R,w)}(h,f))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:le(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Il(e),s=_a(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>S.forEach(h,f=>s.put(Lm(f.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return S.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?S.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),S.forEach(h,f=>this.gn(e,i,f).next(m=>{const g=this.pn(s,f);return m.isEqual(g)?S.resolve():this.yn(e,s,f,m,g)}))))})}wn(e,t,r,i){return ga(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return ga(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=ga(e);let s=new be(Fi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,h)=>{s=s.add(new js(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>s)}pn(e,t){let r=new be(Fi);const i=this.dn(t,e);if(null==i)return r;const s=Vc(t);if(null!=s){const a=e.data.field(s.fieldPath);if(Ns(a))for(const h of a.arrayValue.values||[])r=r.add(new js(t.indexId,e.key,this.In(h),i))}else r=r.add(new js(t.indexId,e.key,id,i));return r}yn(e,t,r,i,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(f,m,g,y,w){const R=f.getIterator(),z=m.getIterator();let q=xi(R),G=xi(z);for(;q||G;){let se=!1,oe=!1;if(q&&G){const K=g(q,G);K<0?oe=!0:K>0&&(se=!0)}else null!=q?oe=!0:se=!0;se?(y(G),G=xi(z)):oe?(w(q),q=xi(R)):(q=xi(R),G=xi(z))}}(i,s,Fi,h=>{a.push(this.wn(e,t,r,h))},h=>{a.push(this.Sn(e,t,r,h))}),S.waitFor(a)}fn(e){let t=1;return _a(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,h)=>Fi(a,h)).filter((a,h,f)=>!h||0!==Fi(a,f[h-1]));const i=[];i.push(e);for(const a of r){const h=Fi(a,e),f=Fi(a,t);if(0===h)i[0]=e.Ht();else if(h>0&&f<0)i.push(a),i.push(a.Ht());else if(f>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];s.push(IDBKeyRange.bound([i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,id,[]],[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,id,[]]))}return s}bn(e,t){return Fi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next($m)}getMinOffset(e,t){return S.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||Y())).next($m)}}function jm(n){return gt(n,"collectionParents")}function ga(n){return gt(n,"indexEntries")}function Il(n){return gt(n,"indexConfiguration")}function _a(n){return gt(n,"indexState")}function $m(n){ne(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Ho(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Wt(e.readTime,e.documentKey,t)}const Hm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class $t{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new $t(e,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Km(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let h=0;const f=r.Y({range:a},(g,y,w)=>(h++,w.delete()));s.push(f.next(()=>{ne(1===h)}));const m=[];for(const g of t.mutations){const y=Bc(e,g.key.path,t.batchId);s.push(i.delete(y)),m.push(g.key)}return S.waitFor(s).next(()=>m)}function sd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y();e=n.noDocument}return JSON.stringify(e).length}$t.DEFAULT_COLLECTION_PERCENTILE=10,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$t.DEFAULT=new $t(41943040,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$t.DISABLED=new $t(-1,0,0);class od{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){ne(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new od(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ui(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=ya(e),a=Ui(e);return a.add({}).next(h=>{ne("number"==typeof h);const f=new zh(h,t,r,i),m=function(R,z,q){const G=q.baseMutations.map(oe=>gl(R.ut,oe)),se=q.mutations.map(oe=>gl(R.ut,oe));return{userId:z,batchId:q.batchId,localWriteTimeMs:q.localWriteTime.toMillis(),baseMutations:G,mutations:se}}(this.serializer,this.userId,f),g=[];let y=new be((w,R)=>le(w.canonicalString(),R.canonicalString()));for(const w of i){const R=Bc(this.userId,w.key.path,h);y=y.add(w.key.path.popLast()),g.push(a.put(m)),g.push(s.put(R,bh))}return y.forEach(w=>{g.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Dn[h]=f.keys()}),S.waitFor(g).next(()=>f)})}lookupMutationBatch(e,t){return Ui(e).get(t).next(r=>r?(ne(r.userId===this.userId),Zs(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?S.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ui(e).Y({index:"userMutationsIndex",range:i},(a,h,f)=>{h.userId===this.userId&&(ne(h.batchId>=r),s=Zs(this.serializer,h)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ui(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ui(e).W("userMutationsIndex",t).next(r=>r.map(i=>Zs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Qo(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return ya(e).Y({range:i},(a,h,f)=>{const[m,g,y]=a,w=Un(g);if(m===this.userId&&t.path.isEqual(w))return Ui(e).get(y).next(R=>{if(!R)throw Y();ne(R.userId===this.userId),s.push(Zs(this.serializer,R))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(le);const i=[];return t.forEach(s=>{const a=Qo(this.userId,s.path),h=IDBKeyRange.lowerBound(a),f=ya(e).Y({range:h},(m,g,y)=>{const[w,R,z]=m,q=Un(R);w===this.userId&&s.path.isEqual(q)?r=r.add(z):y.done()});i.push(f)}),S.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Qo(this.userId,r),a=IDBKeyRange.lowerBound(s);let h=new be(le);return ya(e).Y({range:a},(f,m,g)=>{const[y,w,R]=f,z=Un(w);y===this.userId&&r.isPrefixOf(z)?z.length===i&&(h=h.add(R)):g.done()}).next(()=>this.vn(e,h))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Ui(e).get(s).next(a=>{if(null===a)throw Y();ne(a.userId===this.userId),r.push(Zs(this.serializer,a))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Km(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return ya(e).Y({range:r},(s,a,h)=>{if(s[0]===this.userId){const f=Un(s[1]);i.push(f)}else h.done()}).next(()=>{ne(0===i.length)})})}containsKey(e,t){return Qm(e,this.userId,t)}Mn(e){return Ym(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Qm(n,e,t){const r=Qo(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return ya(n).Y({range:s,J:!0},(h,f,m)=>{const[g,y,w]=h;g===e&&y===i&&(a=!0),m.done()}).next(()=>a)}function Ui(n){return gt(n,"mutations")}function ya(n){return gt(n,"documentMutations")}function Ym(n){return gt(n,"mutationQueues")}class $s{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new $s(0)}static Nn(){return new $s(-1)}}class xy{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new $s(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>re.fromTimestamp(new Ze(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>va(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(ne(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return va(e).Y((a,h)=>{const f=_l(h);f.sequenceNumber<=t&&null===r.get(f.targetId)&&(i++,s.push(this.removeTargetData(e,f)))}).next(()=>S.waitFor(s)).next(()=>i)}forEachTarget(e,t){return va(e).Y((r,i)=>{const s=_l(i);t(s)})}Bn(e){return Jm(e).get("targetGlobalKey").next(t=>(ne(null!==t),t))}Ln(e,t){return Jm(e).put("targetGlobalKey",t)}kn(e,t){return va(e).put(Vm(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Mt(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return va(e).Y({range:i,index:"queryTargetsIndex"},(a,h,f)=>{const m=_l(h);rr(t,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Bi(e);return t.forEach(a=>{const h=mt(a.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,a))}),S.waitFor(i)}removeMatchingKeys(e,t,r){const i=Bi(e);return S.forEach(t,s=>{const a=mt(s.path);return S.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Bi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Bi(e);let s=pe();return i.Y({range:r,J:!0},(a,h,f)=>{const m=Un(a[1]),g=new $(m);s=s.add(g)}).next(()=>s)}containsKey(e,t){const r=mt(t.path),i=IDBKeyRange.bound([r],[wu(r)],!1,!0);let s=0;return Bi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,h],f,m)=>{0!==a&&(s++,m.done())}).next(()=>s>0)}_t(e,t){return va(e).get(t).next(r=>r?_l(r):null)}}function va(n){return gt(n,"targets")}function Jm(n){return gt(n,"targetGlobal")}function Bi(n){return gt(n,"targetDocuments")}function Xm([n,e],[t,r]){const i=le(n,t);return 0===i?le(e,r):i}class Dy{constructor(e){this.Qn=e,this.buffer=new be(Xm),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Xm(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eg{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,I.Z)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){er(r)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Ln(r)}yield t.Gn(3e5)}))}}class ky{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return S.resolve(nn._e);const r=new Dy(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(Hm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hm):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,h,f,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,a=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,h=Date.now(),this.removeTargets(e,r,t))).next(y=>(s=y,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(m=Date.now(),fn()<=L.in.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-g}ms\n\tDetermined least recently used ${i} in `+(h-a)+`ms\n\tRemoved ${s} targets in `+(f-h)+`ms\n\tRemoved ${y} documents in `+(m-f)+`ms\nTotal Duration: ${m-g}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}}class Oy{constructor(e,t){this.db=e,this.garbageCollector=function tg(n,e){return new ky(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return ad(e,r)}removeReference(e,t,r){return ad(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ad(e,t)}Xn(e,t){return function(i,s){let a=!1;return Ym(i).Z(h=>Qm(i,h,s).next(f=>(f&&(a=!0),S.resolve(!f)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,h)=>{if(h<=t){const f=this.Xn(e,a).next(m=>{if(!m)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,re.min()),Bi(e).delete([0,mt(a.path)])))});i.push(f)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ad(e,t)}Zn(e,t){const r=Bi(e);let i,s=nn._e;return r.Y({index:"documentTargetsIndex"},([a,h],{path:f,sequenceNumber:m})=>{0===a?(s!==nn._e&&t(new $(Un(i)),s),s=m,i=f):s=nn._e}).next(()=>{s!==nn._e&&t(new $(Un(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ad(n,e){return Bi(n).put((i=n.currentSequenceNumber,{targetId:0,path:mt(e.path),sequenceNumber:i}));var i}class ng{constructor(){this.changes=new ut(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ny{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Hs(e).put(r)}removeEntry(e,t,r){return Hs(e).delete(function(s,a){const h=s.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],td(a),h[h.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=Be.newInvalidDocument(t);return Hs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Tl(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:Be.newInvalidDocument(t)};return Hs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Tl(t))},(i,s)=>{r={document:this.tr(t,s),size:sd(s)}}).next(()=>r)}getEntries(e,t){let r=Lt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=Lt(),i=new Ve($.comparator);return this.rr(e,t,(s,a)=>{const h=this.tr(s,a);r=r.insert(s,h),i=i.insert(s,sd(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return S.resolve();let i=new be(og);t.forEach(f=>i=i.add(f));const s=IDBKeyRange.bound(Tl(i.first()),Tl(i.last())),a=i.getIterator();let h=a.getNext();return Hs(e).Y({index:"documentKeyIndex",range:s},(f,m,g)=>{const y=$.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&og(h,y)<0;)r(h,null),h=a.getNext();h&&h.isEqual(y)&&(r(h,m),h=a.hasNext()?a.getNext():null),h?g.U(Tl(h)):g.done()}).next(()=>{for(;h;)r(h,null),h=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,h=[a.popLast().toArray(),a.lastSegment(),td(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hs(e).W(IDBKeyRange.bound(h,f,!0)).next(m=>{s?.incrementDocumentReadCount(m.length);let g=Lt();for(const y of m){const w=this.tr($.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);w.isFoundDocument()&&(j(t,w)||i.has(w.key))&&(g=g.insert(w.key,w))}return g})}getAllFromCollectionGroup(e,t,r,i){let s=Lt();const a=sg(t,r),h=sg(t,Wt.max());return Hs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,h,!0)},(f,m,g)=>{const y=this.tr($.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(y.key,y),s.size===i&&g.done()}).next(()=>s)}newChangeBuffer(e){return new Vy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ig(e).get("remoteDocumentGlobalKey").next(t=>(ne(!!t),t))}er(e,t){return ig(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=function Ty(n,e){let t;if(e.document)t=Sm(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=$.fromSegments(e.noDocument.path),i=qs(e.noDocument.readTime);t=Be.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{const r=$.fromSegments(e.unknownDocument.path),i=qs(e.unknownDocument.version);t=Be.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ze(i[0],i[1]);return re.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(re.min()))return r}return Be.newInvalidDocument(e)}}function rg(n){return new Ny(n)}class Vy extends ng{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new ut(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new be((s,a)=>le(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const h=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,h.readTime)),a.isValidDocument()){const f=Nm(this._r.serializer,a);i=i.add(s.path.popLast());const m=sd(f);r+=m-h.size,t.push(this._r.addEntry(e,s,f))}else if(r-=h.size,this.trackRemovals){const f=Nm(this._r.serializer,a.convertToNoDocument(re.min()));t.push(this._r.addEntry(e,s,f))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function ig(n){return gt(n,"remoteDocumentGlobal")}function Hs(n){return gt(n,"remoteDocumentsV14")}function Tl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function sg(n,e){const t=e.documentKey.path.toArray();return[n,td(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function og(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=le(t[s],r[s]),i)return i;return i=le(t.length,r.length),i||(i=le(t[t.length-2],r[r.length-2]),i||le(t[t.length-1],r[r.length-1]))}class My{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ag{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&ul(r.mutation,i,Rt.empty(),Ze.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){const i=pn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Vi();return s.forEach((h,f)=>{a=a.insert(h,f.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=pn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,h)=>{t.set(a,h)})})}computeViews(e,t,r,i){let s=Lt();const a=Mi(),h=Mi();return t.forEach((f,m)=>{const g=r.get(m.key);i.has(m.key)&&(void 0===g||g.mutation instanceof ti)?s=s.insert(m.key,m):void 0!==g?(a.set(m.key,g.mutation.getFieldMask()),ul(g.mutation,m,g.mutation.getFieldMask(),Ze.now())):a.set(m.key,Rt.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,g)=>a.set(m,g)),t.forEach((m,g)=>{var y;return h.set(m,new My(g,null!==(y=a.get(m))&&void 0!==y?y:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Mi();let i=new Ve((a,h)=>a-h),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const h of a)h.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let g=r.get(f)||Rt.empty();g=h.applyToLocalView(m,g),r.set(f,g);const y=(i.get(h.batchId)||pe()).add(f);i=i.insert(h.batchId,y)})}).next(()=>{const a=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,g=f.value,y=sl();g.forEach(w=>{if(!s.has(w)){const R=am(t.get(w),r.get(w));null!==R&&y.set(w,R),s=s.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,y))}return S.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return $.isDocumentKey((a=t).path)&&null===a.collectionGroup&&0===a.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):l(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var a}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):S.resolve(pn());let h=-1,f=s;return a.next(m=>S.forEach(m,(g,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),s.get(g)?S.resolve():this.remoteDocumentCache.getEntry(e,g).next(w=>{f=f.insert(g,w)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,pe())).next(g=>({batchId:h,changes:il(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=Vi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Vi();return this.indexManager.getCollectionParents(e,s).next(h=>S.forEach(h,f=>{const m=(y=t,w=f.child(s),new ir(w,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt));var y,w;return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(g=>{g.forEach((y,w)=>{a=a.insert(y,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((f,m)=>{const g=m.getKey();null===a.get(g)&&(a=a.insert(g,Be.newInvalidDocument(g)))});let h=Vi();return a.forEach((f,m)=>{const g=s.get(f);void 0!==g&&ul(g.mutation,m,Rt.empty(),Ze.now()),j(t,m)&&(h=h.insert(f,m))}),h})}}class Ly{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return S.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:dt(i.createTime)}),S.resolve();var i}getNamedQuery(e,t){return S.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:Qh(i.bundledQuery),readTime:dt(i.readTime)}),S.resolve();var i}}class Fy{constructor(){this.overlays=new Ve($.comparator),this.lr=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){const r=pn();return S.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),S.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){const i=pn(),s=t.length+1,a=new $(t.child("")),h=this.overlays.getIteratorFrom(a);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>r&&i.set(f.getKey(),f)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ve((m,g)=>m-g);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=s.get(m.largestBatchId);null===g&&(g=pn(),s=s.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const h=pn(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,g)=>h.set(m,g)),!(h.size()>=i)););return S.resolve(h)}lt(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new qh(t,r));let s=this.lr.get(t);void 0===s&&(s=pe(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class rf{constructor(){this.hr=new be(Pt.Pr),this.Ir=new be(Pt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new Pt(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new Pt(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new $(new Ae([])),r=new Pt(t,e),i=new Pt(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new $(new Ae([])),r=new Pt(t,e),i=new Pt(t,e+1);let s=pe();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Pt(e,0),r=this.hr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Pt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return $.comparator(e.key,t.key)||le(e.gr,t.gr)}static Tr(e,t){return le(e.gr,t.gr)||$.comparator(e.key,t.key)}}class Uy{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new be(Pt.Pr)}checkEmpty(e){return S.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++;const a=new zh(s,t,r,i);this.mutationQueue.push(a);for(const h of i)this.yr=this.yr.add(new Pt(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return S.resolve(a)}lookupMutationBatch(e,t){return S.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),s=i<0?0:i;return S.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Pt(t,0),i=new Pt(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const h=this.wr(a.gr);s.push(h)}),S.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(le);return t.forEach(i=>{const s=new Pt(i,0),a=new Pt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],h=>{r=r.add(h.gr)})}),S.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;$.isDocumentKey(s)||(s=s.child(""));const a=new Pt(new $(s),0);let h=new be(le);return this.yr.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.gr)),!0)},a),S.resolve(this.br(h))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){ne(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return S.forEach(t.mutations,i=>{const s=new Pt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new Pt(t,0),i=this.yr.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return S.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class By{constructor(e){this.Cr=e,this.docs=new Ve($.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(t))}getEntries(e,t){let r=Lt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Be.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Lt();const a=t.path,h=new $(a.child("")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:g}}=f.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||Ho(Mc(g),r)<=0||(i.has(g.key)||j(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return S.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y()}vr(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new zy(this)}getSize(e){return S.resolve(this.size)}}class zy extends ng{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class Gy{constructor(e){this.persistence=e,this.Fr=new ut(t=>Mt(t),rr),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Mr=0,this.Or=new rf,this.targetCount=0,this.Nr=$s.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),S.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new $s(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.kn(t),S.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),S.waitFor(s).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),S.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),S.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.Or.containsKey(t))}}class sf{constructor(e,t){this.Br={},this.overlays={},this.Lr=new nn(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Gy(this),this.indexManager=new Ry,this.remoteDocumentCache=new By(r=>this.referenceDelegate.Qr(r)),this.serializer=new Om(t),this.Kr=new Ly(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Uy(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const i=new qy(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return S.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class qy extends Lc{constructor(e){super(),this.currentSequenceNumber=e}}class cd{constructor(e){this.persistence=e,this.Gr=new rf,this.zr=null}static jr(e){return new cd(e)}get Hr(){if(this.zr)return this.zr;throw Y()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),S.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Hr,r=>{const i=$.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,re.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return S.or([()=>S.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class Zy{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Ko("createOrUpgrade",t);var f;r<1&&i>=1&&(e.createObjectStore("owner"),(f=e).createObjectStore("mutationQueues",{keyPath:"userId"}),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xu,{unique:!0}),f.createObjectStore("documentMutations"),cg(e),function(f){f.createObjectStore("remoteDocuments")}(e));let a=S.resolve();return r<3&&i>=3&&(0!==r&&(function(f){f.deleteObjectStore("targetDocuments"),f.deleteObjectStore("targets"),f.deleteObjectStore("targetGlobal")}(e),cg(e)),a=a.next(()=>function(f){const m=f.store("targetGlobal"),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",g)}(s))),r<4&&i>=4&&(0!==r&&(a=a.next(()=>function(f,m){return m.store("mutations").W().next(g=>{f.deleteObjectStore("mutations"),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xu,{unique:!0});const y=m.store("mutations"),w=g.map(R=>y.put(R));return S.waitFor(w)})}(e,s))),a=a.next(()=>{!function(f){f.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(f){f.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{!function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(f){f.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(f){f.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{!function(f){const m=f.createObjectStore("documentOverlays",{keyPath:Zc});m.createIndex("collectionPathOverlayIndex",Oh,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",Jp,{unique:!1})}(e)})),r<13&&i>=13&&(a=a.next(()=>function(f){const m=f.createObjectStore("remoteDocumentsV14",{keyPath:Ch});m.createIndex("documentKeyIndex",Sh),m.createIndex("collectionGroupIndex",Rh)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(f){f.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),f.createObjectStore("indexState",{keyPath:qc}).createIndex("sequenceNumberIndex",Dh,{unique:!1}),f.createObjectStore("indexEntries",{keyPath:Du}).createIndex("documentKeyIndex",kh,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=sd(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>S.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(h=>S.forEach(h,f=>{ne(f.userId===s.userId);const m=Zs(this.serializer,f);return Km(e,s.userId,m).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,h)=>{const f=new Ae(a),m=[0,mt(f)];s.push(t.get(m).next(g=>g?S.resolve():t.put({targetId:0,path:mt(f),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>S.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:xh});const r=t.store("collectionParents"),i=new nf,s=a=>{if(i.add(a)){const h=a.lastSegment(),f=a.popLast();return r.put({collectionId:h,parent:mt(f)})}};return t.store("remoteDocuments").Y({J:!0},(a,h)=>{const f=new Ae(a);return s(f.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,h,f],m)=>{const g=Un(h);return s(g.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=_l(i),a=Vm(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const h=t.store("remoteDocumentsV14"),f=(y=a,y.document?new $(Ae.fromString(y.document.name).popFirst(5)):y.noDocument?$.fromSegments(y.noDocument.path):y.unknownDocument?$.fromSegments(y.unknownDocument.path):Y()).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};var y;i.push(h.put(m))}).next(()=>S.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=rg(this.serializer),s=new sf(cd.jr,this.serializer.ut);return r.W().next(a=>{const h=new Map;return a.forEach(f=>{var m;let g=null!==(m=h.get(f.userId))&&void 0!==m?m:pe();Zs(this.serializer,f).keys().forEach(y=>g=g.add(y)),h.set(f.userId,g)}),S.forEach(h,(f,m)=>{const g=new pt(m),y=nd.ct(this.serializer,g),w=s.getIndexManager(g),R=od.ct(g,this.serializer,w,s.referenceDelegate);return new ag(i,R,y,w).recalculateAndSaveOverlaysForDocumentKeys(new jc(t,nn._e),f).next()})})}}function cg(n){n.createObjectStore("targetDocuments",{keyPath:zc}).createIndex("documentTargetsIndex",Gc,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ph,{unique:!0}),n.createObjectStore("targetGlobal")}const of="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class af{constructor(e,t,r,i,s,a,h,f,m,g,y=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=h,this.oi=m,this._i=g,this.ai=y,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=w=>Promise.resolve(),!af.D())throw new V(D.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Oy(this,i),this.Ii=t+"main",this.serializer=new Om(f),this.Ti=new tn(this.Ii,this.ai,new Zy(this.serializer)),this.qr=new xy(this.referenceDelegate,this.serializer),this.remoteDocumentCache=rg(this.serializer),this.Kr=new Ey,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===g&&tt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new V(D.FAILED_PRECONDITION,of);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new nn(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var r=(0,I.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,I.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,I.Z)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ud(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(er(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return El(e).get("owner").next(t=>S.resolve(this.wi(t)))}Si(e){return ud(e).delete(this.clientId)}bi(){var e=this;return(0,I.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=gt(r,"clientMetadata");return i.W().next(s=>{const a=e.Ci(s,18e5),h=s.filter(f=>-1===a.indexOf(f));return S.forEach(h,f=>i.delete(f.clientId)).next(()=>h)})}).catch(()=>[]);if(e.Ei)for(const r of t)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?S.resolve(!0):El(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new V(D.FAILED_PRECONDITION,of);return!1}}return!(!this.networkEnabled||!this.inForeground)||ud(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,I.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new jc(t,nn._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>ud(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return od.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Py(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return nd.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(f=this.ai)?Ou:14===f?Wc:13===f?xs:12===f?ku:11===f?Yo:void Y();var f;let a;return this.Ti.runTransaction(e,i,s,h=>(a=new jc(h,this.Lr?this.Lr.next():nn._e),"readwrite-primary"===t?this.fi(a).next(f=>!!f||this.gi(a)).next(f=>{if(!f)throw tt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new V(D.FAILED_PRECONDITION,Cu);return r(a)}).next(f=>this.yi(a).next(()=>f)):this.Li(a).next(()=>r(a)))).then(h=>(a.raiseOnCommittedEvent(),h))}Li(e){return El(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new V(D.FAILED_PRECONDITION,of)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return El(e).put("owner",t)}static D(){return tn.D()}pi(e){const t=El(e);return t.get("owner").next(r=>this.wi(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):S.resolve())}Di(e,t){const r=Date.now();return!(e<r-t||e>r&&(tt(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,Z.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){tt("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function El(n){return gt(n,"owner")}function ud(n){return gt(n,"clientMetadata")}function cf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class lf{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=pe(),i=pe();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new lf(e,t.fromCache,r,i)}}class Wy{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class lg{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new Wy;return this.Hi(e,t,a).next(h=>{if(s.result=h,this.$i)return this.Ji(e,t,a,h.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(fn()<=L.in.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",O(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),S.resolve()):(fn()<=L.in.DEBUG&&U("QueryEngine","Query:",O(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(fn()<=L.in.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",O(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,c(t))):S.resolve())}zi(e,t){if(Hu(t))return S.resolve(null);let r=c(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=_(t,null,"F"),r=c(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=pe(...s);return this.Gi.getDocuments(e,a).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.Yi(t,h);return this.Zi(t,m,a,f.readTime)?this.zi(e,_(t,null,"F")):this.Xi(e,m,t,f)}))})))}ji(e,t,r,i){return Hu(t)||i.isEqual(re.min())?S.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?S.resolve(null):(fn()<=L.in.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),O(t)),this.Xi(e,a,t,bu(i,-1)).next(h=>h))})}Yi(e,t){let r=new be(X(e));return t.forEach((i,s)=>{j(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return fn()<=L.in.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",O(t)),this.Gi.getDocumentsMatchingQuery(e,t,Wt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class jy{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Ve(le),this.ns=new ut(s=>Mt(s),rr),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ag(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function ug(n,e,t,r){return new jy(n,e,t,r)}function dg(n,e){return uf.apply(this,arguments)}function uf(){return uf=(0,I.Z)(function*(n,e){const t=W(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],h=[];let f=pe();for(const m of i){a.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}for(const m of s){h.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(r,f).next(m=>({_s:m,removedBatchIds:a,addedBatchIds:h}))})})}),uf.apply(this,arguments)}function hg(n){const e=W(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function fg(n,e,t){let r=pe(),i=pe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Lt();return t.forEach((h,f)=>{const m=s.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(re.min())?(e.removeEntry(h,f.readTime),a=a.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),a=a.insert(h,f)):U("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{us:a,cs:i}})}function Ky(n,e){const t=W(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ia(n,e){const t=W(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,S.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new ni(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}function Ta(n,e,t){return df.apply(this,arguments)}function df(){return df=(0,I.Z)(function*(n,e,t){const r=W(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!er(a))throw a;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),df.apply(this,arguments)}function dd(n,e,t){const r=W(n);let i=re.min(),s=pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(f,m,g){const y=W(f),w=y.ns.get(g);return void 0!==w?S.resolve(y.ts.get(w)):y.qr.getTargetData(m,g)}(r,a,c(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,h.targetId).next(f=>{s=f})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:re.min(),t?s:pe())).next(h=>(gg(r,J(e),h),{documents:h,ls:s})))}function pg(n,e){const t=W(n),r=W(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function mg(n,e){const t=W(n),r=t.rs.get(e)||re.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,bu(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(gg(t,e,i),i))}function gg(n,e,t){let r=n.rs.get(e)||re.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}function hf(){return hf=(0,I.Z)(function*(n,e,t,r){const i=W(n);let s=pe(),a=Lt();for(const m of t){const g=e.hs(m.metadata.name);m.document&&(s=s.add(g));const y=e.Ps(m);y.setReadTime(e.Is(m.metadata.readTime)),a=a.insert(g,y)}const h=i.ss.newChangeBuffer({trackRemovals:!0}),f=yield Ia(i,(g=r,c(Ni(Ae.fromString(`__bundle__/docs/${g}`)))));var g;return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>fg(m,h,a).next(g=>(h.apply(m),g)).next(g=>i.qr.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.qr.addMatchingKeys(m,s,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,g.us,g.cs)).next(()=>g.us)))}),hf.apply(this,arguments)}function Yy(n,e){return ff.apply(this,arguments)}function ff(){return ff=(0,I.Z)(function*(n,e,t=pe()){const r=yield Ia(n,c(Qh(e.bundledQuery))),i=W(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=dt(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const h=r.withResumeToken(lt.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(h.targetId,h),i.qr.updateTargetData(s,h).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),ff.apply(this,arguments)}function _g(n,e){return`firestore_clients_${n}_${e}`}function yg(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function pf(n,e){return`firestore_targets_${n}_${e}`}class hd{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code,a&&(s=new V(i.error.code,i.error.message))),a?new hd(e,t,i.state,s):(tt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wl{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new V(r.error.code,r.error.message))),s?new wl(e,r.state,i):(tt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=cl();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=Ru(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new fd(e,s):(tt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class mf{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new mf(t.clientId,t.onlineState):(tt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class gf{constructor(){this.activeTargetIds=cl()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _f{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Ve(le),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=_g(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new gf),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,I.Z)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Rs)continue;const s=e.getItem(_g(e.persistenceKey,i));if(s){const a=fd.Ts(i,s);a&&(e.gs=e.gs.insert(a.clientId,a))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(pf(this.persistenceKey,e));if(r){const i=wl.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(pf(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(U("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void tt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,I.Z)(function*(){if(t.started){if(null!==r.key)if(t.Ss.test(r.key)){if(null==r.newValue){const i=t.Ks(r.key);return t.$s(i,null)}{const i=t.Us(r.key,r.newValue);if(i)return t.$s(i.clientId,i)}}else if(t.bs.test(r.key)){if(null!==r.newValue){const i=t.Ws(r.key,r.newValue);if(i)return t.Gs(i)}}else if(t.Ds.test(r.key)){if(null!==r.newValue){const i=t.zs(r.key,r.newValue);if(i)return t.js(i)}}else if(r.key===t.Cs){if(null!==r.newValue){const i=t.Ms(r.newValue);if(i)return t.xs(i)}}else if(r.key===t.ws){const i=function(a){let h=nn._e;if(null!=a)try{const f=JSON.parse(a);ne("number"==typeof f),h=f}catch(f){tt("SharedClientState","Failed to read sequence number from WebStorage",f)}return h}(r.newValue);i!==nn._e&&t.sequenceNumberHandler(i)}else if(r.key===t.vs){const i=t.Hs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new hd(this.currentUser,e,t,r),s=yg(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=yg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,r){const i=pf(this.persistenceKey,e),s=new wl(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return fd.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]);return hd.Ts(new pt(void 0!==r[2]?r[2]:null),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return wl.Ts(i,t)}Ms(e){return mf.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,I.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],h=[];return s.forEach(f=>{i.has(f)||a.push(f)}),i.forEach(f=>{s.has(f)||h.push(f)}),this.syncEngine.Xs(a,h).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=cl();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class vg{constructor(){this.eo=new gf,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new gf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Jy{ro(e){}shutdown(){}}class Ig{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let pd=null;function yf(){return null===pd?pd=268435456+Math.round(2147483648*Math.random()):pd++,"0x"+pd.toString(16)}const Xy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ev{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Ht="WebChannelConnection";class tv extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const h=yf(),f=this.So(t,r);U("RestConnection",`Sending RPC '${t}' ${h}:`,f,i);const m={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(m,s,a),this.Do(t,f,m,i).then(g=>(U("RestConnection",`Received RPC '${t}' ${h}: `,g),g),g=>{throw Zt("RestConnection",`RPC '${t}' ${h} failed with error: `,g,"url: ",f,"request:",i),g})}Co(t,r,i,s,a,h){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+_r,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){return`${this.mo}/v1/${r}:${Xy[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=yf();return new Promise((a,h)=>{const f=new ph;f.setWithCredentials(!0),f.listenOnce(Pc.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Rc.NO_ERROR:const g=f.getResponseJson();U(Ht,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),a(g);break;case Rc.TIMEOUT:U(Ht,`RPC '${e}' ${s} timed out`),h(new V(D.DEADLINE_EXCEEDED,"Request time out"));break;case Rc.HTTP_ERROR:const y=f.getStatus();if(U(Ht,`RPC '${e}' ${s} failed with status:`,y,"response text:",f.getResponseText()),y>0){let w=f.getResponseJson();Array.isArray(w)&&(w=w[0]);const R=w?.error;if(R&&R.status&&R.message){const z=function(G){const se=G.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(se)>=0?se:D.UNKNOWN}(R.status);h(new V(z,R.message))}else h(new V(D.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new V(D.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{U(Ht,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(i);U(Ht,`RPC '${e}' ${s} sending request:`,i),f.send(t,"POST",m,r,15)})}vo(e,t,r){const i=yf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=dh(),h=hh(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.bo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const g=s.join("");U(Ht,`Creating RPC '${e}' stream ${i}: ${g}`,f);const y=a.createWebChannel(g,f);let w=!1,R=!1;const z=new ev({co:G=>{R?U(Ht,`Not sending because RPC '${e}' stream ${i} is closed:`,G):(w||(U(Ht,`Opening RPC '${e}' stream ${i} transport.`),y.open(),w=!0),U(Ht,`RPC '${e}' stream ${i} sending:`,G),y.send(G))},lo:()=>y.close()}),q=(G,se,oe)=>{G.listen(se,K=>{try{oe(K)}catch(ce){setTimeout(()=>{throw ce},0)}})};return q(y,Pi.EventType.OPEN,()=>{R||U(Ht,`RPC '${e}' stream ${i} transport opened.`)}),q(y,Pi.EventType.CLOSE,()=>{R||(R=!0,U(Ht,`RPC '${e}' stream ${i} transport closed`),z.Ro())}),q(y,Pi.EventType.ERROR,G=>{R||(R=!0,Zt(Ht,`RPC '${e}' stream ${i} transport errored:`,G),z.Ro(new V(D.UNAVAILABLE,"The operation could not be completed")))}),q(y,Pi.EventType.MESSAGE,G=>{var se;if(!R){const oe=G.data[0];ne(!!oe);const ce=oe.error||(null===(se=oe[0])||void 0===se?void 0:se.error);if(ce){U(Ht,`RPC '${e}' stream ${i} received error:`,ce);const _e=ce.status;let De=function(DE){const Y_=_t[DE];if(void 0!==Y_)return fm(Y_)}(_e),ht=ce.message;void 0===De&&(De=D.INTERNAL,ht="Unknown error status: "+_e+" with message "+ce.message),R=!0,z.Ro(new V(De,ht)),y.close()}else U(Ht,`RPC '${e}' stream ${i} received:`,oe),z.Vo(oe)}}),q(h,fh.STAT_EVENT,G=>{G.stat===Go.PROXY?U(Ht,`RPC '${e}' stream ${i} detected buffering proxy`):G.stat===Go.NOPROXY&&U(Ht,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{z.Ao()},0),z}}function Tg(){return typeof window<"u"?window:null}function md(){return typeof document<"u"?document:null}function Al(n){return new dy(n,!0)}class vf{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Eg{constructor(e,t,r,i,s,a,h,f){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new vf(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,I.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,I.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var r=this;return(0,I.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(tt(t.toString()),tt("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):t&&t.code===D.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new V(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,I.Z)(function*(){e.state=0,e.start()}))}o_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nv extends Eg{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function py(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:Y(),i=e.targetChange.targetIds||[],s=function(m,g){return m.useProto3Json?(ne(void 0===g||"string"==typeof g),lt.fromBase64String(g||"")):(ne(void 0===g||g instanceof Uint8Array),lt.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,h=a&&function(m){const g=void 0===m.code?D.UNKNOWN:fm(m.code);return new V(g,m.message||"")}(a);t=new ym(r,i,s,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Ar(n,r.document.name),s=dt(r.document.updateTime),a=r.document.createTime?dt(r.document.createTime):re.min(),h=new It({mapValue:{fields:r.document.fields}}),f=Be.newFoundDocument(i,s,a,h);t=new ed(r.targetIds||[],r.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){const r=e.documentDelete,i=Ar(n,r.document),s=r.readTime?dt(r.readTime):re.min(),a=Be.newNoDocument(i,s);t=new ed([],r.removedTargetIds||[],a.key,a)}else if("documentRemove"in e){const r=e.documentRemove,i=Ar(n,r.document);t=new ed([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Y();{const r=e.filter,{count:i=0,unchangedNames:s}=r,a=new sy(i,s);t=new _m(r.targetId,a)}}var m;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?re.min():a.readTime?dt(a.readTime):re.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=ml(this.serializer),t.addTarget=function(s,a){let h;const f=a.target;if(h=Fs(f)?{documents:Rm(s,f)}:{query:Kh(s,f)},h.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){h.resumeToken=Em(s,a.resumeToken);const m=Wh(s,a.expectedCount);null!==m&&(h.expectedCount=m)}else if(a.snapshotVersion.compareTo(re.min())>0){h.readTime=pa(s,a.snapshotVersion.toTimestamp());const m=Wh(s,a.expectedCount);null!==m&&(h.expectedCount=m)}return h}(this.serializer,e);const r=function gy(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=ml(this.serializer),t.removeTarget=e,this.e_(t)}}class rv extends Eg{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function my(n,e){return n&&n.length>0?(ne(void 0!==e),n.map(t=>function(i,s){let a=dt(i.updateTime?i.updateTime:s);return a.isEqual(re.min())&&(a=dt(s)),new ty(a,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=dt(e.commitTime);return this.listener.I_(r,t)}return ne(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=ml(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>gl(this.serializer,r))};this.e_(t)}}class iv extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new V(D.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new V(D.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(D.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class ov{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(tt(t),this.f_=!1):U("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class av{constructor(e,t,r,i,s){var a=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(h=>{r.enqueueAndForget((0,I.Z)(function*(){var f;zi(a)&&(U("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,I.Z)(function*(g){const y=W(g);y.C_.add(4),yield Ea(y),y.M_.set("Unknown"),y.C_.delete(4),yield bl(y)}),function m(g){return f.apply(this,arguments)})(a))}))}),this.M_=new ov(r,i)}}function bl(n){return Tf.apply(this,arguments)}function Tf(){return Tf=(0,I.Z)(function*(n){if(zi(n))for(const e of n.v_)yield e(!0)}),Tf.apply(this,arguments)}function Ea(n){return Ef.apply(this,arguments)}function Ef(){return Ef=(0,I.Z)(function*(n){for(const e of n.v_)yield e(!1)}),Ef.apply(this,arguments)}function gd(n,e){const t=W(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),bf(t)?Af(t):Aa(t).Ho()&&wf(t,e))}function Cl(n,e){const t=W(n),r=Aa(t);t.D_.delete(e),r.Ho()&&wg(t,e),0===t.D_.size&&(r.Ho()?r.Zo():zi(t)&&t.M_.set("Unknown"))}function wf(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Aa(n).u_(e)}function wg(n,e){n.x_.Oe(e),Aa(n).c_(e)}function Af(n){n.x_=new ay({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Aa(n).start(),n.M_.g_()}function bf(n){return zi(n)&&!Aa(n).jo()&&n.D_.size>0}function zi(n){return 0===W(n).C_.size}function Ag(n){n.x_=void 0}function cv(n){return Cf.apply(this,arguments)}function Cf(){return Cf=(0,I.Z)(function*(n){n.D_.forEach((e,t)=>{wf(n,e)})}),Cf.apply(this,arguments)}function lv(n,e){return Sf.apply(this,arguments)}function Sf(){return Sf=(0,I.Z)(function*(n,e){Ag(n),bf(n)?(n.M_.w_(e),Af(n)):n.M_.set("Unknown")}),Sf.apply(this,arguments)}function uv(n,e,t){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,I.Z)(function*(n,e,t){if(n.M_.set("Online"),e instanceof ym&&2===e.state&&e.cause)try{yield(r=(0,I.Z)(function*(s,a){const h=a.cause;for(const f of a.targetIds)s.D_.has(f)&&(yield s.remoteSyncer.rejectListen(f,h),s.D_.delete(f),s.x_.removeTarget(f))}),function i(s,a){return r.apply(this,arguments)})(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield _d(n,r)}else if(e instanceof ed?n.x_.$e(e):e instanceof _m?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(re.min()))try{const r=yield hg(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){const h=s.x_.it(a);return h.targetChanges.forEach((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const g=s.D_.get(m);g&&s.D_.set(m,g.withResumeToken(f.resumeToken,a))}}),h.targetMismatches.forEach((f,m)=>{const g=s.D_.get(f);if(!g)return;s.D_.set(f,g.withResumeToken(lt.EMPTY_BYTE_STRING,g.snapshotVersion)),wg(s,f);const y=new ni(g.target,f,m,g.sequenceNumber);wf(s,y)}),s.remoteSyncer.applyRemoteEvent(h)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield _d(n,r)}var r}),Rf.apply(this,arguments)}function _d(n,e,t){return Pf.apply(this,arguments)}function Pf(){return Pf=(0,I.Z)(function*(n,e,t){if(!er(e))throw e;n.C_.add(1),yield Ea(n),n.M_.set("Offline"),t||(t=()=>hg(n.localStore)),n.asyncQueue.enqueueRetryable((0,I.Z)(function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield bl(n)}))}),Pf.apply(this,arguments)}function bg(n,e){return e().catch(t=>_d(n,t,e))}function wa(n){return xf.apply(this,arguments)}function xf(){return xf=(0,I.Z)(function*(n){const e=W(n),t=Gi(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;dv(e);)try{const i=yield Ky(e.localStore,r);if(null===i){0===e.b_.length&&t.Zo();break}r=i.batchId,hv(e,i)}catch(i){yield _d(e,i)}Cg(e)&&Sg(e)}),xf.apply(this,arguments)}function dv(n){return zi(n)&&n.b_.length<10}function hv(n,e){n.b_.push(e);const t=Gi(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function Cg(n){return zi(n)&&!Gi(n).jo()&&n.b_.length>0}function Sg(n){Gi(n).start()}function fv(n){return Df.apply(this,arguments)}function Df(){return Df=(0,I.Z)(function*(n){Gi(n).E_()}),Df.apply(this,arguments)}function pv(n){return kf.apply(this,arguments)}function kf(){return kf=(0,I.Z)(function*(n){const e=Gi(n);for(const t of n.b_)e.P_(t.mutations)}),kf.apply(this,arguments)}function mv(n,e,t){return Of.apply(this,arguments)}function Of(){return Of=(0,I.Z)(function*(n,e,t){const r=n.b_.shift(),i=Gh.from(r,e,t);yield bg(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield wa(n)}),Of.apply(this,arguments)}function gv(n,e){return Nf.apply(this,arguments)}function Nf(){return Nf=(0,I.Z)(function*(n,e){var t;e&&Gi(n).h_&&(yield(t=(0,I.Z)(function*(i,s){if(hm(h=s.code)&&h!==D.ABORTED){const a=i.b_.shift();Gi(i).Yo(),yield bg(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,s)),yield wa(i)}var h}),function r(i,s){return t.apply(this,arguments)})(n,e)),Cg(n)&&Sg(n)}),Nf.apply(this,arguments)}function Rg(n,e){return Vf.apply(this,arguments)}function Vf(){return Vf=(0,I.Z)(function*(n,e){const t=W(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const r=zi(t);t.C_.add(3),yield Ea(t),r&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield bl(t)}),Vf.apply(this,arguments)}function Mf(n,e){return Lf.apply(this,arguments)}function Lf(){return Lf=(0,I.Z)(function*(n,e){const t=W(n);e?(t.C_.delete(2),yield bl(t)):e||(t.C_.add(2),yield Ea(t),t.M_.set("Unknown"))}),Lf.apply(this,arguments)}function Aa(n){return n.O_||(n.O_=function(t,r,i){const s=W(t);return s.A_(),new nv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:cv.bind(null,n),Io:lv.bind(null,n),a_:uv.bind(null,n)}),n.v_.push(function(){var e=(0,I.Z)(function*(t){t?(n.O_.Yo(),bf(n)?Af(n):n.M_.set("Unknown")):(yield n.O_.stop(),Ag(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function Gi(n){return n.N_||(n.N_=function(t,r,i){const s=W(t);return s.A_(),new rv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:fv.bind(null,n),Io:gv.bind(null,n),T_:pv.bind(null,n),I_:mv.bind(null,n)}),n.v_.push(function(){var e=(0,I.Z)(function*(t){t?(n.N_.Yo(),yield wa(n)):(yield n.N_.stop(),n.b_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class Ff{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,h=new Ff(e,t,a,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new V(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ba(n,e){if(tt("AsyncQueue",`${e}: ${n}`),er(n))return new V(D.UNAVAILABLE,`${e}: ${n}`);throw n}class Ca{constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=Vi(),this.sortedSet=new Ve(this.comparator)}static emptySet(e){return new Ca(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ca)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Ca;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Pg{constructor(){this.B_=new Ve($.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):Y():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Sa{constructor(e,t,r,i,s,a,h,f,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(h=>{a.push({type:0,doc:h})}),new Sa(e,t,Ca.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&T(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class _v{constructor(){this.k_=void 0,this.listeners=[]}}class yv{constructor(){this.queries=new ut(e=>C(e),T),this.onlineState="Unknown",this.q_=new Set}}function Uf(n,e){return Bf.apply(this,arguments)}function Bf(){return Bf=(0,I.Z)(function*(n,e){const t=W(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new _v),i)try{s.k_=yield t.onListen(r)}catch(a){const h=ba(a,`Initialization of query '${O(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&qf(t)}),Bf.apply(this,arguments)}function zf(n,e){return Gf.apply(this,arguments)}function Gf(){return Gf=(0,I.Z)(function*(n,e){const t=W(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),Gf.apply(this,arguments)}function vv(n,e){const t=W(n);let r=!1;for(const i of e){const a=t.queries.get(i.query);if(a){for(const h of a.listeners)h.K_(i)&&(r=!0);a.k_=i}}r&&qf(t)}function Iv(n,e,t){const r=W(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function qf(n){n.q_.forEach(e=>{e.next()})}class Zf{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Sa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Sa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Tv{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class xg{constructor(e){this.serializer=e}hs(e){return Ar(this.serializer,e)}Ps(e){return e.metadata.exists?Sm(this.serializer,e.document,!1):Be.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return dt(e)}}class Ev{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Dg(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=Ae.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new xg(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const h=(t.get(a)||pe()).add(s);t.set(a,h)}}return t}complete(){var e=this;return(0,I.Z)(function*(){const t=yield function Qy(n,e,t,r){return hf.apply(this,arguments)}(e.localStore,new xg(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield Yy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function Dg(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class kg{constructor(e){this.key=e}}class Og{constructor(e){this.key=e}}class Ng{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=pe(),this.mutatedKeys=pe(),this._a=X(e),this.aa=new Ca(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new Pg,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,h=!1;const f="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,m="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,y)=>{const w=i.get(g),R=j(this.query,y)?y:null,z=!!w&&this.mutatedKeys.has(w.key),q=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let G=!1;w&&R?w.data.isEqual(R.data)?z!==q&&(r.track({type:3,doc:R}),G=!0):this.ha(w,R)||(r.track({type:2,doc:R}),G=!0,(f&&this._a(R,f)>0||m&&this._a(R,m)<0)&&(h=!0)):!w&&R?(r.track({type:0,doc:R}),G=!0):w&&!R&&(r.track({type:1,doc:w}),G=!0,(f||m)&&(h=!0)),G&&(R?(a=a.add(R),s=q?s.add(g):s.delete(g)):(a=a.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const g="F"===this.query.limitType?a.last():a.first();a=a.delete(g.key),s=s.delete(g.key),r.track({type:1,doc:g})}return{aa:a,la:r,Zi:h,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((g,y)=>function(R,z){const q=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return q(R)-q(z)}(g.type,y.type)||this._a(g.doc,y.doc)),this.Pa(r),i=null!=i&&i;const h=t&&!i?this.Ia():[],f=0===this.oa.size&&this.current&&!i?1:0,m=f!==this.sa;return this.sa=f,0!==a.length||m?{snapshot:new Sa(this.query,e.aa,s,a,e.mutatedKeys,0===f,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:h}:{Ta:h}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new Pg,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=pe(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new Og(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new kg(r))}),t}da(e){this.ia=e.ls,this.oa=pe();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return Sa.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class wv{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Av{constructor(e){this.key=e,this.Ra=!1}}class bv{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new ut(h=>C(h),T),this.fa=new Map,this.ga=new Set,this.pa=new Ve($.comparator),this.ya=new Map,this.wa=new rf,this.Sa={},this.ba=new Map,this.Da=$s.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Cv(n,e){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,I.Z)(function*(n,e){const t=pp(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=yield Ia(t.localStore,c(e)),h=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=yield jf(t,e,r,"current"===h,a.resumeToken),t.isPrimaryClient&&gd(t.remoteStore,a)}return i}),Wf.apply(this,arguments)}function jf(n,e,t,r,i){return $f.apply(this,arguments)}function $f(){return $f=(0,I.Z)(function*(n,e,t,r,i){n.va=(y,w,R)=>{return(z=(0,I.Z)(function*(G,se,oe,K){let ce=se.view.ca(oe);ce.Zi&&(ce=yield dd(G.localStore,se.query,!1).then(({documents:jn})=>se.view.ca(jn,ce)));const _e=K&&K.targetChanges.get(se.targetId),De=K&&null!=K.targetMismatches.get(se.targetId),ht=se.view.applyChanges(ce,G.isPrimaryClient,_e,De);return rp(G,se.targetId,ht.Ta),ht.snapshot}),function q(G,se,oe,K){return z.apply(this,arguments)})(n,y,w,R);var z};const s=yield dd(n.localStore,e,!0),a=new Ng(e,s.ls),h=a.ca(s.documents),f=fl.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),m=a.applyChanges(h,n.isPrimaryClient,f);rp(n,t,m.Ta);const g=new wv(e,t,a);return n.ma.set(e,g),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),m.snapshot}),$f.apply(this,arguments)}function Sv(n,e){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,I.Z)(function*(n,e){const t=W(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!T(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ta(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Cl(t.remoteStore,r.targetId),Ra(t,r.targetId)}).catch(Ln))):(Ra(t,r.targetId),yield Ta(t.localStore,r.targetId,!0))}),Hf.apply(this,arguments)}function Kf(){return Kf=(0,I.Z)(function*(n,e,t){const r=mp(n);try{const i=yield function(a,h){const f=W(a),m=Ze.now(),g=h.reduce((R,z)=>R.add(z.key),pe());let y,w;return f.persistence.runTransaction("Locally write mutations","readwrite",R=>{let z=Lt(),q=pe();return f.ss.getEntries(R,g).next(G=>{z=G,z.forEach((se,oe)=>{oe.isValidDocument()||(q=q.add(se))})}).next(()=>f.localDocuments.getOverlayedDocuments(R,z)).next(G=>{y=G;const se=[];for(const oe of h){const K=ry(oe,y.get(oe.key).overlayedDocument);null!=K&&se.push(new ti(oe.key,K,zu(K.value.mapValue),Qe.exists(!0)))}return f.mutationQueue.addMutationBatch(R,m,se,h)}).next(G=>{w=G;const se=G.applyToLocalDocumentSet(y,q);return f.documentOverlayCache.saveOverlays(R,G.batchId,se)})}).then(()=>({batchId:w.batchId,changes:il(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,h,f){let m=a.Sa[a.currentUser.toKey()];m||(m=new Ve(le)),m=m.insert(h,f),a.Sa[a.currentUser.toKey()]=m}(r,i.batchId,t),yield ri(r,i.changes),yield wa(r.remoteStore)}catch(i){const s=ba(i,"Failed to persist write");t.reject(s)}}),Kf.apply(this,arguments)}function Vg(n,e){return Qf.apply(this,arguments)}function Qf(){return Qf=(0,I.Z)(function*(n,e){const t=W(n);try{const r=yield function Hy(n,e){const t=W(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const h=[];e.targetChanges.forEach((g,y)=>{const w=i.get(y);if(!w)return;h.push(t.qr.removeMatchingKeys(s,g.removedDocuments,y).next(()=>t.qr.addMatchingKeys(s,g.addedDocuments,y)));let R=w.withSequenceNumber(s.currentSequenceNumber);var q,G,se;null!==e.targetMismatches.get(y)?R=R.withResumeToken(lt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):g.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(g.resumeToken,r)),i=i.insert(y,R),G=R,se=g,(0===(q=w).resumeToken.approximateByteSize()||G.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=3e8||se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0)&&h.push(t.qr.updateTargetData(s,R))});let f=Lt(),m=pe();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),h.push(fg(s,a,e.documentUpdates).next(g=>{f=g.us,m=g.cs})),!r.isEqual(re.min())){const g=t.qr.getLastRemoteSnapshotVersion(s).next(y=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(g)}return S.waitFor(h).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(t.ts=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?ne(a.Ra):i.removedDocuments.size>0&&(ne(a.Ra),a.Ra=!1))}),yield ri(t,r,e)}catch(r){yield Ln(r)}}),Qf.apply(this,arguments)}function Mg(n,e,t){const r=W(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ma.forEach((s,a)=>{const h=a.view.Q_(e);h.snapshot&&i.push(h.snapshot)}),function(a,h){const f=W(a);f.onlineState=h;let m=!1;f.queries.forEach((g,y)=>{for(const w of y.listeners)w.Q_(h)&&(m=!0)}),m&&qf(f)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Pv(n,e,t){return Yf.apply(this,arguments)}function Yf(){return Yf=(0,I.Z)(function*(n,e,t){const r=W(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Ve($.comparator);a=a.insert(s,Be.newNoDocument(s,re.min()));const h=pe().add(s),f=new hl(re.min(),new Map,new Ve(le),a,h);yield Vg(r,f),r.pa=r.pa.remove(s),r.ya.delete(e),ip(r)}else yield Ta(r.localStore,e,!1).then(()=>Ra(r,e,t)).catch(Ln)}),Yf.apply(this,arguments)}function xv(n,e){return Jf.apply(this,arguments)}function Jf(){return Jf=(0,I.Z)(function*(n,e){const t=W(n),r=e.batch.batchId;try{const i=yield function $y(n,e){const t=W(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(h,f,m,g){const y=m.batch,w=y.keys();let R=S.resolve();return w.forEach(z=>{R=R.next(()=>g.getEntry(f,z)).next(q=>{const G=m.docVersions.get(z);ne(null!==G),q.version.compareTo(G)<0&&(y.applyToRemoteDocument(q,m),q.isValidDocument()&&(q.setReadTime(m.commitVersion),g.addEntry(q)))})}),R.next(()=>h.mutationQueue.removeMutationBatch(f,y))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=pe();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);np(t,r,null),tp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ri(t,i)}catch(i){yield Ln(i)}}),Jf.apply(this,arguments)}function Dv(n,e,t){return Xf.apply(this,arguments)}function Xf(){return Xf=(0,I.Z)(function*(n,e,t){const r=W(n);try{const i=yield function(a,h){const f=W(a);return f.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return f.mutationQueue.lookupMutationBatch(m,h).next(y=>(ne(null!==y),g=y.keys(),f.mutationQueue.removeMutationBatch(m,y))).next(()=>f.mutationQueue.performConsistencyCheck(m)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(m,g,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>f.localDocuments.getDocuments(m,g))})}(r.localStore,e);np(r,e,t),tp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ri(r,i)}catch(i){yield Ln(i)}}),Xf.apply(this,arguments)}function ep(){return ep=(0,I.Z)(function*(n,e){const t=W(n);zi(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const h=W(a);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=ba(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),ep.apply(this,arguments)}function tp(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function np(n,e,t){const r=W(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Ra(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||Lg(n,r)})}function Lg(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&(Cl(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),ip(n))}function rp(n,e,t){for(const r of t)r instanceof kg?(n.wa.addReference(r.key,e),Ov(n,r)):r instanceof Og?(U("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||Lg(n,r.key)):Y()}function Ov(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(U("SyncEngine","New document in limbo: "+t),n.ga.add(r),ip(n))}function ip(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new $(Ae.fromString(e)),r=n.Da.next();n.ya.set(r,new Av(t)),n.pa=n.pa.insert(t,r),gd(n.remoteStore,new ni(c(Ni(t.path)),r,"TargetPurposeLimboResolution",nn._e))}}function ri(n,e,t){return sp.apply(this,arguments)}function sp(){return sp=(0,I.Z)(function*(n,e,t){const r=W(n),i=[],s=[],a=[];var h;r.ma.isEmpty()||(r.ma.forEach((h,f)=>{a.push(r.va(f,e,t).then(m=>{if((m||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(f.targetId,m?.fromCache?"not-current":"current"),m){i.push(m);const g=lf.Qi(f.targetId,m);s.push(g)}}))}),yield Promise.all(a),r.Va.a_(i),yield(h=(0,I.Z)(function*(m,g){const y=W(m);try{yield y.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>S.forEach(g,R=>S.forEach(R.ki,z=>y.persistence.referenceDelegate.addReference(w,R.targetId,z)).next(()=>S.forEach(R.qi,z=>y.persistence.referenceDelegate.removeReference(w,R.targetId,z)))))}catch(w){if(!er(w))throw w;U("LocalStore","Failed to update sequence numbers: "+w)}for(const w of g){const R=w.targetId;if(!w.fromCache){const z=y.ts.get(R),G=z.withLastLimboFreeSnapshotVersion(z.snapshotVersion);y.ts=y.ts.insert(R,G)}}}),function f(m,g){return h.apply(this,arguments)})(r.localStore,s))}),sp.apply(this,arguments)}function Nv(n,e){return op.apply(this,arguments)}function op(){return op=(0,I.Z)(function*(n,e){const t=W(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const r=yield dg(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(h=>{h.forEach(f=>{f.reject(new V(D.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ri(t,r._s)}var s}),op.apply(this,arguments)}function Vv(n,e){const t=W(n),r=t.ya.get(e);if(r&&r.Ra)return pe().add(r.key);{let i=pe();const s=t.fa.get(e);if(!s)return i;for(const a of s){const h=t.ma.get(a);i=i.unionWith(h.view.ua)}return i}}function Mv(n,e){return ap.apply(this,arguments)}function ap(){return ap=(0,I.Z)(function*(n,e){const t=W(n),r=yield dd(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&rp(t,e.targetId,i.Ta),i}),ap.apply(this,arguments)}function Lv(n,e){return cp.apply(this,arguments)}function cp(){return cp=(0,I.Z)(function*(n,e){const t=W(n);return mg(t.localStore,e).then(r=>ri(t,r))}),cp.apply(this,arguments)}function Fv(n,e,t,r){return lp.apply(this,arguments)}function lp(){return lp=(0,I.Z)(function*(n,e,t,r){const i=W(n),s=yield function(h,f){const m=W(h),g=W(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",y=>g.Cn(y,f).next(w=>w?m.localDocuments.getDocuments(y,w):S.resolve(null)))}(i.localStore,e);var f;null!==s?("pending"===t?yield wa(i.remoteStore):"acknowledged"===t||"rejected"===t?(np(i,e,r||null),tp(i,e),f=e,W(W(i.localStore).mutationQueue).Fn(f)):Y(),yield ri(i,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)}),lp.apply(this,arguments)}function up(){return up=(0,I.Z)(function*(n,e){const t=W(n);if(pp(t),mp(t),!0===e&&!0!==t.Ca){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Fg(t,r.toArray());t.Ca=!0,yield Mf(t.remoteStore,!0);for(const s of i)gd(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Ra(t,a),Ta(t.localStore,a,!0))),Cl(t.remoteStore,a)}),yield i,yield Fg(t,r),function(a){const h=W(a);h.ya.forEach((f,m)=>{Cl(h.remoteStore,m)}),h.wa.Vr(),h.ya=new Map,h.pa=new Ve($.comparator)}(t),t.Ca=!1,yield Mf(t.remoteStore,!1)}}),up.apply(this,arguments)}function Fg(n,e,t){return dp.apply(this,arguments)}function dp(){return dp=(0,I.Z)(function*(n,e,t){const r=W(n),i=[],s=[];for(const a of e){let h;const f=r.fa.get(a);if(f&&0!==f.length){h=yield Ia(r.localStore,c(f[0]));for(const m of f){const g=r.ma.get(m),y=yield Mv(r,g);y.snapshot&&s.push(y.snapshot)}}else{const m=yield pg(r.localStore,a);h=yield Ia(r.localStore,m),yield jf(r,Ug(m),a,!1,h.resumeToken)}i.push(h)}return r.Va.a_(s),i}),dp.apply(this,arguments)}function Ug(n){return $u(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Bv(n){return t=W(n).localStore,W(W(t).persistence).Bi();var t}function zv(n,e,t,r){return hp.apply(this,arguments)}function hp(){return hp=(0,I.Z)(function*(n,e,t,r){const i=W(n);if(i.Ca)return void U("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=yield mg(i.localStore,J(s[0])),h=hl.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,lt.EMPTY_BYTE_STRING);yield ri(i,a,h);break}case"rejected":yield Ta(i.localStore,e,!0),Ra(i,e,r);break;default:Y()}}),hp.apply(this,arguments)}function Gv(n,e,t){return fp.apply(this,arguments)}function fp(){return fp=(0,I.Z)(function*(n,e,t){const r=pp(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){U("SyncEngine","Adding an already active target "+i);continue}const s=yield pg(r.localStore,i),a=yield Ia(r.localStore,s);yield jf(r,Ug(s),a.targetId,!1,a.resumeToken),gd(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&(yield Ta(r.localStore,i,!1).then(()=>{Cl(r.remoteStore,i),Ra(r,i)}).catch(Ln))}}),fp.apply(this,arguments)}function pp(n){const e=W(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Vv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Pv.bind(null,e),e.Va.a_=vv.bind(null,e.eventManager),e.Va.Fa=Iv.bind(null,e.eventManager),e}function mp(n){const e=W(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Dv.bind(null,e),e}class Sl{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,I.Z)(function*(){t.serializer=Al(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return ug(this.persistence,new lg,e.initialUser,this.serializer)}createPersistence(e){return new sf(cd.jr,this.serializer)}createSharedClientState(e){return new vg}terminate(){var e=this;return(0,I.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class gp extends Sl{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,I.Z)(function*(){yield t().call(r,e),yield r.xa.initialize(r,e),yield mp(r.xa.syncEngine),yield wa(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return ug(this.persistence,new lg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new eg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new wh(t,this.persistence);return new Eh(e.asyncQueue,r)}createPersistence(e){const t=cf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?$t.withCacheSize(this.cacheSizeBytes):$t.DEFAULT;return new af(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Tg(),md(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new vg}}class Bg extends gp{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,I.Z)(function*(){yield t().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof _f&&(r.sharedClientState.syncEngine={Ys:Fv.bind(null,i),Zs:zv.bind(null,i),Xs:Gv.bind(null,i),Bi:Bv.bind(null,i),Js:Lv.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,I.Z)(function*(a){yield function Uv(n,e){return up.apply(this,arguments)}(r.xa.syncEngine,a),r.gcScheduler&&(a&&!r.gcScheduler.started?r.gcScheduler.start():a||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(a&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():a||r.indexBackfillerScheduler.stop())});return function(a){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Tg();if(!_f.D(t))throw new V(D.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=cf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new _f(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Pa{initialize(e,t){var r=this;return(0,I.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Mg(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Nv.bind(null,r.syncEngine),yield Mf(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new yv}createDatastore(e){const t=Al(e.databaseInfo.databaseId),r=new tv(e.databaseInfo);return new iv(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,a=t=>Mg(this.syncEngine,t,0),h=Ig.D()?new Ig:new Jy,new av(r,i,s,a,h);var r,i,s,a,h}createSyncEngine(e,t){return function(i,s,a,h,f,m,g){const y=new bv(i,s,a,h,f,m);return g&&(y.Ca=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,I.Z)(function*(r){const i=W(r);U("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Ea(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function zg(n,e=10240){let t=0;return{read:()=>(0,I.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,I.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class yd{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):tt("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Wv{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new ct,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,I.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,I.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,I.Z)(function*(){const t=yield e.qa();if(null===t)return null;const r=e.La.decode(t),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Tv(JSON.parse(s),t.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,I.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Ka(e){var t=this;return(0,I.Z)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const r=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,I.Z)(function*(){const t=yield e.Ba.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class jv{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,I.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new V(D.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,I.Z)(function*(a,h){const f=W(a),m=ml(f.serializer)+"/documents",g={documents:h.map(z=>pl(f.serializer,z))},y=yield f.Co("BatchGetDocuments",m,g,h.length),w=new Map;y.forEach(z=>{const q=function fy(n,e){return"found"in e?function(r,i){ne(!!i.found);const s=Ar(r,i.found.name),a=dt(i.found.updateTime),h=i.found.createTime?dt(i.found.createTime):re.min(),f=new It({mapValue:{fields:i.found.fields}});return Be.newFoundDocument(s,a,h,f)}(n,e):"missing"in e?function(r,i){ne(!!i.missing),ne(!!i.readTime);const s=Ar(r,i.missing),a=dt(i.readTime);return Be.newNoDocument(s,a)}(n,e):Y()}(f.serializer,z);w.set(q.key.toString(),q)});const R=[];return h.forEach(z=>{const q=w.get(z.toString());ne(!!q),R.push(q)}),R}),function s(a,h){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new fa(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,I.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=$.fromPath(i);e.mutations.push(new Bh(s,e.precondition(s)))}),yield(r=(0,I.Z)(function*(s,a){const h=W(s),f=ml(h.serializer)+"/documents",m={writes:a.map(g=>gl(h.serializer,g))};yield h.wo("Commit",f,m)}),function i(s,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y();t=re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new V(D.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(re.min())?Qe.exists(!1):Qe.updateTime(t):Qe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(re.min()))throw new V(D.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(t)}return Qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class $v{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new vf(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,I.Z)(function*(){const t=new jv(e.datastore),r=e.za(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const t=this.updateFunction(e);return!Rs(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!hm(t)}return!1}}class Hv{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=pt.UNAUTHENTICATED,this.clientId=jo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var a=(0,I.Z)(function*(h){U("FirestoreClient","Received user=",h.uid),yield s.authCredentialListener(h),s.user=h});return function(h){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(r,a=>(U("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}getConfiguration(){var e=this;return(0,I.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(D.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,I.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=ba(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function vd(n,e){return _p.apply(this,arguments)}function _p(){return _p=(0,I.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,I.Z)(function*(s){r.isEqual(s)||(yield dg(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),_p.apply(this,arguments)}function yp(n,e){return vp.apply(this,arguments)}function vp(){return vp=(0,I.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Ip(n);U("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Rg(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Rg(e.remoteStore,s)),n._onlineComponents=e}),vp.apply(this,arguments)}function Gg(n){return"FirebaseError"===n.name?n.code===D.FAILED_PRECONDITION||n.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Ip(n){return Tp.apply(this,arguments)}function Tp(){return Tp=(0,I.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield vd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!Gg(t))throw t;Zt("Error using user provided cache. Falling back to memory cache: "+t),yield vd(n,new Sl)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield vd(n,new Sl);return n._offlineComponents}),Tp.apply(this,arguments)}function Id(n){return Ep.apply(this,arguments)}function Ep(){return Ep=(0,I.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield yp(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield yp(n,new Pa))),n._onlineComponents}),Ep.apply(this,arguments)}function qg(n){return Ip(n).then(e=>e.persistence)}function xa(n){return Ip(n).then(e=>e.localStore)}function Zg(n){return Id(n).then(e=>e.remoteStore)}function wp(n){return Id(n).then(e=>e.syncEngine)}function Da(n){return Ap.apply(this,arguments)}function Ap(){return Ap=(0,I.Z)(function*(n){const e=yield Id(n),t=e.eventManager;return t.onListen=Cv.bind(null,e.syncEngine),t.onUnlisten=Sv.bind(null,e.syncEngine),t}),Ap.apply(this,arguments)}function jg(n,e,t={}){const r=new ct;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function(s,a,h,f,m){const g=new yd({next:w=>{a.enqueueAndForget(()=>zf(s,y));const R=w.docs.has(h);!R&&w.fromCache?m.reject(new V(D.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&w.fromCache&&f&&"server"===f.source?m.reject(new V(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new Zf(Ni(h.path),g,{includeMetadataChanges:!0,J_:!0});return Uf(s,y)}(yield Da(n),n.asyncQueue,e,t,r)})),r.promise}function $g(n,e,t={}){const r=new ct;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function(s,a,h,f,m){const g=new yd({next:w=>{a.enqueueAndForget(()=>zf(s,y)),w.fromCache&&"server"===f.source?m.reject(new V(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new Zf(h,g,{includeMetadataChanges:!0,J_:!0});return Uf(s,y)}(yield Da(n),n.asyncQueue,e,t,r)})),r.promise}function Hg(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const Kg=new Map;function bp(n,e,t){if(!t)throw new V(D.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qg(n,e,t,r){if(!0===e&&!0===r)throw new V(D.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Yg(n){if(!$.isDocumentKey(n))throw new V(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Jg(n){if($.isDocumentKey(n))throw new V(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Td(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":Y()}function we(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Td(n);throw new V(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xg(n,e){if(e<=0)throw new V(D.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class e_{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new V(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new V(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Hg(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new V(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(D.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rl{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new e_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new V(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new e_(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new kc;switch(r.type){case"firstParty":return new yh(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Kg.get(t);r&&(U("ComponentProvider","Removing Datastore"),Kg.delete(t),r.terminate())}(this),Promise.resolve()}}class Ft{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ft(this.firestore,e,this._query)}}class $e{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $e(this.firestore,e,this._key)}}class br extends Ft{constructor(e,t,r){super(e,t,Ni(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $e(this.firestore,null,new $(e))}withConverter(e){return new br(this.firestore,e,this._path)}}function n_(n,e,...t){if(n=(0,Z.m9)(n),bp("collection","path",e),n instanceof Rl){const r=Ae.fromString(e,...t);return Jg(r),new br(n,null,r)}{if(!(n instanceof $e||n instanceof br))throw new V(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return Jg(r),new br(n.firestore,null,r)}}function Ed(n,e,...t){if(n=(0,Z.m9)(n),1===arguments.length&&(e=jo.newId()),bp("doc","path",e),n instanceof Rl){const r=Ae.fromString(e,...t);return Yg(r),new $e(n,null,new $(r))}{if(!(n instanceof $e||n instanceof br))throw new V(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return Yg(r),new $e(n.firestore,n instanceof br?n.converter:null,new $(r))}}function r_(n,e){return n=(0,Z.m9)(n),e=(0,Z.m9)(e),(n instanceof $e||n instanceof br)&&(e instanceof $e||e instanceof br)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Cp(n,e){return n=(0,Z.m9)(n),e=(0,Z.m9)(e),n instanceof Ft&&e instanceof Ft&&n.firestore===e.firestore&&T(n._query,e._query)&&n.converter===e.converter}class a0{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new vf(this,"async_queue_retry"),this.iu=()=>{const t=md();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=md();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=md();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new ct;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,I.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!er(t))throw t;U("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,tt("INTERNAL UNHANDLED ERROR: ",function(a){let h=a.message||"";return a.stack&&(h=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),h}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Ff.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Y()}verifyOperationInProgress(){}uu(){var e=this;return(0,I.Z)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Sp(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class c0{constructor(){this._progressObserver={},this._taskCompletionResolver=new ct,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class We extends Rl{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new a0,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||i_(this),this._firestoreClient.terminate()}}function st(n){return n._firestoreClient||i_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function i_(n){var e,t,r;const i=n._freezeSettings(),s=(f=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Vh(n._databaseId,f,n._persistenceKey,(g=i).host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Hg(g.experimentalLongPollingOptions),g.useFetchStreams));var f,g;n._firestoreClient=new Hv(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function s_(n,e,t){const r=new ct;return n.asyncQueue.enqueue((0,I.Z)(function*(){try{yield vd(n,t),yield yp(n,e),r.resolve()}catch(i){const s=i;if(!Gg(s))throw s;Zt("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function o_(n){if(n._initialized||n._terminated)throw new V(D.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Cr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Cr(lt.fromBase64String(e))}catch(t){throw new V(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Cr(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ii{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new V(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ks{constructor(e){this._methodName=e}}class wd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}}const v0=/^__.*__$/;class I0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new ti(e,this.data,this.fieldMask,t,this.fieldTransforms):new ha(e,this.data,t,this.fieldTransforms)}}class a_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ti(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function c_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}class Ad{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Ad(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Sd(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(c_(this.Iu)&&v0.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class T0{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Al(e)}pu(e,t,r,i=!1){return new Ad({Iu:e,methodName:t,gu:r,path:Ue.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qs(n){const e=n._freezeSettings(),t=Al(n._databaseId);return new T0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bd(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Dp("Data must be an object, but it was:",a,r);const h=d_(r,a);let f,m;if(s.merge)f=new Rt(a.fieldMask),m=a.fieldTransforms;else if(s.mergeFields){const g=[];for(const y of s.mergeFields){const w=Dl(e,y,t);if(!a.contains(w))throw new V(D.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);f_(g,w)||g.push(w)}f=new Rt(g),m=a.fieldTransforms.filter(y=>f.covers(y.field))}else f=null,m=a.fieldTransforms;return new I0(new It(h),f,m)}class xl extends Ks{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xl}}function l_(n,e,t){return new Ad({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Rp extends Ks{_toFieldTransform(e){return new ll(e.path,new ua)}isEqual(e){return e instanceof Rp}}class E0 extends Ks{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=l_(this,e,!0),r=this.yu.map(s=>Ys(s,t)),i=new Bs(r);return new ll(e.path,i)}isEqual(e){return this===e}}class w0 extends Ks{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=l_(this,e,!0),r=this.yu.map(s=>Ys(s,t)),i=new zs(r);return new ll(e.path,i)}isEqual(e){return this===e}}class A0 extends Ks{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new da(e.serializer,tm(e.serializer,this.wu));return new ll(e.path,t)}isEqual(e){return this===e}}function Pp(n,e,t,r){const i=n.pu(1,e,t);Dp("Data must be an object, but it was:",i,r);const s=[],a=It.empty();Ir(r,(f,m)=>{const g=Cd(e,f,t);m=(0,Z.m9)(m);const y=i.Ru(g);if(m instanceof xl)s.push(g);else{const w=Ys(m,y);null!=w&&(s.push(g),a.set(g,w))}});const h=new Rt(s);return new a_(a,h,i.fieldTransforms)}function xp(n,e,t,r,i,s){const a=n.pu(1,e,t),h=[Dl(e,r,t)],f=[i];if(s.length%2!=0)throw new V(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)h.push(Dl(e,s[w])),f.push(s[w+1]);const m=[],g=It.empty();for(let w=h.length-1;w>=0;--w)if(!f_(m,h[w])){const R=h[w];let z=f[w];z=(0,Z.m9)(z);const q=a.Ru(R);if(z instanceof xl)m.push(R);else{const G=Ys(z,q);null!=G&&(m.push(R),g.set(R,G))}}const y=new Rt(m);return new a_(g,y,a.fieldTransforms)}function u_(n,e,t,r=!1){return Ys(t,n.pu(r?4:3,e))}function Ys(n,e){if(h_(n=(0,Z.m9)(n)))return Dp("Unsupported field value:",e,n),d_(n,e);if(n instanceof Ks)return function(r,i){if(!c_(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const h of r){let f=Ys(h,i.Vu(a));null==f&&(f={nullValue:"NULL_VALUE"}),s.push(f),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,Z.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return tm(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Ze.fromDate(r);return{timestampValue:pa(i.serializer,s)}}if(r instanceof Ze){const s=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pa(i.serializer,s)}}if(r instanceof wd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Cr)return{bytesValue:Em(i.serializer,r._byteString)};if(r instanceof $e){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:jh(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Td(r)}`)}(n,e)}function d_(n,e){const t={};return Vu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ir(n,(r,i)=>{const s=Ys(i,e.Eu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function h_(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Ze||n instanceof wd||n instanceof Cr||n instanceof $e||n instanceof Ks)}function Dp(n,e,t){if(!h_(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=Td(t);throw e.mu("an object"===r?n+" a custom object":n+" "+r)}var i}function Dl(n,e,t){if((e=(0,Z.m9)(e))instanceof ii)return e._internalPath;if("string"==typeof e)return Cd(n,e);throw Sd("Field path arguments must be of type string or ",n,!1,void 0,t)}const b0=new RegExp("[~\\*/\\[\\]]");function Cd(n,e,t){if(e.search(b0)>=0)throw Sd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ii(...e.split("."))._internalPath}catch{throw Sd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Sd(n,e,t,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(s||a)&&(f+=" (found",s&&(f+=` in field ${r}`),a&&(f+=` in document ${i}`),f+=")"),new V(D.INVALID_ARGUMENT,h+n+f)}function f_(n,e){return n.some(t=>t.isEqual(e))}class kl{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $e(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new C0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class C0 extends kl{data(){return super.data()}}function Rd(n,e){return"string"==typeof e?Cd(n,e):e instanceof ii?e._internalPath:e._delegate._internalPath}function p_(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new V(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kp{}class Ol extends kp{}function qi(n,e,...t){let r=[];e instanceof kp&&r.push(e),r=r.concat(t),function(s){const a=s.filter(f=>f instanceof ka).length,h=s.filter(f=>f instanceof Nl).length;if(a>1||a>0&&h>0)throw new V(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Nl extends Ol{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Nl(e,t,r)}_apply(e){const t=this._parse(e);return y_(e._query,t),new Ft(e.firestore,e.converter,p(e._query,t))}_parse(e){const t=Qs(e.firestore);return function(s,a,h,f,m,g,y){let w;if(m.isKeyField()){if("array-contains"===g||"array-contains-any"===g)throw new V(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if("in"===g||"not-in"===g){__(y,g);const R=[];for(const z of y)R.push(g_(f,s,z));w={arrayValue:{values:R}}}else w=g_(f,s,y)}else"in"!==g&&"not-in"!==g&&"array-contains-any"!==g||__(y,g),w=u_(h,"where",y,"in"===g||"not-in"===g);return Te.create(m,g,w)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class ka extends kp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ka(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:me.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let a=i;const h=s.getFlattenedFilters();for(const f of h)y_(a,f),a=p(a,f)}(e._query,t),new Ft(e.firestore,e.converter,p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Op extends Ol{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Op(e,t)}_apply(e){const t=function(i,s,a){if(null!==i.startAt)throw new V(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new V(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oi(s,a)}(e._query,this._field,this._direction);return new Ft(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new ir(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class Pd extends Ol{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Pd(e,t,r)}_apply(e){return new Ft(e.firestore,e.converter,_(e._query,this._limit,this._limitType))}}class xd extends Ol{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new xd(e,t,r)}_apply(e){const t=m_(e,this.type,this._docOrFields,this._inclusive);return new Ft(e.firestore,e.converter,(s=t,new ir((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class Dd extends Ol{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Dd(e,t,r)}_apply(e){const t=m_(e,this.type,this._docOrFields,this._inclusive);return new Ft(e.firestore,e.converter,(s=t,new ir((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function m_(n,e,t,r){if(t[0]=(0,Z.m9)(t[0]),t[0]instanceof kl)return function(s,a,h,f,m){if(!f)throw new V(D.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const g=[];for(const y of o(s))if(y.field.isKeyField())g.push(ei(a,f.key));else{const w=f.data.field(y.field);if(Di(w))throw new V(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===w){const R=y.field.canonicalString();throw new V(D.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${R}' (used as the orderBy) does not exist.`)}g.push(w)}return new nr(g,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Qs(n.firestore);return function(a,h,f,m,g,y){const w=a.explicitOrderBy;if(g.length>w.length)throw new V(D.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const R=[];for(let z=0;z<g.length;z++){const q=g[z];if(w[z].field.isKeyField()){if("string"!=typeof q)throw new V(D.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof q}`);if(!l(a)&&-1!==q.indexOf("/"))throw new V(D.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${q}' contains a slash.`);const G=a.path.child(Ae.fromString(q));if(!$.isDocumentKey(G))throw new V(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${G}' is not because it contains an odd number of segments.`);const se=new $(G);R.push(ei(h,se))}else{const G=u_(f,m,q);R.push(G)}}return new nr(R,y)}(n._query,n.firestore._databaseId,i,e,t,r)}}function g_(n,e,t){if("string"==typeof(t=(0,Z.m9)(t))){if(""===t)throw new V(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l(e)&&-1!==t.indexOf("/"))throw new V(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ae.fromString(t));if(!$.isDocumentKey(r))throw new V(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ei(n,new $(r))}if(t instanceof $e)return ei(n,t._key);throw new V(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Td(t)}.`)}function __(n,e){if(!Array.isArray(n)||0===n.length)throw new V(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function y_(n,e){const t=function(i,s){for(const a of i)for(const h of a.getFlattenedFilters())if(s.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new V(D.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Np{convertValue(e,t="none"){switch(zn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ir(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new wd(Ke(e.latitude),Ke(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Xo(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ds(e));default:return null}}convertTimestamp(e){const t=Bn(e);return new Ze(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ae.fromString(e);ne(km(r));const i=new Tr(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||tt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function kd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class V0 extends Np{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}}class Js{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class si extends kl{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Rd("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Vl extends si{data(e={}){return super.data(e)}}class Zi{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Js(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Vl(this._firestore,this._userDataWriter,r.key,r,new Js(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(h=>({type:"added",doc:new Vl(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Js(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:a++}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(h=>s||3!==h.type).map(h=>{const f=new Vl(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Js(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,g=-1;return 0!==h.type&&(m=a.indexOf(h.doc.key),a=a.delete(h.doc.key)),1!==h.type&&(a=a.add(h.doc),g=a.indexOf(h.doc.key)),{type:L0(h.type),doc:f,oldIndex:m,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function L0(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function I_(n,e){return n instanceof si&&e instanceof si?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Zi&&e instanceof Zi&&n._firestore===e._firestore&&Cp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Wi extends Np{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $e(this.firestore,null,t)}}function T_(n,e,t){n=we(n,$e);const r=we(n.firestore,We),i=kd(n.converter,e,t);return Oa(r,[bd(Qs(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Qe.none())])}function E_(n,e,t,...r){n=we(n,$e);const i=we(n.firestore,We),s=Qs(i);let a;return a="string"==typeof(e=(0,Z.m9)(e))||e instanceof ii?xp(s,"updateDoc",n._key,e,t,r):Pp(s,"updateDoc",n._key,e),Oa(i,[a.toMutation(n._key,Qe.exists(!0))])}function w_(n,...e){var t,r,i;n=(0,Z.m9)(n);let s={includeMetadataChanges:!1},a=0;"object"!=typeof e[a]||Sp(e[a])||(s=e[a],a++);const h={includeMetadataChanges:s.includeMetadataChanges};if(Sp(e[a])){const y=e[a];e[a]=null===(t=y.next)||void 0===t?void 0:t.bind(y),e[a+1]=null===(r=y.error)||void 0===r?void 0:r.bind(y),e[a+2]=null===(i=y.complete)||void 0===i?void 0:i.bind(y)}let f,m,g;if(n instanceof $e)m=we(n.firestore,We),g=Ni(n._key.path),f={next:y=>{e[a]&&e[a](Vp(m,n,y))},error:e[a+1],complete:e[a+2]};else{const y=we(n,Ft);m=we(y.firestore,We),g=y._query;const w=new Wi(m);f={next:R=>{e[a]&&e[a](new Zi(m,w,y,R))},error:e[a+1],complete:e[a+2]},p_(n._query)}return function(w,R,z,q){const G=new yd(q),se=new Zf(R,G,z);return w.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return Uf(yield Da(w),se)})),()=>{G.Na(),w.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return zf(yield Da(w),se)}))}}(st(m),g,h,f)}function Oa(n,e){return function(r,i){const s=new ct;return r.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function Rv(n,e,t){return Kf.apply(this,arguments)}(yield wp(r),i,s)})),s.promise}(st(n),e)}function Vp(n,e,t){const r=t.docs.get(e._key),i=new Wi(n);return new si(n,i,e._key,r,new Js(t.hasPendingWrites,t.fromCache),e.converter)}const tI={maxAttempts:5};class A_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Qs(e)}set(e,t,r){this._verifyNotCommitted();const i=ji(e,this._firestore),s=kd(i.converter,t,r),a=bd(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(a.toMutation(i._key,Qe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=ji(e,this._firestore);let a;return a="string"==typeof(t=(0,Z.m9)(t))||t instanceof ii?xp(this._dataReader,"WriteBatch.update",s._key,t,r,i):Pp(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Qe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ji(e,this._firestore);return this._mutations=this._mutations.concat(new fa(t._key,Qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new V(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ji(n,e){if((n=(0,Z.m9)(n)).firestore!==e)throw new V(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class nI extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Qs(t)}get(t){const r=ji(t,this._firestore),i=new V0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return Y();const a=s[0];if(a.isFoundDocument())return new kl(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new kl(this._firestore,i,r._key,null,r.converter);throw Y()})}set(t,r,i){const s=ji(t,this._firestore),a=kd(s.converter,r,i),h=bd(this._dataReader,"Transaction.set",s._key,a,null!==s.converter,i);return this._transaction.set(s._key,h),this}update(t,r,i,...s){const a=ji(t,this._firestore);let h;return h="string"==typeof(r=(0,Z.m9)(r))||r instanceof ii?xp(this._dataReader,"Transaction.update",a._key,r,i,s):Pp(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,h),this}delete(t){const r=ji(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ji(e,this._firestore),r=new Wi(this._firestore);return super.get(e).then(i=>new si(this._firestore,r,t._key,i._document,new Js(!1,!1),t.converter))}}function Lp(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new V("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function R_(){if(typeof Uint8Array>"u")throw new V("unimplemented","Uint8Arrays are not available in this environment.")}function P_(){if(!function $c(){return typeof atob<"u"}())throw new V("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){_r=Pe.SDK_VERSION,(0,Pe._registerComponent)(new P.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),h=new We(new bs(r.getProvider("auth-internal")),new Oc(r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new V(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tr(m.options.projectId,g)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),h._setSettings(s),h},"PUBLIC").setMultipleInstances(!0)),(0,Pe.registerVersion)(qo,"4.4.0",e),(0,Pe.registerVersion)(qo,"4.4.0","esm2017")}();class Ml{constructor(e){this._delegate=e}static fromBase64String(e){return P_(),new Ml(Cr.fromBase64String(e))}static fromUint8Array(e){return R_(),new Ml(Cr.fromUint8Array(e))}toBase64(){return P_(),this._delegate.toBase64()}toUint8Array(){return R_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Fp(n){return function hI(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class fI{enableIndexedDbPersistence(e,t){return function u0(n,e){o_(n=we(n,We));const t=st(n);if(t._uninitializedComponentsProvider)throw new V(D.FAILED_PRECONDITION,"SDK cache is already specified.");Zt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Pa;return s_(t,i,new gp(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function d0(n){o_(n=we(n,We));const e=st(n);if(e._uninitializedComponentsProvider)throw new V(D.FAILED_PRECONDITION,"SDK cache is already specified.");Zt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Pa;return s_(e,r,new Bg(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function h0(n){if(n._initialized&&!n._terminated)throw new V(D.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ct;return n._queue.enqueueAndForgetEvenWhileRestricted((0,I.Z)(function*(){try{yield(t=(0,I.Z)(function*(i){if(!tn.D())return Promise.resolve();const s=i+"main";yield tn.delete(s)}),function r(i){return t.apply(this,arguments)})(cf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class x_{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Tr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function t_(n,e,t,r={}){var i;const s=(n=we(n,Rl))._getSettings(),a=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&Zt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let h,f;if("string"==typeof r.mockUserToken)h=r.mockUserToken,f=pt.MOCK_USER;else{h=(0,Z.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new V(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new pt(m)}n._authCredentials=new gh(new Zo(h,f))}}(this._delegate,e,t,r)}enableNetwork(){return function p0(n){return function Kv(n){return n.asyncQueue.enqueue((0,I.Z)(function*(){const e=yield qg(n),t=yield Zg(n);return e.setNetworkEnabled(!0),function(i){const s=W(i);return s.C_.delete(0),bl(s)}(t)}))}(st(n=we(n,We)))}(this._delegate)}disableNetwork(){return function m0(n){return function Qv(n){return n.asyncQueue.enqueue((0,I.Z)(function*(){const e=yield qg(n),t=yield Zg(n);return e.setNetworkEnabled(!1),(r=(0,I.Z)(function*(s){const a=W(s);a.C_.add(0),yield Ea(a),a.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(st(n=we(n,We)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Qg("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function f0(n){return function(t){const r=new ct;return t.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return function kv(n,e){return ep.apply(this,arguments)}(yield wp(t),r)})),r.promise}(st(n=we(n,We)))}(this._delegate)}onSnapshotsInSync(e){return function j0(n,e){return function Xv(n,e){const t=new yd(e);return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return i=yield Da(n),s=t,W(i).q_.add(s),void s.next();var i,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return i=yield Da(n),s=t,void W(i).q_.delete(s);var i,s}))}}(st(n=we(n,We)),Sp(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new V("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Na(this,n_(this._delegate,e))}catch(t){throw rn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Wn(this,Ed(this._delegate,e))}catch(t){throw rn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new sn(this,function o0(n,e){if(n=we(n,Rl),bp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new V(D.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ft(n,null,(r=e,new ir(Ae.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw rn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function rI(n,e,t){n=we(n,We);const r=Object.assign(Object.assign({},tI),t);return function(s){if(s.maxAttempts<1)throw new V(D.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,h){const f=new ct;return s.asyncQueue.enqueueAndForget((0,I.Z)(function*(){const m=yield function Wg(n){return Id(n).then(e=>e.datastore)}(s);new $v(s.asyncQueue,m,h,a,f).run()})),f.promise}(st(n),i=>e(new nI(n,i)),r)}(this._delegate,t=>e(new D_(this,t)))}batch(){return st(this._delegate),new k_(new A_(this._delegate,e=>Oa(this._delegate,e)))}loadBundle(e){return function g0(n,e){const t=st(n=we(n,We)),r=new c0;return function e0(n,e,t,r){const i=function(a,h){let f;return f="string"==typeof a?pm().encode(a):a,g=function(g,y){if(g instanceof Uint8Array)return zg(g,y);if(g instanceof ArrayBuffer)return zg(new Uint8Array(g),y);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),new Wv(g,h);var g}(t,Al(e));n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){!function qv(n,e,t){const r=W(n);var i;(i=(0,I.Z)(function*(a,h,f){try{const m=yield h.getMetadata();if(yield function(z,q){const G=W(z),se=dt(q.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",oe=>G.Kr.getBundleMetadata(oe,q.id)).then(oe=>!!oe&&oe.createTime.compareTo(se)>=0)}(a.localStore,m))return yield h.close(),f._completeWith({taskState:"Success",documentsLoaded:(z=m).totalDocuments,bytesLoaded:z.totalBytes,totalDocuments:z.totalDocuments,totalBytes:z.totalBytes}),Promise.resolve(new Set);f._updateProgress(Dg(m));const g=new Ev(m,a.localStore,h.serializer);let y=yield h.Ma();for(;y;){const R=yield g.ea(y);R&&f._updateProgress(R),y=yield h.Ma()}const w=yield g.complete();return yield ri(a,w.ra,void 0),yield function(z,q){const G=W(z);return G.persistence.runTransaction("Save bundle","readwrite",se=>G.Kr.saveBundleMetadata(se,q))}(a.localStore,m),f._completeWith(w.progress),Promise.resolve(w.na)}catch(m){return Zt("SyncEngine",`Loading bundle failed with ${m}`),f._failWith(m),Promise.resolve(new Set)}var z}),function s(a,h,f){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield wp(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function _0(n,e){return function t0(n,e){return n.asyncQueue.enqueue((0,I.Z)(function*(){return function(r,i){const s=W(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(yield xa(n),e)}))}(st(n=we(n,We)),e).then(t=>t?new Ft(n,null,t.query):null)}(this._delegate,e).then(t=>t?new sn(this,t):null)}}class Nd extends Np{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ml(new Cr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Wn.forKey(t,this.firestore,null)}}class D_{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Nd(e)}get(e){const t=eo(e);return this._delegate.get(t).then(r=>new Ll(this._firestore,new si(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=eo(e);return r?(Lp("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=eo(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=eo(e);return this._delegate.delete(t),this}}class k_{constructor(e){this._delegate=e}set(e,t,r){const i=eo(e);return r?(Lp("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=eo(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=eo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Xs{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Vl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Fl(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Xs.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Xs(e,new Nd(e),t),i.set(t,s)),s}}Xs.INSTANCES=new WeakMap;class Wn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nd(e)}static forPath(e,t,r){if(e.length%2!=0)throw new V("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Wn(t,new $e(t._delegate,r,new $(e)))}static forKey(e,t,r){return new Wn(t,new $e(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Na(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Na(this.firestore,n_(this._delegate,e))}catch(t){throw rn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Z.m9)(e))instanceof $e&&r_(this._delegate,e)}set(e,t){t=Lp("DocumentReference.set",t);try{return t?T_(this._delegate,e,t):T_(this._delegate,e)}catch(r){throw rn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?E_(this._delegate,e):E_(this._delegate,e,t,...r)}catch(i){throw rn(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Z0(n){return Oa(we(n.firestore,We),[new fa(n._key,Qe.none())])}(this._delegate)}onSnapshot(...e){const t=O_(e),r=N_(e,i=>new Ll(this.firestore,new si(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return w_(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function U0(n){n=we(n,$e);const e=we(n.firestore,We),t=st(e),r=new Wi(e);return function Yv(n,e){const t=new ct;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return(r=(0,I.Z)(function*(s,a,h){try{const f=yield function(g,y){const w=W(g);return w.persistence.runTransaction("read document","readonly",R=>w.localDocuments.getDocument(R,y))}(s,a);f.isFoundDocument()?h.resolve(f):f.isNoDocument()?h.resolve(null):h.reject(new V(D.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(f){const m=ba(f,`Failed to get document '${a} from cache`);h.reject(m)}}),function i(s,a,h){return r.apply(this,arguments)})(yield xa(n),e,t);var r})),t.promise}(t,n._key).then(i=>new si(e,r,n._key,i,new Js(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function B0(n){n=we(n,$e);const e=we(n.firestore,We);return jg(st(e),n._key,{source:"server"}).then(t=>Vp(e,n,t))}(this._delegate):function F0(n){n=we(n,$e);const e=we(n.firestore,We);return jg(st(e),n._key).then(t=>Vp(e,n,t))}(this._delegate),t.then(r=>new Ll(this.firestore,new si(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Wn(this.firestore,this._delegate.withConverter(e?Xs.getInstance(this.firestore,e):null))}}function rn(n,e,t){return n.message=n.message.replace(e,t),n}function O_(n){for(const e of n)if("object"==typeof e&&!Fp(e))return e;return{}}function N_(n,e){var t,r;let i;return i=Fp(n[0])?n[0]:Fp(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Ll{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Wn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return I_(this._delegate,e._delegate)}}class Fl extends Ll{data(e){const t=this._delegate.data(e);return this._delegate._converter||function mh(n,e){n||Y()}(void 0!==t),t}}class sn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Nd(e)}where(e,t,r){try{return new sn(this.firestore,qi(this._delegate,function S0(n,e,t){const r=e,i=Rd("where",n);return Nl._create(i,r,t)}(e,t,r)))}catch(i){throw rn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new sn(this.firestore,qi(this._delegate,function R0(n,e="asc"){const t=e,r=Rd("orderBy",n);return Op._create(r,t)}(e,t)))}catch(r){throw rn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new sn(this.firestore,qi(this._delegate,function P0(n){return Xg("limit",n),Pd._create("limit",n,"F")}(e)))}catch(t){throw rn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new sn(this.firestore,qi(this._delegate,function x0(n){return Xg("limitToLast",n),Pd._create("limitToLast",n,"L")}(e)))}catch(t){throw rn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new sn(this.firestore,qi(this._delegate,function D0(...n){return xd._create("startAt",n,!0)}(...e)))}catch(t){throw rn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new sn(this.firestore,qi(this._delegate,function k0(...n){return xd._create("startAfter",n,!1)}(...e)))}catch(t){throw rn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new sn(this.firestore,qi(this._delegate,function O0(...n){return Dd._create("endBefore",n,!1)}(...e)))}catch(t){throw rn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new sn(this.firestore,qi(this._delegate,function N0(...n){return Dd._create("endAt",n,!0)}(...e)))}catch(t){throw rn(t,"endAt()","Query.endAt()")}}isEqual(e){return Cp(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function G0(n){n=we(n,Ft);const e=we(n.firestore,We),t=st(e),r=new Wi(e);return function Jv(n,e){const t=new ct;return n.asyncQueue.enqueueAndForget((0,I.Z)(function*(){return(r=(0,I.Z)(function*(s,a,h){try{const f=yield dd(s,a,!0),m=new Ng(a,f.ls),g=m.ca(f.documents),y=m.applyChanges(g,!1);h.resolve(y.snapshot)}catch(f){const m=ba(f,`Failed to execute query '${a} against cache`);h.reject(m)}}),function i(s,a,h){return r.apply(this,arguments)})(yield xa(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Zi(e,r,n,i))}(this._delegate):"server"===e?.source?function q0(n){n=we(n,Ft);const e=we(n.firestore,We),t=st(e),r=new Wi(e);return $g(t,n._query,{source:"server"}).then(i=>new Zi(e,r,n,i))}(this._delegate):function z0(n){n=we(n,Ft);const e=we(n.firestore,We),t=st(e),r=new Wi(e);return p_(n._query),$g(t,n._query).then(i=>new Zi(e,r,n,i))}(this._delegate),t.then(r=>new Up(this.firestore,new Zi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=O_(e),r=N_(e,i=>new Up(this.firestore,new Zi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return w_(this._delegate,t,r)}withConverter(e){return new sn(this.firestore,this._delegate.withConverter(e?Xs.getInstance(this.firestore,e):null))}}class mI{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Fl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Up{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new sn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Fl(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new mI(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Fl(this._firestore,r))})}isEqual(e){return I_(this._delegate,e._delegate)}}class Na extends sn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Wn(this.firestore,e):null}doc(e){try{return new Wn(this.firestore,void 0===e?Ed(this._delegate):Ed(this._delegate,e))}catch(t){throw rn(t,"doc()","CollectionReference.doc()")}}add(e){return function W0(n,e){const t=we(n.firestore,We),r=Ed(n),i=kd(n.converter,e);return Oa(t,[bd(Qs(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Wn(this.firestore,t))}isEqual(e){return r_(this._delegate,e._delegate)}withConverter(e){return new Na(this.firestore,this._delegate.withConverter(e?Xs.getInstance(this.firestore,e):null))}}function eo(n){return we(n,$e)}class Bp{constructor(...e){this._delegate=new ii(...e)}static documentId(){return new Bp(Ue.keyField().canonicalString())}isEqual(e){return(e=(0,Z.m9)(e))instanceof ii&&this._delegate._internalPath.isEqual(e._internalPath)}}class to{constructor(e){this._delegate=e}static serverTimestamp(){const e=function sI(){return new Rp("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new to(e)}static delete(){const e=function iI(){return new xl("deleteField")}();return e._methodName="FieldValue.delete",new to(e)}static arrayUnion(...e){const t=function oI(...n){return new E0("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new to(t)}static arrayRemove(...e){const t=function aI(...n){return new w0("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new to(t)}static increment(e){const t=function cI(n){return new A0("increment",n)}(e);return t._methodName="FieldValue.increment",new to(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const gI={Firestore:x_,GeoPoint:wd,Timestamp:Ze,Blob:Ml,Transaction:D_,WriteBatch:k_,DocumentReference:Wn,DocumentSnapshot:Ll,Query:sn,QueryDocumentSnapshot:Fl,QuerySnapshot:Up,CollectionReference:Na,FieldPath:Bp,FieldValue:to,setLogLevel:function pI(n){!function Dc(n){hn.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function V_(n,e){return function vI(n,e=sr.z){return new li.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function zp(n,e){return V_(n,e).pipe((0,ae.U)(t=>({payload:t,type:"query"})))}!function yI(n){(function _I(n,e){n.INTERNAL.registerComponent(new P.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},gI)))})(n,(e,t)=>new x_(e,t,new fI)),n.registerVersion("@firebase/firestore-compat","0.3.23")}(Ot.Z);class M_{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=G_(r,t);return new U_(i,s,this.afs)}snapshotChanges(){return function II(n,e){return V_(n,e).pipe((0,rt.O)(void 0),vn(),(0,ae.U)(t=>{const[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ae.U)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,yn.D)(this.ref.get(e)).pipe(ft)}}function Vd(n,e){return zp(n,e).pipe((0,rt.O)(void 0),vn(),(0,ae.U)(t=>{const[r,i]=t,s=i.payload.docChanges(),a=s.map(h=>({type:h.type,payload:h}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((h,f)=>{const m=s.find(y=>y.doc.ref.isEqual(h.ref)),g=r?.payload.docs.find(y=>y.ref.isEqual(h.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(h.metadata)||!m&&g&&JSON.stringify(g.metadata)===JSON.stringify(h.metadata)||a.push({type:"modified",payload:{oldIndex:f,newIndex:f,type:"modified",doc:h}})}),a}))}function L_(n,e,t){return Vd(n,t).pipe((0,xn.R)((r,i)=>function TI(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function EI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Gp(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Gp(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Gp(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),(0,io.x)(),(0,ae.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function Gp(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function F_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class U_{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Vd(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ae.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,rt.O)(void 0),vn(),(0,Vr.h)(([r,i])=>i.length>0||!r),(0,ae.U)(([,r])=>r),ft)}auditTrail(e){return this.stateChanges(e).pipe((0,xn.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=F_(e);return L_(this.query,t,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return zp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),ft)}get(e){return(0,yn.D)(this.query.get(e)).pipe(ft)}add(e){return this.ref.add(e)}doc(e){return new M_(this.ref.doc(e),this.afs)}}class wI{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Vd(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,Vr.h)(t=>t.length>0),ft):Vd(this.query,this.afs.schedulers.outsideAngular).pipe(ft)}auditTrail(e){return this.stateChanges(e).pipe((0,xn.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=F_(e);return L_(this.query,t,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return zp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.U)(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),ft)}get(e){return(0,yn.D)(this.query.get(e)).pipe(ft)}}const B_=new d.OlP("angularfire2.enableFirestorePersistence"),z_=new d.OlP("angularfire2.firestore.persistenceSettings"),AI=new d.OlP("angularfire2.firestore.settings"),bI=new d.OlP("angularfire2.firestore.use-emulator");function G_(n,e=(t=>t)){return{query:e(n),ref:n}}let q_=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,a,h,f,m,g,y,w,R,z,q,G,se,oe){this.schedulers=f;const K=Sn(t,h,r),ce=g;y&&ge(K,h,w,z,q,G,R,se),[this.firestore,this.persistenceEnabled$]=Rn(`${K.name}.firestore`,"AngularFirestore",K.name,()=>{const _e=h.runOutsideAngular(()=>K.firestore());if(s&&_e.settings(s),ce&&_e.useEmulator(...ce),i&&!(0,v.PM)(a)){const De=()=>{try{return(0,yn.D)(_e.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(ht){return typeof console<"u"&&console.warn(ht),(0,Pn.of)(!1)}};return[_e,h.runOutsideAngular(De)]}return[_e,(0,Pn.of)(!1)]},[s,ce,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:a}=G_(i,r),h=this.schedulers.ngZone.run(()=>s);return new U_(h,a,this)}collectionGroup(t,r){const i=r||(a=>a),s=this.firestore.collectionGroup(t);return new wI(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new M_(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(d.LFG(cn),d.LFG(_n,8),d.LFG(B_,8),d.LFG(AI,8),d.LFG(d.Lbi),d.LFG(d.R0b),d.LFG(Yt),d.LFG(z_,8),d.LFG(bI,8),d.LFG(Nt,8),d.LFG(E,8),d.LFG(b,8),d.LFG(N,8),d.LFG(x,8),d.LFG(Q,8),d.LFG(ue,8),d.LFG(Ce,8))};static \u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),CI=(()=>{class n{constructor(){Ot.Z.registerVersion("angularfire",$n.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:B_,useValue:!0},{provide:z_,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({providers:[q_]})}return n})(),Z_=(()=>{class n{constructor(t){this.db=t,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(t){return this.puzzleDataRef.add({...t})}update(t,r){return this.puzzleDataRef.doc(t).update(r)}delete(t){return this.puzzleDataRef.doc(t).delete()}static#e=this.\u0275fac=function(r){return new(r||n)(d.LFG(q_))};static#t=this.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),W_=(()=>{class n{constructor(){this.subjectItemUpdate=new Ie.x}updatePerformedItem(t){this.subjectItemUpdate.next(t)}getUpdatedStageLevel(){return this.subjectItemUpdate.asObservable()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=d.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var xe=H(6825),Va=H(4713);let qp=(()=>{class n extends Va.s{static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0),d._UZ(1,"path",1),d.qZA()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return n})();var mn=H(2332);let Zp=(()=>{class n extends Va.s{pathId;ngOnInit(){this.pathId="url(#"+(0,mn.Th)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0)(1,"g"),d._UZ(2,"path",1)(3,"path",2)(4,"path",3),d.qZA(),d.TgZ(5,"defs")(6,"clipPath",4),d._UZ(7,"rect",5),d.qZA()()()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.xp6(1),d.uIk("clip-path",i.pathId),d.xp6(5),d.Q6J("id",i.pathId))},encapsulation:2})}return n})(),Wp=(()=>{class n extends Va.s{pathId;ngOnInit(){this.pathId="url(#"+(0,mn.Th)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["InfoCircleIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0)(1,"g"),d._UZ(2,"path",1),d.qZA(),d.TgZ(3,"defs")(4,"clipPath",2),d._UZ(5,"rect",3),d.qZA()()()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.xp6(1),d.uIk("clip-path",i.pathId),d.xp6(3),d.Q6J("id",i.pathId))},encapsulation:2})}return n})();var Ul=H(7778);let jp=(()=>{class n extends Va.s{pathId;ngOnInit(){this.pathId="url(#"+(0,mn.Th)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["TimesCircleIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0)(1,"g"),d._UZ(2,"path",1),d.qZA(),d.TgZ(3,"defs")(4,"clipPath",2),d._UZ(5,"rect",3),d.qZA()()()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.xp6(1),d.uIk("clip-path",i.pathId),d.xp6(3),d.Q6J("id",i.pathId))},encapsulation:2})}return n})();var Bl=H(4480);const j_=["container"];function SI(n,e){if(1&n&&d._UZ(0,"span"),2&n){const t=d.oxw(2);d.Tol("p-toast-message-icon pi "+t.message.icon)}}function RI(n,e){1&n&&d._UZ(0,"CheckIcon"),2&n&&d.uIk("aria-hidden",!0)("data-pc-section","icon")}function PI(n,e){1&n&&d._UZ(0,"InfoCircleIcon"),2&n&&d.uIk("aria-hidden",!0)("data-pc-section","icon")}function xI(n,e){1&n&&d._UZ(0,"TimesCircleIcon"),2&n&&d.uIk("aria-hidden",!0)("data-pc-section","icon")}function DI(n,e){1&n&&d._UZ(0,"ExclamationTriangleIcon"),2&n&&d.uIk("aria-hidden",!0)("data-pc-section","icon")}function kI(n,e){if(1&n&&(d.TgZ(0,"span",11),d.ynx(1),d.YNc(2,RI,1,2,"CheckIcon",3)(3,PI,1,2,"InfoCircleIcon",3)(4,xI,1,2,"TimesCircleIcon",3)(5,DI,1,2,"ExclamationTriangleIcon",3),d.BQk(),d.qZA()),2&n){const t=d.oxw(2);d.uIk("aria-hidden",!0)("data-pc-section","icon"),d.xp6(2),d.Q6J("ngIf","success"===t.message.severity),d.xp6(1),d.Q6J("ngIf","info"===t.message.severity),d.xp6(1),d.Q6J("ngIf","error"===t.message.severity),d.xp6(1),d.Q6J("ngIf","warn"===t.message.severity)}}function OI(n,e){if(1&n&&(d.ynx(0),d.YNc(1,SI,1,2,"span",6)(2,kI,6,6,"span",7),d.TgZ(3,"div",8)(4,"div",9),d._uU(5),d.qZA(),d.TgZ(6,"div",10),d._uU(7),d.qZA()(),d.BQk()),2&n){const t=d.oxw();d.xp6(1),d.Q6J("ngIf",t.message.icon),d.xp6(1),d.Q6J("ngIf",!t.message.icon),d.xp6(1),d.uIk("data-pc-section","text"),d.xp6(1),d.uIk("data-pc-section","summary"),d.xp6(1),d.Oqu(t.message.summary),d.xp6(1),d.uIk("data-pc-section","detail"),d.xp6(1),d.Oqu(t.message.detail)}}function NI(n,e){1&n&&d.GkF(0)}function VI(n,e){if(1&n&&d._UZ(0,"span"),2&n){const t=d.oxw(2);d.Tol("pt-1 text-base p-toast-message-icon pi "+t.message.closeIcon)}}function MI(n,e){1&n&&d._UZ(0,"TimesIcon",14),2&n&&(d.Q6J("styleClass","p-toast-icon-close-icon"),d.uIk("aria-hidden",!0)("data-pc-section","closeicon"))}function LI(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"button",12),d.NdJ("click",function(i){d.CHM(t);const s=d.oxw();return d.KtG(s.onCloseIconClick(i))})("keydown.enter",function(i){d.CHM(t);const s=d.oxw();return d.KtG(s.onCloseIconClick(i))}),d.YNc(1,VI,1,2,"span",6)(2,MI,1,3,"TimesIcon",13),d.qZA()}if(2&n){const t=d.oxw();d.uIk("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),d.xp6(1),d.Q6J("ngIf",t.message.closeIcon),d.xp6(1),d.Q6J("ngIf",!t.message.closeIcon)}}const FI=n=>[n,"p-toast-message"],UI=(n,e,t,r)=>({showTransformParams:n,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:r}),BI=n=>({value:"visible",params:n}),zI=n=>({$implicit:n});function GI(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"p-toastItem",3),d.NdJ("onClose",function(i){d.CHM(t);const s=d.oxw();return d.KtG(s.onMessageClose(i))})("@toastAnimation.start",function(i){d.CHM(t);const s=d.oxw();return d.KtG(s.onAnimationStart(i))})("@toastAnimation.done",function(i){d.CHM(t);const s=d.oxw();return d.KtG(s.onAnimationEnd(i))}),d.qZA()}if(2&n){const t=e.$implicit,r=e.index,i=d.oxw();d.Q6J("message",t)("index",r)("life",i.life)("template",i.template)("@toastAnimation",void 0)("showTransformOptions",i.showTransformOptions)("hideTransformOptions",i.hideTransformOptions)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}}let qI=(()=>{class n{zone;config;message;index;life;template;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new d.vpe;containerViewChild;timeout;constructor(t,r){this.zone=t,this.config=r}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick(t){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()}get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(r){return new(r||n)(d.Y36(d.R0b),d.Y36(k.b4))};static \u0275cmp=d.Xpm({type:n,selectors:[["p-toastItem"]],viewQuery:function(r,i){if(1&r&&d.Gf(j_,5),2&r){let s;d.iGM(s=d.CRH())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:"index",life:"life",template:"template",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},decls:6,vars:24,consts:[["role","alert","aria-live","assertive","aria-atomic","true",3,"ngClass","mouseenter","mouseleave"],["container",""],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(r,i){1&r&&(d.TgZ(0,"div",0,1),d.NdJ("mouseenter",function(){return i.onMouseEnter()})("mouseleave",function(){return i.onMouseLeave()}),d.TgZ(2,"div",2),d.YNc(3,OI,8,7,"ng-container",3)(4,NI,1,0,"ng-container",4)(5,LI,3,4,"button",5),d.qZA()()),2&r&&(d.Tol(null==i.message?null:i.message.styleClass),d.Q6J("ngClass",d.VKq(13,FI,"p-toast-message-"+(null==i.message?null:i.message.severity)))("@messageState",d.VKq(20,BI,d.l5B(15,UI,i.showTransformOptions,i.hideTransformOptions,i.showTransitionOptions,i.hideTransitionOptions))),d.uIk("id",null==i.message?null:i.message.id)("data-pc-name","toast")("data-pc-section","root"),d.xp6(2),d.Q6J("ngClass",null==i.message?null:i.message.contentStyleClass),d.uIk("data-pc-section","content"),d.xp6(1),d.Q6J("ngIf",!i.template),d.xp6(1),d.Q6J("ngTemplateOutlet",i.template)("ngTemplateOutletContext",d.VKq(22,zI,i.message)),d.xp6(1),d.Q6J("ngIf",!1!==(null==i.message?null:i.message.closable)))},dependencies:()=>[v.mk,v.O5,v.tP,Bl.H,qp,Wp,jp,Zp,Ul.q],encapsulation:2,data:{animation:[(0,xe.X$)("messageState",[(0,xe.SB)("visible",(0,xe.oB)({transform:"translateY(0)",opacity:1})),(0,xe.eR)("void => *",[(0,xe.oB)({transform:"{{showTransformParams}}",opacity:0}),(0,xe.jt)("{{showTransitionParams}}")]),(0,xe.eR)("* => void",[(0,xe.jt)("{{hideTransitionParams}}",(0,xe.oB)({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return n})(),ZI=(()=>{class n{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new d.vpe;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;_position="top-right";constructor(t,r,i,s,a){this.document=t,this.renderer=r,this.messageService=i,this.cd=s,this.config=a}styleElement;id=(0,mn.Th)();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){const r=t.filter(i=>this.canAdd(i));this.add(r)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let r=this.key===t.key;return r&&this.preventOpenDuplicates&&(r=!this.containsMessage(this.messages,t)),r&&this.preventDuplicates&&(r=!this.containsMessage(this.messagesArchieve,t)),r}containsMessage(t,r){return!!t&&null!=t.find(i=>i.summary===r.summary&&i.detail==r.detail&&i.severity===r.severity)}ngAfterContentInit(){this.templates?.forEach(t=>{t.getType(),this.template=t.template})}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){"void"===t.fromState&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&""===this.containerViewChild?.nativeElement.style.zIndex&&mn.P9.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){"void"===t.toState&&this.autoZIndex&&mn.gb.isEmpty(this.messages)&&mn.P9.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let r in this.breakpoints){let i="";for(let s in this.breakpoints[r])i+=s+":"+this.breakpoints[r][s]+" !important;";t+=`\n                    @media screen and (max-width: ${r}) {\n                        .p-toast[${this.id}] {\n                           ${i}\n                        }\n                    }\n                `}this.renderer.setProperty(this.styleElement,"innerHTML",t)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&mn.P9.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(r){return new(r||n)(d.Y36(v.K0),d.Y36(d.Qsj),d.Y36(k.ez),d.Y36(d.sBO),d.Y36(k.b4))};static \u0275cmp=d.Xpm({type:n,selectors:[["p-toast"]],contentQueries:function(r,i,s){if(1&r&&d.Suo(s,k.jx,4),2&r){let a;d.iGM(a=d.CRH())&&(i.templates=a)}},viewQuery:function(r,i){if(1&r&&d.Gf(j_,5),2&r){let s;d.iGM(s=d.CRH())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",life:"life",style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:"preventOpenDuplicates",preventDuplicates:"preventDuplicates",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},decls:3,vars:5,consts:[[1,"p-toast","p-component",3,"ngClass","ngStyle"],["container",""],[3,"message","index","life","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"message","index","life","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose"]],template:function(r,i){1&r&&(d.TgZ(0,"div",0,1),d.YNc(2,GI,1,9,"p-toastItem",2),d.qZA()),2&r&&(d.Tol(i.styleClass),d.Q6J("ngClass","p-toast-"+i._position)("ngStyle",i.style),d.xp6(2),d.Q6J("ngForOf",i.messages))},dependencies:[v.mk,v.sg,v.PC,qI],styles:["@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}\n"],encapsulation:2,data:{animation:[(0,xe.X$)("toastAnimation",[(0,xe.eR)(":enter, :leave",[(0,xe.IO)("@*",(0,xe.pV)())])])]},changeDetection:0})}return n})(),WI=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({imports:[v.ez,Bl.T,qp,Wp,jp,Zp,Ul.q,k.m8]})}return n})();var He=H(2076);let jI=(()=>{class n{el;pFocusTrapDisabled=!1;constructor(t){this.el=t}onkeydown(t){if(!0!==this.pFocusTrapDisabled){t.preventDefault();const r=He.p.getNextFocusableElement(this.el.nativeElement,t.shiftKey);r&&(r.focus(),r.select?.())}}static \u0275fac=function(r){return new(r||n)(d.Y36(d.SBq))};static \u0275dir=d.lG2({type:n,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(r,i){1&r&&d.NdJ("keydown.tab",function(a){return i.onkeydown(a)})("keydown.shift.tab",function(a){return i.onkeydown(a)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}})}return n})(),$I=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({imports:[v.ez]})}return n})(),$_=(()=>{class n extends Va.s{pathId;ngOnInit(){this.pathId="url(#"+(0,mn.Th)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0)(1,"g"),d._UZ(2,"path",1),d.qZA(),d.TgZ(3,"defs")(4,"clipPath",2),d._UZ(5,"rect",3),d.qZA()()()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.xp6(1),d.uIk("clip-path",i.pathId),d.xp6(3),d.Q6J("id",i.pathId))},encapsulation:2})}return n})(),H_=(()=>{class n extends Va.s{pathId;ngOnInit(){this.pathId="url(#"+(0,mn.Th)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.n5z(n)))(i||n)}})();static \u0275cmp=d.Xpm({type:n,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[d.qOj,d.jDz],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(d.O4$(),d.TgZ(0,"svg",0)(1,"g"),d._UZ(2,"path",1),d.qZA(),d.TgZ(3,"defs")(4,"clipPath",2),d._UZ(5,"rect",3),d.qZA()()()),2&r&&(d.Tol(i.getClassNames()),d.uIk("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.xp6(1),d.uIk("clip-path",i.pathId),d.xp6(3),d.Q6J("id",i.pathId))},encapsulation:2})}return n})();const HI=["titlebar"],KI=["content"],QI=["footer"];function YI(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",11),d.NdJ("mousedown",function(i){d.CHM(t);const s=d.oxw(3);return d.KtG(s.initResize(i))}),d.qZA()}}function JI(n,e){if(1&n&&(d.TgZ(0,"span",18),d._uU(1),d.qZA()),2&n){const t=d.oxw(4);d.Q6J("id",t.getAriaLabelledBy()),d.xp6(1),d.Oqu(t.header)}}function XI(n,e){if(1&n&&(d.TgZ(0,"span",18),d.Hsn(1,1),d.qZA()),2&n){const t=d.oxw(4);d.Q6J("id",t.getAriaLabelledBy())}}function eT(n,e){1&n&&d.GkF(0)}function tT(n,e){if(1&n&&d._UZ(0,"span",22),2&n){const t=d.oxw(5);d.Q6J("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function nT(n,e){1&n&&d._UZ(0,"WindowMaximizeIcon",24),2&n&&d.Q6J("styleClass","p-dialog-header-maximize-icon")}function rT(n,e){1&n&&d._UZ(0,"WindowMinimizeIcon",24),2&n&&d.Q6J("styleClass","p-dialog-header-maximize-icon")}function iT(n,e){if(1&n&&(d.ynx(0),d.YNc(1,nT,1,1,"WindowMaximizeIcon",23)(2,rT,1,1,"WindowMinimizeIcon",23),d.BQk()),2&n){const t=d.oxw(5);d.xp6(1),d.Q6J("ngIf",!t.maximized&&!t.maximizeIconTemplate),d.xp6(1),d.Q6J("ngIf",t.maximized&&!t.minimizeIconTemplate)}}function sT(n,e){}function oT(n,e){1&n&&d.YNc(0,sT,0,0,"ng-template")}function aT(n,e){if(1&n&&(d.ynx(0),d.YNc(1,oT,1,0,null,9),d.BQk()),2&n){const t=d.oxw(5);d.xp6(1),d.Q6J("ngTemplateOutlet",t.maximizeIconTemplate)}}function cT(n,e){}function lT(n,e){1&n&&d.YNc(0,cT,0,0,"ng-template")}function uT(n,e){if(1&n&&(d.ynx(0),d.YNc(1,lT,1,0,null,9),d.BQk()),2&n){const t=d.oxw(5);d.xp6(1),d.Q6J("ngTemplateOutlet",t.minimizeIconTemplate)}}const dT=()=>({"p-dialog-header-icon p-dialog-header-maximize p-link":!0});function hT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"button",19),d.NdJ("click",function(){d.CHM(t);const i=d.oxw(4);return d.KtG(i.maximize())})("keydown.enter",function(){d.CHM(t);const i=d.oxw(4);return d.KtG(i.maximize())}),d.YNc(1,tT,1,1,"span",20)(2,iT,3,2,"ng-container",21)(3,aT,2,1,"ng-container",21)(4,uT,2,1,"ng-container",21),d.qZA()}if(2&n){const t=d.oxw(4);d.Q6J("ngClass",d.DdM(5,dT)),d.xp6(1),d.Q6J("ngIf",t.maximizeIcon&&!t.maximizeIconTemplate&&!t.minimizeIconTemplate),d.xp6(1),d.Q6J("ngIf",!t.maximizeIcon),d.xp6(1),d.Q6J("ngIf",!t.maximized),d.xp6(1),d.Q6J("ngIf",t.maximized)}}function fT(n,e){if(1&n&&d._UZ(0,"span",27),2&n){const t=d.oxw(6);d.Q6J("ngClass",t.closeIcon)}}function pT(n,e){1&n&&d._UZ(0,"TimesIcon",24),2&n&&d.Q6J("styleClass","p-dialog-header-close-icon")}function mT(n,e){if(1&n&&(d.ynx(0),d.YNc(1,fT,1,1,"span",26)(2,pT,1,1,"TimesIcon",23),d.BQk()),2&n){const t=d.oxw(5);d.xp6(1),d.Q6J("ngIf",t.closeIcon),d.xp6(1),d.Q6J("ngIf",!t.closeIcon)}}function gT(n,e){}function _T(n,e){1&n&&d.YNc(0,gT,0,0,"ng-template")}function yT(n,e){if(1&n&&(d.TgZ(0,"span"),d.YNc(1,_T,1,0,null,9),d.qZA()),2&n){const t=d.oxw(5);d.xp6(1),d.Q6J("ngTemplateOutlet",t.closeIconTemplate)}}const vT=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0});function IT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"button",25),d.NdJ("click",function(i){d.CHM(t);const s=d.oxw(4);return d.KtG(s.close(i))})("keydown.enter",function(i){d.CHM(t);const s=d.oxw(4);return d.KtG(s.close(i))}),d.YNc(1,mT,3,2,"ng-container",21)(2,yT,2,1,"span",21),d.qZA()}if(2&n){const t=d.oxw(4);d.Q6J("ngClass",d.DdM(5,vT)),d.uIk("aria-label",t.closeAriaLabel)("tabindex",t.closeTabindex),d.xp6(1),d.Q6J("ngIf",!t.closeIconTemplate),d.xp6(1),d.Q6J("ngIf",t.closeIconTemplate)}}function TT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",12,13),d.NdJ("mousedown",function(i){d.CHM(t);const s=d.oxw(3);return d.KtG(s.initDrag(i))}),d.YNc(2,JI,2,2,"span",14)(3,XI,2,1,"span",14)(4,eT,1,0,"ng-container",9),d.TgZ(5,"div",15),d.YNc(6,hT,5,6,"button",16)(7,IT,3,6,"button",17),d.qZA()()}if(2&n){const t=d.oxw(3);d.xp6(2),d.Q6J("ngIf",!t.headerFacet&&!t.headerTemplate),d.xp6(1),d.Q6J("ngIf",t.headerFacet),d.xp6(1),d.Q6J("ngTemplateOutlet",t.headerTemplate),d.xp6(2),d.Q6J("ngIf",t.maximizable),d.xp6(1),d.Q6J("ngIf",t.closable)}}function ET(n,e){1&n&&d.GkF(0)}function wT(n,e){1&n&&d.GkF(0)}function AT(n,e){if(1&n&&(d.TgZ(0,"div",28,29),d.Hsn(2,2),d.YNc(3,wT,1,0,"ng-container",9),d.qZA()),2&n){const t=d.oxw(3);d.xp6(3),d.Q6J("ngTemplateOutlet",t.footerTemplate)}}const bT=(n,e,t,r)=>({"p-dialog p-component":!0,"p-dialog-rtl":n,"p-dialog-draggable":e,"p-dialog-resizable":t,"p-dialog-maximized":r}),CT=(n,e)=>({transform:n,transition:e}),ST=n=>({value:"visible",params:n});function RT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",3,4),d.NdJ("@animation.start",function(i){d.CHM(t);const s=d.oxw(2);return d.KtG(s.onAnimationStart(i))})("@animation.done",function(i){d.CHM(t);const s=d.oxw(2);return d.KtG(s.onAnimationEnd(i))}),d.YNc(2,YI,1,0,"div",5)(3,TT,8,5,"div",6),d.TgZ(4,"div",7,8),d.Hsn(6),d.YNc(7,ET,1,0,"ng-container",9),d.qZA(),d.YNc(8,AT,4,1,"div",10),d.qZA()}if(2&n){const t=d.oxw(2);d.Tol(t.styleClass),d.Q6J("ngClass",d.l5B(16,bT,t.rtl,t.draggable,t.resizable,t.maximized))("ngStyle",t.style)("pFocusTrapDisabled",!1===t.focusTrap)("@animation",d.VKq(24,ST,d.WLB(21,CT,t.transformOptions,t.transitionOptions))),d.uIk("aria-labelledby",t.ariaLabelledBy)("aria-modal",!0),d.xp6(2),d.Q6J("ngIf",t.resizable),d.xp6(1),d.Q6J("ngIf",t.showHeader),d.xp6(1),d.Tol(t.contentStyleClass),d.Q6J("ngClass","p-dialog-content")("ngStyle",t.contentStyle),d.xp6(3),d.Q6J("ngTemplateOutlet",t.contentTemplate),d.xp6(1),d.Q6J("ngIf",t.footerFacet||t.footerTemplate)}}const PT=(n,e,t,r,i,s,a,h,f,m)=>({"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":n,"p-dialog-mask-scrollblocker":e,"p-dialog-left":t,"p-dialog-right":r,"p-dialog-top":i,"p-dialog-top-left":s,"p-dialog-top-right":a,"p-dialog-bottom":h,"p-dialog-bottom-left":f,"p-dialog-bottom-right":m});function xT(n,e){if(1&n&&(d.TgZ(0,"div",1),d.YNc(1,RT,9,26,"div",2),d.qZA()),2&n){const t=d.oxw();d.Tol(t.maskStyleClass),d.Q6J("ngClass",d.rFY(4,PT,[t.modal,t.modal||t.blockScroll,"left"===t.position,"right"===t.position,"top"===t.position,"topleft"===t.position||"top-left"===t.position,"topright"===t.position||"top-right"===t.position,"bottom"===t.position,"bottomleft"===t.position||"bottom-left"===t.position,"bottomright"===t.position||"bottom-right"===t.position])),d.xp6(1),d.Q6J("ngIf",t.visible)}}const DT=["*",[["p-header"]],[["p-footer"]]],kT=["*","p-header","p-footer"],OT=(0,xe.oQ)([(0,xe.oB)({transform:"{{transform}}",opacity:0}),(0,xe.jt)("{{transition}}")]),NT=(0,xe.oQ)([(0,xe.jt)("{{transition}}",(0,xe.oB)({transform:"{{transform}}",opacity:0}))]);let VT=(()=>{class n{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(t){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(t){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(t){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;showHeader=!0;get breakpoint(){return 649}set breakpoint(t){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="-1";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(t){t&&(this._style={...t},this.originalStyle=t)}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onShow=new d.vpe;onHide=new d.vpe;visibleChange=new d.vpe;onResizeInit=new d.vpe;onResizeEnd=new d.vpe;onDragEnd=new d.vpe;onMaximize=new d.vpe;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy;documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=(0,mn.Th)();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;constructor(t,r,i,s,a,h,f){this.document=t,this.platformId=r,this.el=i,this.renderer=s,this.zone=a,this.cd=h,this.config=f,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":default:this.contentTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"maximizeicon":this.maximizeIconTemplate=t.template;break;case"minimizeicon":this.minimizeIconTemplate=t.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return null!==this.header?(0,mn.Th)()+"_header":null}focus(){let t=He.p.findSingle(this.container,"[autofocus]");t&&this.zone.runOutsideAngular(()=>{setTimeout(()=>t.focus(),5)})}close(t){this.visibleChange.emit(!1),t.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)})),this.modal&&He.p.blockBodyScroll()}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&He.p.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?He.p.blockBodyScroll():He.p.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(mn.P9.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if((0,v.NF)(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let r in this.breakpoints)t+=`\n                        @media screen and (max-width: ${r}) {\n                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {\n                                width: ${this.breakpoints[r]} !important;\n                            }\n                        }\n                    `;this.renderer.setProperty(this.styleElement,"innerHTML",t)}}initDrag(t){He.p.hasClass(t.target,"p-dialog-header-icon")||He.p.hasClass(t.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,this.container.style.margin="0",He.p.addClass(this.document.body,"p-unselectable-text"))}onKeydown(t){if(this.focusTrap&&9===t.which){t.preventDefault();let r=He.p.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let i=r.indexOf(r[0].ownerDocument.activeElement);t.shiftKey?-1==i||0===i?r[r.length-1].focus():r[i-1].focus():-1==i||i===r.length-1?r[0].focus():r[i+1].focus()}else r[0].focus()}}onDrag(t){if(this.dragging){const r=He.p.getOuterWidth(this.container),i=He.p.getOuterHeight(this.container),s=t.pageX-this.lastPageX,a=t.pageY-this.lastPageY,h=this.container.getBoundingClientRect(),f=getComputedStyle(this.container),m=parseFloat(f.marginLeft),g=parseFloat(f.marginTop),y=h.left+s-m,w=h.top+a-g,R=He.p.getViewport();this.container.style.position="fixed",this.keepInViewport?(y>=this.minX&&y+r<R.width&&(this._style.left=`${y}px`,this.lastPageX=t.pageX,this.container.style.left=`${y}px`),w>=this.minY&&w+i<R.height&&(this._style.top=`${w}px`,this.lastPageY=t.pageY,this.container.style.top=`${w}px`)):(this.lastPageX=t.pageX,this.container.style.left=`${y}px`,this.lastPageY=t.pageY,this.container.style.top=`${w}px`)}}endDrag(t){this.dragging&&(this.dragging=!1,He.p.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(t))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(t){this.resizable&&(this.resizing=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,He.p.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(t))}onResize(t){if(this.resizing){let r=t.pageX-this.lastPageX,i=t.pageY-this.lastPageY,s=He.p.getOuterWidth(this.container),a=He.p.getOuterHeight(this.container),h=He.p.getOuterHeight(this.contentViewChild?.nativeElement),f=s+r,m=a+i,g=this.container.style.minWidth,y=this.container.style.minHeight,w=this.container.getBoundingClientRect(),R=He.p.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(f+=r,m+=i),(!g||f>parseInt(g))&&w.left+f<R.width&&(this._style.width=f+"px",this.container.style.width=this._style.width),(!y||m>parseInt(y))&&w.top+m<R.height&&(this.contentViewChild.nativeElement.style.height=h+m-a+"px",this._style.height&&(this._style.height=m+"px",this.container.style.height=this._style.height)),this.lastPageX=t.pageX,this.lastPageY=t.pageY}}resizeEnd(t){this.resizing&&(this.resizing=!1,He.p.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(t))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",r=>{27==r.which&&this.close(r)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?this.renderer.appendChild(this.document.body,this.wrapper):He.p.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&He.p.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&He.p.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(t){switch(t.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(He.p.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&He.p.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&mn.P9.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(r){return new(r||n)(d.Y36(v.K0),d.Y36(d.Lbi),d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(d.R0b),d.Y36(d.sBO),d.Y36(k.b4))};static \u0275cmp=d.Xpm({type:n,selectors:[["p-dialog"]],contentQueries:function(r,i,s){if(1&r&&(d.Suo(s,k.h4,5),d.Suo(s,k.$_,5),d.Suo(s,k.jx,4)),2&r){let a;d.iGM(a=d.CRH())&&(i.headerFacet=a.first),d.iGM(a=d.CRH())&&(i.footerFacet=a.first),d.iGM(a=d.CRH())&&(i.templates=a)}},viewQuery:function(r,i){if(1&r&&(d.Gf(HI,5),d.Gf(KI,5),d.Gf(QI,5)),2&r){let s;d.iGM(s=d.CRH())&&(i.headerViewChild=s.first),d.iGM(s=d.CRH())&&(i.contentViewChild=s.first),d.iGM(s=d.CRH())&&(i.footerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:kT,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""]],template:function(r,i){1&r&&(d.F$t(DT),d.YNc(0,xT,2,15,"div",0)),2&r&&d.Q6J("ngIf",i.maskVisible)},dependencies:()=>[v.mk,v.O5,v.tP,v.PC,jI,Bl.H,Ul.q,$_,H_],styles:["@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}\n"],encapsulation:2,data:{animation:[(0,xe.X$)("animation",[(0,xe.eR)("void => visible",[(0,xe._7)(OT)]),(0,xe.eR)("visible => void",[(0,xe._7)(NT)])])]},changeDetection:0})}return n})(),MT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({imports:[v.ez,$I,Bl.T,Ul.q,$_,H_,k.m8]})}return n})();var Md=H(7509);function LT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",7),d.NdJ("click",function(){d.CHM(t);const i=d.oxw();return d.KtG(i.onStageClick())}),d.TgZ(1,"span",8),d._uU(2),d.qZA()()}if(2&n){const t=d.oxw();d.xp6(2),d.hij(" ",t.stageLevel.value," ")}}function FT(n,e){if(1&n&&d._uU(0),2&n){const t=d.oxw();d.hij(" ",t.stageLevel.value," ")}}function UT(n,e){1&n&&(d.TgZ(0,"span",11),d._UZ(1,"i",12),d.qZA())}function BT(n,e){if(1&n&&(d.TgZ(0,"div",9),d.YNc(1,UT,2,0,"span",10),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.Q6J("ngForOf",t.stars)}}function zT(n,e){1&n&&(d.TgZ(0,"span",14),d._UZ(1,"i",12),d.qZA())}function GT(n,e){if(1&n){const t=d.EpF();d.TgZ(0,"div",7),d.NdJ("click",function(){d.CHM(t);const i=d.oxw(2);return d.KtG(i.onStageClick())}),d.YNc(1,zT,2,0,"span",13),d.qZA()}if(2&n){const t=d.oxw(2);d.xp6(1),d.Q6J("ngForOf",t.stars)}}function qT(n,e){1&n&&(d.TgZ(0,"span",16),d._UZ(1,"i",17),d.qZA())}function ZT(n,e){if(1&n&&d.YNc(0,qT,2,0,"span",15),2&n){const t=d.oxw(2);d.Q6J("ngForOf",t.stars)}}function WT(n,e){if(1&n&&(d.TgZ(0,"div",9),d.YNc(1,GT,2,1,"div",2)(2,ZT,1,1,"ng-template",null,4,d.W1O),d.qZA()),2&n){const t=d.MAs(3),r=d.oxw();d.xp6(1),d.Q6J("ngIf",r.stageLevel.completed)("ngIfElse",t)}}const jT=(n,e)=>({"stage-level-number-unselected":n,"stage-level-number-selected":e});let $T=(()=>{class n{constructor(t){this.stageCommunicationService=t,this.stars=new Array(1,2,3)}onStageClick(){this.stageCommunicationService.updatePerformedItem(this.stageLevel),console.log("Stage Clicked")}static#e=this.\u0275fac=function(r){return new(r||n)(d.Y36(W_))};static#t=this.\u0275cmp=d.Xpm({type:n,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:9,vars:8,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[3,"click",4,"ngIf","ngIfElse"],["class","disable-stage-click"],["NOT_COMPLETED",""],["style","display: flex; justify-content: center;",4,"ngIf","ngIfElse"],["STAGE_LEVEL_NOT_SELECTED",""],[3,"click"],[1,"stage-level-completed-value","enable-stage-click"],[2,"display","flex","justify-content","center"],["class","stage-level-asterisk-selected",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],["class","stage-level-asterisk-unselected stage-level-completed enable-stage-click",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-unselected","stage-level-completed","enable-stage-click"],["class","stage-level-asterisk-unselected disable-stage-click",4,"ngFor","ngForOf"],[1,"stage-level-asterisk-unselected","disable-stage-click"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(r,i){if(1&r&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,LT,3,1,"div",2)(3,FT,1,1,"ng-template",3,4,d.W1O),d.qZA(),d.TgZ(5,"div"),d.YNc(6,BT,2,1,"div",5)(7,WT,4,2,"ng-template",null,6,d.W1O),d.qZA()()),2&r){const s=d.MAs(4),a=d.MAs(8);d.xp6(1),d.Q6J("ngClass",d.WLB(5,jT,!i.stageLevel.selected,i.stageLevel.selected)),d.xp6(1),d.Q6J("ngIf",i.stageLevel.completed)("ngIfElse",s),d.xp6(4),d.Q6J("ngIf",i.stageLevel.selected)("ngIfElse",a)}},dependencies:[v.mk,v.sg,v.O5,Md.oO],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .enable-stage-click[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.stage-level-layout[_ngcontent-%COMP%]   .disable-stage-click[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]})}return n})();function HT(n,e){1&n&&(d.TgZ(0,"div")(1,"span",3),d._uU(2,"No stage levels defined!"),d.qZA()())}const KT=n=>({"border-bottom":n});function QT(n,e){if(1&n&&(d.TgZ(0,"div",6),d._UZ(1,"app-stage-level",7),d.qZA()),2&n){const t=e.$implicit;d.Q6J("ngStyle",d.VKq(2,KT,t.selected?"none":"1px solid #d4d4d4")),d.xp6(1),d.Q6J("stageLevel",t)}}function YT(n,e){if(1&n&&(d.TgZ(0,"div",4),d.YNc(1,QT,2,4,"div",5),d.qZA()),2&n){const t=d.oxw();d.xp6(1),d.Q6J("ngForOf",t.stageLevels)}}let JT=(()=>{class n{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=d.Xpm({type:n,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:4,vars:2,consts:[[1,"game-stage-level-layout"],[4,"ngIf","ngIfElse"],["HAS_STAGE_LEVELS",""],[1,"warning-message"],[1,"stage-levels"],["class","stage-level",3,"ngStyle",4,"ngFor","ngForOf"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(r,i){if(1&r&&(d.TgZ(0,"div",0),d.YNc(1,HT,3,0,"div",1)(2,YT,2,1,"ng-template",null,2,d.W1O),d.qZA()),2&r){const s=d.MAs(3);d.xp6(1),d.Q6J("ngIf",i.NO_STAGE_LEVELS)("ngIfElse",s)}},dependencies:[v.sg,v.O5,v.PC,Md.Zl,$T],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]})}return n})();class K_{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}}class Q_{constructor(e,t,r){this.operands=e,this.operator=t,this.result=r}}const XT=(0,xe.X$)("operandButtonAnimationMove",[(0,xe.SB)("buttonFromA",(0,xe.oB)({left:"{{ posALeft }}",top:"{{ posATop }}",width:"90px",height:"90px"}),{params:{posALeft:"1025px",posATop:"219px"}}),(0,xe.SB)("buttonToB",(0,xe.oB)({left:"{{ posBLeft }}",top:"{{ posBTop }}",width:"90px",height:"90px"}),{params:{posBLeft:"805px",posBTop:"324px"}}),(0,xe.eR)("* => buttonToB",(0,xe.jt)("1.5s"))]);var $p=H(617),eE=H(6593);const tE=n=>({"background-color":n});function nE(n,e){if(1&n){const t=d.EpF();d.ynx(0),d.TgZ(1,"button",9),d.NdJ("click",function(){const s=d.CHM(t).$implicit,a=d.oxw();return d.KtG(a.onOperandButtonClick(s))}),d._uU(2),d.qZA(),d.BQk()}if(2&n){const t=e.$implicit;d.xp6(1),d.Q6J("disabled",t.disabled)("ngStyle",d.VKq(4,tE,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",t.disabled||t.selected?"operator-content-button-disabled":"operator-content-button"),d.xp6(1),d.hij("",t.value," ")}}function rE(n,e){if(1&n){const t=d.EpF();d.ynx(0),d.TgZ(1,"button",10),d.NdJ("click",function(){const s=d.CHM(t).$implicit,a=d.oxw();return d.KtG(a.onOperatorButtonClick(s))}),d._UZ(2,"mat-icon",11),d.qZA(),d.BQk()}if(2&n){const t=e.$implicit,r=e.index;d.xp6(1),d.Q6J("ngClass",0===r?"revert-button":"arithmetic-operation-button"),d.xp6(1),d.s9C("svgIcon",t.icon)}}let iE=(()=>{class n{constructor(t,r){this.githubLogoPath="assets/logos/GitHub-Mark-32px.png",this.operators=new Array({selected:!1,caption:te.OPERATOR_REV,operator:te.OPERATOR_REV,icon:"revert"},{selected:!1,caption:te.OPERATOR_ADD,operator:te.OPERATOR_ADD,icon:"addition"},{selected:!1,caption:te.OPERATOR_SUB,operator:te.OPERATOR_SUB,icon:"substraction"},{selected:!1,caption:te.OPERATOR_MUL,operator:te.OPERATOR_MUL,icon:"multiplication"},{selected:!1,caption:te.OPERATOR_DIV,operator:te.OPERATOR_DIV,icon:"division"}),this.onExpectedResultReached=new d.vpe,this.onInvalidOperationExecuted=new d.vpe,t.addSvgIcon("revert",r.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),t.addSvgIcon("addition",r.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),t.addSvgIcon("substraction",r.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),t.addSvgIcon("multiplication",r.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),t.addSvgIcon("division",r.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(t=>t.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(t=>{t.selected=!1})}isTheExpectedResultReached(t){return this.gameParameters.result===t}addStateToHistory(t){this.history.push(t)}clearSelectionOfOperators(){this.operators.forEach(t=>{t.selected=!1})}addGameOperationToOperationHistory(t){this.operationHistory?.push(t)}captureAnimationTriggerStartEvent(t){console.log("Animation trigger start ",t)}captureAnimationTriggerDoneEvent(t){console.log("Animation trigger done ",t)}ngOnInit(){this.history=new K_,this.operationHistory=new K_}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(t=>{t.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(t){if(t.selected=!t.selected,!t.selected){if(this.selectedOperandB&&this.selectedOperandB.id===t.id)return this.selectedOperandB.selected=!1,void(this.selectedOperandB=null);if(this.selectedOperandA&&this.selectedOperandA.id===t.id)return this.selectedOperandA.selected=!1,void(this.selectedOperandA=null)}this.selectedOperandA?this.selectedOperandA.id!==t.id&&(this.selectedOperandB||(this.selectedOperandB=t)):this.selectedOperandA=t;var r=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!r)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&r){let i=Ye.cloneGameParameters(this.gameParameters),s=Ye.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,r.operator);if(this.addStateToHistory(i),s===Number.MIN_VALUE)this.onInvalidOperationExecuted.emit(s);else{let a=new Array(this.selectedOperandA.value,this.selectedOperandB.value),h=new Q_(a,r.operator,s);this.addGameOperationToOperationHistory(h),this.isTheExpectedResultReached(s)&&this.onExpectedResultReached.emit(this.operationHistory),t.value=s,this.gameParameters.operands.find(m=>m.id==this.selectedOperandA.id).disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${t.value} Selected ${t.selected}`)}onOperatorButtonClick(t){if(this.selectedOperandA||t.operator===te.OPERATOR_REV){if(t.selected=!t.selected,t.operator===te.OPERATOR_REV){this.revertLastOperation();let r=Ye.cloneGameParameters(this.gameParameters),i=new Array;r.operands.forEach(a=>{i.push(a.value)});let s=new Q_(i,t.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(s)}console.log(`Caption ${t.caption} Selected ${t.selected}`)}else t.selected=!1}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}static#e=this.\u0275fac=function(r){return new(r||n)(d.Y36($p.jv),d.Y36(eE.H7))};static#t=this.\u0275cmp=d.Xpm({type:n,selectors:[["app-game-arithmetic-operations"]],hostVars:1,hostBindings:function(r,i){1&r&&d.WFA("@operandButtonAnimationMove.start",function(a){return i.captureAnimationTriggerStartEvent(a)})("@operandButtonAnimationMove.done",function(a){return i.captureAnimationTriggerDoneEvent(a)}),2&r&&d.d8E("@operandButtonAnimationMove",i.operandButtonAnimation)},inputs:{gameParameters:"gameParameters"},outputs:{onExpectedResultReached:"onExpectedResultReached",onInvalidOperationExecuted:"onInvalidOperationExecuted"},decls:13,vars:4,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],[4,"ngFor","ngForOf"],[1,"operators-container"],["href","https://github.com/lkovari/LKovariHome/tree/master/src/app/digits/digits-game.component.ts"],["width","16","height","16",3,"src"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass","click"],["type","button",1,"operator-content",3,"ngClass","click"],[1,"operator-content-icon",3,"svgIcon"]],template:function(r,i){1&r&&(d.TgZ(0,"div",0)(1,"div",1),d._uU(2,"Use the any combination of number to reach the target:"),d.qZA(),d.TgZ(3,"div")(4,"label",2),d._uU(5),d.qZA()(),d.TgZ(6,"div",3)(7,"div",4),d.YNc(8,nE,3,6,"ng-container",5),d.qZA()(),d.TgZ(9,"div",6),d.YNc(10,rE,3,2,"ng-container",5),d.qZA(),d.TgZ(11,"a",7),d._UZ(12,"img",8),d.qZA()()),2&r&&(d.xp6(5),d.Oqu(i.gameParameters.result),d.xp6(3),d.Q6J("ngForOf",i.gameParameters.operands),d.xp6(2),d.Q6J("ngForOf",i.operators),d.xp6(2),d.Q6J("src",i.githubLogoPath,d.LSH))},dependencies:[v.mk,v.sg,v.PC,Md.oO,Md.Zl,$p.Hw],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{justify-content:center;display:flex;flex-direction:row;flex-wrap:wrap;width:371px;margin:7px auto}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"],data:{animation:[XT]}})}return n})();const sE=["arithmeticOperations"];function oE(n,e){if(1&n&&(d.TgZ(0,"li",15),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.xp6(1),d.hij(" ",t," ")}}function aE(n,e){if(1&n&&(d.TgZ(0,"li",15),d._uU(1),d.qZA()),2&n){const t=e.$implicit;d.xp6(1),d.hij(" ",t," ")}}const cE=[{path:"digits/digits-game",component:(()=>{class n{constructor(t,r,i,s,a){this.messageService=t,this.cookieService=r,this.clipboardService=i,this.numbersFirestoreService=s,this.stageCommunicationService=a,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new ze,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw",this.updateStageLevel=this.stageCommunicationService.getUpdatedStageLevel().subscribe({next:h=>{console.log("StageLevel updated "+h.index)},error:h=>console.error("StageLevel updated "+h),complete:()=>console.info("StageLevel updated Complete")})}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(t){let r="Completed! Executed Operations:\n",i=t.size()-1;for(;i>=0;){const s=t.peekBy(i);r+=i+1+". "+s?.operands[0]+" "+s?.operator+" "+s?.operands[1]+" = "+s?.result+"\n",--i}return r}createSummaryOfTHeOperations(t,r){let i=this.stageLevels[t].value+" -> ";for(this.gameCompletedModalMessages=[];r.size()>0;){const s=r.pop();this.gameCompletedModalMessages.push(s?.operands[0]+" "+s.operator+" "+s?.operands[1]+" = "+s?.result),i+=""+s?.operator}return i+="\n",i}showSuccessMessage(t){this.messageService.add({severity:"success",summary:"Congratulation!",detail:t})}showErrorMessage(t){this.messageService.add({severity:"error",summary:"Error!",detail:t})}setupStages(){let t=0;this.gameParameters.forEach(r=>{this.stageLevels[t].value=r.result,++t})}storeGameStateToCookie(){let t=new B;t.storeDate=new Date,t.stageIndex=this.stageIndex,t.stageLevels=this.stageLevels,t.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,t.gameParameters=this.gameParameters;let r=t.cookieData2Text(),i=new Date;i.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,r,i)}restoreGameStateFromCookie(){let r,t=this.cookieService.get(this.COOKIE_LK_DIGITS);return t&&""!=t?(r=new B,r=r.text2CookieData(t)):(console.log("INFO: Unable to retrieve the Game State"),r=null),r}mapPuzzleDataToGameParameters(t){t.stages.forEach(r=>{let i=this.gameParameters.find(s=>s.stageIndex===r.stageIndex);if(i){i.result=r.expectedValue;let s=0;i.operands.forEach(h=>{h.value=r.operands[s],s++}),this.initializeStageLevels(),this.stageLevels.find(h=>h.index===r.stageIndex)}})}mapGameParametersToPuzzleData(t){let r=new ke;return r.day=new Date,r.day.setHours(23,59,59,999),t.forEach(i=>{let s=new xt;s.stageIndex=i.stageIndex,s.expectedValue=i.result;let a=new Array;i.operands.forEach(h=>{a.push(h.value)}),s.operands=a,r.stages.push(s)}),r}isDateSame(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}updatePuzzleDataInDb(t){this.firestorePuzzleData.data=JSON.stringify(t),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(r=>console.log(r))}createPuzzleDataInDb(t){this.numbersFirestoreService.create(t).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){let t=navigator.language;return void 0!==this.firestorePuzzleDataItems.find(i=>i.locale===t)}upsertGameDataInDb(t){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(t);else{const r=new Me;r.locale=navigator.language,r.data=JSON.stringify(t),this.createPuzzleDataInDb(r)}}allGameCompleted(){let t=!0;return this.stageLevels.forEach(r=>{t=t&&r.completed}),t}collectAllOperations(){let t=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(t){let r="Genius!\n";this.allGameCompletedModalMessage=[],this.stageLevels.forEach(i=>{r+=i.summary,this.allGameCompletedModalMessage.push(i.summary)}),this.clipboardService.copy(r),this.storeGameStateToCookie(),this.allGameCompletedModalVisible=!0}return t}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let t=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(t)}ngOnInit(){console.log(`Browser locale: ${navigator.language}`),this.initializeStageLevels();let t=this.restoreGameStateFromCookie();if(t){console.log("INFO: Game state restored from cookie");const r=new Date(t.storeDate);if(this.isDateSame(r,new Date))this.stageIndex=t.stageIndex,this.stageLevels=t.stageLevels,this.gameParameters=t.gameParameters,this.setupStages(),t.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let i=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+i),this.upsertGameDataInDb(i)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();let r=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe((0,ae.U)(i=>i.map(s=>({id:s.payload.doc.id,...s.payload.doc.data()})))).subscribe(i=>{this.firestorePuzzleDataItems=i;let s=i.find(a=>a.locale===r);if(s){this.firestorePuzzleData=s,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");const a=new Date,h=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(h,a))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let f=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(f)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let a=this.mapGameParametersToPuzzleData(this.gameParameters);const h=new Me;h.locale=navigator.language,h.data=JSON.stringify(a),this.createPuzzleDataInDb(h)}})}}ngOnDestroy(){this.updateStageLevel.unsubscribe()}onExpectedResultReached(t){const r=this.formatOperations(t),i=this.createSummaryOfTHeOperations(this.stageIndex,t);this.stageLevels[this.stageIndex].summary=i,this.clipboardService.copy(r),this.showSuccessMessage("You are reach the expected result!"),this.stageToCompleted(),this.reachedValue=this.gameParameters[this.stageIndex].result,this.gameCompletedModalVisible=!0}onHideGameCompletedDialog(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}onInvalidOperationExecuted(t){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(t)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}static#e=this.\u0275fac=function(r){return new(r||n)(d.Y36(k.ez),d.Y36(ie),d.Y36(Dt),d.Y36(Z_),d.Y36(W_))};static#t=this.\u0275cmp=d.Xpm({type:n,selectors:[["app-digits-game"]],viewQuery:function(r,i){if(1&r&&d.Gf(sE,7),2&r){let s;d.iGM(s=d.CRH())&&(i.arithmeticComponent=s.first)}},features:[d._Bn([k.ez,ie])],decls:29,vars:16,consts:[[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"gameParameters","onExpectedResultReached","onInvalidOperationExecuted"],["arithmeticOperations",""],["id","splashscreen","header","Welcome to the Numbers Puzzle Game",3,"visible","modal","visibleChange"],["id","gameCompleted","header","Game Completed",3,"visible","modal","visibleChange","onHide"],["class","li-no-bullet",4,"ngFor","ngForOf"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visible","modal","closable","visibleChange"],[1,"li-no-bullet"]],template:function(r,i){1&r&&(d.TgZ(0,"div",0),d._UZ(1,"p-toast",1),d.TgZ(2,"div",2),d._uU(3," This is a daily numbers puzzle, similar to the "),d.TgZ(4,"a",3),d._uU(5,"NY Times Digits"),d.qZA(),d._uU(6,", which unfortunately discontinued at August 8, 2023 "),d.qZA(),d.TgZ(7,"div",4)(8,"div",5),d.NdJ("click",function(){return i.onDeleteCookie()}),d._uU(9," Numbers "),d.qZA(),d.TgZ(10,"div",6),d.NdJ("click",function(){return i.onUpdatePuzzleData()}),d._uU(11),d.ALo(12,"date"),d.qZA()(),d.TgZ(13,"div",7),d._UZ(14,"app-game-stage-levels",8),d.qZA(),d.TgZ(15,"div")(16,"app-game-arithmetic-operations",9,10),d.NdJ("onExpectedResultReached",function(a){return i.onExpectedResultReached(a)})("onInvalidOperationExecuted",function(a){return i.onInvalidOperationExecuted(a)}),d.qZA()()(),d.TgZ(18,"p-dialog",11),d.NdJ("visibleChange",function(a){return i.splashVisible=a}),d.TgZ(19,"p"),d._uU(20,"It can improves your arithmetic combination ability."),d.qZA()(),d.TgZ(21,"p-dialog",12),d.NdJ("visibleChange",function(a){return i.gameCompletedModalVisible=a})("onHide",function(){return i.onHideGameCompletedDialog()}),d.TgZ(22,"div"),d._uU(23),d.YNc(24,oE,2,1,"li",13),d.qZA()(),d.TgZ(25,"p-dialog",14),d.NdJ("visibleChange",function(a){return i.allGameCompletedModalVisible=a}),d.TgZ(26,"div"),d._uU(27," Congratulation! Your Solutions: "),d.YNc(28,aE,2,1,"li",13),d.qZA()()),2&r&&(d.xp6(11),d.hij(" ",d.xi3(12,13,i.currentDate,"MM/dd/yyyy")," "),d.xp6(3),d.Q6J("stageLevels",i.stageLevels),d.xp6(2),d.Q6J("gameParameters",i.gameParameters[i.stageIndex]),d.xp6(2),d.Q6J("visible",i.splashVisible)("modal",!0),d.xp6(3),d.Q6J("visible",i.gameCompletedModalVisible)("modal",!0),d.xp6(2),d.hij(" Target ",i.reachedValue,". Your solution: "),d.xp6(1),d.Q6J("ngForOf",i.gameCompletedModalMessages),d.xp6(1),d.Q6J("visible",i.allGameCompletedModalVisible)("modal",!0)("closable",!1),d.xp6(3),d.Q6J("ngForOf",i.allGameCompletedModalMessage))},dependencies:[v.sg,ZI,VT,JT,iE,v.uU],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:50vw;position:absolute;inset:0;margin:auto;background:rgba(235,249,253,.25);border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:90vh;width:99vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}.digits-game-layout[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]})}return n})()}];let lE=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=d.oAB({type:n});static#n=this.\u0275inj=d.cJS({imports:[v.ez,fe.Bz.forChild(cE),fe.Bz]})}return n})();var uE=H(1447);let RE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=d.oAB({type:n});static \u0275inj=d.cJS({imports:[v.ez,Bl.T,qp,Wp,jp,Zp,Ul.q]})}return n})();var PE=H(553);let xE=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=d.oAB({type:n});static#n=this.\u0275inj=d.cJS({providers:[Z_],imports:[v.ez,fe.Bz,WI,RE,lE,uE.o9,$p.Ps,Le,ci.initializeApp(PE.N.firebasePuzzleData),CI,MT]})}return n})()},3106:(no,Kt,H)=>{H.d(Kt,{Z:()=>xt});var v=H(9058),fe=H(4537),k=H(534),te=H(7879);class Ut{constructor(ve,Ie){this._delegate=ve,this.firebase=Ie,(0,k._addComponent)(ve,new fe.wA("app-compat",()=>this,"PUBLIC")),this.container=ve.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ve){this._delegate.automaticDataCollectionEnabled=ve}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ve=>{this._delegate.checkDestroyed(),ve()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(ve,Ie=k._DEFAULT_ENTRY_NAME){var Dt;this._delegate.checkDestroyed();const on=this._delegate.container.getProvider(ve);return!on.isInitialized()&&"EXPLICIT"===(null===(Dt=on.getComponent())||void 0===Dt?void 0:Dt.instantiationMode)&&on.initialize(),on.getImmediate({identifier:Ie})}_removeServiceInstance(ve,Ie=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ve).clearInstance(Ie)}_addComponent(ve){(0,k._addComponent)(this._delegate,ve)}_addOrOverwriteComponent(ve){(0,k._addOrOverwriteComponent)(this._delegate,ve)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Ye=new v.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),B=function ze(){const Me=function wn(Me){const ve={},Ie={__esModule:!0,initializeApp:function Et(Ee,wt={}){const M=k.initializeApp(Ee,wt);if((0,v.r3)(ve,M.name))return ve[M.name];const Je=new Me(M,Ie);return ve[M.name]=Je,Je},app:on,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function Pe(Ee){const wt=Ee.name,M=wt.replace("-compat","");if(k._registerComponent(Ee)&&"PUBLIC"===Ee.type){const Je=(nt=on())=>{if("function"!=typeof nt[M])throw Ye.create("invalid-app-argument",{appName:wt});return nt[M]()};void 0!==Ee.serviceProps&&(0,v.ZB)(Je,Ee.serviceProps),Ie[M]=Je,Me.prototype[M]=function(...nt){return this._getService.bind(this,wt).apply(this,Ee.multipleInstances?nt:[])}}return"PUBLIC"===Ee.type?Ie[M]:null},removeApp:function Dt(Ee){delete ve[Ee]},useAsService:function Sr(Ee,wt){return"serverAuth"===wt?null:wt},modularAPIs:k}};function on(Ee){if(!(0,v.r3)(ve,Ee=Ee||k._DEFAULT_ENTRY_NAME))throw Ye.create("no-app",{appName:Ee});return ve[Ee]}return Ie.default=Ie,Object.defineProperty(Ie,"apps",{get:function Le(){return Object.keys(ve).map(Ee=>ve[Ee])}}),on.App=Me,Ie}(Ut);return Me.INTERNAL=Object.assign(Object.assign({},Me.INTERNAL),{createFirebaseNamespace:ze,extendNamespace:function ve(Ie){(0,v.ZB)(Me,Ie)},createSubscribe:v.ne,ErrorFactory:v.LL,deepExtend:v.ZB}),Me}(),d=new te.Yd("@firebase/app-compat");if((0,v.jU)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Me=self.firebase.SDK_VERSION;Me&&Me.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const xt=B;!function ke(Me){(0,k.registerVersion)("@firebase/app-compat","0.2.25",Me)}()},534:(no,Kt,H)=>{H.r(Kt),H.d(Kt,{FirebaseError:()=>te.ZR,SDK_VERSION:()=>Xi,_DEFAULT_ENTRY_NAME:()=>gn,_addComponent:()=>_n,_addOrOverwriteComponent:()=>Sn,_apps:()=>Bt,_clearComponents:()=>Rn,_components:()=>cn,_getProvider:()=>ar,_registerComponent:()=>Or,_removeServiceInstance:()=>ci,deleteApp:()=>Hn,getApp:()=>li,getApps:()=>yn,initializeApp:()=>Pn,onLog:()=>ui,registerVersion:()=>Kn,setLogLevel:()=>ro});var v=H(5861),fe=H(4537),k=H(7879),te=H(9058);const Ut=(I,P)=>P.some(L=>I instanceof L);let Tt,Ye;const B=new WeakMap,d=new WeakMap,ie=new WeakMap,ae=new WeakMap,ke=new WeakMap;let ve={get(I,P,L){if(I instanceof IDBTransaction){if("done"===P)return d.get(I);if("objectStoreNames"===P)return I.objectStoreNames||ie.get(I);if("store"===P)return L.objectStoreNames[1]?void 0:L.objectStore(L.objectStoreNames[0])}return Et(I[P])},set:(I,P,L)=>(I[P]=L,!0),has:(I,P)=>I instanceof IDBTransaction&&("done"===P||"store"===P)||P in I};function on(I){return"function"==typeof I?function Dt(I){return I!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ze(){return Ye||(Ye=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(I)?function(...P){return I.apply(Le(this),P),Et(B.get(this))}:function(...P){return Et(I.apply(Le(this),P))}:function(P,...L){const Z=I.call(Le(this),P,...L);return ie.set(Z,P.sort?P.sort():[P]),Et(Z)}}(I):(I instanceof IDBTransaction&&function Me(I){if(d.has(I))return;const P=new Promise((L,Z)=>{const he=()=>{I.removeEventListener("complete",de),I.removeEventListener("error",F),I.removeEventListener("abort",F)},de=()=>{L(),he()},F=()=>{Z(I.error||new DOMException("AbortError","AbortError")),he()};I.addEventListener("complete",de),I.addEventListener("error",F),I.addEventListener("abort",F)});d.set(I,P)}(I),Ut(I,function wn(){return Tt||(Tt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(I,ve):I)}function Et(I){if(I instanceof IDBRequest)return function xt(I){const P=new Promise((L,Z)=>{const he=()=>{I.removeEventListener("success",de),I.removeEventListener("error",F)},de=()=>{L(Et(I.result)),he()},F=()=>{Z(I.error),he()};I.addEventListener("success",de),I.addEventListener("error",F)});return P.then(L=>{L instanceof IDBCursor&&B.set(L,I)}).catch(()=>{}),ke.set(P,I),P}(I);if(ae.has(I))return ae.get(I);const P=on(I);return P!==I&&(ae.set(I,P),ke.set(P,I)),P}const Le=I=>ke.get(I),Ee=["get","getKey","getAll","getAllKeys","count"],wt=["put","add","delete","clear"],M=new Map;function Je(I,P){if(!(I instanceof IDBDatabase)||P in I||"string"!=typeof P)return;if(M.get(P))return M.get(P);const L=P.replace(/FromIndex$/,""),Z=P!==L,he=wt.includes(L);if(!(L in(Z?IDBIndex:IDBObjectStore).prototype)||!he&&!Ee.includes(L))return;const de=function(){var F=(0,v.Z)(function*(et,...ee){const un=this.transaction(et,he?"readwrite":"readonly");let Dn=un.store;return Z&&(Dn=Dn.index(ee.shift())),(yield Promise.all([Dn[L](...ee),he&&un.done]))[0]});return function(ee){return F.apply(this,arguments)}}();return M.set(P,de),de}!function Ie(I){ve=I(ve)}(I=>({...I,get:(P,L,Z)=>Je(P,L)||I.get(P,L,Z),has:(P,L)=>!!Je(P,L)||I.has(P,L)}));class nt{constructor(P){this.container=P}getPlatformInfoString(){return this.container.getProviders().map(L=>{if(function An(I){const P=I.getComponent();return"VERSION"===P?.type}(L)){const Z=L.getImmediate();return`${Z.library}/${Z.version}`}return null}).filter(L=>L).join(" ")}}const Rr="@firebase/app",bn=new k.Yd("@firebase/app"),gn="[DEFAULT]",Ji={[Rr]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Bt=new Map,cn=new Map;function _n(I,P){try{I.container.addComponent(P)}catch(L){bn.debug(`Component ${P.name} failed to register with FirebaseApp ${I.name}`,L)}}function Sn(I,P){I.container.addOrOverwriteComponent(P)}function Or(I){const P=I.name;if(cn.has(P))return bn.debug(`There were multiple attempts to register component ${P}.`),!1;cn.set(P,I);for(const L of Bt.values())_n(L,I);return!0}function ar(I,P){const L=I.container.getProvider("heartbeat").getImmediate({optional:!0});return L&&L.triggerHeartbeat(),I.container.getProvider(P)}function ci(I,P,L=gn){ar(I,P).clearInstance(L)}function Rn(){cn.clear()}const ln=new te.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Jt{constructor(P,L,Z){this._isDeleted=!1,this._options=Object.assign({},P),this._config=Object.assign({},L),this._name=L.name,this._automaticDataCollectionEnabled=L.automaticDataCollectionEnabled,this._container=Z,this.container.addComponent(new fe.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(P){this.checkDestroyed(),this._automaticDataCollectionEnabled=P}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(P){this._isDeleted=P}checkDestroyed(){if(this.isDeleted)throw ln.create("app-deleted",{appName:this._name})}}const Xi="10.7.1";function Pn(I,P={}){let L=I;"object"!=typeof P&&(P={name:P});const Z=Object.assign({name:gn,automaticDataCollectionEnabled:!1},P),he=Z.name;if("string"!=typeof he||!he)throw ln.create("bad-app-name",{appName:String(he)});if(L||(L=(0,te.aH)()),!L)throw ln.create("no-options");const de=Bt.get(he);if(de){if((0,te.vZ)(L,de.options)&&(0,te.vZ)(Z,de.config))return de;throw ln.create("duplicate-app",{appName:he})}const F=new fe.H0(he);for(const ee of cn.values())F.addComponent(ee);const et=new Jt(L,Z,F);return Bt.set(he,et),et}function li(I=gn){const P=Bt.get(I);if(!P&&I===gn&&(0,te.aH)())return Pn();if(!P)throw ln.create("no-app",{appName:I});return P}function yn(){return Array.from(Bt.values())}function Hn(I){return At.apply(this,arguments)}function At(){return(At=(0,v.Z)(function*(I){const P=I.name;Bt.has(P)&&(Bt.delete(P),yield Promise.all(I.container.getProviders().map(L=>L.delete())),I.isDeleted=!0)})).apply(this,arguments)}function Kn(I,P,L){var Z;let he=null!==(Z=Ji[I])&&void 0!==Z?Z:I;L&&(he+=`-${L}`);const de=he.match(/\s|\//),F=P.match(/\s|\//);if(de||F){const et=[`Unable to register library "${he}" with version "${P}":`];return de&&et.push(`library name "${he}" contains illegal characters (whitespace or "/")`),de&&F&&et.push("and"),F&&et.push(`version name "${P}" contains illegal characters (whitespace or "/")`),void bn.warn(et.join(" "))}Or(new fe.wA(`${he}-version`,()=>({library:he,version:P}),"VERSION"))}function ui(I,P){if(null!==I&&"function"!=typeof I)throw ln.create("invalid-log-argument");(0,k.Am)(I,P)}function ro(I){(0,k.Ub)(I)}const di="firebase-heartbeat-database",Vr=1,A="firebase-heartbeat-store";let E=null;function b(){return E||(E=function Pe(I,P,{blocked:L,upgrade:Z,blocking:he,terminated:de}={}){const F=indexedDB.open(I,P),et=Et(F);return Z&&F.addEventListener("upgradeneeded",ee=>{Z(Et(F.result),ee.oldVersion,ee.newVersion,Et(F.transaction),ee)}),L&&F.addEventListener("blocked",ee=>L(ee.oldVersion,ee.newVersion,ee)),et.then(ee=>{de&&ee.addEventListener("close",()=>de()),he&&ee.addEventListener("versionchange",un=>he(un.oldVersion,un.newVersion,un))}).catch(()=>{}),et}(di,Vr,{upgrade:(I,P)=>{0===P&&I.createObjectStore(A)}}).catch(I=>{throw ln.create("idb-open",{originalErrorMessage:I.message})})),E}function x(){return(x=(0,v.Z)(function*(I){try{return yield(yield b()).transaction(A).objectStore(A).get(ge(I))}catch(P){if(P instanceof te.ZR)bn.warn(P.message);else{const L=ln.create("idb-get",{originalErrorMessage:P?.message});bn.warn(L.message)}}})).apply(this,arguments)}function Q(I,P){return ue.apply(this,arguments)}function ue(){return(ue=(0,v.Z)(function*(I,P){try{const Z=(yield b()).transaction(A,"readwrite");yield Z.objectStore(A).put(P,ge(I)),yield Z.done}catch(L){if(L instanceof te.ZR)bn.warn(L.message);else{const Z=ln.create("idb-set",{originalErrorMessage:L?.message});bn.warn(Z.message)}}})).apply(this,arguments)}function ge(I){return`${I.name}!${I.options.appId}`}class rt{constructor(P){this.container=P,this._heartbeatsCache=null;const L=this.container.getProvider("app").getImmediate();this._storage=new vn(L),this._heartbeatsCachePromise=this._storage.read().then(Z=>(this._heartbeatsCache=Z,Z))}triggerHeartbeat(){var P=this;return(0,v.Z)(function*(){var L,Z;const de=P.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),F=ye();if((null!=(null===(L=P._heartbeatsCache)||void 0===L?void 0:L.heartbeats)||(P._heartbeatsCache=yield P._heartbeatsCachePromise,null!=(null===(Z=P._heartbeatsCache)||void 0===Z?void 0:Z.heartbeats)))&&P._heartbeatsCache.lastSentHeartbeatDate!==F&&!P._heartbeatsCache.heartbeats.some(et=>et.date===F))return P._heartbeatsCache.heartbeats.push({date:F,agent:de}),P._heartbeatsCache.heartbeats=P._heartbeatsCache.heartbeats.filter(et=>{const ee=new Date(et.date).valueOf();return Date.now()-ee<=2592e6}),P._storage.overwrite(P._heartbeatsCache)})()}getHeartbeatsHeader(){var P=this;return(0,v.Z)(function*(){var L;if(null===P._heartbeatsCache&&(yield P._heartbeatsCachePromise),null==(null===(L=P._heartbeatsCache)||void 0===L?void 0:L.heartbeats)||0===P._heartbeatsCache.heartbeats.length)return"";const Z=ye(),{heartbeatsToSend:he,unsentEntries:de}=function zt(I,P=1024){const L=[];let Z=I.slice();for(const he of I){const de=L.find(F=>F.agent===he.agent);if(de){if(de.dates.push(he.date),xn(L)>P){de.dates.pop();break}}else if(L.push({agent:he.agent,dates:[he.date]}),xn(L)>P){L.pop();break}Z=Z.slice(1)}return{heartbeatsToSend:L,unsentEntries:Z}}(P._heartbeatsCache.heartbeats),F=(0,te.L)(JSON.stringify({version:2,heartbeats:he}));return P._heartbeatsCache.lastSentHeartbeatDate=Z,de.length>0?(P._heartbeatsCache.heartbeats=de,yield P._storage.overwrite(P._heartbeatsCache)):(P._heartbeatsCache.heartbeats=[],P._storage.overwrite(P._heartbeatsCache)),F})()}}function ye(){return(new Date).toISOString().substring(0,10)}class vn{constructor(P){this.app=P,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,v.Z)(function*(){return!!(0,te.hl)()&&(0,te.eu)().then(()=>!0).catch(()=>!1)})()}read(){var P=this;return(0,v.Z)(function*(){if(yield P._canUseIndexedDBPromise){const Z=yield function N(I){return x.apply(this,arguments)}(P.app);return Z?.heartbeats?Z:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(P){var L=this;return(0,v.Z)(function*(){var Z;if(yield L._canUseIndexedDBPromise){const de=yield L.read();return Q(L.app,{lastSentHeartbeatDate:null!==(Z=P.lastSentHeartbeatDate)&&void 0!==Z?Z:de.lastSentHeartbeatDate,heartbeats:P.heartbeats})}})()}add(P){var L=this;return(0,v.Z)(function*(){var Z;if(yield L._canUseIndexedDBPromise){const de=yield L.read();return Q(L.app,{lastSentHeartbeatDate:null!==(Z=P.lastSentHeartbeatDate)&&void 0!==Z?Z:de.lastSentHeartbeatDate,heartbeats:[...de.heartbeats,...P.heartbeats]})}})()}}function xn(I){return(0,te.L)(JSON.stringify({version:2,heartbeats:I})).length}!function io(I){Or(new fe.wA("platform-logger",P=>new nt(P),"PRIVATE")),Or(new fe.wA("heartbeat",P=>new rt(P),"PRIVATE")),Kn(Rr,"0.9.25",I),Kn(Rr,"0.9.25","esm2017"),Kn("fire-js","")}("")},4537:(no,Kt,H)=>{H.d(Kt,{H0:()=>wn,wA:()=>k});var v=H(5861),fe=H(9058);class k{constructor(B,d,ie){this.name=B,this.instanceFactory=d,this.type=ie,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(B){return this.instantiationMode=B,this}setMultipleInstances(B){return this.multipleInstances=B,this}setServiceProps(B){return this.serviceProps=B,this}setInstanceCreatedCallback(B){return this.onInstanceCreated=B,this}}const te="[DEFAULT]";class Ut{constructor(B,d){this.name=B,this.container=d,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(B){const d=this.normalizeInstanceIdentifier(B);if(!this.instancesDeferred.has(d)){const ie=new fe.BH;if(this.instancesDeferred.set(d,ie),this.isInitialized(d)||this.shouldAutoInitialize())try{const ae=this.getOrInitializeService({instanceIdentifier:d});ae&&ie.resolve(ae)}catch{}}return this.instancesDeferred.get(d).promise}getImmediate(B){var d;const ie=this.normalizeInstanceIdentifier(B?.identifier),ae=null!==(d=B?.optional)&&void 0!==d&&d;if(!this.isInitialized(ie)&&!this.shouldAutoInitialize()){if(ae)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ie})}catch(ke){if(ae)return null;throw ke}}getComponent(){return this.component}setComponent(B){if(B.name!==this.name)throw Error(`Mismatching Component ${B.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=B,this.shouldAutoInitialize()){if(function Ye(ze){return"EAGER"===ze.instantiationMode}(B))try{this.getOrInitializeService({instanceIdentifier:te})}catch{}for(const[d,ie]of this.instancesDeferred.entries()){const ae=this.normalizeInstanceIdentifier(d);try{const ke=this.getOrInitializeService({instanceIdentifier:ae});ie.resolve(ke)}catch{}}}}clearInstance(B=te){this.instancesDeferred.delete(B),this.instancesOptions.delete(B),this.instances.delete(B)}delete(){var B=this;return(0,v.Z)(function*(){const d=Array.from(B.instances.values());yield Promise.all([...d.filter(ie=>"INTERNAL"in ie).map(ie=>ie.INTERNAL.delete()),...d.filter(ie=>"_delete"in ie).map(ie=>ie._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(B=te){return this.instances.has(B)}getOptions(B=te){return this.instancesOptions.get(B)||{}}initialize(B={}){const{options:d={}}=B,ie=this.normalizeInstanceIdentifier(B.instanceIdentifier);if(this.isInitialized(ie))throw Error(`${this.name}(${ie}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ae=this.getOrInitializeService({instanceIdentifier:ie,options:d});for(const[ke,xt]of this.instancesDeferred.entries())ie===this.normalizeInstanceIdentifier(ke)&&xt.resolve(ae);return ae}onInit(B,d){var ie;const ae=this.normalizeInstanceIdentifier(d),ke=null!==(ie=this.onInitCallbacks.get(ae))&&void 0!==ie?ie:new Set;ke.add(B),this.onInitCallbacks.set(ae,ke);const xt=this.instances.get(ae);return xt&&B(xt,ae),()=>{ke.delete(B)}}invokeOnInitCallbacks(B,d){const ie=this.onInitCallbacks.get(d);if(ie)for(const ae of ie)try{ae(B,d)}catch{}}getOrInitializeService({instanceIdentifier:B,options:d={}}){let ie=this.instances.get(B);if(!ie&&this.component&&(ie=this.component.instanceFactory(this.container,{instanceIdentifier:(ze=B,ze===te?void 0:ze),options:d}),this.instances.set(B,ie),this.instancesOptions.set(B,d),this.invokeOnInitCallbacks(ie,B),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,B,ie)}catch{}var ze;return ie||null}normalizeInstanceIdentifier(B=te){return this.component?this.component.multipleInstances?B:te:B}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class wn{constructor(B){this.name=B,this.providers=new Map}addComponent(B){const d=this.getProvider(B.name);if(d.isComponentSet())throw new Error(`Component ${B.name} has already been registered with ${this.name}`);d.setComponent(B)}addOrOverwriteComponent(B){this.getProvider(B.name).isComponentSet()&&this.providers.delete(B.name),this.addComponent(B)}getProvider(B){if(this.providers.has(B))return this.providers.get(B);const d=new Ut(B,this);return this.providers.set(B,d),d}getProviders(){return Array.from(this.providers.values())}}},7879:(no,Kt,H)=>{H.d(Kt,{Am:()=>ze,Ub:()=>wn,Yd:()=>Ye,in:()=>fe});const v=[];var fe=function(B){return B[B.DEBUG=0]="DEBUG",B[B.VERBOSE=1]="VERBOSE",B[B.INFO=2]="INFO",B[B.WARN=3]="WARN",B[B.ERROR=4]="ERROR",B[B.SILENT=5]="SILENT",B}(fe||{});const k={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},te=fe.INFO,Ut={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},Tt=(B,d,...ie)=>{if(d<B.logLevel)return;const ae=(new Date).toISOString(),ke=Ut[d];if(!ke)throw new Error(`Attempted to log a message with an invalid logType (value: ${d})`);console[ke](`[${ae}]  ${B.name}:`,...ie)};class Ye{constructor(d){this.name=d,this._logLevel=te,this._logHandler=Tt,this._userLogHandler=null,v.push(this)}get logLevel(){return this._logLevel}set logLevel(d){if(!(d in fe))throw new TypeError(`Invalid value "${d}" assigned to \`logLevel\``);this._logLevel=d}setLogLevel(d){this._logLevel="string"==typeof d?k[d]:d}get logHandler(){return this._logHandler}set logHandler(d){if("function"!=typeof d)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=d}get userLogHandler(){return this._userLogHandler}set userLogHandler(d){this._userLogHandler=d}debug(...d){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...d),this._logHandler(this,fe.DEBUG,...d)}log(...d){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...d),this._logHandler(this,fe.VERBOSE,...d)}info(...d){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...d),this._logHandler(this,fe.INFO,...d)}warn(...d){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...d),this._logHandler(this,fe.WARN,...d)}error(...d){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...d),this._logHandler(this,fe.ERROR,...d)}}function wn(B){v.forEach(d=>{d.setLogLevel(B)})}function ze(B,d){for(const ie of v){let ae=null;d&&d.level&&(ae=k[d.level]),ie.userLogHandler=null===B?null:(ke,xt,...Me)=>{const ve=Me.map(Ie=>{if(null==Ie)return null;if("string"==typeof Ie)return Ie;if("number"==typeof Ie||"boolean"==typeof Ie)return Ie.toString();if(Ie instanceof Error)return Ie.message;try{return JSON.stringify(Ie)}catch{return null}}).filter(Ie=>Ie).join(" ");xt>=(ae??ke.logLevel)&&B({level:fe[xt].toLowerCase(),message:ve,args:Me,type:ke.name})}}}},6230:(no,Kt,H)=>{H.r(Kt);var v=H(5861),fe=H(3106),k=H(9058),te=H(534),Ut=H(7879),Tt=H(7582),Ye=H(4537);const ze={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const xt=function ae(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Me=function ke(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ve=new k.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Dt=new Ut.Yd("@firebase/auth");function Et(l,...o){Dt.logLevel<=Ut.in.ERROR&&Dt.error(`Auth (${te.SDK_VERSION}): ${l}`,...o)}function Le(l,...o){throw wt(l,...o)}function Pe(l,...o){return wt(l,...o)}function Sr(l,o,c){const u=Object.assign(Object.assign({},Me()),{[o]:c});return new k.LL("auth","Firebase",u).create(o,{appName:l.name})}function Ee(l,o,c){if(!(o instanceof c))throw c.name!==o.constructor.name&&Le(l,"argument-error"),Sr(l,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wt(l,...o){if("string"!=typeof l){const c=o[0],u=[...o.slice(1)];return u[0]&&(u[0].appName=l.name),l._errorFactory.create(c,...u)}return ve.create(l,...o)}function M(l,o,...c){if(!l)throw wt(o,...c)}function Je(l){const o="INTERNAL ASSERTION FAILED: "+l;throw Et(o),new Error(o)}function nt(l,o){l||Je(o)}function An(){var l;return typeof self<"u"&&(null===(l=self.location)||void 0===l?void 0:l.href)||""}function Rr(){return"http:"===sr()||"https:"===sr()}function sr(){var l;return typeof self<"u"&&(null===(l=self.location)||void 0===l?void 0:l.protocol)||null}class Qt{constructor(o,c){this.shortDelay=o,this.longDelay=c,nt(c>o,"Short delay should be less than long delay!"),this.isMobile=(0,k.uI)()||(0,k.b$)()}get(){return function bn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Rr()||(0,k.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $n(l,o){nt(l.emulator,"Emulator should always be set here");const{url:c}=l.emulator;return o?`${c}${o.startsWith("/")?o.slice(1):o}`:c}class $i{static initialize(o,c,u){this.fetchImpl=o,c&&(this.headersImpl=c),u&&(this.responseImpl=u)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Je("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Je("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Je("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ma={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Hi=new Qt(3e4,6e4);function Ce(l,o){return l.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:l.tenantId}):o}function Re(l,o,c,u){return an.apply(this,arguments)}function an(){return(an=(0,v.Z)(function*(l,o,c,u,p={}){return xr(l,p,(0,v.Z)(function*(){let _={},T={};u&&("GET"===o?T=u:_={body:JSON.stringify(u)});const C=(0,k.xO)(Object.assign({key:l.config.apiKey},T)).slice(1),O=yield l._getAdditionalHeaders();return O["Content-Type"]="application/json",l.languageCode&&(O["X-Firebase-Locale"]=l.languageCode),$i.fetch()(Ki(l,l.config.apiHost,c,C),Object.assign({method:o,headers:O,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function xr(l,o,c){return or.apply(this,arguments)}function or(){return(or=(0,v.Z)(function*(l,o,c){l._canInitEmulator=!1;const u=Object.assign(Object.assign({},Ma),o);try{const p=new La(l),_=yield Promise.race([c(),p.promise]);p.clearNetworkTimeout();const T=yield _.json();if("needConfirmation"in T)throw Dr(l,"account-exists-with-different-credential",T);if(_.ok&&!("errorMessage"in T))return T;{const C=_.ok?T.errorMessage:T.error.message,[O,j]=C.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===O)throw Dr(l,"credential-already-in-use",T);if("EMAIL_EXISTS"===O)throw Dr(l,"email-already-in-use",T);if("USER_DISABLED"===O)throw Dr(l,"user-disabled",T);const J=u[O]||O.toLowerCase().replace(/[_\s]+/g,"-");if(j)throw Sr(l,J,j);Le(l,J)}}catch(p){if(p instanceof k.ZR)throw p;Le(l,"network-request-failed",{message:String(p)})}})).apply(this,arguments)}function Yt(l,o,c,u){return kt.apply(this,arguments)}function kt(){return(kt=(0,v.Z)(function*(l,o,c,u,p={}){const _=yield Re(l,o,c,u,p);return"mfaPendingCredential"in _&&Le(l,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function Ki(l,o,c,u){const p=`${o}${c}?${u}`;return l.config.emulator?$n(l.config,p):`${l.config.apiScheme}://${p}`}function Cn(l){switch(l){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class La{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((c,u)=>{this.timer=setTimeout(()=>u(Pe(this.auth,"network-request-failed")),Hi.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Dr(l,o,c){const u={appName:l.name};c.email&&(u.email=c.email),c.phoneNumber&&(u.phoneNumber=c.phoneNumber);const p=Pe(l,o,u);return p.customData._tokenResponse=c,p}function ft(l){return void 0!==l&&void 0!==l.getResponse}function Qi(l){return void 0!==l&&void 0!==l.enterprise}class oi{constructor(o){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=o.recaptchaEnforcementState}getProviderEnforcementState(o){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const c of this.recaptchaEnforcementState)if(c.provider&&c.provider===o)return Cn(c.enforcementState);return null}isProviderEnabled(o){return"ENFORCE"===this.getProviderEnforcementState(o)||"AUDIT"===this.getProviderEnforcementState(o)}}function Ot(){return(Ot=(0,v.Z)(function*(l){return(yield Re(l,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function kr(l,o){return ai.apply(this,arguments)}function ai(){return(ai=(0,v.Z)(function*(l,o){return Re(l,"GET","/v2/recaptchaConfig",Ce(l,o))})).apply(this,arguments)}function gn(){return(gn=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Bt(){return(Bt=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function _n(){return(_n=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function Sn(l){if(l)try{const o=new Date(Number(l));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function ci(){return(ci=(0,v.Z)(function*(l,o=!1){const c=(0,k.m9)(l),u=yield c.getIdToken(o),p=Nr(u);M(p&&p.exp&&p.auth_time&&p.iat,c.auth,"internal-error");const _="object"==typeof p.firebase?p.firebase:void 0,T=_?.sign_in_provider;return{claims:p,token:u,authTime:Sn(Rn(p.auth_time)),issuedAtTime:Sn(Rn(p.iat)),expirationTime:Sn(Rn(p.exp)),signInProvider:T||null,signInSecondFactor:_?.sign_in_second_factor||null}})).apply(this,arguments)}function Rn(l){return 1e3*Number(l)}function Nr(l){const[o,c,u]=l.split(".");if(void 0===o||void 0===c||void 0===u)return Et("JWT malformed, contained fewer than 3 sections"),null;try{const p=(0,k.tV)(c);return p?JSON.parse(p):(Et("Failed to decode base64 JWT payload"),null)}catch(p){return Et("Caught error parsing JWT payload as JSON",p?.toString()),null}}function Jt(l,o){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,v.Z)(function*(l,o,c=!1){if(c)return o;try{return yield o}catch(u){throw u instanceof k.ZR&&function Pn({code:l}){return"auth/user-disabled"===l||"auth/user-token-expired"===l}(u)&&l.auth.currentUser===l&&(yield l.auth.signOut()),u}})).apply(this,arguments)}class li{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var c;if(o){const u=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),u}{this.errorBackoff=3e4;const p=(null!==(c=this.user.stsTokenManager.expirationTime)&&void 0!==c?c:0)-Date.now()-3e5;return Math.max(0,p)}}schedule(o=!1){var c=this;if(!this.isRunning)return;const u=this.getInterval(o);this.timerId=setTimeout((0,v.Z)(function*(){yield c.iteration()}),u)}iteration(){var o=this;return(0,v.Z)(function*(){try{yield o.user.getIdToken(!0)}catch(c){return void("auth/network-request-failed"===c?.code&&o.schedule(!0))}o.schedule()})()}}class yn{constructor(o,c){this.createdAt=o,this.lastLoginAt=c,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sn(this.lastLoginAt),this.creationTime=Sn(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Hn(l){return At.apply(this,arguments)}function At(){return At=(0,v.Z)(function*(l){var o;const c=l.auth,u=yield l.getIdToken(),p=yield Jt(l,function cn(l,o){return _n.apply(this,arguments)}(c,{idToken:u}));M(p?.users.length,c,"internal-error");const _=p.users[0];l._notifyReloadListener(_);const T=null!==(o=_.providerUserInfo)&&void 0!==o&&o.length?function di(l){return l.map(o=>{var{providerId:c}=o,u=(0,Tt._T)(o,["providerId"]);return{providerId:c,uid:u.rawId||"",displayName:u.displayName||null,email:u.email||null,phoneNumber:u.phoneNumber||null,photoURL:u.photoUrl||null}})}(_.providerUserInfo):[],C=function ro(l,o){return[...l.filter(u=>!o.some(p=>p.providerId===u.providerId)),...o]}(l.providerData,T),J=!!l.isAnonymous&&!(l.email&&_.passwordHash||C?.length),X={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:C,metadata:new yn(_.createdAt,_.lastLoginAt),isAnonymous:J};Object.assign(l,X)}),At.apply(this,arguments)}function ui(){return(ui=(0,v.Z)(function*(l){const o=(0,k.m9)(l);yield Hn(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function A(){return(A=(0,v.Z)(function*(l,o){const c=yield xr(l,{},(0,v.Z)(function*(){const u=(0,k.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:p,apiKey:_}=l.config,T=Ki(l,p,"/v1/token",`key=${_}`),C=yield l._getAdditionalHeaders();return C["Content-Type"]="application/x-www-form-urlencoded",$i.fetch()(T,{method:"POST",headers:C,body:u})}));return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}})).apply(this,arguments)}function b(){return(b=(0,v.Z)(function*(l,o){return Re(l,"POST","/v2/accounts:revokeToken",Ce(l,o))})).apply(this,arguments)}class N{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){M(o.idToken,"internal-error"),M(typeof o.idToken<"u","internal-error"),M(typeof o.refreshToken<"u","internal-error");const c="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function ln(l){const o=Nr(l);return M(o,"internal-error"),M(typeof o.exp<"u","internal-error"),M(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,c)}getToken(o,c=!1){var u=this;return(0,v.Z)(function*(){return M(!u.accessToken||u.refreshToken,o,"user-token-expired"),c||!u.accessToken||u.isExpired?u.refreshToken?(yield u.refresh(o,u.refreshToken),u.accessToken):null:u.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,c){var u=this;return(0,v.Z)(function*(){const{accessToken:p,refreshToken:_,expiresIn:T}=yield function Vr(l,o){return A.apply(this,arguments)}(o,c);u.updateTokensAndExpiration(p,_,Number(T))})()}updateTokensAndExpiration(o,c,u){this.refreshToken=c||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*u}static fromJSON(o,c){const{refreshToken:u,accessToken:p,expirationTime:_}=c,T=new N;return u&&(M("string"==typeof u,"internal-error",{appName:o}),T.refreshToken=u),p&&(M("string"==typeof p,"internal-error",{appName:o}),T.accessToken=p),_&&(M("number"==typeof _,"internal-error",{appName:o}),T.expirationTime=_),T}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new N,this.toJSON())}_performRefresh(){return Je("not implemented")}}function x(l,o){M("string"==typeof l||typeof l>"u","internal-error",{appName:o})}class Q{constructor(o){var{uid:c,auth:u,stsTokenManager:p}=o,_=(0,Tt._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new li(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=c,this.auth=u,this.stsTokenManager=p,this.accessToken=p.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new yn(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(o){var c=this;return(0,v.Z)(function*(){const u=yield Jt(c,c.stsTokenManager.getToken(c.auth,o));return M(u,c.auth,"internal-error"),c.accessToken!==u&&(c.accessToken=u,yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)),u})()}getIdTokenResult(o){return function ar(l){return ci.apply(this,arguments)}(this,o)}reload(){return function Kn(l){return ui.apply(this,arguments)}(this)}_assign(o){this!==o&&(M(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(c=>Object.assign({},c)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const c=new Q(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return c.metadata._copy(this.metadata),c}_onReload(o){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,c=!1){var u=this;return(0,v.Z)(function*(){let p=!1;o.idToken&&o.idToken!==u.stsTokenManager.accessToken&&(u.stsTokenManager.updateFromServerResponse(o),p=!0),c&&(yield Hn(u)),yield u.auth._persistUserIfCurrent(u),p&&u.auth._notifyListenersIfCurrent(u)})()}delete(){var o=this;return(0,v.Z)(function*(){const c=yield o.getIdToken();return yield Jt(o,function Yi(l,o){return gn.apply(this,arguments)}(o.auth,{idToken:c})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,c){var u,p,_,T,C,O,j,J;const X=null!==(u=c.displayName)&&void 0!==u?u:void 0,je=null!==(p=c.email)&&void 0!==p?p:void 0,ut=null!==(_=c.phoneNumber)&&void 0!==_?_:void 0,ca=null!==(T=c.photoURL)&&void 0!==T?T:void 0,Lt=null!==(C=c.tenantId)&&void 0!==C?C:void 0,la=null!==(O=c._redirectEventId)&&void 0!==O?O:void 0,Vi=null!==(j=c.createdAt)&&void 0!==j?j:void 0,il=null!==(J=c.lastLoginAt)&&void 0!==J?J:void 0,{uid:pn,emailVerified:sl,isAnonymous:Mi,providerData:ol,stsTokenManager:Ku}=c;M(pn&&Ku,o,"internal-error");const pe=N.fromJSON(this.name,Ku);M("string"==typeof pn,o,"internal-error"),x(X,o.name),x(je,o.name),M("boolean"==typeof sl,o,"internal-error"),M("boolean"==typeof Mi,o,"internal-error"),x(ut,o.name),x(ca,o.name),x(Lt,o.name),x(la,o.name),x(Vi,o.name),x(il,o.name);const al=new Q({uid:pn,auth:o,email:je,emailVerified:sl,displayName:X,isAnonymous:Mi,photoURL:ca,phoneNumber:ut,tenantId:Lt,stsTokenManager:pe,createdAt:Vi,lastLoginAt:il});return ol&&Array.isArray(ol)&&(al.providerData=ol.map(cl=>Object.assign({},cl))),la&&(al._redirectEventId=la),al}static _fromIdTokenResponse(o,c,u=!1){return(0,v.Z)(function*(){const p=new N;p.updateFromServerResponse(c);const _=new Q({uid:c.localId,auth:o,stsTokenManager:p,isAnonymous:u});return yield Hn(_),_})()}}const ue=new Map;function ge(l){nt(l instanceof Function,"Expected a class definition");let o=ue.get(l);return o?(nt(o instanceof l,"Instance stored in cache mismatched with class"),o):(o=new l,ue.set(l,o),o)}const Xe=(()=>{class l{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,v.Z)(function*(){return!0})()}_set(c,u){var p=this;return(0,v.Z)(function*(){p.storage[c]=u})()}_get(c){var u=this;return(0,v.Z)(function*(){const p=u.storage[c];return void 0===p?null:p})()}_remove(c){var u=this;return(0,v.Z)(function*(){delete u.storage[c]})()}_addListener(c,u){}_removeListener(c,u){}}return l.type="NONE",l})();function rt(l,o,c){return`firebase:${l}:${o}:${c}`}class ye{constructor(o,c,u){this.persistence=o,this.auth=c,this.userKey=u;const{config:p,name:_}=this.auth;this.fullUserKey=rt(this.userKey,p.apiKey,_),this.fullPersistenceKey=rt("persistence",p.apiKey,_),this.boundEventHandler=c._onStorageEvent.bind(c),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,v.Z)(function*(){const c=yield o.persistence._get(o.fullUserKey);return c?Q._fromJSON(o.auth,c):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var c=this;return(0,v.Z)(function*(){if(c.persistence===o)return;const u=yield c.getCurrentUser();return yield c.removeCurrentUser(),c.persistence=o,u?c.setCurrentUser(u):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,c,u="authUser"){return(0,v.Z)(function*(){if(!c.length)return new ye(ge(Xe),o,u);const p=(yield Promise.all(c.map(function(){var j=(0,v.Z)(function*(J){if(yield J._isAvailable())return J});return function(J){return j.apply(this,arguments)}}()))).filter(j=>j);let _=p[0]||ge(Xe);const T=rt(u,o.config.apiKey,o.name);let C=null;for(const j of c)try{const J=yield j._get(T);if(J){const X=Q._fromJSON(o,J);j!==_&&(C=X),_=j;break}}catch{}const O=p.filter(j=>j._shouldAllowMigration);return _._shouldAllowMigration&&O.length?(_=O[0],C&&(yield _._set(T,C.toJSON())),yield Promise.all(c.map(function(){var j=(0,v.Z)(function*(J){if(J!==_)try{yield J._remove(T)}catch{}});return function(J){return j.apply(this,arguments)}}())),new ye(_,o,u)):new ye(_,o,u)})()}}function zt(l){const o=l.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(I(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(vn(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(L(o))return"Blackberry";if(Z(o))return"Webos";if(xn(o))return"Safari";if((o.includes("chrome/")||io(o))&&!o.includes("edge/"))return"Chrome";if(P(o))return"Android";{const u=l.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===u?.length)return u[1]}return"Other"}function vn(l=(0,k.z$)()){return/firefox\//i.test(l)}function xn(l=(0,k.z$)()){const o=l.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function io(l=(0,k.z$)()){return/crios\//i.test(l)}function I(l=(0,k.z$)()){return/iemobile/i.test(l)}function P(l=(0,k.z$)()){return/android/i.test(l)}function L(l=(0,k.z$)()){return/blackberry/i.test(l)}function Z(l=(0,k.z$)()){return/webos/i.test(l)}function he(l=(0,k.z$)()){return/iphone|ipad|ipod/i.test(l)||/macintosh/i.test(l)&&/mobile/i.test(l)}function ee(l=(0,k.z$)()){return he(l)||P(l)||Z(l)||L(l)||/windows phone/i.test(l)||I(l)}function Dn(l,o=[]){let c;switch(l){case"Browser":c=zt((0,k.z$)());break;case"Worker":c=`${zt((0,k.z$)())}-${l}`;break;default:c=l}const u=o.length?o.join(","):"FirebaseCore-web";return`${c}/JsCore/${te.SDK_VERSION}/${u}`}class Ld{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,c){const u=_=>new Promise((T,C)=>{try{T(o(_))}catch(O){C(O)}});u.onAbort=c,this.queue.push(u);const p=this.queue.length-1;return()=>{this.queue[p]=()=>Promise.resolve()}}runMiddleware(o){var c=this;return(0,v.Z)(function*(){if(c.auth.currentUser===o)return;const u=[];try{for(const p of c.queue)yield p(o),p.onAbort&&u.push(p.onAbort)}catch(p){u.reverse();for(const _ of u)try{_()}catch{}throw c.auth._errorFactory.create("login-blocked",{originalMessage:p?.message})}})()}}function Ba(){return(Ba=(0,v.Z)(function*(l,o={}){return Re(l,"GET","/v2/passwordPolicy",Ce(l,o))})).apply(this,arguments)}class Ud{constructor(o){var c,u,p,_;const T=o.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(c=T.minPasswordLength)&&void 0!==c?c:6,T.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=T.maxPasswordLength),void 0!==T.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=T.containsLowercaseCharacter),void 0!==T.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=T.containsUppercaseCharacter),void 0!==T.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=T.containsNumericCharacter),void 0!==T.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=T.containsNonAlphanumericCharacter),this.enforcementState=o.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(p=null===(u=o.allowedNonAlphanumericCharacters)||void 0===u?void 0:u.join(""))&&void 0!==p?p:"",this.forceUpgradeOnSignin=null!==(_=o.forceUpgradeOnSignin)&&void 0!==_&&_,this.schemaVersion=o.schemaVersion}validatePassword(o){var c,u,p,_,T,C;const O={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(o,O),this.validatePasswordCharacterOptions(o,O),O.isValid&&(O.isValid=null===(c=O.meetsMinPasswordLength)||void 0===c||c),O.isValid&&(O.isValid=null===(u=O.meetsMaxPasswordLength)||void 0===u||u),O.isValid&&(O.isValid=null===(p=O.containsLowercaseLetter)||void 0===p||p),O.isValid&&(O.isValid=null===(_=O.containsUppercaseLetter)||void 0===_||_),O.isValid&&(O.isValid=null===(T=O.containsNumericCharacter)||void 0===T||T),O.isValid&&(O.isValid=null===(C=O.containsNonAlphanumericCharacter)||void 0===C||C),O}validatePasswordLengthOptions(o,c){const u=this.customStrengthOptions.minPasswordLength,p=this.customStrengthOptions.maxPasswordLength;u&&(c.meetsMinPasswordLength=o.length>=u),p&&(c.meetsMaxPasswordLength=o.length<=p)}validatePasswordCharacterOptions(o,c){let u;this.updatePasswordCharacterOptionsStatuses(c,!1,!1,!1,!1);for(let p=0;p<o.length;p++)u=o.charAt(p),this.updatePasswordCharacterOptionsStatuses(c,u>="a"&&u<="z",u>="A"&&u<="Z",u>="0"&&u<="9",this.allowedNonAlphanumericCharacters.includes(u))}updatePasswordCharacterOptionsStatuses(o,c,u,p,_){this.customStrengthOptions.containsLowercaseLetter&&(o.containsLowercaseLetter||(o.containsLowercaseLetter=c)),this.customStrengthOptions.containsUppercaseLetter&&(o.containsUppercaseLetter||(o.containsUppercaseLetter=u)),this.customStrengthOptions.containsNumericCharacter&&(o.containsNumericCharacter||(o.containsNumericCharacter=p)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(o.containsNonAlphanumericCharacter||(o.containsNonAlphanumericCharacter=_))}}class bt{constructor(o,c,u,p){this.app=o,this.heartbeatServiceProvider=c,this.appCheckServiceProvider=u,this.config=p,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ot(this),this.idTokenSubscription=new ot(this),this.beforeStateQueue=new Ld(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ve,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=p.sdkClientVersion}_initializeWithPersistence(o,c){var u=this;return c&&(this._popupRedirectResolver=ge(c)),this._initializationPromise=this.queue((0,v.Z)(function*(){var p,_;if(!u._deleted&&(u.persistenceManager=yield ye.create(u,o),!u._deleted)){if(null!==(p=u._popupRedirectResolver)&&void 0!==p&&p._shouldInitProactively)try{yield u._popupRedirectResolver._initialize(u)}catch{}yield u.initializeCurrentUser(c),u.lastNotifiedUid=(null===(_=u.currentUser)||void 0===_?void 0:_.uid)||null,!u._deleted&&(u._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,v.Z)(function*(){if(o._deleted)return;const c=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||c){if(o.currentUser&&c&&o.currentUser.uid===c.uid)return o._currentUser._assign(c),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(c,!0)}})()}initializeCurrentUser(o){var c=this;return(0,v.Z)(function*(){var u;const p=yield c.assertedPersistence.getCurrentUser();let _=p,T=!1;if(o&&c.config.authDomain){yield c.getOrInitRedirectPersistenceManager();const C=null===(u=c.redirectUser)||void 0===u?void 0:u._redirectEventId,O=_?._redirectEventId,j=yield c.tryRedirectSignIn(o);(!C||C===O)&&j?.user&&(_=j.user,T=!0)}if(!_)return c.directlySetCurrentUser(null);if(!_._redirectEventId){if(T)try{yield c.beforeStateQueue.runMiddleware(_)}catch(C){_=p,c._popupRedirectResolver._overrideRedirectResult(c,()=>Promise.reject(C))}return _?c.reloadAndSetCurrentUserOrClear(_):c.directlySetCurrentUser(null)}return M(c._popupRedirectResolver,c,"argument-error"),yield c.getOrInitRedirectPersistenceManager(),c.redirectUser&&c.redirectUser._redirectEventId===_._redirectEventId?c.directlySetCurrentUser(_):c.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(o){var c=this;return(0,v.Z)(function*(){let u=null;try{u=yield c._popupRedirectResolver._completeRedirectFn(c,o,!0)}catch{yield c._setRedirectUser(null)}return u})()}reloadAndSetCurrentUserOrClear(o){var c=this;return(0,v.Z)(function*(){try{yield Hn(o)}catch(u){if("auth/network-request-failed"!==u?.code)return c.directlySetCurrentUser(null)}return c.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function Pr(){if(typeof navigator>"u")return null;const l=navigator;return l.languages&&l.languages[0]||l.language||null}()}_delete(){var o=this;return(0,v.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var c=this;return(0,v.Z)(function*(){const u=o?(0,k.m9)(o):null;return u&&M(u.auth.config.apiKey===c.config.apiKey,c,"invalid-user-token"),c._updateCurrentUser(u&&u._clone(c))})()}_updateCurrentUser(o,c=!1){var u=this;return(0,v.Z)(function*(){if(!u._deleted)return o&&M(u.tenantId===o.tenantId,u,"tenant-id-mismatch"),c||(yield u.beforeStateQueue.runMiddleware(o)),u.queue((0,v.Z)(function*(){yield u.directlySetCurrentUser(o),u.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,v.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var c=this;return this.queue((0,v.Z)(function*(){yield c.assertedPersistence.setPersistence(ge(o))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(o){var c=this;return(0,v.Z)(function*(){c._getPasswordPolicyInternal()||(yield c._updatePasswordPolicy());const u=c._getPasswordPolicyInternal();return u.schemaVersion!==c.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(c._errorFactory.create("unsupported-password-policy-schema-version",{})):u.validatePassword(o)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var o=this;return(0,v.Z)(function*(){const c=yield function Ua(l){return Ba.apply(this,arguments)}(o),u=new Ud(c);null===o.tenantId?o._projectPasswordPolicy=u:o._tenantPasswordPolicies[o.tenantId]=u})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new k.LL("auth","Firebase",o())}onAuthStateChanged(o,c,u){return this.registerStateListener(this.authStateSubscription,o,c,u)}beforeAuthStateChanged(o,c){return this.beforeStateQueue.pushCallback(o,c)}onIdTokenChanged(o,c,u){return this.registerStateListener(this.idTokenSubscription,o,c,u)}authStateReady(){return new Promise((o,c)=>{if(this.currentUser)o();else{const u=this.onAuthStateChanged(()=>{u(),o()},c)}})}revokeAccessToken(o){var c=this;return(0,v.Z)(function*(){if(c.currentUser){const u=yield c.currentUser.getIdToken(),p={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:o,idToken:u};null!=c.tenantId&&(p.tenantId=c.tenantId),yield function E(l,o){return b.apply(this,arguments)}(c,p)}})()}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,c){var u=this;return(0,v.Z)(function*(){const p=yield u.getOrInitRedirectPersistenceManager(c);return null===o?p.removeCurrentUser():p.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var c=this;return(0,v.Z)(function*(){if(!c.redirectPersistenceManager){const u=o&&ge(o)||c._popupRedirectResolver;M(u,c,"argument-error"),c.redirectPersistenceManager=yield ye.create(c,[ge(u._redirectPersistence)],"redirectUser"),c.redirectUser=yield c.redirectPersistenceManager.getCurrentUser()}return c.redirectPersistenceManager})()}_redirectUserForId(o){var c=this;return(0,v.Z)(function*(){var u,p;return c._isInitialized&&(yield c.queue((0,v.Z)(function*(){}))),(null===(u=c._currentUser)||void 0===u?void 0:u._redirectEventId)===o?c._currentUser:(null===(p=c.redirectUser)||void 0===p?void 0:p._redirectEventId)===o?c.redirectUser:null})()}_persistUserIfCurrent(o){var c=this;return(0,v.Z)(function*(){if(o===c.currentUser)return c.queue((0,v.Z)(function*(){return c.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,c;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const u=null!==(c=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==c?c:null;this.lastNotifiedUid!==u&&(this.lastNotifiedUid=u,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,c,u,p){if(this._deleted)return()=>{};const _="function"==typeof c?c:c.next.bind(c);let T=!1;const C=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(C,this,"internal-error"),C.then(()=>{T||_(this.currentUser)}),"function"==typeof c){const O=o.addObserver(c,u,p);return()=>{T=!0,O()}}{const O=o.addObserver(c);return()=>{T=!0,O()}}}directlySetCurrentUser(o){var c=this;return(0,v.Z)(function*(){c.currentUser&&c.currentUser!==o&&c._currentUser._stopProactiveRefresh(),o&&c.isProactiveRefreshEnabled&&o._startProactiveRefresh(),c.currentUser=o,o?yield c.assertedPersistence.setCurrentUser(o):yield c.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=Dn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,v.Z)(function*(){var c;const u={"X-Client-Version":o.clientVersion};o.app.options.appId&&(u["X-Firebase-gmpid"]=o.app.options.appId);const p=yield null===(c=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getHeartbeatsHeader();p&&(u["X-Firebase-Client"]=p);const _=yield o._getAppCheckToken();return _&&(u["X-Firebase-AppCheck"]=_),u})()}_getAppCheckToken(){var o=this;return(0,v.Z)(function*(){var c;const u=yield null===(c=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getToken();return u?.error&&function on(l,...o){Dt.logLevel<=Ut.in.WARN&&Dt.warn(`Auth (${te.SDK_VERSION}): ${l}`,...o)}(`Error while retrieving App Check token: ${u.error}`),u?.token})()}}function Oe(l){return(0,k.m9)(l)}class ot{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,k.ne)(c=>this.observer=c)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function za(l){return new Promise((o,c)=>{const u=document.createElement("script");u.setAttribute("src",l),u.onload=o,u.onerror=p=>{const _=Pe("internal-error");_.customData=p,c(_)},u.type="text/javascript",u.charset="UTF-8",function cr(){var l,o;return null!==(o=null===(l=document.getElementsByTagName("head"))||void 0===l?void 0:l[0])&&void 0!==o?o:document}().appendChild(u)})}function Ga(l){return`__${l}${Math.floor(1e6*Math.random())}`}class Gl{constructor(o){this.type="recaptcha-enterprise",this.auth=Oe(o)}verify(o="verify",c=!1){var u=this;return(0,v.Z)(function*(){function _(){return _=(0,v.Z)(function*(C){if(!c){if(null==C.tenantId&&null!=C._agentRecaptchaConfig)return C._agentRecaptchaConfig.siteKey;if(null!=C.tenantId&&void 0!==C._tenantRecaptchaConfigs[C.tenantId])return C._tenantRecaptchaConfigs[C.tenantId].siteKey}return new Promise(function(){var O=(0,v.Z)(function*(j,J){kr(C,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(X=>{if(void 0!==X.recaptchaKey){const je=new oi(X);return null==C.tenantId?C._agentRecaptchaConfig=je:C._tenantRecaptchaConfigs[C.tenantId]=je,j(je.siteKey)}J(new Error("recaptcha Enterprise site key undefined"))}).catch(X=>{J(X)})});return function(j,J){return O.apply(this,arguments)}}())}),_.apply(this,arguments)}function T(C,O,j){const J=window.grecaptcha;Qi(J)?J.enterprise.ready(()=>{J.enterprise.execute(C,{action:o}).then(X=>{O(X)}).catch(()=>{O("NO_RECAPTCHA")})}):j(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((C,O)=>{(function p(C){return _.apply(this,arguments)})(u.auth).then(j=>{if(!c&&Qi(window.grecaptcha))T(j,C,O);else{if(typeof window>"u")return void O(new Error("RecaptchaVerifier is only supported in browser"));za("https://www.google.com/recaptcha/enterprise.js?render="+j).then(()=>{T(j,C,O)}).catch(J=>{O(J)})}}).catch(j=>{O(j)})})})()}}function hi(l,o,c){return fi.apply(this,arguments)}function fi(){return(fi=(0,v.Z)(function*(l,o,c,u=!1){const p=new Gl(l);let _;try{_=yield p.verify(c)}catch{_=yield p.verify(c,!0)}const T=Object.assign({},o);return Object.assign(T,u?{captchaResp:_}:{captchaResponse:_}),Object.assign(T,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(T,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),T})).apply(this,arguments)}function Gt(l,o,c,u){return es.apply(this,arguments)}function es(){return es=(0,v.Z)(function*(l,o,c,u){var p;if(null!==(p=l._getRecaptchaConfig())&&void 0!==p&&p.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const _=yield hi(l,o,c,"getOobCode"===c);return u(l,_)}return u(l,o).catch(function(){var _=(0,v.Z)(function*(T){if("auth/missing-recaptcha-token"===T.code){console.log(`${c} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const C=yield hi(l,o,c,"getOobCode"===c);return u(l,C)}return Promise.reject(T)});return function(T){return _.apply(this,arguments)}}())}),es.apply(this,arguments)}function Wa(l){const o=l.indexOf(":");return o<0?"":l.substr(0,o+1)}function ja(l){if(!l)return null;const o=Number(l);return isNaN(o)?null:o}class lr{constructor(o,c){this.providerId=o,this.signInMethod=c}toJSON(){return Je("not implemented")}_getIdTokenResponse(o){return Je("not implemented")}_linkToIdToken(o,c){return Je("not implemented")}_getReauthenticationResolver(o){return Je("not implemented")}}function oo(l,o){return ts.apply(this,arguments)}function ts(){return(ts=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:resetPassword",Ce(l,o))})).apply(this,arguments)}function ao(){return(ao=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Gd(l,o){return Mr.apply(this,arguments)}function Mr(){return(Mr=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:signUp",o)})).apply(this,arguments)}function Lr(){return(Lr=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:update",Ce(l,o))})).apply(this,arguments)}function Zd(l,o){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithPassword",Ce(l,o))})).apply(this,arguments)}function Fr(l,o){return ns.apply(this,arguments)}function ns(){return(ns=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:sendOobCode",Ce(l,o))})).apply(this,arguments)}function co(){return(co=(0,v.Z)(function*(l,o){return Fr(l,o)})).apply(this,arguments)}function Zl(l,o){return lo.apply(this,arguments)}function lo(){return(lo=(0,v.Z)(function*(l,o){return Fr(l,o)})).apply(this,arguments)}function uo(l,o){return rs.apply(this,arguments)}function rs(){return(rs=(0,v.Z)(function*(l,o){return Fr(l,o)})).apply(this,arguments)}function is(){return(is=(0,v.Z)(function*(l,o){return Fr(l,o)})).apply(this,arguments)}function ho(){return(ho=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithEmailLink",Ce(l,o))})).apply(this,arguments)}function Ja(){return(Ja=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithEmailLink",Ce(l,o))})).apply(this,arguments)}class mi extends lr{constructor(o,c,u,p=null){super("password",u),this._email=o,this._password=c,this._tenantId=p}static _fromEmailAndPassword(o,c){return new mi(o,c,"password")}static _fromEmailAndCode(o,c,u=null){return new mi(o,c,"emailLink",u)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o;if(c?.email&&c?.password){if("password"===c.signInMethod)return this._fromEmailAndPassword(c.email,c.password);if("emailLink"===c.signInMethod)return this._fromEmailAndCode(c.email,c.password,c.tenantId)}return null}_getIdTokenResponse(o){var c=this;return(0,v.Z)(function*(){switch(c.signInMethod){case"password":return Gt(o,{returnSecureToken:!0,email:c._email,password:c._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Zd);case"emailLink":return function Ya(l,o){return ho.apply(this,arguments)}(o,{email:c._email,oobCode:c._password});default:Le(o,"internal-error")}})()}_linkToIdToken(o,c){var u=this;return(0,v.Z)(function*(){switch(u.signInMethod){case"password":return Gt(o,{idToken:c,returnSecureToken:!0,email:u._email,password:u._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Gd);case"emailLink":return function Wl(l,o){return Ja.apply(this,arguments)}(o,{idToken:c,email:u._email,oobCode:u._password});default:Le(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function kn(l,o){return ss.apply(this,arguments)}function ss(){return(ss=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithIdp",Ce(l,o))})).apply(this,arguments)}class On extends lr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const c=new On(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(c.idToken=o.idToken),o.accessToken&&(c.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(c.nonce=o.nonce),o.pendingToken&&(c.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(c.accessToken=o.oauthToken,c.secret=o.oauthTokenSecret):Le("argument-error"),c}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:u,signInMethod:p}=c,_=(0,Tt._T)(c,["providerId","signInMethod"]);if(!u||!p)return null;const T=new On(u,p);return T.idToken=_.idToken||void 0,T.accessToken=_.accessToken||void 0,T.secret=_.secret,T.nonce=_.nonce,T.pendingToken=_.pendingToken||null,T}_getIdTokenResponse(o){return kn(o,this.buildRequest())}_linkToIdToken(o,c){const u=this.buildRequest();return u.idToken=c,kn(o,u)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,kn(o,c)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const c={};this.idToken&&(c.id_token=this.idToken),this.accessToken&&(c.access_token=this.accessToken),this.secret&&(c.oauth_token_secret=this.secret),c.providerId=this.providerId,this.nonce&&!this.pendingToken&&(c.nonce=this.nonce),o.postBody=(0,k.xO)(c)}return o}}function os(){return(os=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:sendVerificationCode",Ce(l,o))})).apply(this,arguments)}function it(){return(it=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithPhoneNumber",Ce(l,o))})).apply(this,arguments)}function gi(){return(gi=(0,v.Z)(function*(l,o){const c=yield Yt(l,"POST","/v1/accounts:signInWithPhoneNumber",Ce(l,o));if(c.temporaryProof)throw Dr(l,"account-exists-with-different-credential",c);return c})).apply(this,arguments)}const tc={USER_NOT_FOUND:"user-not-found"};function nc(){return(nc=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithPhoneNumber",Ce(l,Object.assign(Object.assign({},o),{operation:"REAUTH"})),tc)})).apply(this,arguments)}class Ur extends lr{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,c){return new Ur({verificationId:o,verificationCode:c})}static _fromTokenResponse(o,c){return new Ur({phoneNumber:o,temporaryProof:c})}_getIdTokenResponse(o){return function ec(l,o){return it.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,c){return function yt(l,o){return gi.apply(this,arguments)}(o,Object.assign({idToken:c},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function jd(l,o){return nc.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:c,verificationId:u,verificationCode:p}=this.params;return o&&c?{temporaryProof:o,phoneNumber:c}:{sessionInfo:u,code:p}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:c,verificationCode:u,phoneNumber:p,temporaryProof:_}=o;return u||c||p||_?new Ur({verificationId:c,verificationCode:u,phoneNumber:p,temporaryProof:_}):null}}class as{constructor(o){var c,u,p,_,T,C;const O=(0,k.zd)((0,k.pd)(o)),j=null!==(c=O.apiKey)&&void 0!==c?c:null,J=null!==(u=O.oobCode)&&void 0!==u?u:null,X=function $l(l){switch(l){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(p=O.mode)&&void 0!==p?p:null);M(j&&J&&X,"argument-error"),this.apiKey=j,this.operation=X,this.code=J,this.continueUrl=null!==(_=O.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(T=O.languageCode)&&void 0!==T?T:null,this.tenantId=null!==(C=O.tenantId)&&void 0!==C?C:null}static parseLink(o){const c=function $d(l){const o=(0,k.zd)((0,k.pd)(l)).link,c=o?(0,k.zd)((0,k.pd)(o)).deep_link_id:null,u=(0,k.zd)((0,k.pd)(l)).deep_link_id;return(u?(0,k.zd)((0,k.pd)(u)).link:null)||u||c||o||l}(o);try{return new as(c)}catch{return null}}}let Br=(()=>{class l{constructor(){this.providerId=l.PROVIDER_ID}static credential(c,u){return mi._fromEmailAndPassword(c,u)}static credentialWithLink(c,u){const p=as.parseLink(u);return M(p,"argument-error"),mi._fromEmailAndCode(c,p.code,p.tenantId)}}return l.PROVIDER_ID="password",l.EMAIL_PASSWORD_SIGN_IN_METHOD="password",l.EMAIL_LINK_SIGN_IN_METHOD="emailLink",l})();class Xt{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class ur extends Xt{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class zr extends ur{static credentialFromJSON(o){const c="string"==typeof o?JSON.parse(o):o;return M("providerId"in c&&"signInMethod"in c,"argument-error"),On._fromParams(c)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return M(o.idToken||o.accessToken,"argument-error"),On._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return zr.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return zr.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:c,oauthAccessToken:u,oauthTokenSecret:p,pendingToken:_,nonce:T,providerId:C}=o;if(!u&&!p&&!c&&!_||!C)return null;try{return new zr(C)._credential({idToken:c,accessToken:u,nonce:T,pendingToken:_})}catch{return null}}}let Hl=(()=>{class l extends ur{constructor(){super("facebook.com")}static credential(c){return On._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.FACEBOOK_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return l.credential(c.oauthAccessToken)}catch{return null}}}return l.FACEBOOK_SIGN_IN_METHOD="facebook.com",l.PROVIDER_ID="facebook.com",l})(),cs=(()=>{class l extends ur{constructor(){super("google.com"),this.addScope("profile")}static credential(c,u){return On._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.GOOGLE_SIGN_IN_METHOD,idToken:c,accessToken:u})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:u,oauthAccessToken:p}=c;if(!u&&!p)return null;try{return l.credential(u,p)}catch{return null}}}return l.GOOGLE_SIGN_IN_METHOD="google.com",l.PROVIDER_ID="google.com",l})(),fo=(()=>{class l extends ur{constructor(){super("github.com")}static credential(c){return On._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.GITHUB_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return l.credential(c.oauthAccessToken)}catch{return null}}}return l.GITHUB_SIGN_IN_METHOD="github.com",l.PROVIDER_ID="github.com",l})();class Gr extends lr{constructor(o,c){super(o,o),this.pendingToken=c}_getIdTokenResponse(o){return kn(o,this.buildRequest())}_linkToIdToken(o,c){const u=this.buildRequest();return u.idToken=c,kn(o,u)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,kn(o,c)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:u,signInMethod:p,pendingToken:_}=c;return u&&p&&_&&u===p?new Gr(u,_):null}static _create(o,c){return new Gr(o,c)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class dr extends Xt{constructor(o){M(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return dr.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return dr.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const c=Gr.fromJSON(o);return M(c,"argument-error"),c}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:c,providerId:u}=o;if(!c||!u)return null;try{return Gr._create(u,c)}catch{return null}}}let ic=(()=>{class l extends ur{constructor(){super("twitter.com")}static credential(c,u){return On._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.TWITTER_SIGN_IN_METHOD,oauthToken:c,oauthTokenSecret:u})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthAccessToken:u,oauthTokenSecret:p}=c;if(!u||!p)return null;try{return l.credential(u,p)}catch{return null}}}return l.TWITTER_SIGN_IN_METHOD="twitter.com",l.PROVIDER_ID="twitter.com",l})();function sc(l,o){return po.apply(this,arguments)}function po(){return(po=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signUp",Ce(l,o))})).apply(this,arguments)}class Vt{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,c,u,p=!1){return(0,v.Z)(function*(){const _=yield Q._fromIdTokenResponse(o,u,p),T=Kl(u);return new Vt({user:_,providerId:T,_tokenResponse:u,operationType:c})})()}static _forOperation(o,c,u){return(0,v.Z)(function*(){yield o._updateTokensIfNecessary(u,!0);const p=Kl(u);return new Vt({user:o,providerId:p,_tokenResponse:u,operationType:c})})()}}function Kl(l){return l.providerId?l.providerId:"phoneNumber"in l?"phone":null}function hr(){return(hr=(0,v.Z)(function*(l){var o;const c=Oe(l);if(yield c._initializationPromise,null!==(o=c.currentUser)&&void 0!==o&&o.isAnonymous)return new Vt({user:c.currentUser,providerId:null,operationType:"signIn"});const u=yield sc(c,{returnSecureToken:!0}),p=yield Vt._fromIdTokenResponse(c,"signIn",u,!0);return yield c._updateCurrentUser(p.user),p})).apply(this,arguments)}class mo extends k.ZR{constructor(o,c,u,p){var _;super(c.code,c.message),this.operationType=u,this.user=p,Object.setPrototypeOf(this,mo.prototype),this.customData={appName:o.name,tenantId:null!==(_=o.tenantId)&&void 0!==_?_:void 0,_serverResponse:c.customData._serverResponse,operationType:u}}static _fromErrorAndOperation(o,c,u,p){return new mo(o,c,u,p)}}function Ql(l,o,c,u){return("reauthenticate"===o?c._getReauthenticationResolver(l):c._getIdTokenResponse(l)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?mo._fromErrorAndOperation(l,_,o,u):_})}function fr(l){return new Set(l.map(({providerId:o})=>o).filter(o=>!!o))}function _i(){return _i=(0,v.Z)(function*(l,o){const c=(0,k.m9)(l);yield ls(!0,c,o);const{providerUserInfo:u}=yield function Ji(l,o){return Bt.apply(this,arguments)}(c.auth,{idToken:yield c.getIdToken(),deleteProvider:[o]}),p=fr(u||[]);return c.providerData=c.providerData.filter(_=>p.has(_.providerId)),p.has("phone")||(c.phoneNumber=null),yield c.auth._persistUserIfCurrent(c),c}),_i.apply(this,arguments)}function go(l,o){return qr.apply(this,arguments)}function qr(){return(qr=(0,v.Z)(function*(l,o,c=!1){const u=yield Jt(l,o._linkToIdToken(l.auth,yield l.getIdToken()),c);return Vt._forOperation(l,"link",u)})).apply(this,arguments)}function ls(l,o,c){return vt.apply(this,arguments)}function vt(){return(vt=(0,v.Z)(function*(l,o,c){yield Hn(o);const p=!1===l?"provider-already-linked":"no-such-provider";M(fr(o.providerData).has(c)===l,o.auth,p)})).apply(this,arguments)}function oc(l,o){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,v.Z)(function*(l,o,c=!1){const{auth:u}=l,p="reauthenticate";try{const _=yield Jt(l,Ql(u,p,o,l),c);M(_.idToken,u,"internal-error");const T=Nr(_.idToken);M(T,u,"internal-error");const{sub:C}=T;return M(l.uid===C,u,"user-mismatch"),Vt._forOperation(l,p,_)}catch(_){throw"auth/user-not-found"===_?.code&&Le(u,"user-mismatch"),_}})).apply(this,arguments)}function us(l,o){return _o.apply(this,arguments)}function _o(){return(_o=(0,v.Z)(function*(l,o,c=!1){const u="signIn",p=yield Ql(l,u,o),_=yield Vt._fromIdTokenResponse(l,u,p);return c||(yield l._updateCurrentUser(_.user)),_})).apply(this,arguments)}function yi(l,o){return yo.apply(this,arguments)}function yo(){return(yo=(0,v.Z)(function*(l,o){return us(Oe(l),o)})).apply(this,arguments)}function ac(l,o){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,v.Z)(function*(l,o){const c=(0,k.m9)(l);return yield ls(!1,c,o.providerId),go(c,o)})).apply(this,arguments)}function vo(l,o){return ds.apply(this,arguments)}function ds(){return(ds=(0,v.Z)(function*(l,o){return oc((0,k.m9)(l),o)})).apply(this,arguments)}function vi(){return(vi=(0,v.Z)(function*(l,o){return Yt(l,"POST","/v1/accounts:signInWithCustomToken",Ce(l,o))})).apply(this,arguments)}function Io(){return Io=(0,v.Z)(function*(l,o){const c=Oe(l),u=yield function cc(l,o){return vi.apply(this,arguments)}(c,{token:o,returnSecureToken:!0}),p=yield Vt._fromIdTokenResponse(c,"signIn",u);return yield c._updateCurrentUser(p.user),p}),Io.apply(this,arguments)}class fs{constructor(o,c){this.factorId=o,this.uid=c.mfaEnrollmentId,this.enrollmentTime=new Date(c.enrolledAt).toUTCString(),this.displayName=c.displayName}static _fromServerResponse(o,c){return"phoneInfo"in c?To._fromServerResponse(o,c):"totpInfo"in c?ps._fromServerResponse(o,c):Le(o,"internal-error")}}class To extends fs{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,c){return new To(c)}}class ps extends fs{constructor(o){super("totp",o)}static _fromServerResponse(o,c){return new ps(c)}}function Ii(l,o,c){var u;M((null===(u=c.url)||void 0===u?void 0:u.length)>0,l,"invalid-continue-uri"),M(typeof c.dynamicLinkDomain>"u"||c.dynamicLinkDomain.length>0,l,"invalid-dynamic-link-domain"),o.continueUrl=c.url,o.dynamicLinkDomain=c.dynamicLinkDomain,o.canHandleCodeInApp=c.handleCodeInApp,c.iOS&&(M(c.iOS.bundleId.length>0,l,"missing-ios-bundle-id"),o.iOSBundleId=c.iOS.bundleId),c.android&&(M(c.android.packageName.length>0,l,"missing-android-pkg-name"),o.androidInstallApp=c.android.installApp,o.androidMinimumVersionCode=c.android.minimumVersion,o.androidPackageName=c.android.packageName)}function Eo(l){return wo.apply(this,arguments)}function wo(){return(wo=(0,v.Z)(function*(l){const o=Oe(l);o._getPasswordPolicyInternal()&&(yield o._updatePasswordPolicy())})).apply(this,arguments)}function lc(){return(lc=(0,v.Z)(function*(l,o,c){const u=Oe(l),p={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};c&&Ii(u,p,c),yield Gt(u,p,"getOobCode",Zl)})).apply(this,arguments)}function Ao(){return Ao=(0,v.Z)(function*(l,o,c){yield oo((0,k.m9)(l),{oobCode:o,newPassword:c}).catch(function(){var u=(0,v.Z)(function*(p){throw"auth/password-does-not-meet-requirements"===p.code&&Eo(l),p});return function(p){return u.apply(this,arguments)}}())}),Ao.apply(this,arguments)}function jr(){return jr=(0,v.Z)(function*(l,o){yield function qd(l,o){return Lr.apply(this,arguments)}((0,k.m9)(l),{oobCode:o})}),jr.apply(this,arguments)}function pr(l,o){return gs.apply(this,arguments)}function gs(){return(gs=(0,v.Z)(function*(l,o){const c=(0,k.m9)(l),u=yield oo(c,{oobCode:o}),p=u.requestType;switch(M(p,c,"internal-error"),p){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":M(u.newEmail,c,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":M(u.mfaInfo,c,"internal-error");default:M(u.email,c,"internal-error")}let _=null;return u.mfaInfo&&(_=fs._fromServerResponse(Oe(c),u.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===u.requestType?u.newEmail:u.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===u.requestType?u.email:u.newEmail)||null,multiFactorInfo:_},operation:p}})).apply(this,arguments)}function uc(){return(uc=(0,v.Z)(function*(l,o){const{data:c}=yield pr((0,k.m9)(l),o);return c.email})).apply(this,arguments)}function Co(){return(Co=(0,v.Z)(function*(l,o,c){const u=Oe(l),T=yield Gt(u,{returnSecureToken:!0,email:o,password:c,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",sc).catch(O=>{throw"auth/password-does-not-meet-requirements"===O.code&&Eo(l),O}),C=yield Vt._fromIdTokenResponse(u,"signIn",T);return yield u._updateCurrentUser(C.user),C})).apply(this,arguments)}function In(){return(In=(0,v.Z)(function*(l,o,c){const u=Oe(l),p={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};(function _(T,C){M(C.handleCodeInApp,u,"argument-error"),C&&Ii(u,T,C)})(p,c),yield Gt(u,p,"getOobCode",uo)})).apply(this,arguments)}function Po(){return(Po=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l),p=Br.credentialWithLink(o,c||An());return M(p._tenantId===(u.tenantId||null),u,"tenant-id-mismatch"),yi(u,p)})).apply(this,arguments)}function Ti(){return(Ti=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:createAuthUri",Ce(l,o))})).apply(this,arguments)}function Hr(){return Hr=(0,v.Z)(function*(l,o){const u={identifier:o,continueUri:Rr()?An():"http://localhost"},{signinMethods:p}=yield function Fe(l,o){return Ti.apply(this,arguments)}((0,k.m9)(l),u);return p||[]}),Hr.apply(this,arguments)}function xo(){return xo=(0,v.Z)(function*(l,o){const c=(0,k.m9)(l),p={requestType:"VERIFY_EMAIL",idToken:yield l.getIdToken()};o&&Ii(c.auth,p,o);const{email:_}=yield function Wd(l,o){return co.apply(this,arguments)}(c.auth,p);_!==l.email&&(yield l.reload())}),xo.apply(this,arguments)}function dc(){return dc=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield l.getIdToken(),newEmail:o};c&&Ii(u.auth,_,c);const{email:T}=yield function Qa(l,o){return is.apply(this,arguments)}(u.auth,_);T!==l.email&&(yield l.reload())}),dc.apply(this,arguments)}function hc(){return(hc=(0,v.Z)(function*(l,o){return Re(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Nn(){return Nn=(0,v.Z)(function*(l,{displayName:o,photoURL:c}){if(void 0===o&&void 0===c)return;const u=(0,k.m9)(l),_={idToken:yield u.getIdToken(),displayName:o,photoUrl:c,returnSecureToken:!0},T=yield Jt(u,function eh(l,o){return hc.apply(this,arguments)}(u.auth,_));u.displayName=T.displayName||null,u.photoURL=T.photoUrl||null;const C=u.providerData.find(({providerId:O})=>"password"===O);C&&(C.displayName=u.displayName,C.photoURL=u.photoURL),yield u._updateTokensIfNecessary(T)}),Nn.apply(this,arguments)}function fc(l,o,c){return mr.apply(this,arguments)}function mr(){return mr=(0,v.Z)(function*(l,o,c){const{auth:u}=l,_={idToken:yield l.getIdToken(),returnSecureToken:!0};o&&(_.email=o),c&&(_.password=c);const T=yield Jt(l,function Ha(l,o){return ao.apply(this,arguments)}(u,_));yield l._updateTokensIfNecessary(T,!0)}),mr.apply(this,arguments)}class Ei{constructor(o,c,u={}){this.isNewUser=o,this.providerId=c,this.profile=u}}class pc extends Ei{constructor(o,c,u,p){super(o,c,u),this.username=p}}class nh extends Ei{constructor(o,c){super(o,"facebook.com",c)}}class nu extends pc{constructor(o,c){super(o,"github.com",c,"string"==typeof c?.login?c?.login:null)}}class ru extends Ei{constructor(o,c){super(o,"google.com",c)}}class mc extends pc{constructor(o,c,u){super(o,"twitter.com",c,u)}}function gc(l){const{user:o,_tokenResponse:c}=l;return o.isAnonymous&&!c?{providerId:null,isNewUser:!1,profile:null}:function th(l){var o,c;if(!l)return null;const{providerId:u}=l,p=l.rawUserInfo?JSON.parse(l.rawUserInfo):{},_=l.isNewUser||"identitytoolkit#SignupNewUserResponse"===l.kind;if(!u&&l?.idToken){const T=null===(c=null===(o=Nr(l.idToken))||void 0===o?void 0:o.firebase)||void 0===c?void 0:c.sign_in_provider;if(T)return new Ei(_,"anonymous"!==T&&"custom"!==T?T:null)}if(!u)return null;switch(u){case"facebook.com":return new nh(_,p);case"github.com":return new nu(_,p);case"google.com":return new ru(_,p);case"twitter.com":return new mc(_,p,l.screenName||null);case"custom":case"anonymous":return new Ei(_,null);default:return new Ei(_,u,p)}}(c)}class Qr{constructor(o,c,u){this.type=o,this.credential=c,this.user=u}static _fromIdtoken(o,c){return new Qr("enroll",o,c)}static _fromMfaPendingCredential(o){return new Qr("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var c,u;if(o?.multiFactorSession){if(null!==(c=o.multiFactorSession)&&void 0!==c&&c.pendingCredential)return Qr._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(u=o.multiFactorSession)&&void 0!==u&&u.idToken)return Qr._fromIdtoken(o.multiFactorSession.idToken)}return null}}class Ge{constructor(o,c,u){this.session=o,this.hints=c,this.signInResolver=u}static _fromError(o,c){const u=Oe(o),p=c.customData._serverResponse,_=(p.mfaInfo||[]).map(C=>fs._fromServerResponse(u,C));M(p.mfaPendingCredential,u,"internal-error");const T=Qr._fromMfaPendingCredential(p.mfaPendingCredential);return new Ge(T,_,function(){var C=(0,v.Z)(function*(O){const j=yield O._process(u,T);delete p.mfaInfo,delete p.mfaPendingCredential;const J=Object.assign(Object.assign({},p),{idToken:j.idToken,refreshToken:j.refreshToken});switch(c.operationType){case"signIn":const X=yield Vt._fromIdTokenResponse(u,c.operationType,J);return yield u._updateCurrentUser(X.user),X;case"reauthenticate":return M(c.user,u,"internal-error"),Vt._forOperation(c.user,c.operationType,J);default:Le(u,"internal-error")}});return function(O){return C.apply(this,arguments)}}())}resolveSignIn(o){var c=this;return(0,v.Z)(function*(){return c.signInResolver(o)})()}}class Oo{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(c=>{c.mfaInfo&&(this.enrolledFactors=c.mfaInfo.map(u=>fs._fromServerResponse(o.auth,u)))})}static _fromUser(o){return new Oo(o)}getSession(){var o=this;return(0,v.Z)(function*(){return Qr._fromIdtoken(yield o.user.getIdToken(),o.user)})()}enroll(o,c){var u=this;return(0,v.Z)(function*(){const p=o,_=yield u.getSession(),T=yield Jt(u.user,p._process(u.user.auth,_,c));return yield u.user._updateTokensIfNecessary(T),u.user.reload()})()}unenroll(o){var c=this;return(0,v.Z)(function*(){const u="string"==typeof o?o:o.uid,p=yield c.user.getIdToken();try{const _=yield Jt(c.user,function au(l,o){return Re(l,"POST","/v2/accounts/mfaEnrollment:withdraw",Ce(l,o))}(c.user.auth,{idToken:p,mfaEnrollmentId:u}));c.enrolledFactors=c.enrolledFactors.filter(({uid:T})=>T!==u),yield c.user._updateTokensIfNecessary(_),yield c.user.reload()}catch(_){throw _}})()}}const wi=new WeakMap,en="__sak";class Ic{constructor(o,c){this.storageRetriever=o,this.type=c}_isAvailable(){try{return this.storage?(this.storage.setItem(en,"1"),this.storage.removeItem(en),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,c){return this.storage.setItem(o,JSON.stringify(c)),Promise.resolve()}_get(o){const c=this.storage.getItem(o);return Promise.resolve(c?JSON.parse(c):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const vs=(()=>{class l extends Ic{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(c,u)=>this.onStorageEvent(c,u),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function uh(){const l=(0,k.z$)();return xn(l)||he(l)}()&&function un(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=ee(),this._shouldAllowMigration=!0}forAllChangedKeys(c){for(const u of Object.keys(this.listeners)){const p=this.storage.getItem(u),_=this.localCache[u];p!==_&&c(u,_,p)}}onStorageEvent(c,u=!1){if(!c.key)return void this.forAllChangedKeys((C,O,j)=>{this.notifyListeners(C,j)});const p=c.key;if(u?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const C=this.storage.getItem(p);if(c.newValue!==C)null!==c.newValue?this.storage.setItem(p,c.newValue):this.storage.removeItem(p);else if(this.localCache[p]===c.newValue&&!u)return}const _=()=>{const C=this.storage.getItem(p);!u&&this.localCache[p]===C||this.notifyListeners(p,C)},T=this.storage.getItem(p);!function et(){return(0,k.w1)()&&10===document.documentMode}()||T===c.newValue||c.newValue===c.oldValue?_():setTimeout(_,10)}notifyListeners(c,u){this.localCache[c]=u;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(u&&JSON.parse(u))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((c,u,p)=>{this.onStorageEvent(new StorageEvent("storage",{key:c,oldValue:u,newValue:p}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(c,u){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[c]||(this.listeners[c]=new Set,this.localCache[c]=this.storage.getItem(c)),this.listeners[c].add(u)}_removeListener(c,u){this.listeners[c]&&(this.listeners[c].delete(u),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(c,u){var p=()=>super._set,_=this;return(0,v.Z)(function*(){yield p().call(_,c,u),_.localCache[c]=JSON.stringify(u)})()}_get(c){var u=()=>super._get,p=this;return(0,v.Z)(function*(){const _=yield u().call(p,c);return p.localCache[c]=JSON.stringify(_),_})()}_remove(c){var u=()=>super._remove,p=this;return(0,v.Z)(function*(){yield u().call(p,c),delete p.localCache[c]})()}}return l.type="LOCAL",l})(),Tn=(()=>{class l extends Ic{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(c,u){}_removeListener(c,u){}}return l.type="SESSION",l})();let Vo=(()=>{class l{constructor(c){this.eventTarget=c,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(c){const u=this.receivers.find(_=>_.isListeningto(c));if(u)return u;const p=new l(c);return this.receivers.push(p),p}isListeningto(c){return this.eventTarget===c}handleEvent(c){var u=this;return(0,v.Z)(function*(){const p=c,{eventId:_,eventType:T,data:C}=p.data,O=u.handlersMap[T];if(!O?.size)return;p.ports[0].postMessage({status:"ack",eventId:_,eventType:T});const j=Array.from(O).map(function(){var X=(0,v.Z)(function*(je){return je(p.origin,C)});return function(je){return X.apply(this,arguments)}}()),J=yield function du(l){return Promise.all(l.map(function(){var o=(0,v.Z)(function*(c){try{return{fulfilled:!0,value:yield c}}catch(u){return{fulfilled:!1,reason:u}}});return function(c){return o.apply(this,arguments)}}()))}(j);p.ports[0].postMessage({status:"done",eventId:_,eventType:T,response:J})})()}_subscribe(c,u){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[c]||(this.handlersMap[c]=new Set),this.handlersMap[c].add(u)}_unsubscribe(c,u){this.handlersMap[c]&&u&&this.handlersMap[c].delete(u),(!u||0===this.handlersMap[c].size)&&delete this.handlersMap[c],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return l.receivers=[],l})();function Is(l="",o=10){let c="";for(let u=0;u<o;u++)c+=Math.floor(10*Math.random());return l+c}class hu{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,c,u=50){var p=this;return(0,v.Z)(function*(){const _=typeof MessageChannel<"u"?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let T,C;return new Promise((O,j)=>{const J=Is("",20);_.port1.start();const X=setTimeout(()=>{j(new Error("unsupported_event"))},u);C={messageChannel:_,onMessage(je){const ut=je;if(ut.data.eventId===J)switch(ut.data.status){case"ack":clearTimeout(X),T=setTimeout(()=>{j(new Error("timeout"))},3e3);break;case"done":clearTimeout(T),O(ut.data.response);break;default:clearTimeout(X),clearTimeout(T),j(new Error("invalid_response"))}}},p.handlers.add(C),_.port1.addEventListener("message",C.onMessage),p.target.postMessage({eventType:o,eventId:J,data:c},[_.port2])}).finally(()=>{C&&p.removeMessageHandler(C)})})()}}function qe(){return window}function Mo(){return typeof qe().WorkerGlobalScope<"u"&&"function"==typeof qe().importScripts}function Ts(){return(Ts=(0,v.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const wc="firebaseLocalStorageDb",Vn="firebaseLocalStorage",Ac="fbase_key";class Ai{constructor(o){this.request=o}toPromise(){return new Promise((o,c)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{c(this.request.error)})})}}function Es(l,o){return l.transaction([Vn],o?"readwrite":"readonly").objectStore(Vn)}function bi(){const l=indexedDB.open(wc,1);return new Promise((o,c)=>{l.addEventListener("error",()=>{c(l.error)}),l.addEventListener("upgradeneeded",()=>{const u=l.result;try{u.createObjectStore(Vn,{keyPath:Ac})}catch(p){c(p)}}),l.addEventListener("success",(0,v.Z)(function*(){const u=l.result;u.objectStoreNames.contains(Vn)?o(u):(u.close(),yield function gu(){const l=indexedDB.deleteDatabase(wc);return new Ai(l).toPromise()}(),o(yield bi()))}))})}function qt(l,o,c){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,v.Z)(function*(l,o,c){const u=Es(l,!0).put({[Ac]:o,value:c});return new Ai(u).toPromise()})).apply(this,arguments)}function gr(){return(gr=(0,v.Z)(function*(l,o){const c=Es(l,!1).get(o),u=yield new Ai(c).toPromise();return void 0===u?null:u.value})).apply(this,arguments)}function yu(l,o){const c=Es(l,!0).delete(o);return new Ai(c).toPromise()}const Ci=(()=>{class l{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var c=this;return(0,v.Z)(function*(){return c.db||(c.db=yield bi()),c.db})()}_withRetries(c){var u=this;return(0,v.Z)(function*(){let p=0;for(;;)try{const _=yield u._openDb();return yield c(_)}catch(_){if(p++>3)throw _;u.db&&(u.db.close(),u.db=void 0)}})()}initializeServiceWorkerMessaging(){var c=this;return(0,v.Z)(function*(){return Mo()?c.initializeReceiver():c.initializeSender()})()}initializeReceiver(){var c=this;return(0,v.Z)(function*(){c.receiver=Vo._getInstance(function Lo(){return Mo()?self:null}()),c.receiver._subscribe("keyChanged",function(){var u=(0,v.Z)(function*(p,_){return{keyProcessed:(yield c._poll()).includes(_.key)}});return function(p,_){return u.apply(this,arguments)}}()),c.receiver._subscribe("ping",function(){var u=(0,v.Z)(function*(p,_){return["keyChanged"]});return function(p,_){return u.apply(this,arguments)}}())})()}initializeSender(){var c=this;return(0,v.Z)(function*(){var u,p;if(c.activeServiceWorker=yield function Ec(){return Ts.apply(this,arguments)}(),!c.activeServiceWorker)return;c.sender=new hu(c.activeServiceWorker);const _=yield c.sender._send("ping",{},800);_&&null!==(u=_[0])&&void 0!==u&&u.fulfilled&&null!==(p=_[0])&&void 0!==p&&p.value.includes("keyChanged")&&(c.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(c){var u=this;return(0,v.Z)(function*(){if(u.sender&&u.activeServiceWorker&&function pu(){var l;return(null===(l=navigator?.serviceWorker)||void 0===l?void 0:l.controller)||null}()===u.activeServiceWorker)try{yield u.sender._send("keyChanged",{key:c},u.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,v.Z)(function*(){try{if(!indexedDB)return!1;const c=yield bi();return yield qt(c,en,"1"),yield yu(c,en),!0}catch{}return!1})()}_withPendingWrite(c){var u=this;return(0,v.Z)(function*(){u.pendingWrites++;try{yield c()}finally{u.pendingWrites--}})()}_set(c,u){var p=this;return(0,v.Z)(function*(){return p._withPendingWrite((0,v.Z)(function*(){return yield p._withRetries(_=>qt(_,c,u)),p.localCache[c]=u,p.notifyServiceWorker(c)}))})()}_get(c){var u=this;return(0,v.Z)(function*(){const p=yield u._withRetries(_=>function _u(l,o){return gr.apply(this,arguments)}(_,c));return u.localCache[c]=p,p})()}_remove(c){var u=this;return(0,v.Z)(function*(){return u._withPendingWrite((0,v.Z)(function*(){return yield u._withRetries(p=>yu(p,c)),delete u.localCache[c],u.notifyServiceWorker(c)}))})()}_poll(){var c=this;return(0,v.Z)(function*(){const u=yield c._withRetries(T=>{const C=Es(T,!1).getAll();return new Ai(C).toPromise()});if(!u)return[];if(0!==c.pendingWrites)return[];const p=[],_=new Set;if(0!==u.length)for(const{fbase_key:T,value:C}of u)_.add(T),JSON.stringify(c.localCache[T])!==JSON.stringify(C)&&(c.notifyListeners(T,C),p.push(T));for(const T of Object.keys(c.localCache))c.localCache[T]&&!_.has(T)&&(c.notifyListeners(T,null),p.push(T));return p})()}notifyListeners(c,u){this.localCache[c]=u;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(u)}startPolling(){var c=this;this.stopPolling(),this.pollTimer=setInterval((0,v.Z)(function*(){return c._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(c,u){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[c]||(this.listeners[c]=new Set,this._get(c)),this.listeners[c].add(u)}_removeListener(c,u){this.listeners[c]&&(this.listeners[c].delete(u),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return l.type="LOCAL",l})(),Ri=1e12;class Iu{constructor(o){this.auth=o,this.counter=Ri,this._widgets=new Map}render(o,c){const u=this.counter;return this._widgets.set(u,new Qn(o,this.auth.name,c||{})),this.counter++,u}reset(o){var c;const u=o||Ri;null===(c=this._widgets.get(u))||void 0===c||c.delete(),this._widgets.delete(u)}getResponse(o){var c;return(null===(c=this._widgets.get(o||Ri))||void 0===c?void 0:c.getResponse())||""}execute(o){var c=this;return(0,v.Z)(function*(){var u;return null===(u=c._widgets.get(o||Ri))||void 0===u||u.execute(),""})()}}class Qn{constructor(o,c,u){this.params=u,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const p="string"==typeof o?document.getElementById(o):o;M(p,"argument-error",{appName:c}),this.container=p,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function dn(l){const o=[],c="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let u=0;u<l;u++)o.push(c.charAt(Math.floor(62*Math.random())));return o.join("")}(50);const{callback:o,"expired-callback":c}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,c)try{c()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const at=Ga("rcb"),Uo=new Qt(3e4,6e4);class ws{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=qe().grecaptcha)||void 0===o||!o.render)}load(o,c=""){return M(function zo(l){return l.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(l)}(c),o,"argument-error"),this.shouldResolveImmediately(c)&&ft(qe().grecaptcha)?Promise.resolve(qe().grecaptcha):new Promise((u,p)=>{const _=qe().setTimeout(()=>{p(Pe(o,"network-request-failed"))},Uo.get());qe()[at]=()=>{qe().clearTimeout(_),delete qe()[at];const C=qe().grecaptcha;if(!C||!ft(C))return void p(Pe(o,"internal-error"));const O=C.render;C.render=(j,J)=>{const X=O(j,J);return this.counter++,X},this.hostLanguage=c,u(C)},za(`https://www.google.com/recaptcha/api.js??${(0,k.xO)({onload:at,render:"explicit",hl:c})}`).catch(()=>{clearTimeout(_),p(Pe(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var c;return!(null===(c=qe().grecaptcha)||void 0===c||!c.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Tu{load(o){return(0,v.Z)(function*(){return new Iu(o)})()}clearedOneInstance(){}}const Yr="recaptcha",dh={theme:"light",type:"image"};class hh{constructor(o,c,u=Object.assign({},dh)){this.parameters=u,this.type=Yr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Oe(o),this.isInvisible="invisible"===this.parameters.size,M(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const p="string"==typeof c?document.getElementById(c):c;M(p,this.auth,"argument-error"),this.container=p,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Tu:new ws,this.validateStartingState()}verify(){var o=this;return(0,v.Z)(function*(){o.assertNotDestroyed();const c=yield o.render(),u=o.getAssertedRecaptcha();return u.getResponse(c)||new Promise(_=>{const T=C=>{C&&(o.tokenChangeListeners.delete(T),_(C))};o.tokenChangeListeners.add(T),o.isInvisible&&u.execute(c)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){M(!this.parameters.sitekey,this.auth,"argument-error"),M(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),M(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return c=>{if(this.tokenChangeListeners.forEach(u=>u(c)),"function"==typeof o)o(c);else if("string"==typeof o){const u=qe()[o];"function"==typeof u&&u(c)}}}assertNotDestroyed(){M(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,v.Z)(function*(){if(yield o.init(),!o.widgetId){let c=o.container;if(!o.isInvisible){const u=document.createElement("div");c.appendChild(u),c=u}o.widgetId=o.getAssertedRecaptcha().render(c,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,v.Z)(function*(){M(Rr()&&!Mo(),o.auth,"internal-error"),yield function Rc(){let l=null;return new Promise(o=>{"complete"!==document.readyState?(l=()=>o(),window.addEventListener("load",l)):o()}).catch(o=>{throw l&&window.removeEventListener("load",l),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const c=yield function Fa(l){return Ot.apply(this,arguments)}(o.auth);M(c,o.auth,"internal-error"),o.parameters.sitekey=c})()}getAssertedRecaptcha(){return M(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Pc{constructor(o,c){this.verificationId=o,this.onConfirmation=c}confirm(o){const c=Ur._fromVerification(this.verificationId,o);return this.onConfirmation(c)}}function Go(){return(Go=(0,v.Z)(function*(l,o,c){const u=Oe(l),p=yield Yn(u,o,(0,k.m9)(c));return new Pc(p,_=>yi(u,_))})).apply(this,arguments)}function Pi(){return(Pi=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l);yield ls(!1,u,"phone");const p=yield Yn(u.auth,o,(0,k.m9)(c));return new Pc(p,_=>ac(u,_))})).apply(this,arguments)}function xc(){return(xc=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l),p=yield Yn(u.auth,o,(0,k.m9)(c));return new Pc(p,_=>vo(u,_))})).apply(this,arguments)}function Yn(l,o,c){return qo.apply(this,arguments)}function qo(){return qo=(0,v.Z)(function*(l,o,c){var u;const p=yield c.verify();try{let _;if(M("string"==typeof p,l,"argument-error"),M(c.type===Yr,l,"argument-error"),_="string"==typeof o?{phoneNumber:o}:o,"session"in _){const T=_.session;if("phoneNumber"in _)return M("enroll"===T.type,l,"internal-error"),(yield function ch(l,o){return Re(l,"POST","/v2/accounts/mfaEnrollment:start",Ce(l,o))}(l,{idToken:T.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:p}})).phoneSessionInfo.sessionInfo;{M("signin"===T.type,l,"internal-error");const C=(null===(u=_.multiFactorHint)||void 0===u?void 0:u.uid)||_.multiFactorUid;return M(C,l,"missing-multi-factor-info"),(yield function Cc(l,o){return Re(l,"POST","/v2/accounts/mfaSignIn:start",Ce(l,o))}(l,{mfaPendingCredential:T.credential,mfaEnrollmentId:C,phoneSignInInfo:{recaptchaToken:p}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:T}=yield function Xa(l,o){return os.apply(this,arguments)}(l,{phoneNumber:_.phoneNumber,recaptchaToken:p});return T}}finally{c._reset()}}),qo.apply(this,arguments)}function _r(){return(_r=(0,v.Z)(function*(l,o){yield go((0,k.m9)(l),o)})).apply(this,arguments)}let hn=(()=>{class l{constructor(c){this.providerId=l.PROVIDER_ID,this.auth=Oe(c)}verifyPhoneNumber(c,u){return Yn(this.auth,c,(0,k.m9)(u))}static credential(c,u){return Ur._fromVerification(c,u)}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{phoneNumber:u,temporaryProof:p}=c;return u&&p?Ur._fromTokenResponse(u,p):null}}return l.PROVIDER_ID="phone",l.PHONE_SIGN_IN_METHOD="phone",l})();function fn(l,o){return o?ge(o):(M(l._popupRedirectResolver,l,"argument-error"),l._popupRedirectResolver)}class Dc extends lr{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return kn(o,this._buildIdpRequest())}_linkToIdToken(o,c){return kn(o,this._buildIdpRequest(c))}_getReauthenticationResolver(o){return kn(o,this._buildIdpRequest())}_buildIdpRequest(o){const c={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(c.idToken=o),c}}function U(l){return us(l.auth,new Dc(l),l.bypassAuthState)}function tt(l){const{auth:o,user:c}=l;return M(c,o,"internal-error"),oc(c,new Dc(l),l.bypassAuthState)}function Zt(l){return As.apply(this,arguments)}function As(){return(As=(0,v.Z)(function*(l){const{auth:o,user:c}=l;return M(c,o,"internal-error"),go(c,new Dc(l),l.bypassAuthState)})).apply(this,arguments)}class Y{constructor(o,c,u,p,_=!1){this.auth=o,this.resolver=u,this.user=p,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(c)?c:[c]}execute(){var o=this;return new Promise(function(){var c=(0,v.Z)(function*(u,p){o.pendingPromise={resolve:u,reject:p};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(_){o.reject(_)}});return function(u,p){return c.apply(this,arguments)}}())}onAuthEvent(o){var c=this;return(0,v.Z)(function*(){const{urlResponse:u,sessionId:p,postBody:_,tenantId:T,error:C,type:O}=o;if(C)return void c.reject(C);const j={auth:c.auth,requestUri:u,sessionId:p,tenantId:T||void 0,postBody:_||void 0,user:c.user,bypassAuthState:c.bypassAuthState};try{c.resolve(yield c.getIdpTask(O)(j))}catch(J){c.reject(J)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return U;case"linkViaPopup":case"linkViaRedirect":return Zt;case"reauthViaPopup":case"reauthViaRedirect":return tt;default:Le(this.auth,"internal-error")}}resolve(o){nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ne=new Qt(2e3,1e4);function W(){return(W=(0,v.Z)(function*(l,o,c){const u=Oe(l);Ee(l,o,Xt);const p=fn(u,c);return new kc(u,"signInViaPopup",o,p).executeNotNull()})).apply(this,arguments)}function V(){return(V=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l);Ee(u.auth,o,Xt);const p=fn(u.auth,c);return new kc(u.auth,"reauthViaPopup",o,p,u).executeNotNull()})).apply(this,arguments)}function Zo(){return(Zo=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l);Ee(u.auth,o,Xt);const p=fn(u.auth,c);return new kc(u.auth,"linkViaPopup",o,p,u).executeNotNull()})).apply(this,arguments)}let kc=(()=>{class l extends Y{constructor(c,u,p,_,T){super(c,u,_,T),this.provider=p,this.authWindow=null,this.pollId=null,l.currentPopupAction&&l.currentPopupAction.cancel(),l.currentPopupAction=this}executeNotNull(){var c=this;return(0,v.Z)(function*(){const u=yield c.execute();return M(u,c.auth,"internal-error"),u})()}onExecution(){var c=this;return(0,v.Z)(function*(){nt(1===c.filter.length,"Popup operations only handle one event");const u=Is();c.authWindow=yield c.resolver._openPopup(c.auth,c.provider,c.filter[0],u),c.authWindow.associatedEvent=u,c.resolver._originValidation(c.auth).catch(p=>{c.reject(p)}),c.resolver._isIframeWebStorageSupported(c.auth,p=>{p||c.reject(Pe(c.auth,"web-storage-unsupported"))}),c.pollUserCancellation()})()}get eventId(){var c;return(null===(c=this.authWindow)||void 0===c?void 0:c.associatedEvent)||null}cancel(){this.reject(Pe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,l.currentPopupAction=null}pollUserCancellation(){const c=()=>{var u,p;this.pollId=null!==(p=null===(u=this.authWindow)||void 0===u?void 0:u.window)&&void 0!==p&&p.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Pe(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(c,ne.get())};c()}}return l.currentPopupAction=null,l})();const gh="pendingRedirect",bs=new Map;class _h extends Y{constructor(o,c,u=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],c,void 0,u),this.eventId=null}execute(){var o=()=>super.execute,c=this;return(0,v.Z)(function*(){let u=bs.get(c.auth._key());if(!u){try{const _=(yield function yh(l,o){return Wo.apply(this,arguments)}(c.resolver,c.auth))?yield o().call(c):null;u=()=>Promise.resolve(_)}catch(p){u=()=>Promise.reject(p)}bs.set(c.auth._key(),u)}return c.bypassAuthState||bs.set(c.auth._key(),()=>Promise.resolve(null)),u()})()}onAuthEvent(o){var c=()=>super.onAuthEvent,u=this;return(0,v.Z)(function*(){if("signInViaRedirect"===o.type)return c().call(u,o);if("unknown"!==o.type){if(o.eventId){const p=yield u.auth._redirectUserForId(o.eventId);if(p)return u.user=p,c().call(u,o);u.resolve(null)}}else u.resolve(null)})()}onExecution(){return(0,v.Z)(function*(){})()}cleanUp(){}}function Wo(){return(Wo=(0,v.Z)(function*(l,o){const c=Jr(o),u=le(l);if(!(yield u._isAvailable()))return!1;const p="true"===(yield u._get(c));return yield u._remove(c),p})).apply(this,arguments)}function Oc(l,o){return Eu.apply(this,arguments)}function Eu(){return(Eu=(0,v.Z)(function*(l,o){return le(l)._set(Jr(o),"true")})).apply(this,arguments)}function jo(l,o){bs.set(l._key(),o)}function le(l){return ge(l._redirectPersistence)}function Jr(l){return rt(gh,l.config.apiKey,l.name)}function wu(l,o,c){return function Ze(l,o,c){return re.apply(this,arguments)}(l,o,c)}function re(){return(re=(0,v.Z)(function*(l,o,c){const u=Oe(l);Ee(l,o,Xt),yield u._initializationPromise;const p=fn(u,c);return yield Oc(p,u),p._openRedirect(u,o,"signInViaRedirect")})).apply(this,arguments)}function Cs(l,o,c){return function Ae(l,o,c){return Nc.apply(this,arguments)}(l,o,c)}function Nc(){return(Nc=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l);Ee(u.auth,o,Xt),yield u.auth._initializationPromise;const p=fn(u.auth,c);yield Oc(p,u.auth);const _=yield Au(u);return p._openRedirect(u.auth,o,"reauthViaRedirect",_)})).apply(this,arguments)}function Ue(l,o,c){return function $(l,o,c){return yr.apply(this,arguments)}(l,o,c)}function yr(){return(yr=(0,v.Z)(function*(l,o,c){const u=(0,k.m9)(l);Ee(u.auth,o,Xt),yield u.auth._initializationPromise;const p=fn(u.auth,c);yield ls(!1,u,o.providerId),yield Oc(p,u.auth);const _=yield Au(u);return p._openRedirect(u.auth,o,"linkViaRedirect",_)})).apply(this,arguments)}function Jn(){return(Jn=(0,v.Z)(function*(l,o){return yield Oe(l)._initializationPromise,$o(l,o,!1)})).apply(this,arguments)}function $o(l,o){return Xn.apply(this,arguments)}function Xn(){return(Xn=(0,v.Z)(function*(l,o,c=!1){const u=Oe(l),p=fn(u,o),T=yield new _h(u,p,c).execute();return T&&!c&&(delete T.user._redirectEventId,yield u._persistUserIfCurrent(T.user),yield u._setRedirectUser(null,o)),T})).apply(this,arguments)}function Au(l){return vr.apply(this,arguments)}function vr(){return(vr=(0,v.Z)(function*(l){const o=Is(`${l.uid}:::`);return l._redirectEventId=o,yield l.auth._setRedirectUser(l),yield l.auth._persistUserIfCurrent(l),o})).apply(this,arguments)}class Mc{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let c=!1;return this.consumers.forEach(u=>{this.isEventForConsumer(o,u)&&(c=!0,this.sendToConsumer(o,u),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function Cu(l){switch(l.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ho(l);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,c||(this.queuedRedirectEvent=o,c=!0)),c}sendToConsumer(o,c){var u;if(o.error&&!Ho(o)){const p=(null===(u=o.error.code)||void 0===u?void 0:u.split("auth/")[1])||"internal-error";c.onError(Pe(this.auth,p))}else c.onAuthEvent(o)}isEventForConsumer(o,c){const u=null===c.eventId||!!o.eventId&&o.eventId===c.eventId;return c.filter.includes(o.type)&&u}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wt(o))}saveEventToCache(o){this.cachedEventUids.add(Wt(o)),this.lastProcessedEventTime=Date.now()}}function Wt(l){return[l.type,l.eventId,l.sessionId,l.tenantId].filter(o=>o).join("-")}function Ho({type:l,error:o}){return"unknown"===l&&"auth/no-auth-event"===o?.code}function Lc(l){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,v.Z)(function*(l,o={}){return Re(l,"GET","/v1/projects",o)})).apply(this,arguments)}const Fc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,S=/^https?/;function tn(){return(tn=(0,v.Z)(function*(l){if(l.config.emulator)return;const{authorizedDomains:o}=yield Lc(l);for(const c of o)try{if(Ih(c))return}catch{}Le(l,"unauthorized-domain")})).apply(this,arguments)}function Ih(l){const o=An(),{protocol:c,hostname:u}=new URL(o);if(l.startsWith("chrome-extension://")){const T=new URL(l);return""===T.hostname&&""===u?"chrome-extension:"===c&&l.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===c&&T.hostname===u}if(!S.test(c))return!1;if(Fc.test(l))return u===l;const p=l.replace(/\./g,"\\.");return new RegExp("^(.+\\."+p+"|"+p+")$","i").test(u)}const Ss=new Qt(3e4,6e4);function er(){const l=qe().___jsl;if(l?.H)for(const o of Object.keys(l.H))if(l.H[o].r=l.H[o].r||[],l.H[o].L=l.H[o].L||[],l.H[o].r=[...l.H[o].L],l.CP)for(let c=0;c<l.CP.length;c++)l.CP[c]=null}let Fn=null;const Uc=new Qt(5e3,15e3),Eh="__/auth/iframe",wh="emulator/auth/iframe",nn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Rs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ps(l){const o=l.config;M(o.authDomain,l,"auth-domain-config-required");const c=o.emulator?$n(o,wh):`https://${l.config.authDomain}/${Eh}`,u={apiKey:o.apiKey,appName:l.name,v:te.SDK_VERSION},p=Rs.get(l.config.apiHost);p&&(u.eid=p);const _=l._getFrameworks();return _.length&&(u.fw=_.join(",")),`${c}?${(0,k.xO)(u).slice(1)}`}function mt(){return mt=(0,v.Z)(function*(l){const o=yield function Su(l){return Fn=Fn||function Th(l){return new Promise((o,c)=>{var u,p,_;function T(){er(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{er(),c(Pe(l,"network-request-failed"))},timeout:Ss.get()})}if(null!==(p=null===(u=qe().gapi)||void 0===u?void 0:u.iframes)&&void 0!==p&&p.Iframe)o(gapi.iframes.getContext());else{if(null===(_=qe().gapi)||void 0===_||!_.load){const C=Ga("iframefcb");return qe()[C]=()=>{gapi.load?T():c(Pe(l,"network-request-failed"))},za(`https://apis.google.com/js/api.js?onload=${C}`).catch(O=>c(O))}T()}}).catch(o=>{throw Fn=null,o})}(l),Fn}(l),c=qe().gapi;return M(c,l,"internal-error"),o.open({where:document.body,url:Ps(l),messageHandlersFilter:c.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nn,dontclear:!0},u=>new Promise(function(){var p=(0,v.Z)(function*(_,T){yield u.restyle({setHideOnLeave:!1});const C=Pe(l,"network-request-failed"),O=qe().setTimeout(()=>{T(C)},Uc.get());function j(){qe().clearTimeout(O),_(u)}u.ping(j).then(j,()=>{T(C)})});return function(_,T){return p.apply(this,arguments)}}()))}),mt.apply(this,arguments)}const Ah={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Bc{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Sh="__/auth/handler",Rh="emulator/auth/handler",Ph=encodeURIComponent("fac");function zc(l,o,c,u,p,_){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,v.Z)(function*(l,o,c,u,p,_){M(l.config.authDomain,l,"auth-domain-config-required"),M(l.config.apiKey,l,"invalid-api-key");const T={apiKey:l.config.apiKey,appName:l.name,authType:c,redirectUrl:u,v:te.SDK_VERSION,eventId:p};if(o instanceof Xt){o.setDefaultLanguage(l.languageCode),T.providerId=o.providerId||"",(0,k.xb)(o.getCustomParameters())||(T.customParameters=JSON.stringify(o.getCustomParameters()));for(const[J,X]of Object.entries(_||{}))T[J]=X}if(o instanceof ur){const J=o.getScopes().filter(X=>""!==X);J.length>0&&(T.scopes=J.join(","))}l.tenantId&&(T.tid=l.tenantId);const C=T;for(const J of Object.keys(C))void 0===C[J]&&delete C[J];const O=yield l._getAppCheckToken(),j=O?`#${Ph}=${encodeURIComponent(O)}`:"";return`${function xh({config:l}){return l.emulator?$n(l,Rh):`https://${l.authDomain}/${Sh}`}(l)}?${(0,k.xO)(C).slice(1)}${j}`})).apply(this,arguments)}const qc="webStorageSupport",Du=class Dh{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tn,this._completeRedirectFn=$o,this._overrideRedirectResult=jo}_openPopup(o,c,u,p){var _=this;return(0,v.Z)(function*(){var T;nt(null===(T=_.eventManagers[o._key()])||void 0===T?void 0:T.manager,"_initialize() not called before _openPopup()");const C=yield zc(o,c,u,An(),p);return function bh(l,o,c,u=500,p=600){const _=Math.max((window.screen.availHeight-p)/2,0).toString(),T=Math.max((window.screen.availWidth-u)/2,0).toString();let C="";const O=Object.assign(Object.assign({},Ah),{width:u.toString(),height:p.toString(),top:_,left:T}),j=(0,k.z$)().toLowerCase();c&&(C=io(j)?"_blank":c),vn(j)&&(o=o||"http://localhost",O.scrollbars="yes");const J=Object.entries(O).reduce((je,[ut,ca])=>`${je}${ut}=${ca},`,"");if(function F(l=(0,k.z$)()){var o;return he(l)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(j)&&"_self"!==C)return function Ch(l,o){const c=document.createElement("a");c.href=l,c.target=o;const u=document.createEvent("MouseEvent");u.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),c.dispatchEvent(u)}(o||"",C),new Bc(null);const X=window.open(o||"",C,J);M(X,l,"popup-blocked");try{X.focus()}catch{}return new Bc(X)}(o,C,Is())})()}_openRedirect(o,c,u,p){var _=this;return(0,v.Z)(function*(){return yield _._originValidation(o),function fu(l){qe().location.href=l}(yield zc(o,c,u,An(),p)),new Promise(()=>{})})()}_initialize(o){const c=o._key();if(this.eventManagers[c]){const{manager:p,promise:_}=this.eventManagers[c];return p?Promise.resolve(p):(nt(_,"If manager is not set, promise should be"),_)}const u=this.initAndGetManager(o);return this.eventManagers[c]={promise:u},u.catch(()=>{delete this.eventManagers[c]}),u}initAndGetManager(o){var c=this;return(0,v.Z)(function*(){const u=yield function Ru(l){return mt.apply(this,arguments)}(o),p=new Mc(o);return u.register("authEvent",_=>(M(_?.authEvent,o,"invalid-auth-event"),{status:p.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),c.eventManagers[o._key()]={manager:p},c.iframes[o._key()]=u,p})()}_isIframeWebStorageSupported(o,c){this.iframes[o._key()].send(qc,{type:qc},p=>{var _;const T=null===(_=p?.[0])||void 0===_?void 0:_[qc];void 0!==T&&c(!!T),Le(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function Ko(l){return tn.apply(this,arguments)}(o)),this.originValidationPromises[c]}get _shouldInitProactively(){return ee()||xn()||he()}};class kh{constructor(o){this.factorId=o}_process(o,c,u){switch(c.type){case"enroll":return this._finalizeEnroll(o,c.credential,u);case"signin":return this._finalizeSignIn(o,c.credential);default:return Je("unexpected MultiFactorSessionType")}}}class Zc extends kh{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new Zc(o)}_finalizeEnroll(o,c,u){return function lh(l,o){return Re(l,"POST","/v2/accounts/mfaEnrollment:finalize",Ce(l,o))}(o,{idToken:c,displayName:u,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,c){return function Mn(l,o){return Re(l,"POST","/v2/accounts/mfaSignIn:finalize",Ce(l,o))}(o,{mfaPendingCredential:c,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Oh=(()=>{class l{constructor(){}static assertion(c){return Zc._fromCredential(c)}}return l.FACTOR_ID="phone",l})();var Wc="@firebase/auth";class jc{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var c=this;return(0,v.Z)(function*(){return c.assertAuthConfigured(),yield c.auth._initializationPromise,c.auth.currentUser?{accessToken:yield c.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const c=this.auth.onIdTokenChanged(u=>{o(u?.stsTokenManager.accessToken||null)});this.internalListeners.set(o,c),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const c=this.internalListeners.get(o);c&&(this.internalListeners.delete(o),c(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function be(){return window}(0,k.Pz)("authIdTokenMaxAge"),function Nu(l){(0,te._registerComponent)(new Ye.wA("auth",(o,{options:c})=>{const u=o.getProvider("app").getImmediate(),p=o.getProvider("heartbeat"),_=o.getProvider("app-check-internal"),{apiKey:T,authDomain:C}=u.options;M(T&&!T.includes(":"),"invalid-api-key",{appName:u.name});const O={apiKey:T,authDomain:C,clientPlatform:l,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dn(l)},j=new bt(u,p,_,O);return function ql(l,o){const c=o?.persistence||[],u=(Array.isArray(c)?c:[c]).map(ge);o?.errorMap&&l._updateErrorMap(o.errorMap),l._initializeWithPersistence(u,o?.popupRedirectResolver)}(j,c),j},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,c,u)=>{o.getProvider("auth-internal").initialize()})),(0,te._registerComponent)(new Ye.wA("auth-internal",o=>{const c=Oe(o.getProvider("auth").getImmediate());return new jc(c)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,te.registerVersion)(Wc,"1.5.1",function gt(l){switch(l){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(l)),(0,te.registerVersion)(Wc,"1.5.1","esm2017")}("Browser");function Rt(){return Rt=(0,v.Z)(function*(l,o,c){var u;const{BuildInfo:p}=be();nt(o.sessionId,"AuthEvent did not contain a session ID");const _=yield function tr(l){return Di.apply(this,arguments)}(o.sessionId),T={};return he()?T.ibi=p.packageName:P()?T.apn=p.packageName:Le(l,"operation-not-supported-in-this-environment"),p.displayName&&(T.appDisplayName=p.displayName),T.sessionId=_,zc(l,c,o.type,void 0,null!==(u=o.eventId)&&void 0!==u?u:void 0,T)}),Rt.apply(this,arguments)}function $c(){return($c=(0,v.Z)(function*(l){const{BuildInfo:o}=be(),c={};he()?c.iosBundleId=o.packageName:P()?c.androidPackageName=o.packageName:Le(l,"operation-not-supported-in-this-environment"),yield Lc(l,c)})).apply(this,arguments)}function Bn(){return(Bn=(0,v.Z)(function*(l,o,c){const{cordova:u}=be();let p=()=>{};try{yield new Promise((_,T)=>{let C=null;function O(){var X;_();const je=null===(X=u.plugins.browsertab)||void 0===X?void 0:X.close;"function"==typeof je&&je(),"function"==typeof c?.close&&c.close()}function j(){C||(C=window.setTimeout(()=>{T(Pe(l,"redirect-cancelled-by-user"))},2e3))}function J(){"visible"===document?.visibilityState&&j()}o.addPassiveListener(O),document.addEventListener("resume",j,!1),P()&&document.addEventListener("visibilitychange",J,!1),p=()=>{o.removePassiveListener(O),document.removeEventListener("resume",j,!1),document.removeEventListener("visibilitychange",J,!1),C&&window.clearTimeout(C)}})}finally{p()}})).apply(this,arguments)}function Di(){return(Di=(0,v.Z)(function*(l){const o=function Xo(l){if(nt(/[0-9a-zA-Z]+/.test(l),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(l);const o=new ArrayBuffer(l.length),c=new Uint8Array(o);for(let u=0;u<l.length;u++)c[u]=l.charCodeAt(u);return c}(l),c=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(c)).map(p=>p.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Vh extends Mc{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(c=>c(o)),super.onEvent(o)}initialized(){var o=this;return(0,v.Z)(function*(){yield o.initPromise})()}}function ks(l){return zn.apply(this,arguments)}function zn(){return(zn=(0,v.Z)(function*(l){const o=yield qn()._get(ea(l));return o&&(yield qn()._remove(ea(l))),o})).apply(this,arguments)}function Os(){const l=[];for(let c=0;c<20;c++){const u=Math.floor(62*Math.random());l.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(u))}return l.join("")}function qn(){return ge(vs)}function ea(l){return rt("authEvent",l.config.apiKey,l.name)}function Xr(l){if(!l?.includes("?"))return{};const[o,...c]=l.split("?");return(0,k.zd)(c.join("?"))}const Ns=class Kc{constructor(){this._redirectPersistence=Tn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=$o,this._overrideRedirectResult=jo}_initialize(o){var c=this;return(0,v.Z)(function*(){const u=o._key();let p=c.eventManagers.get(u);return p||(p=new Vh(o),c.eventManagers.set(u,p),c.attachCallbackListeners(o,p)),p})()}_openPopup(o){Le(o,"operation-not-supported-in-this-environment")}_openRedirect(o,c,u,p){var _=this;return(0,v.Z)(function*(){!function Ke(l){var o,c,u,p,_,T,C,O,j,J;const X=be();M("function"==typeof(null===(o=X?.universalLinks)||void 0===o?void 0:o.subscribe),l,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),M(typeof(null===(c=X?.BuildInfo)||void 0===c?void 0:c.packageName)<"u",l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),M("function"==typeof(null===(_=null===(p=null===(u=X?.cordova)||void 0===u?void 0:u.plugins)||void 0===p?void 0:p.browsertab)||void 0===_?void 0:_.openUrl),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M("function"==typeof(null===(O=null===(C=null===(T=X?.cordova)||void 0===T?void 0:T.plugins)||void 0===C?void 0:C.browsertab)||void 0===O?void 0:O.isAvailable),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),M("function"==typeof(null===(J=null===(j=X?.cordova)||void 0===j?void 0:j.InAppBrowser)||void 0===J?void 0:J.open),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const T=yield _._initialize(o);yield T.initialized(),T.resetRedirect(),function vh(){bs.clear()}(),yield _._originValidation(o);const C=function Tr(l,o,c=null){return{type:o,eventId:c,urlResponse:null,sessionId:Os(),postBody:null,tenantId:l.tenantId,error:Pe(l,"no-auth-event")}}(o,u,p);yield function Er(l,o){return qn()._set(ea(l),o)}(o,C);const O=yield function xi(l,o,c){return Rt.apply(this,arguments)}(o,C,c),j=yield function lt(l){const{cordova:o}=be();return new Promise(c=>{o.plugins.browsertab.isAvailable(u=>{let p=null;u?o.plugins.browsertab.openUrl(l):p=o.InAppBrowser.open(l,function de(l=(0,k.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(l)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(l)}()?"_blank":"_system","location=yes"),c(p)})})}(O);return function Nh(l,o,c){return Bn.apply(this,arguments)}(o,T,j)})()}_isIframeWebStorageSupported(o,c){throw new Error("Method not implemented.")}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function Lu(l){return $c.apply(this,arguments)}(o)),this.originValidationPromises[c]}attachCallbackListeners(o,c){const{universalLinks:u,handleOpenURL:p,BuildInfo:_}=be(),T=setTimeout((0,v.Z)(function*(){yield ks(o),c.onEvent(Qc())}),500),C=function(){var J=(0,v.Z)(function*(X){clearTimeout(T);const je=yield ks(o);let ut=null;je&&X?.url&&(ut=function Gn(l,o){var c,u;const p=function Hc(l){const o=Xr(l),c=o.link?decodeURIComponent(o.link):void 0,u=Xr(c).link,p=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return Xr(p).link||p||u||c||l}(o);if(p.includes("/__/auth/callback")){const _=Xr(p),T=_.firebaseError?function ki(l){try{return JSON.parse(l)}catch{return null}}(decodeURIComponent(_.firebaseError)):null,C=null===(u=null===(c=T?.code)||void 0===c?void 0:c.split("auth/"))||void 0===u?void 0:u[1],O=C?Pe(C):null;return O?{type:l.type,eventId:l.eventId,tenantId:l.tenantId,error:O,urlResponse:null,sessionId:null,postBody:null}:{type:l.type,eventId:l.eventId,tenantId:l.tenantId,sessionId:l.sessionId,urlResponse:p,postBody:null}}return null}(je,X.url)),c.onEvent(ut||Qc())});return function(je){return J.apply(this,arguments)}}();typeof u<"u"&&"function"==typeof u.subscribe&&u.subscribe(null,C);const O=p,j=`${_.packageName.toLowerCase()}://`;be().handleOpenURL=function(){var J=(0,v.Z)(function*(X){if(X.toLowerCase().startsWith(j)&&C({url:X}),"function"==typeof O)try{O(X)}catch(je){console.error(je)}});return function(X){return J.apply(this,arguments)}}()}};function Qc(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Pe("no-auth-event")}}function Ms(){var l;return(null===(l=self?.location)||void 0===l?void 0:l.protocol)||null}function Yc(l=(0,k.z$)()){return!("file:"!==Ms()&&"ionic:"!==Ms()&&"capacitor:"!==Ms()||!l.toLowerCase().match(/iphone|ipad|ipod|android/))}function nr(){try{const l=self.localStorage,o=Is();if(l)return l.setItem(o,"1"),l.removeItem(o),!function Be(l=(0,k.z$)()){return function It(){return(0,k.w1)()&&11===document?.documentMode}()||function zu(l=(0,k.z$)()){return/Edge\/\d+/.test(l)}(l)}()||(0,k.hl)()}catch{return na()&&(0,k.hl)()}return!1}function na(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ra(){return(function Mh(){return"http:"===Ms()||"https:"===Ms()}()||(0,k.ru)()||Yc())&&!function Bu(){return(0,k.b$)()||(0,k.UG)()}()&&nr()&&!na()}function Oi(){return Yc()&&typeof document<"u"}function ia(){return(ia=(0,v.Z)(function*(){return!!Oi()&&new Promise(l=>{const o=setTimeout(()=>{l(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),l(!0)})})})).apply(this,arguments)}const me={LOCAL:"local",NONE:"none",SESSION:"session"},Zn=M,sa="persistence";function oa(l){return Ls.apply(this,arguments)}function Ls(){return(Ls=(0,v.Z)(function*(l){yield l._initializationPromise;const o=Xc(),c=rt(sa,l.config.apiKey,l.name);o&&o.setItem(c,l._getPersistence())})).apply(this,arguments)}function Xc(){var l;try{return(null===(l=function Te(){return typeof window<"u"?window:null}())||void 0===l?void 0:l.sessionStorage)||null}catch{return null}}const qu=M;class wr{constructor(){this.browserResolver=ge(Du),this.cordovaResolver=ge(Ns),this.underlyingResolver=null,this._redirectPersistence=Tn,this._completeRedirectFn=$o,this._overrideRedirectResult=jo}_initialize(o){var c=this;return(0,v.Z)(function*(){return yield c.selectUnderlyingResolver(),c.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,c,u,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(o,c,u,p)})()}_openRedirect(o,c,u,p){var _=this;return(0,v.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(o,c,u,p)})()}_isIframeWebStorageSupported(o,c){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,c)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Oi()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return qu(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,v.Z)(function*(){if(o.underlyingResolver)return;const c=yield function Lh(){return ia.apply(this,arguments)}();o.underlyingResolver=c?o.cordovaResolver:o.browserResolver})()}}function Zu(l){return l.unwrap()}function Wu(l){return el(l)}function el(l){const{_tokenResponse:o}=l instanceof k.ZR?l.customData:l;if(!o)return null;if(!(l instanceof k.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return hn.credentialFromResult(l);const c=o.providerId;if(!c||c===ze.PASSWORD)return null;let u;switch(c){case ze.GOOGLE:u=cs;break;case ze.FACEBOOK:u=Hl;break;case ze.GITHUB:u=fo;break;case ze.TWITTER:u=ic;break;default:const{oauthIdToken:p,oauthAccessToken:_,oauthTokenSecret:T,pendingToken:C,nonce:O}=o;return _||T||p||C?C?c.startsWith("saml.")?Gr._create(c,C):On._fromParams({providerId:c,signInMethod:c,pendingToken:C,idToken:p,accessToken:_}):new zr(c).credential({idToken:p,accessToken:_,rawNonce:O}):null}return l instanceof k.ZR?u.credentialFromError(l):u.credentialFromResult(l)}function jt(l,o){return o.catch(c=>{throw c instanceof k.ZR&&function Uh(l,o){var c;const u=null===(c=o.customData)||void 0===c?void 0:c._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new rl(l,function su(l,o){var c;const u=(0,k.m9)(l),p=o;return M(o.customData.operationType,u,"argument-error"),M(null===(c=p.customData._serverResponse)||void 0===c?void 0:c.mfaPendingCredential,u,"argument-error"),Ge._fromError(u,p)}(l,o));else if(u){const p=el(o),_=o;p&&(_.credential=p,_.tenantId=u.tenantId||void 0,_.email=u.email||void 0,_.phoneNumber=u.phoneNumber||void 0)}}(l,c),c}).then(c=>{const p=c.user;return{operationType:c.operationType,credential:Wu(c),additionalUserInfo:gc(c),user:Mt.getOrCreate(p)}})}function tl(l,o){return nl.apply(this,arguments)}function nl(){return(nl=(0,v.Z)(function*(l,o){const c=yield o;return{verificationId:c.verificationId,confirm:u=>jt(l,c.confirm(u))}})).apply(this,arguments)}class rl{constructor(o,c){this.resolver=c,this.auth=function Fh(l){return l.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return jt(Zu(this.auth),this.resolver.resolveSignIn(o))}}class Mt{constructor(o){this._delegate=o,this.multiFactor=function cu(l){const o=(0,k.m9)(l);return wi.has(o)||wi.set(o,Oo._fromUser(o)),wi.get(o)}(o)}static getOrCreate(o){return Mt.USER_MAP.has(o)||Mt.USER_MAP.set(o,new Mt(o)),Mt.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var c=this;return(0,v.Z)(function*(){return jt(c.auth,ac(c._delegate,o))})()}linkWithPhoneNumber(o,c){var u=this;return(0,v.Z)(function*(){return tl(u.auth,function Yp(l,o,c){return Pi.apply(this,arguments)}(u._delegate,o,c))})()}linkWithPopup(o){var c=this;return(0,v.Z)(function*(){return jt(c.auth,function ct(l,o,c){return Zo.apply(this,arguments)}(c._delegate,o,wr))})()}linkWithRedirect(o){var c=this;return(0,v.Z)(function*(){return yield oa(Oe(c.auth)),Ue(c._delegate,o,wr)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var c=this;return(0,v.Z)(function*(){return jt(c.auth,vo(c._delegate,o))})()}reauthenticateWithPhoneNumber(o,c){return tl(this.auth,function ph(l,o,c){return xc.apply(this,arguments)}(this._delegate,o,c))}reauthenticateWithPopup(o){return jt(this.auth,function D(l,o,c){return V.apply(this,arguments)}(this._delegate,o,wr))}reauthenticateWithRedirect(o){var c=this;return(0,v.Z)(function*(){return yield oa(Oe(c.auth)),Cs(c._delegate,o,wr)})()}sendEmailVerification(o){return function Jd(l,o){return xo.apply(this,arguments)}(this._delegate,o)}unlink(o){var c=this;return(0,v.Z)(function*(){return yield function Yl(l,o){return _i.apply(this,arguments)}(c._delegate,o),c})()}updateEmail(o){return function eu(l,o){return fc((0,k.m9)(l),o,null)}(this._delegate,o)}updatePassword(o){return function tu(l,o){return fc((0,k.m9)(l),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function pt(l,o){return _r.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function ys(l,o){return Nn.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,c){return function Xd(l,o,c){return dc.apply(this,arguments)}(this._delegate,o,c)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Mt.USER_MAP=new WeakMap;const rr=M;let Fs=(()=>{class l{constructor(c,u){if(this.app=c,u.isInitialized())return this._delegate=u.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:p}=c.options;rr(p,"invalid-api-key",{appName:c.name}),rr(p,"invalid-api-key",{appName:c.name});const _=typeof window<"u"?wr:void 0;this._delegate=u.initialize({options:{persistence:ju(p,c.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap(xt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Mt.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(c){this._delegate.languageCode=c}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(c){this._delegate.tenantId=c}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(c,u){!function so(l,o,c){const u=Oe(l);M(u._canInitEmulator,u,"emulator-config-failed"),M(/^https?:\/\//.test(o),u,"invalid-emulator-scheme");const p=!!c?.disableWarnings,_=Wa(o),{host:T,port:C}=function zd(l){const o=Wa(l),c=/(\/\/)?([^?#/]+)/.exec(l.substr(o.length));if(!c)return{host:"",port:null};const u=c[2].split("@").pop()||"",p=/^(\[[^\]]+\])(:|$)/.exec(u);if(p){const _=p[1];return{host:_,port:ja(u.substr(_.length+1))}}{const[_,T]=u.split(":");return{host:_,port:ja(T)}}}(o);u.config.emulator={url:`${_}//${T}${null===C?"":`:${C}`}/`},u.settings.appVerificationDisabledForTesting=!0,u.emulatorConfig=Object.freeze({host:T,port:C,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:p})}),p||function $a(){function l(){const o=document.createElement("p"),c=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",c.position="fixed",c.width="100%",c.backgroundColor="#ffffff",c.border=".1em solid #000000",c.color="#b50000",c.bottom="0px",c.left="0px",c.margin="0px",c.zIndex="10000",c.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",l):l())}()}(this._delegate,c,u)}applyActionCode(c){return function bo(l,o){return jr.apply(this,arguments)}(this._delegate,c)}checkActionCode(c){return pr(this._delegate,c)}confirmPasswordReset(c,u){return function ms(l,o,c){return Ao.apply(this,arguments)}(this._delegate,c,u)}createUserWithEmailAndPassword(c,u){var p=this;return(0,v.Z)(function*(){return jt(p._delegate,function Xl(l,o,c){return Co.apply(this,arguments)}(p._delegate,c,u))})()}fetchProvidersForEmail(c){return this.fetchSignInMethodsForEmail(c)}fetchSignInMethodsForEmail(c){return function _s(l,o){return Hr.apply(this,arguments)}(this._delegate,c)}isSignInWithEmailLink(c){return function So(l,o){const c=as.parseLink(o);return"EMAIL_SIGNIN"===c?.operation}(0,c)}getRedirectResult(){var c=this;return(0,v.Z)(function*(){rr(ra(),c._delegate,"operation-not-supported-in-this-environment");const u=yield function Vc(l,o){return Jn.apply(this,arguments)}(c._delegate,wr);return u?jt(c._delegate,Promise.resolve(u)):{credential:null,user:null}})()}addFrameworkForLogging(c){!function Fu(l,o){Oe(l)._logFramework(o)}(this._delegate,c)}onAuthStateChanged(c,u,p){const{next:_,error:T,complete:C}=Us(c,u,p);return this._delegate.onAuthStateChanged(_,T,C)}onIdTokenChanged(c,u,p){const{next:_,error:T,complete:C}=Us(c,u,p);return this._delegate.onIdTokenChanged(_,T,C)}sendSignInLinkToEmail(c,u){return function $r(l,o,c){return In.apply(this,arguments)}(this._delegate,c,u)}sendPasswordResetEmail(c,u){return function Jl(l,o,c){return lc.apply(this,arguments)}(this._delegate,c,u||void 0)}setPersistence(c){var u=this;return(0,v.Z)(function*(){let p;switch(function Jc(l,o){Zn(Object.values(me).includes(o),l,"invalid-persistence-type"),(0,k.b$)()?Zn(o!==me.SESSION,l,"unsupported-persistence-type"):(0,k.UG)()?Zn(o===me.NONE,l,"unsupported-persistence-type"):na()?Zn(o===me.NONE||o===me.LOCAL&&(0,k.hl)(),l,"unsupported-persistence-type"):Zn(o===me.NONE||nr(),l,"unsupported-persistence-type")}(u._delegate,c),c){case me.SESSION:p=Tn;break;case me.LOCAL:p=(yield ge(Ci)._isAvailable())?Ci:vs;break;case me.NONE:p=Xe;break;default:return Le("argument-error",{appName:u._delegate.name})}return u._delegate.setPersistence(p)})()}signInAndRetrieveDataWithCredential(c){return this.signInWithCredential(c)}signInAnonymously(){return jt(this._delegate,function Kd(l){return hr.apply(this,arguments)}(this._delegate))}signInWithCredential(c){return jt(this._delegate,yi(this._delegate,c))}signInWithCustomToken(c){return jt(this._delegate,function hs(l,o){return Io.apply(this,arguments)}(this._delegate,c))}signInWithEmailAndPassword(c,u){return jt(this._delegate,function Yd(l,o,c){return yi((0,k.m9)(l),Br.credential(o,c)).catch(function(){var u=(0,v.Z)(function*(p){throw"auth/password-does-not-meet-requirements"===p.code&&Eo(l),p});return function(p){return u.apply(this,arguments)}}())}(this._delegate,c,u))}signInWithEmailLink(c,u){return jt(this._delegate,function Ro(l,o,c){return Po.apply(this,arguments)}(this._delegate,c,u))}signInWithPhoneNumber(c,u){return tl(this._delegate,function fh(l,o,c){return Go.apply(this,arguments)}(this._delegate,c,u))}signInWithPopup(c){var u=this;return(0,v.Z)(function*(){return rr(ra(),u._delegate,"operation-not-supported-in-this-environment"),jt(u._delegate,function mh(l,o,c){return W.apply(this,arguments)}(u._delegate,c,wr))})()}signInWithRedirect(c){var u=this;return(0,v.Z)(function*(){return rr(ra(),u._delegate,"operation-not-supported-in-this-environment"),yield oa(u._delegate),wu(u._delegate,c,wr)})()}updateCurrentUser(c){return this._delegate.updateCurrentUser(c)}verifyPasswordResetCode(c){return function Qd(l,o){return uc.apply(this,arguments)}(this._delegate,c)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return l.Persistence=me,l})();function Us(l,o,c){let u=l;"function"!=typeof l&&({next:u,error:o,complete:c}=l);const p=u;return{next:T=>p(T&&Mt.getOrCreate(T)),error:o,complete:c}}function ju(l,o){const c=function Gu(l,o){const c=Xc();if(!c)return[];const u=rt(sa,l,o);switch(c.getItem(u)){case me.NONE:return[Xe];case me.LOCAL:return[Ci,Tn];case me.SESSION:return[Tn];default:return[]}}(l,o);if(typeof self<"u"&&!c.includes(Ci)&&c.push(Ci),typeof window<"u")for(const u of[vs,Tn])c.includes(u)||c.push(u);return c.includes(Xe)||c.push(Xe),c}class aa{constructor(){this.providerId="phone",this._delegate=new hn(Zu(fe.Z.auth()))}static credential(o,c){return hn.credential(o,c)}verifyPhoneNumber(o,c){return this._delegate.verifyPhoneNumber(o,c)}unwrap(){return this._delegate}}aa.PHONE_SIGN_IN_METHOD=hn.PHONE_SIGN_IN_METHOD,aa.PROVIDER_ID=hn.PROVIDER_ID;const ir=M;class $u{constructor(o,c,u=fe.Z.app()){var p;ir(null===(p=u.options)||void 0===p?void 0:p.apiKey,"invalid-api-key",{appName:u.name}),this._delegate=new hh(u.auth(),o,c),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Hu(l){l.INTERNAL.registerComponent(new Ye.wA("auth-compat",o=>{const c=o.getProvider("app-compat").getImmediate(),u=o.getProvider("auth");return new Fs(c,u)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Br,FacebookAuthProvider:Hl,GithubAuthProvider:fo,GoogleAuthProvider:cs,OAuthProvider:zr,SAMLAuthProvider:dr,PhoneAuthProvider:aa,PhoneMultiFactorGenerator:Oh,RecaptchaVerifier:$u,TwitterAuthProvider:ic,Auth:Fs,AuthCredential:lr,Error:k.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),l.registerVersion("@firebase/auth-compat","0.5.1")}(fe.Z)}}]);