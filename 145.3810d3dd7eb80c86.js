"use strict";(self.webpackChunkLKovariHome=self.webpackChunkLKovariHome||[]).push([[145],{1076:(Io,fn,le)=>{le.d(fn,{Am:()=>Xr,Bd:()=>ee,FA:()=>Ge,Fy:()=>mn,I9:()=>ws,Im:()=>Oi,Ku:()=>Sr,Ll:()=>gt,T9:()=>qt,Uj:()=>dt,XA:()=>ot,ZQ:()=>be,bD:()=>As,cY:()=>tt,eX:()=>sr,g:()=>Er,gR:()=>br,hp:()=>Un,jZ:()=>St,lT:()=>Ir,lV:()=>$t,nr:()=>Tr,sr:()=>Rt,tD:()=>Xt,u:()=>te,zW:()=>gn,zw:()=>ve});const $=function(R){const b=[];let D=0;for(let Y=0;Y<R.length;Y++){let B=R.charCodeAt(Y);B<128?b[D++]=B:B<2048?(b[D++]=B>>6|192,b[D++]=63&B|128):55296==(64512&B)&&Y+1<R.length&&56320==(64512&R.charCodeAt(Y+1))?(B=65536+((1023&B)<<10)+(1023&R.charCodeAt(++Y)),b[D++]=B>>18|240,b[D++]=B>>12&63|128,b[D++]=B>>6&63|128,b[D++]=63&B|128):(b[D++]=B>>12|224,b[D++]=B>>6&63|128,b[D++]=63&B|128)}return b},Gt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(R,b){if(!Array.isArray(R))throw Error("encodeByteArray takes an array as a parameter");this.init_();const D=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,Y=[];for(let B=0;B<R.length;B+=3){const fe=R[B],Te=B+1<R.length,Ye=Te?R[B+1]:0,Ke=B+2<R.length,Ft=Ke?R[B+2]:0;let At=(15&Ye)<<2|Ft>>6,Wn=63&Ft;Ke||(Wn=64,Te||(At=64)),Y.push(D[fe>>2],D[(3&fe)<<4|Ye>>4],D[At],D[Wn])}return Y.join("")},encodeString(R,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(R):this.encodeByteArray($(R),b)},decodeString(R,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(R):function(R){const b=[];let D=0,Y=0;for(;D<R.length;){const B=R[D++];if(B<128)b[Y++]=String.fromCharCode(B);else if(B>191&&B<224){const fe=R[D++];b[Y++]=String.fromCharCode((31&B)<<6|63&fe)}else if(B>239&&B<365){const Ke=((7&B)<<18|(63&R[D++])<<12|(63&R[D++])<<6|63&R[D++])-65536;b[Y++]=String.fromCharCode(55296+(Ke>>10)),b[Y++]=String.fromCharCode(56320+(1023&Ke))}else{const fe=R[D++],Te=R[D++];b[Y++]=String.fromCharCode((15&B)<<12|(63&fe)<<6|63&Te)}}return b.join("")}(this.decodeStringToByteArray(R,b))},decodeStringToByteArray(R,b){this.init_();const D=b?this.charToByteMapWebSafe_:this.charToByteMap_,Y=[];for(let B=0;B<R.length;){const fe=D[R.charAt(B++)],Ye=B<R.length?D[R.charAt(B)]:0;++B;const Ft=B<R.length?D[R.charAt(B)]:64;++B;const xe=B<R.length?D[R.charAt(B)]:64;if(++B,null==fe||null==Ye||null==Ft||null==xe)throw new zt;Y.push(fe<<2|Ye>>4),64!==Ft&&(Y.push(Ye<<4&240|Ft>>2),64!==xe&&Y.push(Ft<<6&192|xe))}return Y},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let R=0;R<this.ENCODED_VALS.length;R++)this.byteToCharMap_[R]=this.ENCODED_VALS.charAt(R),this.charToByteMap_[this.byteToCharMap_[R]]=R,this.byteToCharMapWebSafe_[R]=this.ENCODED_VALS_WEBSAFE.charAt(R),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[R]]=R,R>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(R)]=R,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(R)]=R)}}};class zt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dt=function(R){return function(R){const b=$(R);return Gt.encodeByteArray(b,!0)}(R).replace(/\./g,"")},te=function(R){try{return Gt.decodeString(R,!0)}catch(b){console.error("base64Decode failed: ",b)}return null};function ve(R,b){if(!(b instanceof Object))return b;switch(b.constructor){case Date:return new Date(b.getTime());case Object:void 0===R&&(R={});break;case Array:R=[];break;default:return b}for(const D in b)!b.hasOwnProperty(D)||!Ae(D)||(R[D]=ve(R[D],b[D]));return R}function Ae(R){return"__proto__"!==R}const Fe=()=>{try{return function Qe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const R=process.env.__FIREBASE_DEFAULTS__;return R?JSON.parse(R):void 0})()||(()=>{if(typeof document>"u")return;let R;try{R=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const b=R&&te(R[1]);return b&&JSON.parse(b)})()}catch(R){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${R}`)}},qt=()=>{var R;return null===(R=Fe())||void 0===R?void 0:R.config},ot=R=>{var b;return null===(b=Fe())||void 0===b?void 0:b[`_${R}`]};class tt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((b,D)=>{this.resolve=b,this.reject=D})}wrapCallback(b){return(D,Y)=>{D?this.reject(D):this.resolve(Y),"function"==typeof b&&(this.promise.catch(()=>{}),1===b.length?b(D):b(D,Y))}}}function mn(R,b){if(R.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Y=b||"demo-project",B=R.iat||0,fe=R.sub||R.user_id;if(!fe)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Te=Object.assign({iss:`https://securetoken.google.com/${Y}`,aud:Y,iat:B,exp:B+3600,auth_time:B,sub:fe,user_id:fe,firebase:{sign_in_provider:"custom",identities:{}}},R);return[dt(JSON.stringify({alg:"none",type:"JWT"})),dt(JSON.stringify(Te)),""].join(".")}function be(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function St(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(be())}function gt(){var R;const b=null===(R=Fe())||void 0===R?void 0:R.forceEnvironment;if("node"===b)return!0;if("browser"===b)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function ee(){return"object"==typeof self&&self.self===self}function Rt(){const R="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof R&&void 0!==R.id}function $t(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ir(){const R=be();return R.indexOf("MSIE ")>=0||R.indexOf("Trident/")>=0}function Tr(){return!gt()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gn(){try{return"object"==typeof indexedDB}catch{return!1}}function sr(){return new Promise((R,b)=>{try{let D=!0;const Y="validate-browser-context-for-indexeddb-analytics-module",B=self.indexedDB.open(Y);B.onsuccess=()=>{B.result.close(),D||self.indexedDB.deleteDatabase(Y),R(!0)},B.onupgradeneeded=()=>{D=!1},B.onerror=()=>{var fe;b((null===(fe=B.error)||void 0===fe?void 0:fe.message)||"")}}catch(D){b(D)}})}class Er extends Error{constructor(b,D,Y){super(D),this.code=b,this.customData=Y,this.name="FirebaseError",Object.setPrototypeOf(this,Er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ge.prototype.create)}}class Ge{constructor(b,D,Y){this.service=b,this.serviceName=D,this.errors=Y}create(b,...D){const Y=D[0]||{},B=`${this.service}/${b}`,fe=this.errors[b],Te=fe?function $e(R,b){return R.replace(Rn,(D,Y)=>{const B=b[Y];return null!=B?String(B):`<${Y}?>`})}(fe,Y):"Error";return new Er(B,`${this.serviceName}: ${Te} (${B}).`,Y)}}const Rn=/\{\$([^}]+)}/g;function br(R,b){return Object.prototype.hasOwnProperty.call(R,b)}function Oi(R){for(const b in R)if(Object.prototype.hasOwnProperty.call(R,b))return!1;return!0}function As(R,b){if(R===b)return!0;const D=Object.keys(R),Y=Object.keys(b);for(const B of D){if(!Y.includes(B))return!1;const fe=R[B],Te=b[B];if(Yt(fe)&&Yt(Te)){if(!As(fe,Te))return!1}else if(fe!==Te)return!1}for(const B of Y)if(!D.includes(B))return!1;return!0}function Yt(R){return null!==R&&"object"==typeof R}function Xr(R){const b=[];for(const[D,Y]of Object.entries(R))Array.isArray(Y)?Y.forEach(B=>{b.push(encodeURIComponent(D)+"="+encodeURIComponent(B))}):b.push(encodeURIComponent(D)+"="+encodeURIComponent(Y));return b.length?"&"+b.join("&"):""}function ws(R){const b={};return R.replace(/^\?/,"").split("&").forEach(Y=>{if(Y){const[B,fe]=Y.split("=");b[decodeURIComponent(B)]=decodeURIComponent(fe)}}),b}function Un(R){const b=R.indexOf("?");if(!b)return"";const D=R.indexOf("#",b);return R.substring(b,D>0?D:void 0)}function Xt(R,b){const D=new rn(R,b);return D.subscribe.bind(D)}class rn{constructor(b,D){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=D,this.task.then(()=>{b(this)}).catch(Y=>{this.error(Y)})}next(b){this.forEachObserver(D=>{D.next(b)})}error(b){this.forEachObserver(D=>{D.error(b)}),this.close(b)}complete(){this.forEachObserver(b=>{b.complete()}),this.close()}subscribe(b,D,Y){let B;if(void 0===b&&void 0===D&&void 0===Y)throw new Error("Missing Observer.");B=function _n(R,b){if("object"!=typeof R||null===R)return!1;for(const D of b)if(D in R&&"function"==typeof R[D])return!0;return!1}(b,["next","error","complete"])?b:{next:b,error:D,complete:Y},void 0===B.next&&(B.next=Ni),void 0===B.error&&(B.error=Ni),void 0===B.complete&&(B.complete=Ni);const fe=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?B.error(this.finalError):B.complete()}catch{}}),this.observers.push(B),fe}unsubscribeOne(b){void 0===this.observers||void 0===this.observers[b]||(delete this.observers[b],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(b){if(!this.finalized)for(let D=0;D<this.observers.length;D++)this.sendOne(D,b)}sendOne(b,D){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[b])try{D(this.observers[b])}catch(Y){typeof console<"u"&&console.error&&console.error(Y)}})}close(b){this.finalized||(this.finalized=!0,void 0!==b&&(this.finalError=b),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ni(){}function Sr(R){return R&&R._delegate?R._delegate:R}},1145:(Io,fn,le)=>{le.r(fn),le.d(fn,{DigitsModule:()=>bT});var A=le(177),Se=le(3331),d=le(4438),$=le(5779);let Ne=(()=>{class r{static#e=this.OPERATOR_REV="\xab";static#t=this.OPERATOR_ADD="+";static#n=this.OPERATOR_SUB="-";static#r=this.OPERATOR_MUL="\xd7";static#i=this.OPERATOR_DIV="/"}return r})();class Gt{constructor(e,t,n,i){this.id=e,this.selected=t,this.disabled=n,this.value=i}}class zt{constructor(){this.operands=[]}}class jt{static evaluate(e,t,n){let i=Number.MIN_VALUE;switch(n){case Ne.OPERATOR_ADD:i=e+t;break;case Ne.OPERATOR_SUB:i=e>=t?e-t:Number.MIN_VALUE;break;case Ne.OPERATOR_DIV:i=e%t==0?e/t:Number.MIN_VALUE;break;case Ne.OPERATOR_MUL:i=e*t}return i}static cloneGameParameters(e){const t=new zt;return t.result=e.result,e.operands.forEach(n=>{const i=new Gt(n.id,!1,!1,-1);Object.assign(i,n),t.operands.push(i)}),t}}class dt{constructor(){this.numbers=[]}generateNumber(e,t){let n=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(n)>=0;)n=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(n)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}}class te{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){const e=this.generateNumber(0,4);let t=Ne.OPERATOR_ADD;switch(e){case 0:t=Ne.OPERATOR_ADD;break;case 1:t=Ne.OPERATOR_SUB;break;case 2:t=Ne.OPERATOR_MUL;break;case 3:t=Ne.OPERATOR_DIV}return t}checkExecuteDivision(e,t){return e%t==0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let n=t;return e<t&&(n=t-1),this.operands.splice(e,1),n}calculateResult(e){let t=this.operands.length,n=0,i=0;const s=this.generateNumber(3,5);let c=Number.MIN_VALUE;for(;i<s&&e.length>1;){const f=this.choiceRandomOperation();let p=this.generateNumber(0,t-1);for(c===Number.MIN_VALUE&&(c=this.generateNumber(0,t-1));c===p;)p=this.generateNumber(0,t-1);switch(f){case Ne.OPERATOR_ADD:e[c]=jt.evaluate(e[c],e[p],f),c=this.removeOperandByIndex(p,c),--t,++i;break;case Ne.OPERATOR_SUB:if(!this.checkExecuteSubstraction(e[c],e[p]))continue;e[c]=jt.evaluate(e[c],e[p],f),c=this.removeOperandByIndex(p,c),--t,++i;break;case Ne.OPERATOR_MUL:e[c]=jt.evaluate(e[c],e[p],f),c=this.removeOperandByIndex(p,c),--t,++i;break;case Ne.OPERATOR_DIV:if(!this.checkExecuteDivision(e[c],e[p]))continue;e[c]=jt.evaluate(e[c],e[p],f),c=this.removeOperandByIndex(p,c),--t,++i}}return n=e[c],n}generateGameParameter(e){const t=new dt;switch(e){case 0:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break;case 1:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break;case 2:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 3:t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 4:t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25)}let n=t.getGeneratedNumbers();n=n.sort((v,T)=>v-T);const i=new Array(n[0],n[1],n[2],n[3],n[4],n[5]);this.operands=new Array(n[0],n[1],n[2],n[3],n[4],n[5]),t.clearGeneratedNumbers();let s=0,c=0;switch(e){case 0:s=30,c=100;break;case 1:s=50,c=150;break;case 2:s=100,c=200;break;case 3:s=300,c=400;break;case 4:s=400,c=550}let f=this.calculateResult(this.operands);for(;s>f||f>c;)this.operands=new Array(n[0],n[1],n[2],n[3],n[4],n[5]),f=this.calculateResult(this.operands);const p=new zt;p.result=f;let _=0;return i.forEach(v=>{const T=new Gt(_,!1,!1,v);p.operands.push(T),++_}),p}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){const n=this.generateGameParameter(t);n.stageIndex=t,e.push(n)}return e=e.sort((t,n)=>t.result-n.result),e}}class re{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}}let ve=(()=>{class r{constructor(t,n){this.document=t,this.platformId=n,this.documentIsAccessible=(0,A.UE)(this.platformId)}static getCookieRegExp(t){const n=t.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+n+"|;\\s*"+n+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(t){try{return decodeURIComponent(t)}catch{return t}}check(t){return!!this.documentIsAccessible&&(t=encodeURIComponent(t),r.getCookieRegExp(t).test(this.document.cookie))}get(t){if(this.documentIsAccessible&&this.check(t)){t=encodeURIComponent(t);const i=r.getCookieRegExp(t).exec(this.document.cookie);return i[1]?r.safeDecodeURIComponent(i[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const t={},n=this.document;return n.cookie&&""!==n.cookie&&n.cookie.split(";").forEach(i=>{const[s,c]=i.split("=");t[r.safeDecodeURIComponent(s.replace(/^ /,""))]=r.safeDecodeURIComponent(c)}),t}set(t,n,i,s,c,f,p,_){if(!this.documentIsAccessible)return;if("number"==typeof i||i instanceof Date||s||c||f||p)return void this.set(t,n,{expires:i,path:s,domain:c,secure:f,sameSite:p||"Lax",partitioned:_});let v=encodeURIComponent(t)+"="+encodeURIComponent(n)+";";const T=i||{};T.expires&&(v+="number"==typeof T.expires?"expires="+new Date((new Date).getTime()+1e3*T.expires*60*60*24).toUTCString()+";":"expires="+T.expires.toUTCString()+";"),T.path&&(v+="path="+T.path+";"),T.domain&&(v+="domain="+T.domain+";"),!1===T.secure&&"None"===T.sameSite&&(T.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${t} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),T.secure&&(v+="secure;"),T.sameSite||(T.sameSite="Lax"),v+="sameSite="+T.sameSite+";",T.partitioned&&(v+="Partitioned;"),this.document.cookie=v}delete(t,n,i,s,c="Lax"){this.documentIsAccessible&&this.set(t,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:n,domain:i,secure:s,sameSite:c})}deleteAll(t,n,i,s="Lax"){if(!this.documentIsAccessible)return;const c=this.getAll();for(const f in c)c.hasOwnProperty(f)&&this.delete(f,t,n,i,s)}static#e=this.\u0275fac=function(n){return new(n||r)(d.KVO(A.qQ),d.KVO(d.Agw))};static#t=this.\u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Ae=le(6354);class Qe{constructor(){this.stages=[]}}class Qt{constructor(){this.operands=[]}}class et{}var Ve=le(9079);const Fe=new d.nKC("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var Vt=le(1413);let pn=(()=>{class r{constructor(t,n,i){this.ngZone=t,this.document=n,this.window=i,this.copySubject=new Vt.B,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});const n=this.copyFromContent(t);return this.pushCopyResponse(n?{content:t,isSuccess:n}:{isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,n=!0){try{this.selectTarget(t);const i=this.copyText();return this.clearSelection(n?t:void 0,this.window),i&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){const t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,n=this.document.body){if(this.tempTextArea&&!n.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{n.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;const i=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),i}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,n){t&&t.focus(),n.getSelection()?.removeAllRanges()}createTempTextArea(t,n){const i="rtl"===t.documentElement.getAttribute("dir");let s;return s=t.createElement("textarea"),s.style.fontSize="12pt",s.style.border="0",s.style.padding="0",s.style.margin="0",s.style.position="absolute",s.style[i?"right":"left"]="-9999px",s.style.top=(n.pageYOffset||t.documentElement.scrollTop)+"px",s.setAttribute("readonly",""),s}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return r.\u0275fac=function(t){return new(t||r)(d.KVO(d.SKi),d.KVO(A.qQ),d.KVO(Fe,8))},r.\u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),tt=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=d.$C({type:r}),r.\u0275inj=d.G2t({imports:[A.MD]}),r})();var mn=le(7852);(0,mn.registerVersion)("firebase","10.12.1","app");var gt=le(6780),Rt=le(9687);const Ln=new class $t extends Rt.q{}(class ee extends gt.R{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}});var Sn=le(3236),To=le(8141),Tr=le(6745),gn=le(941);const sr=new d.RxE("ANGULARFIRE2_VERSION");class Ge{constructor(){return((r,e)=>{const t=(0,mn.getApps)(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(c=>{n.includes(c)||n.push(c)})}),n})($e)}}const $e="app-check";function Rn(){}class Ar{zone;delegate;constructor(e,t=Ln){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(c){i.runGuarded(()=>{e.apply(this,[c])})},t,n)}}class ki{zone;task=null;constructor(e){this.zone=e}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Rn,{},Rn,Rn)),t.pipe((0,To.M)({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Mt=(()=>{class r{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Ar(Zone.current)),this.insideAngular=t.run(()=>new Ar(Zone.current,Sn.E)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||r)(d.KVO(d.SKi))};static \u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Lt(r){return function Oi(r){return function(t){return(t=t.lift(new ki(r.ngZone))).pipe((0,Tr._)(r.outsideAngular),(0,gn.Q)(r.insideAngular))}}(function Fn(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}())(r)}var Yt=le(3345);Yt.A.registerVersion("firebase","10.12.1","app-compat");const ws=["ngOnDestroy"];class Xt{constructor(e){return e}}const rn=new d.nKC("angularfire2.app.options"),sn=new d.nKC("angularfire2.app.name");function _n(r,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const c=Yt.A.apps.filter(f=>f&&f.name===i.name)[0]||e.runOutsideAngular(()=>Yt.A.initializeApp(r,i));try{if(JSON.stringify(r)!==JSON.stringify(c.options)){const f=!!module.hot;Ni("error",`${c.name} Firebase App already initialized with different options${f?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Xt(c)}const Ni=(r,...e)=>{(0,d.naY)()&&typeof console<"u"&&console[r](...e)},Jr={provide:Xt,useFactory:_n,deps:[rn,d.SKi,[new d.Xx1,sn]]};let Hn=(()=>{class r{static initializeApp(t,n){return{ngModule:r,providers:[{provide:rn,useValue:t},{provide:sn,useValue:n}]}}constructor(t){Yt.A.registerVersion("angularfire",sr.full,"core"),Yt.A.registerVersion("angularfire",sr.full,"app-compat"),Yt.A.registerVersion("angular",d.xvI.full,t.toString())}static \u0275fac=function(n){return new(n||r)(d.KVO(d.Agw))};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({providers:[Jr]})}return r})();function Zr(r,e,t,n,i){const[,s,c]=globalThis.\u0275AngularfireInstanceCache.find(f=>f[0]===r)||[];if(s)return function wr(r,e){try{return r.toString()===e.toString()}catch{return r===e}}(i,c)||(yn("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Cs?" You may need to reload as Firebase is not HMR aware.":""}`),yn("warn",{is:i,was:c})),s;{const f=n();return globalThis.\u0275AngularfireInstanceCache.push([r,f,i]),f}}const Cs=typeof module<"u"&&!!module.hot,yn=(r,...e)=>{(0,d.naY)()&&typeof console<"u"&&console[r](...e)};globalThis.\u0275AngularfireInstanceCache||=[],le(3780);var Et=le(7673),Cr=le(1985),Pn=le(8455),or=le(7786),Jt=le(5558),Rs=le(6496),Vi=le(1594),Ps=le(8071);function Sr(r,e){return(0,Ps.T)(e)?(0,Jt.n)(()=>r,e):(0,Jt.n)(()=>r)}var R=le(5964);const D=new d.nKC("angularfire2.auth.use-emulator"),Y=new d.nKC("angularfire2.auth.settings"),B=new d.nKC("angularfire2.auth.tenant-id"),fe=new d.nKC("angularfire2.auth.langugage-code"),Te=new d.nKC("angularfire2.auth.use-device-language"),Ye=new d.nKC("angularfire.auth.persistence"),Ke=(r,e,t,n,i,s,c,f)=>Zr(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{const p=e.runOutsideAngular(()=>r.auth());if(t&&p.useEmulator(...t),n&&(p.tenantId=n),p.languageCode=i,s&&p.useDeviceLanguage(),c)for(const[_,v]of Object.entries(c))p.settings[_]=v;return f&&p.setPersistence(f),p},[t,n,i,s,c,f]);let Ft=(()=>{class r{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,s,c,f,p,_,v,T,S,L){const Q=new Vt.B,ne=(0,Et.of)(void 0).pipe((0,gn.Q)(c.outsideAngular),(0,Jt.n)(()=>s.runOutsideAngular(()=>Promise.resolve().then(le.bind(le,3780)))),(0,Ae.T)(()=>_n(t,s,n)),(0,Ae.T)(X=>Ke(X,s,f,_,v,T,p,S)),(0,Rs.t)({bufferSize:1,refCount:!1}));if((0,A.Vy)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Et.of)(null);else{ne.pipe((0,Vi.$)()).subscribe();const X=ne.pipe((0,Jt.n)(oe=>oe.getRedirectResult().then(Ie=>Ie,()=>null)),Lt,(0,Rs.t)({bufferSize:1,refCount:!1})),me=ne.pipe((0,Jt.n)(oe=>new Cr.c(Ie=>({unsubscribe:s.runOutsideAngular(()=>oe.onAuthStateChanged(Pe=>Ie.next(Pe),Pe=>Ie.error(Pe),()=>Ie.complete()))})))),ye=ne.pipe((0,Jt.n)(oe=>new Cr.c(Ie=>({unsubscribe:s.runOutsideAngular(()=>oe.onIdTokenChanged(Pe=>Ie.next(Pe),Pe=>Ie.error(Pe),()=>Ie.complete()))}))));this.authState=X.pipe(Sr(me),(0,Tr._)(c.outsideAngular),(0,gn.Q)(c.insideAngular)),this.user=X.pipe(Sr(ye),(0,Tr._)(c.outsideAngular),(0,gn.Q)(c.insideAngular)),this.idToken=this.user.pipe((0,Jt.n)(oe=>oe?(0,Pn.H)(oe.getIdToken()):(0,Et.of)(null))),this.idTokenResult=this.user.pipe((0,Jt.n)(oe=>oe?(0,Pn.H)(oe.getIdTokenResult()):(0,Et.of)(null))),this.credential=(0,or.h)(X,Q,this.authState.pipe((0,R.p)(oe=>!oe))).pipe((0,Ae.T)(oe=>oe?.user?oe:null),(0,Tr._)(c.outsideAngular),(0,gn.Q)(c.insideAngular))}return((r,e,t,n={})=>new Proxy(r,{get:(i,s)=>t.runOutsideAngular(()=>{if(r[s])return n?.spy?.get&&n.spy.get(s,r[s]),r[s];if(ws.indexOf(s)>-1)return()=>{};const c=e.toPromise().then(f=>{const p=f?.[s];return"function"==typeof p?p.bind(f):p?.then?p.then(_=>t.run(()=>_)):t.run(()=>p)});return new Proxy(()=>{},{get:(f,p)=>c[p],apply:(f,p,_)=>c.then(v=>{const T=v?.(..._);return n?.spy?.apply&&n.spy.apply(s,_,T),T})})})}))(this,ne,s,{spy:{apply:(X,me,ye)=>{(X.startsWith("signIn")||X.startsWith("createUser"))&&ye.then(oe=>Q.next(oe))}}})}static \u0275fac=function(n){return new(n||r)(d.KVO(rn),d.KVO(sn,8),d.KVO(d.Agw),d.KVO(d.SKi),d.KVO(Mt),d.KVO(D,8),d.KVO(Y,8),d.KVO(B,8),d.KVO(fe,8),d.KVO(Te,8),d.KVO(Ye,8),d.KVO(Ge,8))};static \u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var xe=le(9172),At=le(9974),Wn=le(4360);function Rr(){return(0,At.N)((r,e)=>{let t,n=!1;r.subscribe((0,Wn._)(e,i=>{const s=t;t=i,n&&e.next([s,i]),n=!0}))})}var V,W,ei=le(2816),wo=le(3294),H=le(467),Pr=le(1362),vn=le(8041),Ue=le(1076),ar=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},j={};(function(){var r;function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function i(k,w,x){x||(x=0);var N=Array(16);if("string"==typeof w)for(var M=0;16>M;++M)N[M]=w.charCodeAt(x++)|w.charCodeAt(x++)<<8|w.charCodeAt(x++)<<16|w.charCodeAt(x++)<<24;else for(M=0;16>M;++M)N[M]=w[x++]|w[x++]<<8|w[x++]<<16|w[x++]<<24;var G=k.g[3],P=(w=k.g[0])+(G^(x=k.g[1])&((M=k.g[2])^G))+N[0]+3614090360&4294967295;P=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=(x=(M=(G=(w=x+(P<<7&4294967295|P>>>25))+((P=G+(M^w&(x^M))+N[1]+3905402710&4294967295)<<12&4294967295|P>>>20))+((P=M+(x^G&(w^x))+N[2]+606105819&4294967295)<<17&4294967295|P>>>15))+((P=x+(w^M&(G^w))+N[3]+3250441966&4294967295)<<22&4294967295|P>>>10))+((P=w+(G^x&(M^G))+N[4]+4118548399&4294967295)<<7&4294967295|P>>>25))+((P=G+(M^w&(x^M))+N[5]+1200080426&4294967295)<<12&4294967295|P>>>20))+((P=M+(x^G&(w^x))+N[6]+2821735955&4294967295)<<17&4294967295|P>>>15))+((P=x+(w^M&(G^w))+N[7]+4249261313&4294967295)<<22&4294967295|P>>>10))+((P=w+(G^x&(M^G))+N[8]+1770035416&4294967295)<<7&4294967295|P>>>25))+((P=G+(M^w&(x^M))+N[9]+2336552879&4294967295)<<12&4294967295|P>>>20))+((P=M+(x^G&(w^x))+N[10]+4294925233&4294967295)<<17&4294967295|P>>>15))+((P=x+(w^M&(G^w))+N[11]+2304563134&4294967295)<<22&4294967295|P>>>10))+((P=w+(G^x&(M^G))+N[12]+1804603682&4294967295)<<7&4294967295|P>>>25))+((P=G+(M^w&(x^M))+N[13]+4254626195&4294967295)<<12&4294967295|P>>>20))+((P=M+(x^G&(w^x))+N[14]+2792965006&4294967295)<<17&4294967295|P>>>15))+((P=x+(w^M&(G^w))+N[15]+1236535329&4294967295)<<22&4294967295|P>>>10))+((P=w+(M^G&(x^M))+N[1]+4129170786&4294967295)<<5&4294967295|P>>>27))+((P=G+(x^M&(w^x))+N[6]+3225465664&4294967295)<<9&4294967295|P>>>23))+((P=M+(w^x&(G^w))+N[11]+643717713&4294967295)<<14&4294967295|P>>>18))+((P=x+(G^w&(M^G))+N[0]+3921069994&4294967295)<<20&4294967295|P>>>12))+((P=w+(M^G&(x^M))+N[5]+3593408605&4294967295)<<5&4294967295|P>>>27))+((P=G+(x^M&(w^x))+N[10]+38016083&4294967295)<<9&4294967295|P>>>23))+((P=M+(w^x&(G^w))+N[15]+3634488961&4294967295)<<14&4294967295|P>>>18))+((P=x+(G^w&(M^G))+N[4]+3889429448&4294967295)<<20&4294967295|P>>>12))+((P=w+(M^G&(x^M))+N[9]+568446438&4294967295)<<5&4294967295|P>>>27))+((P=G+(x^M&(w^x))+N[14]+3275163606&4294967295)<<9&4294967295|P>>>23))+((P=M+(w^x&(G^w))+N[3]+4107603335&4294967295)<<14&4294967295|P>>>18))+((P=x+(G^w&(M^G))+N[8]+1163531501&4294967295)<<20&4294967295|P>>>12))+((P=w+(M^G&(x^M))+N[13]+2850285829&4294967295)<<5&4294967295|P>>>27))+((P=G+(x^M&(w^x))+N[2]+4243563512&4294967295)<<9&4294967295|P>>>23))+((P=M+(w^x&(G^w))+N[7]+1735328473&4294967295)<<14&4294967295|P>>>18))+((P=x+(G^w&(M^G))+N[12]+2368359562&4294967295)<<20&4294967295|P>>>12))+((P=w+(x^M^G)+N[5]+4294588738&4294967295)<<4&4294967295|P>>>28))+((P=G+(w^x^M)+N[8]+2272392833&4294967295)<<11&4294967295|P>>>21))+((P=M+(G^w^x)+N[11]+1839030562&4294967295)<<16&4294967295|P>>>16))+((P=x+(M^G^w)+N[14]+4259657740&4294967295)<<23&4294967295|P>>>9))+((P=w+(x^M^G)+N[1]+2763975236&4294967295)<<4&4294967295|P>>>28))+((P=G+(w^x^M)+N[4]+1272893353&4294967295)<<11&4294967295|P>>>21))+((P=M+(G^w^x)+N[7]+4139469664&4294967295)<<16&4294967295|P>>>16))+((P=x+(M^G^w)+N[10]+3200236656&4294967295)<<23&4294967295|P>>>9))+((P=w+(x^M^G)+N[13]+681279174&4294967295)<<4&4294967295|P>>>28))+((P=G+(w^x^M)+N[0]+3936430074&4294967295)<<11&4294967295|P>>>21))+((P=M+(G^w^x)+N[3]+3572445317&4294967295)<<16&4294967295|P>>>16))+((P=x+(M^G^w)+N[6]+76029189&4294967295)<<23&4294967295|P>>>9))+((P=w+(x^M^G)+N[9]+3654602809&4294967295)<<4&4294967295|P>>>28))+((P=G+(w^x^M)+N[12]+3873151461&4294967295)<<11&4294967295|P>>>21))+((P=M+(G^w^x)+N[15]+530742520&4294967295)<<16&4294967295|P>>>16))+((P=x+(M^G^w)+N[2]+3299628645&4294967295)<<23&4294967295|P>>>9))+((P=w+(M^(x|~G))+N[0]+4096336452&4294967295)<<6&4294967295|P>>>26))+((P=G+(x^(w|~M))+N[7]+1126891415&4294967295)<<10&4294967295|P>>>22))+((P=M+(w^(G|~x))+N[14]+2878612391&4294967295)<<15&4294967295|P>>>17))+((P=x+(G^(M|~w))+N[5]+4237533241&4294967295)<<21&4294967295|P>>>11))+((P=w+(M^(x|~G))+N[12]+1700485571&4294967295)<<6&4294967295|P>>>26))+((P=G+(x^(w|~M))+N[3]+2399980690&4294967295)<<10&4294967295|P>>>22))+((P=M+(w^(G|~x))+N[10]+4293915773&4294967295)<<15&4294967295|P>>>17))+((P=x+(G^(M|~w))+N[1]+2240044497&4294967295)<<21&4294967295|P>>>11))+((P=w+(M^(x|~G))+N[8]+1873313359&4294967295)<<6&4294967295|P>>>26))+((P=G+(x^(w|~M))+N[15]+4264355552&4294967295)<<10&4294967295|P>>>22))+((P=M+(w^(G|~x))+N[6]+2734768916&4294967295)<<15&4294967295|P>>>17))+((P=x+(G^(M|~w))+N[13]+1309151649&4294967295)<<21&4294967295|P>>>11))+((G=(w=x+((P=w+(M^(x|~G))+N[4]+4149444226&4294967295)<<6&4294967295|P>>>26))+((P=G+(x^(w|~M))+N[11]+3174756917&4294967295)<<10&4294967295|P>>>22))^((M=G+((P=M+(w^(G|~x))+N[2]+718787259&4294967295)<<15&4294967295|P>>>17))|~w))+N[9]+3951481745&4294967295,k.g[0]=k.g[0]+w&4294967295,k.g[1]=k.g[1]+(M+(P<<21&4294967295|P>>>11))&4294967295,k.g[2]=k.g[2]+M&4294967295,k.g[3]=k.g[3]+G&4294967295}function c(k,w){this.h=w;for(var x=[],N=!0,M=k.length-1;0<=M;M--){var G=0|k[M];N&&G==w||(x[M]=G,N=!1)}this.g=x}(function e(k,w){function x(){}x.prototype=w.prototype,k.D=w.prototype,k.prototype=new x,k.prototype.constructor=k,k.C=function(N,M,G){for(var P=Array(arguments.length-2),Pi=2;Pi<arguments.length;Pi++)P[Pi-2]=arguments[Pi];return w.prototype[M].apply(N,P)}})(n,function t(){this.blockSize=-1}),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},n.prototype.u=function(k,w){void 0===w&&(w=k.length);for(var x=w-this.blockSize,N=this.B,M=this.h,G=0;G<w;){if(0==M)for(;G<=x;)i(this,k,G),G+=this.blockSize;if("string"==typeof k){for(;G<w;)if(N[M++]=k.charCodeAt(G++),M==this.blockSize){i(this,N),M=0;break}}else for(;G<w;)if(N[M++]=k[G++],M==this.blockSize){i(this,N),M=0;break}}this.h=M,this.o+=w},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var w=1;w<k.length-8;++w)k[w]=0;var x=8*this.o;for(w=k.length-8;w<k.length;++w)k[w]=255&x,x/=256;for(this.u(k),k=Array(16),w=x=0;4>w;++w)for(var N=0;32>N;N+=8)k[x++]=this.g[w]>>>N&255;return k};var f={};function p(k){return-128<=k&&128>k?function s(k,w){var x=f;return Object.prototype.hasOwnProperty.call(x,k)?x[k]:x[k]=w(k)}(k,function(w){return new c([0|w],0>w?-1:0)}):new c([0|k],0>k?-1:0)}function _(k){if(isNaN(k)||!isFinite(k))return T;if(0>k)return X(_(-k));for(var w=[],x=1,N=0;k>=x;N++)w[N]=k/x|0,x*=4294967296;return new c(w,0)}var T=p(0),S=p(1),L=p(16777216);function Q(k){if(0!=k.h)return!1;for(var w=0;w<k.g.length;w++)if(0!=k.g[w])return!1;return!0}function ne(k){return-1==k.h}function X(k){for(var w=k.g.length,x=[],N=0;N<w;N++)x[N]=~k.g[N];return new c(x,~k.h).add(S)}function me(k,w){return k.add(X(w))}function ye(k,w){for(;(65535&k[w])!=k[w];)k[w+1]+=k[w]>>>16,k[w]&=65535,w++}function oe(k,w){this.g=k,this.h=w}function Ie(k,w){if(Q(w))throw Error("division by zero");if(Q(k))return new oe(T,T);if(ne(k))return w=Ie(X(k),w),new oe(X(w.g),X(w.h));if(ne(w))return w=Ie(k,X(w)),new oe(X(w.g),w.h);if(30<k.g.length){if(ne(k)||ne(w))throw Error("slowDivide_ only works with positive integers.");for(var x=S,N=w;0>=N.l(k);)x=Pe(x),N=Pe(N);var M=ke(x,1),G=ke(N,1);for(N=ke(N,2),x=ke(x,2);!Q(N);){var P=G.add(N);0>=P.l(k)&&(M=M.add(x),G=P),N=ke(N,1),x=ke(x,1)}return w=me(k,M.j(w)),new oe(M,w)}for(M=T;0<=k.l(w);){for(x=Math.max(1,Math.floor(k.m()/w.m())),N=48>=(N=Math.ceil(Math.log(x)/Math.LN2))?1:Math.pow(2,N-48),P=(G=_(x)).j(w);ne(P)||0<P.l(k);)P=(G=_(x-=N)).j(w);Q(G)&&(G=S),M=M.add(G),k=me(k,P)}return new oe(M,k)}function Pe(k){for(var w=k.g.length+1,x=[],N=0;N<w;N++)x[N]=k.i(N)<<1|k.i(N-1)>>>31;return new c(x,k.h)}function ke(k,w){var x=w>>5;w%=32;for(var N=k.g.length-x,M=[],G=0;G<N;G++)M[G]=0<w?k.i(G+x)>>>w|k.i(G+x+1)<<32-w:k.i(G+x);return new c(M,k.h)}(r=c.prototype).m=function(){if(ne(this))return-X(this).m();for(var k=0,w=1,x=0;x<this.g.length;x++){var N=this.i(x);k+=(0<=N?N:4294967296+N)*w,w*=4294967296}return k},r.toString=function(k){if(2>(k=k||10)||36<k)throw Error("radix out of range: "+k);if(Q(this))return"0";if(ne(this))return"-"+X(this).toString(k);for(var w=_(Math.pow(k,6)),x=this,N="";;){var M=Ie(x,w).g,G=((0<(x=me(x,M.j(w))).g.length?x.g[0]:x.h)>>>0).toString(k);if(Q(x=M))return G+N;for(;6>G.length;)G="0"+G;N=G+N}},r.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h},r.l=function(k){return ne(k=me(this,k))?-1:Q(k)?0:1},r.abs=function(){return ne(this)?X(this):this},r.add=function(k){for(var w=Math.max(this.g.length,k.g.length),x=[],N=0,M=0;M<=w;M++){var G=N+(65535&this.i(M))+(65535&k.i(M)),P=(G>>>16)+(this.i(M)>>>16)+(k.i(M)>>>16);N=P>>>16,x[M]=(P&=65535)<<16|(G&=65535)}return new c(x,-2147483648&x[x.length-1]?-1:0)},r.j=function(k){if(Q(this)||Q(k))return T;if(ne(this))return ne(k)?X(this).j(X(k)):X(X(this).j(k));if(ne(k))return X(this.j(X(k)));if(0>this.l(L)&&0>k.l(L))return _(this.m()*k.m());for(var w=this.g.length+k.g.length,x=[],N=0;N<2*w;N++)x[N]=0;for(N=0;N<this.g.length;N++)for(var M=0;M<k.g.length;M++){var G=this.i(N)>>>16,P=65535&this.i(N),Pi=k.i(M)>>>16,Rl=65535&k.i(M);x[2*N+2*M]+=P*Rl,ye(x,2*N+2*M),x[2*N+2*M+1]+=G*Rl,ye(x,2*N+2*M+1),x[2*N+2*M+1]+=P*Pi,ye(x,2*N+2*M+1),x[2*N+2*M+2]+=G*Pi,ye(x,2*N+2*M+2)}for(N=0;N<w;N++)x[N]=x[2*N+1]<<16|x[2*N];for(N=w;N<2*w;N++)x[N]=0;return new c(x,0)},r.A=function(k){return Ie(this,k).h},r.and=function(k){for(var w=Math.max(this.g.length,k.g.length),x=[],N=0;N<w;N++)x[N]=this.i(N)&k.i(N);return new c(x,this.h&k.h)},r.or=function(k){for(var w=Math.max(this.g.length,k.g.length),x=[],N=0;N<w;N++)x[N]=this.i(N)|k.i(N);return new c(x,this.h|k.h)},r.xor=function(k){for(var w=Math.max(this.g.length,k.g.length),x=[],N=0;N<w;N++)x[N]=this.i(N)^k.i(N);return new c(x,this.h^k.h)},n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,W=j.Md5=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=_,c.fromString=function v(k,w){if(0==k.length)throw Error("number format error: empty string");if(2>(w=w||10)||36<w)throw Error("radix out of range: "+w);if("-"==k.charAt(0))return X(v(k.substring(1),w));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=_(Math.pow(w,8)),N=T,M=0;M<k.length;M+=8){var G=Math.min(8,k.length-M),P=parseInt(k.substring(M,M+G),w);8>G?(G=_(Math.pow(w,G)),N=N.j(G).add(_(P))):N=(N=N.j(x)).add(_(P))}return N},V=j.Integer=c}).apply(typeof ar<"u"?ar:typeof self<"u"?self:typeof window<"u"?window:{});var we,De,Xe,Je,Kt,cr,Co,nt,Ya,ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ee={};(function(){var r,e="function"==typeof Object.defineProperties?Object.defineProperty:function(l,m,y){return l==Array.prototype||l==Object.prototype||(l[m]=y.value),l},n=function t(l){l=["object"==typeof globalThis&&globalThis,l,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ue&&ue];for(var m=0;m<l.length;++m){var y=l[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}(this);!function i(l,m){if(m)e:{var y=n;l=l.split(".");for(var E=0;E<l.length-1;E++){var F=l[E];if(!(F in y))break e;y=y[F]}(m=m(E=y[l=l[l.length-1]]))!=E&&null!=m&&e(y,l,{configurable:!0,writable:!0,value:m})}}("Array.prototype.values",function(l){return l||function(){return function s(l,m){l instanceof String&&(l+="");var y=0,E=!1,F={next:function(){if(!E&&y<l.length){var q=y++;return{value:m(q,l[q]),done:!1}}return E=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}(this,function(m,y){return y})}});var c=c||{},f=this||self;function p(l){var m=typeof l;return"array"==(m="object"!=m?m:l?Array.isArray(l)?"array":m:"null")||"object"==m&&"number"==typeof l.length}function _(l){var m=typeof l;return"object"==m&&null!=l||"function"==m}function v(l,m,y){return l.call.apply(l.bind,arguments)}function T(l,m,y){if(!l)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,E),l.apply(m,F)}}return function(){return l.apply(m,arguments)}}function S(l,m,y){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:T).apply(null,arguments)}function L(l,m){var y=Array.prototype.slice.call(arguments,1);return function(){var E=y.slice();return E.push.apply(E,arguments),l.apply(this,E)}}function Q(l,m){function y(){}y.prototype=m.prototype,l.aa=m.prototype,l.prototype=new y,l.prototype.constructor=l,l.Qb=function(E,F,q){for(var ce=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)ce[ut-2]=arguments[ut];return m.prototype[F].apply(E,ce)}}function ne(l){const m=l.length;if(0<m){const y=Array(m);for(let E=0;E<m;E++)y[E]=l[E];return y}return[]}function X(l,m){for(let y=1;y<arguments.length;y++){const E=arguments[y];if(p(E)){const F=l.length||0,q=E.length||0;l.length=F+q;for(let ce=0;ce<q;ce++)l[F+ce]=E[ce]}else l.push(E)}}function ye(l){return/^[\s\xa0]*$/.test(l)}function oe(){var l=f.navigator;return l&&(l=l.userAgent)?l:""}function Ie(l){return Ie[" "](l),l}Ie[" "]=function(){};var Pe=!(-1==oe().indexOf("Gecko")||-1!=oe().toLowerCase().indexOf("webkit")&&-1==oe().indexOf("Edge")||-1!=oe().indexOf("Trident")||-1!=oe().indexOf("MSIE")||-1!=oe().indexOf("Edge"));function ke(l,m,y){for(const E in l)m.call(y,l[E],E,l)}function w(l){const m={};for(const y in l)m[y]=l[y];return m}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(l,m){let y,E;for(let F=1;F<arguments.length;F++){for(y in E=arguments[F],E)l[y]=E[y];for(let q=0;q<x.length;q++)y=x[q],Object.prototype.hasOwnProperty.call(E,y)&&(l[y]=E[y])}}function M(l){var m=1;l=l.split(":");const y=[];for(;0<m&&l.length;)y.push(l.shift()),m--;return l.length&&y.push(l.join(":")),y}function G(l){f.setTimeout(()=>{throw l},0)}function P(){var l=Op;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}var Rl=new class me{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}(()=>new wT,l=>l.reset());class wT{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let Pl,xl=!1,Op=new class Pi{constructor(){this.h=this.g=null}add(m,y){const E=Rl.get();E.set(m,y),this.h?this.h.next=E:this.g=E,this.h=E}},Gg=()=>{const l=f.Promise.resolve(void 0);Pl=()=>{l.then(CT)}};var CT=()=>{for(var l;l=P();){try{l.h.call(l.g)}catch(y){G(y)}var m=Rl;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}xl=!1};function _s(){this.s=this.s,this.C=this.C}function ln(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}_s.prototype.s=!1,_s.prototype.ma=function(){this.s||(this.s=!0,this.N())},_s.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},ln.prototype.h=function(){this.defaultPrevented=!0};var ST=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const y=()=>{};f.addEventListener("test",y,m),f.removeEventListener("test",y,m)}catch{}return l}();function Dl(l,m){if(ln.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var y=this.type=l.type,E=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(Pe){e:{try{Ie(m.nodeName);var F=!0;break e}catch{}F=!1}F||(m=null)}}else"mouseover"==y?m=l.fromElement:"mouseout"==y&&(m=l.toElement);this.relatedTarget=m,E?(this.clientX=void 0!==E.clientX?E.clientX:E.pageX,this.clientY=void 0!==E.clientY?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=void 0!==l.clientX?l.clientX:l.pageX,this.clientY=void 0!==l.clientY?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType="string"==typeof l.pointerType?l.pointerType:RT[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Dl.aa.h.call(this)}}Q(Dl,ln);var RT={2:"touch",3:"pen",4:"mouse"};Dl.prototype.h=function(){Dl.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var kl="closure_listenable_"+(1e6*Math.random()|0),PT=0;function xT(l,m,y,E,F){this.listener=l,this.proxy=null,this.src=m,this.type=y,this.capture=!!E,this.ha=F,this.key=++PT,this.da=this.fa=!1}function Gd(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function zd(l){this.src=l,this.g={},this.h=0}function Np(l,m){var y=m.type;if(y in l.g){var q,E=l.g[y],F=Array.prototype.indexOf.call(E,m,void 0);(q=0<=F)&&Array.prototype.splice.call(E,F,1),q&&(Gd(m),0==l.g[y].length&&(delete l.g[y],l.h--))}}function Vp(l,m,y,E){for(var F=0;F<l.length;++F){var q=l[F];if(!q.da&&q.listener==m&&q.capture==!!y&&q.ha==E)return F}return-1}zd.prototype.add=function(l,m,y,E,F){var q=l.toString();(l=this.g[q])||(l=this.g[q]=[],this.h++);var ce=Vp(l,m,E,F);return-1<ce?(m=l[ce],y||(m.fa=!1)):((m=new xT(m,this.src,q,!!E,F)).fa=y,l.push(m)),m};var Mp="closure_lm_"+(1e6*Math.random()|0),Lp={};function zg(l,m,y,E,F){if(E&&E.once)return qg(l,m,y,E,F);if(Array.isArray(m)){for(var q=0;q<m.length;q++)zg(l,m[q],y,E,F);return null}return y=Gp(y),l&&l[kl]?l.K(m,y,_(E)?!!E.capture:!!E,F):jg(l,m,y,!1,E,F)}function jg(l,m,y,E,F,q){if(!m)throw Error("Invalid event type");var ce=_(F)?!!F.capture:!!F,ut=Up(l);if(ut||(l[Mp]=ut=new zd(l)),(y=ut.add(m,y,E,ce,q)).proxy)return y;if(E=function DT(){const m=kT;return function l(y){return m.call(l.src,l.listener,y)}}(),y.proxy=E,E.src=l,E.listener=y,l.addEventListener)ST||(F=ce),void 0===F&&(F=!1),l.addEventListener(m.toString(),E,F);else if(l.attachEvent)l.attachEvent(Kg(m.toString()),E);else{if(!l.addListener||!l.removeListener)throw Error("addEventListener and attachEvent are unavailable.");l.addListener(E)}return y}function qg(l,m,y,E,F){if(Array.isArray(m)){for(var q=0;q<m.length;q++)qg(l,m[q],y,E,F);return null}return y=Gp(y),l&&l[kl]?l.L(m,y,_(E)?!!E.capture:!!E,F):jg(l,m,y,!0,E,F)}function $g(l,m,y,E,F){if(Array.isArray(m))for(var q=0;q<m.length;q++)$g(l,m[q],y,E,F);else E=_(E)?!!E.capture:!!E,y=Gp(y),l&&l[kl]?(l=l.i,(m=String(m).toString())in l.g&&-1<(y=Vp(q=l.g[m],y,E,F))&&(Gd(q[y]),Array.prototype.splice.call(q,y,1),0==q.length&&(delete l.g[m],l.h--))):l&&(l=Up(l))&&(m=l.g[m.toString()],l=-1,m&&(l=Vp(m,y,E,F)),(y=-1<l?m[l]:null)&&Fp(y))}function Fp(l){if("number"!=typeof l&&l&&!l.da){var m=l.src;if(m&&m[kl])Np(m.i,l);else{var y=l.type,E=l.proxy;m.removeEventListener?m.removeEventListener(y,E,l.capture):m.detachEvent?m.detachEvent(Kg(y),E):m.addListener&&m.removeListener&&m.removeListener(E),(y=Up(m))?(Np(y,l),0==y.h&&(y.src=null,m[Mp]=null)):Gd(l)}}}function Kg(l){return l in Lp?Lp[l]:Lp[l]="on"+l}function kT(l,m){if(l.da)l=!0;else{m=new Dl(m,this);var y=l.listener,E=l.ha||l.src;l.fa&&Fp(l),l=y.call(E,m)}return l}function Up(l){return(l=l[Mp])instanceof zd?l:null}var Bp="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gp(l){return"function"==typeof l?l:(l[Bp]||(l[Bp]=function(m){return l.handleEvent(m)}),l[Bp])}function un(){_s.call(this),this.i=new zd(this),this.M=this,this.F=null}function wn(l,m){var y,E=l.F;if(E)for(y=[];E;E=E.F)y.push(E);if(l=l.M,E=m.type||m,"string"==typeof m)m=new ln(m,l);else if(m instanceof ln)m.target=m.target||l;else{var F=m;N(m=new ln(E,l),F)}if(F=!0,y)for(var q=y.length-1;0<=q;q--){var ce=m.g=y[q];F=jd(ce,E,!0,m)&&F}if(F=jd(ce=m.g=l,E,!0,m)&&F,F=jd(ce,E,!1,m)&&F,y)for(q=0;q<y.length;q++)F=jd(ce=m.g=y[q],E,!1,m)&&F}function jd(l,m,y,E){if(!(m=l.i.g[String(m)]))return!0;m=m.concat();for(var F=!0,q=0;q<m.length;++q){var ce=m[q];if(ce&&!ce.da&&ce.capture==y){var ut=ce.listener,nn=ce.ha||ce.src;ce.fa&&Np(l.i,ce),F=!1!==ut.call(nn,E)&&F}}return F&&!E.defaultPrevented}function Hg(l,m,y){if("function"==typeof l)y&&(l=S(l,y));else{if(!l||"function"!=typeof l.handleEvent)throw Error("Invalid listener argument");l=S(l.handleEvent,l)}return 2147483647<Number(m)?-1:f.setTimeout(l,m||0)}function Wg(l){l.g=Hg(()=>{l.g=null,l.i&&(l.i=!1,Wg(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}Q(un,_s),un.prototype[kl]=!0,un.prototype.removeEventListener=function(l,m,y,E){$g(this,l,m,y,E)},un.prototype.N=function(){if(un.aa.N.call(this),this.i){var m,l=this.i;for(m in l.g){for(var y=l.g[m],E=0;E<y.length;E++)Gd(y[E]);delete l.g[m],l.h--}}this.F=null},un.prototype.K=function(l,m,y,E){return this.i.add(String(l),m,!1,y,E)},un.prototype.L=function(l,m,y,E){return this.i.add(String(l),m,!0,y,E)};class OT extends _s{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Wg(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ol(l){_s.call(this),this.h=l,this.g={}}Q(Ol,_s);var Qg=[];function Yg(l){ke(l.g,function(m,y){this.g.hasOwnProperty(y)&&Fp(m)},l),l.g={}}Ol.prototype.N=function(){Ol.aa.N.call(this),Yg(this)},Ol.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zp=f.JSON.stringify,NT=f.JSON.parse,VT=class{stringify(l){return f.JSON.stringify(l,void 0)}parse(l){return f.JSON.parse(l,void 0)}};function jp(){}function Jg(){}jp.prototype.h=null;var Nl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qp(){ln.call(this,"d")}function $p(){ln.call(this,"c")}Q(qp,ln),Q($p,ln);var go={},Zg=null;function qd(){return Zg=Zg||new un}function e_(l){ln.call(this,go.La,l)}function Vl(l){const m=qd();wn(m,new e_(m))}function t_(l,m){ln.call(this,go.STAT_EVENT,l),this.stat=m}function Cn(l){const m=qd();wn(m,new t_(m,l))}function n_(l,m){ln.call(this,go.Ma,l),this.size=m}function Ml(l,m){if("function"!=typeof l)throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){l()},m)}function Ll(){this.g=!0}function $a(l,m,y,E){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+function UT(l,m){if(!l.g)return m;if(!m)return null;try{var y=JSON.parse(m);if(y)for(l=0;l<y.length;l++)if(Array.isArray(y[l])){var E=y[l];if(!(2>E.length)){var F=E[1];if(Array.isArray(F)&&!(1>F.length)){var q=F[0];if("noop"!=q&&"stop"!=q&&"close"!=q)for(var ce=1;ce<F.length;ce++)F[ce]=""}}}return zp(y)}catch{return m}}(l,y)+(E?" "+E:"")})}go.La="serverreachability",Q(e_,ln),go.STAT_EVENT="statevent",Q(t_,ln),go.Ma="timingevent",Q(n_,ln),Ll.prototype.xa=function(){this.g=!1},Ll.prototype.info=function(){};var Kp,$d={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},r_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Kd(){}function ys(l,m,y,E){this.j=l,this.i=m,this.l=y,this.R=E||1,this.U=new Ol(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new i_}function i_(){this.i=null,this.g="",this.h=!1}Q(Kd,jp),Kd.prototype.g=function(){return new XMLHttpRequest},Kd.prototype.i=function(){return{}},Kp=new Kd;var s_={},Hp={};function Wp(l,m,y){l.L=1,l.v=Yd(xi(m)),l.m=y,l.P=!0,o_(l,null)}function o_(l,m){l.F=Date.now(),Hd(l),l.A=xi(l.v);var y=l.A,E=l.R;Array.isArray(E)||(E=[String(E)]),I_(y.i,"t",E),l.C=0,y=l.j.J,l.h=new i_,l.g=F_(l.j,y?m:null,!l.m),0<l.O&&(l.M=new OT(S(l.Y,l,l.g),l.O)),m=l.U,y=l.g,E=l.ca;var F="readystatechange";Array.isArray(F)||(F&&(Qg[0]=F.toString()),F=Qg);for(var q=0;q<F.length;q++){var ce=zg(y,F[q],E||m.handleEvent,!1,m.h||m);if(!ce)break;m.g[ce.key]=ce}m=l.H?w(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),Vl(),function MT(l,m,y,E,F,q){l.info(function(){if(l.g)if(q)for(var ce="",ut=q.split("&"),nn=0;nn<ut.length;nn++){var qe=ut[nn].split("=");if(1<qe.length){var dn=qe[0];qe=qe[1];var hn=dn.split("_");ce=2<=hn.length&&"type"==hn[1]?ce+(dn+"=")+qe+"&":ce+(dn+"=redacted&")}}else ce=null;else ce=q;return"XMLHTTP REQ ("+E+") [attempt "+F+"]: "+m+"\n"+y+"\n"+ce})}(l.i,l.u,l.A,l.l,l.R,l.m)}function a_(l){return!!l.g&&"GET"==l.u&&2!=l.L&&l.j.Ca}function BT(l,m){var y=l.C,E=m.indexOf("\n",y);return-1==E?Hp:(y=Number(m.substring(y,E)),isNaN(y)?s_:(E+=1)+y>m.length?Hp:(m=m.slice(E,E+y),l.C=E+y,m))}function Hd(l){l.S=Date.now()+l.I,c_(l,l.I)}function c_(l,m){if(null!=l.B)throw Error("WatchDog timer not null");l.B=Ml(S(l.ba,l),m)}function Qp(l){l.B&&(f.clearTimeout(l.B),l.B=null)}function Fl(l){0==l.j.G||l.J||N_(l.j,l)}function _o(l){Qp(l);var m=l.M;m&&"function"==typeof m.ma&&m.ma(),l.M=null,Yg(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function Yp(l,m){try{var y=l.j;if(0!=y.G&&(y.g==l||Xp(y.h,l)))if(!l.K&&Xp(y.h,l)&&3==y.G){try{var E=y.Da.g.parse(m)}catch{E=null}if(Array.isArray(E)&&3==E.length){var F=E;if(0==F[0]){e:if(!y.u){if(y.g){if(!(y.g.F+3e3<l.F))break e;th(y),Zd(y)}tm(y),Cn(18)}}else y.za=F[1],0<y.za-y.T&&37500>F[2]&&y.F&&0==y.v&&!y.C&&(y.C=Ml(S(y.Za,y),6e3));if(1>=d_(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else vo(y,11)}else if((l.K||y.g==l)&&th(y),!ye(m))for(F=y.Da.g.parse(m),m=0;m<F.length;m++){let qe=F[m];if(y.T=qe[0],qe=qe[1],2==y.G)if("c"==qe[0]){y.K=qe[1],y.ia=qe[2];const dn=qe[3];null!=dn&&(y.la=dn,y.j.info("VER="+y.la));const hn=qe[4];null!=hn&&(y.Aa=hn,y.j.info("SVER="+y.Aa));const Wa=qe[5];null!=Wa&&"number"==typeof Wa&&0<Wa&&(y.L=E=1.5*Wa,y.j.info("backChannelRequestTimeoutMs_="+E)),E=y;const vr=l.g;if(vr){const rh=vr.g?vr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rh){var q=E.h;q.g||-1==rh.indexOf("spdy")&&-1==rh.indexOf("quic")&&-1==rh.indexOf("h2")||(q.j=q.l,q.g=new Set,q.h&&(Jp(q,q.h),q.h=null))}if(E.D){const rm=vr.g?vr.g.getResponseHeader("X-HTTP-Session-Id"):null;rm&&(E.ya=rm,mt(E.I,E.D,rm))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-l.F,y.j.info("Handshake RTT: "+y.R+"ms"));var ce=l;if((E=y).qa=L_(E,E.J?E.ia:null,E.W),ce.K){h_(E.h,ce);var ut=ce,nn=E.L;nn&&(ut.I=nn),ut.B&&(Qp(ut),Hd(ut)),E.g=ce}else k_(E);0<y.i.length&&eh(y)}else"stop"!=qe[0]&&"close"!=qe[0]||vo(y,7);else 3==y.G&&("stop"==qe[0]||"close"==qe[0]?"stop"==qe[0]?vo(y,7):em(y):"noop"!=qe[0]&&y.l&&y.l.ta(qe),y.v=0)}Vl()}catch{}}ys.prototype.ca=function(l){l=l.target;const m=this.M;m&&3==Di(l)?m.j():this.Y(l)},ys.prototype.Y=function(l){try{if(l==this.g)e:{const hn=Di(this.g);var m=this.g.Ba();if(this.g.Z(),!(3>hn)&&(3!=hn||this.g&&(this.h.h||this.g.oa()||S_(this.g)))){this.J||4!=hn||7==m||Vl(),Qp(this);var y=this.g.Z();this.X=y;t:if(a_(this)){var E=S_(this.g);l="";var F=E.length,q=4==Di(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){_o(this),Fl(this);var ce="";break t}this.h.i=new f.TextDecoder}for(m=0;m<F;m++)this.h.h=!0,l+=this.h.i.decode(E[m],{stream:!(q&&m==F-1)});E.length=0,this.h.g+=l,this.C=0,ce=this.h.g}else ce=this.g.oa();if(this.o=200==y,function LT(l,m,y,E,F,q,ce){l.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+F+"]: "+m+"\n"+y+"\n"+q+" "+ce})}(this.i,this.u,this.A,this.l,this.R,hn,y),this.o){if(this.T&&!this.K){t:{if(this.g){var ut,nn=this.g;if((ut=nn.g?nn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ye(ut)){var qe=ut;break t}}qe=null}if(!(y=qe)){this.o=!1,this.s=3,Cn(12),_o(this),Fl(this);break e}$a(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yp(this,y)}if(this.P){let vr;for(y=!0;!this.J&&this.C<ce.length;){if(vr=BT(this,ce),vr==Hp){4==hn&&(this.s=4,Cn(14),y=!1),$a(this.i,this.l,null,"[Incomplete Response]");break}if(vr==s_){this.s=4,Cn(15),$a(this.i,this.l,ce,"[Invalid Chunk]"),y=!1;break}$a(this.i,this.l,vr,null),Yp(this,vr)}if(a_(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=hn||0!=ce.length||this.h.h||(this.s=1,Cn(16),y=!1),this.o=this.o&&y,y){if(0<ce.length&&!this.W){this.W=!0;var dn=this.j;dn.g==this&&dn.ba&&!dn.M&&(dn.j.info("Great, no buffering proxy detected. Bytes received: "+ce.length),nm(dn),dn.M=!0,Cn(11))}}else $a(this.i,this.l,ce,"[Invalid Chunked Response]"),_o(this),Fl(this)}else $a(this.i,this.l,ce,null),Yp(this,ce);4==hn&&_o(this),this.o&&!this.J&&(4==hn?N_(this.j,this):(this.o=!1,Hd(this)))}else(function rE(l){const m={};l=(l.g&&2<=Di(l)&&l.g.getAllResponseHeaders()||"").split("\r\n");for(let E=0;E<l.length;E++){if(ye(l[E]))continue;var y=M(l[E]);const F=y[0];if("string"!=typeof(y=y[1]))continue;y=y.trim();const q=m[F]||[];m[F]=q,q.push(y)}!function k(l,m){for(const y in l)m.call(void 0,l[y],y,l)}(m,function(E){return E.join(", ")})})(this.g),400==y&&0<ce.indexOf("Unknown SID")?(this.s=3,Cn(12)):(this.s=0,Cn(13)),_o(this),Fl(this)}}}catch{}},ys.prototype.cancel=function(){this.J=!0,_o(this)},ys.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(function FT(l,m){l.info(function(){return"TIMEOUT: "+m})}(this.i,this.A),2!=this.L&&(Vl(),Cn(17)),_o(this),this.s=2,Fl(this)):c_(this,this.S-l)};var GT=class{constructor(l,m){this.g=l,this.map=m}};function l_(l){this.l=l||10,l=f.PerformanceNavigationTiming?0<(l=f.performance.getEntriesByType("navigation")).length&&("hq"==l[0].nextHopProtocol||"h2"==l[0].nextHopProtocol):!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function u_(l){return!!l.h||!!l.g&&l.g.size>=l.j}function d_(l){return l.h?1:l.g?l.g.size:0}function Xp(l,m){return l.h?l.h==m:!!l.g&&l.g.has(m)}function Jp(l,m){l.g?l.g.add(m):l.h=m}function h_(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}function f_(l){if(null!=l.h)return l.i.concat(l.h.D);if(null!=l.g&&0!==l.g.size){let m=l.i;for(const y of l.g.values())m=m.concat(y.D);return m}return ne(l.i)}function p_(l,m){if(l.forEach&&"function"==typeof l.forEach)l.forEach(m,void 0);else if(p(l)||"string"==typeof l)Array.prototype.forEach.call(l,m,void 0);else for(var y=function jT(l){if(l.na&&"function"==typeof l.na)return l.na();if(!l.V||"function"!=typeof l.V){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(p(l)||"string"==typeof l){var m=[];l=l.length;for(var y=0;y<l;y++)m.push(y);return m}m=[],y=0;for(const E in l)m[y++]=E;return m}}}(l),E=function zT(l){if(l.V&&"function"==typeof l.V)return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if("string"==typeof l)return l.split("");if(p(l)){for(var m=[],y=l.length,E=0;E<y;E++)m.push(l[E]);return m}for(E in m=[],y=0,l)m[y++]=l[E];return m}(l),F=E.length,q=0;q<F;q++)m.call(void 0,E[q],y&&y[q],l)}l_.prototype.cancel=function(){if(this.i=f_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const l of this.g.values())l.cancel();this.g.clear()}};var m_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yo(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof yo){this.h=l.h,Wd(this,l.j),this.o=l.o,this.g=l.g,Qd(this,l.s),this.l=l.l;var m=l.i,y=new Gl;y.i=m.i,m.g&&(y.g=new Map(m.g),y.h=m.h),g_(this,y),this.m=l.m}else l&&(m=String(l).match(m_))?(this.h=!1,Wd(this,m[1]||"",!0),this.o=Ul(m[2]||""),this.g=Ul(m[3]||"",!0),Qd(this,m[4]),this.l=Ul(m[5]||"",!0),g_(this,m[6]||"",!0),this.m=Ul(m[7]||"")):(this.h=!1,this.i=new Gl(null,this.h))}function xi(l){return new yo(l)}function Wd(l,m,y){l.j=y?Ul(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Qd(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function g_(l,m,y){m instanceof Gl?(l.i=m,function YT(l,m){m&&!l.j&&(vs(l),l.i=null,l.g.forEach(function(y,E){var F=E.toLowerCase();E!=F&&(y_(this,E),I_(this,F,y))},l)),l.j=m}(l.i,l.h)):(y||(m=Bl(m,WT)),l.i=new Gl(m,l.h))}function mt(l,m,y){l.i.set(m,y)}function Yd(l){return mt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Ul(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Bl(l,m,y){return"string"==typeof l?(l=encodeURI(l).replace(m,$T),y&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function $T(l){return"%"+((l=l.charCodeAt(0))>>4&15).toString(16)+(15&l).toString(16)}yo.prototype.toString=function(){var l=[],m=this.j;m&&l.push(Bl(m,__,!0),":");var y=this.g;return(y||"file"==m)&&(l.push("//"),(m=this.o)&&l.push(Bl(m,__,!0),"@"),l.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(y=this.s)&&l.push(":",String(y))),(y=this.l)&&(this.g&&"/"!=y.charAt(0)&&l.push("/"),l.push(Bl(y,"/"==y.charAt(0)?HT:KT,!0))),(y=this.i.toString())&&l.push("?",y),(y=this.m)&&l.push("#",Bl(y,QT)),l.join("")};var __=/[#\/\?@]/g,KT=/[#\?:]/g,HT=/[#\?]/g,WT=/[#\?@]/g,QT=/#/g;function Gl(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function vs(l){l.g||(l.g=new Map,l.h=0,l.i&&function qT(l,m){if(l){l=l.split("&");for(var y=0;y<l.length;y++){var E=l[y].indexOf("="),F=null;if(0<=E){var q=l[y].substring(0,E);F=l[y].substring(E+1)}else q=l[y];m(q,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}(l.i,function(m,y){l.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}function y_(l,m){vs(l),m=Ka(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function v_(l,m){return vs(l),m=Ka(l,m),l.g.has(m)}function I_(l,m,y){y_(l,m),0<y.length&&(l.i=null,l.g.set(Ka(l,m),ne(y)),l.h+=y.length)}function Ka(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Is(l,m,y,E,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),E(y)}catch{}}function ZT(){this.g=new VT}function eE(l,m,y){const E=y||"";try{p_(l,function(F,q){let ce=F;_(F)&&(ce=zp(F)),m.push(E+q+"="+encodeURIComponent(ce))})}catch(F){throw m.push(E+"type="+encodeURIComponent("_badmap")),F}}function zl(l){this.l=l.Ub||null,this.j=l.eb||!1}function Xd(l,m){un.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function T_(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}function jl(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ql(l)}function ql(l){l.onreadystatechange&&l.onreadystatechange.call(l)}function E_(l){let m="";return ke(l,function(y,E){m+=E,m+=":",m+=y,m+="\r\n"}),m}function Zp(l,m,y){e:{for(E in y){var E=!1;break e}E=!0}E||(y=E_(y),"string"==typeof l?null!=y&&encodeURIComponent(String(y)):mt(l,m,y))}function Ct(l){un.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(r=Gl.prototype).add=function(l,m){vs(this),this.i=null,l=Ka(this,l);var y=this.g.get(l);return y||this.g.set(l,y=[]),y.push(m),this.h+=1,this},r.forEach=function(l,m){vs(this),this.g.forEach(function(y,E){y.forEach(function(F){l.call(m,F,E,this)},this)},this)},r.na=function(){vs(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),y=[];for(let E=0;E<m.length;E++){const F=l[E];for(let q=0;q<F.length;q++)y.push(m[E])}return y},r.V=function(l){vs(this);let m=[];if("string"==typeof l)v_(this,l)&&(m=m.concat(this.g.get(Ka(this,l))));else{l=Array.from(this.g.values());for(let y=0;y<l.length;y++)m=m.concat(l[y])}return m},r.set=function(l,m){return vs(this),this.i=null,v_(this,l=Ka(this,l))&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},r.get=function(l,m){return l&&0<(l=this.V(l)).length?String(l[0]):m},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var y=0;y<m.length;y++){var E=m[y];const q=encodeURIComponent(String(E)),ce=this.V(E);for(E=0;E<ce.length;E++){var F=q;""!==ce[E]&&(F+="="+encodeURIComponent(String(ce[E]))),l.push(F)}}return this.i=l.join("&")},Q(zl,jp),zl.prototype.g=function(){return new Xd(this.l,this.j)},zl.prototype.i=function(l){return function(){return l}}({}),Q(Xd,un),(r=Xd.prototype).open=function(l,m){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,ql(this)},r.send=function(l){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||f).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jl(this)),this.readyState=0},r.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ql(this)),this.g&&(this.readyState=3,ql(this),this.g)))if("arraybuffer"===this.responseType)l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;T_(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))},r.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?jl(this):ql(this),3==this.readyState&&T_(this)}},r.Ra=function(l){this.g&&(this.response=this.responseText=l,jl(this))},r.Qa=function(l){this.g&&(this.response=l,jl(this))},r.ga=function(){this.g&&jl(this)},r.setRequestHeader=function(l,m){this.u.append(l,m)},r.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var y=m.next();!y.done;)l.push((y=y.value)[0]+": "+y[1]),y=m.next();return l.join("\r\n")},Object.defineProperty(Xd.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(l){this.m=l?"include":"same-origin"}}),Q(Ct,un);var tE=/^https?$/i,nE=["POST","PUT"];function A_(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,b_(l),Jd(l)}function b_(l){l.A||(l.A=!0,wn(l,"complete"),wn(l,"error"))}function w_(l){if(l.h&&typeof c<"u"&&(!l.v[1]||4!=Di(l)||2!=l.Z()))if(l.u&&4==Di(l))Hg(l.Ea,0,l);else if(wn(l,"readystatechange"),4==Di(l)){l.h=!1;try{const ce=l.Z();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var E;if(E=0===ce){var F=String(l.D).match(m_)[1]||null;!F&&f.self&&f.self.location&&(F=f.self.location.protocol.slice(0,-1)),E=!tE.test(F?F.toLowerCase():"")}y=E}if(y)wn(l,"complete"),wn(l,"success");else{l.m=6;try{var q=2<Di(l)?l.g.statusText:""}catch{q=""}l.l=q+" ["+l.Z()+"]",b_(l)}}finally{Jd(l)}}}function Jd(l,m){if(l.g){C_(l);const y=l.g,E=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||wn(l,"ready");try{y.onreadystatechange=E}catch{}}}function C_(l){l.I&&(f.clearTimeout(l.I),l.I=null)}function Di(l){return l.g?l.g.readyState:0}function S_(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function $l(l,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[l]||m}function R_(l){this.Aa=0,this.i=[],this.j=new Ll,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$l("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$l("baseRetryDelayMs",5e3,l),this.cb=$l("retryDelaySeedMs",1e4,l),this.Wa=$l("forwardChannelMaxRetries",2,l),this.wa=$l("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new l_(l&&l.concurrentRequestLimit),this.Da=new ZT,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function em(l){if(P_(l),3==l.G){var m=l.U++,y=xi(l.I);if(mt(y,"SID",l.K),mt(y,"RID",m),mt(y,"TYPE","terminate"),Kl(l,y),(m=new ys(l,l.j,m)).L=2,m.v=Yd(xi(y)),y=!1,f.navigator&&f.navigator.sendBeacon)try{y=f.navigator.sendBeacon(m.v.toString(),"")}catch{}!y&&f.Image&&((new Image).src=m.v,y=!0),y||(m.g=F_(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Hd(m)}M_(l)}function Zd(l){l.g&&(nm(l),l.g.cancel(),l.g=null)}function P_(l){Zd(l),l.u&&(f.clearTimeout(l.u),l.u=null),th(l),l.h.cancel(),l.s&&("number"==typeof l.s&&f.clearTimeout(l.s),l.s=null)}function eh(l){if(!u_(l.h)&&!l.s){l.s=!0;var m=l.Ga;Pl||Gg(),xl||(Pl(),xl=!0),Op.add(m,l),l.B=0}}function x_(l,m){var y;y=m?m.l:l.U++;const E=xi(l.I);mt(E,"SID",l.K),mt(E,"RID",y),mt(E,"AID",l.T),Kl(l,E),l.m&&l.o&&Zp(E,l.m,l.o),y=new ys(l,l.j,y,l.B+1),null===l.m&&(y.H=l.o),m&&(l.i=m.D.concat(l.i)),m=D_(l,y,1e3),y.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Jp(l.h,y),Wp(y,E,m)}function Kl(l,m){l.H&&ke(l.H,function(y,E){mt(m,E,y)}),l.l&&p_({},function(y,E){mt(m,E,y)})}function D_(l,m,y){y=Math.min(l.i.length,y);var E=l.l?S(l.l.Na,l.l,l):null;e:{var F=l.i;let q=-1;for(;;){const ce=["count="+y];-1==q?0<y?(q=F[0].g,ce.push("ofs="+q)):q=0:ce.push("ofs="+q);let ut=!0;for(let nn=0;nn<y;nn++){let qe=F[nn].g;const dn=F[nn].map;if(qe-=q,0>qe)q=Math.max(0,F[nn].g-100),ut=!1;else try{eE(dn,ce,"req"+qe+"_")}catch{E&&E(dn)}}if(ut){E=ce.join("&");break e}}}return l=l.i.splice(0,y),m.D=l,E}function k_(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;Pl||Gg(),xl||(Pl(),xl=!0),Op.add(m,l),l.v=0}}function tm(l){return!(l.g||l.u||3<=l.v||(l.Y++,l.u=Ml(S(l.Fa,l),V_(l,l.v)),l.v++,0))}function nm(l){null!=l.A&&(f.clearTimeout(l.A),l.A=null)}function O_(l){l.g=new ys(l,l.j,"rpc",l.Y),null===l.m&&(l.g.H=l.o),l.g.O=0;var m=xi(l.qa);mt(m,"RID","rpc"),mt(m,"SID",l.K),mt(m,"AID",l.T),mt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&mt(m,"TO",l.ja),mt(m,"TYPE","xmlhttp"),Kl(l,m),l.m&&l.o&&Zp(m,l.m,l.o),l.L&&(l.g.I=l.L);var y=l.g;l=l.ia,y.L=1,y.v=Yd(xi(m)),y.m=null,y.P=!0,o_(y,l)}function th(l){null!=l.C&&(f.clearTimeout(l.C),l.C=null)}function N_(l,m){var y=null;if(l.g==m){th(l),nm(l),l.g=null;var E=2}else{if(!Xp(l.h,m))return;y=m.D,h_(l.h,m),E=1}if(0!=l.G)if(m.o)if(1==E){y=m.m?m.m.length:0,m=Date.now()-m.F;var F=l.B;wn(E=qd(),new n_(E,y)),eh(l)}else k_(l);else if(3==(F=m.s)||0==F&&0<m.X||!(1==E&&function iE(l,m){return!(d_(l.h)>=l.h.j-(l.s?1:0)||(l.s?(l.i=m.D.concat(l.i),0):1==l.G||2==l.G||l.B>=(l.Va?0:l.Wa)||(l.s=Ml(S(l.Ga,l,m),V_(l,l.B)),l.B++,0)))}(l,m)||2==E&&tm(l)))switch(y&&0<y.length&&(m=l.h,m.i=m.i.concat(y)),F){case 1:vo(l,5);break;case 4:vo(l,10);break;case 3:vo(l,6);break;default:vo(l,2)}}function V_(l,m){let y=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(y*=2),y*m}function vo(l,m){if(l.j.info("Error code "+m),2==m){var y=S(l.fb,l),E=l.Xa;const F=!E;E=new yo(E||"//www.google.com/images/cleardot.gif"),f.location&&"http"==f.location.protocol||Wd(E,"https"),Yd(E),F?function XT(l,m){const y=new Ll;if(f.Image){const E=new Image;E.onload=L(Is,y,"TestLoadImage: loaded",!0,m,E),E.onerror=L(Is,y,"TestLoadImage: error",!1,m,E),E.onabort=L(Is,y,"TestLoadImage: abort",!1,m,E),E.ontimeout=L(Is,y,"TestLoadImage: timeout",!1,m,E),f.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=l}else m(!1)}(E.toString(),y):function JT(l,m){new Ll;const E=new AbortController,F=setTimeout(()=>{E.abort(),Is(0,0,!1,m)},1e4);fetch(l,{signal:E.signal}).then(q=>{clearTimeout(F),Is(0,0,!!q.ok,m)}).catch(()=>{clearTimeout(F),Is(0,0,!1,m)})}(E.toString(),y)}else Cn(2);l.G=0,l.l&&l.l.sa(m),M_(l),P_(l)}function M_(l){if(l.G=0,l.ka=[],l.l){const m=f_(l.h);(0!=m.length||0!=l.i.length)&&(X(l.ka,m),X(l.ka,l.i),l.h.i.length=0,ne(l.i),l.i.length=0),l.l.ra()}}function L_(l,m,y){var E=y instanceof yo?xi(y):new yo(y);if(""!=E.g)m&&(E.g=m+"."+E.g),Qd(E,E.s);else{var F=f.location;E=F.protocol,m=m?m+"."+F.hostname:F.hostname,F=+F.port;var q=new yo(null);E&&Wd(q,E),m&&(q.g=m),F&&Qd(q,F),y&&(q.l=y),E=q}return m=l.ya,(y=l.D)&&m&&mt(E,y,m),mt(E,"VER",l.la),Kl(l,E),E}function F_(l,m,y){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return(m=new Ct(l.Ca&&!l.pa?new zl({eb:y}):l.pa)).Ha(l.J),m}function U_(){}function nh(){}function $n(l,m){un.call(this),this.g=new R_(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!ye(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!ye(m)&&(this.g.D=m,null!==(l=this.h)&&m in l&&m in(l=this.h)&&delete l[m]),this.j=new Ha(this)}function B_(l){qp.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const y in m){l=y;break e}l=void 0}(this.i=l)&&(l=this.i,m=null!==m&&l in m?m[l]:void 0),this.data=m}else this.data=l}function G_(){$p.call(this),this.status=1}function Ha(l){this.g=l}(r=Ct.prototype).Ha=function(l){this.J=l},r.ea=function(l,m,y,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Kp.g(),this.v=function Xg(l){return l.h||(l.h=l.i())}(this.o?this.o:Kp),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(q){return void A_(this,q)}if(l=y||"",y=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var F in E)y.set(F,E[F]);else{if("function"!=typeof E.keys||"function"!=typeof E.get)throw Error("Unknown input type for opt_headers: "+String(E));for(const q of E.keys())y.set(q,E.get(q))}E=Array.from(y.keys()).find(q=>"content-type"==q.toLowerCase()),F=f.FormData&&l instanceof f.FormData,!(0<=Array.prototype.indexOf.call(nE,m,void 0))||E||F||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,ce]of y)this.g.setRequestHeader(q,ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{C_(this),this.u=!0,this.g.send(l),this.u=!1}catch(q){A_(this,q)}},r.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,wn(this,"complete"),wn(this,"abort"),Jd(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Jd(this,!0)),Ct.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?w_(this):this.bb())},r.bb=function(){w_(this)},r.isActive=function(){return!!this.g},r.Z=function(){try{return 2<Di(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&0==m.indexOf(l)&&(m=m.substring(l.length)),NT(m)}},r.Ba=function(){return this.m},r.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(r=R_.prototype).la=8,r.G=1,r.connect=function(l,m,y,E){Cn(0),this.W=l,this.H=m||{},y&&void 0!==E&&(this.H.OSID=y,this.H.OAID=E),this.F=this.X,this.I=L_(this,null,this.W),eh(this)},r.Ga=function(l){if(this.s)if(this.s=null,1==this.G){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const F=new ys(this,this.j,l);let q=this.o;if(this.S&&(q?(q=w(q),N(q,this.S)):q=this.S),null!==this.m||this.O||(F.H=q,q=null),this.P)e:{for(var m=0,y=0;y<this.i.length;y++){var E=this.i[y];if(void 0===(E="__data__"in E.map&&"string"==typeof(E=E.map.__data__)?E.length:void 0))break;if(4096<(m+=E)){m=y;break e}if(4096===m||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=D_(this,F,m),mt(y=xi(this.I),"RID",l),mt(y,"CVER",22),this.D&&mt(y,"X-HTTP-Session-Id",this.D),Kl(this,y),q&&(this.O?m="headers="+encodeURIComponent(String(E_(q)))+"&"+m:this.m&&Zp(y,this.m,q)),Jp(this.h,F),this.Ua&&mt(y,"TYPE","init"),this.P?(mt(y,"$req",m),mt(y,"SID","null"),F.T=!0,Wp(F,y,null)):Wp(F,y,m),this.G=2}}else 3==this.G&&(l?x_(this,l):0==this.i.length||u_(this.h)||x_(this))},r.Fa=function(){if(this.u=null,O_(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ml(S(this.ab,this),l)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Cn(10),Zd(this),O_(this))},r.Za=function(){null!=this.C&&(this.C=null,Zd(this),tm(this),Cn(19))},r.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Cn(2)):(this.j.info("Failed to ping google.com"),Cn(1))},r.isActive=function(){return!!this.l&&this.l.isActive(this)},(r=U_.prototype).ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){},nh.prototype.g=function(l,m){return new $n(l,m)},Q($n,un),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){em(this.g)},$n.prototype.o=function(l){var m=this.g;if("string"==typeof l){var y={};y.__data__=l,l=y}else this.u&&((y={}).__data__=zp(l),l=y);m.i.push(new GT(m.Ya++,l)),3==m.G&&eh(m)},$n.prototype.N=function(){this.g.l=null,delete this.j,em(this.g),delete this.g,$n.aa.N.call(this)},Q(B_,qp),Q(G_,$p),Q(Ha,U_),Ha.prototype.ua=function(){wn(this.g,"a")},Ha.prototype.ta=function(l){wn(this.g,new B_(l))},Ha.prototype.sa=function(l){wn(this.g,new G_)},Ha.prototype.ra=function(){wn(this.g,"b")},nh.prototype.createWebChannel=nh.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,Ya=Ee.createWebChannelTransport=function(){return new nh},nt=Ee.getStatEventTarget=function(){return qd()},Co=Ee.Event=go,cr=Ee.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$d.NO_ERROR=0,$d.TIMEOUT=8,$d.HTTP_ERROR=6,Kt=Ee.ErrorCode=$d,r_.COMPLETE="complete",Je=Ee.EventType=r_,Jg.EventType=Nl,Nl.OPEN="a",Nl.CLOSE="b",Nl.ERROR="c",Nl.MESSAGE="d",un.prototype.listen=un.prototype.K,Xe=Ee.WebChannel=Jg,De=Ee.FetchXmlHttpFactory=zl,Ct.prototype.listenOnce=Ct.prototype.L,Ct.prototype.getLastError=Ct.prototype.Ka,Ct.prototype.getLastErrorCode=Ct.prototype.Ba,Ct.prototype.getStatus=Ct.prototype.Z,Ct.prototype.getResponseJson=Ct.prototype.Oa,Ct.prototype.getResponseText=Ct.prototype.oa,Ct.prototype.send=Ct.prototype.ea,Ct.prototype.setWithCredentials=Ct.prototype.Ha,we=Ee.XhrIo=Ct}).apply(typeof ue<"u"?ue:typeof self<"u"?self:typeof window<"u"?window:{});const Mi="@firebase/firestore";class Ot{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");let xr="10.12.1";const Dr=new vn.Vy("@firebase/firestore");function Li(){return Dr.logLevel}function Z(r,...e){if(Dr.logLevel<=vn.$b.DEBUG){const t=e.map(So);Dr.debug(`Firestore (${xr}): ${r}`,...t)}}function vt(r,...e){if(Dr.logLevel<=vn.$b.ERROR){const t=e.map(So);Dr.error(`Firestore (${xr}): ${r}`,...t)}}function on(r,...e){if(Dr.logLevel<=vn.$b.WARN){const t=e.map(So);Dr.warn(`Firestore (${xr}): ${r}`,...t)}}function So(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function pe(r="Unexpected state"){const e=`FIRESTORE (${xr}) INTERNAL ASSERTION FAILED: `+r;throw vt(e),new Error(e)}function ge(r,e){r||pe()}function ie(r,e){return r}const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Ue.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Pt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Hl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Wl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ot.UNAUTHENTICATED))}shutdown(){}}class Ql{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sh{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const s=_=>this.i!==i?(i=this.i,t(_)):Promise.resolve();let c=new Pt;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Pt,e.enqueueRetryable(()=>s(this.currentUser))};const f=()=>{const _=c;e.enqueueRetryable((0,H.A)(function*(){yield _.promise,yield s(n.currentUser)}))},p=_=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_,this.auth.addAuthTokenListener(this.o),f()};this.t.onInit(_=>p(_)),setTimeout(()=>{if(!this.auth){const _=this.t.getImmediate({optional:!0});_?p(_):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Pt)}},0),f()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ge("string"==typeof n.accessToken),new Hl(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ge(null===e||"string"==typeof e),new Ot(e)}}class Yl{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class oh{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Yl(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ti{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Xl{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=s=>{null!=s.error&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const c=s.token!==this.R;return this.R=s.token,Z("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ge("string"==typeof t.token),this.R=t.token,new ti(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ah(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class Ro{static newId(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=ah(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function Ce(r,e){return r<e?-1:r>e?1:0}function kr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Zl(r){return r+"\0"}class rt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new rt(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ce(this.nanoseconds,e.nanoseconds):Ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class _e{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _e(e)}static min(){return new _e(new rt(0,0))}static max(){return new _e(new rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ni{constructor(e,t,n){void 0===t?t=0:t>e.length&&pe(),void 0===n?n=e.length-t:n>e.length-t&&pe(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ni.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ni?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),c=t.get(i);if(s<c)return-1;if(s>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Oe extends ni{construct(e,t,n){return new Oe(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new J(z.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Oe(t)}static emptyPath(){return new Oe([])}}const Xa=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends ni{construct(e,t,n){return new at(e,t,n)}static isValidIdentifier(e){return Xa.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new at(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new J(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;i<e.length;){const f=e[i];if("\\"===f){if(i+1===e.length)throw new J(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[i+1];if("\\"!==p&&"."!==p&&"`"!==p)throw new J(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=p,i+=2}else"`"===f?(c=!c,i++):"."!==f||c?(n+=f,i++):(s(),i++)}if(s(),c)throw new J(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(t)}static emptyPath(){return new at([])}}class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Oe.fromString(e))}static fromName(e){return new ae(Oe.fromString(e).popFirst(5))}static empty(){return new ae(Oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Oe.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Oe(e.slice()))}}class Fi{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Ds(r){return r.fields.find(e=>2===e.kind)}function ri(r){return r.fields.filter(e=>2!==e.kind)}Fi.UNKNOWN_ID=-1;class ii{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ui{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ui(0,Zt.min())}}function Po(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=_e.fromTimestamp(1e9===n?new rt(t+1,0):new rt(t,n));return new Zt(i,ae.empty(),e)}function eu(r){return new Zt(r.readTime,r.key,-1)}class Zt{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Zt(_e.min(),ae.empty(),-1)}static max(){return new Zt(_e.max(),ae.empty(),-1)}}function si(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=ae.comparator(r.documentKey,e.documentKey),0!==t?t:Ce(r.largestBatchId,e.largestBatchId))}const Qn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Or(r){return xn.apply(this,arguments)}function xn(){return(xn=(0,H.A)(function*(r){if(r.code!==z.FAILED_PRECONDITION||r.message!==Qn)throw r;Z("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):U.reject(t)}static resolve(e){return new U((t,n)=>{t(e)})}static reject(e){return new U((t,n)=>{n(e)})}static waitFor(e){return new U((t,n)=>{let i=0,s=0,c=!1;e.forEach(f=>{++i,f.next(()=>{++s,c&&s===i&&t()},p=>n(p))}),c=!0,s===i&&t()})}static or(e){let t=U.resolve(!1);for(const n of e)t=t.next(i=>i?U.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new U((n,i)=>{const s=e.length,c=new Array(s);let f=0;for(let p=0;p<s;p++){const _=p;t(e[_]).next(v=>{c[_]=v,++f,f===s&&n(c)},v=>i(v))}})}static doWhile(e,t){return new U((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}class Bi{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Pt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new oi(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{const i=ec(n.target.error);this.V.reject(new oi(e,i))}}static open(e,t,n,i){try{return new Bi(t,e.transaction(i,n))}catch(s){throw new oi(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new lh(t)}}class Yn{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===Yn.S((0,Ue.ZQ)())&&vt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Z("SimpleDb","Removing database:",e),lr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,Ue.zW)())return!1;if(Yn.C())return!0;const e=(0,Ue.ZQ)(),t=Yn.S(e),n=0<t&&t<10,i=Do(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.v)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}M(e){var t=this;return(0,H.A)(function*(){return t.db||(Z("SimpleDb","Opening database:",t.name),t.db=yield new Promise((n,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=c=>{n(c.target.result)},s.onblocked=()=>{i(new oi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=c=>{const f=c.target.error;i("VersionError"===f.name?new J(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===f.name?new J(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+f):new oi(e,f))},s.onupgradeneeded=c=>{Z("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',c.oldVersion),t.p.O(c.target.result,s.transaction,c.oldVersion,t.version).next(()=>{Z("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.N&&(t.db.onversionchange=n=>t.N(n)),t.db})()}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,i){var s=this;return(0,H.A)(function*(){const c="readonly"===t;let f=0;for(;;){++f;try{s.db=yield s.M(e);const p=Bi.open(s.db,e,c?"readonly":"readwrite",n),_=i(p).next(v=>(p.g(),v)).catch(v=>(p.abort(v),U.reject(v))).toPromise();return _.catch(()=>{}),yield p.m,_}catch(p){const _=p,v="FirebaseError"!==_.name&&f<3;if(Z("SimpleDb","Transaction failed with error:",_.message,"Retrying:",v),s.close(),!v)return Promise.reject(_)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}function Do(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ch{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return lr(this.B.delete())}}class oi extends J{constructor(e,t){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Nr(r){return"IndexedDbTransactionError"===r.name}class lh{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Z("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Z("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),lr(n)}add(e){return Z("SimpleDb","ADD",this.store.name,e,e),lr(this.store.add(e))}get(e){return lr(this.store.get(e)).next(t=>(void 0===t&&(t=null),Z("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Z("SimpleDb","DELETE",this.store.name,e),lr(this.store.delete(e))}count(){return Z("SimpleDb","COUNT",this.store.name),lr(this.store.count())}U(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const s=i.getAll(n.range);return new U((c,f)=>{s.onerror=p=>{f(p.target.error)},s.onsuccess=p=>{c(p.target.result)}})}{const s=this.cursor(n),c=[];return this.W(s,(f,p)=>{c.push(p)}).next(()=>c)}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new U((i,s)=>{n.onerror=c=>{s(c.target.error)},n.onsuccess=c=>{i(c.target.result)}})}j(e,t){Z("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const i=this.cursor(n);return this.W(i,(s,c,f)=>f.delete())}J(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.W(i,t)}Y(e){const t=this.cursor({});return new U((n,i)=>{t.onerror=s=>{const c=ec(s.target.error);i(c)},t.onsuccess=s=>{const c=s.target.result;c?e(c.primaryKey,c.value).next(f=>{f?c.continue():n()}):n()}})}W(e,t){const n=[];return new U((i,s)=>{e.onerror=c=>{s(c.target.error)},e.onsuccess=c=>{const f=c.target.result;if(!f)return void i();const p=new ch(f),_=t(f.primaryKey,f.value,p);if(_ instanceof U){const v=_.catch(T=>(p.done(),U.reject(T)));n.push(v)}p.isDone?i():null===p.K?f.continue():f.continue(p.K)}}).next(()=>U.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function lr(r){return new U((e,t)=>{r.onsuccess=n=>{e(n.target.result)},r.onerror=n=>{const i=ec(n.target.error);t(i)}})}let Vr=!1;function ec(r){const e=Yn.S((0,Ue.ZQ)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new J("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Vr||(Vr=!0,setTimeout(()=>{throw n},0)),n}}return r}class uh{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){var t=this;Z("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,H.A)(function*(){t.task=null;try{Z("IndexBackfiller",`Documents written: ${yield t.Z.ee()}`)}catch(n){Nr(n)?Z("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Or(n)}yield t.X(6e4)}))}}class ks{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){var t=this;return(0,H.A)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>t.te(n,e))})()}te(e,t){const n=new Set;let i=t,s=!0;return U.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(null!==c&&!n.has(c))return Z("IndexBackfiller",`Processing collection: ${c}`),this.ne(e,c,i).next(f=>{i-=f,n.add(c)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const c=s.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.re(i,s)).next(f=>(Z("IndexBackfiller",`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(e,t,f))).next(()=>c.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{const c=eu(s);si(c,n)>0&&(n=c)}),new Zt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Dn=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}return r.oe=-1,r})();function ai(r){return null==r}function In(r){return 0===r&&1/r==-1/0}function ci(r){return"number"==typeof r&&Number.isInteger(r)&&!In(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}function It(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=tc(e)),e=tu(r.get(t),e);return tc(e)}function tu(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function tc(r){return r+"\x01\x01"}function Bn(r){const e=r.length;if(ge(e>=2),2===e)return ge("\x01"===r.charAt(0)&&"\x01"===r.charAt(1)),Oe.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const c=r.indexOf("\x01",s);switch((c<0||c>t)&&pe(),r.charAt(c+1)){case"\x01":const f=r.substring(s,c);let p;0===i.length?p=f:(i+=f,p=i,i=""),n.push(p);break;case"\x10":i+=r.substring(s,c),i+="\0";break;case"\x11":i+=r.substring(s,c+1);break;default:pe()}s=c+2}return new Oe(n)}const nu=["userId","batchId"];function ur(r,e){return[r,It(e)]}function ru(r,e,t){return[r,It(e),t]}const ko={},iu=["prefixPath","collectionGroup","readTime","documentId"],su=["prefixPath","collectionGroup","documentId"],nc=["collectionGroup","readTime","prefixPath","documentId"],kn=["canonicalId","targetId"],ou=["targetId","path"],dh=["path","targetId"],rc=["collectionId","parent"],Oo=["indexId","uid"],au=["uid","sequenceNumber"],cu=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hh=["indexId","uid","orderedDocumentKey"],ic=["userId","collectionPath","documentId"],sc=["userId","collectionPath","largestBatchId"],oc=["userId","collectionGroup","largestBatchId"],Os=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ac=[...Os,"documentOverlays"],cc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],No=cc,lc=[...No,"indexConfiguration","indexState","indexEntries"],uc=lc;class Gi extends xo{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function bt(r,e){const t=ie(r);return Yn.F(t._e,e)}function dc(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Xn(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Vo(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class it{constructor(e,t){this.comparator=e,this.root=t||Ut.EMPTY}insert(e,t){return new it(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ut.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ut.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zi(this.root,e,this.comparator,!1)}getReverseIterator(){return new zi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zi(this.root,e,this.comparator,!0)}}class zi{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ut{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Ut.RED,this.left=i??Ut.EMPTY,this.right=s??Ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Ut(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ut.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw pe();const e=this.left.check();if(e!==this.right.check())throw pe();return e+(this.isRed()?0:1)}}Ut.EMPTY=null,Ut.RED=!0,Ut.BLACK=!1,Ut.EMPTY=new class{constructor(){this.size=0}get key(){throw pe()}get value(){throw pe()}get color(){throw pe()}get left(){throw pe()}get right(){throw pe()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Ut(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ze{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ji(this.data.getIterator())}getIteratorFrom(e){return new ji(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof ze)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ze(this.comparator);return t.data=e,t}}class ji{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mr(r){return r.hasNext()?r.getNext():void 0}class Ht{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new Ht([])}unionWith(e){let t=new ze(at.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ht(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return kr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class Ns extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ns("Invalid base64 string: "+s):s}}(e);return new Tt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let c=0;c<i.length;++c)s+=String.fromCharCode(i[c]);return s}(e);return new Tt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const fh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gn(r){if(ge(!!r),"string"==typeof r){let e=0;const t=fh.exec(r);if(ge(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:_t(r.seconds),nanos:_t(r.nanos)}}function _t(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function zn(r){return"string"==typeof r?Tt.fromBase64String(r):Tt.fromUint8Array(r)}function Mo(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function qi(r){const e=r.mapValue.fields.__previous_value__;return Mo(e)?qi(e):e}function $i(r){const e=Gn(r.mapValue.fields.__local_write_time__.timestampValue);return new rt(e.seconds,e.nanos)}class pc{constructor(e,t,n,i,s,c,f,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=_}}class Lr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Lr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Lr&&e.projectId===this.projectId&&e.database===this.database}}const Jn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Lo={nullValue:"NULL_VALUE"};function Zn(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Mo(r)?4:du(r)?9007199254740991:10:pe()}function er(r,e){if(r===e)return!0;const t=Zn(r);if(t!==Zn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return $i(r).isEqual($i(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const c=Gn(i.timestampValue),f=Gn(s.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return s=e,zn(r.bytesValue).isEqual(zn(s.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return _t(i.geoPointValue.latitude)===_t(s.geoPointValue.latitude)&&_t(i.geoPointValue.longitude)===_t(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return _t(i.integerValue)===_t(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const c=_t(i.doubleValue),f=_t(s.doubleValue);return c===f?In(c)===In(f):isNaN(c)&&isNaN(f)}return!1}(r,e);case 9:return kr(r.arrayValue.values||[],e.arrayValue.values||[],er);case 10:return function(i,s){const c=i.mapValue.fields||{},f=s.mapValue.fields||{};if(dc(c)!==dc(f))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(void 0===f[p]||!er(c[p],f[p])))return!1;return!0}(r,e);default:return pe()}var s}function Vs(r,e){return void 0!==(r.values||[]).find(t=>er(t,e))}function tr(r,e){if(r===e)return 0;const t=Zn(r),n=Zn(e);if(t!==n)return Ce(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ce(r.booleanValue,e.booleanValue);case 2:return function(s,c){const f=_t(s.integerValue||s.doubleValue),p=_t(c.integerValue||c.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(r,e);case 3:return lu(r.timestampValue,e.timestampValue);case 4:return lu($i(r),$i(e));case 5:return Ce(r.stringValue,e.stringValue);case 6:return function(s,c){const f=zn(s),p=zn(c);return f.compareTo(p)}(r.bytesValue,e.bytesValue);case 7:return function(s,c){const f=s.split("/"),p=c.split("/");for(let _=0;_<f.length&&_<p.length;_++){const v=Ce(f[_],p[_]);if(0!==v)return v}return Ce(f.length,p.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,c){const f=Ce(_t(s.latitude),_t(c.latitude));return 0!==f?f:Ce(_t(s.longitude),_t(c.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(s,c){const f=s.values||[],p=c.values||[];for(let _=0;_<f.length&&_<p.length;++_){const v=tr(f[_],p[_]);if(v)return v}return Ce(f.length,p.length)}(r.arrayValue,e.arrayValue);case 10:return function(s,c){if(s===Jn.mapValue&&c===Jn.mapValue)return 0;if(s===Jn.mapValue)return 1;if(c===Jn.mapValue)return-1;const f=s.fields||{},p=Object.keys(f),_=c.fields||{},v=Object.keys(_);p.sort(),v.sort();for(let T=0;T<p.length&&T<v.length;++T){const S=Ce(p[T],v[T]);if(0!==S)return S;const L=tr(f[p[T]],_[v[T]]);if(0!==L)return L}return Ce(p.length,v.length)}(r.mapValue,e.mapValue);default:throw pe()}}function lu(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return Ce(r,e);const t=Gn(r),n=Gn(e),i=Ce(t.seconds,n.seconds);return 0!==i?i:Ce(t.nanos,n.nanos)}function Ki(r){return Ms(r)}function Ms(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Gn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?zn(r.bytesValue).toBase64():"referenceValue"in r?ae.fromName(r.referenceValue).toString():"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=Ms(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const c of n)s?s=!1:i+=",",i+=`${c}:${Ms(t.fields[c])}`;return i+"}"}(r.mapValue):pe()}function dr(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function mc(r){return!!r&&"integerValue"in r}function li(r){return!!r&&"arrayValue"in r}function uu(r){return!!r&&"nullValue"in r}function Uo(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Bo(r){return!!r&&"mapValue"in r}function ui(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Xn(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=ui(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ui(r.arrayValue.values[t]);return e}return Object.assign({},r)}function du(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}function gc(r){return"nullValue"in r?Lo:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?dr(Lr.empty(),ae.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?{mapValue:{}}:pe()}function ph(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?dr(Lr.empty(),ae.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?{mapValue:{}}:"mapValue"in r?Jn:pe()}function Go(r,e){const t=tr(r.value,e.value);return 0!==t?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function hu(r,e){const t=tr(r.value,e.value);return 0!==t?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Bo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ui(t)}setAll(e){let t=at.emptyPath(),n={},i=[];e.forEach((c,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,n,i),n={},i=[],t=f.popLast()}c?n[f.lastSegment()]=ui(c):i.push(f.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Bo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return er(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Bo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Xn(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Bt(ui(this.value))}}function _c(r){const e=[];return Xn(r.fields,(t,n)=>{const i=new at([t]);if(Bo(n)){const s=_c(n.mapValue).fields;if(0===s.length)e.push(i);else for(const c of s)e.push(i.child(c))}else e.push(i)}),new Ht(e)}class Ze{constructor(e,t,n,i,s,c,f){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=c,this.documentState=f}static newInvalidDocument(e){return new Ze(e,0,_e.min(),_e.min(),_e.min(),Bt.empty(),0)}static newFoundDocument(e,t,n,i){return new Ze(e,1,t,_e.min(),n,i,0)}static newNoDocument(e,t){return new Ze(e,2,t,_e.min(),_e.min(),Bt.empty(),0)}static newUnknownDocument(e,t){return new Ze(e,3,t,_e.min(),_e.min(),Bt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_e.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fr{constructor(e,t){this.position=e,this.inclusive=t}}function di(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],c=r.position[i];if(n=s.field.isKeyField()?ae.comparator(ae.fromName(c.referenceValue),t.key):tr(c,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function yc(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!er(r.position[t],e.position[t]))return!1;return!0}class Ls{constructor(e,t="asc"){this.field=e,this.dir=t}}function mh(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class fu{}class Le extends fu{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new im(e,t,n):"array-contains"===t?new Ic(e,n):"in"===t?new Ur(e,n):"not-in"===t?new Tc(e,n):"array-contains-any"===t?new vh(e,n):new Le(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new sm(e,n):new om(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(tr(t,this.value)):null!==t&&Zn(this.value)===Zn(t)&&this.matchesComparison(tr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return pe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends fu{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new He(e,t)}matches(e){return Fs(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Fs(r){return"and"===r.op}function pu(r){return"or"===r.op}function mu(r){return zo(r)&&Fs(r)}function zo(r){for(const e of r.filters)if(e instanceof He)return!1;return!0}function vc(r){if(r instanceof Le)return r.field.canonicalString()+r.op.toString()+Ki(r.value);if(mu(r))return r.filters.map(e=>vc(e)).join(",");{const e=r.filters.map(t=>vc(t)).join(",");return`${r.op}(${e})`}}function gu(r,e){return r instanceof Le?(n=r,(i=e)instanceof Le&&n.op===i.op&&n.field.isEqual(i.field)&&er(n.value,i.value)):r instanceof He?function(n,i){return i instanceof He&&n.op===i.op&&n.filters.length===i.filters.length&&n.filters.reduce((s,c,f)=>s&&gu(c,i.filters[f]),!0)}(r,e):void pe();var n,i}function gh(r,e){const t=r.filters.concat(e);return He.create(t,r.op)}function _h(r){return r instanceof Le?`${(t=r).field.canonicalString()} ${t.op} ${Ki(t.value)}`:r instanceof He?function(t){return t.op.toString()+" {"+t.getFilters().map(_h).join(" ,")+"}"}(r):"Filter";var t}class im extends Le{constructor(e,t,n){super(e,t,n),this.key=ae.fromName(n.referenceValue)}matches(e){const t=ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class sm extends Le{constructor(e,t){super(e,"in",t),this.keys=yh(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class om extends Le{constructor(e,t){super(e,"not-in",t),this.keys=yh(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function yh(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>ae.fromName(n.referenceValue))}class Ic extends Le{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return li(t)&&Vs(t.arrayValue,this.value)}}class Ur extends Le{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Vs(this.value.arrayValue,t)}}class Tc extends Le{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Vs(this.value.arrayValue,t)}}class vh extends Le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!li(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Vs(this.value.arrayValue,n))}}class Ih{constructor(e,t=null,n=[],i=[],s=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=c,this.endAt=f,this.ue=null}}function Ec(r,e=null,t=[],n=[],i=null,s=null,c=null){return new Ih(r,e,t,n,i,s,c)}function Hi(r){const e=ie(r);if(null===e.ue){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vc(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(s=n).field.canonicalString()+s.dir;var s}).join(","),ai(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ki(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ki(n)).join(",")),e.ue=t}return e.ue}function Us(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!mh(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!gu(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!yc(r.startAt,e.startAt)&&yc(r.endAt,e.endAt)}function jo(r){return ae.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}function Wi(r,e){return r.filters.filter(t=>t instanceof Le&&t.field.isEqual(e))}function qo(r,e,t){let n=Lo,i=!0;for(const s of Wi(r,e)){let c=Lo,f=!0;switch(s.op){case"<":case"<=":c=gc(s.value);break;case"==":case"in":case">=":c=s.value;break;case">":c=s.value,f=!1;break;case"!=":case"not-in":c=Lo}Go({value:n,inclusive:i},{value:c,inclusive:f})<0&&(n=c,i=f)}if(null!==t)for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const c=t.position[s];Go({value:n,inclusive:i},{value:c,inclusive:t.inclusive})<0&&(n=c,i=t.inclusive);break}return{value:n,inclusive:i}}function _u(r,e,t){let n=Jn,i=!0;for(const s of Wi(r,e)){let c=Jn,f=!0;switch(s.op){case">=":case">":c=ph(s.value),f=!1;break;case"==":case"in":case"<=":c=s.value;break;case"<":c=s.value,f=!1;break;case"!=":case"not-in":c=Jn}hu({value:n,inclusive:i},{value:c,inclusive:f})>0&&(n=c,i=f)}if(null!==t)for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const c=t.position[s];hu({value:n,inclusive:i},{value:c,inclusive:t.inclusive})>0&&(n=c,i=t.inclusive);break}return{value:n,inclusive:i}}class On{constructor(e,t=null,n=[],i=[],s=null,c="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=c,this.startAt=f,this.endAt=p,this.ce=null,this.le=null,this.he=null}}function Ac(r,e,t,n,i,s,c,f){return new On(r,e,t,n,i,s,c,f)}function Qi(r){return new On(r)}function yu(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function bc(r){return null!==r.collectionGroup}function Bs(r){const e=ie(r);if(null===e.ce){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new ze(at.comparator);return c.filters.forEach(p=>{p.getFlattenedFilters().forEach(_=>{_.isInequality()&&(f=f.add(_.field))})}),f})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ls(s,n))}),t.has(at.keyField().canonicalString())||e.ce.push(new Ls(at.keyField(),n))}return e.ce}function xt(r){const e=ie(r);return e.le||(e.le=function hr(r,e){if("F"===r.limitType)return Ec(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>new Ls(i.field,"desc"===i.dir?"asc":"desc"));const t=r.endAt?new Fr(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Fr(r.startAt.position,r.startAt.inclusive):null;return Ec(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}(e,Bs(r))),e.le}function wc(r,e){const t=r.filters.concat([e]);return new On(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function $o(r,e,t){return new On(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function fr(r,e){return Us(xt(r),xt(e))&&r.limitType===e.limitType}function vu(r){return`${Hi(xt(r))}|lt:${r.limitType}`}function ct(r){return`Query(target=${function(t){let n=t.path.canonicalString();return null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>_h(i)).join(", ")}]`),ai(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>{return`${(c=i).field.canonicalString()} (${c.dir})`;var c}).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Ki(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Ki(i)).join(",")),`Target(${n})`}(xt(r))}; limitType=${r.limitType})`}function Gs(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return null!==n.collectionGroup?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):ae.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of Bs(n))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&(i=e,!((n=r).startAt&&!function(c,f,p){const _=di(c,f,p);return c.inclusive?_<=0:_<0}(n.startAt,Bs(n),i)||n.endAt&&!function(c,f,p){const _=di(c,f,p);return c.inclusive?_>=0:_>0}(n.endAt,Bs(n),i)));var n,i}function Ko(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Iu(r){return(e,t)=>{let n=!1;for(const i of Bs(r)){const s=Cc(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}function Cc(r,e,t){const n=r.field.isKeyField()?ae.comparator(e.key,t.key):function(s,c,f){const p=c.data.field(s),_=f.data.field(s);return null!==p&&null!==_?tr(p,_):pe()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return pe()}}class pr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xn(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Vo(this.inner)}size(){return this.innerSize}}const Eh=new it(ae.comparator);function en(){return Eh}const Tu=new it(ae.comparator);function Br(...r){let e=Tu;for(const t of r)e=e.insert(t.key,t);return e}function Sc(r){let e=Tu;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function an(){return js()}function zs(){return js()}function js(){return new pr(r=>r.toString(),(r,e)=>r.isEqual(e))}const Rc=new it(ae.comparator),Eu=new ze(ae.comparator);function Re(...r){let e=Eu;for(const t of r)e=e.add(t);return e}const Ah=new ze(Ce);function qs(){return Ah}function Pc(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:In(e)?"-0":e}}function Au(r){return{integerValue:""+r}}function bu(r,e){return ci(e)?Au(e):Pc(r,e)}class xc{constructor(){this._=void 0}}function Yi(r,e,t){return r instanceof Xi?function(i,s){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Mo(s)&&(s=qi(s)),s&&(c.fields.__previous_value__=s),{mapValue:c}}(t,e):r instanceof hi?Cu(r,e):r instanceof nr?Su(r,e):function(i,s){const c=wu(i,s),f=Ru(c)+Ru(i.Pe);return mc(c)&&mc(i.Pe)?Au(f):Pc(i.serializer,f)}(r,e)}function bh(r,e,t){return r instanceof hi?Cu(r,e):r instanceof nr?Su(r,e):t}function wu(r,e){return r instanceof Ji?mc(n=e)||(s=n)&&"doubleValue"in s?e:{integerValue:0}:null;var n,s}class Xi extends xc{}class hi extends xc{constructor(e){super(),this.elements=e}}function Cu(r,e){const t=Ho(e);for(const n of r.elements)t.some(i=>er(i,n))||t.push(n);return{arrayValue:{values:t}}}class nr extends xc{constructor(e){super(),this.elements=e}}function Su(r,e){let t=Ho(e);for(const n of r.elements)t=t.filter(i=>!er(i,n));return{arrayValue:{values:t}}}class Ji extends xc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Ru(r){return _t(r.integerValue||r.doubleValue)}function Ho(r){return li(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class $s{constructor(e,t){this.field=e,this.transform=t}}class Ch{constructor(e,t){this.version=e,this.transformResults=t}}class ht{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ht}static exists(e){return new ht(void 0,e)}static updateTime(e){return new ht(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ks(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class Wo{}function Pu(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new Gr(r.key,ht.none()):new Zi(r.key,r.data,ht.none());{const t=r.data,n=Bt.empty();let i=new ze(at.comparator);for(let s of e.fields)if(!i.has(s)){let c=t.field(s);null===c&&s.length>1&&(s=s.popLast(),c=t.field(s)),null===c?n.delete(s):n.set(s,c),i=i.add(s)}return new jn(r.key,n,new Ht(i.toArray()),ht.none())}}function Sh(r,e,t){r instanceof Zi?function(i,s,c){const f=i.value.clone(),p=Yo(i.fieldTransforms,s,c.transformResults);f.setAll(p),s.convertToFoundDocument(c.version,f).setHasCommittedMutations()}(r,e,t):r instanceof jn?function(i,s,c){if(!Ks(i.precondition,s))return void s.convertToUnknownDocument(c.version);const f=Yo(i.fieldTransforms,s,c.transformResults),p=s.data;p.setAll(xu(i)),p.setAll(f),s.convertToFoundDocument(c.version,p).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function fi(r,e,t,n){return r instanceof Zi?function(s,c,f,p){if(!Ks(s.precondition,c))return f;const _=s.value.clone(),v=Hs(s.fieldTransforms,p,c);return _.setAll(v),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),null}(r,e,t,n):r instanceof jn?function(s,c,f,p){if(!Ks(s.precondition,c))return f;const _=Hs(s.fieldTransforms,p,c),v=c.data;return v.setAll(xu(s)),v.setAll(_),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),null===f?null:f.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(T=>T.field))}(r,e,t,n):(f=t,Ks(r.precondition,c=e)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f);var c,f}function Rh(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=wu(n.transform,i||null);null!=s&&(null===t&&(t=Bt.empty()),t.set(n.field,s))}return t||null}function Qo(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(n=r.fieldTransforms)&&void 0===i||n&&i&&kr(n,i,(s,c)=>function wh(r,e){return r.field.isEqual(e.field)&&(i=e.transform,(n=r.transform)instanceof hi&&i instanceof hi||n instanceof nr&&i instanceof nr?kr(n.elements,i.elements,er):n instanceof Ji&&i instanceof Ji?er(n.Pe,i.Pe):n instanceof Xi&&i instanceof Xi);var n,i}(s,c))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var n,i}class Zi extends Wo{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class jn extends Wo{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function xu(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Yo(r,e,t){const n=new Map;ge(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],c=s.transform,f=e.data.field(s.field);n.set(s.field,bh(c,f,t[i]))}return n}function Hs(r,e,t){const n=new Map;for(const i of r){const s=i.transform,c=t.data.field(i.field);n.set(i.field,Yi(s,c,e))}return n}class Gr extends Wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dc extends Wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ws{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Sh(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=fi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=fi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=zs();return this.mutations.forEach(i=>{const s=e.get(i.key),c=s.overlayedDocument;let f=this.applyToLocalView(c,s.mutatedFields);f=t.has(i.key)?null:f;const p=Pu(c,f);null!==p&&n.set(i.key,p),c.isValidDocument()||c.convertToNoDocument(_e.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Re())}isEqual(e){return this.batchId===e.batchId&&kr(this.mutations,e.mutations,(t,n)=>Qo(t,n))&&kr(this.baseMutations,e.baseMutations,(t,n)=>Qo(t,n))}}class pi{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ge(e.mutations.length===n.length);let i=function(){return Rc}();const s=e.mutations;for(let c=0;c<s.length;c++)i=i.insert(s[c].key,n[c].version);return new pi(e,t,n,i)}}class mr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ph{constructor(e,t){this.count=e,this.unchangedNames=t}}var wt,Be;function Jo(r){switch(r){default:return pe();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function kc(r){if(void 0===r)return vt("GRPC error has no .code"),z.UNKNOWN;switch(r){case wt.OK:return z.OK;case wt.CANCELLED:return z.CANCELLED;case wt.UNKNOWN:return z.UNKNOWN;case wt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case wt.INTERNAL:return z.INTERNAL;case wt.UNAVAILABLE:return z.UNAVAILABLE;case wt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case wt.NOT_FOUND:return z.NOT_FOUND;case wt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case wt.ABORTED:return z.ABORTED;case wt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case wt.DATA_LOSS:return z.DATA_LOSS;default:return pe()}}(Be=wt||(wt={}))[Be.OK=0]="OK",Be[Be.CANCELLED=1]="CANCELLED",Be[Be.UNKNOWN=2]="UNKNOWN",Be[Be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Be[Be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Be[Be.NOT_FOUND=5]="NOT_FOUND",Be[Be.ALREADY_EXISTS=6]="ALREADY_EXISTS",Be[Be.PERMISSION_DENIED=7]="PERMISSION_DENIED",Be[Be.UNAUTHENTICATED=16]="UNAUTHENTICATED",Be[Be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Be[Be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Be[Be.ABORTED=10]="ABORTED",Be[Be.OUT_OF_RANGE=11]="OUT_OF_RANGE",Be[Be.UNIMPLEMENTED=12]="UNIMPLEMENTED",Be[Be.INTERNAL=13]="INTERNAL",Be[Be.UNAVAILABLE=14]="UNAVAILABLE",Be[Be.DATA_LOSS=15]="DATA_LOSS";function Du(){return new TextEncoder}const Oc=new V([4294967295,4294967295],0);function ku(r){const e=Du().encode(r),t=new W;return t.update(e),new Uint8Array(t.digest())}function ea(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new V([t,n],0),new V([i,s],0)]}class Nc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new mi(`Invalid padding: ${t}`);if(n<0)throw new mi(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new mi(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new mi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=V.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(V.fromNumber(n)));return 1===i.compare(Oc)&&(i=new V([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=ku(e),[n,i]=ea(t);for(let s=0;s<this.hashCount;s++){const c=this.Ee(n,i,s);if(!this.de(c))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),c=new Nc(s,i,t);return n.forEach(f=>c.insert(f)),c}insert(e){if(0===this.Ie)return;const t=ku(e),[n,i]=ea(t);for(let s=0;s<this.hashCount;s++){const c=this.Ee(n,i,s);this.Ae(c)}}Ae(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class mi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gi{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Qs.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new gi(_e.min(),i,new it(Ce),en(),Re())}}class Qs{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Qs(n,t,Re(),Re(),Re())}}class zr{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class Ou{constructor(e,t){this.targetId=e,this.me=t}}class Nu{constructor(e,t,n=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class ta{constructor(){this.fe=0,this.ge=Vu(),this.pe=Tt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Re(),t=Re(),n=Re();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:pe()}}),new Qs(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=Vu()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Vc{constructor(e){this.Le=e,this.Be=new Map,this.ke=en(),this.qe=na(),this.Qe=new it(Ce)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:pe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const s=i.target;if(jo(s))if(0===n){const c=new ae(s.path);this.Ue(t,c,Ze.newNoDocument(c,_e.min()))}else ge(1===n);else{const c=this.Ye(t);if(c!==n){const f=this.Ze(e),p=f?this.Xe(f,e,c):1;0!==p&&(this.je(t),this.Qe=this.Qe.insert(t,2===p?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let c,f;try{c=zn(n).toUint8Array()}catch(p){if(p instanceof Ns)return on("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new Nc(c,i,s)}catch(p){return on(p instanceof mi?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return 0===f.Ie?null:f}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const c=this.Le.tt(),f=`projects/${c.projectId}/databases/${c.database}/documents/${s.path.canonicalString()}`;e.mightContain(f)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,c)=>{const f=this.Je(c);if(f){if(s.current&&jo(f.target)){const p=new ae(f.target.path);null!==this.ke.get(p)||this.it(c,p)||this.Ue(c,p,Ze.newNoDocument(p,e))}s.be&&(t.set(c,s.Ce()),s.ve())}});let n=Re();this.qe.forEach((s,c)=>{let f=!0;c.forEachWhile(p=>{const _=this.Je(p);return!_||"TargetPurposeLimboResolution"===_.purpose||(f=!1,!1)}),f&&(n=n.add(s))}),this.ke.forEach((s,c)=>c.setReadTime(e));const i=new gi(e,t,this.Qe,this.ke,n);return this.ke=en(),this.qe=na(),this.Qe=new it(Ce),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ta,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ze(Ce),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Z("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ta),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function na(){return new it(ae.comparator)}function Vu(){return new it(ae.comparator)}const Mc={asc:"ASCENDING",desc:"DESCENDING"},Mu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lu={and:"AND",or:"OR"};class xh{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lc(r,e){return r.useProto3Json||ai(e)?e:{value:e}}function jr(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fu(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Dh(r,e){return jr(r,e.toTimestamp())}function ft(r){return ge(!!r),_e.fromTimestamp(function(t){const n=Gn(t);return new rt(n.seconds,n.nanos)}(r))}function Fc(r,e){return Uc(r,e).canonicalString()}function Uc(r,e){const t=(i=r,new Oe(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===e?t:t.child(e)}function ra(r){const e=Oe.fromString(r);return ge(Hu(e)),e}function Ys(r,e){return Fc(r.databaseId,e.path)}function Nn(r,e){const t=ra(e);if(t.get(1)!==r.databaseId.projectId)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new ae(oa(t))}function Xs(r,e){return Fc(r.databaseId,e)}function ia(r){const e=ra(r);return 4===e.length?Oe.emptyPath():oa(e)}function sa(r){return new Oe(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function oa(r){return ge(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function Uu(r,e,t){return{name:Ys(r,e),fields:t.value.mapValue.fields}}function Bc(r,e,t){const n=Nn(r,e.name),i=ft(e.updateTime),s=e.createTime?ft(e.createTime):_e.min(),c=new Bt({mapValue:{fields:e.fields}}),f=Ze.newFoundDocument(n,i,s,c);return t&&f.setHasCommittedMutations(),t?f.setHasCommittedMutations():f}function Js(r,e){let t;if(e instanceof Zi)t={update:Uu(r,e.key,e.value)};else if(e instanceof Gr)t={delete:Ys(r,e.key)};else if(e instanceof jn)t={update:Uu(r,e.key,e.data),updateMask:Nh(e.fieldMask)};else{if(!(e instanceof Dc))return pe();t={verify:Ys(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,c){const f=c.transform;if(f instanceof Xi)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof hi)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nr)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Ji)return{fieldPath:c.field.canonicalString(),increment:f.Pe};throw pe()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Dh(r,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:pe()),t;var s}function aa(r,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?ht.updateTime(ft(s.updateTime)):void 0!==s.exists?ht.exists(s.exists):ht.none():ht.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(c,f){let p=null;"setToServerValue"in f?(ge("REQUEST_TIME"===f.setToServerValue),p=new Xi):"appendMissingElements"in f?p=new hi(f.appendMissingElements.values||[]):"removeAllFromArray"in f?p=new nr(f.removeAllFromArray.values||[]):"increment"in f?p=new Ji(c,f.increment):pe();const _=at.fromServerFormat(f.fieldPath);return new $s(_,p)}(r,i)):[];var s;if(e.update){const i=Nn(r,e.update.name),s=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=new Ht((e.updateMask.fieldPaths||[]).map(v=>at.fromServerFormat(v)));return new jn(i,s,c,t,n)}return new Zi(i,s,t,n)}if(e.delete){const i=Nn(r,e.delete);return new Gr(i,t)}if(e.verify){const i=Nn(r,e.verify);return new Dc(i,t)}return pe()}function zu(r,e){return{documents:[Xs(r,e.path)]}}function ca(r,e){const t={structuredQuery:{}},n=e.path;let i;null!==e.collectionGroup?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Xs(r,i);const s=function(_){if(0!==_.length)return Ku(He.create(_,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const c=function(_){if(0!==_.length)return _.map(v=>{return{field:qr((S=v).field),direction:$u(S.dir)};var S})}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=Lc(r,e.limit);return null!==f&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt={before:(_=e.startAt).inclusive,values:_.position}),e.endAt&&(t.structuredQuery.endAt=function(_){return{before:!_.inclusive,values:_.position}}(e.endAt)),{_t:t,parent:i};var _}function la(r){let e=ia(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ge(1===n);const v=t.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let s=[];t.where&&(s=function(T){const S=qu(T);return S instanceof He&&mu(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=t.orderBy.map(S=>{return new Ls(es((Q=S).field),function(X){switch(X){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Q.direction));var Q}));let f=null;t.limit&&(f=function(T){let S;return S="object"==typeof T?T.value:T,ai(S)?null:S}(t.limit));let p=null;var T;t.startAt&&(p=new Fr((T=t.startAt).values||[],!!T.before));let _=null;return t.endAt&&(_=function(T){return new Fr(T.values||[],!T.before)}(t.endAt)),Ac(e,i,c,s,f,"F",p,_)}function qu(r){return void 0!==r.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=es(t.unaryFilter.field);return Le.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=es(t.unaryFilter.field);return Le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=es(t.unaryFilter.field);return Le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=es(t.unaryFilter.field);return Le.create(c,"!=",{nullValue:"NULL_VALUE"});default:return pe()}}(r):void 0!==r.fieldFilter?Le.create(es((t=r).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return pe()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==r.compositeFilter?function(t){return He.create(t.compositeFilter.filters.map(n=>qu(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return pe()}}(t.compositeFilter.op))}(r):pe();var t}function $u(r){return Mc[r]}function Oh(r){return Mu[r]}function ua(r){return Lu[r]}function qr(r){return{fieldPath:r.canonicalString()}}function es(r){return at.fromServerFormat(r.fieldPath)}function Ku(r){return r instanceof Le?function(t){if("=="===t.op){if(Uo(t.value))return{unaryFilter:{field:qr(t.field),op:"IS_NAN"}};if(uu(t.value))return{unaryFilter:{field:qr(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Uo(t.value))return{unaryFilter:{field:qr(t.field),op:"IS_NOT_NAN"}};if(uu(t.value))return{unaryFilter:{field:qr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qr(t.field),op:Oh(t.op),value:t.value}}}(r):r instanceof He?function(t){const n=t.getFilters().map(i=>Ku(i));return 1===n.length?n[0]:{compositeFilter:{op:ua(t.op),filters:n}}}(r):pe()}function Nh(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Hu(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class gr{constructor(e,t,n,i,s=_e.min(),c=_e.min(),f=Tt.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new gr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Wu{constructor(e){this.ct=e}}function da(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ha(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document={name:Ys(s=r.ct,(c=e).key),fields:c.data.value.mapValue.fields,updateTime:jr(s,c.version.toTimestamp()),createTime:jr(s,c.createTime.toTimestamp())};else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:_i(e.version)};else{if(!e.isUnknownDocument())return pe();n.unknownDocument={path:t.path.toArray(),version:_i(e.version)}}var s,c;return n}function ha(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function _i(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function yi(r){const e=new rt(r.seconds,r.nanoseconds);return _e.fromTimestamp(e)}function vi(r,e){const t=(e.baseMutations||[]).map(s=>aa(r.ct,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const n=e.mutations.map(s=>aa(r.ct,s)),i=rt.fromMillis(e.localWriteTimeMs);return new Ws(e.batchId,i,t,n)}function Zs(r){const e=yi(r.readTime),t=void 0!==r.lastLimboFreeSnapshotVersion?yi(r.lastLimboFreeSnapshotVersion):_e.min();let n;return n=void 0!==r.query.documents?(ge(1===(s=r.query).documents.length),xt(Qi(ia(s.documents[0])))):function(s){return xt(la(s))}(r.query),new gr(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Tt.fromBase64String(r.resumeToken));var s}function zc(r,e){const t=_i(e.snapshotVersion),n=_i(e.lastLimboFreeSnapshotVersion);let i;i=jo(e.target)?zu(r.ct,e.target):ca(r.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function jc(r){const e=la({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?$o(e,e.limit,"L"):e}function qc(r,e){return new mr(e.largestBatchId,aa(r.ct,e.overlayMutation))}function Qu(r,e){const t=e.path.lastSegment();return[r,It(e.path.popLast()),t]}function Yu(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:_i(n.readTime),documentKey:It(n.documentKey.path),largestBatchId:n.largestBatchId}}class Mh{getBundleMetadata(e,t){return fa(e).get(t).next(n=>{if(n)return{id:(s=n).bundleId,createTime:yi(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return fa(e).put({bundleId:(i=t).id,createTime:_i(ft(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return pa(e).get(t).next(n=>{if(n)return{name:(s=n).name,query:jc(s.bundledQuery),readTime:yi(s.readTime)};var s})}saveNamedQuery(e,t){return pa(e).put({name:(i=t).name,readTime:_i(ft(i.readTime)),bundledQuery:i.bundledQuery});var i}}function fa(r){return bt(r,"bundles")}function pa(r){return bt(r,"namedQueries")}class ma{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){return new ma(e,t.uid||"")}getOverlay(e,t){return Ii(e).get(Qu(this.userId,t)).next(n=>n?qc(this.serializer,n):null)}getOverlays(e,t){const n=an();return U.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,c)=>{const f=new mr(t,c);i.push(this.ht(e,f))}),U.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(c=>i.add(It(c.getCollectionPath())));const s=[];return i.forEach(c=>{const f=IDBKeyRange.bound([this.userId,c,n],[this.userId,c,n+1],!1,!0);s.push(Ii(e).j("collectionPathOverlayIndex",f))}),U.waitFor(s)}getOverlaysForCollection(e,t,n){const i=an(),s=It(t),c=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ii(e).U("collectionPathOverlayIndex",c).next(f=>{for(const p of f){const _=qc(this.serializer,p);i.set(_.getKey(),_)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=an();let c;const f=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ii(e).J({index:"collectionGroupOverlayIndex",range:f},(p,_,v)=>{const T=qc(this.serializer,_);s.size()<i||T.largestBatchId===c?(s.set(T.getKey(),T),c=T.largestBatchId):v.done()}).next(()=>s)}ht(e,t){return Ii(e).put(function(i,s,c){const[f,p,_]=Qu(s,c.mutation.key);return{userId:s,collectionPath:p,documentId:_,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Js(i.ct,c.mutation)}}(this.serializer,this.userId,t))}}function Ii(r){return bt(r,"documentOverlays")}class Ti{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(_t(e.integerValue));else if("doubleValue"in e){const n=_t(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),In(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),"string"==typeof n&&(n=Gn(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(zn(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?du(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):pe()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const i of Object.keys(n))this.Rt(i,t),this.It(n[i],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const i of n)this.It(i,t)}gt(e,t){this.Et(t,37),ae.fromName(e).path.forEach(n=>{this.Et(t,60),this.St(n,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function Xu(r){if(0===r)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function $c(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const c=Xu(255&n[s]);if(i+=c,8!==c)break}return i}(r);return Math.ceil(e/8)}Ti.bt=new Ti;class Kc{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ct(n);else if(n<2048)this.Ct(960|n>>>6),this.Ct(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|n>>>12),this.Ct(128|63&n>>>6),this.Ct(128|63&n);else{const i=t.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Mt(n);else if(n<2048)this.Mt(960|n>>>6),this.Mt(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|n>>>12),this.Mt(128|63&n>>>6),this.Mt(128|63&n);else{const i=t.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){const t=this.Bt(e),n=$c(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}qt(e){const t=this.Bt(e),n=$c(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,s,!1),new Uint8Array(c.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class Lh{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class am{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class Ei{constructor(){this.Gt=new Kc,this.zt=new Lh(this.Gt),this.jt=new am(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class $r{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new $r(this.indexId,this.documentKey,this.arrayValue,n)}}function qn(r,e){let t=r.indexId-e.indexId;return 0!==t?t:(t=Hc(r.arrayValue,e.arrayValue),0!==t?t:(t=Hc(r.directionalValue,e.directionalValue),0!==t?t:ae.comparator(r.documentKey,e.documentKey)))}function Hc(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(0!==n)return n}return r.length-e.length}class Wc{constructor(e){this.Yt=new ze((t,n)=>at.comparator(t.field,n.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const n=t;n.isInequality()?this.Yt=this.Yt.add(n):this.Xt.push(n)}}get en(){return this.Yt.size>1}tn(e){if(ge(e.collectionGroup===this.collectionId),this.en)return!1;const t=Ds(e);if(void 0!==t&&!this.nn(t))return!1;const n=ri(e);let i=new Set,s=0,c=0;for(;s<n.length&&this.nn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Yt.size>0){const f=this.Yt.getIterator().getNext();if(!i.has(f.field.canonicalString())){const p=n[s];if(!this.rn(f,p)||!this.sn(this.Zt[c++],p))return!1}++s}for(;s<n.length;++s)if(c>=this.Zt.length||!this.sn(this.Zt[c++],n[s]))return!1;return!0}on(){if(this.en)return null;let e=new ze(at.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new ii(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new ii(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new ii(n.field,"asc"===n.dir?0:1)));return new Fi(Fi.UNKNOWN_ID,this.collectionId,t,Ui.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Ju(r){var e,t;if(ge(r instanceof Le||r instanceof He),r instanceof Le){if(r instanceof Ur){const i=(null===(t=null===(e=r.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Le.create(r.field,"==",s)))||[];return He.create(i,"or")}return r}const n=r.filters.map(i=>Ju(i));return He.create(n,r.op)}function Fh(r){if(0===r.getFilters().length)return[];const e=ga(Ju(r));return ge(Zu(e)),Qc(e)||Yc(e)?[e]:e.getFilters()}function Qc(r){return r instanceof Le}function Yc(r){return r instanceof He&&mu(r)}function Zu(r){return Qc(r)||Yc(r)||function(t){if(t instanceof He&&pu(t)){for(const n of t.getFilters())if(!Qc(n)&&!Yc(n))return!1;return!0}return!1}(r)}function ga(r){if(ge(r instanceof Le||r instanceof He),r instanceof Le)return r;if(1===r.filters.length)return ga(r.filters[0]);const e=r.filters.map(n=>ga(n));let t=He.create(e,r.op);return t=_a(t),Zu(t)?t:(ge(t instanceof He),ge(Fs(t)),ge(t.filters.length>1),t.filters.reduce((n,i)=>Xc(n,i)))}function Xc(r,e){let t;return ge(r instanceof Le||r instanceof He),ge(e instanceof Le||e instanceof He),t=r instanceof Le?e instanceof Le?He.create([r,e],"and"):Uh(r,e):e instanceof Le?Uh(e,r):function(i,s){if(ge(i.filters.length>0&&s.filters.length>0),Fs(i)&&Fs(s))return gh(i,s.getFilters());const c=pu(i)?i:s,f=pu(i)?s:i,p=c.filters.map(_=>Xc(_,f));return He.create(p,"or")}(r,e),_a(t)}function Uh(r,e){if(Fs(e))return gh(e,r.getFilters());{const t=e.filters.map(n=>Xc(r,n));return He.create(t,"or")}}function _a(r){if(ge(r instanceof Le||r instanceof He),r instanceof Le)return r;const e=r.getFilters();if(1===e.length)return _a(e[0]);if(zo(r))return r;const t=e.map(i=>_a(i)),n=[];return t.forEach(i=>{i instanceof Le?n.push(i):i instanceof He&&(i.op===r.op?n.push(...i.filters):n.push(i))}),1===n.length?n[0]:He.create(n,r.op)}class Ai{constructor(){this._n=new Jc}addToCollectionParentIndex(e,t){return this._n.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(Zt.min())}updateCollectionGroup(e,t,n){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class Jc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ze(Oe.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ze(Oe.comparator)).toArray()}}const ya=new Uint8Array(0);class Zc{constructor(e,t){this.databaseId=t,this.an=new Jc,this.un=new pr(n=>Hi(n),(n,i)=>Us(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});const s={collectionId:n,parent:It(i)};return ed(e).put(s)}return U.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Zl(t),""],!1,!0);return ed(e).U(i).next(s=>{for(const c of s){if(c.collectionId!==t)break;n.push(Bn(c.parent))}return n})}addFieldIndex(e,t){const n=eo(e),i={indexId:(f=t).indexId,collectionGroup:f.collectionGroup,fields:f.fields.map(p=>[p.fieldPath.canonicalString(),p.kind])};var f;delete i.indexId;const s=n.add(i);if(t.indexState){const c=ts(e);return s.next(f=>{c.put(Yu(f,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=eo(e),i=ts(e),s=Kr(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=eo(e),n=Kr(e),i=ts(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return U.forEach(this.cn(t),n=>this.getIndexType(e,n).next(i=>{if(0===i||1===i){const s=new Wc(n).on();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=Kr(e);let i=!0;const s=new Map;return U.forEach(this.cn(t),c=>this.ln(e,c).next(f=>{i&&(i=!!f),s.set(c,f)})).next(()=>{if(i){let c=Re();const f=[];return U.forEach(s,(p,_)=>{var oe;Z("IndexedDbIndexManager",`Using index ${oe=p,`id=${oe.indexId}|cg=${oe.collectionGroup}|f=${oe.fields.map(Ie=>`${Ie.fieldPath}:${Ie.kind}`).join(",")}`} to execute ${Hi(t)}`);const v=function(oe,Ie){const Pe=Ds(Ie);if(void 0===Pe)return null;for(const ke of Wi(oe,Pe.fieldPath))switch(ke.op){case"array-contains-any":return ke.value.arrayValue.values||[];case"array-contains":return[ke.value]}return null}(_,p),T=function(oe,Ie){const Pe=new Map;for(const ke of ri(Ie))for(const k of Wi(oe,ke.fieldPath))switch(k.op){case"==":case"in":Pe.set(ke.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return Pe.set(ke.fieldPath.canonicalString(),k.value),Array.from(Pe.values())}return null}(_,p),S=function(oe,Ie){const Pe=[];let ke=!0;for(const k of ri(Ie)){const w=0===k.kind?qo(oe,k.fieldPath,oe.startAt):_u(oe,k.fieldPath,oe.startAt);Pe.push(w.value),ke&&(ke=w.inclusive)}return new Fr(Pe,ke)}(_,p),L=function(oe,Ie){const Pe=[];let ke=!0;for(const k of ri(Ie)){const w=0===k.kind?_u(oe,k.fieldPath,oe.endAt):qo(oe,k.fieldPath,oe.endAt);Pe.push(w.value),ke&&(ke=w.inclusive)}return new Fr(Pe,ke)}(_,p),Q=this.hn(p,_,S),ne=this.hn(p,_,L),X=this.Pn(p,_,T),me=this.In(p.indexId,v,Q,S.inclusive,ne,L.inclusive,X);return U.forEach(me,ye=>n.G(ye,t.limit).next(oe=>{oe.forEach(Ie=>{const Pe=ae.fromSegments(Ie.documentKey);c.has(Pe)||(c=c.add(Pe),f.push(Pe))})}))}).next(()=>f)}return U.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Fh(He.create(e.filters,"and")).map(n=>Ec(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,n,i,s,c,f){const p=(null!=t?t.length:1)*Math.max(n.length,s.length),_=p/(null!=t?t.length:1),v=[];for(let T=0;T<p;++T){const S=t?this.Tn(t[T/_]):ya,L=this.En(e,S,n[T%_],i),Q=this.dn(e,S,s[T%_],c),ne=f.map(X=>this.En(e,S,X,!0));v.push(...this.createRange(L,Q,ne))}return v}En(e,t,n,i){const s=new $r(e,ae.empty(),t,n);return i?s:s.Jt()}dn(e,t,n,i){const s=new $r(e,ae.empty(),t,n);return i?s.Jt():s}ln(e,t){const n=new Wc(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let c=null;for(const f of s)n.tn(f)&&(!c||f.fields.length>c.fields.length)&&(c=f);return c})}getIndexType(e,t){let n=2;const i=this.cn(t);return U.forEach(i,s=>this.ln(e,s).next(c=>{c?0!==n&&c.fields.length<function(p){let _=new ze(at.comparator),v=!1;for(const T of p.filters)for(const S of T.getFlattenedFilters())S.field.isKeyField()||("array-contains"===S.op||"array-contains-any"===S.op?v=!0:_=_.add(S.field));for(const T of p.orderBy)T.field.isKeyField()||(_=_.add(T.field));return _.size+(v?1:0)}(s)&&(n=1):n=0})).next(()=>null!==t.limit&&i.length>1&&2===n?1:n)}An(e,t){const n=new Ei;for(const i of ri(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const c=n.Ht(i.kind);Ti.bt.Pt(s,c)}return n.Wt()}Tn(e){const t=new Ei;return Ti.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new Ei;return Ti.bt.Pt(dr(this.databaseId,t),n.Ht(function(s){const c=ri(s);return 0===c.length?0:c[c.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let i=[];i.push(new Ei);let s=0;for(const c of ri(e)){const f=n[s++];for(const p of i)if(this.Vn(t,c.fieldPath)&&li(f))i=this.mn(i,c,f);else{const _=p.Ht(c.kind);Ti.bt.Pt(f,_)}}return this.fn(i)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const i=[...e],s=[];for(const c of n.arrayValue.values||[])for(const f of i){const p=new Ei;p.seed(f.Wt()),Ti.bt.Pt(c,p.Ht(t.kind)),s.push(p)}return s}Vn(e,t){return!!e.filters.find(n=>n instanceof Le&&n.field.isEqual(t)&&("in"===n.op||"not-in"===n.op))}getFieldIndexes(e,t){const n=eo(e),i=ts(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{const c=[];return U.forEach(s,f=>i.get([f.indexId,this.uid]).next(p=>{c.push(function(v,T){const S=T?new Ui(T.sequenceNumber,new Zt(yi(T.readTime),new ae(Bn(T.documentKey)),T.largestBatchId)):Ui.empty(),L=v.fields.map(([Q,ne])=>new ii(at.fromServerFormat(Q),ne));return new Fi(v.indexId,v.collectionGroup,L,S)}(f,p))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ce(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=eo(e),s=ts(e);return this.gn(e).next(c=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(f=>U.forEach(f,p=>s.put(Yu(p.indexId,this.uid,c,n)))))}updateIndexEntries(e,t){const n=new Map;return U.forEach(t,(i,s)=>{const c=n.get(i.collectionGroup);return(c?U.resolve(c):this.getFieldIndexes(e,i.collectionGroup)).next(f=>(n.set(i.collectionGroup,f),U.forEach(f,p=>this.pn(e,i,p).next(_=>{const v=this.yn(s,p);return _.isEqual(v)?U.resolve():this.wn(e,s,p,_,v)}))))})}Sn(e,t,n,i){return Kr(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,i){return Kr(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const i=Kr(e);let s=new ze(qn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},(c,f)=>{s=s.add(new $r(n.indexId,t,f.arrayValue,f.directionalValue))}).next(()=>s)}yn(e,t){let n=new ze(qn);const i=this.An(t,e);if(null==i)return n;const s=Ds(t);if(null!=s){const c=e.data.field(s.fieldPath);if(li(c))for(const f of c.arrayValue.values||[])n=n.add(new $r(t.indexId,e.key,this.Tn(f),i))}else n=n.add(new $r(t.indexId,e.key,ya,i));return n}wn(e,t,n,i,s){Z("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return function(p,_,v,T,S){const L=p.getIterator(),Q=_.getIterator();let ne=Mr(L),X=Mr(Q);for(;ne||X;){let me=!1,ye=!1;if(ne&&X){const oe=v(ne,X);oe<0?ye=!0:oe>0&&(me=!0)}else null!=ne?ye=!0:me=!0;me?(T(X),X=Mr(Q)):ye?(S(ne),ne=Mr(L)):(ne=Mr(L),X=Mr(Q))}}(i,s,qn,f=>{c.push(this.Sn(e,t,n,f))},f=>{c.push(this.bn(e,t,n,f))}),U.waitFor(c)}gn(e){let t=1;return ts(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((c,f)=>qn(c,f)).filter((c,f,p)=>!f||0!==qn(c,p[f-1]));const i=[];i.push(e);for(const c of n){const f=qn(c,e),p=qn(c,t);if(0===f)i[0]=e.Jt();else if(f>0&&p<0)i.push(c),i.push(c.Jt());else if(p>0)break}i.push(t);const s=[];for(let c=0;c<i.length;c+=2){if(this.Dn(i[c],i[c+1]))return[];s.push(IDBKeyRange.bound([i[c].indexId,this.uid,i[c].arrayValue,i[c].directionalValue,ya,[]],[i[c+1].indexId,this.uid,i[c+1].arrayValue,i[c+1].directionalValue,ya,[]]))}return s}Dn(e,t){return qn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(va)}getMinOffset(e,t){return U.mapArray(this.cn(t),n=>this.ln(e,n).next(i=>i||pe())).next(va)}}function ed(r){return bt(r,"collectionParents")}function Kr(r){return bt(r,"indexEntries")}function eo(r){return bt(r,"indexConfiguration")}function ts(r){return bt(r,"indexState")}function va(r){ge(0!==r.length);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;si(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zt(e.readTime,e.documentKey,t)}const td={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Wt{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Wt(e,Wt.DEFAULT_COLLECTION_PERCENTILE,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Ia(r,e,t){const n=r.store("mutations"),i=r.store("documentMutations"),s=[],c=IDBKeyRange.only(t.batchId);let f=0;const p=n.J({range:c},(v,T,S)=>(f++,S.delete()));s.push(p.next(()=>{ge(1===f)}));const _=[];for(const v of t.mutations){const T=ru(e,v.key.path,t.batchId);s.push(i.delete(T)),_.push(v.key)}return U.waitFor(s).next(()=>_)}function Ta(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw pe();e=r.noDocument}return JSON.stringify(e).length}Wt.DEFAULT_COLLECTION_PERCENTILE=10,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wt.DEFAULT=new Wt(41943040,Wt.DEFAULT_COLLECTION_PERCENTILE,Wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wt.DISABLED=new Wt(-1,0,0);class Ea{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Cn={}}static lt(e,t,n,i){ge(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Ea(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).J({index:"userMutationsIndex",range:n},(i,s,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=ns(e),c=Hr(e);return c.add({}).next(f=>{ge("number"==typeof f);const p=new Ws(f,t,n,i),_=function(L,Q,ne){const X=ne.baseMutations.map(ye=>Js(L.ct,ye)),me=ne.mutations.map(ye=>Js(L.ct,ye));return{userId:Q,batchId:ne.batchId,localWriteTimeMs:ne.localWriteTime.toMillis(),baseMutations:X,mutations:me}}(this.serializer,this.userId,p),v=[];let T=new ze((S,L)=>Ce(S.canonicalString(),L.canonicalString()));for(const S of i){const L=ru(this.userId,S.key.path,f);T=T.add(S.key.path.popLast()),v.push(c.put(_)),v.push(s.put(L,ko))}return T.forEach(S=>{v.push(this.indexManager.addToCollectionParentIndex(e,S))}),e.addOnCommittedListener(()=>{this.Cn[f]=p.keys()}),U.waitFor(v).next(()=>p)})}lookupMutationBatch(e,t){return Hr(e).get(t).next(n=>n?(ge(n.userId===this.userId),vi(this.serializer,n)):null)}vn(e,t){return this.Cn[t]?U.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.Cn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Hr(e).J({index:"userMutationsIndex",range:i},(c,f,p)=>{f.userId===this.userId&&(ge(f.batchId>=n),s=vi(this.serializer,f)),p.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Hr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,c)=>{n=s.batchId,c.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).U("userMutationsIndex",t).next(n=>n.map(i=>vi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ur(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return ns(e).J({range:i},(c,f,p)=>{const[_,v,T]=c,S=Bn(v);if(_===this.userId&&t.path.isEqual(S))return Hr(e).get(T).next(L=>{if(!L)throw pe();ge(L.userId===this.userId),s.push(vi(this.serializer,L))});p.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ze(Ce);const i=[];return t.forEach(s=>{const c=ur(this.userId,s.path),f=IDBKeyRange.lowerBound(c),p=ns(e).J({range:f},(_,v,T)=>{const[S,L,Q]=_,ne=Bn(L);S===this.userId&&s.path.isEqual(ne)?n=n.add(Q):T.done()});i.push(p)}),U.waitFor(i).next(()=>this.Fn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=ur(this.userId,n),c=IDBKeyRange.lowerBound(s);let f=new ze(Ce);return ns(e).J({range:c},(p,_,v)=>{const[T,S,L]=p,Q=Bn(S);T===this.userId&&n.isPrefixOf(Q)?Q.length===i&&(f=f.add(L)):v.done()}).next(()=>this.Fn(e,f))}Fn(e,t){const n=[],i=[];return t.forEach(s=>{i.push(Hr(e).get(s).next(c=>{if(null===c)throw pe();ge(c.userId===this.userId),n.push(vi(this.serializer,c))}))}),U.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return Ia(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),U.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return U.resolve();const n=IDBKeyRange.lowerBound(function(c){return[c]}(this.userId)),i=[];return ns(e).J({range:n},(s,c,f)=>{if(s[0]===this.userId){const p=Bn(s[1]);i.push(p)}else f.done()}).next(()=>{ge(0===i.length)})})}containsKey(e,t){return nd(e,this.userId,t)}xn(e){return el(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function nd(r,e,t){const n=ur(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let c=!1;return ns(r).J({range:s,H:!0},(f,p,_)=>{const[v,T,S]=f;v===e&&T===i&&(c=!0),_.done()}).next(()=>c)}function Hr(r){return bt(r,"mutations")}function ns(r){return bt(r,"documentMutations")}function el(r){return bt(r,"mutationQueues")}class _r{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new _r(0)}static Ln(){return new _r(-1)}}class Bh{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const n=new _r(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>_e.fromTimestamp(new rt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.kn(e,i)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>rs(e).delete(t.targetId)).next(()=>this.Bn(e)).next(n=>(ge(n.targetCount>0),n.targetCount-=1,this.kn(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return rs(e).J((c,f)=>{const p=Zs(f);p.sequenceNumber<=t&&null===n.get(p.targetId)&&(i++,s.push(this.removeTargetData(e,p)))}).next(()=>U.waitFor(s)).next(()=>i)}forEachTarget(e,t){return rs(e).J((n,i)=>{const s=Zs(i);t(s)})}Bn(e){return Aa(e).get("targetGlobalKey").next(t=>(ge(null!==t),t))}kn(e,t){return Aa(e).put("targetGlobalKey",t)}qn(e,t){return rs(e).put(zc(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=Hi(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return rs(e).J({range:i,index:"queryTargetsIndex"},(c,f,p)=>{const _=Zs(f);Us(t,_.target)&&(s=_,p.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=rr(e);return t.forEach(c=>{const f=It(c.path);i.push(s.put({targetId:n,path:f})),i.push(this.referenceDelegate.addReference(e,n,c))}),U.waitFor(i)}removeMatchingKeys(e,t,n){const i=rr(e);return U.forEach(t,s=>{const c=It(s.path);return U.waitFor([i.delete([n,c]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=rr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=rr(e);let s=Re();return i.J({range:n,H:!0},(c,f,p)=>{const _=Bn(c[1]),v=new ae(_);s=s.add(v)}).next(()=>s)}containsKey(e,t){const n=It(t.path),i=IDBKeyRange.bound([n],[Zl(n)],!1,!0);let s=0;return rr(e).J({index:"documentTargetsIndex",H:!0,range:i},([c,f],p,_)=>{0!==c&&(s++,_.done())}).next(()=>s>0)}ot(e,t){return rs(e).get(t).next(n=>n?Zs(n):null)}}function rs(r){return bt(r,"targets")}function Aa(r){return bt(r,"targetGlobal")}function rr(r){return bt(r,"targetDocuments")}function rd([r,e],[t,n]){const i=Ce(r,t);return 0===i?Ce(e,n):i}class Gh{constructor(e){this.Kn=e,this.buffer=new ze(rd),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();rd(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class to{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){var t=this;Z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,H.A)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(n){Nr(n)?Z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Or(n)}yield t.zn(3e5)}))}}class zh{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(0===t)return U.resolve(Dn.oe);const n=new Gh(t);return this.jn.forEachTarget(e,i=>n.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>n.Wn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(td)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),td):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,i,s,c,f,p,_;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,c=Date.now(),this.nthSequenceNumber(e,i))).next(T=>(n=T,f=Date.now(),this.removeTargets(e,n,t))).next(T=>(s=T,p=Date.now(),this.removeOrphanedDocuments(e,n))).next(T=>(_=Date.now(),Li()<=vn.$b.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${c-v}ms\n\tDetermined least recently used ${i} in `+(f-c)+`ms\n\tRemoved ${s} targets in `+(p-f)+`ms\n\tRemoved ${T} documents in `+(_-p)+`ms\nTotal Duration: ${_-v}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:T})))}}class jh{constructor(e,t){this.db=e,this.garbageCollector=function id(r,e){return new zh(r,e)}(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}Zn(e){let t=0;return this.Jn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(n,i)=>t(i))}addReference(e,t,n){return no(e,n)}removeReference(e,t,n){return no(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return no(e,t)}er(e,t){return function(i,s){let c=!1;return el(i).Y(f=>nd(i,f,s).next(p=>(p&&(c=!0),U.resolve(!p)))).next(()=>c)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Xn(e,(c,f)=>{if(f<=t){const p=this.er(e,c).next(_=>{if(!_)return s++,n.getEntry(e,c).next(()=>(n.removeEntry(c,_e.min()),rr(e).delete([0,It(c.path)])))});i.push(p)}}).next(()=>U.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return no(e,t)}Xn(e,t){const n=rr(e);let i,s=Dn.oe;return n.J({index:"documentTargetsIndex"},([c,f],{path:p,sequenceNumber:_})=>{0===c?(s!==Dn.oe&&t(new ae(Bn(i)),s),s=_,i=p):s=Dn.oe}).next(()=>{s!==Dn.oe&&t(new ae(Bn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function no(r,e){return rr(r).put((i=r.currentSequenceNumber,{targetId:0,path:It(e.path),sequenceNumber:i}));var i}class sd{constructor(){this.changes=new pr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ze.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?U.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qh{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return bi(e).put(n)}removeEntry(e,t,n){return bi(e).delete(function(s,c){const f=s.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],ha(c),f[f.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.tr(e,n)))}getEntry(e,t){let n=Ze.newInvalidDocument(t);return bi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ss(t))},(i,s)=>{n=this.nr(t,s)}).next(()=>n)}rr(e,t){let n={size:0,document:Ze.newInvalidDocument(t)};return bi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ss(t))},(i,s)=>{n={document:this.nr(t,s),size:Ta(s)}}).next(()=>n)}getEntries(e,t){let n=en();return this.ir(e,t,(i,s)=>{const c=this.nr(i,s);n=n.insert(i,c)}).next(()=>n)}sr(e,t){let n=en(),i=new it(ae.comparator);return this.ir(e,t,(s,c)=>{const f=this.nr(s,c);n=n.insert(s,f),i=i.insert(s,Ta(c))}).next(()=>({documents:n,_r:i}))}ir(e,t,n){if(t.isEmpty())return U.resolve();let i=new ze(cd);t.forEach(p=>i=i.add(p));const s=IDBKeyRange.bound(ss(i.first()),ss(i.last())),c=i.getIterator();let f=c.getNext();return bi(e).J({index:"documentKeyIndex",range:s},(p,_,v)=>{const T=ae.fromSegments([..._.prefixPath,_.collectionGroup,_.documentId]);for(;f&&cd(f,T)<0;)n(f,null),f=c.getNext();f&&f.isEqual(T)&&(n(f,_),f=c.hasNext()?c.getNext():null),f?v.$(ss(f)):v.done()}).next(()=>{for(;f;)n(f,null),f=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const c=t.path,f=[c.popLast().toArray(),c.lastSegment(),ha(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],p=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return bi(e).U(IDBKeyRange.bound(f,p,!0)).next(_=>{s?.incrementDocumentReadCount(_.length);let v=en();for(const T of _){const S=this.nr(ae.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);S.isFoundDocument()&&(Gs(t,S)||i.has(S.key))&&(v=v.insert(S.key,S))}return v})}getAllFromCollectionGroup(e,t,n,i){let s=en();const c=ad(t,n),f=ad(t,Zt.max());return bi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,f,!0)},(p,_,v)=>{const T=this.nr(ae.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);s=s.insert(T.key,T),s.size===i&&v.done()}).next(()=>s)}newChangeBuffer(e){return new $h(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return is(e).get("remoteDocumentGlobalKey").next(t=>(ge(!!t),t))}tr(e,t){return is(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const n=function Vh(r,e){let t;if(e.document)t=Bc(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=ae.fromSegments(e.noDocument.path),i=yi(e.noDocument.readTime);t=Ze.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return pe();{const n=ae.fromSegments(e.unknownDocument.path),i=yi(e.unknownDocument.version);t=Ze.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new rt(i[0],i[1]);return _e.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(_e.min()))return n}return Ze.newInvalidDocument(e)}}function od(r){return new qh(r)}class $h extends sd{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new pr(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new ze((s,c)=>Ce(s.canonicalString(),c.canonicalString()));return this.changes.forEach((s,c)=>{const f=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,f.readTime)),c.isValidDocument()){const p=da(this.ar.serializer,c);i=i.add(s.path.popLast());const _=Ta(p);n+=_-f.size,t.push(this.ar.addEntry(e,s,p))}else if(n-=f.size,this.trackRemovals){const p=da(this.ar.serializer,c.convertToNoDocument(_e.min()));t.push(this.ar.addEntry(e,s,p))}}),i.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,n)),U.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(n=>(this.ur.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:n,_r:i})=>(i.forEach((s,c)=>{this.ur.set(s,{size:c,readTime:n.get(s).readTime})}),n))}}function is(r){return bt(r,"remoteDocumentGlobal")}function bi(r){return bt(r,"remoteDocumentsV14")}function ss(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ad(r,e){const t=e.documentKey.path.toArray();return[r,ha(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function cd(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Ce(t[s],n[s]),i)return i;return i=Ce(t.length,n.length),i||(i=Ce(t[t.length-2],n[n.length-2]),i||Ce(t[t.length-1],n[n.length-1]))}class Kh{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ld{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&fi(n.mutation,i,Ht.empty(),rt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Re()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Re()){const i=an();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let c=Br();return s.forEach((f,p)=>{c=c.insert(f,p.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const n=an();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Re()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((c,f)=>{t.set(c,f)})})}computeViews(e,t,n,i){let s=en();const c=js(),f=js();return t.forEach((p,_)=>{const v=n.get(_.key);i.has(_.key)&&(void 0===v||v.mutation instanceof jn)?s=s.insert(_.key,_):void 0!==v?(c.set(_.key,v.mutation.getFieldMask()),fi(v.mutation,_,v.mutation.getFieldMask(),rt.now())):c.set(_.key,Ht.empty())}),this.recalculateAndSaveOverlays(e,s).next(p=>(p.forEach((_,v)=>c.set(_,v)),t.forEach((_,v)=>{var T;return f.set(_,new Kh(v,null!==(T=c.get(_))&&void 0!==T?T:null))}),f))}recalculateAndSaveOverlays(e,t){const n=js();let i=new it((c,f)=>c-f),s=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const f of c)f.keys().forEach(p=>{const _=t.get(p);if(null===_)return;let v=n.get(p)||Ht.empty();v=f.applyToLocalView(_,v),n.set(p,v);const T=(i.get(f.batchId)||Re()).add(p);i=i.insert(f.batchId,T)})}).next(()=>{const c=[],f=i.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),_=p.key,v=p.value,T=zs();v.forEach(S=>{if(!s.has(S)){const L=Pu(t.get(S),n.get(S));null!==L&&T.set(S,L),s=s.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,_,T))}return U.waitFor(c)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return ae.isDocumentKey((c=t).path)&&null===c.collectionGroup&&0===c.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):bc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i);var c}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const c=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):U.resolve(an());let f=-1,p=s;return c.next(_=>U.forEach(_,(v,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),s.get(v)?U.resolve():this.remoteDocumentCache.getEntry(e,v).next(S=>{p=p.insert(v,S)}))).next(()=>this.populateOverlays(e,_,s)).next(()=>this.computeViews(e,p,_,Re())).next(v=>({batchId:f,changes:Sc(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ae(t)).next(n=>{let i=Br();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let c=Br();return this.indexManager.getCollectionParents(e,s).next(f=>U.forEach(f,p=>{const _=(T=t,S=p.child(s),new On(S,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt));var T,S;return this.getDocumentsMatchingCollectionQuery(e,_,n,i).next(v=>{v.forEach((T,S)=>{c=c.insert(T,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(c=>(s=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(c=>{s.forEach((p,_)=>{const v=_.getKey();null===c.get(v)&&(c=c.insert(v,Ze.newInvalidDocument(v)))});let f=Br();return c.forEach((p,_)=>{const v=s.get(p);void 0!==v&&fi(v.mutation,_,Ht.empty(),rt.now()),Gs(t,_)&&(f=f.insert(p,_))}),f})}}class ud{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return U.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,{id:(i=t).id,version:i.version,createTime:ft(i.createTime)}),U.resolve();var i}getNamedQuery(e,t){return U.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,{name:(i=t).name,query:jc(i.bundledQuery),readTime:ft(i.readTime)}),U.resolve();var i}}class tl{constructor(){this.overlays=new it(ae.comparator),this.hr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const n=an();return U.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),U.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(n)),U.resolve()}getOverlaysForCollection(e,t,n){const i=an(),s=t.length+1,c=new ae(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const p=f.getNext().value,_=p.getKey();if(!t.isPrefixOf(_.path))break;_.path.length===s&&p.largestBatchId>n&&i.set(p.getKey(),p)}return U.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new it((_,v)=>_-v);const c=this.overlays.getIterator();for(;c.hasNext();){const _=c.getNext().value;if(_.getKey().getCollectionGroup()===t&&_.largestBatchId>n){let v=s.get(_.largestBatchId);null===v&&(v=an(),s=s.insert(_.largestBatchId,v)),v.set(_.getKey(),_)}}const f=an(),p=s.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((_,v)=>f.set(_,v)),!(f.size()>=i)););return U.resolve(f)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const c=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new mr(t,n));let s=this.hr.get(t);void 0===s&&(s=Re(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}}class ro{constructor(){this.Pr=new ze(Dt.Ir),this.Tr=new ze(Dt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new Dt(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Ar(new Dt(e,t))}Rr(e,t){e.forEach(n=>this.removeReference(n,t))}Vr(e){const t=new ae(new Oe([])),n=new Dt(t,e),i=new Dt(t,e+1),s=[];return this.Tr.forEachInRange([n,i],c=>{this.Ar(c),s.push(c.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new ae(new Oe([])),n=new Dt(t,e),i=new Dt(t,e+1);let s=Re();return this.Tr.forEachInRange([n,i],c=>{s=s.add(c.key)}),s}containsKey(e){const t=new Dt(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Dt{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return ae.comparator(e.key,t.key)||Ce(e.pr,t.pr)}static Er(e,t){return Ce(e.pr,t.pr)||ae.comparator(e.key,t.key)}}class Hh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new ze(Dt.Ir)}checkEmpty(e){return U.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.yr;this.yr++;const c=new Ws(s,t,n,i);this.mutationQueue.push(c);for(const f of i)this.wr=this.wr.add(new Dt(f.key,s)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return U.resolve(c)}lookupMutationBatch(e,t){return U.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.br(t+1),s=i<0?0:i;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Dt(t,0),i=new Dt(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,i],c=>{const f=this.Sr(c.pr);s.push(f)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ze(Ce);return t.forEach(i=>{const s=new Dt(i,0),c=new Dt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,c],f=>{n=n.add(f.pr)})}),U.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;ae.isDocumentKey(s)||(s=s.child(""));const c=new Dt(new ae(s),0);let f=new ze(Ce);return this.wr.forEachWhile(p=>{const _=p.key.path;return!!n.isPrefixOf(_)&&(_.length===i&&(f=f.add(p.pr)),!0)},c),U.resolve(this.Dr(f))}Dr(e){const t=[];return e.forEach(n=>{const i=this.Sr(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){ge(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return U.forEach(t.mutations,i=>{const s=new Dt(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=n})}Mn(e){}containsKey(e,t){const n=new Dt(t,0),i=this.wr.firstAfterOrEqual(n);return U.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return U.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class nl{constructor(e){this.vr=e,this.docs=new it(ae.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,c=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return U.resolve(n?n.document.mutableCopy():Ze.newInvalidDocument(t))}getEntries(e,t){let n=en();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Ze.newInvalidDocument(i))}),U.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=en();const c=t.path,f=new ae(c.child("")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:_,value:{document:v}}=p.getNext();if(!c.isPrefixOf(_.path))break;_.path.length>c.length+1||si(eu(v),n)<=0||(i.has(v.key)||Gs(t,v))&&(s=s.insert(v.key,v.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(e,t,n,i){pe()}Fr(e,t){return U.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Wh(this)}getSize(e){return U.resolve(this.size)}}class Wh extends sd{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(n)}),U.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class Tn{constructor(e){this.persistence=e,this.Mr=new pr(t=>Hi(t),Us),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.Or=0,this.Nr=new ro,this.targetCount=0,this.Lr=_r.Nn()}forEachTarget(e,t){return this.Mr.forEach((n,i)=>t(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),U.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new _r(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.qn(t),U.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Mr.forEach((c,f)=>{f.sequenceNumber<=t&&null===n.get(f.targetId)&&(this.Mr.delete(c),s.push(this.removeMatchingKeysForTargetId(e,f.targetId)),i++)}),U.waitFor(s).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return U.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),U.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(c=>{s.push(i.markPotentiallyOrphaned(e,c))}),U.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return U.resolve(n)}containsKey(e,t){return U.resolve(this.Nr.containsKey(t))}}class wi{constructor(e,t){this.Br={},this.overlays={},this.kr=new Dn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Tn(this),this.indexManager=new Ai,this.remoteDocumentCache=new nl(n=>this.referenceDelegate.Kr(n)),this.serializer=new Wu(t),this.$r=new ud(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new Hh(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){Z("MemoryPersistence","Starting transaction:",e);const i=new dd(this.kr.next());return this.referenceDelegate.Ur(),n(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return U.or(Object.values(this.Br).map(n=>()=>n.containsKey(e,t)))}}class dd extends xo{constructor(e){super(),this.currentSequenceNumber=e}}class ba{constructor(e){this.persistence=e,this.zr=new ro,this.jr=null}static Hr(e){return new ba(e)}get Jr(){if(this.jr)return this.jr;throw pe()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),U.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),U.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Jr,n=>{const i=ae.fromPath(n);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,_e.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(n=>{n?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return U.or([()=>U.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class rl{constructor(e){this.serializer=e}O(e,t,n,i){const s=new Bi("createOrUpgrade",t);var p;n<1&&i>=1&&(e.createObjectStore("owner"),(p=e).createObjectStore("mutationQueues",{keyPath:"userId"}),p.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nu,{unique:!0}),p.createObjectStore("documentMutations"),hd(e),function(p){p.createObjectStore("remoteDocuments")}(e));let c=U.resolve();return n<3&&i>=3&&(0!==n&&(function(p){p.deleteObjectStore("targetDocuments"),p.deleteObjectStore("targets"),p.deleteObjectStore("targetGlobal")}(e),hd(e)),c=c.next(()=>function(p){const _=p.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return _.put("targetGlobalKey",v)}(s))),n<4&&i>=4&&(0!==n&&(c=c.next(()=>function(p,_){return _.store("mutations").U().next(v=>{p.deleteObjectStore("mutations"),p.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nu,{unique:!0});const T=_.store("mutations"),S=v.map(L=>T.put(L));return U.waitFor(S)})}(e,s))),c=c.next(()=>{!function(p){p.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&i>=5&&(c=c.next(()=>this.Xr(s))),n<6&&i>=6&&(c=c.next(()=>(function(p){p.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),n<7&&i>=7&&(c=c.next(()=>this.ti(s))),n<8&&i>=8&&(c=c.next(()=>this.ni(e,s))),n<9&&i>=9&&(c=c.next(()=>{!function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&i>=10&&(c=c.next(()=>this.ri(s))),n<11&&i>=11&&(c=c.next(()=>{(function(p){p.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(p){p.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(c=c.next(()=>{!function(p){const _=p.createObjectStore("documentOverlays",{keyPath:ic});_.createIndex("collectionPathOverlayIndex",sc,{unique:!1}),_.createIndex("collectionGroupOverlayIndex",oc,{unique:!1})}(e)})),n<13&&i>=13&&(c=c.next(()=>function(p){const _=p.createObjectStore("remoteDocumentsV14",{keyPath:iu});_.createIndex("documentKeyIndex",su),_.createIndex("collectionGroupIndex",nc)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(c=c.next(()=>this.si(e,s))),n<15&&i>=15&&(c=c.next(()=>function(p){p.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),p.createObjectStore("indexState",{keyPath:Oo}).createIndex("sequenceNumberIndex",au,{unique:!1}),p.createObjectStore("indexEntries",{keyPath:cu}).createIndex("documentKeyIndex",hh,{unique:!1})}(e))),n<16&&i>=16&&(c=c.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),c}ei(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=Ta(i)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>U.forEach(i,s=>{const c=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",c).next(f=>U.forEach(f,p=>{ge(p.userId===s.userId);const _=vi(this.serializer,p);return Ia(e,s.userId,_).next(()=>{})}))}))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return n.J((c,f)=>{const p=new Oe(c),_=[0,It(p)];s.push(t.get(_).next(v=>v?U.resolve():t.put({targetId:0,path:It(p),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>U.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:rc});const n=t.store("collectionParents"),i=new Jc,s=c=>{if(i.add(c)){const f=c.lastSegment(),p=c.popLast();return n.put({collectionId:f,parent:It(p)})}};return t.store("remoteDocuments").J({H:!0},(c,f)=>{const p=new Oe(c);return s(p.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([c,f,p],_)=>{const v=Bn(f);return s(v.popLast())}))}ri(e){const t=e.store("targets");return t.J((n,i)=>{const s=Zs(i),c=zc(this.serializer,s);return t.put(c)})}ii(e,t){const n=t.store("remoteDocuments"),i=[];return n.J((s,c)=>{const f=t.store("remoteDocumentsV14"),p=(T=c,T.document?new ae(Oe.fromString(T.document.name).popFirst(5)):T.noDocument?ae.fromSegments(T.noDocument.path):T.unknownDocument?ae.fromSegments(T.unknownDocument.path):pe()).path.toArray(),_={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};var T;i.push(f.put(_))}).next(()=>U.waitFor(i))}si(e,t){const n=t.store("mutations"),i=od(this.serializer),s=new wi(ba.Hr,this.serializer.ct);return n.U().next(c=>{const f=new Map;return c.forEach(p=>{var _;let v=null!==(_=f.get(p.userId))&&void 0!==_?_:Re();vi(this.serializer,p).keys().forEach(T=>v=v.add(T)),f.set(p.userId,v)}),U.forEach(f,(p,_)=>{const v=new Ot(_),T=ma.lt(this.serializer,v),S=s.getIndexManager(v),L=Ea.lt(v,this.serializer,S,s.referenceDelegate);return new ld(i,L,T,S).recalculateAndSaveOverlaysForDocumentKeys(new Gi(t,Dn.oe),p).next()})})}}function hd(r){r.createObjectStore("targetDocuments",{keyPath:ou}).createIndex("documentTargetsIndex",dh,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",kn,{unique:!0}),r.createObjectStore("targetGlobal")}const wa="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class il{constructor(e,t,n,i,s,c,f,p,_,v,T=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=s,this.window=c,this.document=f,this._i=_,this.ai=v,this.ui=T,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=S=>Promise.resolve(),!il.D())throw new J(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jh(this,i),this.Ti=t+"main",this.serializer=new Wu(p),this.Ei=new Yn(this.Ti,this.ui,new rl(this.serializer)),this.Qr=new Bh(this.referenceDelegate,this.serializer),this.remoteDocumentCache=od(this.serializer),this.$r=new Mh,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===v&&vt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new J(z.FAILED_PRECONDITION,wa);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Dn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){var t=this;return this.Ii=function(){var n=(0,H.A)(function*(i){if(t.started)return e(i)});return function(i){return n.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(function(){var t=(0,H.A)(function*(n){null===n.newVersion&&(yield e())});return function(n){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget((0,H.A)(function*(){t.started&&(yield t.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>io(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Nr(e))return Z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Vn(e).get("owner").next(t=>U.resolve(this.Si(t)))}bi(e){return io(e).delete(this.clientId)}Di(){var e=this;return(0,H.A)(function*(){if(e.isPrimary&&!e.Ci(e.Pi,18e5)){e.Pi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const i=bt(n,"clientMetadata");return i.U().next(s=>{const c=e.vi(s,18e5),f=s.filter(p=>-1===c.indexOf(p));return U.forEach(f,p=>i.delete(p.clientId)).next(()=>f)})}).catch(()=>[]);if(e.di)for(const n of t)e.di.removeItem(e.Fi(n.clientId))}})()}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?U.resolve(!0):Vn(e).get("owner").next(t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new J(z.FAILED_PRECONDITION,wa);return!1}}return!(!this.networkEnabled||!this.inForeground)||io(e).U().next(n=>void 0===this.vi(n,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&Z("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,H.A)(function*(){e.qr=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Oi(),e.Ni(),yield e.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const n=new Gi(t,Dn.oe);return e.yi(n).next(()=>e.bi(n))}),e.Ei.close(),e.Li()})()}vi(e,t){return e.filter(n=>this.Ci(n.updateTimeMs,t)&&!this.Mi(n.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>io(e).U().next(t=>this.vi(t,18e5).map(n=>n.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return Ea.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Zc(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ma.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){Z("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=16===(p=this.ui)?uc:15===p?lc:14===p?No:13===p?cc:12===p?ac:11===p?Os:void pe();var p;let c;return this.Ei.runTransaction(e,i,s,f=>(c=new Gi(f,this.kr?this.kr.next():Dn.oe),"readwrite-primary"===t?this.gi(c).next(p=>!!p||this.pi(c)).next(p=>{if(!p)throw vt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new J(z.FAILED_PRECONDITION,Qn);return n(c)}).next(p=>this.wi(c).next(()=>p)):this.ki(c).next(()=>n(c)))).then(f=>(c.raiseOnCommittedEvent(),f))}ki(e){return Vn(e).get("owner").next(t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new J(z.FAILED_PRECONDITION,wa)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vn(e).put("owner",t)}static D(){return Yn.D()}yi(e){const t=Vn(e);return t.get("owner").next(n=>this.Si(n)?(Z("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):U.resolve())}Ci(e,t){const n=Date.now();return!(e<n-t||e>n&&(vt(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,Ue.nr)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return Z("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return vt("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){vt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vn(r){return bt(r,"owner")}function io(r){return bt(r,"clientMetadata")}function sl(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}class ol{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=i}static Ki(e,t){let n=Re(),i=Re();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ol(e,t.fromCache,n,i)}}class Qh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class al{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=(0,Ue.nr)()?8:Do((0,Ue.ZQ)())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ji(e,t).next(c=>{s.result=c}).next(()=>{if(!s.result)return this.Hi(e,t,i,n).next(c=>{s.result=c})}).next(()=>{if(s.result)return;const c=new Qh;return this.Ji(e,t,c).next(f=>{if(s.result=f,this.Ui)return this.Yi(e,t,c,f.size)})}).next(()=>s.result)}Yi(e,t,n,i){return n.documentReadCount<this.Wi?(Li()<=vn.$b.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",ct(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),U.resolve()):(Li()<=vn.$b.DEBUG&&Z("QueryEngine","Query:",ct(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(Li()<=vn.$b.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",ct(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xt(t))):U.resolve())}ji(e,t){if(yu(t))return U.resolve(null);let n=xt(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=$o(t,null,"F"),n=xt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const c=Re(...s);return this.zi.getDocuments(e,c).next(f=>this.indexManager.getMinOffset(e,n).next(p=>{const _=this.Zi(t,f);return this.Xi(t,_,c,p.readTime)?this.ji(e,$o(t,null,"F")):this.es(e,_,t,p)}))})))}Hi(e,t,n,i){return yu(t)||i.isEqual(_e.min())?U.resolve(null):this.zi.getDocuments(e,n).next(s=>{const c=this.Zi(t,s);return this.Xi(t,c,n,i)?U.resolve(null):(Li()<=vn.$b.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ct(t)),this.es(e,c,t,Po(i,-1)).next(f=>f))})}Zi(e,t){let n=new ze(Iu(e));return t.forEach((i,s)=>{Gs(e,s)&&(n=n.add(s))}),n}Xi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,n){return Li()<=vn.$b.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",ct(t)),this.zi.getDocumentsMatchingQuery(e,t,Zt.min(),n)}es(e,t,n,i){return this.zi.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(c=>{s=s.insert(c.key,c)}),s))}}class cn{constructor(e,t,n,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new it(Ce),this.rs=new pr(s=>Hi(s),Us),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ld(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function Ca(r,e,t,n){return new cn(r,e,t,n)}function Sa(r,e){return cl.apply(this,arguments)}function cl(){return(cl=(0,H.A)(function*(r,e){const t=ie(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const c=[],f=[];let p=Re();for(const _ of i){c.push(_.batchId);for(const v of _.mutations)p=p.add(v.key)}for(const _ of s){f.push(_.batchId);for(const v of _.mutations)p=p.add(v.key)}return t.localDocuments.getDocuments(n,p).next(_=>({us:_,removedBatchIds:c,addedBatchIds:f}))})})})).apply(this,arguments)}function as(r){const e=ie(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function ll(r,e,t){let n=Re(),i=Re();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let c=en();return t.forEach((f,p)=>{const _=s.get(f);p.isFoundDocument()!==_.isFoundDocument()&&(i=i.add(f)),p.isNoDocument()&&p.version.isEqual(_e.min())?(e.removeEntry(f,p.readTime),c=c.insert(f,p)):!_.isValidDocument()||p.version.compareTo(_.version)>0||0===p.version.compareTo(_.version)&&_.hasPendingWrites?(e.addEntry(p),c=c.insert(f,p)):Z("LocalStore","Ignoring outdated watch update for ",f,". Current version:",_.version," Watch version:",p.version)}),{cs:c,ls:i}})}function Yh(r,e){const t=ie(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Wr(r,e){const t=ie(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Qr.getTargetData(n,e).next(s=>s?(i=s,U.resolve(i)):t.Qr.allocateTargetId(n).next(c=>(i=new gr(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.Qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.ns.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(n.targetId,n),t.rs.set(e,n.targetId)),n})}function cs(r,e,t){return ul.apply(this,arguments)}function ul(){return(ul=(0,H.A)(function*(r,e,t){const n=ie(r),i=n.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,c=>n.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!Nr(c))throw c;Z("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}n.ns=n.ns.remove(e),n.rs.delete(i.target)})).apply(this,arguments)}function Ra(r,e,t){const n=ie(r);let i=_e.min(),s=Re();return n.persistence.runTransaction("Execute query","readwrite",c=>function(p,_,v){const T=ie(p),S=T.rs.get(v);return void 0!==S?U.resolve(T.ns.get(S)):T.Qr.getTargetData(_,v)}(n,c,xt(e)).next(f=>{if(f)return i=f.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(c,f.targetId).next(p=>{s=p})}).next(()=>n.ts.getDocumentsMatchingQuery(c,e,t?i:_e.min(),t?s:Re())).next(f=>(o(n,Ko(e),f),{documents:f,hs:s})))}function pd(r,e){const t=ie(r),n=ie(t.Qr),i=t.ns.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(c=>c?c.target:null))}function u(r,e){const t=ie(r),n=t.ss.get(e)||_e.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.os.getAllFromCollectionGroup(i,e,Po(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(o(t,e,i),i))}function o(r,e,t){let n=r.ss.get(e)||_e.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.ss.set(e,n)}function h(){return(h=(0,H.A)(function*(r,e,t,n){const i=ie(r);let s=Re(),c=en();for(const _ of t){const v=e.Ps(_.metadata.name);_.document&&(s=s.add(v));const T=e.Is(_);T.setReadTime(e.Ts(_.metadata.readTime)),c=c.insert(v,T)}const f=i.os.newChangeBuffer({trackRemovals:!0}),p=yield Wr(i,(v=n,xt(Qi(Oe.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",_=>ll(_,f,c).next(v=>(f.apply(_),v)).next(v=>i.Qr.removeMatchingKeysForTargetId(_,p.targetId).next(()=>i.Qr.addMatchingKeys(_,s,p.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(_,v.cs,v.ls)).next(()=>v.cs)))})).apply(this,arguments)}function g(r,e){return I.apply(this,arguments)}function I(){return(I=(0,H.A)(function*(r,e,t=Re()){const n=yield Wr(r,xt(jc(e.bundledQuery))),i=ie(r);return i.persistence.runTransaction("Save named query","readwrite",s=>{const c=ft(e.readTime);if(n.snapshotVersion.compareTo(c)>=0)return i.$r.saveNamedQuery(s,e);const f=n.withResumeToken(Tt.EMPTY_BYTE_STRING,c);return i.ns=i.ns.insert(f.targetId,f),i.Qr.updateTargetData(s,f).next(()=>i.Qr.removeMatchingKeysForTargetId(s,n.targetId)).next(()=>i.Qr.addMatchingKeys(s,t,n.targetId)).next(()=>i.$r.saveNamedQuery(s,e))})})).apply(this,arguments)}function C(r,e){return`firestore_clients_${r}_${e}`}function O(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function K(r,e){return`firestore_targets_${r}_${e}`}class se{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Es(e,t,n){const i=JSON.parse(n);let s,c="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return c&&i.error&&(c="string"==typeof i.error.message&&"string"==typeof i.error.code,c&&(s=new J(i.error.code,i.error.message))),c?new se(e,t,i.state,s):(vt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class de{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let i,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code,s&&(i=new J(n.error.code,n.error.message))),s?new de(e,n.state,i):(vt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class he{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let i="object"==typeof n&&n.activeTargetIds instanceof Array,s=qs();for(let c=0;i&&c<n.activeTargetIds.length;++c)i=ci(n.activeTargetIds[c]),s=s.add(n.activeTargetIds[c]);return i?new he(e,s):(vt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class lt{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new lt(t.clientId,t.onlineState):(vt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class En{constructor(){this.activeTargetIds=qs()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ls{constructor(e,t,n,i,s){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new it(Ce),this.started=!1,this.ys=[];const c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=C(this.persistenceKey,this.Vs),this.Ss=`firestore_sequence_number_${this.persistenceKey}`,this.ps=this.ps.insert(this.Vs,new En),this.bs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.vs=`firestore_online_state_${this.persistenceKey}`,this.Fs=function(p){return`firestore_bundle_loaded_v2_${p}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,H.A)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Vs)continue;const s=e.getItem(C(e.persistenceKey,i));if(s){const c=he.Es(i,s);c&&(e.ps=e.ps.insert(c.clientId,c))}}e.Ms();const n=e.storage.getItem(e.vs);if(n){const i=e.xs(n);i&&e.Os(i)}for(const i of e.ys)e.gs(i);e.ys=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(K(this.persistenceKey,e));if(n){const i=de.Es(e,n);i&&(t=i.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(K(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Z("SharedClientState","READ",e,t),t}setItem(e,t){Z("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Z("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){var t=this;const n=e;if(n.storageArea===this.storage){if(Z("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void vt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable((0,H.A)(function*(){if(t.started){if(null!==n.key)if(t.bs.test(n.key)){if(null==n.newValue){const i=t.$s(n.key);return t.Us(i,null)}{const i=t.Ws(n.key,n.newValue);if(i)return t.Us(i.clientId,i)}}else if(t.Ds.test(n.key)){if(null!==n.newValue){const i=t.Gs(n.key,n.newValue);if(i)return t.zs(i)}}else if(t.Cs.test(n.key)){if(null!==n.newValue){const i=t.js(n.key,n.newValue);if(i)return t.Hs(i)}}else if(n.key===t.vs){if(null!==n.newValue){const i=t.xs(n.newValue);if(i)return t.Os(i)}}else if(n.key===t.Ss){const i=function(c){let f=Dn.oe;if(null!=c)try{const p=JSON.parse(c);ge("number"==typeof p),f=p}catch(p){vt("SharedClientState","Failed to read sequence number from WebStorage",p)}return f}(n.newValue);i!==Dn.oe&&t.sequenceNumberHandler(i)}else if(n.key===t.Fs){const i=t.Js(n.newValue);yield Promise.all(i.map(s=>t.syncEngine.Ys(s)))}}else t.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){const i=new se(this.currentUser,e,t,n),s=O(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){const t=O(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){this.storage.setItem(this.vs,JSON.stringify({clientId:this.Vs,onlineState:e}))}qs(e,t,n){const i=K(this.persistenceKey,e),s=new de(e,t,n);this.setItem(i,s.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return he.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),i=Number(n[1]);return se.Es(new Ot(void 0!==n[2]?n[2]:null),i,t)}js(e,t){const n=this.Cs.exec(e),i=Number(n[1]);return de.Es(i,t)}xs(e){return lt.Es(e)}Js(e){return JSON.parse(e)}zs(e){var t=this;return(0,H.A)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Zs(e.batchId,e.state,e.error);Z("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(n),c=[],f=[];return s.forEach(p=>{i.has(p)||c.push(p)}),i.forEach(p=>{s.has(p)||f.push(p)}),this.syncEngine.eo(c,f).then(()=>{this.ps=n})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=qs();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class dl{constructor(){this.no=new En,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new En,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hl{io(e){}shutdown(){}}class fl{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let so=null;function oo(){return null===so?so=268435456+Math.round(2147483648*Math.random()):so++,"0x"+so.toString(16)}const md={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gd{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}const Nt="WebChannelConnection";class _d extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=n+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,n,i,s,c){const f=oo(),p=this.vo(t,n.toUriEncodedString());Z("RestConnection",`Sending RPC '${t}' ${f}:`,p,i);const _={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(_,s,c),this.Mo(t,p,_,i).then(v=>(Z("RestConnection",`Received RPC '${t}' ${f}: `,v),v),v=>{throw on("RestConnection",`RPC '${t}' ${f} failed with error: `,v,"url: ",p,"request:",i),v})}xo(t,n,i,s,c,f){return this.Co(t,n,i,s,c)}Fo(t,n,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+xr,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,c)=>t[c]=s),i&&i.headers.forEach((s,c)=>t[c]=s)}vo(t,n){return`${this.wo}/v1/${n}:${md[t]}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,n,i){const s=oo();return new Promise((c,f)=>{const p=new we;p.setWithCredentials(!0),p.listenOnce(Je.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case Kt.NO_ERROR:const v=p.getResponseJson();Z(Nt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(v)),c(v);break;case Kt.TIMEOUT:Z(Nt,`RPC '${e}' ${s} timed out`),f(new J(z.DEADLINE_EXCEEDED,"Request time out"));break;case Kt.HTTP_ERROR:const T=p.getStatus();if(Z(Nt,`RPC '${e}' ${s} failed with status:`,T,"response text:",p.getResponseText()),T>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const L=S?.error;if(L&&L.status&&L.message){const Q=function(X){const me=X.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(me)>=0?me:z.UNKNOWN}(L.status);f(new J(Q,L.message))}else f(new J(z.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new J(z.UNAVAILABLE,"Connection failed."));break;default:pe()}}finally{Z(Nt,`RPC '${e}' ${s} completed.`)}});const _=JSON.stringify(i);Z(Nt,`RPC '${e}' ${s} sending request:`,i),p.send(t,"POST",_,n,15)})}Oo(e,t,n){const i=oo(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Ya(),f=nt(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;void 0!==_&&(p.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(p.xmlHttpFactory=new De({})),this.Fo(p.initMessageHeaders,t,n),p.encodeInitMessageHeaders=!0;const v=s.join("");Z(Nt,`Creating RPC '${e}' stream ${i}: ${v}`,p);const T=c.createWebChannel(v,p);let S=!1,L=!1;const Q=new gd({lo:X=>{L?Z(Nt,`Not sending because RPC '${e}' stream ${i} is closed:`,X):(S||(Z(Nt,`Opening RPC '${e}' stream ${i} transport.`),T.open(),S=!0),Z(Nt,`RPC '${e}' stream ${i} sending:`,X),T.send(X))},ho:()=>T.close()}),ne=(X,me,ye)=>{X.listen(me,oe=>{try{ye(oe)}catch(Ie){setTimeout(()=>{throw Ie},0)}})};return ne(T,Xe.EventType.OPEN,()=>{L||(Z(Nt,`RPC '${e}' stream ${i} transport opened.`),Q.mo())}),ne(T,Xe.EventType.CLOSE,()=>{L||(L=!0,Z(Nt,`RPC '${e}' stream ${i} transport closed`),Q.po())}),ne(T,Xe.EventType.ERROR,X=>{L||(L=!0,on(Nt,`RPC '${e}' stream ${i} transport errored:`,X),Q.po(new J(z.UNAVAILABLE,"The operation could not be completed")))}),ne(T,Xe.EventType.MESSAGE,X=>{var me;if(!L){const ye=X.data[0];ge(!!ye);const Ie=ye.error||(null===(me=ye[0])||void 0===me?void 0:me.error);if(Ie){Z(Nt,`RPC '${e}' stream ${i} received error:`,Ie);const Pe=Ie.status;let ke=function(x){const N=wt[x];if(void 0!==N)return kc(N)}(Pe),k=Ie.message;void 0===ke&&(ke=z.INTERNAL,k="Unknown error status: "+Pe+" with message "+Ie.message),L=!0,Q.po(new J(ke,k)),T.close()}else Z(Nt,`RPC '${e}' stream ${i} received:`,ye),Q.yo(ye)}}),ne(f,Co.STAT_EVENT,X=>{X.stat===cr.PROXY?Z(Nt,`RPC '${e}' stream ${i} detected buffering proxy`):X.stat===cr.NOPROXY&&Z(Nt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{Q.fo()},0),Q}}function yd(){return typeof window<"u"?window:null}function us(){return typeof document<"u"?document:null}function ao(r){return new xh(r,!0)}class Xh{constructor(e,t,n=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=n,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-n);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){null!==this.qo&&(this.qo.skipDelay(),this.qo=null)}cancel(){null!==this.qo&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}class cm{constructor(e,t,n,i,s,c,f,p){this.oi=e,this.Go=n,this.zo=i,this.connection=s,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Xh(e,t)}Zo(){return 1===this.state||5===this.state||this.Xo()}Xo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.e_()}stop(){var e=this;return(0,H.A)(function*(){e.Zo()&&(yield e.close(0))})()}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&null===this.Ho&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){var e=this;return(0,H.A)(function*(){if(e.Xo())return e.close(0)})()}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){var n=this;return(0,H.A)(function*(){n.s_(),n.o_(),n.Yo.cancel(),n.jo++,4!==e?n.Yo.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(vt(t.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),n.Yo.Ko()):t&&t.code===z.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.__(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Ao(t)})()}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.jo===t&&this.u_(n,i)},n=>{e(()=>{const i=new J(z.UNKNOWN,"Fetching auth token failed: "+n.message);return this.c_(i)})})}u_(e,t){const n=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{n(()=>this.listener.Po())}),this.stream.To(()=>{n(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{n(()=>this.c_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}e_(){var e=this;this.state=5,this.Yo.$o((0,H.A)(function*(){e.state=0,e.start()}))}c_(e){return Z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(Z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class z_ extends cm{constructor(e,t,n,i,s,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,c),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=function Gu(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(_=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===_?1:"REMOVE"===_?2:"CURRENT"===_?3:"RESET"===_?4:pe(),i=e.targetChange.targetIds||[],s=function(_,v){return _.useProto3Json?(ge(void 0===v||"string"==typeof v),Tt.fromBase64String(v||"")):(ge(void 0===v||v instanceof Buffer||v instanceof Uint8Array),Tt.fromUint8Array(v||new Uint8Array))}(r,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&function(_){const v=void 0===_.code?z.UNKNOWN:kc(_.code);return new J(v,_.message||"")}(c);t=new Nu(n,i,s,f||null)}else if("documentChange"in e){const n=e.documentChange,i=Nn(r,n.document.name),s=ft(n.document.updateTime),c=n.document.createTime?ft(n.document.createTime):_e.min(),f=new Bt({mapValue:{fields:n.document.fields}}),p=Ze.newFoundDocument(i,s,c,f);t=new zr(n.targetIds||[],n.removedTargetIds||[],p.key,p)}else if("documentDelete"in e){const n=e.documentDelete,i=Nn(r,n.document),s=n.readTime?ft(n.readTime):_e.min(),c=Ze.newNoDocument(i,s);t=new zr([],n.removedTargetIds||[],c.key,c)}else if("documentRemove"in e){const n=e.documentRemove,i=Nn(r,n.document);t=new zr([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return pe();{const n=e.filter,{count:i=0,unchangedNames:s}=n,c=new Ph(i,s);t=new Ou(n.targetId,c)}}var _;return t}(this.serializer,e),n=function(s){if(!("targetChange"in s))return _e.min();const c=s.targetChange;return c.targetIds&&c.targetIds.length?_e.min():c.readTime?ft(c.readTime):_e.min()}(e);return this.listener.h_(t,n)}P_(e){const t={};t.database=sa(this.serializer),t.addTarget=function(s,c){let f;const p=c.target;if(f=jo(p)?{documents:zu(s,p)}:{query:ca(s,p)._t},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=Fu(s,c.resumeToken);const _=Lc(s,c.expectedCount);null!==_&&(f.expectedCount=_)}else if(c.snapshotVersion.compareTo(_e.min())>0){f.readTime=jr(s,c.snapshotVersion.toTimestamp());const _=Lc(s,c.expectedCount);null!==_&&(f.expectedCount=_)}return f}(this.serializer,e);const n=function kh(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.i_(t)}I_(e){const t={};t.database=sa(this.serializer),t.removeTarget=e,this.i_(t)}}class j_ extends cm{constructor(e,t,n,i,s,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,c),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=function Gc(r,e){return r&&r.length>0?(ge(void 0!==e),r.map(t=>function(i,s){let c=ft(i.updateTime?i.updateTime:s);return c.isEqual(_e.min())&&(c=ft(s)),new Ch(c,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=ft(e.commitTime);return this.listener.A_(n,t)}return ge(!e.writeResults||0===e.writeResults.length),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=sa(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Js(this.serializer,n))};this.i_(t)}}class q_ extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,n,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,c])=>this.connection.Co(e,Uc(t,n),i,s,c)).catch(s=>{throw"FirebaseError"===s.name?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new J(z.UNKNOWN,s.toString())})}xo(e,t,n,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,f])=>this.connection.xo(e,Uc(t,n),i,c,f,s)).catch(c=>{throw"FirebaseError"===c.name?(c.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new J(z.UNKNOWN,c.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class $_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(vt(t),this.y_=!1):Z("OnlineStateTracker",t)}C_(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}class K_{constructor(e,t,n,i,s){var c=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(f=>{n.enqueueAndForget((0,H.A)(function*(){var p;ds(c)&&(Z("RemoteStore","Restarting streams for network reachability change."),yield(p=(0,H.A)(function*(v){const T=ie(v);T.M_.add(4),yield Pa(T),T.N_.set("Unknown"),T.M_.delete(4),yield pl(T)}),function _(v){return p.apply(this,arguments)})(c))}))}),this.N_=new $_(n,i)}}function pl(r){return Jh.apply(this,arguments)}function Jh(){return(Jh=(0,H.A)(function*(r){if(ds(r))for(const e of r.x_)yield e(!0)})).apply(this,arguments)}function Pa(r){return Zh.apply(this,arguments)}function Zh(){return(Zh=(0,H.A)(function*(r){for(const e of r.x_)yield e(!1)})).apply(this,arguments)}function vd(r,e){const t=ie(r);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),nf(t)?tf(t):ka(t).Xo()&&ef(t,e))}function xa(r,e){const t=ie(r),n=ka(t);t.F_.delete(e),n.Xo()&&lm(t,e),0===t.F_.size&&(n.Xo()?n.n_():ds(t)&&t.N_.set("Unknown"))}function ef(r,e){if(r.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ka(r).P_(e)}function lm(r,e){r.L_.xe(e),ka(r).I_(e)}function tf(r){r.L_=new Vc({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.F_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),ka(r).start(),r.N_.w_()}function nf(r){return ds(r)&&!ka(r).Zo()&&r.F_.size>0}function ds(r){return 0===ie(r).M_.size}function um(r){r.L_=void 0}function H_(r){return rf.apply(this,arguments)}function rf(){return(rf=(0,H.A)(function*(r){r.N_.set("Online")})).apply(this,arguments)}function W_(r){return sf.apply(this,arguments)}function sf(){return(sf=(0,H.A)(function*(r){r.F_.forEach((e,t)=>{ef(r,e)})})).apply(this,arguments)}function Q_(r,e){return of.apply(this,arguments)}function of(){return(of=(0,H.A)(function*(r,e){um(r),nf(r)?(r.N_.D_(e),tf(r)):r.N_.set("Unknown")})).apply(this,arguments)}function Y_(r,e,t){return af.apply(this,arguments)}function af(){return af=(0,H.A)(function*(r,e,t){if(r.N_.set("Online"),e instanceof Nu&&2===e.state&&e.cause)try{yield(n=(0,H.A)(function*(s,c){const f=c.cause;for(const p of c.targetIds)s.F_.has(p)&&(yield s.remoteSyncer.rejectListen(p,f),s.F_.delete(p),s.L_.removeTarget(p))}),function i(s,c){return n.apply(this,arguments)})(r,e)}catch(n){Z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield Id(r,n)}else if(e instanceof zr?r.L_.Ke(e):e instanceof Ou?r.L_.He(e):r.L_.We(e),!t.isEqual(_e.min()))try{const n=yield as(r.localStore);t.compareTo(n)>=0&&(yield function(s,c){const f=s.L_.rt(c);return f.targetChanges.forEach((p,_)=>{if(p.resumeToken.approximateByteSize()>0){const v=s.F_.get(_);v&&s.F_.set(_,v.withResumeToken(p.resumeToken,c))}}),f.targetMismatches.forEach((p,_)=>{const v=s.F_.get(p);if(!v)return;s.F_.set(p,v.withResumeToken(Tt.EMPTY_BYTE_STRING,v.snapshotVersion)),lm(s,p);const T=new gr(v.target,p,_,v.sequenceNumber);ef(s,T)}),s.remoteSyncer.applyRemoteEvent(f)}(r,t))}catch(n){Z("RemoteStore","Failed to raise snapshot:",n),yield Id(r,n)}var n}),af.apply(this,arguments)}function Id(r,e,t){return cf.apply(this,arguments)}function cf(){return(cf=(0,H.A)(function*(r,e,t){if(!Nr(e))throw e;r.M_.add(1),yield Pa(r),r.N_.set("Offline"),t||(t=()=>as(r.localStore)),r.asyncQueue.enqueueRetryable((0,H.A)(function*(){Z("RemoteStore","Retrying IndexedDB access"),yield t(),r.M_.delete(1),yield pl(r)}))})).apply(this,arguments)}function dm(r,e){return e().catch(t=>Id(r,t,e))}function Da(r){return lf.apply(this,arguments)}function lf(){return(lf=(0,H.A)(function*(r){const e=ie(r),t=hs(e);let n=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;X_(e);)try{const i=yield Yh(e.localStore,n);if(null===i){0===e.v_.length&&t.n_();break}n=i.batchId,J_(e,i)}catch(i){yield Id(e,i)}hm(e)&&fm(e)})).apply(this,arguments)}function X_(r){return ds(r)&&r.v_.length<10}function J_(r,e){r.v_.push(e);const t=hs(r);t.Xo()&&t.E_&&t.d_(e.mutations)}function hm(r){return ds(r)&&!hs(r).Zo()&&r.v_.length>0}function fm(r){hs(r).start()}function Z_(r){return uf.apply(this,arguments)}function uf(){return(uf=(0,H.A)(function*(r){hs(r).V_()})).apply(this,arguments)}function ey(r){return df.apply(this,arguments)}function df(){return(df=(0,H.A)(function*(r){const e=hs(r);for(const t of r.v_)e.d_(t.mutations)})).apply(this,arguments)}function ty(r,e,t){return hf.apply(this,arguments)}function hf(){return(hf=(0,H.A)(function*(r,e,t){const n=r.v_.shift(),i=pi.from(n,e,t);yield dm(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield Da(r)})).apply(this,arguments)}function ny(r,e){return ff.apply(this,arguments)}function ff(){return ff=(0,H.A)(function*(r,e){var t;e&&hs(r).E_&&(yield(t=(0,H.A)(function*(i,s){if(Jo(f=s.code)&&f!==z.ABORTED){const c=i.v_.shift();hs(i).t_(),yield dm(i,()=>i.remoteSyncer.rejectFailedWrite(c.batchId,s)),yield Da(i)}var f}),function n(i,s){return t.apply(this,arguments)})(r,e)),hm(r)&&fm(r)}),ff.apply(this,arguments)}function pm(r,e){return pf.apply(this,arguments)}function pf(){return(pf=(0,H.A)(function*(r,e){const t=ie(r);t.asyncQueue.verifyOperationInProgress(),Z("RemoteStore","RemoteStore received new credentials");const n=ds(t);t.M_.add(3),yield Pa(t),n&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield pl(t)})).apply(this,arguments)}function mf(r,e){return gf.apply(this,arguments)}function gf(){return(gf=(0,H.A)(function*(r,e){const t=ie(r);e?(t.M_.delete(2),yield pl(t)):e||(t.M_.add(2),yield Pa(t),t.N_.set("Unknown"))})).apply(this,arguments)}function ka(r){return r.B_||(r.B_=function(t,n,i){const s=ie(t);return s.f_(),new z_(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:H_.bind(null,r),To:W_.bind(null,r),Ao:Q_.bind(null,r),h_:Y_.bind(null,r)}),r.x_.push(function(){var e=(0,H.A)(function*(t){t?(r.B_.t_(),nf(r)?tf(r):r.N_.set("Unknown")):(yield r.B_.stop(),um(r))});return function(t){return e.apply(this,arguments)}}())),r.B_}function hs(r){return r.k_||(r.k_=function(t,n,i){const s=ie(t);return s.f_(),new j_(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Po:()=>Promise.resolve(),To:Z_.bind(null,r),Ao:ny.bind(null,r),R_:ey.bind(null,r),A_:ty.bind(null,r)}),r.x_.push(function(){var e=(0,H.A)(function*(t){t?(r.k_.t_(),yield Da(r)):(yield r.k_.stop(),r.v_.length>0&&(Z("RemoteStore",`Stopping write stream with ${r.v_.length} pending writes`),r.v_=[]))});return function(t){return e.apply(this,arguments)}}())),r.k_}class _f{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Pt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const c=Date.now()+n,f=new _f(e,t,c,i,s);return f.start(n),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new J(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Oa(r,e){if(vt("AsyncQueue",`${e}: ${r}`),Nr(r))return new J(z.UNAVAILABLE,`${e}: ${r}`);throw r}class Na{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ae.comparator(t.key,n.key):(t,n)=>ae.comparator(t.key,n.key),this.keyedMap=Br(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new Na(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Na)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Na;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class mm{constructor(){this.q_=new it(ae.comparator)}track(e){const t=e.doc.key,n=this.q_.get(t);n?0!==e.type&&3===n.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==n.type?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.q_=this.q_.remove(t):1===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):pe():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Va{constructor(e,t,n,i,s,c,f,p,_){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=_}static fromInitialDocuments(e,t,n,i,s){const c=[];return t.forEach(f=>{c.push({type:0,doc:f})}),new Va(e,t,Na.emptySet(t),c,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class ry{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class iy{constructor(){this.queries=new pr(e=>vu(e),fr),this.onlineState="Unknown",this.z_=new Set}}function yf(r,e){return vf.apply(this,arguments)}function vf(){return(vf=(0,H.A)(function*(r,e){const t=ie(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.W_()&&e.G_()&&(n=2):(s=new ry,n=e.G_()?0:1);try{switch(n){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(c){const f=Oa(c,`Initialization of query '${ct(e.query)}' failed`);return void e.onError(f)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&Ef(t)})).apply(this,arguments)}function If(r,e){return Tf.apply(this,arguments)}function Tf(){return(Tf=(0,H.A)(function*(r,e){const t=ie(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const c=s.U_.indexOf(e);c>=0&&(s.U_.splice(c,1),0===s.U_.length?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})).apply(this,arguments)}function sy(r,e){const t=ie(r);let n=!1;for(const i of e){const c=t.queries.get(i.query);if(c){for(const f of c.U_)f.H_(i)&&(n=!0);c.K_=i}}n&&Ef(t)}function oy(r,e,t){const n=ie(r),i=n.queries.get(e);if(i)for(const s of i.U_)s.onError(t);n.queries.delete(e)}function Ef(r){r.z_.forEach(e=>{e.next()})}var Af,gm;(gm=Af||(Af={})).J_="default",gm.Cache="cache";class bf{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new Va(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){return!e.fromCache||!this.G_()||(!this.options.ra||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ea(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}na(e){e=Va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Af.Cache}}class ay{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}}class _m{constructor(e){this.serializer=e}Ps(e){return Nn(this.serializer,e)}Is(e){return e.metadata.exists?Bc(this.serializer,e.document,!1):Ze.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ft(e)}}class cy{constructor(e,t,n){this.oa=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ym(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;const n=Oe.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){const t=new Map,n=new _m(this.serializer);for(const i of e)if(i.metadata.queries){const s=n.Ps(i.metadata.name);for(const c of i.metadata.queries){const f=(t.get(c)||Re()).add(s);t.set(c,f)}}return t}complete(){var e=this;return(0,H.A)(function*(){const t=yield function a(r,e,t,n){return h.apply(this,arguments)}(e.localStore,new _m(e.serializer),e.documents,e.oa.id),n=e.aa(e.documents);for(const i of e.queries)yield g(e.localStore,i,n.get(i.name));return e.progress.taskState="Success",{progress:e.progress,ua:e.collectionGroups,ca:t}})()}}function ym(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}class vm{constructor(e){this.key=e}}class Im{constructor(e){this.key=e}}class Tm{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Re(),this.mutatedKeys=Re(),this.Ia=Iu(e),this.Ta=new Na(this.Ia)}get Ea(){return this.la}da(e,t){const n=t?t.Aa:new mm,i=t?t.Ta:this.Ta;let s=t?t.mutatedKeys:this.mutatedKeys,c=i,f=!1;const p="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,_="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((v,T)=>{const S=i.get(v),L=Gs(this.query,T)?T:null,Q=!!S&&this.mutatedKeys.has(S.key),ne=!!L&&(L.hasLocalMutations||this.mutatedKeys.has(L.key)&&L.hasCommittedMutations);let X=!1;S&&L?S.data.isEqual(L.data)?Q!==ne&&(n.track({type:3,doc:L}),X=!0):this.Ra(S,L)||(n.track({type:2,doc:L}),X=!0,(p&&this.Ia(L,p)>0||_&&this.Ia(L,_)<0)&&(f=!0)):!S&&L?(n.track({type:0,doc:L}),X=!0):S&&!L&&(n.track({type:1,doc:S}),X=!0,(p||_)&&(f=!0)),X&&(L?(c=c.add(L),s=ne?s.add(v):s.delete(v)):(c=c.delete(v),s=s.delete(v)))}),null!==this.query.limit)for(;c.size>this.query.limit;){const v="F"===this.query.limitType?c.last():c.first();c=c.delete(v.key),s=s.delete(v.key),n.track({type:1,doc:v})}return{Ta:c,Aa:n,Xi:f,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const c=e.Aa.Q_();c.sort((v,T)=>function(L,Q){const ne=X=>{switch(X){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe()}};return ne(L)-ne(Q)}(v.type,T.type)||this.Ia(v.doc,T.doc)),this.Va(n),i=null!=i&&i;const f=t&&!i?this.ma():[],p=0===this.Pa.size&&this.current&&!i?1:0,_=p!==this.ha;return this.ha=p,0!==c.length||_?{snapshot:new Va(this.query,e.Ta,s,c,e.mutatedKeys,0===p,_,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:f}:{fa:f}}j_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new mm,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=Re(),this.Ta.forEach(n=>{this.ga(n.key)&&(this.Pa=this.Pa.add(n.key))});const t=[];return e.forEach(n=>{this.Pa.has(n)||t.push(new Im(n))}),this.Pa.forEach(n=>{e.has(n)||t.push(new vm(n))}),t}pa(e){this.la=e.hs,this.Pa=Re();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Va.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}class ly{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class uy{constructor(e){this.key=e,this.wa=!1}}class dy{constructor(e,t,n,i,s,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=c,this.Sa={},this.ba=new pr(f=>vu(f),fr),this.Da=new Map,this.Ca=new Set,this.va=new it(ae.comparator),this.Fa=new Map,this.Ma=new ro,this.xa={},this.Oa=new Map,this.Na=_r.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return!0===this.La}}function hy(r,e){return wf.apply(this,arguments)}function wf(){return(wf=(0,H.A)(function*(r,e,t=!0){const n=Td(r);let i;const s=n.ba.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield Em(n,e,t,!0),i})).apply(this,arguments)}function fy(r,e){return Cf.apply(this,arguments)}function Cf(){return(Cf=(0,H.A)(function*(r,e){const t=Td(r);yield Em(t,e,!0,!1)})).apply(this,arguments)}function Em(r,e,t,n){return Sf.apply(this,arguments)}function Sf(){return(Sf=(0,H.A)(function*(r,e,t,n){const i=yield Wr(r.localStore,xt(e)),s=i.targetId,c=t?r.sharedClientState.addLocalQueryTarget(s):"not-current";let f;return n&&(f=yield Rf(r,e,s,"current"===c,i.resumeToken)),r.isPrimaryClient&&t&&vd(r.remoteStore,i),f})).apply(this,arguments)}function Rf(r,e,t,n,i){return Pf.apply(this,arguments)}function Pf(){return Pf=(0,H.A)(function*(r,e,t,n,i){r.Ba=(T,S,L)=>{return(Q=(0,H.A)(function*(X,me,ye,oe){let Ie=me.view.da(ye);Ie.Xi&&(Ie=yield Ra(X.localStore,me.query,!1).then(({documents:w})=>me.view.da(w,Ie)));const Pe=oe&&oe.targetChanges.get(me.targetId),ke=oe&&null!=oe.targetMismatches.get(me.targetId),k=me.view.applyChanges(Ie,X.isPrimaryClient,Pe,ke);return Bf(X,me.targetId,k.fa),k.snapshot}),function ne(X,me,ye,oe){return Q.apply(this,arguments)})(r,T,S,L);var Q};const s=yield Ra(r.localStore,e,!0),c=new Tm(e,s.hs),f=c.da(s.documents),p=Qs.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),_=c.applyChanges(f,r.isPrimaryClient,p);Bf(r,t,_.fa);const v=new ly(e,t,c);return r.ba.set(e,v),r.Da.has(t)?r.Da.get(t).push(e):r.Da.set(t,[e]),_.snapshot}),Pf.apply(this,arguments)}function py(r,e,t){return xf.apply(this,arguments)}function xf(){return(xf=(0,H.A)(function*(r,e,t){const n=ie(r),i=n.ba.get(e),s=n.Da.get(i.targetId);if(s.length>1)return n.Da.set(i.targetId,s.filter(c=>!fr(c,e))),void n.ba.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield cs(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&xa(n.remoteStore,i.targetId),Ma(n,i.targetId)}).catch(Or))):(Ma(n,i.targetId),yield cs(n.localStore,i.targetId,!0))})).apply(this,arguments)}function my(r,e){return Df.apply(this,arguments)}function Df(){return(Df=(0,H.A)(function*(r,e){const t=ie(r),n=t.ba.get(e),i=t.Da.get(n.targetId);t.isPrimaryClient&&1===i.length&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),xa(t.remoteStore,n.targetId))})).apply(this,arguments)}function kf(){return(kf=(0,H.A)(function*(r,e,t){const n=Xf(r);try{const i=yield function(c,f){const p=ie(c),_=rt.now(),v=f.reduce((L,Q)=>L.add(Q.key),Re());let T,S;return p.persistence.runTransaction("Locally write mutations","readwrite",L=>{let Q=en(),ne=Re();return p.os.getEntries(L,v).next(X=>{Q=X,Q.forEach((me,ye)=>{ye.isValidDocument()||(ne=ne.add(me))})}).next(()=>p.localDocuments.getOverlayedDocuments(L,Q)).next(X=>{T=X;const me=[];for(const ye of f){const oe=Rh(ye,T.get(ye.key).overlayedDocument);null!=oe&&me.push(new jn(ye.key,oe,_c(oe.value.mapValue),ht.exists(!0)))}return p.mutationQueue.addMutationBatch(L,_,me,f)}).next(X=>{S=X;const me=X.applyToLocalDocumentSet(T,ne);return p.documentOverlayCache.saveOverlays(L,X.batchId,me)})}).then(()=>({batchId:S.batchId,changes:Sc(T)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(c,f,p){let _=c.xa[c.currentUser.toKey()];_||(_=new it(Ce)),_=_.insert(f,p),c.xa[c.currentUser.toKey()]=_}(n,i.batchId,t),yield Ci(n,i.changes),yield Da(n.remoteStore)}catch(i){const s=Oa(i,"Failed to persist write");t.reject(s)}})).apply(this,arguments)}function Am(r,e){return Of.apply(this,arguments)}function Of(){return(Of=(0,H.A)(function*(r,e){const t=ie(r);try{const n=yield function fd(r,e){const t=ie(r),n=e.snapshotVersion;let i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const c=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;const f=[];e.targetChanges.forEach((v,T)=>{const S=i.get(T);if(!S)return;f.push(t.Qr.removeMatchingKeys(s,v.removedDocuments,T).next(()=>t.Qr.addMatchingKeys(s,v.addedDocuments,T)));let L=S.withSequenceNumber(s.currentSequenceNumber);var ne,X,me;null!==e.targetMismatches.get(T)?L=L.withResumeToken(Tt.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):v.resumeToken.approximateByteSize()>0&&(L=L.withResumeToken(v.resumeToken,n)),i=i.insert(T,L),X=L,me=v,(0===(ne=S).resumeToken.approximateByteSize()||X.snapshotVersion.toMicroseconds()-ne.snapshotVersion.toMicroseconds()>=3e8||me.addedDocuments.size+me.modifiedDocuments.size+me.removedDocuments.size>0)&&f.push(t.Qr.updateTargetData(s,L))});let p=en(),_=Re();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(s,v))}),f.push(ll(s,c,e.documentUpdates).next(v=>{p=v.cs,_=v.ls})),!n.isEqual(_e.min())){const v=t.Qr.getLastRemoteSnapshotVersion(s).next(T=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,n));f.push(v)}return U.waitFor(f).next(()=>c.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,p,_)).next(()=>p)}).then(s=>(t.ns=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const c=t.Fa.get(s);c&&(ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?c.wa=!0:i.modifiedDocuments.size>0?ge(c.wa):i.removedDocuments.size>0&&(ge(c.wa),c.wa=!1))}),yield Ci(t,n,e)}catch(n){yield Or(n)}})).apply(this,arguments)}function bm(r,e,t){const n=ie(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.ba.forEach((s,c)=>{const f=c.view.j_(e);f.snapshot&&i.push(f.snapshot)}),function(c,f){const p=ie(c);p.onlineState=f;let _=!1;p.queries.forEach((v,T)=>{for(const S of T.U_)S.j_(f)&&(_=!0)}),_&&Ef(p)}(n.eventManager,e),i.length&&n.Sa.h_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function _y(r,e,t){return Nf.apply(this,arguments)}function Nf(){return(Nf=(0,H.A)(function*(r,e,t){const n=ie(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Fa.get(e),s=i&&i.key;if(s){let c=new it(ae.comparator);c=c.insert(s,Ze.newNoDocument(s,_e.min()));const f=Re().add(s),p=new gi(_e.min(),new Map,new it(Ce),c,f);yield Am(n,p),n.va=n.va.remove(s),n.Fa.delete(e),Gf(n)}else yield cs(n.localStore,e,!1).then(()=>Ma(n,e,t)).catch(Or)})).apply(this,arguments)}function yy(r,e){return Vf.apply(this,arguments)}function Vf(){return(Vf=(0,H.A)(function*(r,e){const t=ie(r),n=e.batch.batchId;try{const i=yield function yr(r,e){const t=ie(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(f,p,_,v){const T=_.batch,S=T.keys();let L=U.resolve();return S.forEach(Q=>{L=L.next(()=>v.getEntry(p,Q)).next(ne=>{const X=_.docVersions.get(Q);ge(null!==X),ne.version.compareTo(X)<0&&(T.applyToRemoteDocument(ne,_),ne.isValidDocument()&&(ne.setReadTime(_.commitVersion),v.addEntry(ne)))})}),L.next(()=>f.mutationQueue.removeMutationBatch(p,T))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(f){let p=Re();for(let _=0;_<f.mutationResults.length;++_)f.mutationResults[_].transformResults.length>0&&(p=p.add(f.batch.mutations[_].key));return p}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);Uf(t,n,null),Ff(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield Ci(t,i)}catch(i){yield Or(i)}})).apply(this,arguments)}function vy(r,e,t){return Mf.apply(this,arguments)}function Mf(){return(Mf=(0,H.A)(function*(r,e,t){const n=ie(r);try{const i=yield function(c,f){const p=ie(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",_=>{let v;return p.mutationQueue.lookupMutationBatch(_,f).next(T=>(ge(null!==T),v=T.keys(),p.mutationQueue.removeMutationBatch(_,T))).next(()=>p.mutationQueue.performConsistencyCheck(_)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(_,v,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(_,v)).next(()=>p.localDocuments.getDocuments(_,v))})}(n.localStore,e);Uf(n,e,t),Ff(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield Ci(n,i)}catch(i){yield Or(i)}})).apply(this,arguments)}function Lf(){return(Lf=(0,H.A)(function*(r,e){const t=ie(r);ds(t.remoteStore)||Z("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=yield function(c){const f=ie(c);return f.persistence.runTransaction("Get highest unacknowledged batch id","readonly",p=>f.mutationQueue.getHighestUnacknowledgedBatchId(p))}(t.localStore);if(-1===n)return void e.resolve();const i=t.Oa.get(n)||[];i.push(e),t.Oa.set(n,i)}catch(n){const i=Oa(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})).apply(this,arguments)}function Ff(r,e){(r.Oa.get(e)||[]).forEach(t=>{t.resolve()}),r.Oa.delete(e)}function Uf(r,e,t){const n=ie(r);let i=n.xa[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.xa[n.currentUser.toKey()]=i}}function Ma(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Da.get(e))r.ba.delete(n),t&&r.Sa.ka(n,t);r.Da.delete(e),r.isPrimaryClient&&r.Ma.Vr(e).forEach(n=>{r.Ma.containsKey(n)||wm(r,n)})}function wm(r,e){r.Ca.delete(e.path.canonicalString());const t=r.va.get(e);null!==t&&(xa(r.remoteStore,t),r.va=r.va.remove(e),r.Fa.delete(t),Gf(r))}function Bf(r,e,t){for(const n of t)n instanceof vm?(r.Ma.addReference(n.key,e),Ty(r,n)):n instanceof Im?(Z("SyncEngine","Document no longer in limbo: "+n.key),r.Ma.removeReference(n.key,e),r.Ma.containsKey(n.key)||wm(r,n.key)):pe()}function Ty(r,e){const t=e.key,n=t.path.canonicalString();r.va.get(t)||r.Ca.has(n)||(Z("SyncEngine","New document in limbo: "+t),r.Ca.add(n),Gf(r))}function Gf(r){for(;r.Ca.size>0&&r.va.size<r.maxConcurrentLimboResolutions;){const e=r.Ca.values().next().value;r.Ca.delete(e);const t=new ae(Oe.fromString(e)),n=r.Na.next();r.Fa.set(n,new uy(t)),r.va=r.va.insert(t,n),vd(r.remoteStore,new gr(xt(Qi(t.path)),n,"TargetPurposeLimboResolution",Dn.oe))}}function Ci(r,e,t){return zf.apply(this,arguments)}function zf(){return zf=(0,H.A)(function*(r,e,t){const n=ie(r),i=[],s=[],c=[];var f;n.ba.isEmpty()||(n.ba.forEach((f,p)=>{c.push(n.Ba(p,e,t).then(_=>{if((_||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(p.targetId,_&&!_.fromCache?"current":"not-current"),_){i.push(_);const v=ol.Ki(p.targetId,_);s.push(v)}}))}),yield Promise.all(c),n.Sa.h_(i),yield(f=(0,H.A)(function*(_,v){const T=ie(_);try{yield T.persistence.runTransaction("notifyLocalViewChanges","readwrite",S=>U.forEach(v,L=>U.forEach(L.qi,Q=>T.persistence.referenceDelegate.addReference(S,L.targetId,Q)).next(()=>U.forEach(L.Qi,Q=>T.persistence.referenceDelegate.removeReference(S,L.targetId,Q)))))}catch(S){if(!Nr(S))throw S;Z("LocalStore","Failed to update sequence numbers: "+S)}for(const S of v){const L=S.targetId;if(!S.fromCache){const Q=T.ns.get(L),X=Q.withLastLimboFreeSnapshotVersion(Q.snapshotVersion);T.ns=T.ns.insert(L,X)}}}),function p(_,v){return f.apply(this,arguments)})(n.localStore,s))}),zf.apply(this,arguments)}function Ey(r,e){return jf.apply(this,arguments)}function jf(){return(jf=(0,H.A)(function*(r,e){const t=ie(r);if(!t.currentUser.isEqual(e)){Z("SyncEngine","User change. New user:",e.toKey());const n=yield Sa(t.localStore,e);t.currentUser=e,(s=t).Oa.forEach(f=>{f.forEach(p=>{p.reject(new J(z.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.Oa.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield Ci(t,n.us)}var s})).apply(this,arguments)}function Ay(r,e){const t=ie(r),n=t.Fa.get(e);if(n&&n.wa)return Re().add(n.key);{let i=Re();const s=t.Da.get(e);if(!s)return i;for(const c of s){const f=t.ba.get(c);i=i.unionWith(f.view.Ea)}return i}}function by(r,e){return qf.apply(this,arguments)}function qf(){return(qf=(0,H.A)(function*(r,e){const t=ie(r),n=yield Ra(t.localStore,e.query,!0),i=e.view.pa(n);return t.isPrimaryClient&&Bf(t,e.targetId,i.fa),i})).apply(this,arguments)}function wy(r,e){return $f.apply(this,arguments)}function $f(){return($f=(0,H.A)(function*(r,e){const t=ie(r);return u(t.localStore,e).then(n=>Ci(t,n))})).apply(this,arguments)}function Cy(r,e,t,n){return Kf.apply(this,arguments)}function Kf(){return(Kf=(0,H.A)(function*(r,e,t,n){const i=ie(r),s=yield function(f,p){const _=ie(f),v=ie(_.mutationQueue);return _.persistence.runTransaction("Lookup mutation documents","readonly",T=>v.vn(T,p).next(S=>S?_.localDocuments.getDocuments(T,S):U.resolve(null)))}(i.localStore,e);var p;null!==s?("pending"===t?yield Da(i.remoteStore):"acknowledged"===t||"rejected"===t?(Uf(i,e,n||null),Ff(i,e),p=e,ie(ie(i.localStore).mutationQueue).Mn(p)):pe(),yield Ci(i,s)):Z("SyncEngine","Cannot apply mutation batch with id: "+e)})).apply(this,arguments)}function Hf(){return(Hf=(0,H.A)(function*(r,e){const t=ie(r);if(Td(t),Xf(t),!0===e&&!0!==t.La){const n=t.sharedClientState.getAllActiveQueryTargets(),i=yield Cm(t,n.toArray());t.La=!0,yield mf(t.remoteStore,!0);for(const s of i)vd(t.remoteStore,s)}else if(!1===e&&!1!==t.La){const n=[];let i=Promise.resolve();t.Da.forEach((s,c)=>{t.sharedClientState.isLocalQueryTarget(c)?n.push(c):i=i.then(()=>(Ma(t,c),cs(t.localStore,c,!0))),xa(t.remoteStore,c)}),yield i,yield Cm(t,n),function(c){const f=ie(c);f.Fa.forEach((p,_)=>{xa(f.remoteStore,_)}),f.Ma.mr(),f.Fa=new Map,f.va=new it(ae.comparator)}(t),t.La=!1,yield mf(t.remoteStore,!1)}})).apply(this,arguments)}function Cm(r,e,t){return Wf.apply(this,arguments)}function Wf(){return(Wf=(0,H.A)(function*(r,e,t){const n=ie(r),i=[],s=[];for(const c of e){let f;const p=n.Da.get(c);if(p&&0!==p.length){f=yield Wr(n.localStore,xt(p[0]));for(const _ of p){const v=n.ba.get(_),T=yield by(n,v);T.snapshot&&s.push(T.snapshot)}}else{const _=yield pd(n.localStore,c);f=yield Wr(n.localStore,_),yield Rf(n,Sm(_),c,!1,f.resumeToken)}i.push(f)}return n.Sa.h_(s),i})).apply(this,arguments)}function Sm(r){return Ac(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function Ry(r){return t=ie(r).localStore,ie(ie(t).persistence).Bi();var t}function Py(r,e,t,n){return Qf.apply(this,arguments)}function Qf(){return(Qf=(0,H.A)(function*(r,e,t,n){const i=ie(r);if(i.La)return void Z("SyncEngine","Ignoring unexpected query state notification.");const s=i.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const c=yield u(i.localStore,Ko(s[0])),f=gi.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Tt.EMPTY_BYTE_STRING);yield Ci(i,c,f);break}case"rejected":yield cs(i.localStore,e,!0),Ma(i,e,n);break;default:pe()}})).apply(this,arguments)}function xy(r,e,t){return Yf.apply(this,arguments)}function Yf(){return(Yf=(0,H.A)(function*(r,e,t){const n=Td(r);if(n.La){for(const i of e){if(n.Da.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){Z("SyncEngine","Adding an already active target "+i);continue}const s=yield pd(n.localStore,i),c=yield Wr(n.localStore,s);yield Rf(n,Sm(s),c.targetId,!1,c.resumeToken),vd(n.remoteStore,c)}for(const i of t)n.Da.has(i)&&(yield cs(n.localStore,i,!1).then(()=>{xa(n.remoteStore,i),Ma(n,i)}).catch(Or))}})).apply(this,arguments)}function Td(r){const e=ie(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Am.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ay.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_y.bind(null,e),e.Sa.h_=sy.bind(null,e.eventManager),e.Sa.ka=oy.bind(null,e.eventManager),e}function Xf(r){const e=ie(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yy.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vy.bind(null,e),e}class La{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,H.A)(function*(){t.serializer=ao(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Ca(this.persistence,new al,e.initialUser,this.serializer)}createPersistence(e){return new wi(ba.Hr,this.serializer)}createSharedClientState(e){return new dl}terminate(){var e=this;return(0,H.A)(function*(){var t,n;null===(t=e.gcScheduler)||void 0===t||t.stop(),null===(n=e.indexBackfillerScheduler)||void 0===n||n.stop(),e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Jf extends La{constructor(e,t,n){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,n=this;return(0,H.A)(function*(){yield t().call(n,e),yield n.Qa.initialize(n,e),yield Xf(n.Qa.syncEngine),yield Da(n.Qa.remoteStore),yield n.persistence.fi(()=>(n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(),n.indexBackfillerScheduler&&!n.indexBackfillerScheduler.started&&n.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return Ca(this.persistence,new al,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new to(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new ks(t,this.persistence);return new uh(e.asyncQueue,n)}createPersistence(e){const t=sl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Wt.withCacheSize(this.cacheSizeBytes):Wt.DEFAULT;return new il(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,yd(),us(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new dl}}class Rm extends Jf{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,n=this;return(0,H.A)(function*(){yield t().call(n,e);const i=n.Qa.syncEngine;n.sharedClientState instanceof ls&&(n.sharedClientState.syncEngine={Zs:Cy.bind(null,i),Xs:Py.bind(null,i),eo:xy.bind(null,i),Bi:Ry.bind(null,i),Ys:wy.bind(null,i)},yield n.sharedClientState.start()),yield n.persistence.fi(function(){var s=(0,H.A)(function*(c){yield function Sy(r,e){return Hf.apply(this,arguments)}(n.Qa.syncEngine,c),n.gcScheduler&&(c&&!n.gcScheduler.started?n.gcScheduler.start():c||n.gcScheduler.stop()),n.indexBackfillerScheduler&&(c&&!n.indexBackfillerScheduler.started?n.indexBackfillerScheduler.start():c||n.indexBackfillerScheduler.stop())});return function(c){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=yd();if(!ls.D(t))throw new J(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=sl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ls(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Fa{initialize(e,t){var n=this;return(0,H.A)(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>bm(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=Ey.bind(null,n.syncEngine),yield mf(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new iy}createDatastore(e){const t=ao(e.databaseInfo.databaseId),n=new _d(e.databaseInfo);return new q_(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return n=this.localStore,i=this.datastore,s=e.asyncQueue,c=t=>bm(this.syncEngine,t,0),f=fl.D()?new fl:new hl,new K_(n,i,s,c,f);var n,i,s,c,f}createSyncEngine(e,t){return function(i,s,c,f,p,_,v){const T=new dy(i,s,c,f,p,_);return v&&(T.La=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){var e=this;return(0,H.A)(function*(){var t,n;yield(n=(0,H.A)(function*(s){const c=ie(s);Z("RemoteStore","RemoteStore shutting down."),c.M_.add(5),yield Pa(c),c.O_.shutdown(),c.N_.set("Unknown")}),function i(s){return n.apply(this,arguments)})(e.remoteStore),null===(t=e.datastore)||void 0===t||t.terminate()})()}}function Pm(r,e=10240){let t=0;return{read:()=>(0,H.A)(function*(){if(t<r.byteLength){const n={value:r.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}})(),cancel:()=>(0,H.A)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Ed{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):vt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Oy{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Pt,this.buffer=new Uint8Array,this.Wa=new TextDecoder("utf-8"),this.Ga().then(n=>{n&&n.sa()?this.metadata.resolve(n.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(n?.ia)}`))},n=>this.metadata.reject(n))}close(){return this.Ua.cancel()}getMetadata(){var e=this;return(0,H.A)(function*(){return e.metadata.promise})()}qa(){var e=this;return(0,H.A)(function*(){return yield e.getMetadata(),e.Ga()})()}Ga(){var e=this;return(0,H.A)(function*(){const t=yield e.za();if(null===t)return null;const n=e.Wa.decode(t),i=Number(n);isNaN(i)&&e.ja(`length string (${n}) is not valid number`);const s=yield e.Ha(i);return new ay(JSON.parse(s),t.length+i)})()}Ja(){return this.buffer.findIndex(e=>123===e)}za(){var e=this;return(0,H.A)(function*(){for(;e.Ja()<0&&!(yield e.Ya()););if(0===e.buffer.length)return null;const t=e.Ja();t<0&&e.ja("Reached the end of bundle when a length string is expected.");const n=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),n})()}Ha(e){var t=this;return(0,H.A)(function*(){for(;t.buffer.length<e;)(yield t.Ya())&&t.ja("Reached the end of bundle when more is expected.");const n=t.Wa.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),n})()}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){var e=this;return(0,H.A)(function*(){const t=yield e.Ua.read();if(!t.done){const n=new Uint8Array(e.buffer.length+t.value.length);n.set(e.buffer),n.set(t.value,e.buffer.length),e.buffer=n}return t.done})()}}class Ny{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,H.A)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw t.lastTransactionError=new J(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),t.lastTransactionError;const n=yield(i=(0,H.A)(function*(c,f){const p=ie(c),_={documents:f.map(L=>Ys(p.serializer,L))},v=yield p.xo("BatchGetDocuments",p.serializer.databaseId,Oe.emptyPath(),_,f.length),T=new Map;v.forEach(L=>{const Q=function Bu(r,e){return"found"in e?function(n,i){ge(!!i.found);const s=Nn(n,i.found.name),c=ft(i.found.updateTime),f=i.found.createTime?ft(i.found.createTime):_e.min(),p=new Bt({mapValue:{fields:i.found.fields}});return Ze.newFoundDocument(s,c,f,p)}(r,e):"missing"in e?function(n,i){ge(!!i.missing),ge(!!i.readTime);const s=Nn(n,i.missing),c=ft(i.readTime);return Ze.newNoDocument(s,c)}(r,e):pe()}(p.serializer,L);T.set(Q.key.toString(),Q)});const S=[];return f.forEach(L=>{const Q=T.get(L.toString());ge(!!Q),S.push(Q)}),S}),function s(c,f){return i.apply(this,arguments)})(t.datastore,e);var i;return n.forEach(i=>t.recordVersion(i)),n})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Gr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,H.A)(function*(){if(e.ensureCommitNotCalled(),e.lastTransactionError)throw e.lastTransactionError;const t=e.readVersions;var n;e.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,i)=>{const s=ae.fromPath(i);e.mutations.push(new Dc(s,e.precondition(s)))}),yield(n=(0,H.A)(function*(s,c){const f=ie(s),p={writes:c.map(_=>Js(f.serializer,_))};yield f.Co("Commit",f.serializer.databaseId,Oe.emptyPath(),p)}),function i(s,c){return n.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw pe();t=_e.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new J(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(_e.min())?ht.exists(!1):ht.updateTime(t):ht.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(_e.min()))throw new J(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ht.updateTime(t)}return ht.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Vy{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this.Za=n.maxAttempts,this.Yo=new Xh(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){var e=this;this.Yo.$o((0,H.A)(function*(){const t=new Ny(e.datastore),n=e.tu(t);n&&n.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.nu(s)}))}).catch(i=>{e.nu(i)})}))}tu(e){try{const t=this.updateFunction(e);return!ai(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Jo(t)}return!1}}class My{constructor(e,t,n,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Ot.UNAUTHENTICATED,this.clientId=Ro.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var c=(0,H.A)(function*(f){Z("FirestoreClient","Received user=",f.uid),yield s.authCredentialListener(f),s.user=f});return function(f){return c.apply(this,arguments)}}()),this.appCheckCredentials.start(n,c=>(Z("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Pt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,H.A)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Oa(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Ad(r,e){return Zf.apply(this,arguments)}function Zf(){return Zf=(0,H.A)(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Z("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=(0,H.A)(function*(s){n.isEqual(s)||(yield Sa(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),Zf.apply(this,arguments)}function ep(r,e){return tp.apply(this,arguments)}function tp(){return(tp=(0,H.A)(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield np(r);Z("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>pm(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>pm(e.remoteStore,i)),r._onlineComponents=e})).apply(this,arguments)}function xm(r){return"FirebaseError"===r.name?r.code===z.FAILED_PRECONDITION||r.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}function np(r){return rp.apply(this,arguments)}function rp(){return(rp=(0,H.A)(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Z("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ad(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!xm(t))throw t;on("Error using user provided cache. Falling back to memory cache: "+t),yield Ad(r,new La)}}else Z("FirestoreClient","Using default OfflineComponentProvider"),yield Ad(r,new La);return r._offlineComponents})).apply(this,arguments)}function bd(r){return ip.apply(this,arguments)}function ip(){return(ip=(0,H.A)(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Z("FirestoreClient","Using user provided OnlineComponentProvider"),yield ep(r,r._uninitializedComponentsProvider._online)):(Z("FirestoreClient","Using default OnlineComponentProvider"),yield ep(r,new Fa))),r._onlineComponents})).apply(this,arguments)}function Dm(r){return np(r).then(e=>e.persistence)}function Ua(r){return np(r).then(e=>e.localStore)}function km(r){return bd(r).then(e=>e.remoteStore)}function sp(r){return bd(r).then(e=>e.syncEngine)}function Ba(r){return op.apply(this,arguments)}function op(){return(op=(0,H.A)(function*(r){const e=yield bd(r),t=e.eventManager;return t.onListen=hy.bind(null,e.syncEngine),t.onUnlisten=py.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=fy.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=my.bind(null,e.syncEngine),t})).apply(this,arguments)}function Nm(r,e,t={}){const n=new Pt;return r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return function(s,c,f,p,_){const v=new Ed({next:S=>{c.enqueueAndForget(()=>If(s,T));const L=S.docs.has(f);!L&&S.fromCache?_.reject(new J(z.UNAVAILABLE,"Failed to get document because the client is offline.")):L&&S.fromCache&&p&&"server"===p.source?_.reject(new J(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):_.resolve(S)},error:S=>_.reject(S)}),T=new bf(Qi(f.path),v,{includeMetadataChanges:!0,ra:!0});return yf(s,T)}(yield Ba(r),r.asyncQueue,e,t,n)})),n.promise}function Vm(r,e,t={}){const n=new Pt;return r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return function(s,c,f,p,_){const v=new Ed({next:S=>{c.enqueueAndForget(()=>If(s,T)),S.fromCache&&"server"===p.source?_.reject(new J(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):_.resolve(S)},error:S=>_.reject(S)}),T=new bf(f,v,{includeMetadataChanges:!0,ra:!0});return yf(s,T)}(yield Ba(r),r.asyncQueue,e,t,n)})),n.promise}function Mm(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const Lm=new Map;function ap(r,e,t){if(!t)throw new J(z.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function Fm(r,e,t,n){if(!0===e&&!0===n)throw new J(z.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Um(r){if(!ae.isDocumentKey(r))throw new J(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Bm(r){if(ae.isDocumentKey(r))throw new J(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function wd(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(n=r).constructor?n.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var n;return"function"==typeof r?"a function":pe()}function Me(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new J(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wd(r);throw new J(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function Gm(r,e){if(e<=0)throw new J(z.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}class zm{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new J(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new J(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Mm(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ml{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new J(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new J(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zm(e),void 0!==e.credentials&&(this._authCredentials=function(n){if(!n)return new Wl;switch(n.type){case"firstParty":return new oh(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new J(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Lm.get(t);n&&(Z("ComponentProvider","Removing Datastore"),Lm.delete(t),n.terminate())}(this),Promise.resolve()}}class tn{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new tn(this.firestore,e,this._query)}}class pt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}}class Qr extends tn{constructor(e,t,n){super(e,t,Qi(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new ae(e))}withConverter(e){return new Qr(this.firestore,e,this._path)}}function qm(r,e,...t){if(r=(0,Ue.Ku)(r),ap("collection","path",e),r instanceof ml){const n=Oe.fromString(e,...t);return Bm(n),new Qr(r,null,n)}{if(!(r instanceof pt||r instanceof Qr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Oe.fromString(e,...t));return Bm(n),new Qr(r.firestore,null,n)}}function Cd(r,e,...t){if(r=(0,Ue.Ku)(r),1===arguments.length&&(e=Ro.newId()),ap("doc","path",e),r instanceof ml){const n=Oe.fromString(e,...t);return Um(n),new pt(r,null,new ae(n))}{if(!(r instanceof pt||r instanceof Qr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Oe.fromString(e,...t));return Um(n),new pt(r.firestore,r instanceof Qr?r.converter:null,new ae(n))}}function $m(r,e){return r=(0,Ue.Ku)(r),e=(0,Ue.Ku)(e),(r instanceof pt||r instanceof Qr)&&(e instanceof pt||e instanceof Qr)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function cp(r,e){return r=(0,Ue.Ku)(r),e=(0,Ue.Ku)(e),r instanceof tn&&e instanceof tn&&r.firestore===e.firestore&&fr(r._query,e._query)&&r.converter===e.converter}class Qy{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Xh(this,"async_queue_retry"),this.hu=()=>{const t=us();t&&Z("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};const e=us();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=us();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new Pt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){var e=this;return(0,H.A)(function*(){if(0!==e.su.length){try{yield e.su[0](),e.su.shift(),e.Yo.reset()}catch(t){if(!Nr(t))throw t;Z("AsyncQueue","Operation failed with retryable error: "+t)}e.su.length>0&&e.Yo.$o(()=>e.Tu())}})()}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(n=>{throw this.au=n,this.uu=!1,vt("INTERNAL UNHANDLED ERROR: ",function(c){let f=c.message||"";return c.stack&&(f=c.stack.includes(c.message)?c.stack:c.message+"\n"+c.stack),f}(n)),n}).then(n=>(this.uu=!1,n))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const i=_f.createAndSchedule(this,e,t,n,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&pe()}verifyOperationInProgress(){}du(){var e=this;return(0,H.A)(function*(){let t;do{t=e.iu,yield t}while(t!==e.iu)})()}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}function lp(r){return function(t,n){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(r)}class Yy{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class st extends ml{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Qy,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Km(this),this._firestoreClient.terminate()}}function yt(r){return r._firestoreClient||Km(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function Km(r){var e,t,n;const i=r._freezeSettings(),s=(p=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new pc(r._databaseId,p,r._persistenceKey,(v=i).host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,Mm(v.experimentalLongPollingOptions),v.useFetchStreams));var p,v;r._firestoreClient=new My(r._authCredentials,r._appCheckCredentials,r._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.localCache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Hm(r,e,t){const n=new Pt;return r.asyncQueue.enqueue((0,H.A)(function*(){try{yield Ad(r,t),yield ep(r,e),n.resolve()}catch(i){const s=i;if(!xm(s))throw s;on("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function Wm(r){if(r._initialized||r._terminated)throw new J(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Yr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yr(Tt.fromBase64String(e))}catch(t){throw new J(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yr(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Si{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new J(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class co{constructor(e){this._methodName=e}}class Sd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new J(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new J(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ce(this._lat,e._lat)||Ce(this._long,e._long)}}const av=/^__.*__$/;class cv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new jn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zi(e,this.data,t,this.fieldTransforms)}}class Qm{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new jn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ym(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe()}}class Rd{constructor(e,t,n,i,s,c){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=c||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new Rd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.wu(e),i}Su(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.gu({path:n,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Dd(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(Ym(this.fu)&&av.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class lv{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ao(e)}Fu(e,t,n,i=!1){return new Rd({fu:e,methodName:t,vu:n,path:at.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lo(r){const e=r._freezeSettings(),t=ao(r._databaseId);return new lv(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Pd(r,e,t,n,i,s={}){const c=r.Fu(s.merge||s.mergeFields?2:0,e,t,i);gp("Data must be an object, but it was:",c,n);const f=Zm(n,c);let p,_;if(s.merge)p=new Ht(c.fieldMask),_=c.fieldTransforms;else if(s.mergeFields){const v=[];for(const T of s.mergeFields){const S=yl(e,T,t);if(!c.contains(S))throw new J(z.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);tg(v,S)||v.push(S)}p=new Ht(v),_=c.fieldTransforms.filter(T=>p.covers(T.field))}else p=null,_=c.fieldTransforms;return new cv(new Bt(f),p,_)}class _l extends co{_toFieldTransform(e){if(2!==e.fu)throw e.Du(1===e.fu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _l}}function Xm(r,e,t){return new Rd({fu:3,vu:e.settings.vu,methodName:r._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class up extends co{_toFieldTransform(e){return new $s(e.path,new Xi)}isEqual(e){return e instanceof up}}class dp extends co{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=Xm(this,e,!0),n=this.Mu.map(s=>uo(s,t)),i=new hi(n);return new $s(e.path,i)}isEqual(e){return e instanceof dp&&(0,Ue.bD)(this.Mu,e.Mu)}}class hp extends co{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=Xm(this,e,!0),n=this.Mu.map(s=>uo(s,t)),i=new nr(n);return new $s(e.path,i)}isEqual(e){return e instanceof hp&&(0,Ue.bD)(this.Mu,e.Mu)}}class fp extends co{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){const t=new Ji(e.serializer,bu(e.serializer,this.xu));return new $s(e.path,t)}isEqual(e){return e instanceof fp&&this.xu===e.xu}}function pp(r,e,t,n){const i=r.Fu(1,e,t);gp("Data must be an object, but it was:",i,n);const s=[],c=Bt.empty();Xn(n,(p,_)=>{const v=xd(e,p,t);_=(0,Ue.Ku)(_);const T=i.Su(v);if(_ instanceof _l)s.push(v);else{const S=uo(_,T);null!=S&&(s.push(v),c.set(v,S))}});const f=new Ht(s);return new Qm(c,f,i.fieldTransforms)}function mp(r,e,t,n,i,s){const c=r.Fu(1,e,t),f=[yl(e,n,t)],p=[i];if(s.length%2!=0)throw new J(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<s.length;S+=2)f.push(yl(e,s[S])),p.push(s[S+1]);const _=[],v=Bt.empty();for(let S=f.length-1;S>=0;--S)if(!tg(_,f[S])){const L=f[S];let Q=p[S];Q=(0,Ue.Ku)(Q);const ne=c.Su(L);if(Q instanceof _l)_.push(L);else{const X=uo(Q,ne);null!=X&&(_.push(L),v.set(L,X))}}const T=new Ht(_);return new Qm(v,T,c.fieldTransforms)}function Jm(r,e,t,n=!1){return uo(t,r.Fu(n?4:3,e))}function uo(r,e){if(eg(r=(0,Ue.Ku)(r)))return gp("Unsupported field value:",e,r),Zm(r,e);if(r instanceof co)return function(n,i){if(!Ym(i.fu))throw i.Du(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.yu&&4!==e.fu)throw e.Du("Nested arrays are not supported");return function(n,i){const s=[];let c=0;for(const f of n){let p=uo(f,i.bu(c));null==p&&(p={nullValue:"NULL_VALUE"}),s.push(p),c++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if(null===(n=(0,Ue.Ku)(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return bu(i.serializer,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const s=rt.fromDate(n);return{timestampValue:jr(i.serializer,s)}}if(n instanceof rt){const s=new rt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:jr(i.serializer,s)}}if(n instanceof Sd)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Yr)return{bytesValue:Fu(i.serializer,n._byteString)};if(n instanceof pt){const s=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(s))throw i.Du(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fc(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Du(`Unsupported field value: ${wd(n)}`)}(r,e)}function Zm(r,e){const t={};return Vo(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xn(r,(n,i)=>{const s=uo(i,e.pu(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function eg(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof rt||r instanceof Sd||r instanceof Yr||r instanceof pt||r instanceof co)}function gp(r,e,t){if(!eg(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const n=wd(t);throw e.Du("an object"===n?r+" a custom object":r+" "+n)}var i}function yl(r,e,t){if((e=(0,Ue.Ku)(e))instanceof Si)return e._internalPath;if("string"==typeof e)return xd(r,e);throw Dd("Field path arguments must be of type string or ",r,!1,void 0,t)}const uv=new RegExp("[~\\*/\\[\\]]");function xd(r,e,t){if(e.search(uv)>=0)throw Dd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Si(...e.split("."))._internalPath}catch{throw Dd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Dd(r,e,t,n,i){const s=n&&!n.isEmpty(),c=void 0!==i;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(s||c)&&(p+=" (found",s&&(p+=` in field ${n}`),c&&(p+=` in document ${i}`),p+=")"),new J(z.INVALID_ARGUMENT,f+r+p)}function tg(r,e){return r.some(t=>t.isEqual(e))}class vl{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new dv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(kd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class dv extends vl{data(){return super.data()}}function kd(r,e){return"string"==typeof e?xd(r,e):e instanceof Si?e._internalPath:e._delegate._internalPath}function ng(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new J(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _p{}class Il extends _p{}function fs(r,e,...t){let n=[];e instanceof _p&&n.push(e),n=n.concat(t),function(s){const c=s.filter(p=>p instanceof Ga).length,f=s.filter(p=>p instanceof Tl).length;if(c>1||c>0&&f>0)throw new J(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Tl extends Il{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Tl(e,t,n)}_apply(e){const t=this._parse(e);return og(e._query,t),new tn(e.firestore,e.converter,wc(e._query,t))}_parse(e){const t=lo(e.firestore);return function(s,c,f,p,_,v,T){let S;if(_.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new J(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){sg(T,v);const L=[];for(const Q of T)L.push(ig(p,s,Q));S={arrayValue:{values:L}}}else S=ig(p,s,T)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||sg(T,v),S=Jm(f,"where",T,"in"===v||"not-in"===v);return Le.create(_,v,S)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ga extends _p{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ga(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:He.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let c=i;const f=s.getFlattenedFilters();for(const p of f)og(c,p),c=wc(c,p)}(e._query,t),new tn(e.firestore,e.converter,wc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class yp extends Il{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yp(e,t)}_apply(e){const t=function(i,s,c){if(null!==i.startAt)throw new J(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new J(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ls(s,c)}(e._query,this._field,this._direction);return new tn(e.firestore,e.converter,function(i,s){const c=i.explicitOrderBy.concat([s]);return new On(i.path,i.collectionGroup,c,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class Od extends Il{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Od(e,t,n)}_apply(e){return new tn(e.firestore,e.converter,$o(e._query,this._limit,this._limitType))}}class Nd extends Il{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Nd(e,t,n)}_apply(e){const t=rg(e,this.type,this._docOrFields,this._inclusive);return new tn(e.firestore,e.converter,(s=t,new On((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class Vd extends Il{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Vd(e,t,n)}_apply(e){const t=rg(e,this.type,this._docOrFields,this._inclusive);return new tn(e.firestore,e.converter,(s=t,new On((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function rg(r,e,t,n){if(t[0]=(0,Ue.Ku)(t[0]),t[0]instanceof vl)return function(s,c,f,p,_){if(!p)throw new J(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const v=[];for(const T of Bs(s))if(T.field.isKeyField())v.push(dr(c,p.key));else{const S=p.data.field(T.field);if(Mo(S))throw new J(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+T.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===S){const L=T.field.canonicalString();throw new J(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${L}' (used as the orderBy) does not exist.`)}v.push(S)}return new Fr(v,_)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{const i=lo(r.firestore);return function(c,f,p,_,v,T){const S=c.explicitOrderBy;if(v.length>S.length)throw new J(z.INVALID_ARGUMENT,`Too many arguments provided to ${_}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const L=[];for(let Q=0;Q<v.length;Q++){const ne=v[Q];if(S[Q].field.isKeyField()){if("string"!=typeof ne)throw new J(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${_}(), but got a ${typeof ne}`);if(!bc(c)&&-1!==ne.indexOf("/"))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${_}() must be a plain document ID, but '${ne}' contains a slash.`);const X=c.path.child(Oe.fromString(ne));if(!ae.isDocumentKey(X))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${_}() must result in a valid document path, but '${X}' is not because it contains an odd number of segments.`);const me=new ae(X);L.push(dr(f,me))}else{const X=Jm(p,_,ne);L.push(X)}}return new Fr(L,T)}(r._query,r.firestore._databaseId,i,e,t,n)}}function ig(r,e,t){if("string"==typeof(t=(0,Ue.Ku)(t))){if(""===t)throw new J(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bc(e)&&-1!==t.indexOf("/"))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Oe.fromString(t));if(!ae.isDocumentKey(n))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return dr(r,new ae(n))}if(t instanceof pt)return dr(r,t._key);throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wd(t)}.`)}function sg(r,e){if(!Array.isArray(r)||0===r.length)throw new J(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function og(r,e){const t=function(i,s){for(const c of i)for(const f of c.getFlattenedFilters())if(s.indexOf(f.op)>=0)return f.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new J(z.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class vp{convertValue(e,t="none"){switch(Zn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw pe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Xn(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new Sd(_t(e.latitude),_t(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=qi(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp($i(e));default:return null}}convertTimestamp(e){const t=Gn(e);return new rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Oe.fromString(e);ge(Hu(n));const i=new Lr(n.get(1),n.get(3)),s=new ae(n.popFirst(5));return i.isEqual(t)||vt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Md(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class Iv extends vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,t)}}class ho{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ri extends vl{constructor(e,t,n,i,s,c){super(e,t,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new El(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(kd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class El extends Ri{data(e={}){return super.data(e)}}class ps{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ho(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new El(this._firestore,this._userDataWriter,n.key,n,new ho(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new J(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map(f=>({type:"added",doc:new El(i._firestore,i._userDataWriter,f.doc.key,f.doc,new ho(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:c++}))}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(f=>s||3!==f.type).map(f=>{const p=new El(i._firestore,i._userDataWriter,f.doc.key,f.doc,new ho(i._snapshot.mutatedKeys.has(f.doc.key),i._snapshot.fromCache),i.query.converter);let _=-1,v=-1;return 0!==f.type&&(_=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),1!==f.type&&(c=c.add(f.doc),v=c.indexOf(f.doc.key)),{type:Ev(f.type),doc:p,oldIndex:_,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Ev(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe()}}function cg(r,e){return r instanceof Ri&&e instanceof Ri?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(null===r._document?null===e._document:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof ps&&e instanceof ps&&r._firestore===e._firestore&&cp(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}class ms extends vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,t)}}function lg(r,e,t){r=Me(r,pt);const n=Me(r.firestore,st),i=Md(r.converter,e,t);return za(n,[Pd(lo(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,ht.none())])}function ug(r,e,t,...n){r=Me(r,pt);const i=Me(r.firestore,st),s=lo(i);let c;return c="string"==typeof(e=(0,Ue.Ku)(e))||e instanceof Si?mp(s,"updateDoc",r._key,e,t,n):pp(s,"updateDoc",r._key,e),za(i,[c.toMutation(r._key,ht.exists(!0))])}function dg(r,...e){var t,n,i;r=(0,Ue.Ku)(r);let s={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof e[c]||lp(e[c])||(s=e[c],c++);const f={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(lp(e[c])){const T=e[c];e[c]=null===(t=T.next)||void 0===t?void 0:t.bind(T),e[c+1]=null===(n=T.error)||void 0===n?void 0:n.bind(T),e[c+2]=null===(i=T.complete)||void 0===i?void 0:i.bind(T)}let p,_,v;if(r instanceof pt)_=Me(r.firestore,st),v=Qi(r._key.path),p={next:T=>{e[c]&&e[c](Ip(_,r,T))},error:e[c+1],complete:e[c+2]};else{const T=Me(r,tn);_=Me(T.firestore,st),v=T._query;const S=new ms(_);p={next:L=>{e[c]&&e[c](new ps(_,S,T,L))},error:e[c+1],complete:e[c+2]},ng(r._query)}return function(S,L,Q,ne){const X=new Ed(ne),me=new bf(L,X,Q);return S.asyncQueue.enqueueAndForget((0,H.A)(function*(){return yf(yield Ba(S),me)})),()=>{X.$a(),S.asyncQueue.enqueueAndForget((0,H.A)(function*(){return If(yield Ba(S),me)}))}}(yt(_),v,f,p)}function za(r,e){return function(n,i){const s=new Pt;return n.asyncQueue.enqueueAndForget((0,H.A)(function*(){return function gy(r,e,t){return kf.apply(this,arguments)}(yield sp(n),i,s)})),s.promise}(yt(r),e)}function Ip(r,e,t){const n=t.docs.get(e._key),i=new ms(r);return new Ri(r,i,e._key,n,new ho(t.hasPendingWrites,t.fromCache),e.converter)}const Bv={maxAttempts:5};class hg{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=lo(e)}set(e,t,n){this._verifyNotCommitted();const i=gs(e,this._firestore),s=Md(i.converter,t,n),c=Pd(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,n);return this._mutations.push(c.toMutation(i._key,ht.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=gs(e,this._firestore);let c;return c="string"==typeof(t=(0,Ue.Ku)(t))||t instanceof Si?mp(this._dataReader,"WriteBatch.update",s._key,t,n,i):pp(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(c.toMutation(s._key,ht.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=gs(e,this._firestore);return this._mutations=this._mutations.concat(new Gr(t._key,ht.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function gs(r,e){if((r=(0,Ue.Ku)(r)).firestore!==e)throw new J(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}class Gv extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=lo(t)}get(t){const n=gs(t,this._firestore),i=new Iv(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||1!==s.length)return pe();const c=s[0];if(c.isFoundDocument())return new vl(this._firestore,i,c.key,c,n.converter);if(c.isNoDocument())return new vl(this._firestore,i,n._key,null,n.converter);throw pe()})}set(t,n,i){const s=gs(t,this._firestore),c=Md(s.converter,n,i),f=Pd(this._dataReader,"Transaction.set",s._key,c,null!==s.converter,i);return this._transaction.set(s._key,f),this}update(t,n,i,...s){const c=gs(t,this._firestore);let f;return f="string"==typeof(n=(0,Ue.Ku)(n))||n instanceof Si?mp(this._dataReader,"Transaction.update",c._key,n,i,s):pp(this._dataReader,"Transaction.update",c._key,n),this._transaction.update(c._key,f),this}delete(t){const n=gs(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=gs(e,this._firestore),n=new ms(this._firestore);return super.get(e).then(i=>new Ri(this._firestore,n,t._key,i._document,new ho(!1,!1),t.converter))}}function Ep(r,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new J("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function gg(){if(typeof Uint8Array>"u")throw new J("unimplemented","Uint8Arrays are not available in this environment.")}function _g(){if(!function fc(){return typeof atob<"u"}())throw new J("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){xr=mn.SDK_VERSION,(0,mn._registerComponent)(new Pr.uA("firestore",(n,{instanceIdentifier:i,options:s})=>{const c=n.getProvider("app").getImmediate(),f=new st(new sh(n.getProvider("auth-internal")),new Xl(n.getProvider("app-check-internal")),function(_,v){if(!Object.prototype.hasOwnProperty.apply(_.options,["projectId"]))throw new J(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lr(_.options.projectId,v)}(c,i),c);return s=Object.assign({useFetchStreams:t},s),f._setSettings(s),f},"PUBLIC").setMultipleInstances(!0)),(0,mn.registerVersion)(Mi,"4.6.3",e),(0,mn.registerVersion)(Mi,"4.6.3","esm2017")}();class Al{constructor(e){this._delegate=e}static fromBase64String(e){return _g(),new Al(Yr.fromBase64String(e))}static fromUint8Array(e){return gg(),new Al(Yr.fromUint8Array(e))}toBase64(){return _g(),this._delegate.toBase64()}toUint8Array(){return gg(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Ap(r){return function Xv(r,e){if("object"!=typeof r||null===r)return!1;const t=r;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(r,["next","error","complete"])}class Jv{enableIndexedDbPersistence(e,t){return function Jy(r,e){Wm(r=Me(r,st));const t=yt(r);if(t._uninitializedComponentsProvider)throw new J(z.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=r._freezeSettings(),i=new Fa;return Hm(t,i,new Jf(i,n.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function Zy(r){Wm(r=Me(r,st));const e=yt(r);if(e._uninitializedComponentsProvider)throw new J(z.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings(),n=new Fa;return Hm(e,n,new Rm(n,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function ev(r){if(r._initialized&&!r._terminated)throw new J(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Pt;return r._queue.enqueueAndForgetEvenWhileRestricted((0,H.A)(function*(){try{yield(t=(0,H.A)(function*(i){if(!Yn.D())return Promise.resolve();const s=i+"main";yield Yn.delete(s)}),function n(i){return t.apply(this,arguments)})(sl(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class yg{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Lr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&on("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function jm(r,e,t,n={}){var i;const s=(r=Me(r,ml))._getSettings(),c=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==c&&on("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:c,ssl:!1})),n.mockUserToken){let f,p;if("string"==typeof n.mockUserToken)f=n.mockUserToken,p=Ot.MOCK_USER;else{f=(0,Ue.Fy)(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new J(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ot(_)}r._authCredentials=new Ql(new Hl(f,p))}}(this._delegate,e,t,n)}enableNetwork(){return function nv(r){return function Ly(r){return r.asyncQueue.enqueue((0,H.A)(function*(){const e=yield Dm(r),t=yield km(r);return e.setNetworkEnabled(!0),function(i){const s=ie(i);return s.M_.delete(0),pl(s)}(t)}))}(yt(r=Me(r,st)))}(this._delegate)}disableNetwork(){return function rv(r){return function Fy(r){return r.asyncQueue.enqueue((0,H.A)(function*(){const e=yield Dm(r),t=yield km(r);return e.setNetworkEnabled(!1),(n=(0,H.A)(function*(s){const c=ie(s);c.M_.add(0),yield Pa(c),c.N_.set("Offline")}),function i(s){return n.apply(this,arguments)})(t);var n}))}(yt(r=Me(r,st)))}(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Fm("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function tv(r){return function(t){const n=new Pt;return t.asyncQueue.enqueueAndForget((0,H.A)(function*(){return function Iy(r,e){return Lf.apply(this,arguments)}(yield sp(t),n)})),n.promise}(yt(r=Me(r,st)))}(this._delegate)}onSnapshotsInSync(e){return function Dv(r,e){return function zy(r,e){const t=new Ed(e);return r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return i=yield Ba(r),s=t,ie(i).z_.add(s),void s.next();var i,s})),()=>{t.$a(),r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return i=yield Ba(r),s=t,void ie(i).z_.delete(s);var i,s}))}}(yt(r=Me(r,st)),lp(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new J("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ja(this,qm(this._delegate,e))}catch(t){throw An(t,"collection()","Firestore.collection()")}}doc(e){try{return new ir(this,Cd(this._delegate,e))}catch(t){throw An(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new bn(this,function Wy(r,e){if(r=Me(r,ml),ap("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new J(z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new tn(r,null,(n=e,new On(Oe.emptyPath(),n)));var n}(this._delegate,e))}catch(t){throw An(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function zv(r,e,t){r=Me(r,st);const n=Object.assign(Object.assign({},Bv),t);return function(s){if(s.maxAttempts<1)throw new J(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,c,f){const p=new Pt;return s.asyncQueue.enqueueAndForget((0,H.A)(function*(){const _=yield function Om(r){return bd(r).then(e=>e.datastore)}(s);new Vy(s.asyncQueue,_,f,c,p).Xa()})),p.promise}(yt(r),i=>e(new Gv(r,i)),n)}(this._delegate,t=>e(new vg(this,t)))}batch(){return yt(this._delegate),new Ig(new hg(this._delegate,e=>za(this._delegate,e)))}loadBundle(e){return function iv(r,e){const t=yt(r=Me(r,st)),n=new Yy;return function jy(r,e,t,n){const i=function(c,f){let p;return p="string"==typeof c?Du().encode(c):c,v=function(v,T){if(v instanceof Uint8Array)return Pm(v,T);if(v instanceof ArrayBuffer)return Pm(new Uint8Array(v),T);if(v instanceof ReadableStream)return v.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(p),new Oy(v,f);var v}(t,ao(e));r.asyncQueue.enqueueAndForget((0,H.A)(function*(){!function Dy(r,e,t){const n=ie(r);var i;(i=(0,H.A)(function*(c,f,p){try{const _=yield f.getMetadata();if(yield function(Q,ne){const X=ie(Q),me=ft(ne.createTime);return X.persistence.runTransaction("hasNewerBundle","readonly",ye=>X.$r.getBundleMetadata(ye,ne.id)).then(ye=>!!ye&&ye.createTime.compareTo(me)>=0)}(c.localStore,_))return yield f.close(),p._completeWith({taskState:"Success",documentsLoaded:(Q=_).totalDocuments,bytesLoaded:Q.totalBytes,totalDocuments:Q.totalDocuments,totalBytes:Q.totalBytes}),Promise.resolve(new Set);p._updateProgress(ym(_));const v=new cy(_,c.localStore,f.serializer);let T=yield f.qa();for(;T;){const L=yield v._a(T);L&&p._updateProgress(L),T=yield f.qa()}const S=yield v.complete();return yield Ci(c,S.ca,void 0),yield function(Q,ne){const X=ie(Q);return X.persistence.runTransaction("Save bundle","readwrite",me=>X.$r.saveBundleMetadata(me,ne))}(c.localStore,_),p._completeWith(S.progress),Promise.resolve(S.ua)}catch(_){return on("SyncEngine",`Loading bundle failed with ${_}`),p._failWith(_),Promise.resolve(new Set)}var Q}),function s(c,f,p){return i.apply(this,arguments)})(n,e,t).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}(yield sp(r),i,n)}))}(t,r._databaseId,e,n),n}(this._delegate,e)}namedQuery(e){return function sv(r,e){return function qy(r,e){return r.asyncQueue.enqueue((0,H.A)(function*(){return function(n,i){const s=ie(n);return s.persistence.runTransaction("Get named query","readonly",c=>s.$r.getNamedQuery(c,i))}(yield Ua(r),e)}))}(yt(r=Me(r,st)),e).then(t=>t?new tn(r,null,t.query):null)}(this._delegate,e).then(t=>t?new bn(this,t):null)}}class Fd extends vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Al(new Yr(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ir.forKey(t,this.firestore,null)}}class vg{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Fd(e)}get(e){const t=po(e);return this._delegate.get(t).then(n=>new bl(this._firestore,new Ri(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const i=po(e);return n?(Ep("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){const s=po(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){const t=po(e);return this._delegate.delete(t),this}}class Ig{constructor(e){this._delegate=e}set(e,t,n){const i=po(e);return n?(Ep("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){const s=po(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){const t=po(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class fo{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new El(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new wl(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=fo.INSTANCES;let i=n.get(e);i||(i=new WeakMap,n.set(e,i));let s=i.get(t);return s||(s=new fo(e,new Fd(e),t),i.set(t,s)),s}}fo.INSTANCES=new WeakMap;class ir{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fd(e)}static forPath(e,t,n){if(e.length%2!=0)throw new J("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ir(t,new pt(t._delegate,n,new ae(e)))}static forKey(e,t,n){return new ir(t,new pt(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new ja(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ja(this.firestore,qm(this._delegate,e))}catch(t){throw An(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Ue.Ku)(e))instanceof pt&&$m(this._delegate,e)}set(e,t){t=Ep("DocumentReference.set",t);try{return t?lg(this._delegate,e,t):lg(this._delegate,e)}catch(n){throw An(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?ug(this._delegate,e):ug(this._delegate,e,t,...n)}catch(i){throw An(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Pv(r){return za(Me(r.firestore,st),[new Gr(r._key,ht.none())])}(this._delegate)}onSnapshot(...e){const t=Tg(e),n=Eg(e,i=>new bl(this.firestore,new Ri(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return dg(this._delegate,t,n)}get(e){let t;return t="cache"===e?.source?function bv(r){r=Me(r,pt);const e=Me(r.firestore,st),t=yt(e),n=new ms(e);return function Uy(r,e){const t=new Pt;return r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return(n=(0,H.A)(function*(s,c,f){try{const p=yield function(v,T){const S=ie(v);return S.persistence.runTransaction("read document","readonly",L=>S.localDocuments.getDocument(L,T))}(s,c);p.isFoundDocument()?f.resolve(p):p.isNoDocument()?f.resolve(null):f.reject(new J(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(p){const _=Oa(p,`Failed to get document '${c} from cache`);f.reject(_)}}),function i(s,c,f){return n.apply(this,arguments)})(yield Ua(r),e,t);var n})),t.promise}(t,r._key).then(i=>new Ri(e,n,r._key,i,new ho(null!==i&&i.hasLocalMutations,!0),r.converter))}(this._delegate):"server"===e?.source?function wv(r){r=Me(r,pt);const e=Me(r.firestore,st);return Nm(yt(e),r._key,{source:"server"}).then(t=>Ip(e,r,t))}(this._delegate):function Av(r){r=Me(r,pt);const e=Me(r.firestore,st);return Nm(yt(e),r._key).then(t=>Ip(e,r,t))}(this._delegate),t.then(n=>new bl(this.firestore,new Ri(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new ir(this.firestore,this._delegate.withConverter(e?fo.getInstance(this.firestore,e):null))}}function An(r,e,t){return r.message=r.message.replace(e,t),r}function Tg(r){for(const e of r)if("object"==typeof e&&!Ap(e))return e;return{}}function Eg(r,e){var t,n;let i;return i=Ap(r[0])?r[0]:Ap(r[1])?r[1]:"function"==typeof r[0]?{next:r[0],error:r[1],complete:r[2]}:{next:r[1],error:r[2],complete:r[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(n=i.complete)||void 0===n?void 0:n.bind(i)}}class bl{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ir(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return cg(this._delegate,e._delegate)}}class wl extends bl{data(e){const t=this._delegate.data(e);return this._delegate._converter||function xs(r,e){r||pe()}(void 0!==t),t}}class bn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Fd(e)}where(e,t,n){try{return new bn(this.firestore,fs(this._delegate,function hv(r,e,t){const n=e,i=kd("where",r);return Tl._create(i,n,t)}(e,t,n)))}catch(i){throw An(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new bn(this.firestore,fs(this._delegate,function fv(r,e="asc"){const t=e,n=kd("orderBy",r);return yp._create(n,t)}(e,t)))}catch(n){throw An(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new bn(this.firestore,fs(this._delegate,function pv(r){return Gm("limit",r),Od._create("limit",r,"F")}(e)))}catch(t){throw An(t,"limit()","Query.limit()")}}limitToLast(e){try{return new bn(this.firestore,fs(this._delegate,function mv(r){return Gm("limitToLast",r),Od._create("limitToLast",r,"L")}(e)))}catch(t){throw An(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new bn(this.firestore,fs(this._delegate,function gv(...r){return Nd._create("startAt",r,!0)}(...e)))}catch(t){throw An(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new bn(this.firestore,fs(this._delegate,function _v(...r){return Nd._create("startAfter",r,!1)}(...e)))}catch(t){throw An(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new bn(this.firestore,fs(this._delegate,function yv(...r){return Vd._create("endBefore",r,!1)}(...e)))}catch(t){throw An(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new bn(this.firestore,fs(this._delegate,function vv(...r){return Vd._create("endAt",r,!0)}(...e)))}catch(t){throw An(t,"endAt()","Query.endAt()")}}isEqual(e){return cp(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Sv(r){r=Me(r,tn);const e=Me(r.firestore,st),t=yt(e),n=new ms(e);return function By(r,e){const t=new Pt;return r.asyncQueue.enqueueAndForget((0,H.A)(function*(){return(n=(0,H.A)(function*(s,c,f){try{const p=yield Ra(s,c,!0),_=new Tm(c,p.hs),v=_.da(p.documents),T=_.applyChanges(v,!1);f.resolve(T.snapshot)}catch(p){const _=Oa(p,`Failed to execute query '${c} against cache`);f.reject(_)}}),function i(s,c,f){return n.apply(this,arguments)})(yield Ua(r),e,t);var n})),t.promise}(t,r._query).then(i=>new ps(e,n,r,i))}(this._delegate):"server"===e?.source?function Rv(r){r=Me(r,tn);const e=Me(r.firestore,st),t=yt(e),n=new ms(e);return Vm(t,r._query,{source:"server"}).then(i=>new ps(e,n,r,i))}(this._delegate):function Cv(r){r=Me(r,tn);const e=Me(r.firestore,st),t=yt(e),n=new ms(e);return ng(r._query),Vm(t,r._query).then(i=>new ps(e,n,r,i))}(this._delegate),t.then(n=>new bp(this.firestore,new ps(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=Tg(e),n=Eg(e,i=>new bp(this.firestore,new ps(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return dg(this._delegate,t,n)}withConverter(e){return new bn(this.firestore,this._delegate.withConverter(e?fo.getInstance(this.firestore,e):null))}}class e0{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new wl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class bp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new bn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new wl(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new e0(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new wl(this._firestore,n))})}isEqual(e){return cg(this._delegate,e._delegate)}}class ja extends bn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ir(this.firestore,e):null}doc(e){try{return new ir(this.firestore,void 0===e?Cd(this._delegate):Cd(this._delegate,e))}catch(t){throw An(t,"doc()","CollectionReference.doc()")}}add(e){return function xv(r,e){const t=Me(r.firestore,st),n=Cd(r),i=Md(r.converter,e);return za(t,[Pd(lo(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,ht.exists(!1))]).then(()=>n)}(this._delegate,e).then(t=>new ir(this.firestore,t))}isEqual(e){return $m(this._delegate,e._delegate)}withConverter(e){return new ja(this.firestore,this._delegate.withConverter(e?fo.getInstance(this.firestore,e):null))}}function po(r){return Me(r,pt)}class wp{constructor(...e){this._delegate=new Si(...e)}static documentId(){return new wp(at.keyField().canonicalString())}isEqual(e){return(e=(0,Ue.Ku)(e))instanceof Si&&this._delegate._internalPath.isEqual(e._internalPath)}}class mo{constructor(e){this._delegate=e}static serverTimestamp(){const e=function qv(){return new up("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new mo(e)}static delete(){const e=function jv(){return new _l("deleteField")}();return e._methodName="FieldValue.delete",new mo(e)}static arrayUnion(...e){const t=function $v(...r){return new dp("arrayUnion",r)}(...e);return t._methodName="FieldValue.arrayUnion",new mo(t)}static arrayRemove(...e){const t=function Kv(...r){return new hp("arrayRemove",r)}(...e);return t._methodName="FieldValue.arrayRemove",new mo(t)}static increment(e){const t=function Hv(r){return new fp("increment",r)}(e);return t._methodName="FieldValue.increment",new mo(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const t0={Firestore:yg,GeoPoint:Sd,Timestamp:rt,Blob:Al,Transaction:vg,WriteBatch:Ig,DocumentReference:ir,DocumentSnapshot:bl,Query:bn,QueryDocumentSnapshot:wl,QuerySnapshot:bp,CollectionReference:ja,FieldPath:wp,FieldValue:mo,setLogLevel:function Zv(r){!function ih(r){Dr.setLogLevel(r)}(r)},CACHE_SIZE_UNLIMITED:-1};function Ag(r,e){return function s0(r,e=Sn.E){return new Cr.c(t=>{let n;return null!=e?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}(r,e)}function Cp(r,e){return Ag(r,e).pipe((0,Ae.T)(t=>({payload:t,type:"query"})))}!function r0(r){(function n0(r,e){r.INTERNAL.registerComponent(new Pr.uA("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},t0)))})(r,(e,t)=>new yg(e,t,new Jv)),r.registerVersion("@firebase/firestore-compat","0.3.32")}(Yt.A);class bg{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const n=this.ref.collection(e),{ref:i,query:s}=xg(n,t);return new Sg(i,s,this.afs)}snapshotChanges(){return function o0(r,e){return Ag(r,e).pipe((0,xe.Z)(void 0),Rr(),(0,Ae.T)(t=>{const[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Lt)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ae.T)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,Pn.H)(this.ref.get(e)).pipe(Lt)}}function Ud(r,e){return Cp(r,e).pipe((0,xe.Z)(void 0),Rr(),(0,Ae.T)(t=>{const[n,i]=t,s=i.payload.docChanges(),c=s.map(f=>({type:f.type,payload:f}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((f,p)=>{const _=s.find(T=>T.doc.ref.isEqual(f.ref)),v=n?.payload.docs.find(T=>T.ref.isEqual(f.ref));_&&JSON.stringify(_.doc.metadata)===JSON.stringify(f.metadata)||!_&&v&&JSON.stringify(v.metadata)===JSON.stringify(f.metadata)||c.push({type:"modified",payload:{oldIndex:p,newIndex:p,type:"modified",doc:f}})}),c}))}function wg(r,e,t){return Ud(r,t).pipe((0,ei.S)((n,i)=>function a0(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=function c0(r,e){switch(e.type){case"added":if(!r[e.newIndex]||!r[e.newIndex].doc.ref.isEqual(e.doc.ref))return Sp(r,e.newIndex,0,e);break;case"modified":if(null==r[e.oldIndex]||r[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Sp(r,e.newIndex,1,e)}break;case"removed":if(r[e.oldIndex]&&r[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Sp(r,e.oldIndex,1)}return r}(r,n))}),r}(n,i.map(s=>s.payload),e),[]),(0,wo.F)(),(0,Ae.T)(n=>n.map(i=>({type:i.type,payload:i}))))}function Sp(r,e,t,...n){const i=r.slice();return i.splice(e,t,...n),i}function Cg(r){return(!r||0===r.length)&&(r=["added","removed","modified"]),r}class Sg{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=Ud(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ae.T)(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,xe.Z)(void 0),Rr(),(0,R.p)(([n,i])=>i.length>0||!n),(0,Ae.T)(([,n])=>n),Lt)}auditTrail(e){return this.stateChanges(e).pipe((0,ei.S)((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=Cg(e);return wg(this.query,t,this.afs.schedulers.outsideAngular).pipe(Lt)}valueChanges(e={}){return Cp(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ae.T)(t=>t.payload.docs.map(n=>e.idField?{...n.data(),[e.idField]:n.id}:n.data())),Lt)}get(e){return(0,Pn.H)(this.query.get(e)).pipe(Lt)}add(e){return this.ref.add(e)}doc(e){return new bg(this.ref.doc(e),this.afs)}}class l0{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Ud(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ae.T)(t=>t.filter(n=>e.indexOf(n.type)>-1)),(0,R.p)(t=>t.length>0),Lt):Ud(this.query,this.afs.schedulers.outsideAngular).pipe(Lt)}auditTrail(e){return this.stateChanges(e).pipe((0,ei.S)((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=Cg(e);return wg(this.query,t,this.afs.schedulers.outsideAngular).pipe(Lt)}valueChanges(e={}){return Cp(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ae.T)(n=>n.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),Lt)}get(e){return(0,Pn.H)(this.query.get(e)).pipe(Lt)}}const Rg=new d.nKC("angularfire2.enableFirestorePersistence"),Pg=new d.nKC("angularfire2.firestore.persistenceSettings"),u0=new d.nKC("angularfire2.firestore.settings"),d0=new d.nKC("angularfire2.firestore.use-emulator");function xg(r,e=(t=>t)){return{query:e(r),ref:r}}let Dg=(()=>{class r{schedulers;firestore;persistenceEnabled$;constructor(t,n,i,s,c,f,p,_,v,T,S,L,Q,ne,X,me,ye){this.schedulers=p;const oe=_n(t,f,n),Ie=v;T&&Ke(oe,f,S,Q,ne,X,L,me),[this.firestore,this.persistenceEnabled$]=Zr(`${oe.name}.firestore`,"AngularFirestore",oe.name,()=>{const Pe=f.runOutsideAngular(()=>oe.firestore());if(s&&Pe.settings(s),Ie&&Pe.useEmulator(...Ie),i&&!(0,A.Vy)(c)){const ke=()=>{try{return(0,Pn.H)(Pe.enablePersistence(_||void 0).then(()=>!0,()=>!1))}catch(k){return typeof console<"u"&&console.warn(k),(0,Et.of)(!1)}};return[Pe,f.runOutsideAngular(ke)]}return[Pe,(0,Et.of)(!1)]},[s,Ie,i])}collection(t,n){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:c}=xg(i,n),f=this.schedulers.ngZone.run(()=>s);return new Sg(f,c,this)}collectionGroup(t,n){const i=n||(c=>c),s=this.firestore.collectionGroup(t);return new l0(i(s),this)}doc(t){let n;n="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>n);return new bg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(d.KVO(rn),d.KVO(sn,8),d.KVO(Rg,8),d.KVO(u0,8),d.KVO(d.Agw),d.KVO(d.SKi),d.KVO(Mt),d.KVO(Pg,8),d.KVO(d0,8),d.KVO(Ft,8),d.KVO(D,8),d.KVO(Y,8),d.KVO(B,8),d.KVO(fe,8),d.KVO(Te,8),d.KVO(Ye,8),d.KVO(Ge,8))};static \u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})(),h0=(()=>{class r{constructor(){Yt.A.registerVersion("angularfire",sr.full,"fst-compat")}static enablePersistence(t){return{ngModule:r,providers:[{provide:Rg,useValue:!0},{provide:Pg,useValue:t}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({providers:[Dg]})}return r})(),kg=(()=>{class r{constructor(t){this.db=t,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(t){return this.puzzleDataRef.add({...t})}update(t,n){return this.puzzleDataRef.doc(t).update(n)}delete(t){return this.puzzleDataRef.doc(t).delete()}static#e=this.\u0275fac=function(n){return new(n||r)(d.KVO(Dg))};static#t=this.\u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Og=(()=>{class r{constructor(){this.subjectItemUpdate=new Vt.B}updatePerformedItem(t){this.subjectItemUpdate.next(t)}getUpdatedStageLevel(){return this.subjectItemUpdate.asObservable()}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var We=le(9969),qa=le(461);let Rp=(()=>{class r extends qa.h{static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["CheckIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0),d.nrm(1,"path",1),d.k0s()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return r})();var Mn=le(4420);let Pp=(()=>{class r extends qa.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Mn._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0)(1,"g"),d.nrm(2,"path",1)(3,"path",2)(4,"path",3),d.k0s(),d.j41(5,"defs")(6,"clipPath",4),d.nrm(7,"rect",5),d.k0s()()()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.R7$(),d.BMQ("clip-path",i.pathId),d.R7$(5),d.Y8G("id",i.pathId))},encapsulation:2})}return r})(),xp=(()=>{class r extends qa.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Mn._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["InfoCircleIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0)(1,"g"),d.nrm(2,"path",1),d.k0s(),d.j41(3,"defs")(4,"clipPath",2),d.nrm(5,"rect",3),d.k0s()()()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.R7$(),d.BMQ("clip-path",i.pathId),d.R7$(3),d.Y8G("id",i.pathId))},encapsulation:2})}return r})();var Cl=le(1512);let Dp=(()=>{class r extends qa.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Mn._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["TimesCircleIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0)(1,"g"),d.nrm(2,"path",1),d.k0s(),d.j41(3,"defs")(4,"clipPath",2),d.nrm(5,"rect",3),d.k0s()()()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.R7$(),d.BMQ("clip-path",i.pathId),d.R7$(3),d.Y8G("id",i.pathId))},encapsulation:2})}return r})();var Sl=le(563),je=le(1455);const Ng=["container"],f0=r=>[r,"p-toast-message"],p0=(r,e,t,n)=>({showTransformParams:r,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:n}),m0=r=>({value:"visible",params:r}),g0=(r,e)=>({$implicit:r,closeFn:e}),_0=r=>({$implicit:r});function y0(r,e){1&r&&d.eu8(0)}function v0(r,e){if(1&r&&(d.qex(0),d.DNE(1,y0,1,0,"ng-container",4),d.bVm()),2&r){const t=d.XpG();d.R7$(),d.Y8G("ngTemplateOutlet",t.headlessTemplate)("ngTemplateOutletContext",d.l_i(2,g0,t.message,t.onCloseIconClick))}}function I0(r,e){if(1&r&&d.nrm(0,"span"),2&r){const t=d.XpG(3);d.HbH("p-toast-message-icon pi "+t.message.icon)}}function T0(r,e){1&r&&d.nrm(0,"CheckIcon"),2&r&&d.BMQ("aria-hidden",!0)("data-pc-section","icon")}function E0(r,e){1&r&&d.nrm(0,"InfoCircleIcon"),2&r&&d.BMQ("aria-hidden",!0)("data-pc-section","icon")}function A0(r,e){1&r&&d.nrm(0,"TimesCircleIcon"),2&r&&d.BMQ("aria-hidden",!0)("data-pc-section","icon")}function b0(r,e){1&r&&d.nrm(0,"ExclamationTriangleIcon"),2&r&&d.BMQ("aria-hidden",!0)("data-pc-section","icon")}function w0(r,e){if(1&r&&(d.j41(0,"span",13),d.qex(1),d.DNE(2,T0,1,2,"CheckIcon",6)(3,E0,1,2,"InfoCircleIcon",6)(4,A0,1,2,"TimesCircleIcon",6)(5,b0,1,2,"ExclamationTriangleIcon",6),d.bVm(),d.k0s()),2&r){const t=d.XpG(3);d.BMQ("aria-hidden",!0)("data-pc-section","icon"),d.R7$(2),d.Y8G("ngIf","success"===t.message.severity),d.R7$(),d.Y8G("ngIf","info"===t.message.severity),d.R7$(),d.Y8G("ngIf","error"===t.message.severity),d.R7$(),d.Y8G("ngIf","warn"===t.message.severity)}}function C0(r,e){if(1&r&&(d.qex(0),d.DNE(1,I0,1,2,"span",8)(2,w0,6,6,"span",9),d.j41(3,"div",10)(4,"div",11),d.EFF(5),d.k0s(),d.j41(6,"div",12),d.EFF(7),d.k0s()(),d.bVm()),2&r){const t=d.XpG(2);d.R7$(),d.Y8G("ngIf",t.message.icon),d.R7$(),d.Y8G("ngIf",!t.message.icon),d.R7$(),d.BMQ("data-pc-section","text"),d.R7$(),d.BMQ("data-pc-section","summary"),d.R7$(),d.JRh(t.message.summary),d.R7$(),d.BMQ("data-pc-section","detail"),d.R7$(),d.JRh(t.message.detail)}}function S0(r,e){1&r&&d.eu8(0)}function R0(r,e){if(1&r&&d.nrm(0,"span"),2&r){const t=d.XpG(3);d.HbH("pt-1 text-base p-toast-message-icon pi "+t.message.closeIcon)}}function P0(r,e){1&r&&d.nrm(0,"TimesIcon",16),2&r&&(d.Y8G("styleClass","p-toast-icon-close-icon"),d.BMQ("aria-hidden",!0)("data-pc-section","closeicon"))}function x0(r,e){if(1&r){const t=d.RV6();d.j41(0,"button",14),d.bIt("click",function(i){d.eBV(t);const s=d.XpG(2);return d.Njj(s.onCloseIconClick(i))})("keydown.enter",function(i){d.eBV(t);const s=d.XpG(2);return d.Njj(s.onCloseIconClick(i))}),d.DNE(1,R0,1,2,"span",8)(2,P0,1,3,"TimesIcon",15),d.k0s()}if(2&r){const t=d.XpG(2);d.BMQ("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),d.R7$(),d.Y8G("ngIf",t.message.closeIcon),d.R7$(),d.Y8G("ngIf",!t.message.closeIcon)}}function D0(r,e){if(1&r&&(d.j41(0,"div",5),d.DNE(1,C0,8,7,"ng-container",6)(2,S0,1,0,"ng-container",4)(3,x0,3,4,"button",7),d.k0s()),2&r){const t=d.XpG();d.Y8G("ngClass",null==t.message?null:t.message.contentStyleClass),d.BMQ("data-pc-section","content"),d.R7$(),d.Y8G("ngIf",!t.template),d.R7$(),d.Y8G("ngTemplateOutlet",t.template)("ngTemplateOutletContext",d.eq3(6,_0,t.message)),d.R7$(),d.Y8G("ngIf",!1!==(null==t.message?null:t.message.closable))}}function k0(r,e){if(1&r){const t=d.RV6();d.j41(0,"p-toastItem",3),d.bIt("onClose",function(i){d.eBV(t);const s=d.XpG();return d.Njj(s.onMessageClose(i))})("@toastAnimation.start",function(i){d.eBV(t);const s=d.XpG();return d.Njj(s.onAnimationStart(i))})("@toastAnimation.done",function(i){d.eBV(t);const s=d.XpG();return d.Njj(s.onAnimationEnd(i))}),d.k0s()}if(2&r){const t=e.$implicit,n=e.index,i=d.XpG();d.Y8G("message",t)("index",n)("life",i.life)("template",i.template)("headlessTemplate",i.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",i.showTransformOptions)("hideTransformOptions",i.hideTransformOptions)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}}let O0=(()=>{class r{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new d.bkB;containerViewChild;timeout;constructor(t,n){this.zone=t,this.config=n}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=t=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(n){return new(n||r)(d.rXU(d.SKi),d.rXU($.r1))};static \u0275cmp=d.VBU({type:r,selectors:[["p-toastItem"]],viewQuery:function(n,i){if(1&n&&d.GBs(Ng,5),2&n){let s;d.mGM(s=d.lsd())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",d.Udg],life:[2,"life","life",d.Udg],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[d.GFd],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(n,i){if(1&n){const s=d.RV6();d.j41(0,"div",2,0),d.bIt("mouseenter",function(){return d.eBV(s),d.Njj(i.onMouseEnter())})("mouseleave",function(){return d.eBV(s),d.Njj(i.onMouseLeave())}),d.DNE(2,v0,2,5,"ng-container",3)(3,D0,4,8,"ng-template",null,1,d.C5r),d.k0s()}if(2&n){const s=d.sdS(4);d.HbH(null==i.message?null:i.message.styleClass),d.Y8G("ngClass",d.eq3(9,f0,"p-toast-message-"+(null==i.message?null:i.message.severity)))("@messageState",d.eq3(16,m0,d.ziG(11,p0,i.showTransformOptions,i.hideTransformOptions,i.showTransitionOptions,i.hideTransitionOptions))),d.BMQ("id",null==i.message?null:i.message.id)("data-pc-name","toast")("data-pc-section","root"),d.R7$(2),d.Y8G("ngIf",i.headlessTemplate)("ngIfElse",s)}},dependencies:()=>[A.YU,A.bT,A.T3,Sl.n,Rp,xp,Dp,Pp,Cl.A],encapsulation:2,data:{animation:[(0,We.hZ)("messageState",[(0,We.wk)("visible",(0,We.iF)({transform:"translateY(0)",opacity:1})),(0,We.kY)("void => *",[(0,We.iF)({transform:"{{showTransformParams}}",opacity:0}),(0,We.i0)("{{showTransitionParams}}")]),(0,We.kY)("* => void",[(0,We.i0)("{{hideTransitionParams}}",(0,We.iF)({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return r})(),N0=(()=>{class r{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new d.bkB;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(t,n,i,s,c){this.document=t,this.renderer=n,this.messageService=i,this.cd=s,this.config=c}styleElement;id=(0,Mn._Y)();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){const n=t.filter(i=>this.canAdd(i));this.add(n)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let n=this.key===t.key;return n&&this.preventOpenDuplicates&&(n=!this.containsMessage(this.messages,t)),n&&this.preventDuplicates&&(n=!this.containsMessage(this.messagesArchieve,t)),n}containsMessage(t,n){return!!t&&null!=t.find(i=>i.summary===n.summary&&i.detail==n.detail&&i.severity===n.severity)}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"message":default:this.template=t.template;break;case"headless":this.headlessTemplate=t.template}})}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){"void"===t.fromState&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&""===this.containerViewChild?.nativeElement.style.zIndex&&Mn.Q$.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){"void"===t.toState&&this.autoZIndex&&Mn.BF.isEmpty(this.messages)&&Mn.Q$.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let n in this.breakpoints){let i="";for(let s in this.breakpoints[n])i+=s+":"+this.breakpoints[n][s]+" !important;";t+=`\n                    @media screen and (max-width: ${n}) {\n                        .p-toast[${this.id}] {\n                           ${i}\n                        }\n                    }\n                `}this.renderer.setProperty(this.styleElement,"innerHTML",t),je.D.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Mn.Q$.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(n){return new(n||r)(d.rXU(A.qQ),d.rXU(d.sFG),d.rXU($.bg),d.rXU(d.gRc),d.rXU($.r1))};static \u0275cmp=d.VBU({type:r,selectors:[["p-toast"]],contentQueries:function(n,i,s){if(1&n&&d.wni(s,$.Ei,4),2&n){let c;d.mGM(c=d.lsd())&&(i.templates=c)}},viewQuery:function(n,i){if(1&n&&d.GBs(Ng,5),2&n){let s;d.mGM(s=d.lsd())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",d.L39],baseZIndex:[2,"baseZIndex","baseZIndex",d.Udg],life:[2,"life","life",d.Udg],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",d.L39],preventDuplicates:[2,"preventDuplicates","preventDuplicates",d.L39],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[d.GFd],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(n,i){1&n&&(d.j41(0,"div",1,0),d.DNE(2,k0,1,10,"p-toastItem",2),d.k0s()),2&n&&(d.HbH(i.styleClass),d.Y8G("ngClass","p-toast-"+i._position)("ngStyle",i.style),d.R7$(2),d.Y8G("ngForOf",i.messages))},dependencies:[A.YU,A.Sq,A.B3,O0],styles:["@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}\n"],encapsulation:2,data:{animation:[(0,We.hZ)("toastAnimation",[(0,We.kY)(":enter, :leave",[(0,We.P)("@*",(0,We.MA)())])])]},changeDetection:0})}return r})(),V0=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({imports:[A.MD,Sl.Z,Rp,xp,Dp,Pp,Cl.A,$.Gg]})}return r})(),M0=(()=>{class r{pFocusTrapDisabled=!1;platformId=(0,d.WQX)(d.Agw);host=(0,d.WQX)(d.aKT);document=(0,d.WQX)(A.qQ);firstHiddenFocusableElement;lastHiddenFocusableElement;ngOnInit(){(0,A.UE)(this.platformId)&&!this.pFocusTrapDisabled&&!this.firstHiddenFocusableElement&&!this.lastHiddenFocusableElement&&this.createHiddenFocusableElements()}ngOnChanges(t){t.pFocusTrapDisabled&&(0,A.UE)(this.platformId)&&(t.pFocusTrapDisabled.currentValue?this.removeHiddenFocusableElements():this.createHiddenFocusableElements())}removeHiddenFocusableElements(){this.firstHiddenFocusableElement&&this.firstHiddenFocusableElement.parentNode&&this.firstHiddenFocusableElement.parentNode.removeChild(this.firstHiddenFocusableElement),this.lastHiddenFocusableElement&&this.lastHiddenFocusableElement.parentNode&&this.lastHiddenFocusableElement.parentNode.removeChild(this.lastHiddenFocusableElement)}getComputedSelector(t){return`:not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])${t??""}`}createHiddenFocusableElements(){const n=i=>je.D.createElement("span",{class:"p-hidden-accessible p-hidden-focusable",tabindex:"0",role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:i?.bind(this)});this.firstHiddenFocusableElement=n(this.onFirstHiddenElementFocus),this.lastHiddenFocusableElement=n(this.onLastHiddenElementFocus),this.firstHiddenFocusableElement.setAttribute("data-pc-section","firstfocusableelement"),this.lastHiddenFocusableElement.setAttribute("data-pc-section","lastfocusableelement"),this.host.nativeElement.prepend(this.firstHiddenFocusableElement),this.host.nativeElement.append(this.lastHiddenFocusableElement)}onFirstHiddenElementFocus(t){const{currentTarget:n,relatedTarget:i}=t,s=i!==this.lastHiddenFocusableElement&&this.host.nativeElement?.contains(i)?this.lastHiddenFocusableElement:je.D.getFirstFocusableElement(n.parentElement,":not(.p-hidden-focusable)");je.D.focus(s)}onLastHiddenElementFocus(t){const{currentTarget:n,relatedTarget:i}=t,s=i!==this.firstHiddenFocusableElement&&this.host.nativeElement?.contains(i)?this.firstHiddenFocusableElement:je.D.getLastFocusableElement(n.parentElement,":not(.p-hidden-focusable)");je.D.focus(s)}static \u0275fac=function(n){return new(n||r)};static \u0275dir=d.FsC({type:r,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],inputs:{pFocusTrapDisabled:[2,"pFocusTrapDisabled","pFocusTrapDisabled",d.L39]},features:[d.GFd,d.OA$]})}return r})(),L0=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({imports:[A.MD]})}return r})(),Vg=(()=>{class r extends qa.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Mn._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0)(1,"g"),d.nrm(2,"path",1),d.k0s(),d.j41(3,"defs")(4,"clipPath",2),d.nrm(5,"rect",3),d.k0s()()()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.R7$(),d.BMQ("clip-path",i.pathId),d.R7$(3),d.Y8G("id",i.pathId))},encapsulation:2})}return r})(),Mg=(()=>{class r extends qa.h{pathId;ngOnInit(){this.pathId="url(#"+(0,Mn._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=d.xGo(r)))(i||r)}})();static \u0275cmp=d.VBU({type:r,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[d.Vt3,d.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){1&n&&(d.qSk(),d.j41(0,"svg",0)(1,"g"),d.nrm(2,"path",1),d.k0s(),d.j41(3,"defs")(4,"clipPath",2),d.nrm(5,"rect",3),d.k0s()()()),2&n&&(d.HbH(i.getClassNames()),d.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),d.R7$(),d.BMQ("clip-path",i.pathId),d.R7$(3),d.Y8G("id",i.pathId))},encapsulation:2})}return r})();var Lg=le(2796);const F0=["titlebar"],U0=["content"],B0=["footer"],G0=["*",[["p-header"]],[["p-footer"]]],z0=["*","p-header","p-footer"],j0=(r,e,t,n,i,s,c,f,p,_)=>({"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":r,"p-dialog-mask-scrollblocker":e,"p-dialog-left":t,"p-dialog-right":n,"p-dialog-top":i,"p-dialog-top-left":s,"p-dialog-top-right":c,"p-dialog-bottom":f,"p-dialog-bottom-left":p,"p-dialog-bottom-right":_}),q0=(r,e,t,n)=>({"p-dialog p-component":!0,"p-dialog-rtl":r,"p-dialog-draggable":e,"p-dialog-resizable":t,"p-dialog-maximized":n}),$0=(r,e)=>({transform:r,transition:e}),K0=r=>({value:"visible",params:r}),H0=()=>({"p-dialog-header-icon p-dialog-header-maximize p-link":!0}),W0=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0});function Q0(r,e){1&r&&d.eu8(0)}function Y0(r,e){if(1&r&&(d.qex(0),d.DNE(1,Q0,1,0,"ng-container",10),d.bVm()),2&r){const t=d.XpG(3);d.R7$(),d.Y8G("ngTemplateOutlet",t.headlessTemplate)}}function X0(r,e){if(1&r){const t=d.RV6();d.j41(0,"div",15),d.bIt("mousedown",function(i){d.eBV(t);const s=d.XpG(4);return d.Njj(s.initResize(i))}),d.k0s()}}function J0(r,e){if(1&r&&(d.j41(0,"span",21),d.EFF(1),d.k0s()),2&r){const t=d.XpG(5);d.Y8G("id",t.ariaLabelledBy),d.R7$(),d.JRh(t.header)}}function Z0(r,e){if(1&r&&(d.j41(0,"span",21),d.SdG(1,1),d.k0s()),2&r){const t=d.XpG(5);d.Y8G("id",t.ariaLabelledBy)}}function eI(r,e){1&r&&d.eu8(0)}function tI(r,e){if(1&r&&d.nrm(0,"span",25),2&r){const t=d.XpG(6);d.Y8G("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function nI(r,e){1&r&&d.nrm(0,"WindowMaximizeIcon",27),2&r&&d.Y8G("styleClass","p-dialog-header-maximize-icon")}function rI(r,e){1&r&&d.nrm(0,"WindowMinimizeIcon",27),2&r&&d.Y8G("styleClass","p-dialog-header-maximize-icon")}function iI(r,e){if(1&r&&(d.qex(0),d.DNE(1,nI,1,1,"WindowMaximizeIcon",26)(2,rI,1,1,"WindowMinimizeIcon",26),d.bVm()),2&r){const t=d.XpG(6);d.R7$(),d.Y8G("ngIf",!t.maximized&&!t.maximizeIconTemplate),d.R7$(),d.Y8G("ngIf",t.maximized&&!t.minimizeIconTemplate)}}function sI(r,e){}function oI(r,e){1&r&&d.DNE(0,sI,0,0,"ng-template")}function aI(r,e){if(1&r&&(d.qex(0),d.DNE(1,oI,1,0,null,10),d.bVm()),2&r){const t=d.XpG(6);d.R7$(),d.Y8G("ngTemplateOutlet",t.maximizeIconTemplate)}}function cI(r,e){}function lI(r,e){1&r&&d.DNE(0,cI,0,0,"ng-template")}function uI(r,e){if(1&r&&(d.qex(0),d.DNE(1,lI,1,0,null,10),d.bVm()),2&r){const t=d.XpG(6);d.R7$(),d.Y8G("ngTemplateOutlet",t.minimizeIconTemplate)}}function dI(r,e){if(1&r){const t=d.RV6();d.j41(0,"button",22),d.bIt("click",function(){d.eBV(t);const i=d.XpG(5);return d.Njj(i.maximize())})("keydown.enter",function(){d.eBV(t);const i=d.XpG(5);return d.Njj(i.maximize())}),d.DNE(1,tI,1,1,"span",23)(2,iI,3,2,"ng-container",24)(3,aI,2,1,"ng-container",24)(4,uI,2,1,"ng-container",24),d.k0s()}if(2&r){const t=d.XpG(5);d.Y8G("ngClass",d.lJ4(7,H0)),d.BMQ("tabindex",t.maximizable?"0":"-1")("aria-label",t.maximizeLabel),d.R7$(),d.Y8G("ngIf",t.maximizeIcon&&!t.maximizeIconTemplate&&!t.minimizeIconTemplate),d.R7$(),d.Y8G("ngIf",!t.maximizeIcon),d.R7$(),d.Y8G("ngIf",!t.maximized),d.R7$(),d.Y8G("ngIf",t.maximized)}}function hI(r,e){if(1&r&&d.nrm(0,"span",30),2&r){const t=d.XpG(7);d.Y8G("ngClass",t.closeIcon)}}function fI(r,e){1&r&&d.nrm(0,"TimesIcon",27),2&r&&d.Y8G("styleClass","p-dialog-header-close-icon")}function pI(r,e){if(1&r&&(d.qex(0),d.DNE(1,hI,1,1,"span",29)(2,fI,1,1,"TimesIcon",26),d.bVm()),2&r){const t=d.XpG(6);d.R7$(),d.Y8G("ngIf",t.closeIcon),d.R7$(),d.Y8G("ngIf",!t.closeIcon)}}function mI(r,e){}function gI(r,e){1&r&&d.DNE(0,mI,0,0,"ng-template")}function _I(r,e){if(1&r&&(d.j41(0,"span"),d.DNE(1,gI,1,0,null,10),d.k0s()),2&r){const t=d.XpG(6);d.R7$(),d.Y8G("ngTemplateOutlet",t.closeIconTemplate)}}function yI(r,e){if(1&r){const t=d.RV6();d.j41(0,"button",28),d.bIt("click",function(i){d.eBV(t);const s=d.XpG(5);return d.Njj(s.close(i))})("keydown.enter",function(i){d.eBV(t);const s=d.XpG(5);return d.Njj(s.close(i))}),d.DNE(1,pI,3,2,"ng-container",24)(2,_I,2,1,"span",24),d.k0s()}if(2&r){const t=d.XpG(5);d.Y8G("ngClass",d.lJ4(5,W0)),d.BMQ("aria-label",t.closeAriaLabel)("tabindex",t.closeTabindex),d.R7$(),d.Y8G("ngIf",!t.closeIconTemplate),d.R7$(),d.Y8G("ngIf",t.closeIconTemplate)}}function vI(r,e){if(1&r){const t=d.RV6();d.j41(0,"div",16,3),d.bIt("mousedown",function(i){d.eBV(t);const s=d.XpG(4);return d.Njj(s.initDrag(i))}),d.DNE(2,J0,2,2,"span",17)(3,Z0,2,1,"span",17)(4,eI,1,0,"ng-container",10),d.j41(5,"div",18),d.DNE(6,dI,5,8,"button",19)(7,yI,3,6,"button",20),d.k0s()()}if(2&r){const t=d.XpG(4);d.R7$(2),d.Y8G("ngIf",!t.headerFacet&&!t.headerTemplate),d.R7$(),d.Y8G("ngIf",t.headerFacet),d.R7$(),d.Y8G("ngTemplateOutlet",t.headerTemplate),d.R7$(2),d.Y8G("ngIf",t.maximizable),d.R7$(),d.Y8G("ngIf",t.closable)}}function II(r,e){1&r&&d.eu8(0)}function TI(r,e){1&r&&d.eu8(0)}function EI(r,e){if(1&r&&(d.j41(0,"div",31,4),d.SdG(2,2),d.DNE(3,TI,1,0,"ng-container",10),d.k0s()),2&r){const t=d.XpG(4);d.R7$(3),d.Y8G("ngTemplateOutlet",t.footerTemplate)}}function AI(r,e){if(1&r&&(d.DNE(0,X0,1,0,"div",11)(1,vI,8,5,"div",12),d.j41(2,"div",13,2),d.SdG(4),d.DNE(5,II,1,0,"ng-container",10),d.k0s(),d.DNE(6,EI,4,1,"div",14)),2&r){const t=d.XpG(3);d.Y8G("ngIf",t.resizable),d.R7$(),d.Y8G("ngIf",t.showHeader),d.R7$(),d.HbH(t.contentStyleClass),d.Y8G("ngClass","p-dialog-content")("ngStyle",t.contentStyle),d.R7$(3),d.Y8G("ngTemplateOutlet",t.contentTemplate),d.R7$(),d.Y8G("ngIf",t.footerFacet||t.footerTemplate)}}function bI(r,e){if(1&r){const t=d.RV6();d.j41(0,"div",8,0),d.bIt("@animation.start",function(i){d.eBV(t);const s=d.XpG(2);return d.Njj(s.onAnimationStart(i))})("@animation.done",function(i){d.eBV(t);const s=d.XpG(2);return d.Njj(s.onAnimationEnd(i))}),d.DNE(2,Y0,2,1,"ng-container",9)(3,AI,7,8,"ng-template",null,1,d.C5r),d.k0s()}if(2&r){const t=d.sdS(4),n=d.XpG(2);d.HbH(n.styleClass),d.Y8G("ngClass",d.ziG(10,q0,n.rtl,n.draggable,n.resizable,n.maximized))("ngStyle",n.style)("pFocusTrapDisabled",!1===n.focusTrap)("@animation",d.eq3(18,K0,d.l_i(15,$0,n.transformOptions,n.transitionOptions))),d.BMQ("aria-labelledby",n.ariaLabelledBy)("aria-modal",!0),d.R7$(2),d.Y8G("ngIf",n.headlessTemplate)("ngIfElse",t)}}function wI(r,e){if(1&r&&(d.j41(0,"div",6),d.DNE(1,bI,5,20,"div",7),d.k0s()),2&r){const t=d.XpG();d.Aen(t.maskStyle),d.HbH(t.maskStyleClass),d.Y8G("ngClass",d.zJS(6,j0,[t.modal,t.modal||t.blockScroll,"left"===t.position,"right"===t.position,"top"===t.position,"topleft"===t.position||"top-left"===t.position,"topright"===t.position||"top-right"===t.position,"bottom"===t.position,"bottomleft"===t.position||"bottom-left"===t.position,"bottomright"===t.position||"bottom-right"===t.position])),d.R7$(),d.Y8G("ngIf",t.visible)}}const CI=(0,We.lY)([(0,We.iF)({transform:"{{transform}}",opacity:0}),(0,We.i0)("{{transition}}")]),SI=(0,We.lY)([(0,We.i0)("{{transition}}",(0,We.iF)({transform:"{{transform}}",opacity:0}))]);let RI=(()=>{class r{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(t){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(t){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(t){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;maskStyle;showHeader=!0;get breakpoint(){return 649}set breakpoint(t){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="0";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(t){t&&(this._style={...t},this.originalStyle=t)}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onShow=new d.bkB;onHide=new d.bkB;visibleChange=new d.bkB;onResizeInit=new d.bkB;onResizeEnd=new d.bkB;onDragEnd=new d.bkB;onMaximize=new d.bkB;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;headlessTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy=this.getAriaLabelledBy();documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=(0,Mn._Y)();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;get maximizeLabel(){return this.config.getTranslation($.Yj.ARIA).maximizeLabel}constructor(t,n,i,s,c,f,p){this.document=t,this.platformId=n,this.el=i,this.renderer=s,this.zone=c,this.cd=f,this.config=p,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":default:this.contentTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"maximizeicon":this.maximizeIconTemplate=t.template;break;case"minimizeicon":this.minimizeIconTemplate=t.template;break;case"headless":this.headlessTemplate=t.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return null!==this.header?(0,Mn._Y)()+"_header":null}focus(t=this.contentViewChild.nativeElement){let n=je.D.getFocusableElement(t,"[autofocus]");if(n)return void this.zone.runOutsideAngular(()=>{setTimeout(()=>n.focus(),5)});const i=je.D.getFocusableElement(t);i?this.zone.runOutsideAngular(()=>{setTimeout(()=>i.focus(),5)}):this.footerViewChild&&this.focus(this.footerViewChild.nativeElement)}close(t){this.visibleChange.emit(!1),t.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)})),this.modal&&je.D.blockBodyScroll()}disableModality(){if(this.wrapper){this.dismissableMask&&this.unbindMaskClickListener();const t=document.querySelectorAll(".p-dialog-mask-scrollblocker");this.modal&&t&&1==t.length&&je.D.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges()}}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?je.D.blockBodyScroll():je.D.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(Mn.Q$.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if((0,A.UE)(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let n in this.breakpoints)t+=`\n                        @media screen and (max-width: ${n}) {\n                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {\n                                width: ${this.breakpoints[n]} !important;\n                            }\n                        }\n                    `;this.renderer.setProperty(this.styleElement,"innerHTML",t),je.D.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}initDrag(t){je.D.hasClass(t.target,"p-dialog-header-icon")||je.D.hasClass(t.target,"p-dialog-header-close-icon")||je.D.hasClass(t.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,this.container.style.margin="0",je.D.addClass(this.document.body,"p-unselectable-text"))}onDrag(t){if(this.dragging){const n=je.D.getOuterWidth(this.container),i=je.D.getOuterHeight(this.container),s=t.pageX-this.lastPageX,c=t.pageY-this.lastPageY,f=this.container.getBoundingClientRect(),p=getComputedStyle(this.container),_=parseFloat(p.marginLeft),v=parseFloat(p.marginTop),T=f.left+s-_,S=f.top+c-v,L=je.D.getViewport();this.container.style.position="fixed",this.keepInViewport?(T>=this.minX&&T+n<L.width&&(this._style.left=`${T}px`,this.lastPageX=t.pageX,this.container.style.left=`${T}px`),S>=this.minY&&S+i<L.height&&(this._style.top=`${S}px`,this.lastPageY=t.pageY,this.container.style.top=`${S}px`)):(this.lastPageX=t.pageX,this.container.style.left=`${T}px`,this.lastPageY=t.pageY,this.container.style.top=`${S}px`)}}endDrag(t){this.dragging&&(this.dragging=!1,je.D.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(t))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(t){this.resizable&&(this.resizing=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,je.D.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(t))}onResize(t){if(this.resizing){let n=t.pageX-this.lastPageX,i=t.pageY-this.lastPageY,s=je.D.getOuterWidth(this.container),c=je.D.getOuterHeight(this.container),f=je.D.getOuterHeight(this.contentViewChild?.nativeElement),p=s+n,_=c+i,v=this.container.style.minWidth,T=this.container.style.minHeight,S=this.container.getBoundingClientRect(),L=je.D.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(p+=n,_+=i),(!v||p>parseInt(v))&&S.left+p<L.width&&(this._style.width=p+"px",this.container.style.width=this._style.width),(!T||_>parseInt(T))&&S.top+_<L.height&&(this.contentViewChild.nativeElement.style.height=f+_-c+"px",this._style.height&&(this._style.height=_+"px",this.container.style.height=this._style.height)),this.lastPageX=t.pageX,this.lastPageY=t.pageY}}resizeEnd(t){this.resizing&&(this.resizing=!1,je.D.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(t))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",n=>{"Escape"==n.key&&this.close(n)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?this.renderer.appendChild(this.document.body,this.wrapper):je.D.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&je.D.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&je.D.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(t){switch(t.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(je.D.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&je.D.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&Mn.Q$.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(n){return new(n||r)(d.rXU(A.qQ),d.rXU(d.Agw),d.rXU(d.aKT),d.rXU(d.sFG),d.rXU(d.SKi),d.rXU(d.gRc),d.rXU($.r1))};static \u0275cmp=d.VBU({type:r,selectors:[["p-dialog"]],contentQueries:function(n,i,s){if(1&n&&(d.wni(s,$.Y9,5),d.wni(s,$.wi,5),d.wni(s,$.Ei,4)),2&n){let c;d.mGM(c=d.lsd())&&(i.headerFacet=c.first),d.mGM(c=d.lsd())&&(i.footerFacet=c.first),d.mGM(c=d.lsd())&&(i.templates=c)}},viewQuery:function(n,i){if(1&n&&(d.GBs(F0,5),d.GBs(U0,5),d.GBs(B0,5)),2&n){let s;d.mGM(s=d.lsd())&&(i.headerViewChild=s.first),d.mGM(s=d.lsd())&&(i.contentViewChild=s.first),d.mGM(s=d.lsd())&&(i.footerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:[2,"draggable","draggable",d.L39],resizable:[2,"resizable","resizable",d.L39],positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:[2,"modal","modal",d.L39],closeOnEscape:[2,"closeOnEscape","closeOnEscape",d.L39],dismissableMask:[2,"dismissableMask","dismissableMask",d.L39],rtl:[2,"rtl","rtl",d.L39],closable:[2,"closable","closable",d.L39],responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",maskStyle:"maskStyle",showHeader:[2,"showHeader","showHeader",d.L39],breakpoint:"breakpoint",blockScroll:[2,"blockScroll","blockScroll",d.L39],autoZIndex:[2,"autoZIndex","autoZIndex",d.L39],baseZIndex:[2,"baseZIndex","baseZIndex",d.Udg],minX:[2,"minX","minX",d.Udg],minY:[2,"minY","minY",d.Udg],focusOnShow:[2,"focusOnShow","focusOnShow",d.L39],maximizable:[2,"maximizable","maximizable",d.L39],keepInViewport:[2,"keepInViewport","keepInViewport",d.L39],focusTrap:[2,"focusTrap","focusTrap",d.L39],transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},features:[d.GFd],ngContentSelectors:z0,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["content",""],["titlebar",""],["footer",""],[3,"class","style","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","pRipple","","pButton","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","","pButton","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"]],template:function(n,i){1&n&&(d.NAR(G0),d.DNE(0,wI,2,17,"div",5)),2&n&&d.Y8G("ngIf",i.maskVisible)},dependencies:()=>[A.YU,A.bT,A.T3,A.B3,M0,Lg._f,Sl.n,Cl.A,Vg,Mg],styles:["@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{-webkit-transition:none;transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}\n"],encapsulation:2,data:{animation:[(0,We.hZ)("animation",[(0,We.kY)("void => visible",[(0,We.sM)(CI)]),(0,We.kY)("visible => void",[(0,We.sM)(SI)])])]},changeDetection:0})}return r})(),PI=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({imports:[A.MD,L0,Lg.tm,Sl.Z,Cl.A,Vg,Mg,$.Gg]})}return r})();var Bd=le(6038);const xI=(r,e)=>({"stage-level-number-unselected":r,"stage-level-number-selected":e});function DI(r,e){if(1&r){const t=d.RV6();d.j41(0,"div",4),d.bIt("click",function(){d.eBV(t);const i=d.XpG();return d.Njj(i.stageClick())}),d.j41(1,"span",5),d.EFF(2),d.k0s()()}if(2&r){const t=d.XpG();d.R7$(2),d.SpI(" ",t.stageLevel.value," ")}}function kI(r,e){if(1&r&&(d.qex(0,2),d.EFF(1),d.bVm()),2&r){const t=d.XpG();d.R7$(),d.SpI(" ",t.stageLevel.value," ")}}function OI(r,e){1&r&&(d.j41(0,"span",6),d.nrm(1,"i",7),d.k0s())}function NI(r,e){if(1&r&&(d.j41(0,"div",3),d.Z7z(1,OI,2,0,"span",6,d.fX1),d.k0s()),2&r){const t=d.XpG();d.R7$(),d.Dyx(t.stars)}}function VI(r,e){1&r&&(d.j41(0,"span",8),d.nrm(1,"i",7),d.k0s())}function MI(r,e){if(1&r){const t=d.RV6();d.j41(0,"div",4),d.bIt("click",function(){d.eBV(t);const i=d.XpG(2);return d.Njj(i.stageClick())}),d.Z7z(1,VI,2,0,"span",8,d.fX1),d.k0s()}if(2&r){const t=d.XpG(2);d.R7$(),d.Dyx(t.stars)}}function LI(r,e){1&r&&(d.j41(0,"span",9),d.nrm(1,"i",10),d.k0s())}function FI(r,e){if(1&r&&d.Z7z(0,LI,2,0,"span",9,d.fX1),2&r){const t=d.XpG(2);d.Dyx(t.stars)}}function UI(r,e){if(1&r&&(d.j41(0,"div",3),d.DNE(1,MI,3,0,"div")(2,FI,2,0),d.k0s()),2&r){const t=d.XpG();d.R7$(),d.vxM(t.stageLevel.completed?1:2)}}let BI=(()=>{class r{constructor(t){this.stageCommunicationService=t,this.stars=new Array(1,2,3)}stageClick(){this.stageCommunicationService.updatePerformedItem(this.stageLevel),console.log("Stage Clicked")}static#e=this.\u0275fac=function(n){return new(n||r)(d.rXU(Og))};static#t=this.\u0275cmp=d.VBU({type:r,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:7,vars:6,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[1,"disable-stage-click"],[2,"display","flex","justify-content","center"],[3,"click"],[1,"stage-level-completed-value","enable-stage-click"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],[1,"stage-level-asterisk-unselected","stage-level-completed","enable-stage-click"],[1,"stage-level-asterisk-unselected","disable-stage-click"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(n,i){1&n&&(d.j41(0,"div",0)(1,"div",1),d.DNE(2,DI,3,1,"div")(3,kI,2,1,"ng-container",2),d.k0s(),d.j41(4,"div"),d.DNE(5,NI,3,0,"div",3)(6,UI,3,1,"div",3),d.k0s()()),2&n&&(d.R7$(),d.Y8G("ngClass",d.l_i(3,xI,!i.stageLevel.selected,i.stageLevel.selected)),d.R7$(),d.vxM(i.stageLevel.completed?2:3),d.R7$(3),d.vxM(i.stageLevel.selected?5:6))},dependencies:[A.YU,Bd.PW],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .enable-stage-click[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.stage-level-layout[_ngcontent-%COMP%]   .disable-stage-click[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]})}return r})();const GI=(r,e)=>e.index,zI=r=>({"border-bottom":r});function jI(r,e){1&r&&(d.j41(0,"div")(1,"span",2),d.EFF(2,"No stage levels defined!"),d.k0s()())}function qI(r,e){if(1&r&&(d.j41(0,"div",3),d.nrm(1,"app-stage-level",4),d.k0s()),2&r){const t=e.$implicit;d.Y8G("ngStyle",d.eq3(2,zI,t.selected?"none":"1px solid #d4d4d4")),d.R7$(),d.Y8G("stageLevel",t)}}function $I(r,e){if(1&r&&(d.j41(0,"div",1),d.Z7z(1,qI,2,4,"div",3,GI),d.k0s()),2&r){const t=d.XpG();d.R7$(),d.Dyx(t.stageLevels)}}let KI=(()=>{class r{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275cmp=d.VBU({type:r,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:3,vars:1,consts:[[1,"game-stage-level-layout"],[1,"stage-levels"],[1,"warning-message"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(n,i){1&n&&(d.j41(0,"div",0),d.DNE(1,jI,3,0,"div")(2,$I,3,0,"div",1),d.k0s()),2&n&&(d.R7$(),d.vxM(i.NO_STAGE_LEVELS?1:2))},dependencies:[A.B3,Bd.eI,BI],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]})}return r})();class Fg{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}}class Ug{constructor(e,t,n){this.operands=e,this.operator=t,this.result=n}}const HI=(0,We.hZ)("operandButtonAnimationMove",[(0,We.wk)("buttonFromA",(0,We.iF)({left:"{{ posALeft }}",top:"{{ posATop }}",width:"90px",height:"90px"}),{params:{posALeft:"1025px",posATop:"219px"}}),(0,We.wk)("buttonToB",(0,We.iF)({left:"{{ posBLeft }}",top:"{{ posBTop }}",width:"90px",height:"90px"}),{params:{posBLeft:"805px",posBTop:"324px"}}),(0,We.kY)("* => buttonToB",(0,We.i0)("1.5s"))]);var kp=le(9213),WI=le(345);const Bg=(r,e)=>e.id,QI=r=>({"background-color":r});function YI(r,e){if(1&r){const t=d.RV6();d.j41(0,"button",10),d.bIt("click",function(){const i=d.eBV(t).$implicit,s=d.XpG();return d.Njj(s.onOperandButtonClick(i))}),d.EFF(1),d.k0s()}if(2&r){const t=e.$implicit;d.Y8G("disabled",t.disabled)("ngStyle",d.eq3(4,QI,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",t.disabled||t.selected?"operator-content-button-disabled":"operator-content-button"),d.R7$(),d.SpI("",t.value," ")}}function XI(r,e){if(1&r){const t=d.RV6();d.j41(0,"button",11),d.bIt("click",function(){const i=d.eBV(t).$implicit,s=d.XpG();return d.Njj(s.onOperatorButtonClick(i))}),d.nrm(1,"mat-icon",12),d.k0s()}if(2&r){const t=e.$implicit;d.Y8G("ngClass",0===e.$index?"revert-button":"arithmetic-operation-button"),d.R7$(),d.FS9("svgIcon",t.icon)}}let JI=(()=>{class r{constructor(t,n){this.githubLogoPath="assets/logos/GitHub-Mark-32px.png",this.operators=new Array({id:0,selected:!1,caption:Ne.OPERATOR_REV,operator:Ne.OPERATOR_REV,icon:"revert"},{id:1,selected:!1,caption:Ne.OPERATOR_ADD,operator:Ne.OPERATOR_ADD,icon:"addition"},{id:2,selected:!1,caption:Ne.OPERATOR_SUB,operator:Ne.OPERATOR_SUB,icon:"substraction"},{id:3,selected:!1,caption:Ne.OPERATOR_MUL,operator:Ne.OPERATOR_MUL,icon:"multiplication"},{id:4,selected:!1,caption:Ne.OPERATOR_DIV,operator:Ne.OPERATOR_DIV,icon:"division"}),this.expectedResultReached=new d.bkB,this.invalidOperationExecuted=new d.bkB,t.addSvgIcon("revert",n.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),t.addSvgIcon("addition",n.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),t.addSvgIcon("substraction",n.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),t.addSvgIcon("multiplication",n.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),t.addSvgIcon("division",n.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(t=>t.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(t=>{t.selected=!1})}isTheExpectedResultReached(t){return this.gameParameters.result===t}addStateToHistory(t){this.history.push(t)}clearSelectionOfOperators(){this.operators.forEach(t=>{t.selected=!1})}addGameOperationToOperationHistory(t){this.operationHistory?.push(t)}captureAnimationTriggerStartEvent(t){console.log("Animation trigger start ",t)}captureAnimationTriggerDoneEvent(t){console.log("Animation trigger done ",t)}ngOnInit(){this.history=new Fg,this.operationHistory=new Fg}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(t=>{t.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(t){if(t.selected=!t.selected,!t.selected){if(this.selectedOperandB&&this.selectedOperandB.id===t.id)return this.selectedOperandB.selected=!1,void(this.selectedOperandB=null);if(this.selectedOperandA&&this.selectedOperandA.id===t.id)return this.selectedOperandA.selected=!1,void(this.selectedOperandA=null)}this.selectedOperandA?this.selectedOperandA.id!==t.id&&(this.selectedOperandB||(this.selectedOperandB=t)):this.selectedOperandA=t;var n=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!n)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&n){const i=jt.cloneGameParameters(this.gameParameters),s=jt.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,n.operator);if(this.addStateToHistory(i),s===Number.MIN_VALUE)this.invalidOperationExecuted.emit(s);else{const c=new Array(this.selectedOperandA.value,this.selectedOperandB.value),f=new Ug(c,n.operator,s);this.addGameOperationToOperationHistory(f),this.isTheExpectedResultReached(s)&&this.expectedResultReached.emit(this.operationHistory),t.value=s,this.gameParameters.operands.find(_=>_.id==this.selectedOperandA.id).disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${t.value} Selected ${t.selected}`)}onOperatorButtonClick(t){if(this.selectedOperandA||t.operator===Ne.OPERATOR_REV){if(t.selected=!t.selected,t.operator===Ne.OPERATOR_REV){this.revertLastOperation();const n=jt.cloneGameParameters(this.gameParameters),i=new Array;n.operands.forEach(c=>{i.push(c.value)});const s=new Ug(i,t.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(s)}console.log(`Caption ${t.caption} Selected ${t.selected}`)}else t.selected=!1}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}static#e=this.\u0275fac=function(n){return new(n||r)(d.rXU(kp.tp),d.rXU(WI.up))};static#t=this.\u0275cmp=d.VBU({type:r,selectors:[["app-game-arithmetic-operations"]],hostVars:1,hostBindings:function(n,i){1&n&&d.Kam("@operandButtonAnimationMove.start",function(c){return i.captureAnimationTriggerStartEvent(c)})("@operandButtonAnimationMove.done",function(c){return i.captureAnimationTriggerDoneEvent(c)}),2&n&&d.zvX("@operandButtonAnimationMove",i.operandButtonAnimation)},inputs:{gameParameters:"gameParameters"},outputs:{expectedResultReached:"expectedResultReached",invalidOperationExecuted:"invalidOperationExecuted"},decls:15,vars:2,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass"],[1,"operators-container"],["type","button",1,"operator-content",3,"ngClass"],["href","https://github.com/lkovari/LKovariHome/tree/master/src/app/digits/digits-game.component.ts"],["width","16","height","16",3,"src"],["type","button",1,"operand",3,"click","disabled","ngStyle","ngClass"],["type","button",1,"operator-content",3,"click","ngClass"],[1,"operator-content-icon",3,"svgIcon"]],template:function(n,i){1&n&&(d.j41(0,"div",0)(1,"div",1),d.EFF(2,"Use the any combination of number to reach the target:"),d.k0s(),d.j41(3,"div")(4,"label",2),d.EFF(5),d.k0s()(),d.j41(6,"div",3)(7,"div",4),d.Z7z(8,YI,2,6,"button",5,Bg),d.k0s()(),d.j41(10,"div",6),d.Z7z(11,XI,2,2,"button",7,Bg),d.k0s(),d.j41(13,"a",8),d.nrm(14,"img",9),d.k0s()()),2&n&&(d.R7$(5),d.JRh(i.gameParameters.result),d.R7$(3),d.Dyx(i.gameParameters.operands),d.R7$(3),d.Dyx(i.operators),d.R7$(3),d.Y8G("src",i.githubLogoPath,d.B4B))},dependencies:[A.YU,A.B3,Bd.PW,Bd.eI,kp.An],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{justify-content:center;display:flex;flex-direction:row;flex-wrap:wrap;width:371px;margin:7px auto}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"],data:{animation:[HI]}})}return r})();const ZI=["arithmeticOperations"];function eT(r,e){if(1&r&&(d.j41(0,"li",13),d.EFF(1),d.k0s()),2&r){const t=e.$implicit;d.R7$(),d.SpI(" ",t," ")}}function tT(r,e){if(1&r&&(d.j41(0,"li",13),d.EFF(1),d.k0s()),2&r){const t=e.$implicit;d.R7$(),d.SpI(" ",t," ")}}const nT=[{path:"digits/digits-game",component:(()=>{class r{constructor(t,n,i,s,c){this.messageService=t,this.cookieService=n,this.clipboardService=i,this.numbersFirestoreService=s,this.stageCommunicationService=c,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new te,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw",this.destroyRef=(0,d.WQX)(d.abz),this.updateStageLevel=this.stageCommunicationService.getUpdatedStageLevel().pipe((0,Ve.pQ)(this.destroyRef)).subscribe({next:f=>{console.log("StageLevel updated "+f.index)},error:f=>console.error("StageLevel updated "+f),complete:()=>console.info("StageLevel updated Complete")})}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(t){let n="Completed! Executed Operations:\n",i=t.size()-1;for(;i>=0;){const s=t.peekBy(i);n+=i+1+". "+s?.operands[0]+" "+s?.operator+" "+s?.operands[1]+" = "+s?.result+"\n",--i}return n}createSummaryOfTHeOperations(t,n){let i=this.stageLevels[t].value+" -> ";for(this.gameCompletedModalMessages=[];n.size()>0;){const s=n.pop();this.gameCompletedModalMessages.push(s?.operands[0]+" "+s.operator+" "+s?.operands[1]+" = "+s?.result),i+=""+s?.operator}return i+="\n",i}showSuccessMessage(t){this.messageService.add({severity:"success",summary:"Congratulation!",detail:t})}showErrorMessage(t){this.messageService.add({severity:"error",summary:"Error!",detail:t})}setupStages(){let t=0;this.gameParameters.forEach(n=>{this.stageLevels[t].value=n.result,++t})}storeGameStateToCookie(){const t=new re;t.storeDate=new Date,t.stageIndex=this.stageIndex,t.stageLevels=this.stageLevels,t.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,t.gameParameters=this.gameParameters;const n=t.cookieData2Text(),i=new Date;i.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,n,i)}restoreGameStateFromCookie(){const t=this.cookieService.get(this.COOKIE_LK_DIGITS);let n;return t&&""!=t?(n=new re,n=n.text2CookieData(t)):(console.log("INFO: Unable to retrieve the Game State"),n=null),n}mapPuzzleDataToGameParameters(t){t.stages.forEach(n=>{const i=this.gameParameters.find(s=>s.stageIndex===n.stageIndex);if(i){i.result=n.expectedValue;let s=0;i.operands.forEach(f=>{f.value=n.operands[s],s++}),this.initializeStageLevels(),this.stageLevels.find(f=>f.index===n.stageIndex)}})}mapGameParametersToPuzzleData(t){const n=new Qe;return n.day=new Date,n.day.setHours(23,59,59,999),t.forEach(i=>{const s=new Qt;s.stageIndex=i.stageIndex,s.expectedValue=i.result;const c=new Array;i.operands.forEach(f=>{c.push(f.value)}),s.operands=c,n.stages.push(s)}),n}isDateSame(t,n){return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()}updatePuzzleDataInDb(t){this.firestorePuzzleData.data=JSON.stringify(t),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(n=>console.log(n))}createPuzzleDataInDb(t){this.numbersFirestoreService.create(t).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){const t=navigator.language;return void 0!==this.firestorePuzzleDataItems.find(i=>i.locale===t)}upsertGameDataInDb(t){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(t);else{const n=new et;n.locale=navigator.language,n.data=JSON.stringify(t),this.createPuzzleDataInDb(n)}}allGameCompleted(){let t=!0;return this.stageLevels.forEach(n=>{t=t&&n.completed}),t}collectAllOperations(){const t=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(t){let n="Genius!\n";this.allGameCompletedModalMessage=[],this.stageLevels.forEach(i=>{n+=i.summary,this.allGameCompletedModalMessage.push(i.summary)}),this.clipboardService.copy(n),this.storeGameStateToCookie(),this.allGameCompletedModalVisible=!0}return t}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const t=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(t)}ngOnInit(){console.log(`Browser locale: ${navigator.language}`),this.initializeStageLevels();const t=this.restoreGameStateFromCookie();if(t){console.log("INFO: Game state restored from cookie");const n=new Date(t.storeDate);if(this.isDateSame(n,new Date))this.stageIndex=t.stageIndex,this.stageLevels=t.stageLevels,this.gameParameters=t.gameParameters,this.setupStages(),t.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const i=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+i),this.upsertGameDataInDb(i)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();const n=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe((0,Ae.T)(i=>i.map(s=>({id:s.payload.doc.id,...s.payload.doc.data()})))).subscribe(i=>{this.firestorePuzzleDataItems=i;const s=i.find(c=>c.locale===n);if(s){this.firestorePuzzleData=s,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");const c=new Date,f=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(f,c))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const p=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(p)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const c=this.mapGameParametersToPuzzleData(this.gameParameters),f=new et;f.locale=navigator.language,f.data=JSON.stringify(c),this.createPuzzleDataInDb(f)}})}}ngOnDestroy(){this.updateStageLevel.unsubscribe()}expectedResultReached(t){const n=this.formatOperations(t),i=this.createSummaryOfTHeOperations(this.stageIndex,t);this.stageLevels[this.stageIndex].summary=i,this.clipboardService.copy(n),this.showSuccessMessage("You are reach the expected result!"),this.stageToCompleted(),this.reachedValue=this.gameParameters[this.stageIndex].result,this.gameCompletedModalVisible=!0}hideGameCompletedDialog(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}invalidOperationExecuted(t){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(t)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}static#e=this.\u0275fac=function(n){return new(n||r)(d.rXU($.bg),d.rXU(ve),d.rXU(pn),d.rXU(kg),d.rXU(Og))};static#t=this.\u0275cmp=d.VBU({type:r,selectors:[["app-digits-game"]],viewQuery:function(n,i){if(1&n&&d.GBs(ZI,7),2&n){let s;d.mGM(s=d.lsd())&&(i.arithmeticComponent=s.first)}},features:[d.Jv_([$.bg,ve])],decls:31,vars:14,consts:[["arithmeticOperations",""],[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"expectedResultReached","invalidOperationExecuted","gameParameters"],["id","splashscreen","header","Welcome to the Numbers Puzzle Game",3,"visibleChange","visible","modal"],["id","gameCompleted","header","Game Completed",3,"visibleChange","onHide","visible","modal"],[1,"li-no-bullet"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visibleChange","visible","modal","closable"]],template:function(n,i){if(1&n){const s=d.RV6();d.j41(0,"div",1),d.nrm(1,"p-toast",2),d.j41(2,"div",3),d.EFF(3," This is a daily numbers puzzle, similar to the "),d.j41(4,"a",4),d.EFF(5,"NY Times Digits"),d.k0s(),d.EFF(6,", which unfortunately discontinued at August 8, 2023 "),d.k0s(),d.j41(7,"div",5)(8,"div",6),d.bIt("click",function(){return d.eBV(s),d.Njj(i.onDeleteCookie())}),d.EFF(9," Numbers "),d.k0s(),d.j41(10,"div",7),d.bIt("click",function(){return d.eBV(s),d.Njj(i.onUpdatePuzzleData())}),d.EFF(11),d.nI1(12,"date"),d.k0s()(),d.j41(13,"div",8),d.nrm(14,"app-game-stage-levels",9),d.k0s(),d.j41(15,"div")(16,"app-game-arithmetic-operations",10,0),d.bIt("expectedResultReached",function(f){return d.eBV(s),d.Njj(i.expectedResultReached(f))})("invalidOperationExecuted",function(f){return d.eBV(s),d.Njj(i.invalidOperationExecuted(f))}),d.k0s()()(),d.j41(18,"p-dialog",11),d.mxI("visibleChange",function(f){return d.eBV(s),d.DH7(i.splashVisible,f)||(i.splashVisible=f),d.Njj(f)}),d.j41(19,"p"),d.EFF(20,"It can improves your arithmetic combination ability."),d.k0s()(),d.j41(21,"p-dialog",12),d.mxI("visibleChange",function(f){return d.eBV(s),d.DH7(i.gameCompletedModalVisible,f)||(i.gameCompletedModalVisible=f),d.Njj(f)}),d.bIt("onHide",function(){return d.eBV(s),d.Njj(i.hideGameCompletedDialog())}),d.j41(22,"div"),d.EFF(23),d.Z7z(24,eT,2,1,"li",13,d.fX1),d.k0s()(),d.j41(26,"p-dialog",14),d.mxI("visibleChange",function(f){return d.eBV(s),d.DH7(i.allGameCompletedModalVisible,f)||(i.allGameCompletedModalVisible=f),d.Njj(f)}),d.j41(27,"div"),d.EFF(28," Congratulation! Your Solutions: "),d.Z7z(29,tT,2,1,"li",13,d.fX1),d.k0s()()}2&n&&(d.R7$(11),d.SpI(" ",d.i5U(12,11,i.currentDate,"MM/dd/yyyy")," "),d.R7$(3),d.Y8G("stageLevels",i.stageLevels),d.R7$(2),d.Y8G("gameParameters",i.gameParameters[i.stageIndex]),d.R7$(2),d.R50("visible",i.splashVisible),d.Y8G("modal",!0),d.R7$(3),d.R50("visible",i.gameCompletedModalVisible),d.Y8G("modal",!0),d.R7$(2),d.SpI(" Target ",i.reachedValue,". Your solution: "),d.R7$(),d.Dyx(i.gameCompletedModalMessages),d.R7$(2),d.R50("visible",i.allGameCompletedModalVisible),d.Y8G("modal",!0)("closable",!1),d.R7$(3),d.Dyx(i.allGameCompletedModalMessage))},dependencies:[N0,RI,KI,JI,A.vh],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:50vw;position:absolute;inset:0;margin:auto;background:#ebf9fd40;border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:90vh;width:99vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}.digits-game-layout[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]})}return r})()}];let rT=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=d.$C({type:r});static#n=this.\u0275inj=d.G2t({imports:[A.MD,Se.iI.forChild(nT),Se.iI]})}return r})();var iT=le(6924);let ET=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=d.$C({type:r});static \u0275inj=d.G2t({imports:[A.MD,Sl.Z,Rp,xp,Dp,Pp,Cl.A]})}return r})();var AT=le(5312);let bT=(()=>{class r{static#e=this.\u0275fac=function(n){return new(n||r)};static#t=this.\u0275mod=d.$C({type:r});static#n=this.\u0275inj=d.G2t({providers:[kg],imports:[A.MD,Se.iI,V0,ET,rT,iT.YF,kp.m_,tt,Hn.initializeApp(AT.c.firebasePuzzleData),h0,PI]})}return r})()},3345:(Io,fn,le)=>{le.d(fn,{A:()=>Qt});var A=le(1076),Se=le(1362),d=le(7852),$=le(8041);class Ne{constructor(Ve,Fe){this._delegate=Ve,this.firebase=Fe,(0,d._addComponent)(Ve,new Se.uA("app-compat",()=>this,"PUBLIC")),this.container=Ve.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ve){this._delegate.automaticDataCollectionEnabled=Ve}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Ve=>{this._delegate.checkDestroyed(),Ve()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,d.deleteApp)(this._delegate)))}_getService(Ve,Fe=d._DEFAULT_ENTRY_NAME){var Vt;this._delegate.checkDestroyed();const pn=this._delegate.container.getProvider(Ve);return!pn.isInitialized()&&"EXPLICIT"===(null===(Vt=pn.getComponent())||void 0===Vt?void 0:Vt.instantiationMode)&&pn.initialize(),pn.getImmediate({identifier:Fe})}_removeServiceInstance(Ve,Fe=d._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Ve).clearInstance(Fe)}_addComponent(Ve){(0,d._addComponent)(this._delegate,Ve)}_addOrOverwriteComponent(Ve){(0,d._addOrOverwriteComponent)(this._delegate,Ve)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const zt=new A.FA("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),te=function dt(){const et=function jt(et){const Ve={},Fe={__esModule:!0,initializeApp:function qt(be,St={}){const gt=d.initializeApp(be,St);if((0,A.gR)(Ve,gt.name))return Ve[gt.name];const ee=new et(gt,Fe);return Ve[gt.name]=ee,ee},app:pn,registerVersion:d.registerVersion,setLogLevel:d.setLogLevel,onLog:d.onLog,apps:null,SDK_VERSION:d.SDK_VERSION,INTERNAL:{registerComponent:function tt(be){const St=be.name,gt=St.replace("-compat","");if(d._registerComponent(be)&&"PUBLIC"===be.type){const ee=(Rt=pn())=>{if("function"!=typeof Rt[gt])throw zt.create("invalid-app-argument",{appName:St});return Rt[gt]()};void 0!==be.serviceProps&&(0,A.zw)(ee,be.serviceProps),Fe[gt]=ee,et.prototype[gt]=function(...Rt){return this._getService.bind(this,St).apply(this,be.multipleInstances?Rt:[])}}return"PUBLIC"===be.type?Fe[gt]:null},removeApp:function Vt(be){delete Ve[be]},useAsService:function mn(be,St){return"serverAuth"===St?null:St},modularAPIs:d}};function pn(be){if(!(0,A.gR)(Ve,be=be||d._DEFAULT_ENTRY_NAME))throw zt.create("no-app",{appName:be});return Ve[be]}return Fe.default=Fe,Object.defineProperty(Fe,"apps",{get:function ot(){return Object.keys(Ve).map(be=>Ve[be])}}),pn.App=et,Fe}(Ne);return et.INTERNAL=Object.assign(Object.assign({},et.INTERNAL),{createFirebaseNamespace:dt,extendNamespace:function Ve(Fe){(0,A.zw)(et,Fe)},createSubscribe:A.tD,ErrorFactory:A.FA,deepExtend:A.zw}),et}(),re=new $.Vy("@firebase/app-compat");if((0,A.Bd)()&&void 0!==self.firebase){re.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const et=self.firebase.SDK_VERSION;et&&et.indexOf("LITE")>=0&&re.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Qt=te;!function Qe(et){(0,d.registerVersion)("@firebase/app-compat","0.2.34",et)}()},7852:(Io,fn,le)=>{le.r(fn),le.d(fn,{FirebaseError:()=>$.g,SDK_VERSION:()=>or,_DEFAULT_ENTRY_NAME:()=>Un,_addComponent:()=>_n,_addOrOverwriteComponent:()=>Ni,_apps:()=>Xt,_clearComponents:()=>yn,_components:()=>sn,_getProvider:()=>Hn,_isFirebaseApp:()=>wr,_isFirebaseServerApp:()=>Cs,_registerComponent:()=>Jr,_removeServiceInstance:()=>Zr,_serverApps:()=>rn,deleteApp:()=>Sr,getApp:()=>Vi,getApps:()=>Ps,initializeApp:()=>Jt,initializeServerApp:()=>Rs,onLog:()=>D,registerVersion:()=>b,setLogLevel:()=>Y});var A=le(467),Se=le(1362),d=le(8041),$=le(1076);const Ne=(j,V)=>V.some(W=>j instanceof W);let Gt,zt;const te=new WeakMap,re=new WeakMap,ve=new WeakMap,Ae=new WeakMap,Qe=new WeakMap;let Ve={get(j,V,W){if(j instanceof IDBTransaction){if("done"===V)return re.get(j);if("objectStoreNames"===V)return j.objectStoreNames||ve.get(j);if("store"===V)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return qt(j[V])},set:(j,V,W)=>(j[V]=W,!0),has:(j,V)=>j instanceof IDBTransaction&&("done"===V||"store"===V)||V in j};function pn(j){return"function"==typeof j?function Vt(j){return j!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function dt(){return zt||(zt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(j)?function(...V){return j.apply(ot(this),V),qt(te.get(this))}:function(...V){return qt(j.apply(ot(this),V))}:function(V,...W){const ue=j.call(ot(this),V,...W);return ve.set(ue,V.sort?V.sort():[V]),qt(ue)}}(j):(j instanceof IDBTransaction&&function et(j){if(re.has(j))return;const V=new Promise((W,ue)=>{const Ee=()=>{j.removeEventListener("complete",we),j.removeEventListener("error",De),j.removeEventListener("abort",De)},we=()=>{W(),Ee()},De=()=>{ue(j.error||new DOMException("AbortError","AbortError")),Ee()};j.addEventListener("complete",we),j.addEventListener("error",De),j.addEventListener("abort",De)});re.set(j,V)}(j),Ne(j,function jt(){return Gt||(Gt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(j,Ve):j)}function qt(j){if(j instanceof IDBRequest)return function Qt(j){const V=new Promise((W,ue)=>{const Ee=()=>{j.removeEventListener("success",we),j.removeEventListener("error",De)},we=()=>{W(qt(j.result)),Ee()},De=()=>{ue(j.error),Ee()};j.addEventListener("success",we),j.addEventListener("error",De)});return V.then(W=>{W instanceof IDBCursor&&te.set(W,j)}).catch(()=>{}),Qe.set(V,j),V}(j);if(Ae.has(j))return Ae.get(j);const V=pn(j);return V!==j&&(Ae.set(j,V),Qe.set(V,j)),V}const ot=j=>Qe.get(j),be=["get","getKey","getAll","getAllKeys","count"],St=["put","add","delete","clear"],gt=new Map;function ee(j,V){if(!(j instanceof IDBDatabase)||V in j||"string"!=typeof V)return;if(gt.get(V))return gt.get(V);const W=V.replace(/FromIndex$/,""),ue=V!==W,Ee=St.includes(W);if(!(W in(ue?IDBIndex:IDBObjectStore).prototype)||!Ee&&!be.includes(W))return;const we=function(){var De=(0,A.A)(function*(Xe,...Je){const Kt=this.transaction(Xe,Ee?"readwrite":"readonly");let cr=Kt.store;return ue&&(cr=cr.index(Je.shift())),(yield Promise.all([cr[W](...Je),Ee&&Kt.done]))[0]});return function(Je){return De.apply(this,arguments)}}();return gt.set(V,we),we}!function Fe(j){Ve=j(Ve)}(j=>({...j,get:(V,W,ue)=>ee(V,W)||j.get(V,W,ue),has:(V,W)=>!!ee(V,W)||j.has(V,W)}));class Rt{constructor(V){this.container=V}getPlatformInfoString(){return this.container.getProviders().map(W=>{if(function $t(j){const V=j.getComponent();return"VERSION"===V?.type}(W)){const ue=W.getImmediate();return`${ue.library}/${ue.version}`}return null}).filter(W=>W).join(" ")}}const Ln="@firebase/app",Ir="0.10.4",Sn=new d.Vy("@firebase/app"),To="@firebase/app-compat",Tr="@firebase/analytics-compat",gn="@firebase/analytics",sr="@firebase/app-check-compat",Eo="@firebase/app-check",Ao="@firebase/auth",Er="@firebase/auth-compat",Ge="@firebase/database",$e="@firebase/database-compat",Rn="@firebase/functions",Ar="@firebase/functions-compat",ki="@firebase/installations",Mt="@firebase/installations-compat",Fn="@firebase/messaging",Ts="@firebase/messaging-compat",Kn="@firebase/performance",Qa="@firebase/performance-compat",br="@firebase/remote-config",Lt="@firebase/remote-config-compat",Oi="@firebase/storage",Es="@firebase/storage-compat",As="@firebase/firestore",Yt="@firebase/vertexai-preview",bs="@firebase/firestore-compat",Xr="firebase",Un="[DEFAULT]",bo={[Ln]:"fire-core",[To]:"fire-core-compat",[gn]:"fire-analytics",[Tr]:"fire-analytics-compat",[Eo]:"fire-app-check",[sr]:"fire-app-check-compat",[Ao]:"fire-auth",[Er]:"fire-auth-compat",[Ge]:"fire-rtdb",[$e]:"fire-rtdb-compat",[Rn]:"fire-fn",[Ar]:"fire-fn-compat",[ki]:"fire-iid",[Mt]:"fire-iid-compat",[Fn]:"fire-fcm",[Ts]:"fire-fcm-compat",[Kn]:"fire-perf",[Qa]:"fire-perf-compat",[br]:"fire-rc",[Lt]:"fire-rc-compat",[Oi]:"fire-gcs",[Es]:"fire-gcs-compat",[As]:"fire-fst",[bs]:"fire-fst-compat",[Yt]:"fire-vertex","fire-js":"fire-js",[Xr]:"fire-js-all"},Xt=new Map,rn=new Map,sn=new Map;function _n(j,V){try{j.container.addComponent(V)}catch(W){Sn.debug(`Component ${V.name} failed to register with FirebaseApp ${j.name}`,W)}}function Ni(j,V){j.container.addOrOverwriteComponent(V)}function Jr(j){const V=j.name;if(sn.has(V))return Sn.debug(`There were multiple attempts to register component ${V}.`),!1;sn.set(V,j);for(const W of Xt.values())_n(W,j);for(const W of rn.values())_n(W,j);return!0}function Hn(j,V){const W=j.container.getProvider("heartbeat").getImmediate({optional:!0});return W&&W.triggerHeartbeat(),j.container.getProvider(V)}function Zr(j,V,W=Un){Hn(j,V).clearInstance(W)}function wr(j){return void 0!==j.options}function Cs(j){return void 0!==j.settings}function yn(){sn.clear()}const Et=new $.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Cr{constructor(V,W,ue){this._isDeleted=!1,this._options=Object.assign({},V),this._config=Object.assign({},W),this._name=W.name,this._automaticDataCollectionEnabled=W.automaticDataCollectionEnabled,this._container=ue,this.container.addComponent(new Se.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(V){this.checkDestroyed(),this._automaticDataCollectionEnabled=V}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(V){this._isDeleted=V}checkDestroyed(){if(this.isDeleted)throw Et.create("app-deleted",{appName:this._name})}}class Pn extends Cr{constructor(V,W,ue,Ee){const we=void 0!==W.automaticDataCollectionEnabled&&W.automaticDataCollectionEnabled,De={name:ue,automaticDataCollectionEnabled:we};super(void 0!==V.apiKey?V:V.options,De,Ee),this._serverConfig=Object.assign({automaticDataCollectionEnabled:we},W),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,W.releaseOnDeref=void 0,b(Ln,Ir,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(V){this.isDeleted||(this._refCount++,void 0!==V&&this._finalizationRegistry.register(V,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Sr(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Et.create("server-app-deleted")}}const or="10.12.1";function Jt(j,V={}){let W=j;"object"!=typeof V&&(V={name:V});const ue=Object.assign({name:Un,automaticDataCollectionEnabled:!1},V),Ee=ue.name;if("string"!=typeof Ee||!Ee)throw Et.create("bad-app-name",{appName:String(Ee)});if(W||(W=(0,$.T9)()),!W)throw Et.create("no-options");const we=Xt.get(Ee);if(we){if((0,$.bD)(W,we.options)&&(0,$.bD)(ue,we.config))return we;throw Et.create("duplicate-app",{appName:Ee})}const De=new Se.h1(Ee);for(const Je of sn.values())De.addComponent(Je);const Xe=new Cr(W,ue,De);return Xt.set(Ee,Xe),Xe}function Rs(j,V){if((0,$.Bd)())throw Et.create("invalid-server-app-environment");let W;void 0===V.automaticDataCollectionEnabled&&(V.automaticDataCollectionEnabled=!1),W=wr(j)?j.options:j;const ue=Object.assign(Object.assign({},V),W);if(void 0!==ue.releaseOnDeref&&delete ue.releaseOnDeref,void 0!==V.releaseOnDeref&&typeof FinalizationRegistry>"u")throw Et.create("finalization-registry-not-supported",{});const we=""+(Kt=JSON.stringify(ue),[...Kt].reduce((cr,Co)=>Math.imul(31,cr)+Co.charCodeAt(0)|0,0)),De=rn.get(we);var Kt;if(De)return De.incRefCount(V.releaseOnDeref),De;const Xe=new Se.h1(we);for(const Kt of sn.values())Xe.addComponent(Kt);const Je=new Pn(W,V,we,Xe);return rn.set(we,Je),Je}function Vi(j=Un){const V=Xt.get(j);if(!V&&j===Un&&(0,$.T9)())return Jt();if(!V)throw Et.create("no-app",{appName:j});return V}function Ps(){return Array.from(Xt.values())}function Sr(j){return R.apply(this,arguments)}function R(){return(R=(0,A.A)(function*(j){let V=!1;const W=j.name;Xt.has(W)?(V=!0,Xt.delete(W)):rn.has(W)&&j.decRefCount()<=0&&(rn.delete(W),V=!0),V&&(yield Promise.all(j.container.getProviders().map(ue=>ue.delete())),j.isDeleted=!0)})).apply(this,arguments)}function b(j,V,W){var ue;let Ee=null!==(ue=bo[j])&&void 0!==ue?ue:j;W&&(Ee+=`-${W}`);const we=Ee.match(/\s|\//),De=V.match(/\s|\//);if(we||De){const Xe=[`Unable to register library "${Ee}" with version "${V}":`];return we&&Xe.push(`library name "${Ee}" contains illegal characters (whitespace or "/")`),we&&De&&Xe.push("and"),De&&Xe.push(`version name "${V}" contains illegal characters (whitespace or "/")`),void Sn.warn(Xe.join(" "))}Jr(new Se.uA(`${Ee}-version`,()=>({library:Ee,version:V}),"VERSION"))}function D(j,V){if(null!==j&&"function"!=typeof j)throw Et.create("invalid-log-argument");(0,d.Ey)(j,V)}function Y(j){(0,d.He)(j)}const B="firebase-heartbeat-database",fe=1,Te="firebase-heartbeat-store";let Ye=null;function Ke(){return Ye||(Ye=function tt(j,V,{blocked:W,upgrade:ue,blocking:Ee,terminated:we}={}){const De=indexedDB.open(j,V),Xe=qt(De);return ue&&De.addEventListener("upgradeneeded",Je=>{ue(qt(De.result),Je.oldVersion,Je.newVersion,qt(De.transaction),Je)}),W&&De.addEventListener("blocked",Je=>W(Je.oldVersion,Je.newVersion,Je)),Xe.then(Je=>{we&&Je.addEventListener("close",()=>we()),Ee&&Je.addEventListener("versionchange",Kt=>Ee(Kt.oldVersion,Kt.newVersion,Kt))}).catch(()=>{}),Xe}(B,fe,{upgrade:(j,V)=>{if(0===V)try{j.createObjectStore(Te)}catch(W){console.warn(W)}}}).catch(j=>{throw Et.create("idb-open",{originalErrorMessage:j.message})})),Ye}function kt(){return(kt=(0,A.A)(function*(j){try{const W=(yield Ke()).transaction(Te),ue=yield W.objectStore(Te).get(Wn(j));return yield W.done,ue}catch(V){if(V instanceof $.g)Sn.warn(V.message);else{const W=Et.create("idb-get",{originalErrorMessage:V?.message});Sn.warn(W.message)}}})).apply(this,arguments)}function xe(j,V){return At.apply(this,arguments)}function At(){return(At=(0,A.A)(function*(j,V){try{const ue=(yield Ke()).transaction(Te,"readwrite");yield ue.objectStore(Te).put(V,Wn(j)),yield ue.done}catch(W){if(W instanceof $.g)Sn.warn(W.message);else{const ue=Et.create("idb-set",{originalErrorMessage:W?.message});Sn.warn(ue.message)}}})).apply(this,arguments)}function Wn(j){return`${j.name}!${j.options.appId}`}class wo{constructor(V){this.container=V,this._heartbeatsCache=null;const W=this.container.getProvider("app").getImmediate();this._storage=new vn(W),this._heartbeatsCachePromise=this._storage.read().then(ue=>(this._heartbeatsCache=ue,ue))}triggerHeartbeat(){var V=this;return(0,A.A)(function*(){var W,ue;const we=V.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),De=H();if((null!=(null===(W=V._heartbeatsCache)||void 0===W?void 0:W.heartbeats)||(V._heartbeatsCache=yield V._heartbeatsCachePromise,null!=(null===(ue=V._heartbeatsCache)||void 0===ue?void 0:ue.heartbeats)))&&V._heartbeatsCache.lastSentHeartbeatDate!==De&&!V._heartbeatsCache.heartbeats.some(Xe=>Xe.date===De))return V._heartbeatsCache.heartbeats.push({date:De,agent:we}),V._heartbeatsCache.heartbeats=V._heartbeatsCache.heartbeats.filter(Xe=>{const Je=new Date(Xe.date).valueOf();return Date.now()-Je<=2592e6}),V._storage.overwrite(V._heartbeatsCache)})()}getHeartbeatsHeader(){var V=this;return(0,A.A)(function*(){var W;if(null===V._heartbeatsCache&&(yield V._heartbeatsCachePromise),null==(null===(W=V._heartbeatsCache)||void 0===W?void 0:W.heartbeats)||0===V._heartbeatsCache.heartbeats.length)return"";const ue=H(),{heartbeatsToSend:Ee,unsentEntries:we}=function Pr(j,V=1024){const W=[];let ue=j.slice();for(const Ee of j){const we=W.find(De=>De.agent===Ee.agent);if(we){if(we.dates.push(Ee.date),Ue(W)>V){we.dates.pop();break}}else if(W.push({agent:Ee.agent,dates:[Ee.date]}),Ue(W)>V){W.pop();break}ue=ue.slice(1)}return{heartbeatsToSend:W,unsentEntries:ue}}(V._heartbeatsCache.heartbeats),De=(0,$.Uj)(JSON.stringify({version:2,heartbeats:Ee}));return V._heartbeatsCache.lastSentHeartbeatDate=ue,we.length>0?(V._heartbeatsCache.heartbeats=we,yield V._storage.overwrite(V._heartbeatsCache)):(V._heartbeatsCache.heartbeats=[],V._storage.overwrite(V._heartbeatsCache)),De})()}}function H(){return(new Date).toISOString().substring(0,10)}class vn{constructor(V){this.app=V,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,A.A)(function*(){return!!(0,$.zW)()&&(0,$.eX)().then(()=>!0).catch(()=>!1)})()}read(){var V=this;return(0,A.A)(function*(){if(yield V._canUseIndexedDBPromise){const ue=yield function Ft(j){return kt.apply(this,arguments)}(V.app);return ue?.heartbeats?ue:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(V){var W=this;return(0,A.A)(function*(){var ue;if(yield W._canUseIndexedDBPromise){const we=yield W.read();return xe(W.app,{lastSentHeartbeatDate:null!==(ue=V.lastSentHeartbeatDate)&&void 0!==ue?ue:we.lastSentHeartbeatDate,heartbeats:V.heartbeats})}})()}add(V){var W=this;return(0,A.A)(function*(){var ue;if(yield W._canUseIndexedDBPromise){const we=yield W.read();return xe(W.app,{lastSentHeartbeatDate:null!==(ue=V.lastSentHeartbeatDate)&&void 0!==ue?ue:we.lastSentHeartbeatDate,heartbeats:[...we.heartbeats,...V.heartbeats]})}})()}}function Ue(j){return(0,$.Uj)(JSON.stringify({version:2,heartbeats:j})).length}!function ar(j){Jr(new Se.uA("platform-logger",V=>new Rt(V),"PRIVATE")),Jr(new Se.uA("heartbeat",V=>new wo(V),"PRIVATE")),b(Ln,Ir,j),b(Ln,Ir,"esm2017"),b("fire-js","")}("")},1362:(Io,fn,le)=>{le.d(fn,{h1:()=>jt,uA:()=>d});var A=le(467),Se=le(1076);class d{constructor(te,re,ve){this.name=te,this.instanceFactory=re,this.type=ve,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(te){return this.instantiationMode=te,this}setMultipleInstances(te){return this.multipleInstances=te,this}setServiceProps(te){return this.serviceProps=te,this}setInstanceCreatedCallback(te){return this.onInstanceCreated=te,this}}const $="[DEFAULT]";class Ne{constructor(te,re){this.name=te,this.container=re,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(te){const re=this.normalizeInstanceIdentifier(te);if(!this.instancesDeferred.has(re)){const ve=new Se.cY;if(this.instancesDeferred.set(re,ve),this.isInitialized(re)||this.shouldAutoInitialize())try{const Ae=this.getOrInitializeService({instanceIdentifier:re});Ae&&ve.resolve(Ae)}catch{}}return this.instancesDeferred.get(re).promise}getImmediate(te){var re;const ve=this.normalizeInstanceIdentifier(te?.identifier),Ae=null!==(re=te?.optional)&&void 0!==re&&re;if(!this.isInitialized(ve)&&!this.shouldAutoInitialize()){if(Ae)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ve})}catch(Qe){if(Ae)return null;throw Qe}}getComponent(){return this.component}setComponent(te){if(te.name!==this.name)throw Error(`Mismatching Component ${te.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=te,this.shouldAutoInitialize()){if(function zt(dt){return"EAGER"===dt.instantiationMode}(te))try{this.getOrInitializeService({instanceIdentifier:$})}catch{}for(const[re,ve]of this.instancesDeferred.entries()){const Ae=this.normalizeInstanceIdentifier(re);try{const Qe=this.getOrInitializeService({instanceIdentifier:Ae});ve.resolve(Qe)}catch{}}}}clearInstance(te=$){this.instancesDeferred.delete(te),this.instancesOptions.delete(te),this.instances.delete(te)}delete(){var te=this;return(0,A.A)(function*(){const re=Array.from(te.instances.values());yield Promise.all([...re.filter(ve=>"INTERNAL"in ve).map(ve=>ve.INTERNAL.delete()),...re.filter(ve=>"_delete"in ve).map(ve=>ve._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(te=$){return this.instances.has(te)}getOptions(te=$){return this.instancesOptions.get(te)||{}}initialize(te={}){const{options:re={}}=te,ve=this.normalizeInstanceIdentifier(te.instanceIdentifier);if(this.isInitialized(ve))throw Error(`${this.name}(${ve}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ae=this.getOrInitializeService({instanceIdentifier:ve,options:re});for(const[Qe,Qt]of this.instancesDeferred.entries())ve===this.normalizeInstanceIdentifier(Qe)&&Qt.resolve(Ae);return Ae}onInit(te,re){var ve;const Ae=this.normalizeInstanceIdentifier(re),Qe=null!==(ve=this.onInitCallbacks.get(Ae))&&void 0!==ve?ve:new Set;Qe.add(te),this.onInitCallbacks.set(Ae,Qe);const Qt=this.instances.get(Ae);return Qt&&te(Qt,Ae),()=>{Qe.delete(te)}}invokeOnInitCallbacks(te,re){const ve=this.onInitCallbacks.get(re);if(ve)for(const Ae of ve)try{Ae(te,re)}catch{}}getOrInitializeService({instanceIdentifier:te,options:re={}}){let ve=this.instances.get(te);if(!ve&&this.component&&(ve=this.component.instanceFactory(this.container,{instanceIdentifier:(dt=te,dt===$?void 0:dt),options:re}),this.instances.set(te,ve),this.instancesOptions.set(te,re),this.invokeOnInitCallbacks(ve,te),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,te,ve)}catch{}var dt;return ve||null}normalizeInstanceIdentifier(te=$){return this.component?this.component.multipleInstances?te:$:te}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class jt{constructor(te){this.name=te,this.providers=new Map}addComponent(te){const re=this.getProvider(te.name);if(re.isComponentSet())throw new Error(`Component ${te.name} has already been registered with ${this.name}`);re.setComponent(te)}addOrOverwriteComponent(te){this.getProvider(te.name).isComponentSet()&&this.providers.delete(te.name),this.addComponent(te)}getProvider(te){if(this.providers.has(te))return this.providers.get(te);const re=new Ne(te,this);return this.providers.set(te,re),re}getProviders(){return Array.from(this.providers.values())}}},8041:(Io,fn,le)=>{le.d(fn,{$b:()=>Se,Ey:()=>dt,He:()=>jt,Vy:()=>zt});const A=[];var Se=function(te){return te[te.DEBUG=0]="DEBUG",te[te.VERBOSE=1]="VERBOSE",te[te.INFO=2]="INFO",te[te.WARN=3]="WARN",te[te.ERROR=4]="ERROR",te[te.SILENT=5]="SILENT",te}(Se||{});const d={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},$=Se.INFO,Ne={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},Gt=(te,re,...ve)=>{if(re<te.logLevel)return;const Ae=(new Date).toISOString(),Qe=Ne[re];if(!Qe)throw new Error(`Attempted to log a message with an invalid logType (value: ${re})`);console[Qe](`[${Ae}]  ${te.name}:`,...ve)};class zt{constructor(re){this.name=re,this._logLevel=$,this._logHandler=Gt,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(re){if(!(re in Se))throw new TypeError(`Invalid value "${re}" assigned to \`logLevel\``);this._logLevel=re}setLogLevel(re){this._logLevel="string"==typeof re?d[re]:re}get logHandler(){return this._logHandler}set logHandler(re){if("function"!=typeof re)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=re}get userLogHandler(){return this._userLogHandler}set userLogHandler(re){this._userLogHandler=re}debug(...re){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...re),this._logHandler(this,Se.DEBUG,...re)}log(...re){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...re),this._logHandler(this,Se.VERBOSE,...re)}info(...re){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...re),this._logHandler(this,Se.INFO,...re)}warn(...re){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...re),this._logHandler(this,Se.WARN,...re)}error(...re){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...re),this._logHandler(this,Se.ERROR,...re)}}function jt(te){A.forEach(re=>{re.setLogLevel(te)})}function dt(te,re){for(const ve of A){let Ae=null;re&&re.level&&(Ae=d[re.level]),ve.userLogHandler=null===te?null:(Qe,Qt,...et)=>{const Ve=et.map(Fe=>{if(null==Fe)return null;if("string"==typeof Fe)return Fe;if("number"==typeof Fe||"boolean"==typeof Fe)return Fe.toString();if(Fe instanceof Error)return Fe.message;try{return JSON.stringify(Fe)}catch{return null}}).filter(Fe=>Fe).join(" ");Qt>=(Ae??Qe.logLevel)&&te({level:Se[Qt].toLowerCase(),message:Ve,args:et,type:Qe.name})}}}},3780:(Io,fn,le)=>{le.r(fn);var A=le(467),Se=le(3345),d=le(7852),$=le(1076),Ne=le(8041),Gt=le(1635),zt=le(1362);const dt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const Qt=function Ae(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},et=function Qe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ve=new $.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Vt=new Ne.Vy("@firebase/auth");function qt(u,...o){Vt.logLevel<=Ne.$b.ERROR&&Vt.error(`Auth (${d.SDK_VERSION}): ${u}`,...o)}function ot(u,...o){throw gt(u,...o)}function tt(u,...o){return gt(u,...o)}function mn(u,o,a){const h=Object.assign(Object.assign({},et()),{[o]:a});return new $.FA("auth","Firebase",h).create(o,{appName:u.name})}function be(u){return mn(u,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function St(u,o,a){if(!(o instanceof a))throw a.name!==o.constructor.name&&ot(u,"argument-error"),mn(u,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gt(u,...o){if("string"!=typeof u){const a=o[0],h=[...o.slice(1)];return h[0]&&(h[0].appName=u.name),u._errorFactory.create(a,...h)}return Ve.create(u,...o)}function ee(u,o,...a){if(!u)throw gt(o,...a)}function Rt(u){const o="INTERNAL ASSERTION FAILED: "+u;throw qt(o),new Error(o)}function $t(u,o){u||Rt(o)}function Ln(){var u;return typeof self<"u"&&(null===(u=self.location)||void 0===u?void 0:u.href)||""}function Ir(){return"http:"===Sn()||"https:"===Sn()}function Sn(){var u;return typeof self<"u"&&(null===(u=self.location)||void 0===u?void 0:u.protocol)||null}class gn{constructor(o,a){this.shortDelay=o,this.longDelay=a,$t(a>o,"Short delay should be less than long delay!"),this.isMobile=(0,$.jZ)()||(0,$.lV)()}get(){return function To(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Ir()||(0,$.sr)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function sr(u,o){$t(u.emulator,"Emulator should always be set here");const{url:a}=u.emulator;return o?`${a}${o.startsWith("/")?o.slice(1):o}`:a}class Eo{static initialize(o,a,h){this.fetchImpl=o,a&&(this.headersImpl=a),h&&(this.responseImpl=h)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Rt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Rt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Rt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ao={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Er=new gn(3e4,6e4);function Ge(u,o){return u.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:u.tenantId}):o}function $e(u,o,a,h){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,A.A)(function*(u,o,a,h,g={}){return Ar(u,g,(0,A.A)(function*(){let I={},C={};h&&("GET"===o?C=h:I={body:JSON.stringify(h)});const O=(0,$.Am)(Object.assign({key:u.config.apiKey},C)).slice(1),K=yield u._getAdditionalHeaders();return K["Content-Type"]="application/json",u.languageCode&&(K["X-Firebase-Locale"]=u.languageCode),Eo.fetch()(Ts(u,u.config.apiHost,a,O),Object.assign({method:o,headers:K,referrerPolicy:"no-referrer"},I))}))})).apply(this,arguments)}function Ar(u,o,a){return ki.apply(this,arguments)}function ki(){return(ki=(0,A.A)(function*(u,o,a){u._canInitEmulator=!1;const h=Object.assign(Object.assign({},Ao),o);try{const g=new Qa(u),I=yield Promise.race([a(),g.promise]);g.clearNetworkTimeout();const C=yield I.json();if("needConfirmation"in C)throw br(u,"account-exists-with-different-credential",C);if(I.ok&&!("errorMessage"in C))return C;{const O=I.ok?C.errorMessage:C.error.message,[K,se]=O.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===K)throw br(u,"credential-already-in-use",C);if("EMAIL_EXISTS"===K)throw br(u,"email-already-in-use",C);if("USER_DISABLED"===K)throw br(u,"user-disabled",C);const de=h[K]||K.toLowerCase().replace(/[_\s]+/g,"-");if(se)throw mn(u,de,se);ot(u,de)}}catch(g){if(g instanceof $.g)throw g;ot(u,"network-request-failed",{message:String(g)})}})).apply(this,arguments)}function Mt(u,o,a,h){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,A.A)(function*(u,o,a,h,g={}){const I=yield $e(u,o,a,h,g);return"mfaPendingCredential"in I&&ot(u,"multi-factor-auth-required",{_serverResponse:I}),I})).apply(this,arguments)}function Ts(u,o,a,h){const g=`${o}${a}?${h}`;return u.config.emulator?sr(u.config,g):`${u.config.apiScheme}://${g}`}function Kn(u){switch(u){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Qa{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((a,h)=>{this.timer=setTimeout(()=>h(tt(this.auth,"network-request-failed")),Er.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function br(u,o,a){const h={appName:u.name};a.email&&(h.email=a.email),a.phoneNumber&&(h.phoneNumber=a.phoneNumber);const g=tt(u,o,h);return g.customData._tokenResponse=a,g}function Lt(u){return void 0!==u&&void 0!==u.getResponse}function Oi(u){return void 0!==u&&void 0!==u.enterprise}class Es{constructor(o){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=o.recaptchaEnforcementState}getProviderEnforcementState(o){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const a of this.recaptchaEnforcementState)if(a.provider&&a.provider===o)return Kn(a.enforcementState);return null}isProviderEnabled(o){return"ENFORCE"===this.getProviderEnforcementState(o)||"AUDIT"===this.getProviderEnforcementState(o)}}function Yt(){return(Yt=(0,A.A)(function*(u){return(yield $e(u,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function bs(u,o){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,A.A)(function*(u,o){return $e(u,"GET","/v2/recaptchaConfig",Ge(u,o))})).apply(this,arguments)}function Un(){return(Un=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Xt(){return(Xt=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function rn(u,o){return sn.apply(this,arguments)}function sn(){return(sn=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function _n(u){if(u)try{const o=new Date(Number(u));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function Hn(){return(Hn=(0,A.A)(function*(u,o=!1){const a=(0,$.Ku)(u),h=yield a.getIdToken(o),g=wr(h);ee(g&&g.exp&&g.auth_time&&g.iat,a.auth,"internal-error");const I="object"==typeof g.firebase?g.firebase:void 0,C=I?.sign_in_provider;return{claims:g,token:h,authTime:_n(Zr(g.auth_time)),issuedAtTime:_n(Zr(g.iat)),expirationTime:_n(Zr(g.exp)),signInProvider:C||null,signInSecondFactor:I?.sign_in_second_factor||null}})).apply(this,arguments)}function Zr(u){return 1e3*Number(u)}function wr(u){const[o,a,h]=u.split(".");if(void 0===o||void 0===a||void 0===h)return qt("JWT malformed, contained fewer than 3 sections"),null;try{const g=(0,$.u)(a);return g?JSON.parse(g):(qt("Failed to decode base64 JWT payload"),null)}catch(g){return qt("Caught error parsing JWT payload as JSON",g?.toString()),null}}function Cs(u){const o=wr(u);return ee(o,"internal-error"),ee(typeof o.exp<"u","internal-error"),ee(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}function yn(u,o){return Ss.apply(this,arguments)}function Ss(){return(Ss=(0,A.A)(function*(u,o,a=!1){if(a)return o;try{return yield o}catch(h){throw h instanceof $.g&&function Et({code:u}){return"auth/user-disabled"===u||"auth/user-token-expired"===u}(h)&&u.auth.currentUser===u&&(yield u.auth.signOut()),h}})).apply(this,arguments)}class Cr{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var a;if(o){const h=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),h}{this.errorBackoff=3e4;const g=(null!==(a=this.user.stsTokenManager.expirationTime)&&void 0!==a?a:0)-Date.now()-3e5;return Math.max(0,g)}}schedule(o=!1){var a=this;if(!this.isRunning)return;const h=this.getInterval(o);this.timerId=setTimeout((0,A.A)(function*(){yield a.iteration()}),h)}iteration(){var o=this;return(0,A.A)(function*(){try{yield o.user.getIdToken(!0)}catch(a){return void("auth/network-request-failed"===a?.code&&o.schedule(!0))}o.schedule()})()}}class Pn{constructor(o,a){this.createdAt=o,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=_n(this.lastLoginAt),this.creationTime=_n(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function or(u){return Jt.apply(this,arguments)}function Jt(){return(Jt=(0,A.A)(function*(u){var o;const a=u.auth,h=yield u.getIdToken(),g=yield yn(u,rn(a,{idToken:h}));ee(g?.users.length,a,"internal-error");const I=g.users[0];u._notifyReloadListener(I);const C=null!==(o=I.providerUserInfo)&&void 0!==o&&o.length?Sr(I.providerUserInfo):[],O=function Ps(u,o){return[...u.filter(h=>!o.some(g=>g.providerId===h.providerId)),...o]}(u.providerData,C),de=!!u.isAnonymous&&!(u.email&&I.passwordHash||O?.length),he={uid:I.localId,displayName:I.displayName||null,photoURL:I.photoUrl||null,email:I.email||null,emailVerified:I.emailVerified||!1,phoneNumber:I.phoneNumber||null,tenantId:I.tenantId||null,providerData:O,metadata:new Pn(I.createdAt,I.lastLoginAt),isAnonymous:de};Object.assign(u,he)})).apply(this,arguments)}function Vi(){return(Vi=(0,A.A)(function*(u){const o=(0,$.Ku)(u);yield or(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function Sr(u){return u.map(o=>{var{providerId:a}=o,h=(0,Gt.Tt)(o,["providerId"]);return{providerId:a,uid:h.rawId||"",displayName:h.displayName||null,email:h.email||null,phoneNumber:h.phoneNumber||null,photoURL:h.photoUrl||null}})}function b(){return(b=(0,A.A)(function*(u,o){const a=yield Ar(u,{},(0,A.A)(function*(){const h=(0,$.Am)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:g,apiKey:I}=u.config,C=Ts(u,g,"/v1/token",`key=${I}`),O=yield u._getAdditionalHeaders();return O["Content-Type"]="application/x-www-form-urlencoded",Eo.fetch()(C,{method:"POST",headers:O,body:h})}));return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}})).apply(this,arguments)}function Y(){return(Y=(0,A.A)(function*(u,o){return $e(u,"POST","/v2/accounts:revokeToken",Ge(u,o))})).apply(this,arguments)}class B{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){ee(o.idToken,"internal-error"),ee(typeof o.idToken<"u","internal-error"),ee(typeof o.refreshToken<"u","internal-error");const a="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):Cs(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,a)}updateFromIdToken(o){ee(0!==o.length,"internal-error");const a=Cs(o);this.updateTokensAndExpiration(o,null,a)}getToken(o,a=!1){var h=this;return(0,A.A)(function*(){return a||!h.accessToken||h.isExpired?(ee(h.refreshToken,o,"user-token-expired"),h.refreshToken?(yield h.refresh(o,h.refreshToken),h.accessToken):null):h.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,a){var h=this;return(0,A.A)(function*(){const{accessToken:g,refreshToken:I,expiresIn:C}=yield function R(u,o){return b.apply(this,arguments)}(o,a);h.updateTokensAndExpiration(g,I,Number(C))})()}updateTokensAndExpiration(o,a,h){this.refreshToken=a||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*h}static fromJSON(o,a){const{refreshToken:h,accessToken:g,expirationTime:I}=a,C=new B;return h&&(ee("string"==typeof h,"internal-error",{appName:o}),C.refreshToken=h),g&&(ee("string"==typeof g,"internal-error",{appName:o}),C.accessToken=g),I&&(ee("number"==typeof I,"internal-error",{appName:o}),C.expirationTime=I),C}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new B,this.toJSON())}_performRefresh(){return Rt("not implemented")}}function fe(u,o){ee("string"==typeof u||typeof u>"u","internal-error",{appName:o})}class Te{constructor(o){var{uid:a,auth:h,stsTokenManager:g}=o,I=(0,Gt.Tt)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Cr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=h,this.stsTokenManager=g,this.accessToken=g.accessToken,this.displayName=I.displayName||null,this.email=I.email||null,this.emailVerified=I.emailVerified||!1,this.phoneNumber=I.phoneNumber||null,this.photoURL=I.photoURL||null,this.isAnonymous=I.isAnonymous||!1,this.tenantId=I.tenantId||null,this.providerData=I.providerData?[...I.providerData]:[],this.metadata=new Pn(I.createdAt||void 0,I.lastLoginAt||void 0)}getIdToken(o){var a=this;return(0,A.A)(function*(){const h=yield yn(a,a.stsTokenManager.getToken(a.auth,o));return ee(h,a.auth,"internal-error"),a.accessToken!==h&&(a.accessToken=h,yield a.auth._persistUserIfCurrent(a),a.auth._notifyListenersIfCurrent(a)),h})()}getIdTokenResult(o){return function Jr(u){return Hn.apply(this,arguments)}(this,o)}reload(){return function Rs(u){return Vi.apply(this,arguments)}(this)}_assign(o){this!==o&&(ee(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(a=>Object.assign({},a)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const a=new Te(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return a.metadata._copy(this.metadata),a}_onReload(o){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,a=!1){var h=this;return(0,A.A)(function*(){let g=!1;o.idToken&&o.idToken!==h.stsTokenManager.accessToken&&(h.stsTokenManager.updateFromServerResponse(o),g=!0),a&&(yield or(h)),yield h.auth._persistUserIfCurrent(h),g&&h.auth._notifyListenersIfCurrent(h)})()}delete(){var o=this;return(0,A.A)(function*(){if((0,d._isFirebaseServerApp)(o.auth.app))return Promise.reject(be(o.auth));const a=yield o.getIdToken();return yield yn(o,function ws(u,o){return Un.apply(this,arguments)}(o.auth,{idToken:a})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,a){var h,g,I,C,O,K,se,de;const he=null!==(h=a.displayName)&&void 0!==h?h:void 0,lt=null!==(g=a.email)&&void 0!==g?g:void 0,En=null!==(I=a.phoneNumber)&&void 0!==I?I:void 0,ls=null!==(C=a.photoURL)&&void 0!==C?C:void 0,dl=null!==(O=a.tenantId)&&void 0!==O?O:void 0,hl=null!==(K=a._redirectEventId)&&void 0!==K?K:void 0,fl=null!==(se=a.createdAt)&&void 0!==se?se:void 0,so=null!==(de=a.lastLoginAt)&&void 0!==de?de:void 0,{uid:oo,emailVerified:md,isAnonymous:gd,providerData:Nt,stsTokenManager:_d}=a;ee(oo&&_d,o,"internal-error");const yd=B.fromJSON(this.name,_d);ee("string"==typeof oo,o,"internal-error"),fe(he,o.name),fe(lt,o.name),ee("boolean"==typeof md,o,"internal-error"),ee("boolean"==typeof gd,o,"internal-error"),fe(En,o.name),fe(ls,o.name),fe(dl,o.name),fe(hl,o.name),fe(fl,o.name),fe(so,o.name);const us=new Te({uid:oo,auth:o,email:lt,emailVerified:md,displayName:he,isAnonymous:gd,photoURL:ls,phoneNumber:En,tenantId:dl,stsTokenManager:yd,createdAt:fl,lastLoginAt:so});return Nt&&Array.isArray(Nt)&&(us.providerData=Nt.map(ao=>Object.assign({},ao))),hl&&(us._redirectEventId=hl),us}static _fromIdTokenResponse(o,a,h=!1){return(0,A.A)(function*(){const g=new B;g.updateFromServerResponse(a);const I=new Te({uid:a.localId,auth:o,stsTokenManager:g,isAnonymous:h});return yield or(I),I})()}static _fromGetAccountInfoResponse(o,a,h){return(0,A.A)(function*(){const g=a.users[0];ee(void 0!==g.localId,"internal-error");const I=void 0!==g.providerUserInfo?Sr(g.providerUserInfo):[],C=!(g.email&&g.passwordHash||I?.length),O=new B;O.updateFromIdToken(h);const K=new Te({uid:g.localId,auth:o,stsTokenManager:O,isAnonymous:C}),se={uid:g.localId,displayName:g.displayName||null,photoURL:g.photoUrl||null,email:g.email||null,emailVerified:g.emailVerified||!1,phoneNumber:g.phoneNumber||null,tenantId:g.tenantId||null,providerData:I,metadata:new Pn(g.createdAt,g.lastLoginAt),isAnonymous:!(g.email&&g.passwordHash||I?.length)};return Object.assign(K,se),K})()}}const Ye=new Map;function Ke(u){$t(u instanceof Function,"Expected a class definition");let o=Ye.get(u);return o?($t(o instanceof u,"Instance stored in cache mismatched with class"),o):(o=new u,Ye.set(u,o),o)}const kt=(()=>{class u{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,A.A)(function*(){return!0})()}_set(a,h){var g=this;return(0,A.A)(function*(){g.storage[a]=h})()}_get(a){var h=this;return(0,A.A)(function*(){const g=h.storage[a];return void 0===g?null:g})()}_remove(a){var h=this;return(0,A.A)(function*(){delete h.storage[a]})()}_addListener(a,h){}_removeListener(a,h){}}return u.type="NONE",u})();function xe(u,o,a){return`firebase:${u}:${o}:${a}`}class At{constructor(o,a,h){this.persistence=o,this.auth=a,this.userKey=h;const{config:g,name:I}=this.auth;this.fullUserKey=xe(this.userKey,g.apiKey,I),this.fullPersistenceKey=xe("persistence",g.apiKey,I),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,A.A)(function*(){const a=yield o.persistence._get(o.fullUserKey);return a?Te._fromJSON(o.auth,a):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var a=this;return(0,A.A)(function*(){if(a.persistence===o)return;const h=yield a.getCurrentUser();return yield a.removeCurrentUser(),a.persistence=o,h?a.setCurrentUser(h):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,a,h="authUser"){return(0,A.A)(function*(){if(!a.length)return new At(Ke(kt),o,h);const g=(yield Promise.all(a.map(function(){var se=(0,A.A)(function*(de){if(yield de._isAvailable())return de});return function(de){return se.apply(this,arguments)}}()))).filter(se=>se);let I=g[0]||Ke(kt);const C=xe(h,o.config.apiKey,o.name);let O=null;for(const se of a)try{const de=yield se._get(C);if(de){const he=Te._fromJSON(o,de);se!==I&&(O=he),I=se;break}}catch{}const K=g.filter(se=>se._shouldAllowMigration);return I._shouldAllowMigration&&K.length?(I=K[0],O&&(yield I._set(C,O.toJSON())),yield Promise.all(a.map(function(){var se=(0,A.A)(function*(de){if(de!==I)try{yield de._remove(C)}catch{}});return function(de){return se.apply(this,arguments)}}())),new At(I,o,h)):new At(I,o,h)})()}}function Wn(u){const o=u.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(H(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(Rr(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(vn(o))return"Blackberry";if(Ue(o))return"Webos";if(ei(o))return"Safari";if((o.includes("chrome/")||wo(o))&&!o.includes("edge/"))return"Chrome";if(Pr(o))return"Android";{const h=u.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===h?.length)return h[1]}return"Other"}function Rr(u=(0,$.ZQ)()){return/firefox\//i.test(u)}function ei(u=(0,$.ZQ)()){const o=u.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function wo(u=(0,$.ZQ)()){return/crios\//i.test(u)}function H(u=(0,$.ZQ)()){return/iemobile/i.test(u)}function Pr(u=(0,$.ZQ)()){return/android/i.test(u)}function vn(u=(0,$.ZQ)()){return/blackberry/i.test(u)}function Ue(u=(0,$.ZQ)()){return/webos/i.test(u)}function ar(u=(0,$.ZQ)()){return/iphone|ipad|ipod/i.test(u)||/macintosh/i.test(u)&&/mobile/i.test(u)}function ue(u=(0,$.ZQ)()){return ar(u)||Pr(u)||Ue(u)||vn(u)||/windows phone/i.test(u)||H(u)}function we(u,o=[]){let a;switch(u){case"Browser":a=Wn((0,$.ZQ)());break;case"Worker":a=`${Wn((0,$.ZQ)())}-${u}`;break;default:a=u}const h=o.length?o.join(","):"FirebaseCore-web";return`${a}/JsCore/${d.SDK_VERSION}/${h}`}class De{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,a){const h=I=>new Promise((C,O)=>{try{C(o(I))}catch(K){O(K)}});h.onAbort=a,this.queue.push(h);const g=this.queue.length-1;return()=>{this.queue[g]=()=>Promise.resolve()}}runMiddleware(o){var a=this;return(0,A.A)(function*(){if(a.auth.currentUser===o)return;const h=[];try{for(const g of a.queue)yield g(o),g.onAbort&&h.push(g.onAbort)}catch(g){h.reverse();for(const I of h)try{I()}catch{}throw a.auth._errorFactory.create("login-blocked",{originalMessage:g?.message})}})()}}function Je(){return(Je=(0,A.A)(function*(u,o={}){return $e(u,"GET","/v2/passwordPolicy",Ge(u,o))})).apply(this,arguments)}class cr{constructor(o){var a,h,g,I;const C=o.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(a=C.minPasswordLength)&&void 0!==a?a:6,C.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=C.maxPasswordLength),void 0!==C.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=C.containsLowercaseCharacter),void 0!==C.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=C.containsUppercaseCharacter),void 0!==C.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=C.containsNumericCharacter),void 0!==C.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=C.containsNonAlphanumericCharacter),this.enforcementState=o.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(g=null===(h=o.allowedNonAlphanumericCharacters)||void 0===h?void 0:h.join(""))&&void 0!==g?g:"",this.forceUpgradeOnSignin=null!==(I=o.forceUpgradeOnSignin)&&void 0!==I&&I,this.schemaVersion=o.schemaVersion}validatePassword(o){var a,h,g,I,C,O;const K={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(o,K),this.validatePasswordCharacterOptions(o,K),K.isValid&&(K.isValid=null===(a=K.meetsMinPasswordLength)||void 0===a||a),K.isValid&&(K.isValid=null===(h=K.meetsMaxPasswordLength)||void 0===h||h),K.isValid&&(K.isValid=null===(g=K.containsLowercaseLetter)||void 0===g||g),K.isValid&&(K.isValid=null===(I=K.containsUppercaseLetter)||void 0===I||I),K.isValid&&(K.isValid=null===(C=K.containsNumericCharacter)||void 0===C||C),K.isValid&&(K.isValid=null===(O=K.containsNonAlphanumericCharacter)||void 0===O||O),K}validatePasswordLengthOptions(o,a){const h=this.customStrengthOptions.minPasswordLength,g=this.customStrengthOptions.maxPasswordLength;h&&(a.meetsMinPasswordLength=o.length>=h),g&&(a.meetsMaxPasswordLength=o.length<=g)}validatePasswordCharacterOptions(o,a){let h;this.updatePasswordCharacterOptionsStatuses(a,!1,!1,!1,!1);for(let g=0;g<o.length;g++)h=o.charAt(g),this.updatePasswordCharacterOptionsStatuses(a,h>="a"&&h<="z",h>="A"&&h<="Z",h>="0"&&h<="9",this.allowedNonAlphanumericCharacters.includes(h))}updatePasswordCharacterOptionsStatuses(o,a,h,g,I){this.customStrengthOptions.containsLowercaseLetter&&(o.containsLowercaseLetter||(o.containsLowercaseLetter=a)),this.customStrengthOptions.containsUppercaseLetter&&(o.containsUppercaseLetter||(o.containsUppercaseLetter=h)),this.customStrengthOptions.containsNumericCharacter&&(o.containsNumericCharacter||(o.containsNumericCharacter=g)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(o.containsNonAlphanumericCharacter||(o.containsNonAlphanumericCharacter=I))}}class Co{constructor(o,a,h,g){this.app=o,this.heartbeatServiceProvider=a,this.appCheckServiceProvider=h,this.config=g,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ya(this),this.idTokenSubscription=new Ya(this),this.beforeStateQueue=new De(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ve,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=g.sdkClientVersion}_initializeWithPersistence(o,a){var h=this;return a&&(this._popupRedirectResolver=Ke(a)),this._initializationPromise=this.queue((0,A.A)(function*(){var g,I;if(!h._deleted&&(h.persistenceManager=yield At.create(h,o),!h._deleted)){if(null!==(g=h._popupRedirectResolver)&&void 0!==g&&g._shouldInitProactively)try{yield h._popupRedirectResolver._initialize(h)}catch{}yield h.initializeCurrentUser(a),h.lastNotifiedUid=(null===(I=h.currentUser)||void 0===I?void 0:I.uid)||null,!h._deleted&&(h._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,A.A)(function*(){if(o._deleted)return;const a=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||a){if(o.currentUser&&a&&o.currentUser.uid===a.uid)return o._currentUser._assign(a),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(a,!0)}})()}initializeCurrentUserFromIdToken(o){var a=this;return(0,A.A)(function*(){try{const h=yield rn(a,{idToken:o}),g=yield Te._fromGetAccountInfoResponse(a,h,o);yield a.directlySetCurrentUser(g)}catch(h){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",h),yield a.directlySetCurrentUser(null)}})()}initializeCurrentUser(o){var a=this;return(0,A.A)(function*(){var h;if((0,d._isFirebaseServerApp)(a.app)){const O=a.app.settings.authIdToken;return O?new Promise(K=>{setTimeout(()=>a.initializeCurrentUserFromIdToken(O).then(K,K))}):a.directlySetCurrentUser(null)}const g=yield a.assertedPersistence.getCurrentUser();let I=g,C=!1;if(o&&a.config.authDomain){yield a.getOrInitRedirectPersistenceManager();const O=null===(h=a.redirectUser)||void 0===h?void 0:h._redirectEventId,K=I?._redirectEventId,se=yield a.tryRedirectSignIn(o);(!O||O===K)&&se?.user&&(I=se.user,C=!0)}if(!I)return a.directlySetCurrentUser(null);if(!I._redirectEventId){if(C)try{yield a.beforeStateQueue.runMiddleware(I)}catch(O){I=g,a._popupRedirectResolver._overrideRedirectResult(a,()=>Promise.reject(O))}return I?a.reloadAndSetCurrentUserOrClear(I):a.directlySetCurrentUser(null)}return ee(a._popupRedirectResolver,a,"argument-error"),yield a.getOrInitRedirectPersistenceManager(),a.redirectUser&&a.redirectUser._redirectEventId===I._redirectEventId?a.directlySetCurrentUser(I):a.reloadAndSetCurrentUserOrClear(I)})()}tryRedirectSignIn(o){var a=this;return(0,A.A)(function*(){let h=null;try{h=yield a._popupRedirectResolver._completeRedirectFn(a,o,!0)}catch{yield a._setRedirectUser(null)}return h})()}reloadAndSetCurrentUserOrClear(o){var a=this;return(0,A.A)(function*(){try{yield or(o)}catch(h){if("auth/network-request-failed"!==h?.code)return a.directlySetCurrentUser(null)}return a.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function Tr(){if(typeof navigator>"u")return null;const u=navigator;return u.languages&&u.languages[0]||u.language||null}()}_delete(){var o=this;return(0,A.A)(function*(){o._deleted=!0})()}updateCurrentUser(o){var a=this;return(0,A.A)(function*(){if((0,d._isFirebaseServerApp)(a.app))return Promise.reject(be(a));const h=o?(0,$.Ku)(o):null;return h&&ee(h.auth.config.apiKey===a.config.apiKey,a,"invalid-user-token"),a._updateCurrentUser(h&&h._clone(a))})()}_updateCurrentUser(o,a=!1){var h=this;return(0,A.A)(function*(){if(!h._deleted)return o&&ee(h.tenantId===o.tenantId,h,"tenant-id-mismatch"),a||(yield h.beforeStateQueue.runMiddleware(o)),h.queue((0,A.A)(function*(){yield h.directlySetCurrentUser(o),h.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,A.A)(function*(){return(0,d._isFirebaseServerApp)(o.app)?Promise.reject(be(o)):(yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0))})()}setPersistence(o){var a=this;return(0,d._isFirebaseServerApp)(this.app)?Promise.reject(be(this)):this.queue((0,A.A)(function*(){yield a.assertedPersistence.setPersistence(Ke(o))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(o){var a=this;return(0,A.A)(function*(){a._getPasswordPolicyInternal()||(yield a._updatePasswordPolicy());const h=a._getPasswordPolicyInternal();return h.schemaVersion!==a.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(a._errorFactory.create("unsupported-password-policy-schema-version",{})):h.validatePassword(o)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var o=this;return(0,A.A)(function*(){const a=yield function Xe(u){return Je.apply(this,arguments)}(o),h=new cr(a);null===o.tenantId?o._projectPasswordPolicy=h:o._tenantPasswordPolicies[o.tenantId]=h})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new $.FA("auth","Firebase",o())}onAuthStateChanged(o,a,h){return this.registerStateListener(this.authStateSubscription,o,a,h)}beforeAuthStateChanged(o,a){return this.beforeStateQueue.pushCallback(o,a)}onIdTokenChanged(o,a,h){return this.registerStateListener(this.idTokenSubscription,o,a,h)}authStateReady(){return new Promise((o,a)=>{if(this.currentUser)o();else{const h=this.onAuthStateChanged(()=>{h(),o()},a)}})}revokeAccessToken(o){var a=this;return(0,A.A)(function*(){if(a.currentUser){const h=yield a.currentUser.getIdToken(),g={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:o,idToken:h};null!=a.tenantId&&(g.tenantId=a.tenantId),yield function D(u,o){return Y.apply(this,arguments)}(a,g)}})()}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,a){var h=this;return(0,A.A)(function*(){const g=yield h.getOrInitRedirectPersistenceManager(a);return null===o?g.removeCurrentUser():g.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var a=this;return(0,A.A)(function*(){if(!a.redirectPersistenceManager){const h=o&&Ke(o)||a._popupRedirectResolver;ee(h,a,"argument-error"),a.redirectPersistenceManager=yield At.create(a,[Ke(h._redirectPersistence)],"redirectUser"),a.redirectUser=yield a.redirectPersistenceManager.getCurrentUser()}return a.redirectPersistenceManager})()}_redirectUserForId(o){var a=this;return(0,A.A)(function*(){var h,g;return a._isInitialized&&(yield a.queue((0,A.A)(function*(){}))),(null===(h=a._currentUser)||void 0===h?void 0:h._redirectEventId)===o?a._currentUser:(null===(g=a.redirectUser)||void 0===g?void 0:g._redirectEventId)===o?a.redirectUser:null})()}_persistUserIfCurrent(o){var a=this;return(0,A.A)(function*(){if(o===a.currentUser)return a.queue((0,A.A)(function*(){return a.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const h=null!==(a=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==a?a:null;this.lastNotifiedUid!==h&&(this.lastNotifiedUid=h,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,a,h,g){if(this._deleted)return()=>{};const I="function"==typeof a?a:a.next.bind(a);let C=!1;const O=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(O,this,"internal-error"),O.then(()=>{C||I(this.currentUser)}),"function"==typeof a){const K=o.addObserver(a,h,g);return()=>{C=!0,K()}}{const K=o.addObserver(a);return()=>{C=!0,K()}}}directlySetCurrentUser(o){var a=this;return(0,A.A)(function*(){a.currentUser&&a.currentUser!==o&&a._currentUser._stopProactiveRefresh(),o&&a.isProactiveRefreshEnabled&&o._startProactiveRefresh(),a.currentUser=o,o?yield a.assertedPersistence.setCurrentUser(o):yield a.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=we(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,A.A)(function*(){var a;const h={"X-Client-Version":o.clientVersion};o.app.options.appId&&(h["X-Firebase-gmpid"]=o.app.options.appId);const g=yield null===(a=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getHeartbeatsHeader();g&&(h["X-Firebase-Client"]=g);const I=yield o._getAppCheckToken();return I&&(h["X-Firebase-AppCheck"]=I),h})()}_getAppCheckToken(){var o=this;return(0,A.A)(function*(){var a;const h=yield null===(a=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getToken();return h?.error&&function pn(u,...o){Vt.logLevel<=Ne.$b.WARN&&Vt.warn(`Auth (${d.SDK_VERSION}): ${u}`,...o)}(`Error while retrieving App Check token: ${h.error}`),h?.token})()}}function nt(u){return(0,$.Ku)(u)}class Ya{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,$.tD)(a=>this.observer=a)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Mi={loadJS:()=>(0,A.A)(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xr(u){return Mi.loadJS(u)}function Z(u){return`__${u}${Math.floor(1e6*Math.random())}`}class So{constructor(o){this.type="recaptcha-enterprise",this.auth=nt(o)}verify(o="verify",a=!1){var h=this;return(0,A.A)(function*(){function I(){return I=(0,A.A)(function*(O){if(!a){if(null==O.tenantId&&null!=O._agentRecaptchaConfig)return O._agentRecaptchaConfig.siteKey;if(null!=O.tenantId&&void 0!==O._tenantRecaptchaConfigs[O.tenantId])return O._tenantRecaptchaConfigs[O.tenantId].siteKey}return new Promise(function(){var K=(0,A.A)(function*(se,de){bs(O,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(he=>{if(void 0!==he.recaptchaKey){const lt=new Es(he);return null==O.tenantId?O._agentRecaptchaConfig=lt:O._tenantRecaptchaConfigs[O.tenantId]=lt,se(lt.siteKey)}de(new Error("recaptcha Enterprise site key undefined"))}).catch(he=>{de(he)})});return function(se,de){return K.apply(this,arguments)}}())}),I.apply(this,arguments)}function C(O,K,se){const de=window.grecaptcha;Oi(de)?de.enterprise.ready(()=>{de.enterprise.execute(O,{action:o}).then(he=>{K(he)}).catch(()=>{K("NO_RECAPTCHA")})}):se(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((O,K)=>{(function g(O){return I.apply(this,arguments)})(h.auth).then(se=>{if(!a&&Oi(window.grecaptcha))C(se,O,K);else{if(typeof window>"u")return void K(new Error("RecaptchaVerifier is only supported in browser"));let de=function Li(){return Mi.recaptchaEnterpriseScript}();0!==de.length&&(de+=se),xr(de).then(()=>{C(se,O,K)}).catch(he=>{K(he)})}}).catch(se=>{K(se)})})})()}}function pe(u,o,a){return ge.apply(this,arguments)}function ge(){return(ge=(0,A.A)(function*(u,o,a,h=!1){const g=new So(u);let I;try{I=yield g.verify(a)}catch{I=yield g.verify(a,!0)}const C=Object.assign({},o);return Object.assign(C,h?{captchaResp:I}:{captchaResponse:I}),Object.assign(C,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(C,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),C})).apply(this,arguments)}function xs(u,o,a,h){return ie.apply(this,arguments)}function ie(){return ie=(0,A.A)(function*(u,o,a,h){var g;if(null!==(g=u._getRecaptchaConfig())&&void 0!==g&&g.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const I=yield pe(u,o,a,"getOobCode"===a);return h(u,I)}return h(u,o).catch(function(){var I=(0,A.A)(function*(C){if("auth/missing-recaptcha-token"===C.code){console.log(`${a} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const O=yield pe(u,o,a,"getOobCode"===a);return h(u,O)}return Promise.reject(C)});return function(C){return I.apply(this,arguments)}}())}),ie.apply(this,arguments)}function Ql(u){const o=u.indexOf(":");return o<0?"":u.substr(0,o+1)}function Yl(u){if(!u)return null;const o=Number(u);return isNaN(o)?null:o}class ti{constructor(o,a){this.providerId=o,this.signInMethod=a}toJSON(){return Rt("not implemented")}_getIdTokenResponse(o){return Rt("not implemented")}_linkToIdToken(o,a){return Rt("not implemented")}_getReauthenticationResolver(o){return Rt("not implemented")}}function Xl(u,o){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:resetPassword",Ge(u,o))})).apply(this,arguments)}function Ro(){return(Ro=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Ce(u,o){return kr.apply(this,arguments)}function kr(){return(kr=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:signUp",o)})).apply(this,arguments)}function rt(){return(rt=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:update",Ge(u,o))})).apply(this,arguments)}function _e(u,o){return ni.apply(this,arguments)}function ni(){return(ni=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithPassword",Ge(u,o))})).apply(this,arguments)}function Oe(u,o){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:sendOobCode",Ge(u,o))})).apply(this,arguments)}function ae(){return(ae=(0,A.A)(function*(u,o){return Oe(u,o)})).apply(this,arguments)}function Fi(u,o){return Ds.apply(this,arguments)}function Ds(){return(Ds=(0,A.A)(function*(u,o){return Oe(u,o)})).apply(this,arguments)}function ri(u,o){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,A.A)(function*(u,o){return Oe(u,o)})).apply(this,arguments)}function Za(){return(Za=(0,A.A)(function*(u,o){return Oe(u,o)})).apply(this,arguments)}function Po(){return(Po=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithEmailLink",Ge(u,o))})).apply(this,arguments)}function Zt(){return(Zt=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithEmailLink",Ge(u,o))})).apply(this,arguments)}class si extends ti{constructor(o,a,h,g=null){super("password",h),this._email=o,this._password=a,this._tenantId=g}static _fromEmailAndPassword(o,a){return new si(o,a,"password")}static _fromEmailAndCode(o,a,h=null){return new si(o,a,"emailLink",h)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o;if(a?.email&&a?.password){if("password"===a.signInMethod)return this._fromEmailAndPassword(a.email,a.password);if("emailLink"===a.signInMethod)return this._fromEmailAndCode(a.email,a.password,a.tenantId)}return null}_getIdTokenResponse(o){var a=this;return(0,A.A)(function*(){switch(a.signInMethod){case"password":return xs(o,{returnSecureToken:!0,email:a._email,password:a._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",_e);case"emailLink":return function Ui(u,o){return Po.apply(this,arguments)}(o,{email:a._email,oobCode:a._password});default:ot(o,"internal-error")}})()}_linkToIdToken(o,a){var h=this;return(0,A.A)(function*(){switch(h.signInMethod){case"password":return xs(o,{idToken:a,returnSecureToken:!0,email:h._email,password:h._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ce);case"emailLink":return function eu(u,o){return Zt.apply(this,arguments)}(o,{idToken:a,email:h._email,oobCode:h._password});default:ot(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function Qn(u,o){return xo.apply(this,arguments)}function xo(){return(xo=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithIdp",Ge(u,o))})).apply(this,arguments)}class xn extends ti{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const a=new xn(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(a.idToken=o.idToken),o.accessToken&&(a.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(a.nonce=o.nonce),o.pendingToken&&(a.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(a.accessToken=o.oauthToken,a.secret=o.oauthTokenSecret):ot("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:g}=a,I=(0,Gt.Tt)(a,["providerId","signInMethod"]);if(!h||!g)return null;const C=new xn(h,g);return C.idToken=I.idToken||void 0,C.accessToken=I.accessToken||void 0,C.secret=I.secret,C.nonce=I.nonce,C.pendingToken=I.pendingToken||null,C}_getIdTokenResponse(o){return Qn(o,this.buildRequest())}_linkToIdToken(o,a){const h=this.buildRequest();return h.idToken=a,Qn(o,h)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Qn(o,a)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),o.postBody=(0,$.Am)(a)}return o}}function Bi(){return(Bi=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:sendVerificationCode",Ge(u,o))})).apply(this,arguments)}function Do(){return(Do=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithPhoneNumber",Ge(u,o))})).apply(this,arguments)}function oi(){return(oi=(0,A.A)(function*(u,o){const a=yield Mt(u,"POST","/v1/accounts:signInWithPhoneNumber",Ge(u,o));if(a.temporaryProof)throw br(u,"account-exists-with-different-credential",a);return a})).apply(this,arguments)}const Nr={USER_NOT_FOUND:"user-not-found"};function lr(){return(lr=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithPhoneNumber",Ge(u,Object.assign(Object.assign({},o),{operation:"REAUTH"})),Nr)})).apply(this,arguments)}class Vr extends ti{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,a){return new Vr({verificationId:o,verificationCode:a})}static _fromTokenResponse(o,a){return new Vr({phoneNumber:o,temporaryProof:a})}_getIdTokenResponse(o){return function Yn(u,o){return Do.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,a){return function ch(u,o){return oi.apply(this,arguments)}(o,Object.assign({idToken:a},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function lh(u,o){return lr.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:a,verificationId:h,verificationCode:g}=this.params;return o&&a?{temporaryProof:o,phoneNumber:a}:{sessionInfo:h,code:g}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:a,verificationCode:h,phoneNumber:g,temporaryProof:I}=o;return h||a||g||I?new Vr({verificationId:a,verificationCode:h,phoneNumber:g,temporaryProof:I}):null}}class ks{constructor(o){var a,h,g,I,C,O;const K=(0,$.I9)((0,$.hp)(o)),se=null!==(a=K.apiKey)&&void 0!==a?a:null,de=null!==(h=K.oobCode)&&void 0!==h?h:null,he=function ec(u){switch(u){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(g=K.mode)&&void 0!==g?g:null);ee(se&&de&&he,"argument-error"),this.apiKey=se,this.operation=he,this.code=de,this.continueUrl=null!==(I=K.continueUrl)&&void 0!==I?I:null,this.languageCode=null!==(C=K.languageCode)&&void 0!==C?C:null,this.tenantId=null!==(O=K.tenantId)&&void 0!==O?O:null}static parseLink(o){const a=function uh(u){const o=(0,$.I9)((0,$.hp)(u)).link,a=o?(0,$.I9)((0,$.hp)(o)).deep_link_id:null,h=(0,$.I9)((0,$.hp)(u)).deep_link_id;return(h?(0,$.I9)((0,$.hp)(h)).link:null)||h||a||o||u}(o);try{return new ks(a)}catch{return null}}}let ai=(()=>{class u{constructor(){this.providerId=u.PROVIDER_ID}static credential(a,h){return si._fromEmailAndPassword(a,h)}static credentialWithLink(a,h){const g=ks.parseLink(h);return ee(g,"argument-error"),si._fromEmailAndCode(a,g.code,g.tenantId)}}return u.PROVIDER_ID="password",u.EMAIL_PASSWORD_SIGN_IN_METHOD="password",u.EMAIL_LINK_SIGN_IN_METHOD="emailLink",u})();class In{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class ci extends In{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class It extends ci{static credentialFromJSON(o){const a="string"==typeof o?JSON.parse(o):o;return ee("providerId"in a&&"signInMethod"in a,"argument-error"),xn._fromParams(a)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return ee(o.idToken||o.accessToken,"argument-error"),xn._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return It.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return It.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:a,oauthAccessToken:h,oauthTokenSecret:g,pendingToken:I,nonce:C,providerId:O}=o;if(!h&&!g&&!a&&!I||!O)return null;try{return new It(O)._credential({idToken:a,accessToken:h,nonce:C,pendingToken:I})}catch{return null}}}let tu=(()=>{class u extends ci{constructor(){super("facebook.com")}static credential(a){return xn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return u.credentialFromTaggedObject(a)}static credentialFromError(a){return u.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return u.credential(a.oauthAccessToken)}catch{return null}}}return u.FACEBOOK_SIGN_IN_METHOD="facebook.com",u.PROVIDER_ID="facebook.com",u})(),tc=(()=>{class u extends ci{constructor(){super("google.com"),this.addScope("profile")}static credential(a,h){return xn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:h})}static credentialFromResult(a){return u.credentialFromTaggedObject(a)}static credentialFromError(a){return u.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthIdToken:h,oauthAccessToken:g}=a;if(!h&&!g)return null;try{return u.credential(h,g)}catch{return null}}}return u.GOOGLE_SIGN_IN_METHOD="google.com",u.PROVIDER_ID="google.com",u})(),Bn=(()=>{class u extends ci{constructor(){super("github.com")}static credential(a){return xn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return u.credentialFromTaggedObject(a)}static credentialFromError(a){return u.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return u.credential(a.oauthAccessToken)}catch{return null}}}return u.GITHUB_SIGN_IN_METHOD="github.com",u.PROVIDER_ID="github.com",u})();class ur extends ti{constructor(o,a){super(o,o),this.pendingToken=a}_getIdTokenResponse(o){return Qn(o,this.buildRequest())}_linkToIdToken(o,a){const h=this.buildRequest();return h.idToken=a,Qn(o,h)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Qn(o,a)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:h,signInMethod:g,pendingToken:I}=a;return h&&g&&I&&h===g?new ur(h,I):null}static _create(o,a){return new ur(o,a)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ko extends In{constructor(o){ee(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return ko.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return ko.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const a=ur.fromJSON(o);return ee(a,"argument-error"),a}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:a,providerId:h}=o;if(!a||!h)return null;try{return ur._create(h,a)}catch{return null}}}let iu=(()=>{class u extends ci{constructor(){super("twitter.com")}static credential(a,h){return xn._fromParams({providerId:u.PROVIDER_ID,signInMethod:u.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:h})}static credentialFromResult(a){return u.credentialFromTaggedObject(a)}static credentialFromError(a){return u.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthAccessToken:h,oauthTokenSecret:g}=a;if(!h||!g)return null;try{return u.credential(h,g)}catch{return null}}}return u.TWITTER_SIGN_IN_METHOD="twitter.com",u.PROVIDER_ID="twitter.com",u})();function su(u,o){return nc.apply(this,arguments)}function nc(){return(nc=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signUp",Ge(u,o))})).apply(this,arguments)}class kn{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,a,h,g=!1){return(0,A.A)(function*(){const I=yield Te._fromIdTokenResponse(o,h,g),C=ou(h);return new kn({user:I,providerId:C,_tokenResponse:h,operationType:a})})()}static _forOperation(o,a,h){return(0,A.A)(function*(){yield o._updateTokensIfNecessary(h,!0);const g=ou(h);return new kn({user:o,providerId:g,_tokenResponse:h,operationType:a})})()}}function ou(u){return u.providerId?u.providerId:"phoneNumber"in u?"phone":null}function rc(){return(rc=(0,A.A)(function*(u){var o;if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const a=nt(u);if(yield a._initializationPromise,null!==(o=a.currentUser)&&void 0!==o&&o.isAnonymous)return new kn({user:a.currentUser,providerId:null,operationType:"signIn"});const h=yield su(a,{returnSecureToken:!0}),g=yield kn._fromIdTokenResponse(a,"signIn",h,!0);return yield a._updateCurrentUser(g.user),g})).apply(this,arguments)}class Oo extends $.g{constructor(o,a,h,g){var I;super(a.code,a.message),this.operationType=h,this.user=g,Object.setPrototypeOf(this,Oo.prototype),this.customData={appName:o.name,tenantId:null!==(I=o.tenantId)&&void 0!==I?I:void 0,_serverResponse:a.customData._serverResponse,operationType:h}}static _fromErrorAndOperation(o,a,h,g){return new Oo(o,a,h,g)}}function au(u,o,a,h){return("reauthenticate"===o?a._getReauthenticationResolver(u):a._getIdTokenResponse(u)).catch(I=>{throw"auth/multi-factor-auth-required"===I.code?Oo._fromErrorAndOperation(u,I,o,h):I})}function cu(u){return new Set(u.map(({providerId:o})=>o).filter(o=>!!o))}function ic(){return ic=(0,A.A)(function*(u,o){const a=(0,$.Ku)(u);yield Os(!0,a,o);const{providerUserInfo:h}=yield function bo(u,o){return Xt.apply(this,arguments)}(a.auth,{idToken:yield a.getIdToken(),deleteProvider:[o]}),g=cu(h||[]);return a.providerData=a.providerData.filter(I=>g.has(I.providerId)),g.has("phone")||(a.phoneNumber=null),yield a.auth._persistUserIfCurrent(a),a}),ic.apply(this,arguments)}function sc(u,o){return oc.apply(this,arguments)}function oc(){return(oc=(0,A.A)(function*(u,o,a=!1){const h=yield yn(u,o._linkToIdToken(u.auth,yield u.getIdToken()),a);return kn._forOperation(u,"link",h)})).apply(this,arguments)}function Os(u,o,a){return ac.apply(this,arguments)}function ac(){return(ac=(0,A.A)(function*(u,o,a){yield or(o);const g=!1===u?"provider-already-linked":"no-such-provider";ee(cu(o.providerData).has(a)===u,o.auth,g)})).apply(this,arguments)}function cc(u,o){return No.apply(this,arguments)}function No(){return(No=(0,A.A)(function*(u,o,a=!1){const{auth:h}=u;if((0,d._isFirebaseServerApp)(h.app))return Promise.reject(be(h));const g="reauthenticate";try{const I=yield yn(u,au(h,g,o,u),a);ee(I.idToken,h,"internal-error");const C=wr(I.idToken);ee(C,h,"internal-error");const{sub:O}=C;return ee(u.uid===O,h,"user-mismatch"),kn._forOperation(u,g,I)}catch(I){throw"auth/user-not-found"===I?.code&&ot(h,"user-mismatch"),I}})).apply(this,arguments)}function lc(u,o){return uc.apply(this,arguments)}function uc(){return(uc=(0,A.A)(function*(u,o,a=!1){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h="signIn",g=yield au(u,h,o),I=yield kn._fromIdTokenResponse(u,h,g);return a||(yield u._updateCurrentUser(I.user)),I})).apply(this,arguments)}function Gi(u,o){return bt.apply(this,arguments)}function bt(){return(bt=(0,A.A)(function*(u,o){return lc(nt(u),o)})).apply(this,arguments)}function dc(u,o){return Xn.apply(this,arguments)}function Xn(){return(Xn=(0,A.A)(function*(u,o){const a=(0,$.Ku)(u);return yield Os(!1,a,o.providerId),sc(a,o)})).apply(this,arguments)}function hc(u,o){return Vo.apply(this,arguments)}function Vo(){return(Vo=(0,A.A)(function*(u,o){return cc((0,$.Ku)(u),o)})).apply(this,arguments)}function zi(){return(zi=(0,A.A)(function*(u,o){return Mt(u,"POST","/v1/accounts:signInWithCustomToken",Ge(u,o))})).apply(this,arguments)}function ze(){return ze=(0,A.A)(function*(u,o){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const a=nt(u),h=yield function it(u,o){return zi.apply(this,arguments)}(a,{token:o,returnSecureToken:!0}),g=yield kn._fromIdTokenResponse(a,"signIn",h);return yield a._updateCurrentUser(g.user),g}),ze.apply(this,arguments)}class ji{constructor(o,a){this.factorId=o,this.uid=a.mfaEnrollmentId,this.enrollmentTime=new Date(a.enrolledAt).toUTCString(),this.displayName=a.displayName}static _fromServerResponse(o,a){return"phoneInfo"in a?Mr._fromServerResponse(o,a):"totpInfo"in a?Ht._fromServerResponse(o,a):ot(o,"internal-error")}}class Mr extends ji{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,a){return new Mr(a)}}class Ht extends ji{constructor(o){super("totp",o)}static _fromServerResponse(o,a){return new Ht(a)}}function Ns(u,o,a){var h;ee((null===(h=a.url)||void 0===h?void 0:h.length)>0,u,"invalid-continue-uri"),ee(typeof a.dynamicLinkDomain>"u"||a.dynamicLinkDomain.length>0,u,"invalid-dynamic-link-domain"),o.continueUrl=a.url,o.dynamicLinkDomain=a.dynamicLinkDomain,o.canHandleCodeInApp=a.handleCodeInApp,a.iOS&&(ee(a.iOS.bundleId.length>0,u,"missing-ios-bundle-id"),o.iOSBundleId=a.iOS.bundleId),a.android&&(ee(a.android.packageName.length>0,u,"missing-android-pkg-name"),o.androidInstallApp=a.android.installApp,o.androidMinimumVersionCode=a.android.minimumVersion,o.androidPackageName=a.android.packageName)}function fc(u){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,A.A)(function*(u){const o=nt(u);o._getPasswordPolicyInternal()&&(yield o._updatePasswordPolicy())})).apply(this,arguments)}function Gn(){return(Gn=(0,A.A)(function*(u,o,a){const h=nt(u),g={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};a&&Ns(h,g,a),yield xs(h,g,"getOobCode",Fi)})).apply(this,arguments)}function zn(){return zn=(0,A.A)(function*(u,o,a){yield Xl((0,$.Ku)(u),{oobCode:o,newPassword:a}).catch(function(){var h=(0,A.A)(function*(g){throw"auth/password-does-not-meet-requirements"===g.code&&fc(u),g});return function(g){return h.apply(this,arguments)}}())}),zn.apply(this,arguments)}function qi(){return qi=(0,A.A)(function*(u,o){yield function Zl(u,o){return rt.apply(this,arguments)}((0,$.Ku)(u),{oobCode:o})}),qi.apply(this,arguments)}function $i(u,o){return pc.apply(this,arguments)}function pc(){return(pc=(0,A.A)(function*(u,o){const a=(0,$.Ku)(u),h=yield Xl(a,{oobCode:o}),g=h.requestType;switch(ee(g,a,"internal-error"),g){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ee(h.newEmail,a,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ee(h.mfaInfo,a,"internal-error");default:ee(h.email,a,"internal-error")}let I=null;return h.mfaInfo&&(I=ji._fromServerResponse(nt(a),h.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.newEmail:h.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===h.requestType?h.email:h.newEmail)||null,multiFactorInfo:I},operation:g}})).apply(this,arguments)}function Jn(){return(Jn=(0,A.A)(function*(u,o){const{data:a}=yield $i((0,$.Ku)(u),o);return a.email})).apply(this,arguments)}function Zn(){return(Zn=(0,A.A)(function*(u,o,a){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h=nt(u),C=yield xs(h,{returnSecureToken:!0,email:o,password:a,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",su).catch(K=>{throw"auth/password-does-not-meet-requirements"===K.code&&fc(u),K}),O=yield kn._fromIdTokenResponse(h,"signIn",C);return yield h._updateCurrentUser(O.user),O})).apply(this,arguments)}function tr(){return(tr=(0,A.A)(function*(u,o,a){const h=nt(u),g={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};(function I(C,O){ee(O.handleCodeInApp,h,"argument-error"),O&&Ns(h,C,O)})(g,a),yield xs(h,g,"getOobCode",ri)})).apply(this,arguments)}function Ms(){return(Ms=(0,A.A)(function*(u,o,a){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h=(0,$.Ku)(u),g=ai.credentialWithLink(o,a||Ln());return ee(g._tenantId===(h.tenantId||null),h,"tenant-id-mismatch"),Gi(h,g)})).apply(this,arguments)}function dr(){return(dr=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:createAuthUri",Ge(u,o))})).apply(this,arguments)}function li(){return li=(0,A.A)(function*(u,o){const h={identifier:o,continueUri:Ir()?Ln():"http://localhost"},{signinMethods:g}=yield function Fo(u,o){return dr.apply(this,arguments)}((0,$.Ku)(u),h);return g||[]}),li.apply(this,arguments)}function Uo(){return Uo=(0,A.A)(function*(u,o){const a=(0,$.Ku)(u),g={requestType:"VERIFY_EMAIL",idToken:yield u.getIdToken()};o&&Ns(a.auth,g,o);const{email:I}=yield function at(u,o){return ae.apply(this,arguments)}(a.auth,g);I!==u.email&&(yield u.reload())}),Uo.apply(this,arguments)}function ui(){return ui=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u),I={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield u.getIdToken(),newEmail:o};a&&Ns(h.auth,I,a);const{email:C}=yield function ii(u,o){return Za.apply(this,arguments)}(h.auth,I);C!==u.email&&(yield u.reload())}),ui.apply(this,arguments)}function gc(){return(gc=(0,A.A)(function*(u,o){return $e(u,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Go(){return Go=(0,A.A)(function*(u,{displayName:o,photoURL:a}){if(void 0===o&&void 0===a)return;const h=(0,$.Ku)(u),I={idToken:yield h.getIdToken(),displayName:o,photoUrl:a,returnSecureToken:!0},C=yield yn(h,function du(u,o){return gc.apply(this,arguments)}(h.auth,I));h.displayName=C.displayName||null,h.photoURL=C.photoUrl||null;const O=h.providerData.find(({providerId:K})=>"password"===K);O&&(O.displayName=h.displayName,O.photoURL=h.photoURL),yield h._updateTokensIfNecessary(C)}),Go.apply(this,arguments)}function _c(u,o,a){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,A.A)(function*(u,o,a){const{auth:h}=u,I={idToken:yield u.getIdToken(),returnSecureToken:!0};o&&(I.email=o),a&&(I.password=a);const C=yield yn(u,function ah(u,o){return Ro.apply(this,arguments)}(h,I));yield u._updateTokensIfNecessary(C,!0)}),Ze.apply(this,arguments)}class di{constructor(o,a,h={}){this.isNewUser=o,this.providerId=a,this.profile=h}}class yc extends di{constructor(o,a,h,g){super(o,a,h),this.username=g}}class Ls extends di{constructor(o,a){super(o,"facebook.com",a)}}class mh extends yc{constructor(o,a){super(o,"github.com",a,"string"==typeof a?.login?a?.login:null)}}class fu extends di{constructor(o,a){super(o,"google.com",a)}}class Le extends yc{constructor(o,a,h){super(o,"twitter.com",a,h)}}function He(u){const{user:o,_tokenResponse:a}=u;return o.isAnonymous&&!a?{providerId:null,isNewUser:!1,profile:null}:function Fr(u){var o,a;if(!u)return null;const{providerId:h}=u,g=u.rawUserInfo?JSON.parse(u.rawUserInfo):{},I=u.isNewUser||"identitytoolkit#SignupNewUserResponse"===u.kind;if(!h&&u?.idToken){const C=null===(a=null===(o=wr(u.idToken))||void 0===o?void 0:o.firebase)||void 0===a?void 0:a.sign_in_provider;if(C)return new di(I,"anonymous"!==C&&"custom"!==C?C:null)}if(!h)return null;switch(h){case"facebook.com":return new Ls(I,g);case"github.com":return new mh(I,g);case"google.com":return new fu(I,g);case"twitter.com":return new Le(I,g,u.screenName||null);case"custom":case"anonymous":return new di(I,null);default:return new di(I,h,g)}}(a)}class Ur{constructor(o,a,h){this.type=o,this.credential=a,this.user=h}static _fromIdtoken(o,a){return new Ur("enroll",o,a)}static _fromMfaPendingCredential(o){return new Ur("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var a,h;if(o?.multiFactorSession){if(null!==(a=o.multiFactorSession)&&void 0!==a&&a.pendingCredential)return Ur._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(h=o.multiFactorSession)&&void 0!==h&&h.idToken)return Ur._fromIdtoken(o.multiFactorSession.idToken)}return null}}class Tc{constructor(o,a,h){this.session=o,this.hints=a,this.signInResolver=h}static _fromError(o,a){const h=nt(o),g=a.customData._serverResponse,I=(g.mfaInfo||[]).map(O=>ji._fromServerResponse(h,O));ee(g.mfaPendingCredential,h,"internal-error");const C=Ur._fromMfaPendingCredential(g.mfaPendingCredential);return new Tc(C,I,function(){var O=(0,A.A)(function*(K){const se=yield K._process(h,C);delete g.mfaInfo,delete g.mfaPendingCredential;const de=Object.assign(Object.assign({},g),{idToken:se.idToken,refreshToken:se.refreshToken});switch(a.operationType){case"signIn":const he=yield kn._fromIdTokenResponse(h,a.operationType,de);return yield h._updateCurrentUser(he.user),he;case"reauthenticate":return ee(a.user,h,"internal-error"),kn._forOperation(a.user,a.operationType,de);default:ot(h,"internal-error")}});return function(K){return O.apply(this,arguments)}}())}resolveSignIn(o){var a=this;return(0,A.A)(function*(){return a.signInResolver(o)})()}}class Wi{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(h=>ji._fromServerResponse(o.auth,h)))})}static _fromUser(o){return new Wi(o)}getSession(){var o=this;return(0,A.A)(function*(){return Ur._fromIdtoken(yield o.user.getIdToken(),o.user)})()}enroll(o,a){var h=this;return(0,A.A)(function*(){const g=o,I=yield h.getSession(),C=yield yn(h.user,g._process(h.user.auth,I,a));return yield h.user._updateTokensIfNecessary(C),h.user.reload()})()}unenroll(o){var a=this;return(0,A.A)(function*(){const h="string"==typeof o?o:o.uid,g=yield a.user.getIdToken();try{const I=yield yn(a.user,function jo(u,o){return $e(u,"POST","/v2/accounts/mfaEnrollment:withdraw",Ge(u,o))}(a.user.auth,{idToken:g,mfaEnrollmentId:h}));a.enrolledFactors=a.enrolledFactors.filter(({uid:C})=>C!==h),yield a.user._updateTokensIfNecessary(I),yield a.user.reload()}catch(I){throw I}})()}}const qo=new WeakMap,On="__sak";class Ac{constructor(o,a){this.storageRetriever=o,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(On,"1"),this.storage.removeItem(On),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,a){return this.storage.setItem(o,JSON.stringify(a)),Promise.resolve()}_get(o){const a=this.storage.getItem(o);return Promise.resolve(a?JSON.parse(a):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const xt=(()=>{class u extends Ac{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,h)=>this.onStorageEvent(a,h),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Qi(){const u=(0,$.ZQ)();return ei(u)||ar(u)}()&&function Ee(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=ue(),this._shouldAllowMigration=!0}forAllChangedKeys(a){for(const h of Object.keys(this.listeners)){const g=this.storage.getItem(h),I=this.localCache[h];g!==I&&a(h,I,g)}}onStorageEvent(a,h=!1){if(!a.key)return void this.forAllChangedKeys((O,K,se)=>{this.notifyListeners(O,se)});const g=a.key;if(h?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const O=this.storage.getItem(g);if(a.newValue!==O)null!==a.newValue?this.storage.setItem(g,a.newValue):this.storage.removeItem(g);else if(this.localCache[g]===a.newValue&&!h)return}const I=()=>{const O=this.storage.getItem(g);!h&&this.localCache[g]===O||this.notifyListeners(g,O)},C=this.storage.getItem(g);!function W(){return(0,$.lT)()&&10===document.documentMode}()||C===a.newValue||a.newValue===a.oldValue?I():setTimeout(I,10)}notifyListeners(a,h){this.localCache[a]=h;const g=this.listeners[a];if(g)for(const I of Array.from(g))I(h&&JSON.parse(h))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,h,g)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:h,newValue:g}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(a,h){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[a]||(this.listeners[a]=new Set,this.localCache[a]=this.storage.getItem(a)),this.listeners[a].add(h)}_removeListener(a,h){this.listeners[a]&&(this.listeners[a].delete(h),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(a,h){var g=()=>super._set,I=this;return(0,A.A)(function*(){yield g().call(I,a,h),I.localCache[a]=JSON.stringify(h)})()}_get(a){var h=()=>super._get,g=this;return(0,A.A)(function*(){const I=yield h().call(g,a);return g.localCache[a]=JSON.stringify(I),I})()}_remove(a){var h=()=>super._remove,g=this;return(0,A.A)(function*(){yield h().call(g,a),delete g.localCache[a]})()}}return u.type="LOCAL",u})(),hr=(()=>{class u extends Ac{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(a,h){}_removeListener(a,h){}}return u.type="SESSION",u})();let $o=(()=>{class u{constructor(a){this.eventTarget=a,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(a){const h=this.receivers.find(I=>I.isListeningto(a));if(h)return h;const g=new u(a);return this.receivers.push(g),g}isListeningto(a){return this.eventTarget===a}handleEvent(a){var h=this;return(0,A.A)(function*(){const g=a,{eventId:I,eventType:C,data:O}=g.data,K=h.handlersMap[C];if(!K?.size)return;g.ports[0].postMessage({status:"ack",eventId:I,eventType:C});const se=Array.from(K).map(function(){var he=(0,A.A)(function*(lt){return lt(g.origin,O)});return function(lt){return he.apply(this,arguments)}}()),de=yield function wc(u){return Promise.all(u.map(function(){var o=(0,A.A)(function*(a){try{return{fulfilled:!0,value:yield a}}catch(h){return{fulfilled:!1,reason:h}}});return function(a){return o.apply(this,arguments)}}()))}(se);g.ports[0].postMessage({status:"done",eventId:I,eventType:C,response:de})})()}_subscribe(a,h){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[a]||(this.handlersMap[a]=new Set),this.handlersMap[a].add(h)}_unsubscribe(a,h){this.handlersMap[a]&&h&&this.handlersMap[a].delete(h),(!h||0===this.handlersMap[a].size)&&delete this.handlersMap[a],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return u.receivers=[],u})();function fr(u="",o=10){let a="";for(let h=0;h<o;h++)a+=Math.floor(10*Math.random());return u+a}class vu{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,a,h=50){var g=this;return(0,A.A)(function*(){const I=typeof MessageChannel<"u"?new MessageChannel:null;if(!I)throw new Error("connection_unavailable");let C,O;return new Promise((K,se)=>{const de=fr("",20);I.port1.start();const he=setTimeout(()=>{se(new Error("unsupported_event"))},h);O={messageChannel:I,onMessage(lt){const En=lt;if(En.data.eventId===de)switch(En.data.status){case"ack":clearTimeout(he),C=setTimeout(()=>{se(new Error("timeout"))},3e3);break;case"done":clearTimeout(C),K(En.data.response);break;default:clearTimeout(he),clearTimeout(C),se(new Error("invalid_response"))}}},g.handlers.add(O),I.port1.addEventListener("message",O.onMessage),g.target.postMessage({eventType:o,eventId:de,data:a},[I.port2])}).finally(()=>{O&&g.removeMessageHandler(O)})})()}}function ct(){return window}function Ko(){return typeof ct().WorkerGlobalScope<"u"&&"function"==typeof ct().importScripts}function Cc(){return(Cc=(0,A.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const en="firebaseLocalStorageDb",Br="firebaseLocalStorage",Sc="fbase_key";class an{constructor(o){this.request=o}toPromise(){return new Promise((o,a)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function zs(u,o){return u.transaction([Br],o?"readwrite":"readonly").objectStore(Br)}function Rc(){const u=indexedDB.open(en,1);return new Promise((o,a)=>{u.addEventListener("error",()=>{a(u.error)}),u.addEventListener("upgradeneeded",()=>{const h=u.result;try{h.createObjectStore(Br,{keyPath:Sc})}catch(g){a(g)}}),u.addEventListener("success",(0,A.A)(function*(){const h=u.result;h.objectStoreNames.contains(Br)?o(h):(h.close(),yield function js(){const u=indexedDB.deleteDatabase(en);return new an(u).toPromise()}(),o(yield Rc()))}))})}function Eu(u,o,a){return Re.apply(this,arguments)}function Re(){return(Re=(0,A.A)(function*(u,o,a){const h=zs(u,!0).put({[Sc]:o,value:a});return new an(h).toPromise()})).apply(this,arguments)}function qs(){return(qs=(0,A.A)(function*(u,o){const a=zs(u,!1).get(o),h=yield new an(a).toPromise();return void 0===h?null:h.value})).apply(this,arguments)}function Pc(u,o){const a=zs(u,!0).delete(o);return new an(a).toPromise()}const Yi=(()=>{class u{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var a=this;return(0,A.A)(function*(){return a.db||(a.db=yield Rc()),a.db})()}_withRetries(a){var h=this;return(0,A.A)(function*(){let g=0;for(;;)try{const I=yield h._openDb();return yield a(I)}catch(I){if(g++>3)throw I;h.db&&(h.db.close(),h.db=void 0)}})()}initializeServiceWorkerMessaging(){var a=this;return(0,A.A)(function*(){return Ko()?a.initializeReceiver():a.initializeSender()})()}initializeReceiver(){var a=this;return(0,A.A)(function*(){a.receiver=$o._getInstance(function Eh(){return Ko()?self:null}()),a.receiver._subscribe("keyChanged",function(){var h=(0,A.A)(function*(g,I){return{keyProcessed:(yield a._poll()).includes(I.key)}});return function(g,I){return h.apply(this,arguments)}}()),a.receiver._subscribe("ping",function(){var h=(0,A.A)(function*(g,I){return["keyChanged"]});return function(g,I){return h.apply(this,arguments)}}())})()}initializeSender(){var a=this;return(0,A.A)(function*(){var h,g;if(a.activeServiceWorker=yield function Iu(){return Cc.apply(this,arguments)}(),!a.activeServiceWorker)return;a.sender=new vu(a.activeServiceWorker);const I=yield a.sender._send("ping",{},800);I&&null!==(h=I[0])&&void 0!==h&&h.fulfilled&&null!==(g=I[0])&&void 0!==g&&g.value.includes("keyChanged")&&(a.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(a){var h=this;return(0,A.A)(function*(){if(h.sender&&h.activeServiceWorker&&function pr(){var u;return(null===(u=navigator?.serviceWorker)||void 0===u?void 0:u.controller)||null}()===h.activeServiceWorker)try{yield h.sender._send("keyChanged",{key:a},h.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,A.A)(function*(){try{if(!indexedDB)return!1;const a=yield Rc();return yield Eu(a,On,"1"),yield Pc(a,On),!0}catch{}return!1})()}_withPendingWrite(a){var h=this;return(0,A.A)(function*(){h.pendingWrites++;try{yield a()}finally{h.pendingWrites--}})()}_set(a,h){var g=this;return(0,A.A)(function*(){return g._withPendingWrite((0,A.A)(function*(){return yield g._withRetries(I=>Eu(I,a,h)),g.localCache[a]=h,g.notifyServiceWorker(a)}))})()}_get(a){var h=this;return(0,A.A)(function*(){const g=yield h._withRetries(I=>function Ah(u,o){return qs.apply(this,arguments)}(I,a));return h.localCache[a]=g,g})()}_remove(a){var h=this;return(0,A.A)(function*(){return h._withPendingWrite((0,A.A)(function*(){return yield h._withRetries(g=>Pc(g,a)),delete h.localCache[a],h.notifyServiceWorker(a)}))})()}_poll(){var a=this;return(0,A.A)(function*(){const h=yield a._withRetries(C=>{const O=zs(C,!1).getAll();return new an(O).toPromise()});if(!h)return[];if(0!==a.pendingWrites)return[];const g=[],I=new Set;if(0!==h.length)for(const{fbase_key:C,value:O}of h)I.add(C),JSON.stringify(a.localCache[C])!==JSON.stringify(O)&&(a.notifyListeners(C,O),g.push(C));for(const C of Object.keys(a.localCache))a.localCache[C]&&!I.has(C)&&(a.notifyListeners(C,null),g.push(C));return g})()}notifyListeners(a,h){this.localCache[a]=h;const g=this.listeners[a];if(g)for(const I of Array.from(g))I(h)}startPolling(){var a=this;this.stopPolling(),this.pollTimer=setInterval((0,A.A)(function*(){return a._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(a,h){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[a]||(this.listeners[a]=new Set,this._get(a)),this.listeners[a].add(h)}_removeListener(a,h){this.listeners[a]&&(this.listeners[a].delete(h),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return u.type="LOCAL",u})(),nr=1e12;class Su{constructor(o){this.auth=o,this.counter=nr,this._widgets=new Map}render(o,a){const h=this.counter;return this._widgets.set(h,new Ji(o,this.auth.name,a||{})),this.counter++,h}reset(o){var a;const h=o||nr;null===(a=this._widgets.get(h))||void 0===a||a.delete(),this._widgets.delete(h)}getResponse(o){var a;return(null===(a=this._widgets.get(o||nr))||void 0===a?void 0:a.getResponse())||""}execute(o){var a=this;return(0,A.A)(function*(){var h;return null===(h=a._widgets.get(o||nr))||void 0===h||h.execute(),""})()}}class Ji{constructor(o,a,h){this.params=h,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const g="string"==typeof o?document.getElementById(o):o;ee(g,"argument-error",{appName:a}),this.container=g,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Ru(u){const o=[],a="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let h=0;h<u;h++)o.push(a.charAt(Math.floor(62*Math.random())));return o.join("")}(50);const{callback:o,"expired-callback":a}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,a)try{a()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ho=Z("rcb"),$s=new gn(3e4,6e4);class wh{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=ct().grecaptcha)||void 0===o||!o.render)}load(o,a=""){return ee(function Ch(u){return u.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(u)}(a),o,"argument-error"),this.shouldResolveImmediately(a)&&Lt(ct().grecaptcha)?Promise.resolve(ct().grecaptcha):new Promise((h,g)=>{const I=ct().setTimeout(()=>{g(tt(o,"network-request-failed"))},$s.get());ct()[Ho]=()=>{ct().clearTimeout(I),delete ct()[Ho];const O=ct().grecaptcha;if(!O||!Lt(O))return void g(tt(o,"internal-error"));const K=O.render;O.render=(se,de)=>{const he=K(se,de);return this.counter++,he},this.hostLanguage=a,h(O)},xr(`${function Dr(){return Mi.recaptchaV2Script}()}?${(0,$.Am)({onload:Ho,render:"explicit",hl:a})}`).catch(()=>{clearTimeout(I),g(tt(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var a;return!(null===(a=ct().grecaptcha)||void 0===a||!a.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ht{load(o){return(0,A.A)(function*(){return new Su(o)})()}clearedOneInstance(){}}const Ks="recaptcha",Wo={theme:"light",type:"image"};class Pu{constructor(o,a,h=Object.assign({},Wo)){this.parameters=h,this.type=Ks,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=nt(o),this.isInvisible="invisible"===this.parameters.size,ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const g="string"==typeof a?document.getElementById(a):a;ee(g,this.auth,"argument-error"),this.container=g,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ht:new wh,this.validateStartingState()}verify(){var o=this;return(0,A.A)(function*(){o.assertNotDestroyed();const a=yield o.render(),h=o.getAssertedRecaptcha();return h.getResponse(a)||new Promise(I=>{const C=O=>{O&&(o.tokenChangeListeners.delete(C),I(O))};o.tokenChangeListeners.add(C),o.isInvisible&&h.execute(a)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){ee(!this.parameters.sitekey,this.auth,"argument-error"),ee(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ee(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return a=>{if(this.tokenChangeListeners.forEach(h=>h(a)),"function"==typeof o)o(a);else if("string"==typeof o){const h=ct()[o];"function"==typeof h&&h(a)}}}assertNotDestroyed(){ee(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,A.A)(function*(){if(yield o.init(),!o.widgetId){let a=o.container;if(!o.isInvisible){const h=document.createElement("div");a.appendChild(h),a=h}o.widgetId=o.getAssertedRecaptcha().render(a,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,A.A)(function*(){ee(Ir()&&!Ko(),o.auth,"internal-error"),yield function Sh(){let u=null;return new Promise(o=>{"complete"!==document.readyState?(u=()=>o(),window.addEventListener("load",u)):o()}).catch(o=>{throw u&&window.removeEventListener("load",u),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const a=yield function As(u){return Yt.apply(this,arguments)}(o.auth);ee(a,o.auth,"internal-error"),o.parameters.sitekey=a})()}getAssertedRecaptcha(){return ee(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class fi{constructor(o,a){this.verificationId=o,this.onConfirmation=a}confirm(o){const a=Vr._fromVerification(this.verificationId,o);return this.onConfirmation(a)}}function Qo(){return(Qo=(0,A.A)(function*(u,o,a){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h=nt(u),g=yield Hs(h,o,(0,$.Ku)(a));return new fi(g,I=>Gi(h,I))})).apply(this,arguments)}function jn(){return(jn=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);yield Os(!1,h,"phone");const g=yield Hs(h.auth,o,(0,$.Ku)(a));return new fi(g,I=>dc(h,I))})).apply(this,arguments)}function Yo(){return(Yo=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);if((0,d._isFirebaseServerApp)(h.auth.app))return Promise.reject(be(h.auth));const g=yield Hs(h.auth,o,(0,$.Ku)(a));return new fi(g,I=>hc(h,I))})).apply(this,arguments)}function Hs(u,o,a){return Gr.apply(this,arguments)}function Gr(){return Gr=(0,A.A)(function*(u,o,a){var h;const g=yield a.verify();try{let I;if(ee("string"==typeof g,u,"argument-error"),ee(a.type===Ks,u,"argument-error"),I="string"==typeof o?{phoneNumber:o}:o,"session"in I){const C=I.session;if("phoneNumber"in I)return ee("enroll"===C.type,u,"internal-error"),(yield function Ih(u,o){return $e(u,"POST","/v2/accounts/mfaEnrollment:start",Ge(u,o))}(u,{idToken:C.credential,phoneEnrollmentInfo:{phoneNumber:I.phoneNumber,recaptchaToken:g}})).phoneSessionInfo.sessionInfo;{ee("signin"===C.type,u,"internal-error");const O=(null===(h=I.multiFactorHint)||void 0===h?void 0:h.uid)||I.multiFactorUid;return ee(O,u,"missing-multi-factor-info"),(yield function bh(u,o){return $e(u,"POST","/v2/accounts/mfaSignIn:start",Ge(u,o))}(u,{mfaPendingCredential:C.credential,mfaEnrollmentId:O,phoneSignInInfo:{recaptchaToken:g}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:C}=yield function U(u,o){return Bi.apply(this,arguments)}(u,{phoneNumber:I.phoneNumber,recaptchaToken:g});return C}}finally{a._reset()}}),Gr.apply(this,arguments)}function Ws(){return(Ws=(0,A.A)(function*(u,o){const a=(0,$.Ku)(u);if((0,d._isFirebaseServerApp)(a.auth.app))return Promise.reject(be(a.auth));yield sc(a,o)})).apply(this,arguments)}let pi=(()=>{class u{constructor(a){this.providerId=u.PROVIDER_ID,this.auth=nt(a)}verifyPhoneNumber(a,h){return Hs(this.auth,a,(0,$.Ku)(h))}static credential(a,h){return Vr._fromVerification(a,h)}static credentialFromResult(a){return u.credentialFromTaggedObject(a)}static credentialFromError(a){return u.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{phoneNumber:h,temporaryProof:g}=a;return h&&g?Vr._fromTokenResponse(h,g):null}}return u.PROVIDER_ID="phone",u.PHONE_SIGN_IN_METHOD="phone",u})();function mr(u,o){return o?Ke(o):(ee(u._popupRedirectResolver,u,"argument-error"),u._popupRedirectResolver)}class Xo extends ti{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return Qn(o,this._buildIdpRequest())}_linkToIdToken(o,a){return Qn(o,this._buildIdpRequest(a))}_getReauthenticationResolver(o){return Qn(o,this._buildIdpRequest())}_buildIdpRequest(o){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(a.idToken=o),a}}function Ph(u){return lc(u.auth,new Xo(u),u.bypassAuthState)}function wt(u){const{auth:o,user:a}=u;return ee(a,o,"internal-error"),cc(a,new Xo(u),u.bypassAuthState)}function Be(u){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,A.A)(function*(u){const{auth:o,user:a}=u;return ee(a,o,"internal-error"),sc(a,new Xo(u),u.bypassAuthState)})).apply(this,arguments)}class kc{constructor(o,a,h,g,I=!1){this.auth=o,this.resolver=h,this.user=g,this.bypassAuthState=I,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){var o=this;return new Promise(function(){var a=(0,A.A)(function*(h,g){o.pendingPromise={resolve:h,reject:g};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(I){o.reject(I)}});return function(h,g){return a.apply(this,arguments)}}())}onAuthEvent(o){var a=this;return(0,A.A)(function*(){const{urlResponse:h,sessionId:g,postBody:I,tenantId:C,error:O,type:K}=o;if(O)return void a.reject(O);const se={auth:a.auth,requestUri:h,sessionId:g,tenantId:C||void 0,postBody:I||void 0,user:a.user,bypassAuthState:a.bypassAuthState};try{a.resolve(yield a.getIdpTask(K)(se))}catch(de){a.reject(de)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return Ph;case"linkViaPopup":case"linkViaRedirect":return Be;case"reauthViaPopup":case"reauthViaRedirect":return wt;default:ot(this.auth,"internal-error")}}resolve(o){$t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){$t(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zo=new gn(2e3,1e4);function Oc(){return(Oc=(0,A.A)(function*(u,o,a){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(tt(u,"operation-not-supported-in-this-environment"));const h=nt(u);St(u,o,In);const g=mr(h,a);return new gi(h,"signInViaPopup",o,g).executeNotNull()})).apply(this,arguments)}function ea(){return(ea=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);if((0,d._isFirebaseServerApp)(h.auth.app))return Promise.reject(tt(h.auth,"operation-not-supported-in-this-environment"));St(h.auth,o,In);const g=mr(h.auth,a);return new gi(h.auth,"reauthViaPopup",o,g,h).executeNotNull()})).apply(this,arguments)}function mi(){return(mi=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);St(h.auth,o,In);const g=mr(h.auth,a);return new gi(h.auth,"linkViaPopup",o,g,h).executeNotNull()})).apply(this,arguments)}let gi=(()=>{class u extends kc{constructor(a,h,g,I,C){super(a,h,I,C),this.provider=g,this.authWindow=null,this.pollId=null,u.currentPopupAction&&u.currentPopupAction.cancel(),u.currentPopupAction=this}executeNotNull(){var a=this;return(0,A.A)(function*(){const h=yield a.execute();return ee(h,a.auth,"internal-error"),h})()}onExecution(){var a=this;return(0,A.A)(function*(){$t(1===a.filter.length,"Popup operations only handle one event");const h=fr();a.authWindow=yield a.resolver._openPopup(a.auth,a.provider,a.filter[0],h),a.authWindow.associatedEvent=h,a.resolver._originValidation(a.auth).catch(g=>{a.reject(g)}),a.resolver._isIframeWebStorageSupported(a.auth,g=>{g||a.reject(tt(a.auth,"web-storage-unsupported"))}),a.pollUserCancellation()})()}get eventId(){var a;return(null===(a=this.authWindow)||void 0===a?void 0:a.associatedEvent)||null}cancel(){this.reject(tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,u.currentPopupAction=null}pollUserCancellation(){const a=()=>{var h,g;this.pollId=null!==(g=null===(h=this.authWindow)||void 0===h?void 0:h.window)&&void 0!==g&&g.closed?window.setTimeout(()=>{this.pollId=null,this.reject(tt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(a,Zo.get())};a()}}return u.currentPopupAction=null,u})();const Qs="pendingRedirect",zr=new Map;class Ou extends kc{constructor(o,a,h=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,h),this.eventId=null}execute(){var o=()=>super.execute,a=this;return(0,A.A)(function*(){let h=zr.get(a.auth._key());if(!h){try{const I=(yield function Nu(u,o){return ta.apply(this,arguments)}(a.resolver,a.auth))?yield o().call(a):null;h=()=>Promise.resolve(I)}catch(g){h=()=>Promise.reject(g)}zr.set(a.auth._key(),h)}return a.bypassAuthState||zr.set(a.auth._key(),()=>Promise.resolve(null)),h()})()}onAuthEvent(o){var a=()=>super.onAuthEvent,h=this;return(0,A.A)(function*(){if("signInViaRedirect"===o.type)return a().call(h,o);if("unknown"!==o.type){if(o.eventId){const g=yield h.auth._redirectUserForId(o.eventId);if(g)return h.user=g,a().call(h,o);h.resolve(null)}}else h.resolve(null)})()}onExecution(){return(0,A.A)(function*(){})()}cleanUp(){}}function ta(){return(ta=(0,A.A)(function*(u,o){const a=Lu(o),h=Mu(u);if(!(yield h._isAvailable()))return!1;const g="true"===(yield h._get(a));return yield h._remove(a),g})).apply(this,arguments)}function Vc(u,o){return na.apply(this,arguments)}function na(){return(na=(0,A.A)(function*(u,o){return Mu(u)._set(Lu(o),"true")})).apply(this,arguments)}function Mc(u,o){zr.set(u._key(),o)}function Mu(u){return Ke(u._redirectPersistence)}function Lu(u){return xe(Qs,u.config.apiKey,u.name)}function xh(u,o,a){return function Lc(u,o,a){return jr.apply(this,arguments)}(u,o,a)}function jr(){return(jr=(0,A.A)(function*(u,o,a){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h=nt(u);St(u,o,In),yield h._initializationPromise;const g=mr(h,a);return yield Vc(g,h),g._openRedirect(h,o,"signInViaRedirect")})).apply(this,arguments)}function Fu(u,o,a){return function Dh(u,o,a){return ft.apply(this,arguments)}(u,o,a)}function ft(){return(ft=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);if(St(h.auth,o,In),(0,d._isFirebaseServerApp)(h.auth.app))return Promise.reject(be(h.auth));yield h.auth._initializationPromise;const g=mr(h.auth,a);yield Vc(g,h.auth);const I=yield sa(h);return g._openRedirect(h.auth,o,"reauthViaRedirect",I)})).apply(this,arguments)}function Fc(u,o,a){return function Uc(u,o,a){return ra.apply(this,arguments)}(u,o,a)}function ra(){return(ra=(0,A.A)(function*(u,o,a){const h=(0,$.Ku)(u);St(h.auth,o,In),yield h.auth._initializationPromise;const g=mr(h.auth,a);yield Os(!1,h,o.providerId),yield Vc(g,h.auth);const I=yield sa(h);return g._openRedirect(h.auth,o,"linkViaRedirect",I)})).apply(this,arguments)}function Nn(){return(Nn=(0,A.A)(function*(u,o){return yield nt(u)._initializationPromise,Xs(u,o,!1)})).apply(this,arguments)}function Xs(u,o){return ia.apply(this,arguments)}function ia(){return(ia=(0,A.A)(function*(u,o,a=!1){if((0,d._isFirebaseServerApp)(u.app))return Promise.reject(be(u));const h=nt(u),g=mr(h,o),C=yield new Ou(h,g,a).execute();return C&&!a&&(delete C.user._redirectEventId,yield h._persistUserIfCurrent(C.user),yield h._setRedirectUser(null,o)),C})).apply(this,arguments)}function sa(u){return oa.apply(this,arguments)}function oa(){return(oa=(0,A.A)(function*(u){const o=fr(`${u.uid}:::`);return u._redirectEventId=o,yield u.auth._setRedirectUser(u),yield u.auth._persistUserIfCurrent(u),o})).apply(this,arguments)}class Bc{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let a=!1;return this.consumers.forEach(h=>{this.isEventForConsumer(o,h)&&(a=!0,this.sendToConsumer(o,h),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function Js(u){switch(u.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gu(u);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=o,a=!0)),a}sendToConsumer(o,a){var h;if(o.error&&!Gu(o)){const g=(null===(h=o.error.code)||void 0===h?void 0:h.split("auth/")[1])||"internal-error";a.onError(tt(this.auth,g))}else a.onAuthEvent(o)}isEventForConsumer(o,a){const h=null===a.eventId||!!o.eventId&&o.eventId===a.eventId;return a.filter.includes(o.type)&&h}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bu(o))}saveEventToCache(o){this.cachedEventUids.add(Bu(o)),this.lastProcessedEventTime=Date.now()}}function Bu(u){return[u.type,u.eventId,u.sessionId,u.tenantId].filter(o=>o).join("-")}function Gu({type:u,error:o}){return"unknown"===u&&"auth/no-auth-event"===o?.code}function aa(u){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,A.A)(function*(u,o={}){return $e(u,"GET","/v1/projects",o)})).apply(this,arguments)}const zu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ca=/^https?/;function la(){return(la=(0,A.A)(function*(u){if(u.config.emulator)return;const{authorizedDomains:o}=yield aa(u);for(const a of o)try{if(kh(a))return}catch{}ot(u,"unauthorized-domain")})).apply(this,arguments)}function kh(u){const o=Ln(),{protocol:a,hostname:h}=new URL(o);if(u.startsWith("chrome-extension://")){const C=new URL(u);return""===C.hostname&&""===h?"chrome-extension:"===a&&u.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===a&&C.hostname===h}if(!ca.test(a))return!1;if(zu.test(u))return h===u;const g=u.replace(/\./g,"\\.");return new RegExp("^(.+\\."+g+"|"+g+")$","i").test(h)}const qu=new gn(3e4,6e4);function $u(){const u=ct().___jsl;if(u?.H)for(const o of Object.keys(u.H))if(u.H[o].r=u.H[o].r||[],u.H[o].L=u.H[o].L||[],u.H[o].r=[...u.H[o].L],u.CP)for(let a=0;a<u.CP.length;a++)u.CP[a]=null}let ua=null;const es=new gn(5e3,15e3),Ku="__/auth/iframe",Nh="emulator/auth/iframe",Hu={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Wu(u){const o=u.config;ee(o.authDomain,u,"auth-domain-config-required");const a=o.emulator?sr(o,Nh):`https://${u.config.authDomain}/${Ku}`,h={apiKey:o.apiKey,appName:u.name,v:d.SDK_VERSION},g=gr.get(u.config.apiHost);g&&(h.eid=g);const I=u._getFrameworks();return I.length&&(h.fw=I.join(",")),`${a}?${(0,$.Am)(h).slice(1)}`}function da(){return da=(0,A.A)(function*(u){const o=yield function qr(u){return ua=ua||function Oh(u){return new Promise((o,a)=>{var h,g,I;function C(){$u(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{$u(),a(tt(u,"network-request-failed"))},timeout:qu.get()})}if(null!==(g=null===(h=ct().gapi)||void 0===h?void 0:h.iframes)&&void 0!==g&&g.Iframe)o(gapi.iframes.getContext());else{if(null===(I=ct().gapi)||void 0===I||!I.load){const O=Z("iframefcb");return ct()[O]=()=>{gapi.load?C():a(tt(u,"network-request-failed"))},xr(`${function ih(){return Mi.gapiScript}()}?onload=${O}`).catch(K=>a(K))}C()}}).catch(o=>{throw ua=null,o})}(u),ua}(u),a=ct().gapi;return ee(a,u,"internal-error"),o.open({where:document.body,url:Wu(u),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Hu,dontclear:!0},h=>new Promise(function(){var g=(0,A.A)(function*(I,C){yield h.restyle({setHideOnLeave:!1});const O=tt(u,"network-request-failed"),K=ct().setTimeout(()=>{C(O)},es.get());function se(){ct().clearTimeout(K),I(h)}h.ping(se).then(se,()=>{C(O)})});return function(I,C){return g.apply(this,arguments)}}()))}),da.apply(this,arguments)}const ha={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zc{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Qu="__/auth/handler",Yu="emulator/auth/handler",Mh=encodeURIComponent("fac");function fa(u,o,a,h,g,I){return pa.apply(this,arguments)}function pa(){return(pa=(0,A.A)(function*(u,o,a,h,g,I){ee(u.config.authDomain,u,"auth-domain-config-required"),ee(u.config.apiKey,u,"invalid-api-key");const C={apiKey:u.config.apiKey,appName:u.name,authType:a,redirectUrl:h,v:d.SDK_VERSION,eventId:g};if(o instanceof In){o.setDefaultLanguage(u.languageCode),C.providerId=o.providerId||"",(0,$.Im)(o.getCustomParameters())||(C.customParameters=JSON.stringify(o.getCustomParameters()));for(const[de,he]of Object.entries(I||{}))C[de]=he}if(o instanceof ci){const de=o.getScopes().filter(he=>""!==he);de.length>0&&(C.scopes=de.join(","))}u.tenantId&&(C.tid=u.tenantId);const O=C;for(const de of Object.keys(O))void 0===O[de]&&delete O[de];const K=yield u._getAppCheckToken(),se=K?`#${Mh}=${encodeURIComponent(K)}`:"";return`${function ma({config:u}){return u.emulator?sr(u,Yu):`https://${u.authDomain}/${Qu}`}(u)}?${(0,$.Am)(O).slice(1)}${se}`})).apply(this,arguments)}const Ii="webStorageSupport",Xu=class Ti{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hr,this._completeRedirectFn=Xs,this._overrideRedirectResult=Mc}_openPopup(o,a,h,g){var I=this;return(0,A.A)(function*(){var C;$t(null===(C=I.eventManagers[o._key()])||void 0===C?void 0:C.manager,"_initialize() not called before _openPopup()");const O=yield fa(o,a,h,Ln(),g);return function jc(u,o,a,h=500,g=600){const I=Math.max((window.screen.availHeight-g)/2,0).toString(),C=Math.max((window.screen.availWidth-h)/2,0).toString();let O="";const K=Object.assign(Object.assign({},ha),{width:h.toString(),height:g.toString(),top:I,left:C}),se=(0,$.ZQ)().toLowerCase();a&&(O=wo(se)?"_blank":a),Rr(se)&&(o=o||"http://localhost",K.scrollbars="yes");const de=Object.entries(K).reduce((lt,[En,ls])=>`${lt}${En}=${ls},`,"");if(function V(u=(0,$.ZQ)()){var o;return ar(u)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(se)&&"_self"!==O)return function qc(u,o){const a=document.createElement("a");a.href=u,a.target=o;const h=document.createEvent("MouseEvent");h.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(h)}(o||"",O),new zc(null);const he=window.open(o||"",O,de);ee(he,u,"popup-blocked");try{he.focus()}catch{}return new zc(he)}(o,O,fr())})()}_openRedirect(o,a,h,g){var I=this;return(0,A.A)(function*(){return yield I._originValidation(o),function Gs(u){ct().location.href=u}(yield fa(o,a,h,Ln(),g)),new Promise(()=>{})})()}_initialize(o){const a=o._key();if(this.eventManagers[a]){const{manager:g,promise:I}=this.eventManagers[a];return g?Promise.resolve(g):($t(I,"If manager is not set, promise should be"),I)}const h=this.initAndGetManager(o);return this.eventManagers[a]={promise:h},h.catch(()=>{delete this.eventManagers[a]}),h}initAndGetManager(o){var a=this;return(0,A.A)(function*(){const h=yield function Vh(u){return da.apply(this,arguments)}(o),g=new Bc(o);return h.register("authEvent",I=>(ee(I?.authEvent,o,"invalid-auth-event"),{status:g.onEvent(I.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),a.eventManagers[o._key()]={manager:g},a.iframes[o._key()]=h,g})()}_isIframeWebStorageSupported(o,a){this.iframes[o._key()].send(Ii,{type:Ii},g=>{var I;const C=null===(I=g?.[0])||void 0===I?void 0:I[Ii];void 0!==C&&a(!!C),ot(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function ju(u){return la.apply(this,arguments)}(o)),this.originValidationPromises[a]}get _shouldInitProactively(){return ue()||ei()||ar()}};class $c{constructor(o){this.factorId=o}_process(o,a,h){switch(a.type){case"enroll":return this._finalizeEnroll(o,a.credential,h);case"signin":return this._finalizeSignIn(o,a.credential);default:return Rt("unexpected MultiFactorSessionType")}}}class Kc extends $c{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new Kc(o)}_finalizeEnroll(o,a,h){return function Ec(u,o){return $e(u,"POST","/v2/accounts/mfaEnrollment:finalize",Ge(u,o))}(o,{idToken:a,displayName:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,a){return function wu(u,o){return $e(u,"POST","/v2/accounts/mfaSignIn:finalize",Ge(u,o))}(o,{mfaPendingCredential:a,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Lh=(()=>{class u{constructor(){}static assertion(a){return Kc._fromCredential(a)}}return u.FACTOR_ID="phone",u})();var Hc="@firebase/auth";class Ju{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var a=this;return(0,A.A)(function*(){return a.assertAuthConfigured(),yield a.auth._initializationPromise,a.auth.currentUser?{accessToken:yield a.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const a=this.auth.onIdTokenChanged(h=>{o(h?.stsTokenManager.accessToken||null)});this.internalListeners.set(o,a),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const a=this.internalListeners.get(o);a&&(this.internalListeners.delete(o),a(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ai(){return window}(0,$.XA)("authIdTokenMaxAge"),function Ot(u){Mi=u}({loadJS:u=>new Promise((o,a)=>{const h=document.createElement("script");h.setAttribute("src",u),h.onload=o,h.onerror=g=>{const I=tt("internal-error");I.customData=g,a(I)},h.type="text/javascript",h.charset="UTF-8",function _a(){var u,o;return null!==(o=null===(u=document.getElementsByTagName("head"))||void 0===u?void 0:u[0])&&void 0!==o?o:document}().appendChild(h)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function Qc(u){(0,d._registerComponent)(new zt.uA("auth",(o,{options:a})=>{const h=o.getProvider("app").getImmediate(),g=o.getProvider("heartbeat"),I=o.getProvider("app-check-internal"),{apiKey:C,authDomain:O}=h.options;ee(C&&!C.includes(":"),"invalid-api-key",{appName:h.name});const K={apiKey:C,authDomain:O,clientPlatform:u,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:we(u)},se=new Co(h,g,I,K);return function Hl(u,o){const a=o?.persistence||[],h=(Array.isArray(a)?a:[a]).map(Ke);o?.errorMap&&u._updateErrorMap(o.errorMap),u._initializeWithPersistence(h,o?.popupRedirectResolver)}(se,a),se},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,a,h)=>{o.getProvider("auth-internal").initialize()})),(0,d._registerComponent)(new zt.uA("auth-internal",o=>{const a=nt(o.getProvider("auth").getImmediate());return new Ju(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,d.registerVersion)(Hc,"1.7.3",function Fh(u){switch(u){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(u)),(0,d.registerVersion)(Hc,"1.7.3","esm2017")}("Browser");function Zc(){return Zc=(0,A.A)(function*(u,o,a){var h;const{BuildInfo:g}=Ai();$t(o.sessionId,"AuthEvent did not contain a session ID");const I=yield function Wt(u){return Ia.apply(this,arguments)}(o.sessionId),C={};return ar()?C.ibi=g.packageName:Pr()?C.apn=g.packageName:ot(u,"operation-not-supported-in-this-environment"),g.displayName&&(C.appDisplayName=g.displayName),C.sessionId=I,fa(u,a,o.type,void 0,null!==(h=o.eventId)&&void 0!==h?h:void 0,C)}),Zc.apply(this,arguments)}function Kr(){return(Kr=(0,A.A)(function*(u){const{BuildInfo:o}=Ai(),a={};ar()?a.iosBundleId=o.packageName:Pr()?a.androidPackageName=o.packageName:ot(u,"operation-not-supported-in-this-environment"),yield aa(u,a)})).apply(this,arguments)}function va(){return(va=(0,A.A)(function*(u,o,a){const{cordova:h}=Ai();let g=()=>{};try{yield new Promise((I,C)=>{let O=null;function K(){var he;I();const lt=null===(he=h.plugins.browsertab)||void 0===he?void 0:he.close;"function"==typeof lt&&lt(),"function"==typeof a?.close&&a.close()}function se(){O||(O=window.setTimeout(()=>{C(tt(u,"redirect-cancelled-by-user"))},2e3))}function de(){"visible"===document?.visibilityState&&se()}o.addPassiveListener(K),document.addEventListener("resume",se,!1),Pr()&&document.addEventListener("visibilitychange",de,!1),g=()=>{o.removePassiveListener(K),document.removeEventListener("resume",se,!1),document.removeEventListener("visibilitychange",de,!1),O&&window.clearTimeout(O)}})}finally{g()}})).apply(this,arguments)}function Ia(){return(Ia=(0,A.A)(function*(u){const o=function Ta(u){if($t(/[0-9a-zA-Z]+/.test(u),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(u);const o=new ArrayBuffer(u.length),a=new Uint8Array(o);for(let h=0;h<u.length;h++)a[h]=u.charCodeAt(h);return a}(u),a=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(a)).map(g=>g.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class nd extends Bc{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(o)),super.onEvent(o)}initialized(){var o=this;return(0,A.A)(function*(){yield o.initPromise})()}}function el(u){return _r.apply(this,arguments)}function _r(){return(_r=(0,A.A)(function*(u){const o=yield Aa()._get(rr(u));return o&&(yield Aa()._remove(rr(u))),o})).apply(this,arguments)}function rs(){const u=[];for(let a=0;a<20;a++){const h=Math.floor(62*Math.random());u.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(h))}return u.join("")}function Aa(){return Ke(xt)}function rr(u){return xe("authEvent",u.config.apiKey,u.name)}function to(u){if(!u?.includes("?"))return{};const[o,...a]=u.split("?");return(0,$.I9)(a.join("?"))}const jh=class id{constructor(){this._redirectPersistence=hr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Xs,this._overrideRedirectResult=Mc}_initialize(o){var a=this;return(0,A.A)(function*(){const h=o._key();let g=a.eventManagers.get(h);return g||(g=new nd(o),a.eventManagers.set(h,g),a.attachCallbackListeners(o,g)),g})()}_openPopup(o){ot(o,"operation-not-supported-in-this-environment")}_openRedirect(o,a,h,g){var I=this;return(0,A.A)(function*(){!function td(u){var o,a,h,g,I,C,O,K,se,de;const he=Ai();ee("function"==typeof(null===(o=he?.universalLinks)||void 0===o?void 0:o.subscribe),u,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ee(typeof(null===(a=he?.BuildInfo)||void 0===a?void 0:a.packageName)<"u",u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ee("function"==typeof(null===(I=null===(g=null===(h=he?.cordova)||void 0===h?void 0:h.plugins)||void 0===g?void 0:g.browsertab)||void 0===I?void 0:I.openUrl),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee("function"==typeof(null===(K=null===(O=null===(C=he?.cordova)||void 0===C?void 0:C.plugins)||void 0===O?void 0:O.browsertab)||void 0===K?void 0:K.isAvailable),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ee("function"==typeof(null===(de=null===(se=he?.cordova)||void 0===se?void 0:se.InAppBrowser)||void 0===de?void 0:de.open),u,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const C=yield I._initialize(o);yield C.initialized(),C.resetRedirect(),function Vu(){zr.clear()}(),yield I._originValidation(o);const O=function Hr(u,o,a=null){return{type:o,eventId:a,urlResponse:null,sessionId:rs(),postBody:null,tenantId:u.tenantId,error:tt(u,"no-auth-event")}}(o,h,g);yield function ns(u,o){return Aa()._set(rr(u),o)}(o,O);const K=yield function ya(u,o,a){return Zc.apply(this,arguments)}(o,O,a),se=yield function eo(u){const{cordova:o}=Ai();return new Promise(a=>{o.plugins.browsertab.isAvailable(h=>{let g=null;h?o.plugins.browsertab.openUrl(u):g=o.InAppBrowser.open(u,function j(u=(0,$.ZQ)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(u)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(u)}()?"_blank":"_system","location=yes"),a(g)})})}(K);return function ts(u,o,a){return va.apply(this,arguments)}(o,C,se)})()}_isIframeWebStorageSupported(o,a){throw new Error("Method not implemented.")}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function ed(u){return Kr.apply(this,arguments)}(o)),this.originValidationPromises[a]}attachCallbackListeners(o,a){const{universalLinks:h,handleOpenURL:g,BuildInfo:I}=Ai(),C=setTimeout((0,A.A)(function*(){yield el(o),a.onEvent(no())}),500),O=function(){var de=(0,A.A)(function*(he){clearTimeout(C);const lt=yield el(o);let En=null;lt&&he?.url&&(En=function Bh(u,o){var a,h;const g=function Gh(u){const o=to(u),a=o.link?decodeURIComponent(o.link):void 0,h=to(a).link,g=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return to(g).link||g||h||a||u}(o);if(g.includes("/__/auth/callback")){const I=to(g),C=I.firebaseError?function rd(u){try{return JSON.parse(u)}catch{return null}}(decodeURIComponent(I.firebaseError)):null,O=null===(h=null===(a=C?.code)||void 0===a?void 0:a.split("auth/"))||void 0===h?void 0:h[1],K=O?tt(O):null;return K?{type:u.type,eventId:u.eventId,tenantId:u.tenantId,error:K,urlResponse:null,sessionId:null,postBody:null}:{type:u.type,eventId:u.eventId,tenantId:u.tenantId,sessionId:u.sessionId,urlResponse:g,postBody:null}}return null}(lt,he.url)),a.onEvent(En||no())});return function(lt){return de.apply(this,arguments)}}();typeof h<"u"&&"function"==typeof h.subscribe&&h.subscribe(null,O);const K=g,se=`${I.packageName.toLowerCase()}://`;Ai().handleOpenURL=function(){var de=(0,A.A)(function*(he){if(he.toLowerCase().startsWith(se)&&O({url:he}),"function"==typeof K)try{K(he)}catch(lt){console.error(lt)}});return function(he){return de.apply(this,arguments)}}()}};function no(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:tt("no-auth-event")}}function is(){var u;return(null===(u=self?.location)||void 0===u?void 0:u.protocol)||null}function ss(u=(0,$.ZQ)()){return!("file:"!==is()&&"ionic:"!==is()&&"capacitor:"!==is()||!u.toLowerCase().match(/iphone|ipad|ipod|android/))}function ud(){try{const u=self.localStorage,o=fr();if(u)return u.setItem(o,"1"),u.removeItem(o),!function ld(u=(0,$.ZQ)()){return function cd(){return(0,$.lT)()&&11===document?.documentMode}()||function Kh(u=(0,$.ZQ)()){return/Edge\/\d+/.test(u)}(u)}()||(0,$.zW)()}catch{return tl()&&(0,$.zW)()}return!1}function tl(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ro(){return(function bi(){return"http:"===is()||"https:"===is()}()||(0,$.sr)()||ss())&&!function ad(){return(0,$.lV)()||(0,$.Ll)()}()&&ud()&&!tl()}function Dt(){return ss()&&typeof document<"u"}function nl(){return(nl=(0,A.A)(function*(){return!!Dt()&&new Promise(u=>{const o=setTimeout(()=>{u(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),u(!0)})})})).apply(this,arguments)}const Tn={LOCAL:"local",NONE:"none",SESSION:"session"},wi=ee,dd="persistence";function os(u){return rl.apply(this,arguments)}function rl(){return(rl=(0,A.A)(function*(u){yield u._initializationPromise;const o=wa(),a=xe(dd,u.config.apiKey,u.name);o&&o.setItem(a,u._getPersistence())})).apply(this,arguments)}function wa(){var u;try{return(null===(u=function Wh(){return typeof window<"u"?window:null}())||void 0===u?void 0:u.sessionStorage)||null}catch{return null}}const il=ee;class Vn{constructor(){this.browserResolver=Ke(Xu),this.cordovaResolver=Ke(jh),this.underlyingResolver=null,this._redirectPersistence=hr,this._completeRedirectFn=Xs,this._overrideRedirectResult=Mc}_initialize(o){var a=this;return(0,A.A)(function*(){return yield a.selectUnderlyingResolver(),a.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,a,h,g){var I=this;return(0,A.A)(function*(){return yield I.selectUnderlyingResolver(),I.assertedUnderlyingResolver._openPopup(o,a,h,g)})()}_openRedirect(o,a,h,g){var I=this;return(0,A.A)(function*(){return yield I.selectUnderlyingResolver(),I.assertedUnderlyingResolver._openRedirect(o,a,h,g)})()}_isIframeWebStorageSupported(o,a){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,a)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Dt()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return il(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,A.A)(function*(){if(o.underlyingResolver)return;const a=yield function Hh(){return nl.apply(this,arguments)}();o.underlyingResolver=a?o.cordovaResolver:o.browserResolver})()}}function io(u){return u.unwrap()}function ol(u){return al(u)}function al(u){const{_tokenResponse:o}=u instanceof $.g?u.customData:u;if(!o)return null;if(!(u instanceof $.g)&&"temporaryProof"in o&&"phoneNumber"in o)return pi.credentialFromResult(u);const a=o.providerId;if(!a||a===dt.PASSWORD)return null;let h;switch(a){case dt.GOOGLE:h=tc;break;case dt.FACEBOOK:h=tu;break;case dt.GITHUB:h=Bn;break;case dt.TWITTER:h=iu;break;default:const{oauthIdToken:g,oauthAccessToken:I,oauthTokenSecret:C,pendingToken:O,nonce:K}=o;return I||C||g||O?O?a.startsWith("saml.")?ur._create(a,O):xn._fromParams({providerId:a,signInMethod:a,pendingToken:O,idToken:g,accessToken:I}):new It(a).credential({idToken:g,accessToken:I,rawNonce:K}):null}return u instanceof $.g?h.credentialFromError(u):h.credentialFromResult(u)}function cn(u,o){return o.catch(a=>{throw a instanceof $.g&&function Qh(u,o){var a;const h=null===(a=o.customData)||void 0===a?void 0:a._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new cl(u,function vh(u,o){var a;const h=(0,$.Ku)(u),g=o;return ee(o.customData.operationType,h,"argument-error"),ee(null===(a=g.customData._serverResponse)||void 0===a?void 0:a.mfaPendingCredential,h,"argument-error"),Tc._fromError(h,g)}(u,o));else if(h){const g=al(o),I=o;g&&(I.credential=g,I.tenantId=h.tenantId||void 0,I.email=h.email||void 0,I.phoneNumber=h.phoneNumber||void 0)}}(u,a),a}).then(a=>{const g=a.user;return{operationType:a.operationType,credential:ol(a),additionalUserInfo:He(a),user:yr.getOrCreate(g)}})}function Ca(u,o){return Sa.apply(this,arguments)}function Sa(){return(Sa=(0,A.A)(function*(u,o){const a=yield o;return{verificationId:a.verificationId,confirm:h=>cn(u,a.confirm(h))}})).apply(this,arguments)}class cl{constructor(o,a){this.resolver=a,this.auth=function sl(u){return u.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return cn(io(this.auth),this.resolver.resolveSignIn(o))}}class yr{constructor(o){this._delegate=o,this.multiFactor=function _u(u){const o=(0,$.Ku)(u);return qo.has(o)||qo.set(o,Wi._fromUser(o)),qo.get(o)}(o)}static getOrCreate(o){return yr.USER_MAP.has(o)||yr.USER_MAP.set(o,new yr(o)),yr.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var a=this;return(0,A.A)(function*(){return cn(a.auth,dc(a._delegate,o))})()}linkWithPhoneNumber(o,a){var h=this;return(0,A.A)(function*(){return Ca(h.auth,function Zi(u,o,a){return jn.apply(this,arguments)}(h._delegate,o,a))})()}linkWithPopup(o){var a=this;return(0,A.A)(function*(){return cn(a.auth,function Nc(u,o,a){return mi.apply(this,arguments)}(a._delegate,o,Vn))})()}linkWithRedirect(o){var a=this;return(0,A.A)(function*(){return yield os(nt(a.auth)),Fc(a._delegate,o,Vn)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var a=this;return(0,A.A)(function*(){return cn(a.auth,hc(a._delegate,o))})()}reauthenticateWithPhoneNumber(o,a){return Ca(this.auth,function xu(u,o,a){return Yo.apply(this,arguments)}(this._delegate,o,a))}reauthenticateWithPopup(o){return cn(this.auth,function ku(u,o,a){return ea.apply(this,arguments)}(this._delegate,o,Vn))}reauthenticateWithRedirect(o){var a=this;return(0,A.A)(function*(){return yield os(nt(a.auth)),Fu(a._delegate,o,Vn)})()}sendEmailVerification(o){return function uu(u,o){return Uo.apply(this,arguments)}(this._delegate,o)}unlink(o){var a=this;return(0,A.A)(function*(){return yield function hh(u,o){return ic.apply(this,arguments)}(a._delegate,o),a})()}updateEmail(o){return function hu(u,o){const a=(0,$.Ku)(u);return(0,d._isFirebaseServerApp)(a.auth.app)?Promise.reject(be(a.auth)):_c(a,o,null)}(this._delegate,o)}updatePassword(o){return function Bt(u,o){return _c((0,$.Ku)(u),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function Dc(u,o){return Ws.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function ph(u,o){return Go.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,a){return function Bo(u,o,a){return ui.apply(this,arguments)}(this._delegate,o,a)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}yr.USER_MAP=new WeakMap;const as=ee;let fd=(()=>{class u{constructor(a,h){if(this.app=a,h.isInitialized())return this._delegate=h.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:g}=a.options;as(g,"invalid-api-key",{appName:a.name}),as(g,"invalid-api-key",{appName:a.name});const I=typeof window<"u"?Vn:void 0;this._delegate=h.initialize({options:{persistence:Yh(g,a.name),popupRedirectResolver:I}}),this._delegate._updateErrorMap(Qt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?yr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(a){this._delegate.languageCode=a}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(a){this._delegate.tenantId=a}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(a,h){!function Wl(u,o,a){const h=nt(u);ee(h._canInitEmulator,h,"emulator-config-failed"),ee(/^https?:\/\//.test(o),h,"invalid-emulator-scheme");const g=!!a?.disableWarnings,I=Ql(o),{host:C,port:O}=function sh(u){const o=Ql(u),a=/(\/\/)?([^?#/]+)/.exec(u.substr(o.length));if(!a)return{host:"",port:null};const h=a[2].split("@").pop()||"",g=/^(\[[^\]]+\])(:|$)/.exec(h);if(g){const I=g[1];return{host:I,port:Yl(h.substr(I.length+1))}}{const[I,C]=h.split(":");return{host:I,port:Yl(C)}}}(o);h.config.emulator={url:`${I}//${C}${null===O?"":`:${O}`}/`},h.settings.appVerificationDisabledForTesting=!0,h.emulatorConfig=Object.freeze({host:C,port:O,protocol:I.replace(":",""),options:Object.freeze({disableWarnings:g})}),g||function oh(){function u(){const o=document.createElement("p"),a=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",u):u())}()}(this._delegate,a,h)}applyActionCode(a){return function Mo(u,o){return qi.apply(this,arguments)}(this._delegate,a)}checkActionCode(a){return $i(this._delegate,a)}confirmPasswordReset(a,h){return function _t(u,o,a){return zn.apply(this,arguments)}(this._delegate,a,h)}createUserWithEmailAndPassword(a,h){var g=this;return(0,A.A)(function*(){return cn(g._delegate,function Lo(u,o,a){return Zn.apply(this,arguments)}(g._delegate,a,h))})()}fetchProvidersForEmail(a){return this.fetchSignInMethodsForEmail(a)}fetchSignInMethodsForEmail(a){return function mc(u,o){return li.apply(this,arguments)}(this._delegate,a)}isSignInWithEmailLink(a){return function lu(u,o){const a=ks.parseLink(o);return"EMAIL_SIGNIN"===a?.operation}(0,a)}getRedirectResult(){var a=this;return(0,A.A)(function*(){as(ro(),a._delegate,"operation-not-supported-in-this-environment");const h=yield function Ys(u,o){return Nn.apply(this,arguments)}(a._delegate,Vn);return h?cn(a._delegate,Promise.resolve(h)):{credential:null,user:null}})()}addFrameworkForLogging(a){!function sd(u,o){nt(u)._logFramework(o)}(this._delegate,a)}onAuthStateChanged(a,h,g){const{next:I,error:C,complete:O}=ll(a,h,g);return this._delegate.onAuthStateChanged(I,C,O)}onIdTokenChanged(a,h,g){const{next:I,error:C,complete:O}=ll(a,h,g);return this._delegate.onIdTokenChanged(I,C,O)}sendSignInLinkToEmail(a,h){return function Vs(u,o,a){return tr.apply(this,arguments)}(this._delegate,a,h)}sendPasswordResetEmail(a,h){return function fh(u,o,a){return Gn.apply(this,arguments)}(this._delegate,a,h||void 0)}setPersistence(a){var h=this;return(0,A.A)(function*(){let g;switch(function ba(u,o){wi(Object.values(Tn).includes(o),u,"invalid-persistence-type"),(0,$.lV)()?wi(o!==Tn.SESSION,u,"unsupported-persistence-type"):(0,$.Ll)()?wi(o===Tn.NONE,u,"unsupported-persistence-type"):tl()?wi(o===Tn.NONE||o===Tn.LOCAL&&(0,$.zW)(),u,"unsupported-persistence-type"):wi(o===Tn.NONE||ud(),u,"unsupported-persistence-type")}(h._delegate,a),a){case Tn.SESSION:g=hr;break;case Tn.LOCAL:g=(yield Ke(Yi)._isAvailable())?Yi:xt;break;case Tn.NONE:g=kt;break;default:return ot("argument-error",{appName:h._delegate.name})}return h._delegate.setPersistence(g)})()}signInAndRetrieveDataWithCredential(a){return this.signInWithCredential(a)}signInAnonymously(){return cn(this._delegate,function dh(u){return rc.apply(this,arguments)}(this._delegate))}signInWithCredential(a){return cn(this._delegate,Gi(this._delegate,a))}signInWithCustomToken(a){return cn(this._delegate,function Ut(u,o){return ze.apply(this,arguments)}(this._delegate,a))}signInWithEmailAndPassword(a,h){return cn(this._delegate,function er(u,o,a){return(0,d._isFirebaseServerApp)(u.app)?Promise.reject(be(u)):Gi((0,$.Ku)(u),ai.credential(o,a)).catch(function(){var h=(0,A.A)(function*(g){throw"auth/password-does-not-meet-requirements"===g.code&&fc(u),g});return function(g){return h.apply(this,arguments)}}())}(this._delegate,a,h))}signInWithEmailLink(a,h){return cn(this._delegate,function Ki(u,o,a){return Ms.apply(this,arguments)}(this._delegate,a,h))}signInWithPhoneNumber(a,h){return Ca(this._delegate,function Rh(u,o,a){return Qo.apply(this,arguments)}(this._delegate,a,h))}signInWithPopup(a){var h=this;return(0,A.A)(function*(){return as(ro(),h._delegate,"operation-not-supported-in-this-environment"),cn(h._delegate,function Du(u,o,a){return Oc.apply(this,arguments)}(h._delegate,a,Vn))})()}signInWithRedirect(a){var h=this;return(0,A.A)(function*(){return as(ro(),h._delegate,"operation-not-supported-in-this-environment"),yield os(h._delegate),xh(h._delegate,a,Vn)})()}updateCurrentUser(a){return this._delegate.updateCurrentUser(a)}verifyPasswordResetCode(a){return function Lr(u,o){return Jn.apply(this,arguments)}(this._delegate,a)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return u.Persistence=Tn,u})();function ll(u,o,a){let h=u;"function"!=typeof u&&({next:h,error:o,complete:a}=u);const g=h;return{next:C=>g(C&&yr.getOrCreate(C)),error:o,complete:a}}function Yh(u,o){const a=function hd(u,o){const a=wa();if(!a)return[];const h=xe(dd,u,o);switch(a.getItem(h)){case Tn.NONE:return[kt];case Tn.LOCAL:return[Yi,hr];case Tn.SESSION:return[hr];default:return[]}}(u,o);if(typeof self<"u"&&!a.includes(Yi)&&a.push(Yi),typeof window<"u")for(const h of[xt,hr])a.includes(h)||a.push(h);return a.includes(kt)||a.push(kt),a}class Wr{constructor(){this.providerId="phone",this._delegate=new pi(io(Se.A.auth()))}static credential(o,a){return pi.credential(o,a)}verifyPhoneNumber(o,a){return this._delegate.verifyPhoneNumber(o,a)}unwrap(){return this._delegate}}Wr.PHONE_SIGN_IN_METHOD=pi.PHONE_SIGN_IN_METHOD,Wr.PROVIDER_ID=pi.PROVIDER_ID;const cs=ee;class ul{constructor(o,a,h=Se.A.app()){var g;cs(null===(g=h.options)||void 0===g?void 0:g.apiKey,"invalid-api-key",{appName:h.name}),this._delegate=new Pu(h.auth(),o,a),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function pd(u){u.INTERNAL.registerComponent(new zt.uA("auth-compat",o=>{const a=o.getProvider("app-compat").getImmediate(),h=o.getProvider("auth");return new fd(a,h)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:ai,FacebookAuthProvider:tu,GithubAuthProvider:Bn,GoogleAuthProvider:tc,OAuthProvider:It,SAMLAuthProvider:ko,PhoneAuthProvider:Wr,PhoneMultiFactorGenerator:Lh,RecaptchaVerifier:ul,TwitterAuthProvider:iu,Auth:fd,AuthCredential:ti,Error:$.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),u.registerVersion("@firebase/auth-compat","0.5.8")}(Se.A)}}]);