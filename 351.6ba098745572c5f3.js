"use strict";(self.webpackChunkLKovariHome=self.webpackChunkLKovariHome||[]).push([[351],{1076:(ro,Wt,W)=>{W.d(Wt,{Am:()=>Xi,Bd:()=>tt,FA:()=>De,Fy:()=>tn,I9:()=>pn,Im:()=>si,Ku:()=>ci,Ll:()=>N,T9:()=>bt,Uj:()=>je,XA:()=>ze,ZQ:()=>be,bD:()=>Mr,cY:()=>qe,eX:()=>cr,g:()=>Pe,gR:()=>Yi,hp:()=>Ji,jZ:()=>Ct,lT:()=>ii,lV:()=>Rn,nr:()=>nn,sr:()=>st,tD:()=>xn,u:()=>L,zW:()=>dn,zw:()=>re});const ce=function(A){const E=[];let b=0;for(let O=0;O<A.length;O++){let P=A.charCodeAt(O);P<128?E[b++]=P:P<2048?(E[b++]=P>>6|192,E[b++]=63&P|128):55296==(64512&P)&&O+1<A.length&&56320==(64512&A.charCodeAt(O+1))?(P=65536+((1023&P)<<10)+(1023&A.charCodeAt(++O)),E[b++]=P>>18|240,E[b++]=P>>12&63|128,E[b++]=P>>6&63|128,E[b++]=63&P|128):(E[b++]=P>>12|224,E[b++]=P>>6&63|128,E[b++]=63&P|128)}return E},Et={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,E){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const b=E?this.byteToCharMapWebSafe_:this.byteToCharMap_,O=[];for(let P=0;P<A.length;P+=3){const X=A[P],he=P+1<A.length,ve=he?A[P+1]:0,Nt=P+2<A.length,He=Nt?A[P+2]:0;let Bt=(15&ve)<<2|He>>6,Yn=63&He;Nt||(Yn=64,he||(Bt=64)),O.push(b[X>>2],b[(3&X)<<4|ve>>4],b[Bt],b[Yn])}return O.join("")},encodeString(A,E){return this.HAS_NATIVE_SUPPORT&&!E?btoa(A):this.encodeByteArray(ce(A),E)},decodeString(A,E){return this.HAS_NATIVE_SUPPORT&&!E?atob(A):function(A){const E=[];let b=0,O=0;for(;b<A.length;){const P=A[b++];if(P<128)E[O++]=String.fromCharCode(P);else if(P>191&&P<224){const X=A[b++];E[O++]=String.fromCharCode((31&P)<<6|63&X)}else if(P>239&&P<365){const Nt=((7&P)<<18|(63&A[b++])<<12|(63&A[b++])<<6|63&A[b++])-65536;E[O++]=String.fromCharCode(55296+(Nt>>10)),E[O++]=String.fromCharCode(56320+(1023&Nt))}else{const X=A[b++],he=A[b++];E[O++]=String.fromCharCode((15&P)<<12|(63&X)<<6|63&he)}}return E.join("")}(this.decodeStringToByteArray(A,E))},decodeStringToByteArray(A,E){this.init_();const b=E?this.charToByteMapWebSafe_:this.charToByteMap_,O=[];for(let P=0;P<A.length;){const X=b[A.charAt(P++)],ve=P<A.length?b[A.charAt(P)]:0;++P;const He=P<A.length?b[A.charAt(P)]:64;++P;const ge=P<A.length?b[A.charAt(P)]:64;if(++P,null==X||null==ve||null==He||null==ge)throw new At;O.push(X<<2|ve>>4),64!==He&&(O.push(ve<<4&240|He>>2),64!==ge&&O.push(He<<6&192|ge))}return O},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class At extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const je=function(A){return function(A){const E=ce(A);return Et.encodeByteArray(E,!0)}(A).replace(/\./g,"")},L=function(A){try{return Et.decodeString(A,!0)}catch(E){console.error("base64Decode failed: ",E)}return null};function re(A,E){if(!(E instanceof Object))return E;switch(E.constructor){case Date:return new Date(E.getTime());case Object:void 0===A&&(A={});break;case Array:A=[];break;default:return E}for(const b in E)!E.hasOwnProperty(b)||!ae(b)||(A[b]=re(A[b],E[b]));return A}function ae(A){return"__proto__"!==A}const we=()=>{try{return function Ne(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if(typeof document>"u")return;let A;try{A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const E=A&&L(A[1]);return E&&JSON.parse(E)})()}catch(A){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${A}`)}},bt=()=>{var A;return null===(A=we())||void 0===A?void 0:A.config},ze=A=>{var E;return null===(E=we())||void 0===E?void 0:E[`_${A}`]};class qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((E,b)=>{this.resolve=E,this.reject=b})}wrapCallback(E){return(b,O)=>{b?this.reject(b):this.resolve(O),"function"==typeof E&&(this.promise.catch(()=>{}),1===E.length?E(b):E(b,O))}}}function tn(A,E){if(A.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const O=E||"demo-project",P=A.iat||0,X=A.sub||A.user_id;if(!X)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const he=Object.assign({iss:`https://securetoken.google.com/${O}`,aud:O,iat:P,exp:P+3600,auth_time:P,sub:X,user_id:X,firebase:{sign_in_provider:"custom",identities:{}}},A);return[je(JSON.stringify({alg:"none",type:"JWT"})),je(JSON.stringify(he)),""].join(".")}function be(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ct(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(be())}function N(){var A;const E=null===(A=we())||void 0===A?void 0:A.forceEnvironment;if("node"===E)return!0;if("browser"===E)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function tt(){return"object"==typeof self&&self.self===self}function st(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id}function Rn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ii(){const A=be();return A.indexOf("MSIE ")>=0||A.indexOf("Trident/")>=0}function nn(){return!N()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dn(){try{return"object"==typeof indexedDB}catch{return!1}}function cr(){return new Promise((A,E)=>{try{let b=!0;const O="validate-browser-context-for-indexeddb-analytics-module",P=self.indexedDB.open(O);P.onsuccess=()=>{P.result.close(),b||self.indexedDB.deleteDatabase(O),A(!0)},P.onupgradeneeded=()=>{b=!1},P.onerror=()=>{var X;E((null===(X=P.error)||void 0===X?void 0:X.message)||"")}}catch(b){E(b)}})}class Pe extends Error{constructor(E,b,O){super(b),this.code=E,this.customData=O,this.name="FirebaseError",Object.setPrototypeOf(this,Pe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,De.prototype.create)}}class De{constructor(E,b,O){this.service=E,this.serviceName=b,this.errors=O}create(E,...b){const O=b[0]||{},P=`${this.service}/${E}`,X=this.errors[E],he=X?function Nr(A,E){return A.replace(hn,(b,O)=>{const P=E[O];return null!=P?String(P):`<${O}?>`})}(X,O):"Error";return new Pe(P,`${this.serviceName}: ${he} (${P}).`,O)}}const hn=/\{\$([^}]+)}/g;function Yi(A,E){return Object.prototype.hasOwnProperty.call(A,E)}function si(A){for(const E in A)if(Object.prototype.hasOwnProperty.call(A,E))return!1;return!0}function Mr(A,E){if(A===E)return!0;const b=Object.keys(A),O=Object.keys(E);for(const P of b){if(!O.includes(P))return!1;const X=A[P],he=E[P];if(Ft(X)&&Ft(he)){if(!Mr(X,he))return!1}else if(X!==he)return!1}for(const P of O)if(!b.includes(P))return!1;return!0}function Ft(A){return null!==A&&"object"==typeof A}function Xi(A){const E=[];for(const[b,O]of Object.entries(A))Array.isArray(O)?O.forEach(P=>{E.push(encodeURIComponent(b)+"="+encodeURIComponent(P))}):E.push(encodeURIComponent(b)+"="+encodeURIComponent(O));return E.length?"&"+E.join("&"):""}function pn(A){const E={};return A.replace(/^\?/,"").split("&").forEach(O=>{if(O){const[P,X]=O.split("=");E[decodeURIComponent(P)]=decodeURIComponent(X)}}),E}function Ji(A){const E=A.indexOf("?");if(!E)return"";const b=A.indexOf("#",E);return A.substring(E,b>0?b:void 0)}function xn(A,E){const b=new mn(A,E);return b.subscribe.bind(b)}class mn{constructor(E,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{E(this)}).catch(O=>{this.error(O)})}next(E){this.forEachObserver(b=>{b.next(E)})}error(E){this.forEachObserver(b=>{b.error(E)}),this.close(E)}complete(){this.forEachObserver(E=>{E.complete()}),this.close()}subscribe(E,b,O){let P;if(void 0===E&&void 0===b&&void 0===O)throw new Error("Missing Observer.");P=function Kn(A,E){if("object"!=typeof A||null===A)return!1;for(const b of E)if(b in A&&"function"==typeof A[b])return!0;return!1}(E,["next","error","complete"])?E:{next:E,error:b,complete:O},void 0===P.next&&(P.next=lr),void 0===P.error&&(P.error=lr),void 0===P.complete&&(P.complete=lr);const X=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?P.error(this.finalError):P.complete()}catch{}}),this.observers.push(P),X}unsubscribeOne(E){void 0===this.observers||void 0===this.observers[E]||(delete this.observers[E],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(E){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,E)}sendOne(E,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[E])try{b(this.observers[E])}catch(O){typeof console<"u"&&console.error&&console.error(O)}})}close(E){this.finalized||(this.finalized=!0,void 0!==E&&(this.finalError=E),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lr(){}function ci(A){return A&&A._delegate?A._delegate:A}},2351:(ro,Wt,W)=>{W.r(Wt),W.d(Wt,{DigitsModule:()=>OE});var v=W(177),fe=W(3331),u=W(4438),ce=W(5779);let Ie=(()=>{class n{static#e=this.OPERATOR_REV="\xab";static#t=this.OPERATOR_ADD="+";static#n=this.OPERATOR_SUB="-";static#r=this.OPERATOR_MUL="\xd7";static#i=this.OPERATOR_DIV="/"}return n})();class Et{constructor(e,t,r,i){this.id=e,this.selected=t,this.disabled=r,this.value=i}}class At{constructor(){this.operands=[]}}class wt{static evaluate(e,t,r){let i=Number.MIN_VALUE;switch(r){case Ie.OPERATOR_ADD:i=e+t;break;case Ie.OPERATOR_SUB:i=e>=t?e-t:Number.MIN_VALUE;break;case Ie.OPERATOR_DIV:i=e%t==0?e/t:Number.MIN_VALUE;break;case Ie.OPERATOR_MUL:i=e*t}return i}static cloneGameParameters(e){const t=new At;return t.result=e.result,e.operands.forEach(r=>{const i=new Et(r.id,!1,!1,-1);Object.assign(i,r),t.operands.push(i)}),t}}class je{constructor(){this.numbers=[]}generateNumber(e,t){let r=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(r)>=0;)r=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(r)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}}class L{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){const e=this.generateNumber(0,4);let t=Ie.OPERATOR_ADD;switch(e){case 0:t=Ie.OPERATOR_ADD;break;case 1:t=Ie.OPERATOR_SUB;break;case 2:t=Ie.OPERATOR_MUL;break;case 3:t=Ie.OPERATOR_DIV}return t}checkExecuteDivision(e,t){return e%t==0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let r=t;return e<t&&(r=t-1),this.operands.splice(e,1),r}calculateResult(e){let t=this.operands.length,r=0,i=0;const s=this.generateNumber(3,5);let a=Number.MIN_VALUE;for(;i<s&&e.length>1;){const h=this.choiceRandomOperation();let f=this.generateNumber(0,t-1);for(a===Number.MIN_VALUE&&(a=this.generateNumber(0,t-1));a===f;)f=this.generateNumber(0,t-1);switch(h){case Ie.OPERATOR_ADD:e[a]=wt.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case Ie.OPERATOR_SUB:if(!this.checkExecuteSubstraction(e[a],e[f]))continue;e[a]=wt.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case Ie.OPERATOR_MUL:e[a]=wt.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i;break;case Ie.OPERATOR_DIV:if(!this.checkExecuteDivision(e[a],e[f]))continue;e[a]=wt.evaluate(e[a],e[f],h),a=this.removeOperandByIndex(f,a),--t,++i}}return r=e[a],r}generateGameParameter(e){const t=new je;switch(e){case 0:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break;case 1:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break;case 2:t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 3:t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break;case 4:t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25)}let r=t.getGeneratedNumbers();r=r.sort((g,y)=>g-y);const i=new Array(r[0],r[1],r[2],r[3],r[4],r[5]);this.operands=new Array(r[0],r[1],r[2],r[3],r[4],r[5]),t.clearGeneratedNumbers();let s=0,a=0;switch(e){case 0:s=30,a=100;break;case 1:s=50,a=150;break;case 2:s=100,a=200;break;case 3:s=300,a=400;break;case 4:s=400,a=550}let h=this.calculateResult(this.operands);for(;s>h||h>a;)this.operands=new Array(r[0],r[1],r[2],r[3],r[4],r[5]),h=this.calculateResult(this.operands);const f=new At;f.result=h;let m=0;return i.forEach(g=>{const y=new Et(m,!1,!1,g);f.operands.push(y),++m}),f}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){const r=this.generateGameParameter(t);r.stageIndex=t,e.push(r)}return e=e.sort((t,r)=>t.result-r.result),e}}class j{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}}let re=(()=>{class n{constructor(t,r){this.document=t,this.platformId=r,this.documentIsAccessible=(0,v.UE)(this.platformId)}static getCookieRegExp(t){const r=t.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+r+"|;\\s*"+r+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(t){try{return decodeURIComponent(t)}catch{return t}}check(t){return!!this.documentIsAccessible&&(t=encodeURIComponent(t),n.getCookieRegExp(t).test(this.document.cookie))}get(t){if(this.documentIsAccessible&&this.check(t)){t=encodeURIComponent(t);const i=n.getCookieRegExp(t).exec(this.document.cookie);return i[1]?n.safeDecodeURIComponent(i[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const t={},r=this.document;return r.cookie&&""!==r.cookie&&r.cookie.split(";").forEach(i=>{const[s,a]=i.split("=");t[n.safeDecodeURIComponent(s.replace(/^ /,""))]=n.safeDecodeURIComponent(a)}),t}set(t,r,i,s,a,h,f){if(!this.documentIsAccessible)return;if("number"==typeof i||i instanceof Date||s||a||h||f)return void this.set(t,r,{expires:i,path:s,domain:a,secure:h,sameSite:f||"Lax"});let m=encodeURIComponent(t)+"="+encodeURIComponent(r)+";";const g=i||{};g.expires&&(m+="number"==typeof g.expires?"expires="+new Date((new Date).getTime()+1e3*g.expires*60*60*24).toUTCString()+";":"expires="+g.expires.toUTCString()+";"),g.path&&(m+="path="+g.path+";"),g.domain&&(m+="domain="+g.domain+";"),!1===g.secure&&"None"===g.sameSite&&(g.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${t} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),g.secure&&(m+="secure;"),g.sameSite||(g.sameSite="Lax"),m+="sameSite="+g.sameSite+";",this.document.cookie=m}delete(t,r,i,s,a="Lax"){this.documentIsAccessible&&this.set(t,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:r,domain:i,secure:s,sameSite:a})}deleteAll(t,r,i,s="Lax"){if(!this.documentIsAccessible)return;const a=this.getAll();for(const h in a)a.hasOwnProperty(h)&&this.delete(h,t,r,i,s)}static#e=this.\u0275fac=function(r){return new(r||n)(u.KVO(v.qQ),u.KVO(u.Agw))};static#t=this.\u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ae=W(6354);class Ne{constructor(){this.stages=[]}}class kt{constructor(){this.operands=[]}}class Le{}var Te=W(9079);const we=new u.nKC("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var gt=W(1413);let Ht=(()=>{class n{constructor(t,r,i){this.ngZone=t,this.document=r,this.window=i,this.copySubject=new gt.B,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});const r=this.copyFromContent(t);return this.pushCopyResponse(r?{content:t,isSuccess:r}:{isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,r=!0){try{this.selectTarget(t);const i=this.copyText();return this.clearSelection(r?t:void 0,this.window),i&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){const t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,r=this.document.body){if(this.tempTextArea&&!r.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{r.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;const i=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),i}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,r){t&&t.focus(),r.getSelection()?.removeAllRanges()}createTempTextArea(t,r){const i="rtl"===t.documentElement.getAttribute("dir");let s;return s=t.createElement("textarea"),s.style.fontSize="12pt",s.style.border="0",s.style.padding="0",s.style.margin="0",s.style.position="absolute",s.style[i?"right":"left"]="-9999px",s.style.top=(r.pageYOffset||t.documentElement.scrollTop)+"px",s.setAttribute("readonly",""),s}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return n.\u0275fac=function(t){return new(t||n)(u.KVO(u.SKi),u.KVO(v.qQ),u.KVO(we,8))},n.\u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=u.$C({type:n}),n.\u0275inj=u.G2t({imports:[v.MD]}),n})();var tn=W(7852);(0,tn.registerVersion)("firebase","10.7.1","app");var N=W(6780),st=W(9687);const ar=new class Rn extends st.q{}(class tt extends N.R{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}});var un=W(3236),io=W(8141),nn=W(6745),dn=W(941);const cr=new u.RxE("ANGULARFIRE2_VERSION");class De{constructor(){return((n,e)=>{const t=(0,tn.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r})(Nr)}}const Nr="app-check";function hn(){}class $n{zone;delegate;constructor(e,t=ar){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(a){i.runGuarded(()=>{e.apply(this,[a])})},t,r)}}class rn{zone;task=null;constructor(e){this.zone=e}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",hn,{},hn,hn)),t.pipe((0,io.M)({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let fn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new $n(Zone.current)),this.insideAngular=t.run(()=>new $n(Zone.current,un.E)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(u.KVO(u.SKi))};static \u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _t(n){return function si(n){return function(t){return(t=t.lift(new rn(n.ngZone))).pipe((0,nn._)(n.outsideAngular),(0,dn.Q)(n.insideAngular))}}(function Sn(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}())(n)}var Ft=W(3345);Ft.A.registerVersion("firebase","10.7.1","app-compat");const pn=["ngOnDestroy"];class xn{constructor(e){return e}}const mn=new u.nKC("angularfire2.app.options"),gn=new u.nKC("angularfire2.app.name");function Kn(n,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const a=Ft.A.apps.filter(h=>h&&h.name===i.name)[0]||e.runOutsideAngular(()=>Ft.A.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(a.options)){const h=!!module.hot;lr("error",`${a.name} Firebase App already initialized with different options${h?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new xn(a)}const lr=(n,...e)=>{(0,u.naY)()&&typeof console<"u"&&console[n](...e)},ai={provide:xn,useFactory:Kn,deps:[mn,u.SKi,[new u.Xx1,gn]]};let Wn=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:mn,useValue:t},{provide:gn,useValue:r}]}}constructor(t){Ft.A.registerVersion("angularfire",cr.full,"core"),Ft.A.registerVersion("angularfire",cr.full,"app-compat"),Ft.A.registerVersion("angular",u.xvI.full,t.toString())}static \u0275fac=function(r){return new(r||n)(u.KVO(u.Agw))};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({providers:[ai]})}return n})();function ur(n,e,t,r,i){const[,s,a]=globalThis.\u0275AngularfireInstanceCache.find(h=>h[0]===n)||[];if(s)return function sn(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(i,a)||(Lr("error",`${e} was already initialized on the ${t} Firebase App with different settings.${on?" You may need to reload as Firebase is not HMR aware.":""}`),Lr("warn",{is:i,was:a})),s;{const h=r();return globalThis.\u0275AngularfireInstanceCache.push([n,h,i]),h}}const on=typeof module<"u"&&!!module.hot,Lr=(n,...e)=>{(0,u.naY)()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[],W(3228);var Hn=W(7673),dr=W(1985),Ut=W(8455),Qn=W(7786),Ot=W(5558),Fr=W(6496),lo=W(1594),Zi=W(8071);function ci(n,e){return(0,Zi.T)(e)?(0,Ot.n)(()=>n,e):(0,Ot.n)(()=>n)}var A=W(5964);const b=new u.nKC("angularfire2.auth.use-emulator"),O=new u.nKC("angularfire2.auth.settings"),P=new u.nKC("angularfire2.auth.tenant-id"),X=new u.nKC("angularfire2.auth.langugage-code"),he=new u.nKC("angularfire2.auth.use-device-language"),ve=new u.nKC("angularfire.auth.persistence"),Nt=(n,e,t,r,i,s,a,h)=>ur(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),r&&(f.tenantId=r),f.languageCode=i,s&&f.useDeviceLanguage(),a)for(const[m,g]of Object.entries(a))f.settings[m]=g;return h&&f.setPersistence(h),f},[t,r,i,s,a,h]);let He=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,a,h,f,m,g,y,w,S){const U=new gt.B,G=(0,Hn.of)(void 0).pipe((0,dn.Q)(a.outsideAngular),(0,Ot.n)(()=>s.runOutsideAngular(()=>Promise.resolve().then(W.bind(W,3228)))),(0,ae.T)(()=>Kn(t,s,r)),(0,ae.T)(B=>Nt(B,s,h,m,g,y,f,w)),(0,Fr.t)({bufferSize:1,refCount:!1}));if((0,v.Vy)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Hn.of)(null);else{G.pipe((0,lo.$)()).subscribe();const B=G.pipe((0,Ot.n)(H=>H.getRedirectResult().then(ue=>ue,()=>null)),_t,(0,Fr.t)({bufferSize:1,refCount:!1})),ie=G.pipe((0,Ot.n)(H=>new dr.c(ue=>({unsubscribe:s.runOutsideAngular(()=>H.onAuthStateChanged(ye=>ue.next(ye),ye=>ue.error(ye),()=>ue.complete()))})))),oe=G.pipe((0,Ot.n)(H=>new dr.c(ue=>({unsubscribe:s.runOutsideAngular(()=>H.onIdTokenChanged(ye=>ue.next(ye),ye=>ue.error(ye),()=>ue.complete()))}))));this.authState=B.pipe(ci(ie),(0,nn._)(a.outsideAngular),(0,dn.Q)(a.insideAngular)),this.user=B.pipe(ci(oe),(0,nn._)(a.outsideAngular),(0,dn.Q)(a.insideAngular)),this.idToken=this.user.pipe((0,Ot.n)(H=>H?(0,Ut.H)(H.getIdToken()):(0,Hn.of)(null))),this.idTokenResult=this.user.pipe((0,Ot.n)(H=>H?(0,Ut.H)(H.getIdTokenResult()):(0,Hn.of)(null))),this.credential=(0,Qn.h)(B,U,this.authState.pipe((0,A.p)(H=>!H))).pipe((0,ae.T)(H=>H?.user?H:null),(0,nn._)(a.outsideAngular),(0,dn.Q)(a.insideAngular))}return((n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(pn.indexOf(s)>-1)return()=>{};const a=e.toPromise().then(h=>{const f=h?.[s];return"function"==typeof f?f.bind(h):f?.then?f.then(m=>t.run(()=>m)):t.run(()=>f)});return new Proxy(()=>{},{get:(h,f)=>a[f],apply:(h,f,m)=>a.then(g=>{const y=g?.(...m);return r?.spy?.apply&&r.spy.apply(s,m,y),y})})})}))(this,G,s,{spy:{apply:(B,ie,oe)=>{(B.startsWith("signIn")||B.startsWith("createUser"))&&oe.then(H=>U.next(H))}}})}static \u0275fac=function(r){return new(r||n)(u.KVO(mn),u.KVO(gn,8),u.KVO(u.Agw),u.KVO(u.SKi),u.KVO(fn),u.KVO(b,8),u.KVO(O,8),u.KVO(P,8),u.KVO(X,8),u.KVO(he,8),u.KVO(ve,8),u.KVO(De,8))};static \u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var ge=W(9172),Bt=W(9974),Yn=W(4360);function Dn(){return(0,Bt.N)((n,e)=>{let t,r=!1;n.subscribe((0,Yn._)(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var z,li=W(2816),D=W(3294),I=W(467),F=W(1362),Q=W(8041),Y=W(1076),Ee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},me={},$e=$e||{},se=Ee||self;function Xn(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function es(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var ts="closure_uid_"+(1e9*Math.random()>>>0),zd=0;function Gd(n,e,t){return n.call.apply(n.bind,arguments)}function jd(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function _e(n,e,t){return(_e=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Gd:jd).apply(null,arguments)}function ns(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ht(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),h=2;h<arguments.length;h++)a[h-2]=arguments[h];return e.prototype[i].apply(r,a)}}function kn(){this.s=this.s,this.o=this.o}kn.prototype.s=!1,kn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Bd(n){Object.prototype.hasOwnProperty.call(n,ts)&&n[ts]||(n[ts]=++zd)}(this)},kn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Fl=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function La(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Ul(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Xn(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function vt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}vt.prototype.h=function(){this.defaultPrevented=!0};var Bl=function(){if(!se.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};se.addEventListener("test",t,e),se.removeEventListener("test",t,e)}catch{}return n}();function Ur(n){return/^[\s\xa0]*$/.test(n)}function hr(){var n=se.navigator;return n&&(n=n.userAgent)?n:""}function an(n){return-1!=hr().indexOf(n)}function Fa(n){return Fa[" "](n),n}Fa[" "]=function(){};var fr,n,qd=an("Opera"),ui=an("Trident")||an("MSIE"),Ba=an("Edge"),uo=Ba||ui,zl=an("Gecko")&&!(-1!=hr().toLowerCase().indexOf("webkit")&&!an("Edge"))&&!(an("Trident")||an("MSIE"))&&!an("Edge"),Gl=-1!=hr().toLowerCase().indexOf("webkit")&&!an("Edge");function jl(){var n=se.document;return n?n.documentMode:void 0}e:{var ho="",rs=(n=hr(),zl?/rv:([^\);]+)(\)|;)/.exec(n):Ba?/Edge\/([\d\.]+)/.exec(n):ui?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Gl?/WebKit\/(\S+)/.exec(n):qd?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(rs&&(ho=rs?rs[1]:""),ui){var za=jl();if(null!=za&&za>parseFloat(ho)){fr=String(za);break e}}fr=ho}var Ga=se.document&&ui&&(jl()||parseInt(fr,10))||void 0;function ss(n,e){if(vt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(zl){e:{try{Fa(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ja[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&ss.$.h.call(this)}}ht(ss,vt);var ja={2:"touch",3:"pen",4:"mouse"};ss.prototype.h=function(){ss.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var os="closure_listenable_"+(1e6*Math.random()|0),qa=0;function fo(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++qa,this.fa=this.ia=!1}function di(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function $a(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function $l(n){const e={};for(const t in n)e[t]=n[t];return e}const po="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Kl(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<po.length;s++)t=po[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function hi(n){this.src=n,this.g={},this.h=0}function Wa(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=Fl(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(di(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function as(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}hi.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var a=as(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):((e=new fo(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var Ha="closure_lm_"+(1e6*Math.random()|0),cs={};function Wl(n,e,t,r,i){if(r&&r.once)return On(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Wl(n,e[s],t,r,i);return null}return t=ds(t),n&&n[os]?n.O(e,t,es(r)?!!r.capture:!!r,i):mo(n,e,t,!1,r,i)}function mo(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=es(i)?!!i.capture:!!i,h=us(n);if(h||(n[Ha]=h=new hi(n)),(t=h.add(e,t,r,a,s)).proxy)return t;if(r=function ls(){const e=$d;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)Bl||(i=a),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(_n(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function On(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)On(n,e[s],t,r,i);return null}return t=ds(t),n&&n[os]?n.P(e,t,es(r)?!!r.capture:!!r,i):mo(n,e,t,!0,r,i)}function go(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)go(n,e[s],t,r,i);else r=es(r)?!!r.capture:!!r,t=ds(t),n&&n[os]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=as(s=n.g[e],t,r,i))&&(di(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=us(n))&&(e=n.g[e.toString()],n=-1,e&&(n=as(e,t,r,i)),(t=-1<n?e[n]:null)&&Qa(t))}function Qa(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[os])Wa(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(_n(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=us(e))?(Wa(t,n),0==t.h&&(t.src=null,e[Ha]=null)):di(n)}}}function _n(n){return n in cs?cs[n]:cs[n]="on"+n}function $d(n,e){if(n.fa)n=!0;else{e=new ss(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Qa(n),n=t.call(r,e)}return n}function us(n){return(n=n[Ha])instanceof hi?n:null}var Ya="__closure_events_fn_"+(1e9*Math.random()>>>0);function ds(n){return"function"==typeof n?n:(n[Ya]||(n[Ya]=function(e){return n.handleEvent(e)}),n[Ya])}function ft(){kn.call(this),this.i=new hi(this),this.S=this,this.J=null}function ct(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new vt(e,n);else if(e instanceof vt)e.target=e.target||n;else{var i=e;Kl(e=new vt(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=_o(a,r,!0,e)&&i}if(i=_o(a=e.g=n,r,!0,e)&&i,i=_o(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=_o(a=e.g=t[s],r,!1,e)&&i}function _o(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var h=a.listener,f=a.la||a.src;a.ia&&Wa(n.i,a),i=!1!==h.call(f,r)&&i}}return i&&!r.defaultPrevented}ht(ft,kn),ft.prototype[os]=!0,ft.prototype.removeEventListener=function(n,e,t,r){go(this,n,e,t,r)},ft.prototype.N=function(){if(ft.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)di(t[r]);delete n.g[e],n.h--}}this.J=null},ft.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},ft.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Xa=se.JSON.stringify;function Br(){var n=pr;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Hl=new class Ja{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new hs,n=>n.reset());class hs{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Qp(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Za(n){se.setTimeout(()=>{throw n},0)}let Yt,Nn=!1,pr=new class Kd{constructor(){this.h=this.g=null}add(e,t){const r=Hl.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},ec=()=>{const n=se.Promise.resolve(void 0);Yt=()=>{n.then(Ql)}};var Ql=()=>{for(var n;n=Br();){try{n.h.call(n.g)}catch(t){Za(t)}var e=Hl;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Nn=!1};function fs(n,e){ft.call(this),this.h=n||1,this.g=e||se,this.j=_e(this.qb,this),this.l=Date.now()}function tc(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function mr(n,e,t){if("function"==typeof n)t&&(n=_e(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=_e(n.handleEvent,n)}return 2147483647<Number(e)?-1:se.setTimeout(n,e||0)}function Yl(n){n.g=mr(()=>{n.g=null,n.i&&(n.i=!1,Yl(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ht(fs,ft),(z=fs.prototype).ga=!1,z.T=null,z.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ct(this,"tick"),this.ga&&(tc(this),this.start()))}},z.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},z.N=function(){fs.$.N.call(this),tc(this),delete this.g};class yo extends kn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Yl(this)}N(){super.N(),this.g&&(se.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fi(n){kn.call(this),this.h=n,this.g={}}ht(fi,kn);var nc=[];function vo(n,e,t,r){Array.isArray(t)||(t&&(nc[0]=t.toString()),t=nc);for(var i=0;i<t.length;i++){var s=Wl(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Xt(n){$a(n.g,function(e,t){this.g.hasOwnProperty(t)&&Qa(e)},n),n.g={}}function ps(){this.g=!0}function Jn(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Jl(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return Xa(t)}catch{return e}}(n,t)+(r?" "+r:"")})}fi.prototype.N=function(){fi.$.N.call(this),Xt(this)},fi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ps.prototype.Ea=function(){this.g=!1},ps.prototype.info=function(){};var zr={},Io=null;function pi(){return Io=Io||new ft}function To(n){vt.call(this,zr.Ta,n)}function gr(n){const e=pi();ct(e,new To(e))}function Eo(n,e){vt.call(this,zr.STAT_EVENT,n),this.stat=e}function Rt(n){const e=pi();ct(e,new Eo(e,n))}function Ao(n,e){vt.call(this,zr.Ua,n),this.size=e}function mi(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return se.setTimeout(function(){n()},e)}zr.Ta="serverreachability",ht(To,vt),zr.STAT_EVENT="statevent",ht(Eo,vt),zr.Ua="timingevent",ht(Ao,vt);var gi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ms={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function gs(){}function wo(){}gs.prototype.h=null;var ys,_i={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function _s(){vt.call(this,"d")}function sc(){vt.call(this,"c")}function bo(){}function Gr(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new fi(this),this.P=oc,this.V=new fs(n=uo?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new yi}function yi(){this.i=null,this.g="",this.h=!1}ht(_s,vt),ht(sc,vt),ht(bo,gs),bo.prototype.g=function(){return new XMLHttpRequest},bo.prototype.i=function(){return{}},ys=new bo;var oc=45e3,Co={},vi={};function vs(n,e,t){n.L=1,n.A=Do(tr(e)),n.u=t,n.S=!0,Ro(n,null)}function Ro(n,e){n.G=Date.now(),jr(n),n.B=tr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),ko(t.i,"t",r),n.o=0,t=n.l.J,n.h=new yi,n.g=Iu(n.l,t?e:null,!n.u),0<n.O&&(n.M=new yo(_e(n.Pa,n,n.g),n.O)),vo(n.U,n.g,"readystatechange",n.nb),e=n.I?$l(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),gr(),function Wd(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",h=s.split("&"),f=0;f<h.length;f++){var m=h[f].split("=");if(1<m.length){var g=m[0];m=m[1];var y=g.split("_");a=2<=y.length&&"type"==y[1]?a+(g+"=")+m+"&":a+(g+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+a})}(n.j,n.v,n.B,n.m,n.W,n.u)}function Zl(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function So(n,e,t){let i,r=!0;for(;!n.J&&n.o<t.length;){if(i=Hd(n,t),i==vi){4==e&&(n.s=4,Rt(14),r=!1),Jn(n.j,n.m,null,"[Incomplete Response]");break}if(i==Co){n.s=4,Rt(15),Jn(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Jn(n.j,n.m,i,null),ac(n,i)}Zl(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=e||0!=t.length||n.h.h||(n.s=1,Rt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),yc(e),e.M=!0,Rt(11))):(Jn(n.j,n.m,t,"[Invalid Chunked Response]"),Zn(n),Ti(n))}function Hd(n,e){var t=n.o,r=e.indexOf("\n",t);return-1==r?vi:(t=Number(e.substring(t,r)),isNaN(t)?Co:(r+=1)+t>e.length?vi:(e=e.slice(r,r+t),n.o=r+t,e))}function jr(n){n.Y=Date.now()+n.P,eu(n,n.P)}function eu(n,e){if(null!=n.C)throw Error("WatchDog timer not null");n.C=mi(_e(n.lb,n),e)}function Ii(n){n.C&&(se.clearTimeout(n.C),n.C=null)}function Ti(n){0==n.l.H||n.J||vu(n.l,n)}function Zn(n){Ii(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,tc(n.V),Xt(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function ac(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||fc(t.i,n)))if(!n.K&&fc(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;ws(t),Lo(t)}As(t),Rt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=mi(_e(t.ib,t),6e3));if(1>=cu(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ir(t,11)}else if((n.K||t.g==n)&&ws(t),!Ur(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let m=i[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const g=m[3];null!=g&&(t.ra=g,t.l.info("VER="+t.ra));const y=m[4];null!=y&&(t.Ga=y,t.l.info("SVER="+t.Ga));const w=m[5];null!=w&&"number"==typeof w&&0<w&&(t.L=r=1.5*w,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const S=n.g;if(S){const U=S.g?S.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(U){var s=r.i;s.g||-1==U.indexOf("spdy")&&-1==U.indexOf("quic")&&-1==U.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(lu(s,s.h),s.h=null))}if(r.F){const G=S.g?S.g.getResponseHeader("X-HTTP-Session-Id"):null;G&&(r.Da=G,Me(r.I,r.F,G))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var a=n;if((r=t).wa=Cs(r,r.J?r.pa:null,r.Y),a.K){eh(r.i,a);var h=a,f=r.L;f&&h.setTimeout(f),h.C&&(Ii(h),jr(h)),r.g=a}else _u(r);0<t.j.length&&vr(t)}else"stop"!=m[0]&&"close"!=m[0]||Ir(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?Ir(t,7):Vn(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}gr()}catch{}}function Po(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Xn(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Qd(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Xn(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function cc(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Xn(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(z=Gr.prototype).setTimeout=function(n){this.P=n},z.nb=function(n){n=n.target;const e=this.M;e&&3==vn(n)?e.l():this.Pa(n)},z.Pa=function(n){try{if(n==this.g)e:{const g=vn(this.g);var e=this.g.Ia();if(this.g.da(),!(3>g)&&(3!=g||uo||this.g&&(this.h.h||this.g.ja()||fu(this.g)))){this.J||4!=g||7==e||gr(),Ii(this);var t=this.g.da();this.ca=t;t:if(Zl(this)){var r=fu(this.g);n="";var i=r.length,s=4==vn(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Zn(this),Ti(this);var a="";break t}this.h.i=new se.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=200==t,function rc(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+a})}(this.j,this.v,this.B,this.m,this.W,g,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var h,f=this.g;if((h=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ur(h)){var m=h;break t}}m=null}if(!(t=m)){this.i=!1,this.s=3,Rt(12),Zn(this),Ti(this);break e}Jn(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ac(this,t)}this.S?(So(this,g,a),uo&&this.i&&3==g&&(vo(this.U,this.V,"tick",this.mb),this.V.start())):(Jn(this.j,this.m,a,null),ac(this,a)),4==g&&Zn(this),this.i&&!this.J&&(4==g?vu(this.l,this):(this.i=!1,jr(this)))}else(function ah(n){const e={};n=(n.g&&2<=vn(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(Ur(n[r]))continue;var t=Qp(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function Ka(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<a.indexOf("Unknown SID")?(this.s=3,Rt(12)):(this.s=0,Rt(13)),Zn(this),Ti(this)}}}catch{}},z.mb=function(){if(this.g){var n=vn(this.g),e=this.g.ja();this.o<e.length&&(Ii(this),So(this,n,e),this.i&&4!=n&&jr(this))}},z.cancel=function(){this.J=!0,Zn(this)},z.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function Xl(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(gr(),Rt(17)),Zn(this),this.s=2,Ti(this)):eu(this,this.Y-n)};var tu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function er(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof er){this.h=n.h,xo(this,n.j),this.s=n.s,this.g=n.g,Ei(this,n.m),this.l=n.l;var e=n.i,t=new $r;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),nu(this,t),this.o=n.o}else n&&(e=String(n).match(tu))?(this.h=!1,xo(this,e[1]||"",!0),this.s=qr(e[2]||""),this.g=qr(e[3]||"",!0),Ei(this,e[4]),this.l=qr(e[5]||"",!0),nu(this,e[6]||"",!0),this.o=qr(e[7]||"")):(this.h=!1,this.i=new $r(null,this.h))}function tr(n){return new er(n)}function xo(n,e,t){n.j=t?qr(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Ei(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function nu(n,e,t){e instanceof $r?(n.i=e,function wi(n,e){e&&!n.j&&(_r(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(iu(this,r),ko(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=Is(e,dc)),n.i=new $r(e,n.h))}function Me(n,e,t){n.i.set(e,t)}function Do(n){return Me(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function qr(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Is(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,lc),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function lc(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}er.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Is(e,ru,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Is(e,ru,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(Is(t,"/"==t.charAt(0)?Xd:uc,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Is(t,Jd)),n.join("")};var ru=/[#\/\?@]/g,uc=/[#\?:]/g,Xd=/[#\?]/g,dc=/[#\?@]/g,Jd=/#/g;function $r(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function _r(n){n.g||(n.g=new Map,n.h=0,n.i&&function Yd(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function iu(n,e){_r(n),e=Ai(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function hc(n,e){return _r(n),e=Ai(n,e),n.g.has(e)}function ko(n,e,t){iu(n,e),0<t.length&&(n.i=null,n.g.set(Ai(n,e),La(t)),n.h+=t.length)}function Ai(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}(z=$r.prototype).add=function(n,e){_r(this),this.i=null,n=Ai(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},z.forEach=function(n,e){_r(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},z.ta=function(){_r(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},z.Z=function(n){_r(this);let e=[];if("string"==typeof n)hc(this,n)&&(e=e.concat(this.g.get(Ai(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},z.set=function(n,e){return _r(this),this.i=null,hc(this,n=Ai(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},z.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},z.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};var su=class{constructor(n,e){this.g=n,this.map=e}};function ou(n){this.l=n||Zd,n=se.PerformanceNavigationTiming?0<(n=se.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(se.g&&se.g.Ka&&se.g.Ka()&&se.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Zd=10;function au(n){return!!n.h||!!n.g&&n.g.size>=n.j}function cu(n){return n.h?1:n.g?n.g.size:0}function fc(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function lu(n,e){n.g?n.g.add(e):n.h=e}function eh(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function th(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return La(n.i)}ou.prototype.cancel=function(){if(this.i=th(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var pc=class{stringify(n){return se.JSON.stringify(n,void 0)}parse(n){return se.JSON.parse(n,void 0)}};function nh(){this.g=new pc}function rh(n,e,t){const r=t||"";try{Po(n,function(i,s){let a=i;es(i)&&(a=Xa(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function mc(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Oo(n){this.l=n.ec||null,this.j=n.ob||!1}function gc(n,e){ft.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=uu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ht(Oo,gs),Oo.prototype.g=function(){return new gc(this.l,this.j)},Oo.prototype.i=function(n){return function(){return n}}({}),ht(gc,ft);var uu=0;function ih(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function Kr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,yn(n)}function yn(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(z=gc.prototype).open=function(n,e){if(this.readyState!=uu)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,yn(this)},z.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||se).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},z.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kr(this)),this.readyState=uu},z.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,yn(this)),this.g&&(this.readyState=3,yn(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof se.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ih(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},z.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Kr(this):yn(this),3==this.readyState&&ih(this)}},z.Za=function(n){this.g&&(this.response=this.responseText=n,Kr(this))},z.Ya=function(n){this.g&&(this.response=n,Kr(this))},z.ka=function(){this.g&&Kr(this)},z.setRequestHeader=function(n,e){this.v.append(n,e)},z.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},z.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(gc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var _c=se.JSON.parse;function Je(n){ft.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=du,this.L=this.M=!1}ht(Je,ft);var du="",sh=/^https?$/i,Xp=["POST","PUT"];function hu(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,No(n),Mo(n)}function No(n){n.F||(n.F=!0,ct(n,"complete"),ct(n,"error"))}function Vo(n){if(n.h&&typeof $e<"u"&&(!n.C[1]||4!=vn(n)||2!=n.da()))if(n.v&&4==vn(n))mr(n.La,0,n);else if(ct(n,"readystatechange"),4==vn(n)){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===a){var i=String(n.I).match(tu)[1]||null;!i&&se.self&&se.self.location&&(i=se.self.location.protocol.slice(0,-1)),r=!sh.test(i?i.toLowerCase():"")}t=r}if(t)ct(n,"complete"),ct(n,"success");else{n.m=6;try{var s=2<vn(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",No(n)}}finally{Mo(n)}}}function Mo(n,e){if(n.g){Ts(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||ct(n,"ready");try{t.onreadystatechange=r}catch{}}}function Ts(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(se.clearTimeout(n.A),n.A=null)}function vn(n){return n.g?n.g.readyState:0}function fu(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case du:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function pu(n){let e="";return $a(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function mu(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=pu(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Me(n,e,t))}function yr(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function ch(n){this.Ga=0,this.j=[],this.l=new ps,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=yr("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=yr("baseRetryDelayMs",5e3,n),this.hb=yr("retryDelaySeedMs",1e4,n),this.eb=yr("forwardChannelMaxRetries",2,n),this.xa=yr("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new ou(n&&n.concurrentRequestLimit),this.Ja=new nh,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Vn(n){if(gu(n),3==n.H){var e=n.W++,t=tr(n.I);if(Me(t,"SID",n.K),Me(t,"RID",e),Me(t,"TYPE","terminate"),Es(n,t),(e=new Gr(n,n.l,e)).L=2,e.A=Do(tr(t)),t=!1,se.navigator&&se.navigator.sendBeacon)try{t=se.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&se.Image&&((new Image).src=e.A,t=!0),t||(e.g=Iu(e.l,null),e.g.ha(e.A)),e.G=Date.now(),jr(e)}bi(n)}function Lo(n){n.g&&(yc(n),n.g.cancel(),n.g=null)}function gu(n){Lo(n),n.u&&(se.clearTimeout(n.u),n.u=null),ws(n),n.i.cancel(),n.m&&("number"==typeof n.m&&se.clearTimeout(n.m),n.m=null)}function vr(n){if(!au(n.i)&&!n.m){n.m=!0;var e=n.Na;Yt||ec(),Nn||(Yt(),Nn=!0),pr.add(e,n),n.C=0}}function nt(n,e){var t;t=e?e.m:n.W++;const r=tr(n.I);Me(r,"SID",n.K),Me(r,"RID",t),Me(r,"AID",n.V),Es(n,r),n.o&&n.s&&mu(r,n.o,n.s),t=new Gr(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Fo(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),lu(n.i,t),vs(t,r,e)}function Es(n,e){n.na&&$a(n.na,function(t,r){Me(e,r,t)}),n.h&&Po({},function(t,r){Me(e,r,t)})}function Fo(n,e,t){t=Math.min(n.j.length,t);var r=n.h?_e(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];-1==s?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let h=!0;for(let f=0;f<t;f++){let m=i[f].g;const g=i[f].map;if(m-=s,0>m)s=Math.max(0,i[f].g-100),h=!1;else try{rh(g,a,"req"+m+"_")}catch{r&&r(g)}}if(h){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function _u(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Yt||ec(),Nn||(Yt(),Nn=!0),pr.add(e,n),n.A=0}}function As(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=mi(_e(n.Ma,n),bs(n,n.A)),n.A++,0))}function yc(n){null!=n.B&&(se.clearTimeout(n.B),n.B=null)}function yu(n){n.g=new Gr(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=tr(n.wa);Me(e,"RID","rpc"),Me(e,"SID",n.K),Me(e,"AID",n.V),Me(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Me(e,"TO",n.qa),Me(e,"TYPE","xmlhttp"),Es(n,e),n.o&&n.s&&mu(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Do(tr(e)),t.u=null,t.S=!0,Ro(t,n)}function ws(n){null!=n.v&&(se.clearTimeout(n.v),n.v=null)}function vu(n,e){var t=null;if(n.g==e){ws(n),yc(n),n.g=null;var r=2}else{if(!fc(n.i,e))return;t=e.F,eh(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;ct(r=pi(),new Ao(r,t)),vr(n)}else _u(n);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function lh(n,e){return!(cu(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=mi(_e(n.Na,n,e),bs(n,n.C)),n.C++,0)))}(n,e)||2==r&&As(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Ir(n,5);break;case 4:Ir(n,10);break;case 3:Ir(n,6);break;default:Ir(n,2)}}function bs(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ir(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=_e(n.pb,n);t||(t=new er("//www.google.com/images/cleardot.gif"),se.location&&"http"==se.location.protocol||xo(t,"https"),Do(t)),function Yp(n,e){const t=new ps;if(se.Image){const r=new Image;r.onload=ns(mc,t,r,"TestLoadImage: loaded",!0,e),r.onerror=ns(mc,t,r,"TestLoadImage: error",!1,e),r.onabort=ns(mc,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=ns(mc,t,r,"TestLoadImage: timeout",!1,e),se.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Rt(2);n.H=0,n.h&&n.h.za(e),bi(n),gu(n)}function bi(n){if(n.H=0,n.ma=[],n.h){const e=th(n.i);(0!=e.length||0!=n.j.length)&&(Ul(n.ma,e),Ul(n.ma,n.j),n.i.i.length=0,La(n.j),n.j.length=0),n.h.ya()}}function Cs(n,e,t){var r=t instanceof er?tr(t):new er(t);if(""!=r.g)e&&(r.g=e+"."+r.g),Ei(r,r.m);else{var i=se.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new er(null);r&&xo(s,r),e&&(s.g=e),i&&Ei(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&Me(r,t,e),Me(r,"VER",n.ra),Es(n,r),r}function Iu(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Je(n.Ha&&!n.va?new Oo({ob:t}):n.va)).Oa(n.J),e}function Uo(){}function Rs(){if(ui&&!(10<=Number(Ga)))throw Error("Environmental error: no available transport.")}function Vt(n,e){ft.call(this),this.g=new ch(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Ur(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ur(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Wr(this)}function Tu(n){_s.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Bo(){sc.call(this),this.status=1}function Wr(n){this.g=n}function In(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Eu(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],a=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;a=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(a<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(e=t+((a=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function Re(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(z=Je.prototype).Oa=function(n){this.M=n},z.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ys.g(),this.C=function ic(n){return n.h||(n.h=n.i())}(this.u?this.u:ys),this.g.onreadystatechange=_e(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void hu(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=se.FormData&&n instanceof se.FormData,!(0<=Fl(Xp,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ts(this),0<this.B&&((this.L=function oh(n){return ui&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_e(this.ua,this)):this.A=mr(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){hu(this,s)}},z.ua=function(){typeof $e<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ct(this,"timeout"),this.abort(8))},z.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ct(this,"complete"),ct(this,"abort"),Mo(this))},z.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mo(this,!0)),Je.$.N.call(this)},z.La=function(){this.s||(this.G||this.v||this.l?Vo(this):this.kb())},z.kb=function(){Vo(this)},z.isActive=function(){return!!this.g},z.da=function(){try{return 2<vn(this)?this.g.status:-1}catch{return-1}},z.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},z.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),_c(e)}},z.Ia=function(){return this.m},z.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(z=ch.prototype).ra=8,z.H=1,z.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new Gr(this,this.l,n);let s=this.s;if(this.U&&(s?(s=$l(s),Kl(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Fo(this,i,e),Me(t=tr(this.I),"RID",n),Me(t,"CVER",22),this.F&&Me(t,"X-HTTP-Session-Id",this.F),Es(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(pu(s)))+"&"+e:this.o&&mu(t,this.o,s)),lu(this.i,i),this.bb&&Me(t,"TYPE","init"),this.P?(Me(t,"$req",e),Me(t,"SID","null"),i.aa=!0,vs(i,t,null)):vs(i,t,e),this.H=2}}else 3==this.H&&(n?nt(this,n):0==this.j.length||au(this.i)||nt(this))},z.Ma=function(){if(this.u=null,yu(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=mi(_e(this.jb,this),n)}},z.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Rt(10),Lo(this),yu(this))},z.ib=function(){null!=this.v&&(this.v=null,Lo(this),As(this),Rt(19))},z.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Rt(2)):(this.l.info("Failed to ping google.com"),Rt(1))},z.isActive=function(){return!!this.h&&this.h.isActive(this)},(z=Uo.prototype).Ba=function(){},z.Aa=function(){},z.za=function(){},z.ya=function(){},z.isActive=function(){return!0},z.Va=function(){},Rs.prototype.g=function(n,e){return new Vt(n,e)},ht(Vt,ft),Vt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Rt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=Cs(n,null,n.Y),vr(n)},Vt.prototype.close=function(){Vn(this.g)},Vt.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Xa(n),n=t);e.j.push(new su(e.fb++,n)),3==e.H&&vr(e)},Vt.prototype.N=function(){this.g.h=null,delete this.j,Vn(this.g),delete this.g,Vt.$.N.call(this)},ht(Tu,_s),ht(Bo,sc),ht(Wr,Uo),Wr.prototype.Ba=function(){ct(this.g,"a")},Wr.prototype.Aa=function(n){ct(this.g,new Tu(n))},Wr.prototype.za=function(n){ct(this.g,new Bo)},Wr.prototype.ya=function(){ct(this.g,"b")},ht(In,function uh(){this.blockSize=-1}),In.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},In.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)Eu(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){Eu(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){Eu(this,r),i=0;break}}this.h=i,this.i+=e},In.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var dh={};function vc(n){return-128<=n&&128>n?function Ua(n,e){var t=dh;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new Re([0|e],0>e?-1:0)}):new Re([0|n],0>n?-1:0)}function Mn(n){if(isNaN(n)||!isFinite(n))return nr;if(0>n)return It(Mn(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Ic;return new Re(e,0)}var Ic=4294967296,nr=vc(0),Tc=vc(1),wu=vc(16777216);function rr(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function zt(n){return-1==n.h}function It(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Re(t,~n.h).add(Tc)}function zo(n,e){return n.add(It(e))}function Go(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Ss(n,e){this.g=n,this.h=e}function jo(n,e){if(rr(e))throw Error("division by zero");if(rr(n))return new Ss(nr,nr);if(zt(n))return e=jo(It(n),e),new Ss(It(e.g),It(e.h));if(zt(e))return e=jo(n,It(e)),new Ss(It(e.g),e.h);if(30<n.g.length){if(zt(n)||zt(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Tc,r=e;0>=r.X(n);)t=Ec(t),r=Ec(r);var i=Ci(t,1),s=Ci(r,1);for(r=Ci(r,2),t=Ci(t,2);!rr(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=Ci(r,1),t=Ci(t,1)}return e=zo(n,i.R(e)),new Ss(i,e)}for(i=nr;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),a=(s=Mn(t)).R(e);zt(a)||0<a.X(n);)a=(s=Mn(t-=r)).R(e);rr(s)&&(s=Tc),i=i.add(s),n=zo(n,a)}return new Ss(i,n)}function Ec(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Re(t,n.h)}function Ci(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Re(i,n.h)}(z=Re.prototype).ea=function(){if(zt(this))return-It(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Ic+r)*e,e*=Ic}return n},z.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(rr(this))return"0";if(zt(this))return"-"+It(this).toString(n);for(var e=Mn(Math.pow(n,6)),t=this,r="";;){var i=jo(t,e).g,s=((0<(t=zo(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(rr(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},z.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},z.X=function(n){return zt(n=zo(this,n))?-1:rr(n)?0:1},z.abs=function(){return zt(this)?It(this):this},z.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,t[i]=(a&=65535)<<16|(s&=65535)}return new Re(t,-2147483648&t[t.length-1]?-1:0)},z.R=function(n){if(rr(this)||rr(n))return nr;if(zt(this))return zt(n)?It(this).R(It(n)):It(It(this).R(n));if(zt(n))return It(this.R(It(n)));if(0>this.X(wu)&&0>n.X(wu))return Mn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=65535&this.D(r),h=n.D(i)>>>16,f=65535&n.D(i);t[2*r+2*i]+=a*f,Go(t,2*r+2*i),t[2*r+2*i+1]+=s*f,Go(t,2*r+2*i+1),t[2*r+2*i+1]+=a*h,Go(t,2*r+2*i+1),t[2*r+2*i+2]+=s*h,Go(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Re(t,0)},z.gb=function(n){return jo(this,n).h},z.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Re(t,this.h&n.h)},z.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Re(t,this.h|n.h)},z.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Re(t,this.h^n.h)},Rs.prototype.createWebChannel=Rs.prototype.g,Vt.prototype.send=Vt.prototype.u,Vt.prototype.open=Vt.prototype.m,Vt.prototype.close=Vt.prototype.close,gi.NO_ERROR=0,gi.TIMEOUT=8,gi.HTTP_ERROR=6,ms.COMPLETE="complete",wo.EventType=_i,_i.OPEN="a",_i.CLOSE="b",_i.ERROR="c",_i.MESSAGE="d",ft.prototype.listen=ft.prototype.O,Je.prototype.listenOnce=Je.prototype.P,Je.prototype.getLastError=Je.prototype.Sa,Je.prototype.getLastErrorCode=Je.prototype.Ia,Je.prototype.getStatus=Je.prototype.da,Je.prototype.getResponseJson=Je.prototype.Wa,Je.prototype.getResponseText=Je.prototype.ja,Je.prototype.send=Je.prototype.ha,Je.prototype.setWithCredentials=Je.prototype.Oa,In.prototype.digest=In.prototype.l,In.prototype.reset=In.prototype.reset,In.prototype.update=In.prototype.j,Re.prototype.add=Re.prototype.add,Re.prototype.multiply=Re.prototype.R,Re.prototype.modulo=Re.prototype.gb,Re.prototype.compare=Re.prototype.X,Re.prototype.toNumber=Re.prototype.ea,Re.prototype.toString=Re.prototype.toString,Re.prototype.getBits=Re.prototype.D,Re.fromNumber=Mn,Re.fromString=function Au(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return It(Au(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Mn(Math.pow(e,8)),r=nr,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Mn(Math.pow(e,s)),r=r.R(s).add(Mn(a))):r=(r=r.R(t)).add(Mn(a))}return r};var hh=me.createWebChannelTransport=function(){return new Rs},fh=me.getStatEventTarget=function(){return pi()},Ps=me.ErrorCode=gi,ph=me.EventType=ms,Ac=me.Event=zr,bu=me.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},qo=(me.FetchXmlHttpFactory=Oo,me.WebChannel=wo),wc=me.XhrIo=Je,$o=me.Md5=In,Tr=me.Integer=Re;const Ru="@firebase/firestore";class ot{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ot.UNAUTHENTICATED=new ot(null),ot.GOOGLE_CREDENTIALS=new ot("google-credentials-uid"),ot.FIRST_PARTY=new ot("first-party-uid"),ot.MOCK_USER=new ot("mock-user");let Ln="10.7.0";const Gt=new Q.Vy("@firebase/firestore");function Er(){return Gt.logLevel}function M(n,...e){if(Gt.logLevel<=Q.$b.DEBUG){const t=e.map(Ko);Gt.debug(`Firestore (${Ln}): ${n}`,...t)}}function rt(n,...e){if(Gt.logLevel<=Q.$b.ERROR){const t=e.map(Ko);Gt.error(`Firestore (${Ln}): ${n}`,...t)}}function St(n,...e){if(Gt.logLevel<=Q.$b.WARN){const t=e.map(Ko);Gt.warn(`Firestore (${Ln}): ${n}`,...t)}}function Ko(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Z(n="Unexpected state"){const e=`FIRESTORE (${Ln}) INTERNAL ASSERTION FAILED: `+n;throw rt(e),new Error(e)}function te(n,e){n||Z()}function K(n,e){return n}const x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class V extends Y.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class it{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Wo{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gh{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ot.UNAUTHENTICATED))}shutdown(){}}class xs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _h{constructor(e){this.t=e,this.currentUser=ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let a=new it;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new it,e.enqueueRetryable(()=>s(this.currentUser))};const h=()=>{const m=a;e.enqueueRetryable((0,I.A)(function*(){yield m.promise,yield s(r.currentUser)}))},f=m=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new it)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te("string"==typeof r.accessToken),new Wo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return te(null===e||"string"==typeof e),new ot(e)}}class yh{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Cc{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new yh(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ho{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Rc{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{null!=s.error&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te("string"==typeof t.token),this.R=t.token,new Ho(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Sc(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Pc{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=Sc(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function de(n,e){return n<e?-1:n>e?1:0}function Ri(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Su(n){return n+"\0"}class Fe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Fe.fromMillis(Date.now())}static fromDate(e){return Fe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Fe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Fe(0,0))}static max(){return new ne(new Fe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ds{constructor(e,t,r){void 0===t?t=0:t>e.length&&Z(),void 0===r?r=e.length-t:r>e.length-t&&Z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Ds.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ds?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ae extends Ds{construct(e,t,r){return new Ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new V(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Ae(t)}static emptyPath(){return new Ae([])}}const vh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends Ds{construct(e,t,r){return new Ge(e,t,r)}static isValidIdentifier(e){return vh.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ge(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new V(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new V(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new V(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else"`"===h?(a=!a,i++):"."!==h||a?(r+=h,i++):(s(),i++)}if(s(),a)throw new V(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ge(t)}static emptyPath(){return new Ge([])}}class ${constructor(e){this.path=e}static fromPath(e){return new $(Ae.fromString(e))}static fromName(e){return new $(Ae.fromString(e).popFirst(5))}static empty(){return new $(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ae.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new Ae(e.slice()))}}class Si{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function ks(n){return n.fields.find(e=>2===e.kind)}function Fn(n){return n.fields.filter(e=>2!==e.kind)}Si.UNKNOWN_ID=-1;class Ar{constructor(e,t){this.fieldPath=e,this.kind=t}}class Pi{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Pi(0,jt.min())}}function kc(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ne.fromTimestamp(1e9===r?new Fe(t+1,0):new Fe(t,r));return new jt(i,$.empty(),e)}function Oc(n){return new jt(n.readTime,n.key,-1)}class jt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new jt(ne.min(),$.empty(),-1)}static max(){return new jt(ne.max(),$.empty(),-1)}}function Nc(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=$.comparator(n.documentKey,e.documentKey),0!==t?t:de(n.largestBatchId,e.largestBatchId))}const Vc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function wr(n){return Mc.apply(this,arguments)}function Mc(){return Mc=(0,I.A)(function*(n){if(n.code!==x.FAILED_PRECONDITION||n.message!==Vc)throw n;M("LocalStore","Unexpectedly lost primary lease")}),Mc.apply(this,arguments)}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(h=>{++i,h.next(()=>{++s,a&&s===i&&t()},f=>r(f))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let h=0;for(let f=0;f<s;f++){const m=f;t(e[m]).next(g=>{a[m]=g,++h,h===s&&r(a)},g=>i(g))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class xi{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new it,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Di(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Lc(r.target.error);this.V.reject(new Di(e,i))}}static open(e,t,r,i){try{return new xi(t,e.transaction(i,r))}catch(s){throw new Di(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(M("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Yo(t)}}class Tn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===Tn.S((0,Y.ZQ)())&&rt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return M("SimpleDb","Removing database:",e),Hr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,Y.zW)())return!1;if(Tn.C())return!0;const e=(0,Y.ZQ)(),t=Tn.S(e),r=0<t&&t<10,i=Tn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var t=this;return(0,I.A)(function*(){return t.db||(M("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=a=>{r(a.target.result)},s.onblocked=()=>{i(new Di(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const h=a.target.error;i("VersionError"===h.name?new V(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new V(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new Di(e,h))},s.onupgradeneeded=a=>{M("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',a.oldVersion),t.p.N(a.target.result,s.transaction,a.oldVersion,t.version).next(()=>{M("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,I.A)(function*(){const a="readonly"===t;let h=0;for(;;){++h;try{s.db=yield s.O(e);const f=xi.open(s.db,e,a?"readonly":"readwrite",r),m=i(f).next(g=>(f.g(),g)).catch(g=>(f.abort(g),R.reject(g))).toPromise();return m.catch(()=>{}),yield f.m,m}catch(f){const m=f,g="FirebaseError"!==m.name&&h<3;if(M("SimpleDb","Transaction failed with error:",m.message,"Retrying:",g),s.close(),!g)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ih{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Hr(this.k.delete())}}class Di extends V{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function br(n){return"IndexedDbTransactionError"===n.name}class Yo{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(M("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(M("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hr(r)}add(e){return M("SimpleDb","ADD",this.store.name,e,e),Hr(this.store.add(e))}get(e){return Hr(this.store.get(e)).next(t=>(void 0===t&&(t=null),M("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return M("SimpleDb","DELETE",this.store.name,e),Hr(this.store.delete(e))}count(){return M("SimpleDb","COUNT",this.store.name),Hr(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(a,h)=>{s.push(h)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=h=>{a(h.target.error)},i.onsuccess=h=>{s(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){M("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,h)=>h.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=Lc(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(h=>{h?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const h=a.target.result;if(!h)return void i();const f=new Ih(h),m=t(h.primaryKey,h.value,f);if(m instanceof R){const g=m.catch(y=>(f.done(),R.reject(y)));r.push(g)}f.isDone?i():null===f.$?h.continue():h.continue(f.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hr(n){return new R((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Lc(r.target.error);t(i)}})}let Pu=!1;function Lc(n){const e=Tn.S((0,Y.ZQ)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new V("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Pu||(Pu=!0,setTimeout(()=>{throw r},0)),r}}return n}class Th{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var t=this;M("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,I.A)(function*(){t.task=null;try{M("IndexBackiller",`Documents written: ${yield t.X.te()}`)}catch(r){br(r)?M("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield wr(r)}yield t.ee(6e4)}))}}class Eh{constructor(e,t){this.localStore=e,this.persistence=t}te(e=50){var t=this;return(0,I.A)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.ne(r,e))})()}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(null!==a&&!r.has(a))return M("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(h=>{i-=h,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(h=>(M("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=Oc(s);Nc(a,r)>0&&(r=a)}),new jt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Jt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}return n._e=-1,n})();function Os(n){return null==n}function Ns(n){return 0===n&&1/n==-1/0}function Xo(n){return"number"==typeof n&&Number.isInteger(n)&&!Ns(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Pt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xu(e)),e=Ah(n.get(t),e);return xu(e)}function Ah(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function xu(n){return n+"\x01\x01"}function Un(n){const e=n.length;if(te(e>=2),2===e)return te("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Ae.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("\x01",s);switch((a<0||a>t)&&Z(),n.charAt(a+1)){case"\x01":const h=n.substring(s,a);let f;0===i.length?f=h:(i+=h,f=i,i=""),r.push(f);break;case"\x10":i+=n.substring(s,a),i+="\0";break;case"\x11":i+=n.substring(s,a+1);break;default:Z()}s=a+2}return new Ae(r)}const Du=["userId","batchId"];function Vs(n,e){return[n,Pt(e)]}function ku(n,e,t){return[n,Pt(e),t]}const wh={},bh=["prefixPath","collectionGroup","readTime","documentId"],Ch=["prefixPath","collectionGroup","documentId"],Rh=["collectionGroup","readTime","prefixPath","documentId"],Fc=["canonicalId","targetId"],Uc=["targetId","path"],Sh=["path","targetId"],Bc=["collectionId","parent"],Ph=["indexId","uid"],Ou=["uid","sequenceNumber"],Nu=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zc=["indexId","uid","orderedDocumentKey"],xh=["userId","collectionPath","documentId"],Zp=["userId","collectionPath","largestBatchId"],Gc=["userId","collectionGroup","largestBatchId"],jc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Jo=[...jc,"documentOverlays"],qc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$c=qc,Dh=[...$c,"indexConfiguration","indexState","indexEntries"];class Kc extends Qo{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function pt(n,e){const t=K(n);return Tn.M(t.ae,e)}function Vu(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Cr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Wc(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ue{constructor(e,t){this.comparator=e,this.root=t||Qe.EMPTY}insert(e,t){return new Ue(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qe.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hc(this.root,e,this.comparator,!0)}}class Hc{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qe{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Qe.RED,this.left=i??Qe.EMPTY,this.right=s??Qe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Qe(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Qe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Qe.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Z();const e=this.left.check();if(e!==this.right.check())throw Z();return e+(this.isRed()?0:1)}}Qe.EMPTY=null,Qe.RED=!0,Qe.BLACK=!1,Qe.EMPTY=new class{constructor(){this.size=0}get key(){throw Z()}get value(){throw Z()}get color(){throw Z()}get left(){throw Z()}get right(){throw Z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Qe(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ve{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mu(this.data.getIterator())}getIteratorFrom(e){return new Mu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ve)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ve(this.comparator);return t.data=e,t}}class Mu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rr(n){return n.hasNext()?n.getNext():void 0}class qt{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new qt([])}unionWith(e){let t=new Ve(Ge.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new qt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ri(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Zo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zo("Invalid base64 string: "+s):s}}(e);return new lt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new lt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lt.EMPTY_BYTE_STRING=new lt("");const Qc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sr(n){if(te(!!n),"string"==typeof n){let e=0;const t=Qc.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ze(n.seconds),nanos:Ze(n.nanos)}}function Ze(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function En(n){return"string"==typeof n?lt.fromBase64String(n):lt.fromUint8Array(n)}function ea(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ta(n){const e=n.mapValue.fields.__previous_value__;return ea(e)?ta(e):e}function Ms(n){const e=Sr(n.mapValue.fields.__local_write_time__.timestampValue);return new Fe(e.seconds,e.nanos)}class Oh{constructor(e,t,r,i,s,a,h,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m}}class Pr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Pr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Pr&&e.projectId===this.projectId&&e.database===this.database}}const ir={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ki={nullValue:"NULL_VALUE"};function xr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ea(n)?4:Mi(n)?9007199254740991:10:Z()}function Bn(n,e){if(n===e)return!0;const t=xr(n);if(t!==xr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ms(n).isEqual(Ms(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Sr(i.timestampValue),h=Sr(s.timestampValue);return a.seconds===h.seconds&&a.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,En(n.bytesValue).isEqual(En(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ze(i.geoPointValue.latitude)===Ze(s.geoPointValue.latitude)&&Ze(i.geoPointValue.longitude)===Ze(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ze(i.integerValue)===Ze(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Ze(i.doubleValue),h=Ze(s.doubleValue);return a===h?Ns(a)===Ns(h):isNaN(a)&&isNaN(h)}return!1}(n,e);case 9:return Ri(n.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:return function(i,s){const a=i.mapValue.fields||{},h=s.mapValue.fields||{};if(Vu(a)!==Vu(h))return!1;for(const f in a)if(a.hasOwnProperty(f)&&(void 0===h[f]||!Bn(a[f],h[f])))return!1;return!0}(n,e);default:return Z()}var s}function Qr(n,e){return void 0!==(n.values||[]).find(t=>Bn(t,e))}function zn(n,e){if(n===e)return 0;const t=xr(n),r=xr(e);if(t!==r)return de(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return de(n.booleanValue,e.booleanValue);case 2:return function(s,a){const h=Ze(s.integerValue||s.doubleValue),f=Ze(a.integerValue||a.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(n,e);case 3:return Lu(n.timestampValue,e.timestampValue);case 4:return Lu(Ms(n),Ms(e));case 5:return de(n.stringValue,e.stringValue);case 6:return function(s,a){const h=En(s),f=En(a);return h.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const h=s.split("/"),f=a.split("/");for(let m=0;m<h.length&&m<f.length;m++){const g=de(h[m],f[m]);if(0!==g)return g}return de(h.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const h=de(Ze(s.latitude),Ze(a.latitude));return 0!==h?h:de(Ze(s.longitude),Ze(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const h=s.values||[],f=a.values||[];for(let m=0;m<h.length&&m<f.length;++m){const g=zn(h[m],f[m]);if(g)return g}return de(h.length,f.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===ir.mapValue&&a===ir.mapValue)return 0;if(s===ir.mapValue)return 1;if(a===ir.mapValue)return-1;const h=s.fields||{},f=Object.keys(h),m=a.fields||{},g=Object.keys(m);f.sort(),g.sort();for(let y=0;y<f.length&&y<g.length;++y){const w=de(f[y],g[y]);if(0!==w)return w;const S=zn(h[f[y]],m[g[y]]);if(0!==S)return S}return de(f.length,g.length)}(n.mapValue,e.mapValue);default:throw Z()}}function Lu(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return de(n,e);const t=Sr(n),r=Sr(e),i=de(t.seconds,r.seconds);return 0!==i?i:de(t.nanos,r.nanos)}function Oi(n){return Ni(n)}function Ni(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Sr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?En(n.bytesValue).toBase64():"referenceValue"in n?$.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Ni(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Ni(t.fields[a])}`;return i+"}"}(n.mapValue):Z()}function Yr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Yc(n){return!!n&&"integerValue"in n}function Vi(n){return!!n&&"arrayValue"in n}function Fu(n){return!!n&&"nullValue"in n}function Uu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ra(n){return!!n&&"mapValue"in n}function Ls(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Cr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ls(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ls(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Mi(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function Nh(n){return"nullValue"in n?ki:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Yr(Pr.empty(),$.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Z()}function Bu(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Yr(Pr.empty(),$.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?ir:Z()}function zu(n,e){const t=zn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Gu(n,e){const t=zn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Tt{constructor(e){this.value=e}static empty(){return new Tt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ra(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ls(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((a,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,i),r={},i=[],t=h.popLast()}a?r[h.lastSegment()]=Ls(a):i.push(h.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());ra(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ra(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Cr(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Tt(Ls(this.value))}}function ju(n){const e=[];return Cr(n.fields,(t,r)=>{const i=new Ge([t]);if(ra(r)){const s=ju(r.mapValue).fields;if(0===s.length)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new qt(e)}class Be{constructor(e,t,r,i,s,a,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=h}static newInvalidDocument(e){return new Be(e,0,ne.min(),ne.min(),ne.min(),Tt.empty(),0)}static newFoundDocument(e,t,r,i){return new Be(e,1,t,ne.min(),r,i,0)}static newNoDocument(e,t){return new Be(e,2,t,ne.min(),ne.min(),Tt.empty(),0)}static newUnknownDocument(e,t){return new Be(e,3,t,ne.min(),ne.min(),Tt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ne.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Gn{constructor(e,t){this.position=e,this.inclusive=t}}function ia(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(r=s.field.isKeyField()?$.comparator($.fromName(a.referenceValue),t.key):zn(a,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Xc(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Bn(n.position[t],e.position[t]))return!1;return!0}class Fs{constructor(e,t="asc"){this.field=e,this.dir=t}}function Jc(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class qu{}class le extends qu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Ku(e,t,r):"array-contains"===t?new Hu(e,r):"in"===t?new Mt(e,r):"not-in"===t?new nl(e,r):"array-contains-any"===t?new rl(e,r):new le(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Vh(e,r):new Mh(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(zn(t,this.value)):null!==t&&xr(this.value)===xr(t)&&this.matchesComparison(zn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Se extends qu{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Se(e,t)}matches(e){return Xr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Xr(n){return"and"===n.op}function Zc(n){return"or"===n.op}function Us(n){return sa(n)&&Xr(n)}function sa(n){for(const e of n.filters)if(e instanceof Se)return!1;return!0}function el(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+Oi(n.value);if(Us(n))return n.filters.map(e=>el(e)).join(",");{const e=n.filters.map(t=>el(t)).join(",");return`${n.op}(${e})`}}function tl(n,e){return n instanceof le?(r=n,(i=e)instanceof le&&r.op===i.op&&r.field.isEqual(i.field)&&Bn(r.value,i.value)):n instanceof Se?function(r,i){return i instanceof Se&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,a,h)=>s&&tl(a,i.filters[h]),!0)}(n,e):void Z();var r,i}function $u(n,e){const t=n.filters.concat(e);return Se.create(t,n.op)}function sr(n){return n instanceof le?`${(t=n).field.canonicalString()} ${t.op} ${Oi(t.value)}`:n instanceof Se?function(t){return t.op.toString()+" {"+t.getFilters().map(sr).join(" ,")+"}"}(n):"Filter";var t}class Ku extends le{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){const t=$.comparator(e.key,this.key);return this.matchesComparison(t)}}class Vh extends le{constructor(e,t){super(e,"in",t),this.keys=Wu(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Mh extends le{constructor(e,t){super(e,"not-in",t),this.keys=Wu(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Wu(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}class Hu extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vi(t)&&Qr(t.arrayValue,this.value)}}class Mt extends le{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Qr(this.value.arrayValue,t)}}class nl extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Qr(this.value.arrayValue,t)}}class rl extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Qr(this.value.arrayValue,r))}}class Lh{constructor(e,t=null,r=[],i=[],s=null,a=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=h,this.ce=null}}function An(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Lh(n,e,t,r,i,s,a)}function wn(n){const e=K(n);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>el(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Os(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Oi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Oi(r)).join(",")),e.ce=t}return e.ce}function Li(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Jc(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tl(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Xc(n.startAt,e.startAt)&&Xc(n.endAt,e.endAt)}function Bs(n){return $.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function oa(n,e){return n.filters.filter(t=>t instanceof le&&t.field.isEqual(e))}function aa(n,e,t){let r=ki,i=!0;for(const s of oa(n,e)){let a=ki,h=!0;switch(s.op){case"<":case"<=":a=Nh(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,h=!1;break;case"!=":case"not-in":a=ki}zu({value:r,inclusive:i},{value:a,inclusive:h})<0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];zu({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}function Qu(n,e,t){let r=ir,i=!0;for(const s of oa(n,e)){let a=ir,h=!0;switch(s.op){case">=":case">":a=Bu(s.value),h=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,h=!1;break;case"!=":case"not-in":a=ir}Gu({value:r,inclusive:i},{value:a,inclusive:h})>0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Gu({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}class or{constructor(e,t=null,r=[],i=[],s=null,a="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=h,this.endAt=f,this.le=null,this.he=null,this.Pe=null}}function Yu(n,e,t,r,i,s,a,h){return new or(n,e,t,r,i,s,a,h)}function Fi(n){return new or(n)}function l(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function o(n){return null!==n.collectionGroup}function c(n){const e=K(n);if(null===e.le){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let h=new Ve(Ge.comparator);return a.filters.forEach(f=>{f.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Fs(s,r))}),t.has(Ge.keyField().canonicalString())||e.le.push(new Fs(Ge.keyField(),r))}return e.le}function d(n){const e=K(n);return e.he||(e.he=function p(n,e){if("F"===n.limitType)return An(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new Fs(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new Gn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Gn(n.startAt.position,n.startAt.inclusive):null;return An(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,c(n))),e.he}function _(n,e){const t=n.filters.concat([e]);return new or(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function T(n,e,t){return new or(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function C(n,e){return Li(d(n),d(e))&&n.limitType===e.limitType}function k(n){return`${wn(d(n))}|lt:${n.limitType}`}function q(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>sr(i)).join(", ")}]`),Os(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(a=i).field.canonicalString()} (${a.dir})`;var a}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Oi(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Oi(i)).join(",")),`Target(${r})`}(d(n))}; limitType=${n.limitType})`}function J(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of c(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(a,h,f){const m=ia(a,h,f);return a.inclusive?m<=0:m<0}(r.startAt,c(r),i)||r.endAt&&!function(a,h,f){const m=ia(a,h,f);return a.inclusive?m>=0:m>0}(r.endAt,c(r),i)));var r,i}function ee(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ke(n){return(e,t)=>{let r=!1;for(const i of c(n)){const s=bn(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function bn(n,e,t){const r=n.field.isKeyField()?$.comparator(e.key,t.key):function(s,a,h){const f=a.data.field(s),m=h.data.field(s);return null!==f&&null!==m?zn(f,m):Z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Z()}}class cn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Cr(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Wc(this.inner)}size(){return this.innerSize}}const Xu=new Ue($.comparator);function xt(){return Xu}const il=new Ue($.comparator);function Ui(...n){let e=il;for(const t of n)e=e.insert(t.key,t);return e}function ca(n){let e=il;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Cn(){return Jr()}function sl(){return Jr()}function Jr(){return new cn(n=>n.toString(),(n,e)=>n.isEqual(e))}const Ju=new Ue($.comparator),Fh=new Ve($.comparator);function pe(...n){let e=Fh;for(const t of n)e=e.add(t);return e}const Uh=new Ve(de);function Bh(){return Uh}function em(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ns(e)?"-0":e}}function tm(n){return{integerValue:""+n}}function nm(n,e){return Xo(e)?tm(e):em(n,e)}class Zu{constructor(){this._=void 0}}function ey(n,e,t){return n instanceof la?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ea(s)&&(s=ta(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof zs?im(n,e):n instanceof Gs?sm(n,e):function(i,s){const a=rm(i,s),h=om(a)+om(i.Ie);return Yc(a)&&Yc(i.Ie)?tm(h):em(i.serializer,h)}(n,e)}function ty(n,e,t){return n instanceof zs?im(n,e):n instanceof Gs?sm(n,e):t}function rm(n,e){return n instanceof ua?Yc(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class la extends Zu{}class zs extends Zu{constructor(e){super(),this.elements=e}}function im(n,e){const t=am(e);for(const r of n.elements)t.some(i=>Bn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Gs extends Zu{constructor(e){super(),this.elements=e}}function sm(n,e){let t=am(e);for(const r of n.elements)t=t.filter(i=>!Bn(i,r));return{arrayValue:{values:t}}}class ua extends Zu{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function om(n){return Ze(n.integerValue||n.doubleValue)}function am(n){return Vi(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ol{constructor(e,t){this.field=e,this.transform=t}}class ry{constructor(e,t){this.version=e,this.transformResults=t}}class et{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new et}static exists(e){return new et(void 0,e)}static updateTime(e){return new et(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ed(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class td{}function cm(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new ha(n.key,et.none()):new da(n.key,n.data,et.none());{const t=n.data,r=Tt.empty();let i=new Ve(Ge.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);null===a&&s.length>1&&(s=s.popLast(),a=t.field(s)),null===a?r.delete(s):r.set(s,a),i=i.add(s)}return new Zr(n.key,r,new qt(i.toArray()),et.none())}}function iy(n,e,t){n instanceof da?function(i,s,a){const h=i.value.clone(),f=dm(i.fieldTransforms,s,a.transformResults);h.setAll(f),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):n instanceof Zr?function(i,s,a){if(!ed(i.precondition,s))return void s.convertToUnknownDocument(a.version);const h=dm(i.fieldTransforms,s,a.transformResults),f=s.data;f.setAll(um(i)),f.setAll(h),s.convertToFoundDocument(a.version,f).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function al(n,e,t,r){return n instanceof da?function(s,a,h,f){if(!ed(s.precondition,a))return h;const m=s.value.clone(),g=hm(s.fieldTransforms,f,a);return m.setAll(g),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Zr?function(s,a,h,f){if(!ed(s.precondition,a))return h;const m=hm(s.fieldTransforms,f,a),g=a.data;return g.setAll(um(s)),g.setAll(m),a.convertToFoundDocument(a.version,g).setHasLocalMutations(),null===h?null:h.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(n,e,t,r):(h=t,ed(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):h);var a,h}function sy(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=rm(r.transform,i||null);null!=s&&(null===t&&(t=Tt.empty()),t.set(r.field,s))}return t||null}function lm(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&Ri(r,i,(s,a)=>function ny(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof zs&&i instanceof zs||r instanceof Gs&&i instanceof Gs?Ri(r.elements,i.elements,Bn):r instanceof ua&&i instanceof ua?Bn(r.Ie,i.Ie):r instanceof la&&i instanceof la);var r,i}(s,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class da extends td{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zr extends td{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function um(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function dm(n,e,t){const r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,h=e.data.field(s.field);r.set(s.field,ty(a,h,t[i]))}return r}function hm(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,ey(s,a,e))}return r}class ha extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zh extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gh{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&iy(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=al(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=al(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sl();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let h=this.applyToLocalView(a,s.mutatedFields);h=t.has(i.key)?null:h;const f=cm(a,h);null!==f&&r.set(i.key,f),a.isValidDocument()||a.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pe())}isEqual(e){return this.batchId===e.batchId&&Ri(this.mutations,e.mutations,(t,r)=>lm(t,r))&&Ri(this.baseMutations,e.baseMutations,(t,r)=>lm(t,r))}}class jh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return Ju}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new jh(e,t,r,i)}}class qh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ay{constructor(e,t){this.count=e,this.unchangedNames=t}}var mt,xe;function fm(n){switch(n){default:return Z();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function pm(n){if(void 0===n)return rt("GRPC error has no .code"),x.UNKNOWN;switch(n){case mt.OK:return x.OK;case mt.CANCELLED:return x.CANCELLED;case mt.UNKNOWN:return x.UNKNOWN;case mt.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case mt.INTERNAL:return x.INTERNAL;case mt.UNAVAILABLE:return x.UNAVAILABLE;case mt.UNAUTHENTICATED:return x.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case mt.NOT_FOUND:return x.NOT_FOUND;case mt.ALREADY_EXISTS:return x.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return x.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case mt.ABORTED:return x.ABORTED;case mt.OUT_OF_RANGE:return x.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return x.UNIMPLEMENTED;case mt.DATA_LOSS:return x.DATA_LOSS;default:return Z()}}(xe=mt||(mt={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";function mm(){return new TextEncoder}const cy=new Tr([4294967295,4294967295],0);function gm(n){const e=mm().encode(n),t=new $o;return t.update(e),new Uint8Array(t.digest())}function _m(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Tr([t,r],0),new Tr([i,s],0)]}class $h{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cl(`Invalid padding: ${t}`);if(r<0)throw new cl(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new cl(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new cl(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Tr.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Tr.fromNumber(r)));return 1===i.compare(cy)&&(i=new Tr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=gm(e),[r,i]=_m(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new $h(s,i,t);return r.forEach(h=>a.insert(h)),a}insert(e){if(0===this.Te)return;const t=gm(e),[r,i]=_m(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class cl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ll{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,ul.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ll(ne.min(),i,new Ue(de),xt(),pe())}}class ul{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ul(r,t,pe(),pe(),pe())}}class rd{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class ym{constructor(e,t){this.targetId=e,this.fe=t}}class vm{constructor(e,t,r=lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Im{constructor(){this.ge=0,this.pe=Em(),this.ye=lt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=pe(),t=pe(),r=pe();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Z()}}),new ul(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=Em()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,te(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class ly{constructor(e){this.Le=e,this.ke=new Map,this.qe=xt(),this.Qe=Tm(),this.Ke=new Ue(de)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:Z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(Bs(s))if(0===r){const a=new $(s.path);this.We(t,a,Be.newNoDocument(a,ne.min()))}else te(1===r);else{const a=this.Ze(t);if(a!==r){const h=this.Xe(e),f=h?this.et(h,e,a):1;0!==f&&(this.He(t),this.Ke=this.Ke.insert(t,2===f?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,h;try{a=En(r).toUint8Array()}catch(f){if(f instanceof Zo)return St("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new $h(a,i,s)}catch(f){return St(f instanceof cl?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return 0===h.Te?null:h}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),h=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(h)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const h=this.Ye(a);if(h){if(s.current&&Bs(h.target)){const f=new $(h.target.path);null!==this.qe.get(f)||this.st(a,f)||this.We(a,f,Be.newNoDocument(f,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=pe();this.Qe.forEach((s,a)=>{let h=!0;a.forEachWhile(f=>{const m=this.Ye(f);return!m||"TargetPurposeLimboResolution"===m.purpose||(h=!1,!1)}),h&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new ll(e,t,this.Ke,this.qe,r);return this.qe=xt(),this.Qe=Tm(),this.Ke=new Ue(de),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Im,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Ve(de),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||M("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Im),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Tm(){return new Ue($.comparator)}function Em(){return new Ue($.comparator)}const uy={asc:"ASCENDING",desc:"DESCENDING"},dy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hy={and:"AND",or:"OR"};class fy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Kh(n,e){return n.useProto3Json||Os(e)?e:{value:e}}function fa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Am(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function py(n,e){return fa(n,e.toTimestamp())}function ut(n){return te(!!n),ne.fromTimestamp(function(t){const r=Sr(t);return new Fe(r.seconds,r.nanos)}(n))}function Wh(n,e){return(r=n,new Ae(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function wm(n){const e=Ae.fromString(n);return te(Om(e)),e}function dl(n,e){return Wh(n.databaseId,e.path)}function Dr(n,e){const t=wm(e);if(t.get(1)!==n.databaseId.projectId)throw new V(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new V(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(Cm(t))}function Hh(n,e){return Wh(n.databaseId,e)}function bm(n){const e=wm(n);return 4===e.length?Ae.emptyPath():Cm(e)}function hl(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cm(n){return te(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Rm(n,e,t){return{name:dl(n,e),fields:t.value.mapValue.fields}}function Sm(n,e,t){const r=Dr(n,e.name),i=ut(e.updateTime),s=e.createTime?ut(e.createTime):ne.min(),a=new Tt({mapValue:{fields:e.fields}}),h=Be.newFoundDocument(r,i,s,a);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function fl(n,e){let t;if(e instanceof da)t={update:Rm(n,e.key,e.value)};else if(e instanceof ha)t={delete:dl(n,e.key)};else if(e instanceof Zr)t={update:Rm(n,e.key,e.data),updateMask:Ey(e.fieldMask)};else{if(!(e instanceof zh))return Z();t={verify:dl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const h=a.transform;if(h instanceof la)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof zs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Gs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof ua)return{fieldPath:a.field.canonicalString(),increment:h.Ie};throw Z()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:py(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Z()),t;var s}function Qh(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?et.updateTime(ut(s.updateTime)):void 0!==s.exists?et.exists(s.exists):et.none():et.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,h){let f=null;"setToServerValue"in h?(te("REQUEST_TIME"===h.setToServerValue),f=new la):"appendMissingElements"in h?f=new zs(h.appendMissingElements.values||[]):"removeAllFromArray"in h?f=new Gs(h.removeAllFromArray.values||[]):"increment"in h?f=new ua(a,h.increment):Z();const m=Ge.fromServerFormat(h.fieldPath);return new ol(m,f)}(n,i)):[];var s;if(e.update){const i=Dr(n,e.update.name),s=new Tt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=new qt((e.updateMask.fieldPaths||[]).map(g=>Ge.fromServerFormat(g)));return new Zr(i,s,a,t,r)}return new da(i,s,t,r)}if(e.delete){const i=Dr(n,e.delete);return new ha(i,t)}if(e.verify){const i=Dr(n,e.verify);return new zh(i,t)}return Z()}function Pm(n,e){return{documents:[Hh(n,e.path)]}}function Yh(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Hh(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Hh(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(f){if(0!==f.length)return km(Se.create(f,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(f){if(0!==f.length)return f.map(m=>{return{field:Bi((y=m).field),direction:vy(y.dir)};var y})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Kh(n,e.limit);return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(f=e.startAt).inclusive,values:f.position}),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),t;var f}function xm(n){let e=bm(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){te(1===r);const g=t.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=function(y){const w=Dm(y);return w instanceof Se&&Us(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=t.orderBy.map(w=>{return new Fs(pa((U=w).field),function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(U.direction));var U}));let h=null;t.limit&&(h=function(y){let w;return w="object"==typeof y?y.value:y,Os(w)?null:w}(t.limit));let f=null;var y;t.startAt&&(f=new Gn((y=t.startAt).values||[],!!y.before));let m=null;return t.endAt&&(m=function(y){return new Gn(y.values||[],!y.before)}(t.endAt)),Yu(e,i,a,s,h,"F",f,m)}function Dm(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=pa(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pa(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pa(t.unaryFilter.field);return le.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=pa(t.unaryFilter.field);return le.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Z()}}(n):void 0!==n.fieldFilter?le.create(pa((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Z()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return Se.create(t.compositeFilter.filters.map(r=>Dm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Z()}}(t.compositeFilter.op))}(n):Z();var t}function vy(n){return uy[n]}function Iy(n){return dy[n]}function Ty(n){return hy[n]}function Bi(n){return{fieldPath:n.canonicalString()}}function pa(n){return Ge.fromServerFormat(n.fieldPath)}function km(n){return n instanceof le?function(t){if("=="===t.op){if(Uu(t.value))return{unaryFilter:{field:Bi(t.field),op:"IS_NAN"}};if(Fu(t.value))return{unaryFilter:{field:Bi(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Uu(t.value))return{unaryFilter:{field:Bi(t.field),op:"IS_NOT_NAN"}};if(Fu(t.value))return{unaryFilter:{field:Bi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bi(t.field),op:Iy(t.op),value:t.value}}}(n):n instanceof Se?function(t){const r=t.getFilters().map(i=>km(i));return 1===r.length?r[0]:{compositeFilter:{op:Ty(t.op),filters:r}}}(n):Z()}function Ey(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Om(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ei{constructor(e,t,r,i,s=ne.min(),a=ne.min(),h=lt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new ei(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ei(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ei(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ei(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Nm{constructor(e){this.ut=e}}function Vm(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:id(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:dl(s=n.ut,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:fa(s,a.version.toTimestamp()),createTime:fa(s,a.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:js(e.version)};else{if(!e.isUnknownDocument())return Z();r.unknownDocument={path:t.path.toArray(),version:js(e.version)}}var s,a;return r}function id(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function js(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function qs(n){const e=new Fe(n.seconds,n.nanoseconds);return ne.fromTimestamp(e)}function $s(n,e){const t=(e.baseMutations||[]).map(s=>Qh(n.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>Qh(n.ut,s)),i=Fe.fromMillis(e.localWriteTimeMs);return new Gh(e.batchId,i,t,r)}function pl(n){const e=qs(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?qs(n.lastLimboFreeSnapshotVersion):ne.min();let r;return r=void 0!==n.query.documents?(te(1===(s=n.query).documents.length),d(Fi(bm(s.documents[0])))):function(s){return d(xm(s))}(n.query),new ei(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,lt.fromBase64String(n.resumeToken));var s}function Mm(n,e){const t=js(e.snapshotVersion),r=js(e.lastLimboFreeSnapshotVersion);let i;i=Bs(e.target)?Pm(n.ut,e.target):Yh(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:wn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Xh(n){const e=xm({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?T(e,e.limit,"L"):e}function Jh(n,e){return new qh(e.largestBatchId,Qh(n.ut,e.overlayMutation))}function Lm(n,e){const t=e.path.lastSegment();return[n,Pt(e.path.popLast()),t]}function Fm(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:js(r.readTime),documentKey:Pt(r.documentKey.path),largestBatchId:r.largestBatchId}}class wy{getBundleMetadata(e,t){return Um(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:qs(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return Um(e).put({bundleId:(i=t).id,createTime:js(ut(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return Bm(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:Xh(s.bundledQuery),readTime:qs(s.readTime)};var s})}saveNamedQuery(e,t){return Bm(e).put({name:(i=t).name,readTime:js(ut(i.readTime)),bundledQuery:i.bundledQuery});var i}}function Um(n){return pt(n,"bundles")}function Bm(n){return pt(n,"namedQueries")}class sd{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){return new sd(e,t.uid||"")}getOverlay(e,t){return ml(e).get(Lm(this.userId,t)).next(r=>r?Jh(this.serializer,r):null)}getOverlays(e,t){const r=Cn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const h=new qh(t,a);i.push(this.lt(e,h))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(Pt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const h=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(ml(e).H("collectionPathOverlayIndex",h))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Cn(),s=Pt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ml(e).W("collectionPathOverlayIndex",a).next(h=>{for(const f of h){const m=Jh(this.serializer,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Cn();let a;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ml(e).Y({index:"collectionGroupOverlayIndex",range:h},(f,m,g)=>{const y=Jh(this.serializer,m);s.size()<i||y.largestBatchId===a?(s.set(y.getKey(),y),a=y.largestBatchId):g.done()}).next(()=>s)}lt(e,t){return ml(e).put(function(i,s,a){const[h,f,m]=Lm(s,a.mutation.key);return{userId:s,collectionPath:f,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:fl(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function ml(n){return pt(n,"documentOverlays")}class Ks{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Ze(e.integerValue));else if("doubleValue"in e){const r=Ze(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),Ns(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(En(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?Mi(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):Z()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),$.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function by(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function zm(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=by(255&r[s]);if(i+=a,8!==a)break}return i}(n);return Math.ceil(e/8)}Ks.St=new Ks;class Cy{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=zm(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=zm(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Ry{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Sy{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class gl{constructor(){this.Wt=new Cy,this.Gt=new Ry(this.Wt),this.zt=new Sy(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ws{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ws(this.indexId,this.documentKey,this.arrayValue,r)}}function zi(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Gm(n.arrayValue,e.arrayValue),0!==t?t:(t=Gm(n.directionalValue,e.directionalValue),0!==t?t:$.comparator(n.documentKey,e.documentKey)))}function Gm(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class jm{constructor(e){this.Jt=new Ve((t,r)=>Ge.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(te(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=ks(e);if(void 0!==t&&!this.tn(t))return!1;const r=Fn(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const h=this.Jt.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=r[s];if(!this.nn(h,f)||!this.rn(this.Yt[a++],f))return!1}++s}for(;s<r.length;++s)if(a>=this.Yt.length||!this.rn(this.Yt[a++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Ve(Ge.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Ar(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ar(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ar(r.field,"asc"===r.dir?0:1)));return new Si(Si.UNKNOWN_ID,this.collectionId,t,Pi.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function qm(n){var e,t;if(te(n instanceof le||n instanceof Se),n instanceof le){if(n instanceof Mt){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>le.create(n.field,"==",s)))||[];return Se.create(i,"or")}return n}const r=n.filters.map(i=>qm(i));return Se.create(r,n.op)}function Py(n){if(0===n.getFilters().length)return[];const e=tf(qm(n));return te($m(e)),Zh(e)||ef(e)?[e]:e.getFilters()}function Zh(n){return n instanceof le}function ef(n){return n instanceof Se&&Us(n)}function $m(n){return Zh(n)||ef(n)||function(t){if(t instanceof Se&&Zc(t)){for(const r of t.getFilters())if(!Zh(r)&&!ef(r))return!1;return!0}return!1}(n)}function tf(n){if(te(n instanceof le||n instanceof Se),n instanceof le)return n;if(1===n.filters.length)return tf(n.filters[0]);const e=n.filters.map(r=>tf(r));let t=Se.create(e,n.op);return t=od(t),$m(t)?t:(te(t instanceof Se),te(Xr(t)),te(t.filters.length>1),t.filters.reduce((r,i)=>nf(r,i)))}function nf(n,e){let t;return te(n instanceof le||n instanceof Se),te(e instanceof le||e instanceof Se),t=n instanceof le?e instanceof le?Se.create([n,e],"and"):Km(n,e):e instanceof le?Km(e,n):function(i,s){if(te(i.filters.length>0&&s.filters.length>0),Xr(i)&&Xr(s))return $u(i,s.getFilters());const a=Zc(i)?i:s,h=Zc(i)?s:i,f=a.filters.map(m=>nf(m,h));return Se.create(f,"or")}(n,e),od(t)}function Km(n,e){if(Xr(e))return $u(e,n.getFilters());{const t=e.filters.map(r=>nf(n,r));return Se.create(t,"or")}}function od(n){if(te(n instanceof le||n instanceof Se),n instanceof le)return n;const e=n.getFilters();if(1===e.length)return od(e[0]);if(sa(n))return n;const t=e.map(i=>od(i)),r=[];return t.forEach(i=>{i instanceof le?r.push(i):i instanceof Se&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Se.create(r,n.op)}class xy{constructor(){this.on=new rf}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(jt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(jt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class rf{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ve(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ve(Ae.comparator)).toArray()}}const ad=new Uint8Array(0);class Dy{constructor(e,t){this.user=e,this.databaseId=t,this._n=new rf,this.an=new cn(r=>wn(r),(r,i)=>Li(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:Pt(i)};return Wm(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Su(t),""],!1,!0);return Wm(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Un(a.parent))}return r})}addFieldIndex(e,t){const r=_l(e),i={indexId:(h=t).indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])};var h;delete i.indexId;const s=r.add(i);if(t.indexState){const a=ga(e);return s.next(h=>{a.put(Fm(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=_l(e),i=ga(e),s=ma(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=_l(e),r=ma(e),i=ga(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new jm(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=ma(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(h=>{i&&(i=!!h),s.set(a,h)})).next(()=>{if(i){let a=pe();const h=[];return R.forEach(s,(f,m)=>{var H;M("IndexedDbIndexManager",`Using index ${H=f,`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map(ue=>`${ue.fieldPath}:${ue.kind}`).join(",")}`} to execute ${wn(t)}`);const g=function(H,ue){const ye=ks(ue);if(void 0===ye)return null;for(const Oe of oa(H,ye.fieldPath))switch(Oe.op){case"array-contains-any":return Oe.value.arrayValue.values||[];case"array-contains":return[Oe.value]}return null}(m,f),y=function(H,ue){const ye=new Map;for(const Oe of Fn(ue))for(const dt of oa(H,Oe.fieldPath))switch(dt.op){case"==":case"in":ye.set(Oe.fieldPath.canonicalString(),dt.value);break;case"not-in":case"!=":return ye.set(Oe.fieldPath.canonicalString(),dt.value),Array.from(ye.values())}return null}(m,f),w=function(H,ue){const ye=[];let Oe=!0;for(const dt of Fn(ue)){const qn=0===dt.kind?aa(H,dt.fieldPath,H.startAt):Qu(H,dt.fieldPath,H.startAt);ye.push(qn.value),Oe&&(Oe=qn.inclusive)}return new Gn(ye,Oe)}(m,f),S=function(H,ue){const ye=[];let Oe=!0;for(const dt of Fn(ue)){const qn=0===dt.kind?Qu(H,dt.fieldPath,H.endAt):aa(H,dt.fieldPath,H.endAt);ye.push(qn.value),Oe&&(Oe=qn.inclusive)}return new Gn(ye,Oe)}(m,f),U=this.ln(f,m,w),G=this.ln(f,m,S),B=this.hn(f,m,y),ie=this.Pn(f.indexId,g,U,w.inclusive,G,S.inclusive,B);return R.forEach(ie,oe=>r.j(oe,t.limit).next(H=>{H.forEach(ue=>{const ye=$.fromSegments(ue.documentKey);a.has(ye)||(a=a.add(ye),h.push(ye))})}))}).next(()=>h)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:Py(Se.create(e.filters,"and")).map(r=>An(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,h){const f=(null!=t?t.length:1)*Math.max(r.length,s.length),m=f/(null!=t?t.length:1),g=[];for(let y=0;y<f;++y){const w=t?this.In(t[y/m]):ad,S=this.Tn(e,w,r[y%m],i),U=this.En(e,w,s[y%m],a),G=h.map(B=>this.Tn(e,w,B,!0));g.push(...this.createRange(S,U,G))}return g}Tn(e,t,r,i){const s=new Ws(e,$.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ws(e,$.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new jm(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const h of s)r.en(h)&&(!a||h.fields.length>a.fields.length)&&(a=h);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?0!==r&&a.fields.length<function(f){let m=new Ve(Ge.comparator),g=!1;for(const y of f.filters)for(const w of y.getFlattenedFilters())w.field.isKeyField()||("array-contains"===w.op||"array-contains-any"===w.op?g=!0:m=m.add(w.field));for(const y of f.orderBy)y.field.isKeyField()||(m=m.add(y.field));return m.size+(g?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}dn(e,t){const r=new gl;for(const i of Fn(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const a=r.jt(i.kind);Ks.St.ht(s,a)}return r.Ut()}In(e){const t=new gl;return Ks.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new gl;return Ks.St.ht(Yr(this.databaseId,t),r.jt(function(s){const a=Fn(s);return 0===a.length?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(null===r)return[];let i=[];i.push(new gl);let s=0;for(const a of Fn(e)){const h=r[s++];for(const f of i)if(this.Rn(t,a.fieldPath)&&Vi(h))i=this.Vn(i,a,h);else{const m=f.jt(a.kind);Ks.St.ht(h,m)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const h of i){const f=new gl;f.seed(h.Ut()),Ks.St.ht(a,f.jt(t.kind)),s.push(f)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof le&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=_l(e),i=ga(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,h=>i.get([h.indexId,this.uid]).next(f=>{a.push(function(g,y){const w=y?new Pi(y.sequenceNumber,new jt(qs(y.readTime),new $(Un(y.documentKey)),y.largestBatchId)):Pi.empty(),S=g.fields.map(([U,G])=>new Ar(Ge.fromServerFormat(U),G));return new Si(g.indexId,g.collectionGroup,S,w)}(h,f))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:de(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=_l(e),s=ga(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>R.forEach(h,f=>s.put(Fm(f.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),R.forEach(h,f=>this.gn(e,i,f).next(m=>{const g=this.pn(s,f);return m.isEqual(g)?R.resolve():this.yn(e,s,f,m,g)}))))})}wn(e,t,r,i){return ma(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return ma(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=ma(e);let s=new Ve(zi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,h)=>{s=s.add(new Ws(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>s)}pn(e,t){let r=new Ve(zi);const i=this.dn(t,e);if(null==i)return r;const s=ks(t);if(null!=s){const a=e.data.field(s.fieldPath);if(Vi(a))for(const h of a.arrayValue.values||[])r=r.add(new Ws(t.indexId,e.key,this.In(h),i))}else r=r.add(new Ws(t.indexId,e.key,ad,i));return r}yn(e,t,r,i,s){M("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(f,m,g,y,w){const S=f.getIterator(),U=m.getIterator();let G=Rr(S),B=Rr(U);for(;G||B;){let ie=!1,oe=!1;if(G&&B){const H=g(G,B);H<0?oe=!0:H>0&&(ie=!0)}else null!=G?oe=!0:ie=!0;ie?(y(B),B=Rr(U)):oe?(w(G),G=Rr(S)):(G=Rr(S),B=Rr(U))}}(i,s,zi,h=>{a.push(this.wn(e,t,r,h))},h=>{a.push(this.Sn(e,t,r,h))}),R.waitFor(a)}fn(e){let t=1;return ga(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,h)=>zi(a,h)).filter((a,h,f)=>!h||0!==zi(a,f[h-1]));const i=[];i.push(e);for(const a of r){const h=zi(a,e),f=zi(a,t);if(0===h)i[0]=e.Ht();else if(h>0&&f<0)i.push(a),i.push(a.Ht());else if(f>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];s.push(IDBKeyRange.bound([i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,ad,[]],[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,ad,[]]))}return s}bn(e,t){return zi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Hm)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||Z())).next(Hm)}}function Wm(n){return pt(n,"collectionParents")}function ma(n){return pt(n,"indexEntries")}function _l(n){return pt(n,"indexConfiguration")}function ga(n){return pt(n,"indexState")}function Hm(n){te(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Nc(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new jt(e.readTime,e.documentKey,t)}const Qm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class $t{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new $t(e,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Ym(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let h=0;const f=r.Y({range:a},(g,y,w)=>(h++,w.delete()));s.push(f.next(()=>{te(1===h)}));const m=[];for(const g of t.mutations){const y=ku(e,g.key.path,t.batchId);s.push(i.delete(y)),m.push(g.key)}return R.waitFor(s).next(()=>m)}function cd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Z();e=n.noDocument}return JSON.stringify(e).length}$t.DEFAULT_COLLECTION_PERCENTILE=10,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$t.DEFAULT=new $t(41943040,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$t.DISABLED=new $t(-1,0,0);class ld{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){te(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new ld(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=_a(e),a=Gi(e);return a.add({}).next(h=>{te("number"==typeof h);const f=new Gh(h,t,r,i),m=function(S,U,G){const B=G.baseMutations.map(oe=>fl(S.ut,oe)),ie=G.mutations.map(oe=>fl(S.ut,oe));return{userId:U,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:B,mutations:ie}}(this.serializer,this.userId,f),g=[];let y=new Ve((w,S)=>de(w.canonicalString(),S.canonicalString()));for(const w of i){const S=ku(this.userId,w.key.path,h);y=y.add(w.key.path.popLast()),g.push(a.put(m)),g.push(s.put(S,wh))}return y.forEach(w=>{g.push(this.indexManager.addToCollectionParentIndex(e,w))}),e.addOnCommittedListener(()=>{this.Dn[h]=f.keys()}),R.waitFor(g).next(()=>f)})}lookupMutationBatch(e,t){return Gi(e).get(t).next(r=>r?(te(r.userId===this.userId),$s(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Gi(e).Y({index:"userMutationsIndex",range:i},(a,h,f)=>{h.userId===this.userId&&(te(h.batchId>=r),s=$s(this.serializer,h)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Gi(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gi(e).W("userMutationsIndex",t).next(r=>r.map(i=>$s(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Vs(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return _a(e).Y({range:i},(a,h,f)=>{const[m,g,y]=a,w=Un(g);if(m===this.userId&&t.path.isEqual(w))return Gi(e).get(y).next(S=>{if(!S)throw Z();te(S.userId===this.userId),s.push($s(this.serializer,S))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(de);const i=[];return t.forEach(s=>{const a=Vs(this.userId,s.path),h=IDBKeyRange.lowerBound(a),f=_a(e).Y({range:h},(m,g,y)=>{const[w,S,U]=m,G=Un(S);w===this.userId&&s.path.isEqual(G)?r=r.add(U):y.done()});i.push(f)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Vs(this.userId,r),a=IDBKeyRange.lowerBound(s);let h=new Ve(de);return _a(e).Y({range:a},(f,m,g)=>{const[y,w,S]=f,U=Un(w);y===this.userId&&r.isPrefixOf(U)?U.length===i&&(h=h.add(S)):g.done()}).next(()=>this.vn(e,h))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Gi(e).get(s).next(a=>{if(null===a)throw Z();te(a.userId===this.userId),r.push($s(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Ym(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return _a(e).Y({range:r},(s,a,h)=>{if(s[0]===this.userId){const f=Un(s[1]);i.push(f)}else h.done()}).next(()=>{te(0===i.length)})})}containsKey(e,t){return Xm(e,this.userId,t)}Mn(e){return Jm(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Xm(n,e,t){const r=Vs(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return _a(n).Y({range:s,J:!0},(h,f,m)=>{const[g,y,w]=h;g===e&&y===i&&(a=!0),m.done()}).next(()=>a)}function Gi(n){return pt(n,"mutations")}function _a(n){return pt(n,"documentMutations")}function Jm(n){return pt(n,"mutationQueues")}class Hs{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Hs(0)}static Nn(){return new Hs(-1)}}class ky{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Hs(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>ne.fromTimestamp(new Fe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ya(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(te(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return ya(e).Y((a,h)=>{const f=pl(h);f.sequenceNumber<=t&&null===r.get(f.targetId)&&(i++,s.push(this.removeTargetData(e,f)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return ya(e).Y((r,i)=>{const s=pl(i);t(s)})}Bn(e){return Zm(e).get("targetGlobalKey").next(t=>(te(null!==t),t))}Ln(e,t){return Zm(e).put("targetGlobalKey",t)}kn(e,t){return ya(e).put(Mm(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=wn(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ya(e).Y({range:i,index:"queryTargetsIndex"},(a,h,f)=>{const m=pl(h);Li(t,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=ji(e);return t.forEach(a=>{const h=Pt(a.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=ji(e);return R.forEach(t,s=>{const a=Pt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=ji(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=ji(e);let s=pe();return i.Y({range:r,J:!0},(a,h,f)=>{const m=Un(a[1]),g=new $(m);s=s.add(g)}).next(()=>s)}containsKey(e,t){const r=Pt(t.path),i=IDBKeyRange.bound([r],[Su(r)],!1,!0);let s=0;return ji(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,h],f,m)=>{0!==a&&(s++,m.done())}).next(()=>s>0)}_t(e,t){return ya(e).get(t).next(r=>r?pl(r):null)}}function ya(n){return pt(n,"targets")}function Zm(n){return pt(n,"targetGlobal")}function ji(n){return pt(n,"targetDocuments")}function eg([n,e],[t,r]){const i=de(n,t);return 0===i?de(e,r):i}class Oy{constructor(e){this.Qn=e,this.buffer=new Ve(eg),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();eg(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class tg{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var t=this;M("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,I.A)(function*(){t.Wn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){br(r)?M("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield wr(r)}yield t.Gn(3e5)}))}}class Ny{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return R.resolve(Jt._e);const r=new Oy(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Qm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qm):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,h,f,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,a=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,h=Date.now(),this.removeTargets(e,r,t))).next(y=>(s=y,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(m=Date.now(),Er()<=Q.$b.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-g}ms\n\tDetermined least recently used ${i} in `+(h-a)+`ms\n\tRemoved ${s} targets in `+(f-h)+`ms\n\tRemoved ${y} documents in `+(m-f)+`ms\nTotal Duration: ${m-g}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}}class Vy{constructor(e,t){this.db=e,this.garbageCollector=function ng(n,e){return new Ny(n,e)}(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return ud(e,r)}removeReference(e,t,r){return ud(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ud(e,t)}Xn(e,t){return function(i,s){let a=!1;return Jm(i).Z(h=>Xm(i,h,s).next(f=>(f&&(a=!0),R.resolve(!f)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,h)=>{if(h<=t){const f=this.Xn(e,a).next(m=>{if(!m)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,ne.min()),ji(e).delete([0,Pt(a.path)])))});i.push(f)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ud(e,t)}Zn(e,t){const r=ji(e);let i,s=Jt._e;return r.Y({index:"documentTargetsIndex"},([a,h],{path:f,sequenceNumber:m})=>{0===a?(s!==Jt._e&&t(new $(Un(i)),s),s=m,i=f):s=Jt._e}).next(()=>{s!==Jt._e&&t(new $(Un(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ud(n,e){return ji(n).put((i=n.currentSequenceNumber,{targetId:0,path:Pt(e.path),sequenceNumber:i}));var i}class rg{constructor(){this.changes=new cn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class My{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Qs(e).put(r)}removeEntry(e,t,r){return Qs(e).delete(function(s,a){const h=s.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],id(a),h[h.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=Be.newInvalidDocument(t);return Qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(yl(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:Be.newInvalidDocument(t)};return Qs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(yl(t))},(i,s)=>{r={document:this.tr(t,s),size:cd(s)}}).next(()=>r)}getEntries(e,t){let r=xt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=xt(),i=new Ue($.comparator);return this.rr(e,t,(s,a)=>{const h=this.tr(s,a);r=r.insert(s,h),i=i.insert(s,cd(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Ve(ag);t.forEach(f=>i=i.add(f));const s=IDBKeyRange.bound(yl(i.first()),yl(i.last())),a=i.getIterator();let h=a.getNext();return Qs(e).Y({index:"documentKeyIndex",range:s},(f,m,g)=>{const y=$.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&ag(h,y)<0;)r(h,null),h=a.getNext();h&&h.isEqual(y)&&(r(h,m),h=a.hasNext()?a.getNext():null),h?g.U(yl(h)):g.done()}).next(()=>{for(;h;)r(h,null),h=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,h=[a.popLast().toArray(),a.lastSegment(),id(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qs(e).W(IDBKeyRange.bound(h,f,!0)).next(m=>{s?.incrementDocumentReadCount(m.length);let g=xt();for(const y of m){const w=this.tr($.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);w.isFoundDocument()&&(J(t,w)||i.has(w.key))&&(g=g.insert(w.key,w))}return g})}getAllFromCollectionGroup(e,t,r,i){let s=xt();const a=og(t,r),h=og(t,jt.max());return Qs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,h,!0)},(f,m,g)=>{const y=this.tr($.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(y.key,y),s.size===i&&g.done()}).next(()=>s)}newChangeBuffer(e){return new Ly(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return sg(e).get("remoteDocumentGlobalKey").next(t=>(te(!!t),t))}er(e,t){return sg(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=function Ay(n,e){let t;if(e.document)t=Sm(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=$.fromSegments(e.noDocument.path),i=qs(e.noDocument.readTime);t=Be.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Z();{const r=$.fromSegments(e.unknownDocument.path),i=qs(e.unknownDocument.version);t=Be.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Fe(i[0],i[1]);return ne.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(ne.min()))return r}return Be.newInvalidDocument(e)}}function ig(n){return new My(n)}class Ly extends rg{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new cn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Ve((s,a)=>de(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const h=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,h.readTime)),a.isValidDocument()){const f=Vm(this._r.serializer,a);i=i.add(s.path.popLast());const m=cd(f);r+=m-h.size,t.push(this._r.addEntry(e,s,f))}else if(r-=h.size,this.trackRemovals){const f=Vm(this._r.serializer,a.convertToNoDocument(ne.min()));t.push(this._r.addEntry(e,s,f))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function sg(n){return pt(n,"remoteDocumentGlobal")}function Qs(n){return pt(n,"remoteDocumentsV14")}function yl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function og(n,e){const t=e.documentKey.path.toArray();return[n,id(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ag(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=de(t[s],r[s]),i)return i;return i=de(t.length,r.length),i||(i=de(t[t.length-2],r[r.length-2]),i||de(t[t.length-1],r[r.length-1]))}class Fy{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cg{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&al(r.mutation,i,qt.empty(),Fe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pe()){const i=Cn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Ui();return s.forEach((h,f)=>{a=a.insert(h,f.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Cn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pe()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,h)=>{t.set(a,h)})})}computeViews(e,t,r,i){let s=xt();const a=Jr(),h=Jr();return t.forEach((f,m)=>{const g=r.get(m.key);i.has(m.key)&&(void 0===g||g.mutation instanceof Zr)?s=s.insert(m.key,m):void 0!==g?(a.set(m.key,g.mutation.getFieldMask()),al(g.mutation,m,g.mutation.getFieldMask(),Fe.now())):a.set(m.key,qt.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,g)=>a.set(m,g)),t.forEach((m,g)=>{var y;return h.set(m,new Fy(g,null!==(y=a.get(m))&&void 0!==y?y:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Jr();let i=new Ue((a,h)=>a-h),s=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const h of a)h.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let g=r.get(f)||qt.empty();g=h.applyToLocalView(m,g),r.set(f,g);const y=(i.get(h.batchId)||pe()).add(f);i=i.insert(h.batchId,y)})}).next(()=>{const a=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,g=f.value,y=sl();g.forEach(w=>{if(!s.has(w)){const S=cm(t.get(w),r.get(w));null!==S&&y.set(w,S),s=s.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,y))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return $.isDocumentKey((a=t).path)&&null===a.collectionGroup&&0===a.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):o(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var a}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Cn());let h=-1,f=s;return a.next(m=>R.forEach(m,(g,y)=>(h<y.largestBatchId&&(h=y.largestBatchId),s.get(g)?R.resolve():this.remoteDocumentCache.getEntry(e,g).next(w=>{f=f.insert(g,w)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,pe())).next(g=>({batchId:h,changes:ca(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=Ui();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=Ui();return this.indexManager.getCollectionParents(e,s).next(h=>R.forEach(h,f=>{const m=(y=t,w=f.child(s),new or(w,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt));var y,w;return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(g=>{g.forEach((y,w)=>{a=a.insert(y,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((f,m)=>{const g=m.getKey();null===a.get(g)&&(a=a.insert(g,Be.newInvalidDocument(g)))});let h=Ui();return a.forEach((f,m)=>{const g=s.get(f);void 0!==g&&al(g.mutation,m,qt.empty(),Fe.now()),J(t,m)&&(h=h.insert(f,m))}),h})}}class Uy{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,{id:(i=t).id,version:i.version,createTime:ut(i.createTime)}),R.resolve();var i}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,{name:(i=t).name,query:Xh(i.bundledQuery),readTime:ut(i.readTime)}),R.resolve();var i}}class By{constructor(){this.overlays=new Ue($.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Cn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Cn(),s=t.length+1,a=new $(t.child("")),h=this.overlays.getIteratorFrom(a);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>r&&i.set(f.getKey(),f)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ue((m,g)=>m-g);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=s.get(m.largestBatchId);null===g&&(g=Cn(),s=s.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const h=Cn(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,g)=>h.set(m,g)),!(h.size()>=i)););return R.resolve(h)}lt(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new qh(t,r));let s=this.lr.get(t);void 0===s&&(s=pe(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class sf{constructor(){this.hr=new Ve(Dt.Pr),this.Ir=new Ve(Dt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new Dt(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new Dt(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new $(new Ae([])),r=new Dt(t,e),i=new Dt(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new $(new Ae([])),r=new Dt(t,e),i=new Dt(t,e+1);let s=pe();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Dt(e,0),r=this.hr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Dt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return $.comparator(e.key,t.key)||de(e.gr,t.gr)}static Tr(e,t){return de(e.gr,t.gr)||$.comparator(e.key,t.key)}}class zy{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Ve(Dt.Pr)}checkEmpty(e){return R.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++;const a=new Gh(s,t,r,i);this.mutationQueue.push(a);for(const h of i)this.yr=this.yr.add(new Dt(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.Sr(t+1),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Dt(t,0),i=new Dt(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const h=this.wr(a.gr);s.push(h)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(de);return t.forEach(i=>{const s=new Dt(i,0),a=new Dt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],h=>{r=r.add(h.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;$.isDocumentKey(s)||(s=s.child(""));const a=new Dt(new $(s),0);let h=new Ve(de);return this.yr.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.gr)),!0)},a),R.resolve(this.br(h))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){te(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new Dt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new Dt(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Gy{constructor(e){this.Cr=e,this.docs=new Ue($.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(t))}getEntries(e,t){let r=xt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Be.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=xt();const a=t.path,h=new $(a.child("")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:g}}=f.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||Nc(Oc(g),r)<=0||(i.has(g.key)||J(t,g))&&(s=s.insert(g.key,g.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Z()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new jy(this)}getSize(e){return R.resolve(this.size)}}class jy extends rg{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class qy{constructor(e){this.persistence=e,this.Fr=new cn(t=>wn(t),Li),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Mr=0,this.Or=new sf,this.targetCount=0,this.Nr=Hs.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Hs(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class of{constructor(e,t){this.Br={},this.overlays={},this.Lr=new Jt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new qy(this),this.indexManager=new xy,this.remoteDocumentCache=new Gy(r=>this.referenceDelegate.Qr(r)),this.serializer=new Nm(t),this.Kr=new Uy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new By,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new zy(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const i=new $y(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class $y extends Qo{constructor(e){super(),this.currentSequenceNumber=e}}class dd{constructor(e){this.persistence=e,this.Gr=new sf,this.zr=null}static jr(e){return new dd(e)}get Hr(){if(this.zr)return this.zr;throw Z()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=$.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,ne.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class Ky{constructor(e){this.serializer=e}N(e,t,r,i){const s=new xi("createOrUpgrade",t);var f;r<1&&i>=1&&(e.createObjectStore("owner"),(f=e).createObjectStore("mutationQueues",{keyPath:"userId"}),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Du,{unique:!0}),f.createObjectStore("documentMutations"),lg(e),function(f){f.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(0!==r&&(function(f){f.deleteObjectStore("targetDocuments"),f.deleteObjectStore("targets"),f.deleteObjectStore("targetGlobal")}(e),lg(e)),a=a.next(()=>function(f){const m=f.store("targetGlobal"),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ne.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",g)}(s))),r<4&&i>=4&&(0!==r&&(a=a.next(()=>function(f,m){return m.store("mutations").W().next(g=>{f.deleteObjectStore("mutations"),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Du,{unique:!0});const y=m.store("mutations"),w=g.map(S=>y.put(S));return R.waitFor(w)})}(e,s))),a=a.next(()=>{!function(f){f.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(f){f.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{!function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(f){f.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(f){f.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{!function(f){const m=f.createObjectStore("documentOverlays",{keyPath:xh});m.createIndex("collectionPathOverlayIndex",Zp,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",Gc,{unique:!1})}(e)})),r<13&&i>=13&&(a=a.next(()=>function(f){const m=f.createObjectStore("remoteDocumentsV14",{keyPath:bh});m.createIndex("documentKeyIndex",Ch),m.createIndex("collectionGroupIndex",Rh)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(f){f.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),f.createObjectStore("indexState",{keyPath:Ph}).createIndex("sequenceNumberIndex",Ou,{unique:!1}),f.createObjectStore("indexEntries",{keyPath:Nu}).createIndex("documentKeyIndex",zc,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=cd(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(h=>R.forEach(h,f=>{te(f.userId===s.userId);const m=$s(this.serializer,f);return Ym(e,s.userId,m).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,h)=>{const f=new Ae(a),m=[0,Pt(f)];s.push(t.get(m).next(g=>g?R.resolve():t.put({targetId:0,path:Pt(f),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Bc});const r=t.store("collectionParents"),i=new rf,s=a=>{if(i.add(a)){const h=a.lastSegment(),f=a.popLast();return r.put({collectionId:h,parent:Pt(f)})}};return t.store("remoteDocuments").Y({J:!0},(a,h)=>{const f=new Ae(a);return s(f.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,h,f],m)=>{const g=Un(h);return s(g.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=pl(i),a=Mm(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const h=t.store("remoteDocumentsV14"),f=(y=a,y.document?new $(Ae.fromString(y.document.name).popFirst(5)):y.noDocument?$.fromSegments(y.noDocument.path):y.unknownDocument?$.fromSegments(y.unknownDocument.path):Z()).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};var y;i.push(h.put(m))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=ig(this.serializer),s=new of(dd.jr,this.serializer.ut);return r.W().next(a=>{const h=new Map;return a.forEach(f=>{var m;let g=null!==(m=h.get(f.userId))&&void 0!==m?m:pe();$s(this.serializer,f).keys().forEach(y=>g=g.add(y)),h.set(f.userId,g)}),R.forEach(h,(f,m)=>{const g=new ot(m),y=sd.ct(this.serializer,g),w=s.getIndexManager(g),S=ld.ct(g,this.serializer,w,s.referenceDelegate);return new cg(i,S,y,w).recalculateAndSaveOverlaysForDocumentKeys(new Kc(t,Jt._e),f).next()})})}}function lg(n){n.createObjectStore("targetDocuments",{keyPath:Uc}).createIndex("documentTargetsIndex",Sh,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Fc,{unique:!0}),n.createObjectStore("targetGlobal")}const af="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class cf{constructor(e,t,r,i,s,a,h,f,m,g,y=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=h,this.oi=m,this._i=g,this.ai=y,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=w=>Promise.resolve(),!cf.D())throw new V(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Vy(this,i),this.Ii=t+"main",this.serializer=new Nm(f),this.Ti=new Tn(this.Ii,this.ai,new Ky(this.serializer)),this.qr=new ky(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ig(this.serializer),this.Kr=new wy,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===g&&rt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new V(x.FAILED_PRECONDITION,af);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Jt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var t=this;return this.Pi=function(){var r=(0,I.A)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var t=(0,I.A)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,I.A)(function*(){t.started&&(yield t.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(br(e))return M("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return M("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return vl(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return fd(e).delete(this.clientId)}bi(){var e=this;return(0,I.A)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=pt(r,"clientMetadata");return i.W().next(s=>{const a=e.Ci(s,18e5),h=s.filter(f=>-1===a.indexOf(f));return R.forEach(h,f=>i.delete(f.clientId)).next(()=>h)})}).catch(()=>[]);if(e.Ei)for(const r of t)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):vl(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new V(x.FAILED_PRECONDITION,af);return!1}}return!(!this.networkEnabled||!this.inForeground)||fd(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&M("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,I.A)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Kc(t,Jt._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>fd(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return ld.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Dy(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return sd.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){M("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(f=this.ai)?Dh:14===f?$c:13===f?qc:12===f?Jo:11===f?jc:void Z();var f;let a;return this.Ti.runTransaction(e,i,s,h=>(a=new Kc(h,this.Lr?this.Lr.next():Jt._e),"readwrite-primary"===t?this.fi(a).next(f=>!!f||this.gi(a)).next(f=>{if(!f)throw rt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new V(x.FAILED_PRECONDITION,Vc);return r(a)}).next(f=>this.yi(a).next(()=>f)):this.Li(a).next(()=>r(a)))).then(h=>(a.raiseOnCommittedEvent(),h))}Li(e){return vl(e).get("owner").next(t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new V(x.FAILED_PRECONDITION,af)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vl(e).put("owner",t)}static D(){return Tn.D()}pi(e){const t=vl(e);return t.get("owner").next(r=>this.wi(r)?(M("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t||e>r&&(rt(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;(0,Y.nr)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return M("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return rt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){rt("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vl(n){return pt(n,"owner")}function fd(n){return pt(n,"clientMetadata")}function lf(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class uf{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=pe(),i=pe();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new uf(e,t.fromCache,r,i)}}class Wy{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ug{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new Wy;return this.Hi(e,t,a).next(h=>{if(s.result=h,this.$i)return this.Ji(e,t,a,h.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(Er()<=Q.$b.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",q(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(Er()<=Q.$b.DEBUG&&M("QueryEngine","Query:",q(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Er()<=Q.$b.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",q(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,d(t))):R.resolve())}zi(e,t){if(l(t))return R.resolve(null);let r=d(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=T(t,null,"F"),r=d(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=pe(...s);return this.Gi.getDocuments(e,a).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.Yi(t,h);return this.Zi(t,m,a,f.readTime)?this.zi(e,T(t,null,"F")):this.Xi(e,m,t,f)}))})))}ji(e,t,r,i){return l(t)||i.isEqual(ne.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(Er()<=Q.$b.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),q(t)),this.Xi(e,a,t,kc(i,-1)).next(h=>h))})}Yi(e,t){let r=new Ve(Ke(e));return t.forEach((i,s)=>{J(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return Er()<=Q.$b.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",q(t)),this.Gi.getDocumentsMatchingQuery(e,t,jt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class Hy{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Ue(de),this.ns=new cn(s=>wn(s),Li),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cg(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function dg(n,e,t,r){return new Hy(n,e,t,r)}function hg(n,e){return df.apply(this,arguments)}function df(){return df=(0,I.A)(function*(n,e){const t=K(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],h=[];let f=pe();for(const m of i){a.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}for(const m of s){h.push(m.batchId);for(const g of m.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(r,f).next(m=>({_s:m,removedBatchIds:a,addedBatchIds:h}))})})}),df.apply(this,arguments)}function fg(n){const e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function pg(n,e,t){let r=pe(),i=pe();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=xt();return t.forEach((h,f)=>{const m=s.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(ne.min())?(e.removeEntry(h,f.readTime),a=a.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),a=a.insert(h,f)):M("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{us:a,cs:i}})}function Xy(n,e){const t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function va(n,e){const t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new ei(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}function Ia(n,e,t){return hf.apply(this,arguments)}function hf(){return hf=(0,I.A)(function*(n,e,t){const r=K(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!br(a))throw a;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),hf.apply(this,arguments)}function pd(n,e,t){const r=K(n);let i=ne.min(),s=pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(f,m,g){const y=K(f),w=y.ns.get(g);return void 0!==w?R.resolve(y.ts.get(w)):y.qr.getTargetData(m,g)}(r,a,d(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,h.targetId).next(f=>{s=f})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:ne.min(),t?s:pe())).next(h=>(_g(r,ee(e),h),{documents:h,ls:s})))}function mg(n,e){const t=K(n),r=K(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function gg(n,e){const t=K(n),r=t.rs.get(e)||ne.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,kc(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(_g(t,e,i),i))}function _g(n,e,t){let r=n.rs.get(e)||ne.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}function ff(){return ff=(0,I.A)(function*(n,e,t,r){const i=K(n);let s=pe(),a=xt();for(const m of t){const g=e.hs(m.metadata.name);m.document&&(s=s.add(g));const y=e.Ps(m);y.setReadTime(e.Is(m.metadata.readTime)),a=a.insert(g,y)}const h=i.ss.newChangeBuffer({trackRemovals:!0}),f=yield va(i,(g=r,d(Fi(Ae.fromString(`__bundle__/docs/${g}`)))));var g;return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>pg(m,h,a).next(g=>(h.apply(m),g)).next(g=>i.qr.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.qr.addMatchingKeys(m,s,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,g.us,g.cs)).next(()=>g.us)))}),ff.apply(this,arguments)}function Zy(n,e){return pf.apply(this,arguments)}function pf(){return pf=(0,I.A)(function*(n,e,t=pe()){const r=yield va(n,d(Xh(e.bundledQuery))),i=K(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=ut(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const h=r.withResumeToken(lt.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(h.targetId,h),i.qr.updateTargetData(s,h).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),pf.apply(this,arguments)}function yg(n,e){return`firestore_clients_${n}_${e}`}function vg(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function mf(n,e){return`firestore_targets_${n}_${e}`}class md{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code,a&&(s=new V(i.error.code,i.error.message))),a?new md(e,t,i.state,s):(rt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Il{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new V(r.error.code,r.error.message))),s?new Il(e,r.state,i):(rt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gd{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=Bh();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=Xo(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new gd(e,s):(rt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class gf{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new gf(t.clientId,t.onlineState):(rt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class _f{constructor(){this.activeTargetIds=Bh()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yf{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Ue(de),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=yg(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new _f),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,I.A)(function*(){const t=yield e.syncEngine.Bi();for(const i of t){if(i===e.Rs)continue;const s=e.getItem(yg(e.persistenceKey,i));if(s){const a=gd.Ts(i,s);a&&(e.gs=e.gs.insert(a.clientId,a))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(mf(this.persistenceKey,e));if(r){const i=Il.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(mf(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return M("SharedClientState","READ",e,t),t}setItem(e,t){M("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){M("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var t=this;const r=e;if(r.storageArea===this.storage){if(M("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void rt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,I.A)(function*(){if(t.started){if(null!==r.key)if(t.Ss.test(r.key)){if(null==r.newValue){const i=t.Ks(r.key);return t.$s(i,null)}{const i=t.Us(r.key,r.newValue);if(i)return t.$s(i.clientId,i)}}else if(t.bs.test(r.key)){if(null!==r.newValue){const i=t.Ws(r.key,r.newValue);if(i)return t.Gs(i)}}else if(t.Ds.test(r.key)){if(null!==r.newValue){const i=t.zs(r.key,r.newValue);if(i)return t.js(i)}}else if(r.key===t.Cs){if(null!==r.newValue){const i=t.Ms(r.newValue);if(i)return t.xs(i)}}else if(r.key===t.ws){const i=function(a){let h=Jt._e;if(null!=a)try{const f=JSON.parse(a);te("number"==typeof f),h=f}catch(f){rt("SharedClientState","Failed to read sequence number from WebStorage",f)}return h}(r.newValue);i!==Jt._e&&t.sequenceNumberHandler(i)}else if(r.key===t.vs){const i=t.Hs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Js(s)))}}else t.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new md(this.currentUser,e,t,r),s=vg(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=vg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,t,r){const i=mf(this.persistenceKey,e),s=new Il(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return gd.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]);return md.Ts(new ot(void 0!==r[2]?r[2]:null),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return Il.Ts(i,t)}Ms(e){return gf.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var t=this;return(0,I.A)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Ys(e.batchId,e.state,e.error);M("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],h=[];return s.forEach(f=>{i.has(f)||a.push(f)}),i.forEach(f=>{s.has(f)||h.push(f)}),this.syncEngine.Xs(a,h).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=Bh();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Ig{constructor(){this.eo=new _f,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new _f,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ev{ro(e){}shutdown(){}}class Tg{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let _d=null;function vf(){return null===_d?_d=268435456+Math.round(2147483648*Math.random()):_d++,"0x"+_d.toString(16)}const tv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nv{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Kt="WebChannelConnection";class rv extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const h=vf(),f=this.So(t,r);M("RestConnection",`Sending RPC '${t}' ${h}:`,f,i);const m={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(m,s,a),this.Do(t,f,m,i).then(g=>(M("RestConnection",`Received RPC '${t}' ${h}: `,g),g),g=>{throw St("RestConnection",`RPC '${t}' ${h} failed with error: `,g,"url: ",f,"request:",i),g})}Co(t,r,i,s,a,h){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ln,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){return`${this.mo}/v1/${r}:${tv[t]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=vf();return new Promise((a,h)=>{const f=new wc;f.setWithCredentials(!0),f.listenOnce(ph.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Ps.NO_ERROR:const g=f.getResponseJson();M(Kt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(g)),a(g);break;case Ps.TIMEOUT:M(Kt,`RPC '${e}' ${s} timed out`),h(new V(x.DEADLINE_EXCEEDED,"Request time out"));break;case Ps.HTTP_ERROR:const y=f.getStatus();if(M(Kt,`RPC '${e}' ${s} failed with status:`,y,"response text:",f.getResponseText()),y>0){let w=f.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w?.error;if(S&&S.status&&S.message){const U=function(B){const ie=B.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(ie)>=0?ie:x.UNKNOWN}(S.status);h(new V(U,S.message))}else h(new V(x.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new V(x.UNAVAILABLE,"Connection failed."));break;default:Z()}}finally{M(Kt,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(i);M(Kt,`RPC '${e}' ${s} sending request:`,i),f.send(t,"POST",m,r,15)})}vo(e,t,r){const i=vf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=hh(),h=fh(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.bo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const g=s.join("");M(Kt,`Creating RPC '${e}' stream ${i}: ${g}`,f);const y=a.createWebChannel(g,f);let w=!1,S=!1;const U=new nv({co:B=>{S?M(Kt,`Not sending because RPC '${e}' stream ${i} is closed:`,B):(w||(M(Kt,`Opening RPC '${e}' stream ${i} transport.`),y.open(),w=!0),M(Kt,`RPC '${e}' stream ${i} sending:`,B),y.send(B))},lo:()=>y.close()}),G=(B,ie,oe)=>{B.listen(ie,H=>{try{oe(H)}catch(ue){setTimeout(()=>{throw ue},0)}})};return G(y,qo.EventType.OPEN,()=>{S||M(Kt,`RPC '${e}' stream ${i} transport opened.`)}),G(y,qo.EventType.CLOSE,()=>{S||(S=!0,M(Kt,`RPC '${e}' stream ${i} transport closed`),U.Ro())}),G(y,qo.EventType.ERROR,B=>{S||(S=!0,St(Kt,`RPC '${e}' stream ${i} transport errored:`,B),U.Ro(new V(x.UNAVAILABLE,"The operation could not be completed")))}),G(y,qo.EventType.MESSAGE,B=>{var ie;if(!S){const oe=B.data[0];te(!!oe);const ue=oe.error||(null===(ie=oe[0])||void 0===ie?void 0:ie.error);if(ue){M(Kt,`RPC '${e}' stream ${i} received error:`,ue);const ye=ue.status;let Oe=function(NE){const Z_=mt[NE];if(void 0!==Z_)return pm(Z_)}(ye),dt=ue.message;void 0===Oe&&(Oe=x.INTERNAL,dt="Unknown error status: "+ye+" with message "+ue.message),S=!0,U.Ro(new V(Oe,dt)),y.close()}else M(Kt,`RPC '${e}' stream ${i} received:`,oe),U.Vo(oe)}}),G(h,Ac.STAT_EVENT,B=>{B.stat===bu.PROXY?M(Kt,`RPC '${e}' stream ${i} detected buffering proxy`):B.stat===bu.NOPROXY&&M(Kt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{U.Ao()},0),U}}function Eg(){return typeof window<"u"?window:null}function yd(){return typeof document<"u"?document:null}function Tl(n){return new fy(n,!0)}class If{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&M("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Ag{constructor(e,t,r,i,s,a,h,f){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new If(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,I.A)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,I.A)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,t){var r=this;return(0,I.A)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(rt(t.toString()),rt("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):t&&t.code===x.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(t)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new V(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,I.A)(function*(){e.state=0,e.start()}))}o_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iv extends Ag{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function gy(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:Z(),i=e.targetChange.targetIds||[],s=function(m,g){return m.useProto3Json?(te(void 0===g||"string"==typeof g),lt.fromBase64String(g||"")):(te(void 0===g||g instanceof Uint8Array),lt.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,h=a&&function(m){const g=void 0===m.code?x.UNKNOWN:pm(m.code);return new V(g,m.message||"")}(a);t=new vm(r,i,s,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Dr(n,r.document.name),s=ut(r.document.updateTime),a=r.document.createTime?ut(r.document.createTime):ne.min(),h=new Tt({mapValue:{fields:r.document.fields}}),f=Be.newFoundDocument(i,s,a,h);t=new rd(r.targetIds||[],r.removedTargetIds||[],f.key,f)}else if("documentDelete"in e){const r=e.documentDelete,i=Dr(n,r.document),s=r.readTime?ut(r.readTime):ne.min(),a=Be.newNoDocument(i,s);t=new rd([],r.removedTargetIds||[],a.key,a)}else if("documentRemove"in e){const r=e.documentRemove,i=Dr(n,r.document);t=new rd([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Z();{const r=e.filter,{count:i=0,unchangedNames:s}=r,a=new ay(i,s);t=new ym(r.targetId,a)}}var m;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return ne.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ne.min():a.readTime?ut(a.readTime):ne.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=hl(this.serializer),t.addTarget=function(s,a){let h;const f=a.target;if(h=Bs(f)?{documents:Pm(s,f)}:{query:Yh(s,f)},h.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){h.resumeToken=Am(s,a.resumeToken);const m=Kh(s,a.expectedCount);null!==m&&(h.expectedCount=m)}else if(a.snapshotVersion.compareTo(ne.min())>0){h.readTime=fa(s,a.snapshotVersion.toTimestamp());const m=Kh(s,a.expectedCount);null!==m&&(h.expectedCount=m)}return h}(this.serializer,e);const r=function yy(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=hl(this.serializer),t.removeTarget=e,this.e_(t)}}class sv extends Ag{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function _y(n,e){return n&&n.length>0?(te(void 0!==e),n.map(t=>function(i,s){let a=ut(i.updateTime?i.updateTime:s);return a.isEqual(ne.min())&&(a=ut(s)),new ry(a,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=ut(e.commitTime);return this.listener.I_(r,t)}return te(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=hl(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>fl(this.serializer,r))};this.e_(t)}}class ov extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new V(x.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new V(x.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(x.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class cv{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(rt(t),this.f_=!1):M("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class lv{constructor(e,t,r,i,s){var a=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(h=>{r.enqueueAndForget((0,I.A)(function*(){var f;qi(a)&&(M("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,I.A)(function*(g){const y=K(g);y.C_.add(4),yield Ta(y),y.M_.set("Unknown"),y.C_.delete(4),yield El(y)}),function m(g){return f.apply(this,arguments)})(a))}))}),this.M_=new cv(r,i)}}function El(n){return Ef.apply(this,arguments)}function Ef(){return Ef=(0,I.A)(function*(n){if(qi(n))for(const e of n.v_)yield e(!0)}),Ef.apply(this,arguments)}function Ta(n){return Af.apply(this,arguments)}function Af(){return Af=(0,I.A)(function*(n){for(const e of n.v_)yield e(!1)}),Af.apply(this,arguments)}function vd(n,e){const t=K(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Cf(t)?bf(t):Aa(t).Ho()&&wf(t,e))}function Al(n,e){const t=K(n),r=Aa(t);t.D_.delete(e),r.Ho()&&wg(t,e),0===t.D_.size&&(r.Ho()?r.Zo():qi(t)&&t.M_.set("Unknown"))}function wf(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Aa(n).u_(e)}function wg(n,e){n.x_.Oe(e),Aa(n).c_(e)}function bf(n){n.x_=new ly({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Aa(n).start(),n.M_.g_()}function Cf(n){return qi(n)&&!Aa(n).jo()&&n.D_.size>0}function qi(n){return 0===K(n).C_.size}function bg(n){n.x_=void 0}function uv(n){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,I.A)(function*(n){n.D_.forEach((e,t)=>{wf(n,e)})}),Rf.apply(this,arguments)}function dv(n,e){return Sf.apply(this,arguments)}function Sf(){return Sf=(0,I.A)(function*(n,e){bg(n),Cf(n)?(n.M_.w_(e),bf(n)):n.M_.set("Unknown")}),Sf.apply(this,arguments)}function hv(n,e,t){return Pf.apply(this,arguments)}function Pf(){return Pf=(0,I.A)(function*(n,e,t){if(n.M_.set("Online"),e instanceof vm&&2===e.state&&e.cause)try{yield(r=(0,I.A)(function*(s,a){const h=a.cause;for(const f of a.targetIds)s.D_.has(f)&&(yield s.remoteSyncer.rejectListen(f,h),s.D_.delete(f),s.x_.removeTarget(f))}),function i(s,a){return r.apply(this,arguments)})(n,e)}catch(r){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Id(n,r)}else if(e instanceof rd?n.x_.$e(e):e instanceof ym?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(ne.min()))try{const r=yield fg(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){const h=s.x_.it(a);return h.targetChanges.forEach((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const g=s.D_.get(m);g&&s.D_.set(m,g.withResumeToken(f.resumeToken,a))}}),h.targetMismatches.forEach((f,m)=>{const g=s.D_.get(f);if(!g)return;s.D_.set(f,g.withResumeToken(lt.EMPTY_BYTE_STRING,g.snapshotVersion)),wg(s,f);const y=new ei(g.target,f,m,g.sequenceNumber);wf(s,y)}),s.remoteSyncer.applyRemoteEvent(h)}(n,t))}catch(r){M("RemoteStore","Failed to raise snapshot:",r),yield Id(n,r)}var r}),Pf.apply(this,arguments)}function Id(n,e,t){return xf.apply(this,arguments)}function xf(){return xf=(0,I.A)(function*(n,e,t){if(!br(e))throw e;n.C_.add(1),yield Ta(n),n.M_.set("Offline"),t||(t=()=>fg(n.localStore)),n.asyncQueue.enqueueRetryable((0,I.A)(function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.C_.delete(1),yield El(n)}))}),xf.apply(this,arguments)}function Cg(n,e){return e().catch(t=>Id(n,t,e))}function Ea(n){return Df.apply(this,arguments)}function Df(){return Df=(0,I.A)(function*(n){const e=K(n),t=$i(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;fv(e);)try{const i=yield Xy(e.localStore,r);if(null===i){0===e.b_.length&&t.Zo();break}r=i.batchId,pv(e,i)}catch(i){yield Id(e,i)}Rg(e)&&Sg(e)}),Df.apply(this,arguments)}function fv(n){return qi(n)&&n.b_.length<10}function pv(n,e){n.b_.push(e);const t=$i(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function Rg(n){return qi(n)&&!$i(n).jo()&&n.b_.length>0}function Sg(n){$i(n).start()}function mv(n){return kf.apply(this,arguments)}function kf(){return kf=(0,I.A)(function*(n){$i(n).E_()}),kf.apply(this,arguments)}function gv(n){return Of.apply(this,arguments)}function Of(){return Of=(0,I.A)(function*(n){const e=$i(n);for(const t of n.b_)e.P_(t.mutations)}),Of.apply(this,arguments)}function _v(n,e,t){return Nf.apply(this,arguments)}function Nf(){return Nf=(0,I.A)(function*(n,e,t){const r=n.b_.shift(),i=jh.from(r,e,t);yield Cg(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ea(n)}),Nf.apply(this,arguments)}function yv(n,e){return Vf.apply(this,arguments)}function Vf(){return Vf=(0,I.A)(function*(n,e){var t;e&&$i(n).h_&&(yield(t=(0,I.A)(function*(i,s){if(fm(h=s.code)&&h!==x.ABORTED){const a=i.b_.shift();$i(i).Yo(),yield Cg(i,()=>i.remoteSyncer.rejectFailedWrite(a.batchId,s)),yield Ea(i)}var h}),function r(i,s){return t.apply(this,arguments)})(n,e)),Rg(n)&&Sg(n)}),Vf.apply(this,arguments)}function Pg(n,e){return Mf.apply(this,arguments)}function Mf(){return Mf=(0,I.A)(function*(n,e){const t=K(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const r=qi(t);t.C_.add(3),yield Ta(t),r&&t.M_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),yield El(t)}),Mf.apply(this,arguments)}function Lf(n,e){return Ff.apply(this,arguments)}function Ff(){return Ff=(0,I.A)(function*(n,e){const t=K(n);e?(t.C_.delete(2),yield El(t)):e||(t.C_.add(2),yield Ta(t),t.M_.set("Unknown"))}),Ff.apply(this,arguments)}function Aa(n){return n.O_||(n.O_=function(t,r,i){const s=K(t);return s.A_(),new iv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:uv.bind(null,n),Io:dv.bind(null,n),a_:hv.bind(null,n)}),n.v_.push(function(){var e=(0,I.A)(function*(t){t?(n.O_.Yo(),Cf(n)?bf(n):n.M_.set("Unknown")):(yield n.O_.stop(),bg(n))});return function(t){return e.apply(this,arguments)}}())),n.O_}function $i(n){return n.N_||(n.N_=function(t,r,i){const s=K(t);return s.A_(),new sv(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:mv.bind(null,n),Io:yv.bind(null,n),T_:gv.bind(null,n),I_:_v.bind(null,n)}),n.v_.push(function(){var e=(0,I.A)(function*(t){t?(n.N_.Yo(),yield Ea(n)):(yield n.N_.stop(),n.b_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(t){return e.apply(this,arguments)}}())),n.N_}class Uf{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new it,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,h=new Uf(e,t,a,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new V(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wa(n,e){if(rt("AsyncQueue",`${e}: ${n}`),br(n))return new V(x.UNAVAILABLE,`${e}: ${n}`);throw n}class ba{constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=Ui(),this.sortedSet=new Ue(this.comparator)}static emptySet(e){return new ba(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ba)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new ba;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class xg{constructor(){this.B_=new Ue($.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):Z():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ca{constructor(e,t,r,i,s,a,h,f,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(h=>{a.push({type:0,doc:h})}),new Ca(e,t,ba.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&C(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class vv{constructor(){this.k_=void 0,this.listeners=[]}}class Iv{constructor(){this.queries=new cn(e=>k(e),C),this.onlineState="Unknown",this.q_=new Set}}function Bf(n,e){return zf.apply(this,arguments)}function zf(){return zf=(0,I.A)(function*(n,e){const t=K(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new vv),i)try{s.k_=yield t.onListen(r)}catch(a){const h=wa(a,`Initialization of query '${q(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&qf(t)}),zf.apply(this,arguments)}function Gf(n,e){return jf.apply(this,arguments)}function jf(){return jf=(0,I.A)(function*(n,e){const t=K(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),jf.apply(this,arguments)}function Tv(n,e){const t=K(n);let r=!1;for(const i of e){const a=t.queries.get(i.query);if(a){for(const h of a.listeners)h.K_(i)&&(r=!0);a.k_=i}}r&&qf(t)}function Ev(n,e,t){const r=K(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function qf(n){n.q_.forEach(e=>{e.next()})}class $f{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Ca(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){return!e.fromCache||(!this.options.J_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Ca.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Av{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class Dg{constructor(e){this.serializer=e}hs(e){return Dr(this.serializer,e)}Ps(e){return e.metadata.exists?Sm(this.serializer,e.document,!1):Be.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return ut(e)}}class wv{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kg(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=Ae.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new Dg(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const h=(t.get(a)||pe()).add(s);t.set(a,h)}}return t}complete(){var e=this;return(0,I.A)(function*(){const t=yield function Jy(n,e,t,r){return ff.apply(this,arguments)}(e.localStore,new Dg(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield Zy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:t}})()}}function kg(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Og{constructor(e){this.key=e}}class Ng{constructor(e){this.key=e}}class Vg{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=pe(),this.mutatedKeys=pe(),this._a=Ke(e),this.aa=new ba(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new xg,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,h=!1;const f="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,m="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,y)=>{const w=i.get(g),S=J(this.query,y)?y:null,U=!!w&&this.mutatedKeys.has(w.key),G=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let B=!1;w&&S?w.data.isEqual(S.data)?U!==G&&(r.track({type:3,doc:S}),B=!0):this.ha(w,S)||(r.track({type:2,doc:S}),B=!0,(f&&this._a(S,f)>0||m&&this._a(S,m)<0)&&(h=!0)):!w&&S?(r.track({type:0,doc:S}),B=!0):w&&!S&&(r.track({type:1,doc:w}),B=!0,(f||m)&&(h=!0)),B&&(S?(a=a.add(S),s=G?s.add(g):s.delete(g)):(a=a.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const g="F"===this.query.limitType?a.last():a.first();a=a.delete(g.key),s=s.delete(g.key),r.track({type:1,doc:g})}return{aa:a,la:r,Zi:h,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((g,y)=>function(S,U){const G=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z()}};return G(S)-G(U)}(g.type,y.type)||this._a(g.doc,y.doc)),this.Pa(r),i=null!=i&&i;const h=t&&!i?this.Ia():[],f=0===this.oa.size&&this.current&&!i?1:0,m=f!==this.sa;return this.sa=f,0!==a.length||m?{snapshot:new Ca(this.query,e.aa,s,a,e.mutatedKeys,0===f,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:h}:{Ta:h}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new xg,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=pe(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new Ng(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new Og(r))}),t}da(e){this.ia=e.ls,this.oa=pe();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return Ca.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class bv{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Cv{constructor(e){this.key=e,this.Ra=!1}}class Rv{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new cn(h=>k(h),C),this.fa=new Map,this.ga=new Set,this.pa=new Ue($.comparator),this.ya=new Map,this.wa=new sf,this.Sa={},this.ba=new Map,this.Da=Hs.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Sv(n,e){return Kf.apply(this,arguments)}function Kf(){return Kf=(0,I.A)(function*(n,e){const t=mp(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=yield va(t.localStore,d(e)),h=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=yield Wf(t,e,r,"current"===h,a.resumeToken),t.isPrimaryClient&&vd(t.remoteStore,a)}return i}),Kf.apply(this,arguments)}function Wf(n,e,t,r,i){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,I.A)(function*(n,e,t,r,i){n.va=(y,w,S)=>{return(U=(0,I.A)(function*(B,ie,oe,H){let ue=ie.view.ca(oe);ue.Zi&&(ue=yield pd(B.localStore,ie.query,!1).then(({documents:qn})=>ie.view.ca(qn,ue)));const ye=H&&H.targetChanges.get(ie.targetId),Oe=H&&null!=H.targetMismatches.get(ie.targetId),dt=ie.view.applyChanges(ue,B.isPrimaryClient,ye,Oe);return ip(B,ie.targetId,dt.Ta),dt.snapshot}),function G(B,ie,oe,H){return U.apply(this,arguments)})(n,y,w,S);var U};const s=yield pd(n.localStore,e,!0),a=new Vg(e,s.ls),h=a.ca(s.documents),f=ul.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),m=a.applyChanges(h,n.isPrimaryClient,f);ip(n,t,m.Ta);const g=new bv(e,t,a);return n.ma.set(e,g),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),m.snapshot}),Hf.apply(this,arguments)}function Pv(n,e){return Qf.apply(this,arguments)}function Qf(){return Qf=(0,I.A)(function*(n,e){const t=K(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!C(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ia(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Al(t.remoteStore,r.targetId),Ra(t,r.targetId)}).catch(wr))):(Ra(t,r.targetId),yield Ia(t.localStore,r.targetId,!0))}),Qf.apply(this,arguments)}function Yf(){return Yf=(0,I.A)(function*(n,e,t){const r=gp(n);try{const i=yield function(a,h){const f=K(a),m=Fe.now(),g=h.reduce((S,U)=>S.add(U.key),pe());let y,w;return f.persistence.runTransaction("Locally write mutations","readwrite",S=>{let U=xt(),G=pe();return f.ss.getEntries(S,g).next(B=>{U=B,U.forEach((ie,oe)=>{oe.isValidDocument()||(G=G.add(ie))})}).next(()=>f.localDocuments.getOverlayedDocuments(S,U)).next(B=>{y=B;const ie=[];for(const oe of h){const H=sy(oe,y.get(oe.key).overlayedDocument);null!=H&&ie.push(new Zr(oe.key,H,ju(H.value.mapValue),et.exists(!0)))}return f.mutationQueue.addMutationBatch(S,m,ie,h)}).next(B=>{w=B;const ie=B.applyToLocalDocumentSet(y,G);return f.documentOverlayCache.saveOverlays(S,B.batchId,ie)})}).then(()=>({batchId:w.batchId,changes:ca(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,h,f){let m=a.Sa[a.currentUser.toKey()];m||(m=new Ue(de)),m=m.insert(h,f),a.Sa[a.currentUser.toKey()]=m}(r,i.batchId,t),yield ti(r,i.changes),yield Ea(r.remoteStore)}catch(i){const s=wa(i,"Failed to persist write");t.reject(s)}}),Yf.apply(this,arguments)}function Mg(n,e){return Xf.apply(this,arguments)}function Xf(){return Xf=(0,I.A)(function*(n,e){const t=K(n);try{const r=yield function Yy(n,e){const t=K(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const h=[];e.targetChanges.forEach((g,y)=>{const w=i.get(y);if(!w)return;h.push(t.qr.removeMatchingKeys(s,g.removedDocuments,y).next(()=>t.qr.addMatchingKeys(s,g.addedDocuments,y)));let S=w.withSequenceNumber(s.currentSequenceNumber);var G,B,ie;null!==e.targetMismatches.get(y)?S=S.withResumeToken(lt.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):g.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(g.resumeToken,r)),i=i.insert(y,S),B=S,ie=g,(0===(G=w).resumeToken.approximateByteSize()||B.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=3e8||ie.addedDocuments.size+ie.modifiedDocuments.size+ie.removedDocuments.size>0)&&h.push(t.qr.updateTargetData(s,S))});let f=xt(),m=pe();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),h.push(pg(s,a,e.documentUpdates).next(g=>{f=g.us,m=g.cs})),!r.isEqual(ne.min())){const g=t.qr.getLastRemoteSnapshotVersion(s).next(y=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(g)}return R.waitFor(h).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(t.ts=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?te(a.Ra):i.removedDocuments.size>0&&(te(a.Ra),a.Ra=!1))}),yield ti(t,r,e)}catch(r){yield wr(r)}}),Xf.apply(this,arguments)}function Lg(n,e,t){const r=K(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ma.forEach((s,a)=>{const h=a.view.Q_(e);h.snapshot&&i.push(h.snapshot)}),function(a,h){const f=K(a);f.onlineState=h;let m=!1;f.queries.forEach((g,y)=>{for(const w of y.listeners)w.Q_(h)&&(m=!0)}),m&&qf(f)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Dv(n,e,t){return Jf.apply(this,arguments)}function Jf(){return Jf=(0,I.A)(function*(n,e,t){const r=K(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Ue($.comparator);a=a.insert(s,Be.newNoDocument(s,ne.min()));const h=pe().add(s),f=new ll(ne.min(),new Map,new Ue(de),a,h);yield Mg(r,f),r.pa=r.pa.remove(s),r.ya.delete(e),sp(r)}else yield Ia(r.localStore,e,!1).then(()=>Ra(r,e,t)).catch(wr)}),Jf.apply(this,arguments)}function kv(n,e){return Zf.apply(this,arguments)}function Zf(){return Zf=(0,I.A)(function*(n,e){const t=K(n),r=e.batch.batchId;try{const i=yield function Qy(n,e){const t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(h,f,m,g){const y=m.batch,w=y.keys();let S=R.resolve();return w.forEach(U=>{S=S.next(()=>g.getEntry(f,U)).next(G=>{const B=m.docVersions.get(U);te(null!==B),G.version.compareTo(B)<0&&(y.applyToRemoteDocument(G,m),G.isValidDocument()&&(G.setReadTime(m.commitVersion),g.addEntry(G)))})}),S.next(()=>h.mutationQueue.removeMutationBatch(f,y))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=pe();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);rp(t,r,null),np(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ti(t,i)}catch(i){yield wr(i)}}),Zf.apply(this,arguments)}function Ov(n,e,t){return ep.apply(this,arguments)}function ep(){return ep=(0,I.A)(function*(n,e,t){const r=K(n);try{const i=yield function(a,h){const f=K(a);return f.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return f.mutationQueue.lookupMutationBatch(m,h).next(y=>(te(null!==y),g=y.keys(),f.mutationQueue.removeMutationBatch(m,y))).next(()=>f.mutationQueue.performConsistencyCheck(m)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(m,g,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>f.localDocuments.getDocuments(m,g))})}(r.localStore,e);rp(r,e,t),np(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ti(r,i)}catch(i){yield wr(i)}}),ep.apply(this,arguments)}function tp(){return tp=(0,I.A)(function*(n,e){const t=K(n);qi(t.remoteStore)||M("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const h=K(a);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=wa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),tp.apply(this,arguments)}function np(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function rp(n,e,t){const r=K(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Ra(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||Fg(n,r)})}function Fg(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);null!==t&&(Al(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),sp(n))}function ip(n,e,t){for(const r of t)r instanceof Og?(n.wa.addReference(r.key,e),Vv(n,r)):r instanceof Ng?(M("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||Fg(n,r.key)):Z()}function Vv(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(M("SyncEngine","New document in limbo: "+t),n.ga.add(r),sp(n))}function sp(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new $(Ae.fromString(e)),r=n.Da.next();n.ya.set(r,new Cv(t)),n.pa=n.pa.insert(t,r),vd(n.remoteStore,new ei(d(Fi(t.path)),r,"TargetPurposeLimboResolution",Jt._e))}}function ti(n,e,t){return op.apply(this,arguments)}function op(){return op=(0,I.A)(function*(n,e,t){const r=K(n),i=[],s=[],a=[];var h;r.ma.isEmpty()||(r.ma.forEach((h,f)=>{a.push(r.va(f,e,t).then(m=>{if((m||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(f.targetId,m?.fromCache?"not-current":"current"),m){i.push(m);const g=uf.Qi(f.targetId,m);s.push(g)}}))}),yield Promise.all(a),r.Va.a_(i),yield(h=(0,I.A)(function*(m,g){const y=K(m);try{yield y.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>R.forEach(g,S=>R.forEach(S.ki,U=>y.persistence.referenceDelegate.addReference(w,S.targetId,U)).next(()=>R.forEach(S.qi,U=>y.persistence.referenceDelegate.removeReference(w,S.targetId,U)))))}catch(w){if(!br(w))throw w;M("LocalStore","Failed to update sequence numbers: "+w)}for(const w of g){const S=w.targetId;if(!w.fromCache){const U=y.ts.get(S),B=U.withLastLimboFreeSnapshotVersion(U.snapshotVersion);y.ts=y.ts.insert(S,B)}}}),function f(m,g){return h.apply(this,arguments)})(r.localStore,s))}),op.apply(this,arguments)}function Mv(n,e){return ap.apply(this,arguments)}function ap(){return ap=(0,I.A)(function*(n,e){const t=K(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());const r=yield hg(t.localStore,e);t.currentUser=e,(s=t).ba.forEach(h=>{h.forEach(f=>{f.reject(new V(x.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ti(t,r._s)}var s}),ap.apply(this,arguments)}function Lv(n,e){const t=K(n),r=t.ya.get(e);if(r&&r.Ra)return pe().add(r.key);{let i=pe();const s=t.fa.get(e);if(!s)return i;for(const a of s){const h=t.ma.get(a);i=i.unionWith(h.view.ua)}return i}}function Fv(n,e){return cp.apply(this,arguments)}function cp(){return cp=(0,I.A)(function*(n,e){const t=K(n),r=yield pd(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&ip(t,e.targetId,i.Ta),i}),cp.apply(this,arguments)}function Uv(n,e){return lp.apply(this,arguments)}function lp(){return lp=(0,I.A)(function*(n,e){const t=K(n);return gg(t.localStore,e).then(r=>ti(t,r))}),lp.apply(this,arguments)}function Bv(n,e,t,r){return up.apply(this,arguments)}function up(){return up=(0,I.A)(function*(n,e,t,r){const i=K(n),s=yield function(h,f){const m=K(h),g=K(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",y=>g.Cn(y,f).next(w=>w?m.localDocuments.getDocuments(y,w):R.resolve(null)))}(i.localStore,e);var f;null!==s?("pending"===t?yield Ea(i.remoteStore):"acknowledged"===t||"rejected"===t?(rp(i,e,r||null),np(i,e),f=e,K(K(i.localStore).mutationQueue).Fn(f)):Z(),yield ti(i,s)):M("SyncEngine","Cannot apply mutation batch with id: "+e)}),up.apply(this,arguments)}function dp(){return dp=(0,I.A)(function*(n,e){const t=K(n);if(mp(t),gp(t),!0===e&&!0!==t.Ca){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Ug(t,r.toArray());t.Ca=!0,yield Lf(t.remoteStore,!0);for(const s of i)vd(t.remoteStore,s)}else if(!1===e&&!1!==t.Ca){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Ra(t,a),Ia(t.localStore,a,!0))),Al(t.remoteStore,a)}),yield i,yield Ug(t,r),function(a){const h=K(a);h.ya.forEach((f,m)=>{Al(h.remoteStore,m)}),h.wa.Vr(),h.ya=new Map,h.pa=new Ue($.comparator)}(t),t.Ca=!1,yield Lf(t.remoteStore,!1)}}),dp.apply(this,arguments)}function Ug(n,e,t){return hp.apply(this,arguments)}function hp(){return hp=(0,I.A)(function*(n,e,t){const r=K(n),i=[],s=[];for(const a of e){let h;const f=r.fa.get(a);if(f&&0!==f.length){h=yield va(r.localStore,d(f[0]));for(const m of f){const g=r.ma.get(m),y=yield Fv(r,g);y.snapshot&&s.push(y.snapshot)}}else{const m=yield mg(r.localStore,a);h=yield va(r.localStore,m),yield Wf(r,Bg(m),a,!1,h.resumeToken)}i.push(h)}return r.Va.a_(s),i}),hp.apply(this,arguments)}function Bg(n){return Yu(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Gv(n){return t=K(n).localStore,K(K(t).persistence).Bi();var t}function jv(n,e,t,r){return fp.apply(this,arguments)}function fp(){return fp=(0,I.A)(function*(n,e,t,r){const i=K(n);if(i.Ca)return void M("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=yield gg(i.localStore,ee(s[0])),h=ll.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,lt.EMPTY_BYTE_STRING);yield ti(i,a,h);break}case"rejected":yield Ia(i.localStore,e,!0),Ra(i,e,r);break;default:Z()}}),fp.apply(this,arguments)}function qv(n,e,t){return pp.apply(this,arguments)}function pp(){return pp=(0,I.A)(function*(n,e,t){const r=mp(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){M("SyncEngine","Adding an already active target "+i);continue}const s=yield mg(r.localStore,i),a=yield va(r.localStore,s);yield Wf(r,Bg(s),a.targetId,!1,a.resumeToken),vd(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&(yield Ia(r.localStore,i,!1).then(()=>{Al(r.remoteStore,i),Ra(r,i)}).catch(wr))}}),pp.apply(this,arguments)}function mp(n){const e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Mg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Lv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Dv.bind(null,e),e.Va.a_=Tv.bind(null,e.eventManager),e.Va.Fa=Ev.bind(null,e.eventManager),e}function gp(n){const e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ov.bind(null,e),e}class Sa{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,I.A)(function*(){t.serializer=Tl(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return dg(this.persistence,new ug,e.initialUser,this.serializer)}createPersistence(e){return new of(dd.jr,this.serializer)}createSharedClientState(e){return new Ig}terminate(){var e=this;return(0,I.A)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class _p extends Sa{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,I.A)(function*(){yield t().call(r,e),yield r.xa.initialize(r,e),yield gp(r.xa.syncEngine),yield Ea(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return dg(this.persistence,new ug,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new tg(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new Eh(t,this.persistence);return new Th(e.asyncQueue,r)}createPersistence(e){const t=lf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?$t.withCacheSize(this.cacheSizeBytes):$t.DEFAULT;return new cf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Eg(),yd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Ig}}class zg extends _p{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,I.A)(function*(){yield t().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof yf&&(r.sharedClientState.syncEngine={Ys:Bv.bind(null,i),Zs:jv.bind(null,i),Xs:qv.bind(null,i),Bi:Gv.bind(null,i),Js:Uv.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,I.A)(function*(a){yield function zv(n,e){return dp.apply(this,arguments)}(r.xa.syncEngine,a),r.gcScheduler&&(a&&!r.gcScheduler.started?r.gcScheduler.start():a||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(a&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():a||r.indexBackfillerScheduler.stop())});return function(a){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Eg();if(!yf.D(t))throw new V(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=lf(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new yf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Pa{initialize(e,t){var r=this;return(0,I.A)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Lg(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Mv.bind(null,r.syncEngine),yield Lf(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Iv}createDatastore(e){const t=Tl(e.databaseInfo.databaseId),r=new rv(e.databaseInfo);return new ov(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,a=t=>Lg(this.syncEngine,t,0),h=Tg.D()?new Tg:new ev,new lv(r,i,s,a,h);var r,i,s,a,h}createSyncEngine(e,t){return function(i,s,a,h,f,m,g){const y=new Rv(i,s,a,h,f,m);return g&&(y.Ca=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,I.A)(function*(r){const i=K(r);M("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Ta(i),i.F_.shutdown(),i.M_.set("Unknown")}),function t(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function Gg(n,e=10240){let t=0;return{read:()=>(0,I.A)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,I.A)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Td{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):rt("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Wv{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new it,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,I.A)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,I.A)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,I.A)(function*(){const t=yield e.qa();if(null===t)return null;const r=e.La.decode(t),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Av(JSON.parse(s),t.length+i)})()}$a(){return this.buffer.findIndex(e=>123===e)}qa(){var e=this;return(0,I.A)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const t=e.$a();t<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Ka(e){var t=this;return(0,I.A)(function*(){for(;t.buffer.length<e;)(yield t.Ua())&&t.Qa("Reached the end of bundle when more is expected.");const r=t.La.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,I.A)(function*(){const t=yield e.Ba.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class Hv{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,I.A)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new V(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,I.A)(function*(a,h){const f=K(a),m=hl(f.serializer)+"/documents",g={documents:h.map(U=>dl(f.serializer,U))},y=yield f.Co("BatchGetDocuments",m,g,h.length),w=new Map;y.forEach(U=>{const G=function my(n,e){return"found"in e?function(r,i){te(!!i.found);const s=Dr(r,i.found.name),a=ut(i.found.updateTime),h=i.found.createTime?ut(i.found.createTime):ne.min(),f=new Tt({mapValue:{fields:i.found.fields}});return Be.newFoundDocument(s,a,h,f)}(n,e):"missing"in e?function(r,i){te(!!i.missing),te(!!i.readTime);const s=Dr(r,i.missing),a=ut(i.readTime);return Be.newNoDocument(s,a)}(n,e):Z()}(f.serializer,U);w.set(G.key.toString(),G)});const S=[];return h.forEach(U=>{const G=w.get(U.toString());te(!!G),S.push(G)}),S}),function s(a,h){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ha(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,I.A)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=$.fromPath(i);e.mutations.push(new zh(s,e.precondition(s)))}),yield(r=(0,I.A)(function*(s,a){const h=K(s),f=hl(h.serializer)+"/documents",m={writes:a.map(g=>fl(h.serializer,g))};yield h.wo("Commit",f,m)}),function i(s,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Z();t=ne.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new V(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ne.min())?et.exists(!1):et.updateTime(t):et.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ne.min()))throw new V(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return et.updateTime(t)}return et.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Qv{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new If(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,I.A)(function*(){const t=new Hv(e.datastore),r=e.za(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const t=this.updateFunction(e);return!Os(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!fm(t)}return!1}}class Yv{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ot.UNAUTHENTICATED,this.clientId=Pc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var a=(0,I.A)(function*(h){M("FirestoreClient","Received user=",h.uid),yield s.authCredentialListener(h),s.user=h});return function(h){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(r,a=>(M("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}getConfiguration(){var e=this;return(0,I.A)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(x.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new it;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,I.A)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=wa(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Ed(n,e){return yp.apply(this,arguments)}function yp(){return yp=(0,I.A)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,I.A)(function*(s){r.isEqual(s)||(yield hg(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),yp.apply(this,arguments)}function vp(n,e){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,I.A)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Tp(n);M("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Pg(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Pg(e.remoteStore,s)),n._onlineComponents=e}),Ip.apply(this,arguments)}function jg(n){return"FirebaseError"===n.name?n.code===x.FAILED_PRECONDITION||n.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Tp(n){return Ep.apply(this,arguments)}function Ep(){return Ep=(0,I.A)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ed(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!jg(t))throw t;St("Error using user provided cache. Falling back to memory cache: "+t),yield Ed(n,new Sa)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield Ed(n,new Sa);return n._offlineComponents}),Ep.apply(this,arguments)}function Ad(n){return Ap.apply(this,arguments)}function Ap(){return Ap=(0,I.A)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield vp(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield vp(n,new Pa))),n._onlineComponents}),Ap.apply(this,arguments)}function qg(n){return Tp(n).then(e=>e.persistence)}function xa(n){return Tp(n).then(e=>e.localStore)}function $g(n){return Ad(n).then(e=>e.remoteStore)}function wp(n){return Ad(n).then(e=>e.syncEngine)}function Da(n){return bp.apply(this,arguments)}function bp(){return bp=(0,I.A)(function*(n){const e=yield Ad(n),t=e.eventManager;return t.onListen=Sv.bind(null,e.syncEngine),t.onUnlisten=Pv.bind(null,e.syncEngine),t}),bp.apply(this,arguments)}function Wg(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return function(s,a,h,f,m){const g=new Td({next:w=>{a.enqueueAndForget(()=>Gf(s,y));const S=w.docs.has(h);!S&&w.fromCache?m.reject(new V(x.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&w.fromCache&&f&&"server"===f.source?m.reject(new V(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new $f(Fi(h.path),g,{includeMetadataChanges:!0,J_:!0});return Bf(s,y)}(yield Da(n),n.asyncQueue,e,t,r)})),r.promise}function Hg(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return function(s,a,h,f,m){const g=new Td({next:w=>{a.enqueueAndForget(()=>Gf(s,y)),w.fromCache&&"server"===f.source?m.reject(new V(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(w)},error:w=>m.reject(w)}),y=new $f(h,g,{includeMetadataChanges:!0,J_:!0});return Bf(s,y)}(yield Da(n),n.asyncQueue,e,t,r)})),r.promise}function Qg(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const Yg=new Map;function Cp(n,e,t){if(!t)throw new V(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Xg(n,e,t,r){if(!0===e&&!0===r)throw new V(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Jg(n){if(!$.isDocumentKey(n))throw new V(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Zg(n){if($.isDocumentKey(n))throw new V(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function wd(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":Z()}function Ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wd(n);throw new V(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function e_(n,e){if(e<=0)throw new V(x.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class t_{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new V(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new V(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Xg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Qg(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new V(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wl{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new V(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new gh;switch(r.type){case"firstParty":return new Cc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Yg.get(t);r&&(M("ComponentProvider","Removing Datastore"),Yg.delete(t),r.terminate())}(this),Promise.resolve()}}class Lt{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Lt(this.firestore,e,this._query)}}class Ye{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ye(this.firestore,e,this._key)}}class kr extends Lt{constructor(e,t,r){super(e,t,Fi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new $(e))}withConverter(e){return new kr(this.firestore,e,this._path)}}function r_(n,e,...t){if(n=(0,Y.Ku)(n),Cp("collection","path",e),n instanceof wl){const r=Ae.fromString(e,...t);return Zg(r),new kr(n,null,r)}{if(!(n instanceof Ye||n instanceof kr))throw new V(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return Zg(r),new kr(n.firestore,null,r)}}function bd(n,e,...t){if(n=(0,Y.Ku)(n),1===arguments.length&&(e=Pc.newId()),Cp("doc","path",e),n instanceof wl){const r=Ae.fromString(e,...t);return Jg(r),new Ye(n,null,new $(r))}{if(!(n instanceof Ye||n instanceof kr))throw new V(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return Jg(r),new Ye(n.firestore,n instanceof kr?n.converter:null,new $(r))}}function i_(n,e){return n=(0,Y.Ku)(n),e=(0,Y.Ku)(e),(n instanceof Ye||n instanceof kr)&&(e instanceof Ye||e instanceof kr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Rp(n,e){return n=(0,Y.Ku)(n),e=(0,Y.Ku)(e),n instanceof Lt&&e instanceof Lt&&n.firestore===e.firestore&&C(n._query,e._query)&&n.converter===e.converter}class l0{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new If(this,"async_queue_retry"),this.iu=()=>{const t=yd();t&&M("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=yd();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=yd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new it;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,I.A)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(t){if(!br(t))throw t;M("AsyncQueue","Operation failed with retryable error: "+t)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,rt("INTERNAL UNHANDLED ERROR: ",function(a){let h=a.message||"";return a.stack&&(h=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),h}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Uf.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Z()}verifyOperationInProgress(){}uu(){var e=this;return(0,I.A)(function*(){let t;do{t=e.Ja,yield t}while(t!==e.Ja)})()}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Sp(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class u0{constructor(){this._progressObserver={},this._taskCompletionResolver=new it,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class We extends wl{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new l0,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||s_(this),this._firestoreClient.terminate()}}function at(n){return n._firestoreClient||s_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function s_(n){var e,t,r;const i=n._freezeSettings(),s=(f=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Oh(n._databaseId,f,n._persistenceKey,(g=i).host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Qg(g.experimentalLongPollingOptions),g.useFetchStreams));var f,g;n._firestoreClient=new Yv(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.localCache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function o_(n,e,t){const r=new it;return n.asyncQueue.enqueue((0,I.A)(function*(){try{yield Ed(n,t),yield vp(n,e),r.resolve()}catch(i){const s=i;if(!jg(s))throw s;St("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function a_(n){if(n._initialized||n._terminated)throw new V(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Or{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Or(lt.fromBase64String(e))}catch(t){throw new V(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Or(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ni{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new V(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ys{constructor(e){this._methodName=e}}class Cd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}}const T0=/^__.*__$/;class E0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Zr(e,this.data,this.fieldMask,t,this.fieldTransforms):new da(e,this.data,t,this.fieldTransforms)}}class c_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function l_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z()}}class Rd{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Rd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return xd(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(l_(this.Iu)&&T0.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class A0{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Tl(e)}pu(e,t,r,i=!1){return new Rd({Iu:e,methodName:t,gu:r,path:Ge.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xs(n){const e=n._freezeSettings(),t=Tl(n._databaseId);return new A0(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sd(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);kp("Data must be an object, but it was:",a,r);const h=h_(r,a);let f,m;if(s.merge)f=new qt(a.fieldMask),m=a.fieldTransforms;else if(s.mergeFields){const g=[];for(const y of s.mergeFields){const w=Rl(e,y,t);if(!a.contains(w))throw new V(x.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);p_(g,w)||g.push(w)}f=new qt(g),m=a.fieldTransforms.filter(y=>f.covers(y.field))}else f=null,m=a.fieldTransforms;return new E0(new Tt(h),f,m)}class Cl extends Ys{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cl}}function u_(n,e,t){return new Rd({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Pp extends Ys{_toFieldTransform(e){return new ol(e.path,new la)}isEqual(e){return e instanceof Pp}}class w0 extends Ys{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=u_(this,e,!0),r=this.yu.map(s=>Js(s,t)),i=new zs(r);return new ol(e.path,i)}isEqual(e){return this===e}}class b0 extends Ys{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=u_(this,e,!0),r=this.yu.map(s=>Js(s,t)),i=new Gs(r);return new ol(e.path,i)}isEqual(e){return this===e}}class C0 extends Ys{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new ua(e.serializer,nm(e.serializer,this.wu));return new ol(e.path,t)}isEqual(e){return this===e}}function xp(n,e,t,r){const i=n.pu(1,e,t);kp("Data must be an object, but it was:",i,r);const s=[],a=Tt.empty();Cr(r,(f,m)=>{const g=Pd(e,f,t);m=(0,Y.Ku)(m);const y=i.Ru(g);if(m instanceof Cl)s.push(g);else{const w=Js(m,y);null!=w&&(s.push(g),a.set(g,w))}});const h=new qt(s);return new c_(a,h,i.fieldTransforms)}function Dp(n,e,t,r,i,s){const a=n.pu(1,e,t),h=[Rl(e,r,t)],f=[i];if(s.length%2!=0)throw new V(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)h.push(Rl(e,s[w])),f.push(s[w+1]);const m=[],g=Tt.empty();for(let w=h.length-1;w>=0;--w)if(!p_(m,h[w])){const S=h[w];let U=f[w];U=(0,Y.Ku)(U);const G=a.Ru(S);if(U instanceof Cl)m.push(S);else{const B=Js(U,G);null!=B&&(m.push(S),g.set(S,B))}}const y=new qt(m);return new c_(g,y,a.fieldTransforms)}function d_(n,e,t,r=!1){return Js(t,n.pu(r?4:3,e))}function Js(n,e){if(f_(n=(0,Y.Ku)(n)))return kp("Unsupported field value:",e,n),h_(n,e);if(n instanceof Ys)return function(r,i){if(!l_(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const h of r){let f=Js(h,i.Vu(a));null==f&&(f={nullValue:"NULL_VALUE"}),s.push(f),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,Y.Ku)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return nm(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Fe.fromDate(r);return{timestampValue:fa(i.serializer,s)}}if(r instanceof Fe){const s=new Fe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fa(i.serializer,s)}}if(r instanceof Cd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Or)return{bytesValue:Am(i.serializer,r._byteString)};if(r instanceof Ye){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Wh(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${wd(r)}`)}(n,e)}function h_(n,e){const t={};return Wc(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cr(n,(r,i)=>{const s=Js(i,e.Eu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function f_(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Fe||n instanceof Cd||n instanceof Or||n instanceof Ye||n instanceof Ys)}function kp(n,e,t){if(!f_(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=wd(t);throw e.mu("an object"===r?n+" a custom object":n+" "+r)}var i}function Rl(n,e,t){if((e=(0,Y.Ku)(e))instanceof ni)return e._internalPath;if("string"==typeof e)return Pd(n,e);throw xd("Field path arguments must be of type string or ",n,!1,void 0,t)}const R0=new RegExp("[~\\*/\\[\\]]");function Pd(n,e,t){if(e.search(R0)>=0)throw xd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ni(...e.split("."))._internalPath}catch{throw xd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xd(n,e,t,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(s||a)&&(f+=" (found",s&&(f+=` in field ${r}`),a&&(f+=` in document ${i}`),f+=")"),new V(x.INVALID_ARGUMENT,h+n+f)}function p_(n,e){return n.some(t=>t.isEqual(e))}class Sl{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new S0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Dd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class S0 extends Sl{data(){return super.data()}}function Dd(n,e){return"string"==typeof e?Pd(n,e):e instanceof ni?e._internalPath:e._delegate._internalPath}function m_(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new V(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Op{}class Pl extends Op{}function Ki(n,e,...t){let r=[];e instanceof Op&&r.push(e),r=r.concat(t),function(s){const a=s.filter(f=>f instanceof ka).length,h=s.filter(f=>f instanceof xl).length;if(a>1||a>0&&h>0)throw new V(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class xl extends Pl{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new xl(e,t,r)}_apply(e){const t=this._parse(e);return v_(e._query,t),new Lt(e.firestore,e.converter,_(e._query,t))}_parse(e){const t=Xs(e.firestore);return function(s,a,h,f,m,g,y){let w;if(m.isKeyField()){if("array-contains"===g||"array-contains-any"===g)throw new V(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if("in"===g||"not-in"===g){y_(y,g);const S=[];for(const U of y)S.push(__(f,s,U));w={arrayValue:{values:S}}}else w=__(f,s,y)}else"in"!==g&&"not-in"!==g&&"array-contains-any"!==g||y_(y,g),w=d_(h,"where",y,"in"===g||"not-in"===g);return le.create(m,g,w)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class ka extends Op{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ka(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:Se.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let a=i;const h=s.getFlattenedFilters();for(const f of h)v_(a,f),a=_(a,f)}(e._query,t),new Lt(e.firestore,e.converter,_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Np extends Pl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Np(e,t)}_apply(e){const t=function(i,s,a){if(null!==i.startAt)throw new V(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new V(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fs(s,a)}(e._query,this._field,this._direction);return new Lt(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new or(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class kd extends Pl{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new kd(e,t,r)}_apply(e){return new Lt(e.firestore,e.converter,T(e._query,this._limit,this._limitType))}}class Od extends Pl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Od(e,t,r)}_apply(e){const t=g_(e,this.type,this._docOrFields,this._inclusive);return new Lt(e.firestore,e.converter,(s=t,new or((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class Nd extends Pl{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Nd(e,t,r)}_apply(e){const t=g_(e,this.type,this._docOrFields,this._inclusive);return new Lt(e.firestore,e.converter,(s=t,new or((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function g_(n,e,t,r){if(t[0]=(0,Y.Ku)(t[0]),t[0]instanceof Sl)return function(s,a,h,f,m){if(!f)throw new V(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const g=[];for(const y of c(s))if(y.field.isKeyField())g.push(Yr(a,f.key));else{const w=f.data.field(y.field);if(ea(w))throw new V(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===w){const S=y.field.canonicalString();throw new V(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}g.push(w)}return new Gn(g,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Xs(n.firestore);return function(a,h,f,m,g,y){const w=a.explicitOrderBy;if(g.length>w.length)throw new V(x.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let U=0;U<g.length;U++){const G=g[U];if(w[U].field.isKeyField()){if("string"!=typeof G)throw new V(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof G}`);if(!o(a)&&-1!==G.indexOf("/"))throw new V(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${G}' contains a slash.`);const B=a.path.child(Ae.fromString(G));if(!$.isDocumentKey(B))throw new V(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${B}' is not because it contains an odd number of segments.`);const ie=new $(B);S.push(Yr(h,ie))}else{const B=d_(f,m,G);S.push(B)}}return new Gn(S,y)}(n._query,n.firestore._databaseId,i,e,t,r)}}function __(n,e,t){if("string"==typeof(t=(0,Y.Ku)(t))){if(""===t)throw new V(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!o(e)&&-1!==t.indexOf("/"))throw new V(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ae.fromString(t));if(!$.isDocumentKey(r))throw new V(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Yr(n,new $(r))}if(t instanceof Ye)return Yr(n,t._key);throw new V(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wd(t)}.`)}function y_(n,e){if(!Array.isArray(n)||0===n.length)throw new V(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function v_(n,e){const t=function(i,s){for(const a of i)for(const h of a.getFlattenedFilters())if(s.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new V(x.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Vp{convertValue(e,t="none"){switch(xr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(En(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Cr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Cd(Ze(e.latitude),Ze(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ta(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ms(e));default:return null}}convertTimestamp(e){const t=Sr(e);return new Fe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ae.fromString(e);te(Om(r));const i=new Pr(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||rt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Vd(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class L0 extends Vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}}class Zs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ri extends Sl{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Dd("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Dl extends ri{data(e={}){return super.data(e)}}class Wi{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Dl(this._firestore,this._userDataWriter,r.key,r,new Zs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new V(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(h=>({type:"added",doc:new Dl(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Zs(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:a++}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(h=>s||3!==h.type).map(h=>{const f=new Dl(i._firestore,i._userDataWriter,h.doc.key,h.doc,new Zs(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,g=-1;return 0!==h.type&&(m=a.indexOf(h.doc.key),a=a.delete(h.doc.key)),1!==h.type&&(a=a.add(h.doc),g=a.indexOf(h.doc.key)),{type:U0(h.type),doc:f,oldIndex:m,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function U0(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z()}}function T_(n,e){return n instanceof ri&&e instanceof ri?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Wi&&e instanceof Wi&&n._firestore===e._firestore&&Rp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Hi extends Vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}}function E_(n,e,t){n=Ce(n,Ye);const r=Ce(n.firestore,We),i=Vd(n.converter,e,t);return Oa(r,[Sd(Xs(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,et.none())])}function A_(n,e,t,...r){n=Ce(n,Ye);const i=Ce(n.firestore,We),s=Xs(i);let a;return a="string"==typeof(e=(0,Y.Ku)(e))||e instanceof ni?Dp(s,"updateDoc",n._key,e,t,r):xp(s,"updateDoc",n._key,e),Oa(i,[a.toMutation(n._key,et.exists(!0))])}function w_(n,...e){var t,r,i;n=(0,Y.Ku)(n);let s={includeMetadataChanges:!1},a=0;"object"!=typeof e[a]||Sp(e[a])||(s=e[a],a++);const h={includeMetadataChanges:s.includeMetadataChanges};if(Sp(e[a])){const y=e[a];e[a]=null===(t=y.next)||void 0===t?void 0:t.bind(y),e[a+1]=null===(r=y.error)||void 0===r?void 0:r.bind(y),e[a+2]=null===(i=y.complete)||void 0===i?void 0:i.bind(y)}let f,m,g;if(n instanceof Ye)m=Ce(n.firestore,We),g=Fi(n._key.path),f={next:y=>{e[a]&&e[a](Mp(m,n,y))},error:e[a+1],complete:e[a+2]};else{const y=Ce(n,Lt);m=Ce(y.firestore,We),g=y._query;const w=new Hi(m);f={next:S=>{e[a]&&e[a](new Wi(m,w,y,S))},error:e[a+1],complete:e[a+2]},m_(n._query)}return function(w,S,U,G){const B=new Td(G),ie=new $f(S,B,U);return w.asyncQueue.enqueueAndForget((0,I.A)(function*(){return Bf(yield Da(w),ie)})),()=>{B.Na(),w.asyncQueue.enqueueAndForget((0,I.A)(function*(){return Gf(yield Da(w),ie)}))}}(at(m),g,h,f)}function Oa(n,e){return function(r,i){const s=new it;return r.asyncQueue.enqueueAndForget((0,I.A)(function*(){return function xv(n,e,t){return Yf.apply(this,arguments)}(yield wp(r),i,s)})),s.promise}(at(n),e)}function Mp(n,e,t){const r=t.docs.get(e._key),i=new Hi(n);return new ri(n,i,e._key,r,new Zs(t.hasPendingWrites,t.fromCache),e.converter)}const rI={maxAttempts:5};class b_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xs(e)}set(e,t,r){this._verifyNotCommitted();const i=Qi(e,this._firestore),s=Vd(i.converter,t,r),a=Sd(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(a.toMutation(i._key,et.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Qi(e,this._firestore);let a;return a="string"==typeof(t=(0,Y.Ku)(t))||t instanceof ni?Dp(this._dataReader,"WriteBatch.update",s._key,t,r,i):xp(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,et.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qi(e,this._firestore);return this._mutations=this._mutations.concat(new ha(t._key,et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new V(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qi(n,e){if((n=(0,Y.Ku)(n)).firestore!==e)throw new V(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class iI extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Xs(t)}get(t){const r=Qi(t,this._firestore),i=new L0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return Z();const a=s[0];if(a.isFoundDocument())return new Sl(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Sl(this._firestore,i,r._key,null,r.converter);throw Z()})}set(t,r,i){const s=Qi(t,this._firestore),a=Vd(s.converter,r,i),h=Sd(this._dataReader,"Transaction.set",s._key,a,null!==s.converter,i);return this._transaction.set(s._key,h),this}update(t,r,i,...s){const a=Qi(t,this._firestore);let h;return h="string"==typeof(r=(0,Y.Ku)(r))||r instanceof ni?Dp(this._dataReader,"Transaction.update",a._key,r,i,s):xp(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,h),this}delete(t){const r=Qi(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Qi(e,this._firestore),r=new Hi(this._firestore);return super.get(e).then(i=>new ri(this._firestore,r,t._key,i._document,new Zs(!1,!1),t.converter))}}function Fp(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new V("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function P_(){if(typeof Uint8Array>"u")throw new V("unimplemented","Uint8Arrays are not available in this environment.")}function x_(){if(!function kh(){return typeof atob<"u"}())throw new V("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){Ln=tn.SDK_VERSION,(0,tn._registerComponent)(new F.uA("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),h=new We(new _h(r.getProvider("auth-internal")),new Rc(r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new V(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pr(m.options.projectId,g)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),h._setSettings(s),h},"PUBLIC").setMultipleInstances(!0)),(0,tn.registerVersion)(Ru,"4.4.0",e),(0,tn.registerVersion)(Ru,"4.4.0","esm2017")}();class kl{constructor(e){this._delegate=e}static fromBase64String(e){return x_(),new kl(Or.fromBase64String(e))}static fromUint8Array(e){return P_(),new kl(Or.fromUint8Array(e))}toBase64(){return x_(),this._delegate.toBase64()}toUint8Array(){return P_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Up(n){return function pI(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class mI{enableIndexedDbPersistence(e,t){return function h0(n,e){a_(n=Ce(n,We));const t=at(n);if(t._uninitializedComponentsProvider)throw new V(x.FAILED_PRECONDITION,"SDK cache is already specified.");St("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Pa;return o_(t,i,new _p(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function f0(n){a_(n=Ce(n,We));const e=at(n);if(e._uninitializedComponentsProvider)throw new V(x.FAILED_PRECONDITION,"SDK cache is already specified.");St("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Pa;return o_(e,r,new zg(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function p0(n){if(n._initialized&&!n._terminated)throw new V(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new it;return n._queue.enqueueAndForgetEvenWhileRestricted((0,I.A)(function*(){try{yield(t=(0,I.A)(function*(i){if(!Tn.D())return Promise.resolve();const s=i+"main";yield Tn.delete(s)}),function r(i){return t.apply(this,arguments)})(lf(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class D_{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Pr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&St("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function n_(n,e,t,r={}){var i;const s=(n=Ce(n,wl))._getSettings(),a=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&St("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let h,f;if("string"==typeof r.mockUserToken)h=r.mockUserToken,f=ot.MOCK_USER;else{h=(0,Y.Fy)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new V(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new ot(m)}n._authCredentials=new xs(new Wo(h,f))}}(this._delegate,e,t,r)}enableNetwork(){return function g0(n){return function Xv(n){return n.asyncQueue.enqueue((0,I.A)(function*(){const e=yield qg(n),t=yield $g(n);return e.setNetworkEnabled(!0),function(i){const s=K(i);return s.C_.delete(0),El(s)}(t)}))}(at(n=Ce(n,We)))}(this._delegate)}disableNetwork(){return function _0(n){return function Jv(n){return n.asyncQueue.enqueue((0,I.A)(function*(){const e=yield qg(n),t=yield $g(n);return e.setNetworkEnabled(!1),(r=(0,I.A)(function*(s){const a=K(s);a.C_.add(0),yield Ta(a),a.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(at(n=Ce(n,We)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Xg("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function m0(n){return function(t){const r=new it;return t.asyncQueue.enqueueAndForget((0,I.A)(function*(){return function Nv(n,e){return tp.apply(this,arguments)}(yield wp(t),r)})),r.promise}(at(n=Ce(n,We)))}(this._delegate)}onSnapshotsInSync(e){return function H0(n,e){return function t0(n,e){const t=new Td(e);return n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return i=yield Da(n),s=t,K(i).q_.add(s),void s.next();var i,s})),()=>{t.Na(),n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return i=yield Da(n),s=t,void K(i).q_.delete(s);var i,s}))}}(at(n=Ce(n,We)),Sp(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new V("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Na(this,r_(this._delegate,e))}catch(t){throw Zt(t,"collection()","Firestore.collection()")}}doc(e){try{return new jn(this,bd(this._delegate,e))}catch(t){throw Zt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new en(this,function c0(n,e){if(n=Ce(n,wl),Cp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new V(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Lt(n,null,(r=e,new or(Ae.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw Zt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function sI(n,e,t){n=Ce(n,We);const r=Object.assign(Object.assign({},rI),t);return function(s){if(s.maxAttempts<1)throw new V(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,h){const f=new it;return s.asyncQueue.enqueueAndForget((0,I.A)(function*(){const m=yield function Kg(n){return Ad(n).then(e=>e.datastore)}(s);new Qv(s.asyncQueue,m,h,a,f).run()})),f.promise}(at(n),i=>e(new iI(n,i)),r)}(this._delegate,t=>e(new k_(this,t)))}batch(){return at(this._delegate),new O_(new b_(this._delegate,e=>Oa(this._delegate,e)))}loadBundle(e){return function y0(n,e){const t=at(n=Ce(n,We)),r=new u0;return function n0(n,e,t,r){const i=function(a,h){let f;return f="string"==typeof a?mm().encode(a):a,g=function(g,y){if(g instanceof Uint8Array)return Gg(g,y);if(g instanceof ArrayBuffer)return Gg(new Uint8Array(g),y);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),new Wv(g,h);var g}(t,Tl(e));n.asyncQueue.enqueueAndForget((0,I.A)(function*(){!function $v(n,e,t){const r=K(n);var i;(i=(0,I.A)(function*(a,h,f){try{const m=yield h.getMetadata();if(yield function(U,G){const B=K(U),ie=ut(G.createTime);return B.persistence.runTransaction("hasNewerBundle","readonly",oe=>B.Kr.getBundleMetadata(oe,G.id)).then(oe=>!!oe&&oe.createTime.compareTo(ie)>=0)}(a.localStore,m))return yield h.close(),f._completeWith({taskState:"Success",documentsLoaded:(U=m).totalDocuments,bytesLoaded:U.totalBytes,totalDocuments:U.totalDocuments,totalBytes:U.totalBytes}),Promise.resolve(new Set);f._updateProgress(kg(m));const g=new wv(m,a.localStore,h.serializer);let y=yield h.Ma();for(;y;){const S=yield g.ea(y);S&&f._updateProgress(S),y=yield h.Ma()}const w=yield g.complete();return yield ti(a,w.ra,void 0),yield function(U,G){const B=K(U);return B.persistence.runTransaction("Save bundle","readwrite",ie=>B.Kr.saveBundleMetadata(ie,G))}(a.localStore,m),f._completeWith(w.progress),Promise.resolve(w.na)}catch(m){return St("SyncEngine",`Loading bundle failed with ${m}`),f._failWith(m),Promise.resolve(new Set)}var U}),function s(a,h,f){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield wp(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function v0(n,e){return function r0(n,e){return n.asyncQueue.enqueue((0,I.A)(function*(){return function(r,i){const s=K(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(yield xa(n),e)}))}(at(n=Ce(n,We)),e).then(t=>t?new Lt(n,null,t.query):null)}(this._delegate,e).then(t=>t?new en(this,t):null)}}class Ld extends Vp{constructor(e){super(),this.firestore=e}convertBytes(e){return new kl(new Or(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return jn.forKey(t,this.firestore,null)}}class k_{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ld(e)}get(e){const t=to(e);return this._delegate.get(t).then(r=>new Ol(this._firestore,new ri(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=to(e);return r?(Fp("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=to(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=to(e);return this._delegate.delete(t),this}}class O_{constructor(e){this._delegate=e}set(e,t,r){const i=to(e);return r?(Fp("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=to(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=to(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class eo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Dl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Nl(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=eo.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new eo(e,new Ld(e),t),i.set(t,s)),s}}eo.INSTANCES=new WeakMap;class jn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ld(e)}static forPath(e,t,r){if(e.length%2!=0)throw new V("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jn(t,new Ye(t._delegate,r,new $(e)))}static forKey(e,t,r){return new jn(t,new Ye(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Na(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Na(this.firestore,r_(this._delegate,e))}catch(t){throw Zt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Y.Ku)(e))instanceof Ye&&i_(this._delegate,e)}set(e,t){t=Fp("DocumentReference.set",t);try{return t?E_(this._delegate,e,t):E_(this._delegate,e)}catch(r){throw Zt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?A_(this._delegate,e):A_(this._delegate,e,t,...r)}catch(i){throw Zt(i,"updateDoc()","DocumentReference.update()")}}delete(){return function K0(n){return Oa(Ce(n.firestore,We),[new ha(n._key,et.none())])}(this._delegate)}onSnapshot(...e){const t=N_(e),r=V_(e,i=>new Ol(this.firestore,new ri(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return w_(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function z0(n){n=Ce(n,Ye);const e=Ce(n.firestore,We),t=at(e),r=new Hi(e);return function Zv(n,e){const t=new it;return n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return(r=(0,I.A)(function*(s,a,h){try{const f=yield function(g,y){const w=K(g);return w.persistence.runTransaction("read document","readonly",S=>w.localDocuments.getDocument(S,y))}(s,a);f.isFoundDocument()?h.resolve(f):f.isNoDocument()?h.resolve(null):h.reject(new V(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(f){const m=wa(f,`Failed to get document '${a} from cache`);h.reject(m)}}),function i(s,a,h){return r.apply(this,arguments)})(yield xa(n),e,t);var r})),t.promise}(t,n._key).then(i=>new ri(e,r,n._key,i,new Zs(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function G0(n){n=Ce(n,Ye);const e=Ce(n.firestore,We);return Wg(at(e),n._key,{source:"server"}).then(t=>Mp(e,n,t))}(this._delegate):function B0(n){n=Ce(n,Ye);const e=Ce(n.firestore,We);return Wg(at(e),n._key).then(t=>Mp(e,n,t))}(this._delegate),t.then(r=>new Ol(this.firestore,new ri(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new jn(this.firestore,this._delegate.withConverter(e?eo.getInstance(this.firestore,e):null))}}function Zt(n,e,t){return n.message=n.message.replace(e,t),n}function N_(n){for(const e of n)if("object"==typeof e&&!Up(e))return e;return{}}function V_(n,e){var t,r;let i;return i=Up(n[0])?n[0]:Up(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Ol{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new jn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return T_(this._delegate,e._delegate)}}class Nl extends Ol{data(e){const t=this._delegate.data(e);return this._delegate._converter||function bc(n,e){n||Z()}(void 0!==t),t}}class en{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ld(e)}where(e,t,r){try{return new en(this.firestore,Ki(this._delegate,function P0(n,e,t){const r=e,i=Dd("where",n);return xl._create(i,r,t)}(e,t,r)))}catch(i){throw Zt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new en(this.firestore,Ki(this._delegate,function x0(n,e="asc"){const t=e,r=Dd("orderBy",n);return Np._create(r,t)}(e,t)))}catch(r){throw Zt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new en(this.firestore,Ki(this._delegate,function D0(n){return e_("limit",n),kd._create("limit",n,"F")}(e)))}catch(t){throw Zt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new en(this.firestore,Ki(this._delegate,function k0(n){return e_("limitToLast",n),kd._create("limitToLast",n,"L")}(e)))}catch(t){throw Zt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new en(this.firestore,Ki(this._delegate,function O0(...n){return Od._create("startAt",n,!0)}(...e)))}catch(t){throw Zt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new en(this.firestore,Ki(this._delegate,function N0(...n){return Od._create("startAfter",n,!1)}(...e)))}catch(t){throw Zt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new en(this.firestore,Ki(this._delegate,function V0(...n){return Nd._create("endBefore",n,!1)}(...e)))}catch(t){throw Zt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new en(this.firestore,Ki(this._delegate,function M0(...n){return Nd._create("endAt",n,!0)}(...e)))}catch(t){throw Zt(t,"endAt()","Query.endAt()")}}isEqual(e){return Rp(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function q0(n){n=Ce(n,Lt);const e=Ce(n.firestore,We),t=at(e),r=new Hi(e);return function e0(n,e){const t=new it;return n.asyncQueue.enqueueAndForget((0,I.A)(function*(){return(r=(0,I.A)(function*(s,a,h){try{const f=yield pd(s,a,!0),m=new Vg(a,f.ls),g=m.ca(f.documents),y=m.applyChanges(g,!1);h.resolve(y.snapshot)}catch(f){const m=wa(f,`Failed to execute query '${a} against cache`);h.reject(m)}}),function i(s,a,h){return r.apply(this,arguments)})(yield xa(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Wi(e,r,n,i))}(this._delegate):"server"===e?.source?function $0(n){n=Ce(n,Lt);const e=Ce(n.firestore,We),t=at(e),r=new Hi(e);return Hg(t,n._query,{source:"server"}).then(i=>new Wi(e,r,n,i))}(this._delegate):function j0(n){n=Ce(n,Lt);const e=Ce(n.firestore,We),t=at(e),r=new Hi(e);return m_(n._query),Hg(t,n._query).then(i=>new Wi(e,r,n,i))}(this._delegate),t.then(r=>new Bp(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=N_(e),r=V_(e,i=>new Bp(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return w_(this._delegate,t,r)}withConverter(e){return new en(this.firestore,this._delegate.withConverter(e?eo.getInstance(this.firestore,e):null))}}class _I{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Nl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Bp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new en(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Nl(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new _I(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Nl(this._firestore,r))})}isEqual(e){return T_(this._delegate,e._delegate)}}class Na extends en{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jn(this.firestore,e):null}doc(e){try{return new jn(this.firestore,void 0===e?bd(this._delegate):bd(this._delegate,e))}catch(t){throw Zt(t,"doc()","CollectionReference.doc()")}}add(e){return function W0(n,e){const t=Ce(n.firestore,We),r=bd(n),i=Vd(n.converter,e);return Oa(t,[Sd(Xs(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,et.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new jn(this.firestore,t))}isEqual(e){return i_(this._delegate,e._delegate)}withConverter(e){return new Na(this.firestore,this._delegate.withConverter(e?eo.getInstance(this.firestore,e):null))}}function to(n){return Ce(n,Ye)}class zp{constructor(...e){this._delegate=new ni(...e)}static documentId(){return new zp(Ge.keyField().canonicalString())}isEqual(e){return(e=(0,Y.Ku)(e))instanceof ni&&this._delegate._internalPath.isEqual(e._internalPath)}}class no{constructor(e){this._delegate=e}static serverTimestamp(){const e=function aI(){return new Pp("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new no(e)}static delete(){const e=function oI(){return new Cl("deleteField")}();return e._methodName="FieldValue.delete",new no(e)}static arrayUnion(...e){const t=function cI(...n){return new w0("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new no(t)}static arrayRemove(...e){const t=function lI(...n){return new b0("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new no(t)}static increment(e){const t=function uI(n){return new C0("increment",n)}(e);return t._methodName="FieldValue.increment",new no(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const yI={Firestore:D_,GeoPoint:Cd,Timestamp:Fe,Blob:kl,Transaction:k_,WriteBatch:O_,DocumentReference:jn,DocumentSnapshot:Ol,Query:en,QueryDocumentSnapshot:Nl,QuerySnapshot:Bp,CollectionReference:Na,FieldPath:zp,FieldValue:no,setLogLevel:function gI(n){!function mh(n){Gt.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function M_(n,e){return function TI(n,e=un.E){return new dr.c(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function Gp(n,e){return M_(n,e).pipe((0,ae.T)(t=>({payload:t,type:"query"})))}!function II(n){(function vI(n,e){n.INTERNAL.registerComponent(new F.uA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},yI)))})(n,(e,t)=>new D_(e,t,new mI)),n.registerVersion("@firebase/firestore-compat","0.3.23")}(Ft.A);class L_{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=j_(r,t);return new B_(i,s,this.afs)}snapshotChanges(){return function EI(n,e){return M_(n,e).pipe((0,ge.Z)(void 0),Dn(),(0,ae.T)(t=>{const[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ae.T)(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return(0,Ut.H)(this.ref.get(e)).pipe(_t)}}function Fd(n,e){return Gp(n,e).pipe((0,ge.Z)(void 0),Dn(),(0,ae.T)(t=>{const[r,i]=t,s=i.payload.docChanges(),a=s.map(h=>({type:h.type,payload:h}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((h,f)=>{const m=s.find(y=>y.doc.ref.isEqual(h.ref)),g=r?.payload.docs.find(y=>y.ref.isEqual(h.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(h.metadata)||!m&&g&&JSON.stringify(g.metadata)===JSON.stringify(h.metadata)||a.push({type:"modified",payload:{oldIndex:f,newIndex:f,type:"modified",doc:h}})}),a}))}function F_(n,e,t){return Fd(n,t).pipe((0,li.S)((r,i)=>function AI(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function wI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return jp(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return jp(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return jp(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),(0,D.F)(),(0,ae.T)(r=>r.map(i=>({type:i.type,payload:i}))))}function jp(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function U_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class B_{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Fd(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ae.T)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,ge.Z)(void 0),Dn(),(0,A.p)(([r,i])=>i.length>0||!r),(0,ae.T)(([,r])=>r),_t)}auditTrail(e){return this.stateChanges(e).pipe((0,li.S)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=U_(e);return F_(this.query,t,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return Gp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.T)(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),_t)}get(e){return(0,Ut.H)(this.query.get(e)).pipe(_t)}add(e){return this.ref.add(e)}doc(e){return new L_(this.ref.doc(e),this.afs)}}class bI{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Fd(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.T)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,A.p)(t=>t.length>0),_t):Fd(this.query,this.afs.schedulers.outsideAngular).pipe(_t)}auditTrail(e){return this.stateChanges(e).pipe((0,li.S)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=U_(e);return F_(this.query,t,this.afs.schedulers.outsideAngular).pipe(_t)}valueChanges(e={}){return Gp(this.query,this.afs.schedulers.outsideAngular).pipe((0,ae.T)(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),_t)}get(e){return(0,Ut.H)(this.query.get(e)).pipe(_t)}}const z_=new u.nKC("angularfire2.enableFirestorePersistence"),G_=new u.nKC("angularfire2.firestore.persistenceSettings"),CI=new u.nKC("angularfire2.firestore.settings"),RI=new u.nKC("angularfire2.firestore.use-emulator");function j_(n,e=(t=>t)){return{query:e(n),ref:n}}let q_=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,a,h,f,m,g,y,w,S,U,G,B,ie,oe){this.schedulers=f;const H=Kn(t,h,r),ue=g;y&&Nt(H,h,w,U,G,B,S,ie),[this.firestore,this.persistenceEnabled$]=ur(`${H.name}.firestore`,"AngularFirestore",H.name,()=>{const ye=h.runOutsideAngular(()=>H.firestore());if(s&&ye.settings(s),ue&&ye.useEmulator(...ue),i&&!(0,v.Vy)(a)){const Oe=()=>{try{return(0,Ut.H)(ye.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(dt){return typeof console<"u"&&console.warn(dt),(0,Hn.of)(!1)}};return[ye,h.runOutsideAngular(Oe)]}return[ye,(0,Hn.of)(!1)]},[s,ue,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:a}=j_(i,r),h=this.schedulers.ngZone.run(()=>s);return new B_(h,a,this)}collectionGroup(t,r){const i=r||(a=>a),s=this.firestore.collectionGroup(t);return new bI(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new L_(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(u.KVO(mn),u.KVO(gn,8),u.KVO(z_,8),u.KVO(CI,8),u.KVO(u.Agw),u.KVO(u.SKi),u.KVO(fn),u.KVO(G_,8),u.KVO(RI,8),u.KVO(He,8),u.KVO(b,8),u.KVO(O,8),u.KVO(P,8),u.KVO(X,8),u.KVO(he,8),u.KVO(ve,8),u.KVO(De,8))};static \u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),SI=(()=>{class n{constructor(){Ft.A.registerVersion("angularfire",cr.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:z_,useValue:!0},{provide:G_,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({providers:[q_]})}return n})(),$_=(()=>{class n{constructor(t){this.db=t,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(t){return this.puzzleDataRef.add({...t})}update(t,r){return this.puzzleDataRef.doc(t).update(r)}delete(t){return this.puzzleDataRef.doc(t).delete()}static#e=this.\u0275fac=function(r){return new(r||n)(u.KVO(q_))};static#t=this.\u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),K_=(()=>{class n{constructor(){this.subjectItemUpdate=new gt.B}updatePerformedItem(t){this.subjectItemUpdate.next(t)}getUpdatedStageLevel(){return this.subjectItemUpdate.asObservable()}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275prov=u.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ke=W(9969),Va=W(461);let qp=(()=>{class n extends Va.h{static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["CheckIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0),u.nrm(1,"path",1),u.k0s()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role))},encapsulation:2})}return n})();var ln=W(4420);let $p=(()=>{class n extends Va.h{pathId;ngOnInit(){this.pathId="url(#"+(0,ln._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0)(1,"g"),u.nrm(2,"path",1)(3,"path",2)(4,"path",3),u.k0s(),u.j41(5,"defs")(6,"clipPath",4),u.nrm(7,"rect",5),u.k0s()()()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),u.R7$(),u.BMQ("clip-path",i.pathId),u.R7$(5),u.Y8G("id",i.pathId))},encapsulation:2})}return n})(),Kp=(()=>{class n extends Va.h{pathId;ngOnInit(){this.pathId="url(#"+(0,ln._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["InfoCircleIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0)(1,"g"),u.nrm(2,"path",1),u.k0s(),u.j41(3,"defs")(4,"clipPath",2),u.nrm(5,"rect",3),u.k0s()()()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),u.R7$(),u.BMQ("clip-path",i.pathId),u.R7$(3),u.Y8G("id",i.pathId))},encapsulation:2})}return n})();var Vl=W(1512);let Wp=(()=>{class n extends Va.h{pathId;ngOnInit(){this.pathId="url(#"+(0,ln._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["TimesCircleIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0)(1,"g"),u.nrm(2,"path",1),u.k0s(),u.j41(3,"defs")(4,"clipPath",2),u.nrm(5,"rect",3),u.k0s()()()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),u.R7$(),u.BMQ("clip-path",i.pathId),u.R7$(3),u.Y8G("id",i.pathId))},encapsulation:2})}return n})();var Ml=W(563);const W_=["container"],PI=n=>[n,"p-toast-message"],xI=(n,e,t,r)=>({showTransformParams:n,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:r}),DI=n=>({value:"visible",params:n}),kI=n=>({$implicit:n});function OI(n,e){if(1&n&&u.nrm(0,"span"),2&n){const t=u.XpG(2);u.HbH("p-toast-message-icon pi "+t.message.icon)}}function NI(n,e){1&n&&u.nrm(0,"CheckIcon"),2&n&&u.BMQ("aria-hidden",!0)("data-pc-section","icon")}function VI(n,e){1&n&&u.nrm(0,"InfoCircleIcon"),2&n&&u.BMQ("aria-hidden",!0)("data-pc-section","icon")}function MI(n,e){1&n&&u.nrm(0,"TimesCircleIcon"),2&n&&u.BMQ("aria-hidden",!0)("data-pc-section","icon")}function LI(n,e){1&n&&u.nrm(0,"ExclamationTriangleIcon"),2&n&&u.BMQ("aria-hidden",!0)("data-pc-section","icon")}function FI(n,e){if(1&n&&(u.j41(0,"span",11),u.qex(1),u.DNE(2,NI,1,2,"CheckIcon",3)(3,VI,1,2,"InfoCircleIcon",3)(4,MI,1,2,"TimesCircleIcon",3)(5,LI,1,2,"ExclamationTriangleIcon",3),u.bVm(),u.k0s()),2&n){const t=u.XpG(2);u.BMQ("aria-hidden",!0)("data-pc-section","icon"),u.R7$(2),u.Y8G("ngIf","success"===t.message.severity),u.R7$(),u.Y8G("ngIf","info"===t.message.severity),u.R7$(),u.Y8G("ngIf","error"===t.message.severity),u.R7$(),u.Y8G("ngIf","warn"===t.message.severity)}}function UI(n,e){if(1&n&&(u.qex(0),u.DNE(1,OI,1,2,"span",6)(2,FI,6,6,"span",7),u.j41(3,"div",8)(4,"div",9),u.EFF(5),u.k0s(),u.j41(6,"div",10),u.EFF(7),u.k0s()(),u.bVm()),2&n){const t=u.XpG();u.R7$(),u.Y8G("ngIf",t.message.icon),u.R7$(),u.Y8G("ngIf",!t.message.icon),u.R7$(),u.BMQ("data-pc-section","text"),u.R7$(),u.BMQ("data-pc-section","summary"),u.R7$(),u.JRh(t.message.summary),u.R7$(),u.BMQ("data-pc-section","detail"),u.R7$(),u.JRh(t.message.detail)}}function BI(n,e){1&n&&u.eu8(0)}function zI(n,e){if(1&n&&u.nrm(0,"span"),2&n){const t=u.XpG(2);u.HbH("pt-1 text-base p-toast-message-icon pi "+t.message.closeIcon)}}function GI(n,e){1&n&&u.nrm(0,"TimesIcon",14),2&n&&(u.Y8G("styleClass","p-toast-icon-close-icon"),u.BMQ("aria-hidden",!0)("data-pc-section","closeicon"))}function jI(n,e){if(1&n){const t=u.RV6();u.j41(0,"button",12),u.bIt("click",function(i){u.eBV(t);const s=u.XpG();return u.Njj(s.onCloseIconClick(i))})("keydown.enter",function(i){u.eBV(t);const s=u.XpG();return u.Njj(s.onCloseIconClick(i))}),u.DNE(1,zI,1,2,"span",6)(2,GI,1,3,"TimesIcon",13),u.k0s()}if(2&n){const t=u.XpG();u.BMQ("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),u.R7$(),u.Y8G("ngIf",t.message.closeIcon),u.R7$(),u.Y8G("ngIf",!t.message.closeIcon)}}function qI(n,e){if(1&n){const t=u.RV6();u.j41(0,"p-toastItem",3),u.bIt("onClose",function(i){u.eBV(t);const s=u.XpG();return u.Njj(s.onMessageClose(i))})("@toastAnimation.start",function(i){u.eBV(t);const s=u.XpG();return u.Njj(s.onAnimationStart(i))})("@toastAnimation.done",function(i){u.eBV(t);const s=u.XpG();return u.Njj(s.onAnimationEnd(i))}),u.k0s()}if(2&n){const t=e.$implicit,r=e.index,i=u.XpG();u.Y8G("message",t)("index",r)("life",i.life)("template",i.template)("@toastAnimation",void 0)("showTransformOptions",i.showTransformOptions)("hideTransformOptions",i.hideTransformOptions)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}}let $I=(()=>{class n{zone;config;message;index;life;template;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new u.bkB;containerViewChild;timeout;constructor(t,r){this.zone=t,this.config=r}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick(t){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()}get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(r){return new(r||n)(u.rXU(u.SKi),u.rXU(ce.r1))};static \u0275cmp=u.VBU({type:n,selectors:[["p-toastItem"]],viewQuery:function(r,i){if(1&r&&u.GBs(W_,5),2&r){let s;u.mGM(s=u.lsd())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:"index",life:"life",template:"template",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},decls:6,vars:24,consts:[["container",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(r,i){if(1&r){const s=u.RV6();u.j41(0,"div",1,0),u.bIt("mouseenter",function(){return u.eBV(s),u.Njj(i.onMouseEnter())})("mouseleave",function(){return u.eBV(s),u.Njj(i.onMouseLeave())}),u.j41(2,"div",2),u.DNE(3,UI,8,7,"ng-container",3)(4,BI,1,0,"ng-container",4)(5,jI,3,4,"button",5),u.k0s()()}2&r&&(u.HbH(null==i.message?null:i.message.styleClass),u.Y8G("ngClass",u.eq3(13,PI,"p-toast-message-"+(null==i.message?null:i.message.severity)))("@messageState",u.eq3(20,DI,u.ziG(15,xI,i.showTransformOptions,i.hideTransformOptions,i.showTransitionOptions,i.hideTransitionOptions))),u.BMQ("id",null==i.message?null:i.message.id)("data-pc-name","toast")("data-pc-section","root"),u.R7$(2),u.Y8G("ngClass",null==i.message?null:i.message.contentStyleClass),u.BMQ("data-pc-section","content"),u.R7$(),u.Y8G("ngIf",!i.template),u.R7$(),u.Y8G("ngTemplateOutlet",i.template)("ngTemplateOutletContext",u.eq3(22,kI,i.message)),u.R7$(),u.Y8G("ngIf",!1!==(null==i.message?null:i.message.closable)))},dependencies:()=>[v.YU,v.bT,v.T3,Ml.n,qp,Kp,Wp,$p,Vl.A],encapsulation:2,data:{animation:[(0,ke.hZ)("messageState",[(0,ke.wk)("visible",(0,ke.iF)({transform:"translateY(0)",opacity:1})),(0,ke.kY)("void => *",[(0,ke.iF)({transform:"{{showTransformParams}}",opacity:0}),(0,ke.i0)("{{showTransitionParams}}")]),(0,ke.kY)("* => void",[(0,ke.i0)("{{hideTransitionParams}}",(0,ke.iF)({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return n})(),KI=(()=>{class n{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new u.bkB;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;_position="top-right";constructor(t,r,i,s,a){this.document=t,this.renderer=r,this.messageService=i,this.cd=s,this.config=a}styleElement;id=(0,ln._Y)();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){const r=t.filter(i=>this.canAdd(i));this.add(r)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let r=this.key===t.key;return r&&this.preventOpenDuplicates&&(r=!this.containsMessage(this.messages,t)),r&&this.preventDuplicates&&(r=!this.containsMessage(this.messagesArchieve,t)),r}containsMessage(t,r){return!!t&&null!=t.find(i=>i.summary===r.summary&&i.detail==r.detail&&i.severity===r.severity)}ngAfterContentInit(){this.templates?.forEach(t=>{t.getType(),this.template=t.template})}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){"void"===t.fromState&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&""===this.containerViewChild?.nativeElement.style.zIndex&&ln.Q$.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){"void"===t.toState&&this.autoZIndex&&ln.BF.isEmpty(this.messages)&&ln.Q$.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let r in this.breakpoints){let i="";for(let s in this.breakpoints[r])i+=s+":"+this.breakpoints[r][s]+" !important;";t+=`\n                    @media screen and (max-width: ${r}) {\n                        .p-toast[${this.id}] {\n                           ${i}\n                        }\n                    }\n                `}this.renderer.setProperty(this.styleElement,"innerHTML",t)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&ln.Q$.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(r){return new(r||n)(u.rXU(v.qQ),u.rXU(u.sFG),u.rXU(ce.bg),u.rXU(u.gRc),u.rXU(ce.r1))};static \u0275cmp=u.VBU({type:n,selectors:[["p-toast"]],contentQueries:function(r,i,s){if(1&r&&u.wni(s,ce.Ei,4),2&r){let a;u.mGM(a=u.lsd())&&(i.templates=a)}},viewQuery:function(r,i){if(1&r&&u.GBs(W_,5),2&r){let s;u.mGM(s=u.lsd())&&(i.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",life:"life",style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:"preventOpenDuplicates",preventDuplicates:"preventDuplicates",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(r,i){1&r&&(u.j41(0,"div",1,0),u.DNE(2,qI,1,9,"p-toastItem",2),u.k0s()),2&r&&(u.HbH(i.styleClass),u.Y8G("ngClass","p-toast-"+i._position)("ngStyle",i.style),u.R7$(2),u.Y8G("ngForOf",i.messages))},dependencies:[v.YU,v.Sq,v.B3,$I],styles:["@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}\n"],encapsulation:2,data:{animation:[(0,ke.hZ)("toastAnimation",[(0,ke.kY)(":enter, :leave",[(0,ke.P)("@*",(0,ke.MA)())])])]},changeDetection:0})}return n})(),WI=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({imports:[v.MD,Ml.Z,qp,Kp,Wp,$p,Vl.A,ce.Gg]})}return n})();var Xe=W(1455);let HI=(()=>{class n{el;pFocusTrapDisabled=!1;constructor(t){this.el=t}onkeydown(t){if(!0!==this.pFocusTrapDisabled){t.preventDefault();const r=Xe.D.getNextFocusableElement(this.el.nativeElement,t.shiftKey);r&&(r.focus(),r.select?.())}}static \u0275fac=function(r){return new(r||n)(u.rXU(u.aKT))};static \u0275dir=u.FsC({type:n,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(r,i){1&r&&u.bIt("keydown.tab",function(a){return i.onkeydown(a)})("keydown.shift.tab",function(a){return i.onkeydown(a)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}})}return n})(),QI=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({imports:[v.MD]})}return n})(),H_=(()=>{class n extends Va.h{pathId;ngOnInit(){this.pathId="url(#"+(0,ln._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0)(1,"g"),u.nrm(2,"path",1),u.k0s(),u.j41(3,"defs")(4,"clipPath",2),u.nrm(5,"rect",3),u.k0s()()()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),u.R7$(),u.BMQ("clip-path",i.pathId),u.R7$(3),u.Y8G("id",i.pathId))},encapsulation:2})}return n})(),Q_=(()=>{class n extends Va.h{pathId;ngOnInit(){this.pathId="url(#"+(0,ln._Y)()+")"}static \u0275fac=(()=>{let t;return function(i){return(t||(t=u.xGo(n)))(i||n)}})();static \u0275cmp=u.VBU({type:n,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[u.Vt3,u.aNF],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,i){1&r&&(u.qSk(),u.j41(0,"svg",0)(1,"g"),u.nrm(2,"path",1),u.k0s(),u.j41(3,"defs")(4,"clipPath",2),u.nrm(5,"rect",3),u.k0s()()()),2&r&&(u.HbH(i.getClassNames()),u.BMQ("aria-label",i.ariaLabel)("aria-hidden",i.ariaHidden)("role",i.role),u.R7$(),u.BMQ("clip-path",i.pathId),u.R7$(3),u.Y8G("id",i.pathId))},encapsulation:2})}return n})();const YI=["titlebar"],XI=["content"],JI=["footer"],ZI=["*",[["p-header"]],[["p-footer"]]],eT=["*","p-header","p-footer"],tT=(n,e,t,r,i,s,a,h,f,m)=>({"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":n,"p-dialog-mask-scrollblocker":e,"p-dialog-left":t,"p-dialog-right":r,"p-dialog-top":i,"p-dialog-top-left":s,"p-dialog-top-right":a,"p-dialog-bottom":h,"p-dialog-bottom-left":f,"p-dialog-bottom-right":m}),nT=(n,e,t,r)=>({"p-dialog p-component":!0,"p-dialog-rtl":n,"p-dialog-draggable":e,"p-dialog-resizable":t,"p-dialog-maximized":r}),rT=(n,e)=>({transform:n,transition:e}),iT=n=>({value:"visible",params:n}),sT=()=>({"p-dialog-header-icon p-dialog-header-maximize p-link":!0}),oT=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0});function aT(n,e){if(1&n){const t=u.RV6();u.j41(0,"div",13),u.bIt("mousedown",function(i){u.eBV(t);const s=u.XpG(3);return u.Njj(s.initResize(i))}),u.k0s()}}function cT(n,e){if(1&n&&(u.j41(0,"span",19),u.EFF(1),u.k0s()),2&n){const t=u.XpG(4);u.Y8G("id",t.getAriaLabelledBy()),u.R7$(),u.JRh(t.header)}}function lT(n,e){if(1&n&&(u.j41(0,"span",19),u.SdG(1,1),u.k0s()),2&n){const t=u.XpG(4);u.Y8G("id",t.getAriaLabelledBy())}}function uT(n,e){1&n&&u.eu8(0)}function dT(n,e){if(1&n&&u.nrm(0,"span",23),2&n){const t=u.XpG(5);u.Y8G("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function hT(n,e){1&n&&u.nrm(0,"WindowMaximizeIcon",25),2&n&&u.Y8G("styleClass","p-dialog-header-maximize-icon")}function fT(n,e){1&n&&u.nrm(0,"WindowMinimizeIcon",25),2&n&&u.Y8G("styleClass","p-dialog-header-maximize-icon")}function pT(n,e){if(1&n&&(u.qex(0),u.DNE(1,hT,1,1,"WindowMaximizeIcon",24)(2,fT,1,1,"WindowMinimizeIcon",24),u.bVm()),2&n){const t=u.XpG(5);u.R7$(),u.Y8G("ngIf",!t.maximized&&!t.maximizeIconTemplate),u.R7$(),u.Y8G("ngIf",t.maximized&&!t.minimizeIconTemplate)}}function mT(n,e){}function gT(n,e){1&n&&u.DNE(0,mT,0,0,"ng-template")}function _T(n,e){if(1&n&&(u.qex(0),u.DNE(1,gT,1,0,null,11),u.bVm()),2&n){const t=u.XpG(5);u.R7$(),u.Y8G("ngTemplateOutlet",t.maximizeIconTemplate)}}function yT(n,e){}function vT(n,e){1&n&&u.DNE(0,yT,0,0,"ng-template")}function IT(n,e){if(1&n&&(u.qex(0),u.DNE(1,vT,1,0,null,11),u.bVm()),2&n){const t=u.XpG(5);u.R7$(),u.Y8G("ngTemplateOutlet",t.minimizeIconTemplate)}}function TT(n,e){if(1&n){const t=u.RV6();u.j41(0,"button",20),u.bIt("click",function(){u.eBV(t);const i=u.XpG(4);return u.Njj(i.maximize())})("keydown.enter",function(){u.eBV(t);const i=u.XpG(4);return u.Njj(i.maximize())}),u.DNE(1,dT,1,1,"span",21)(2,pT,3,2,"ng-container",22)(3,_T,2,1,"ng-container",22)(4,IT,2,1,"ng-container",22),u.k0s()}if(2&n){const t=u.XpG(4);u.Y8G("ngClass",u.lJ4(5,sT)),u.R7$(),u.Y8G("ngIf",t.maximizeIcon&&!t.maximizeIconTemplate&&!t.minimizeIconTemplate),u.R7$(),u.Y8G("ngIf",!t.maximizeIcon),u.R7$(),u.Y8G("ngIf",!t.maximized),u.R7$(),u.Y8G("ngIf",t.maximized)}}function ET(n,e){if(1&n&&u.nrm(0,"span",28),2&n){const t=u.XpG(6);u.Y8G("ngClass",t.closeIcon)}}function AT(n,e){1&n&&u.nrm(0,"TimesIcon",25),2&n&&u.Y8G("styleClass","p-dialog-header-close-icon")}function wT(n,e){if(1&n&&(u.qex(0),u.DNE(1,ET,1,1,"span",27)(2,AT,1,1,"TimesIcon",24),u.bVm()),2&n){const t=u.XpG(5);u.R7$(),u.Y8G("ngIf",t.closeIcon),u.R7$(),u.Y8G("ngIf",!t.closeIcon)}}function bT(n,e){}function CT(n,e){1&n&&u.DNE(0,bT,0,0,"ng-template")}function RT(n,e){if(1&n&&(u.j41(0,"span"),u.DNE(1,CT,1,0,null,11),u.k0s()),2&n){const t=u.XpG(5);u.R7$(),u.Y8G("ngTemplateOutlet",t.closeIconTemplate)}}function ST(n,e){if(1&n){const t=u.RV6();u.j41(0,"button",26),u.bIt("click",function(i){u.eBV(t);const s=u.XpG(4);return u.Njj(s.close(i))})("keydown.enter",function(i){u.eBV(t);const s=u.XpG(4);return u.Njj(s.close(i))}),u.DNE(1,wT,3,2,"ng-container",22)(2,RT,2,1,"span",22),u.k0s()}if(2&n){const t=u.XpG(4);u.Y8G("ngClass",u.lJ4(5,oT)),u.BMQ("aria-label",t.closeAriaLabel)("tabindex",t.closeTabindex),u.R7$(),u.Y8G("ngIf",!t.closeIconTemplate),u.R7$(),u.Y8G("ngIf",t.closeIconTemplate)}}function PT(n,e){if(1&n){const t=u.RV6();u.j41(0,"div",14,2),u.bIt("mousedown",function(i){u.eBV(t);const s=u.XpG(3);return u.Njj(s.initDrag(i))}),u.DNE(2,cT,2,2,"span",15)(3,lT,2,1,"span",15)(4,uT,1,0,"ng-container",11),u.j41(5,"div",16),u.DNE(6,TT,5,6,"button",17)(7,ST,3,6,"button",18),u.k0s()()}if(2&n){const t=u.XpG(3);u.R7$(2),u.Y8G("ngIf",!t.headerFacet&&!t.headerTemplate),u.R7$(),u.Y8G("ngIf",t.headerFacet),u.R7$(),u.Y8G("ngTemplateOutlet",t.headerTemplate),u.R7$(2),u.Y8G("ngIf",t.maximizable),u.R7$(),u.Y8G("ngIf",t.closable)}}function xT(n,e){1&n&&u.eu8(0)}function DT(n,e){1&n&&u.eu8(0)}function kT(n,e){if(1&n&&(u.j41(0,"div",29,3),u.SdG(2,2),u.DNE(3,DT,1,0,"ng-container",11),u.k0s()),2&n){const t=u.XpG(3);u.R7$(3),u.Y8G("ngTemplateOutlet",t.footerTemplate)}}function OT(n,e){if(1&n){const t=u.RV6();u.j41(0,"div",7,0),u.bIt("@animation.start",function(i){u.eBV(t);const s=u.XpG(2);return u.Njj(s.onAnimationStart(i))})("@animation.done",function(i){u.eBV(t);const s=u.XpG(2);return u.Njj(s.onAnimationEnd(i))}),u.DNE(2,aT,1,0,"div",8)(3,PT,8,5,"div",9),u.j41(4,"div",10,1),u.SdG(6),u.DNE(7,xT,1,0,"ng-container",11),u.k0s(),u.DNE(8,kT,4,1,"div",12),u.k0s()}if(2&n){const t=u.XpG(2);u.HbH(t.styleClass),u.Y8G("ngClass",u.ziG(16,nT,t.rtl,t.draggable,t.resizable,t.maximized))("ngStyle",t.style)("pFocusTrapDisabled",!1===t.focusTrap)("@animation",u.eq3(24,iT,u.l_i(21,rT,t.transformOptions,t.transitionOptions))),u.BMQ("aria-labelledby",t.ariaLabelledBy)("aria-modal",!0),u.R7$(2),u.Y8G("ngIf",t.resizable),u.R7$(),u.Y8G("ngIf",t.showHeader),u.R7$(),u.HbH(t.contentStyleClass),u.Y8G("ngClass","p-dialog-content")("ngStyle",t.contentStyle),u.R7$(3),u.Y8G("ngTemplateOutlet",t.contentTemplate),u.R7$(),u.Y8G("ngIf",t.footerFacet||t.footerTemplate)}}function NT(n,e){if(1&n&&(u.j41(0,"div",5),u.DNE(1,OT,9,26,"div",6),u.k0s()),2&n){const t=u.XpG();u.HbH(t.maskStyleClass),u.Y8G("ngClass",u.zJS(4,tT,[t.modal,t.modal||t.blockScroll,"left"===t.position,"right"===t.position,"top"===t.position,"topleft"===t.position||"top-left"===t.position,"topright"===t.position||"top-right"===t.position,"bottom"===t.position,"bottomleft"===t.position||"bottom-left"===t.position,"bottomright"===t.position||"bottom-right"===t.position])),u.R7$(),u.Y8G("ngIf",t.visible)}}const VT=(0,ke.lY)([(0,ke.iF)({transform:"{{transform}}",opacity:0}),(0,ke.i0)("{{transition}}")]),MT=(0,ke.lY)([(0,ke.i0)("{{transition}}",(0,ke.iF)({transform:"{{transform}}",opacity:0}))]);let LT=(()=>{class n{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(t){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(t){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(t){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;showHeader=!0;get breakpoint(){return 649}set breakpoint(t){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="-1";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(t){t&&(this._style={...t},this.originalStyle=t)}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}onShow=new u.bkB;onHide=new u.bkB;visibleChange=new u.bkB;onResizeInit=new u.bkB;onResizeEnd=new u.bkB;onDragEnd=new u.bkB;onMaximize=new u.bkB;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy;documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=(0,ln._Y)();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;constructor(t,r,i,s,a,h,f){this.document=t,this.platformId=r,this.el=i,this.renderer=s,this.zone=a,this.cd=h,this.config=f,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":default:this.contentTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"maximizeicon":this.maximizeIconTemplate=t.template;break;case"minimizeicon":this.minimizeIconTemplate=t.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return null!==this.header?(0,ln._Y)()+"_header":null}focus(){let t=Xe.D.findSingle(this.container,"[autofocus]");t&&this.zone.runOutsideAngular(()=>{setTimeout(()=>t.focus(),5)})}close(t){this.visibleChange.emit(!1),t.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)})),this.modal&&Xe.D.blockBodyScroll()}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&Xe.D.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?Xe.D.blockBodyScroll():Xe.D.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(ln.Q$.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if((0,v.UE)(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let r in this.breakpoints)t+=`\n                        @media screen and (max-width: ${r}) {\n                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {\n                                width: ${this.breakpoints[r]} !important;\n                            }\n                        }\n                    `;this.renderer.setProperty(this.styleElement,"innerHTML",t)}}initDrag(t){Xe.D.hasClass(t.target,"p-dialog-header-icon")||Xe.D.hasClass(t.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,this.container.style.margin="0",Xe.D.addClass(this.document.body,"p-unselectable-text"))}onKeydown(t){if(this.focusTrap&&9===t.which){t.preventDefault();let r=Xe.D.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let i=r.indexOf(r[0].ownerDocument.activeElement);t.shiftKey?-1==i||0===i?r[r.length-1].focus():r[i-1].focus():-1==i||i===r.length-1?r[0].focus():r[i+1].focus()}else r[0].focus()}}onDrag(t){if(this.dragging){const r=Xe.D.getOuterWidth(this.container),i=Xe.D.getOuterHeight(this.container),s=t.pageX-this.lastPageX,a=t.pageY-this.lastPageY,h=this.container.getBoundingClientRect(),f=getComputedStyle(this.container),m=parseFloat(f.marginLeft),g=parseFloat(f.marginTop),y=h.left+s-m,w=h.top+a-g,S=Xe.D.getViewport();this.container.style.position="fixed",this.keepInViewport?(y>=this.minX&&y+r<S.width&&(this._style.left=`${y}px`,this.lastPageX=t.pageX,this.container.style.left=`${y}px`),w>=this.minY&&w+i<S.height&&(this._style.top=`${w}px`,this.lastPageY=t.pageY,this.container.style.top=`${w}px`)):(this.lastPageX=t.pageX,this.container.style.left=`${y}px`,this.lastPageY=t.pageY,this.container.style.top=`${w}px`)}}endDrag(t){this.dragging&&(this.dragging=!1,Xe.D.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(t))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(t){this.resizable&&(this.resizing=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,Xe.D.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(t))}onResize(t){if(this.resizing){let r=t.pageX-this.lastPageX,i=t.pageY-this.lastPageY,s=Xe.D.getOuterWidth(this.container),a=Xe.D.getOuterHeight(this.container),h=Xe.D.getOuterHeight(this.contentViewChild?.nativeElement),f=s+r,m=a+i,g=this.container.style.minWidth,y=this.container.style.minHeight,w=this.container.getBoundingClientRect(),S=Xe.D.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(f+=r,m+=i),(!g||f>parseInt(g))&&w.left+f<S.width&&(this._style.width=f+"px",this.container.style.width=this._style.width),(!y||m>parseInt(y))&&w.top+m<S.height&&(this.contentViewChild.nativeElement.style.height=h+m-a+"px",this._style.height&&(this._style.height=m+"px",this.container.style.height=this._style.height)),this.lastPageX=t.pageX,this.lastPageY=t.pageY}}resizeEnd(t){this.resizing&&(this.resizing=!1,Xe.D.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(t))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",r=>{27==r.which&&this.close(r)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?this.renderer.appendChild(this.document.body,this.wrapper):Xe.D.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&Xe.D.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&Xe.D.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(t){switch(t.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(Xe.D.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&Xe.D.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&ln.Q$.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?{...this.originalStyle}:{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(r){return new(r||n)(u.rXU(v.qQ),u.rXU(u.Agw),u.rXU(u.aKT),u.rXU(u.sFG),u.rXU(u.SKi),u.rXU(u.gRc),u.rXU(ce.r1))};static \u0275cmp=u.VBU({type:n,selectors:[["p-dialog"]],contentQueries:function(r,i,s){if(1&r&&(u.wni(s,ce.Y9,5),u.wni(s,ce.wi,5),u.wni(s,ce.Ei,4)),2&r){let a;u.mGM(a=u.lsd())&&(i.headerFacet=a.first),u.mGM(a=u.lsd())&&(i.footerFacet=a.first),u.mGM(a=u.lsd())&&(i.templates=a)}},viewQuery:function(r,i){if(1&r&&(u.GBs(YI,5),u.GBs(XI,5),u.GBs(JI,5)),2&r){let s;u.mGM(s=u.lsd())&&(i.headerViewChild=s.first),u.mGM(s=u.lsd())&&(i.contentViewChild=s.first),u.mGM(s=u.lsd())&&(i.footerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:eT,decls:1,vars:1,consts:[["container",""],["content",""],["titlebar",""],["footer",""],[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","tabindex","-1","pRipple","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"]],template:function(r,i){1&r&&(u.NAR(ZI),u.DNE(0,NT,2,15,"div",4)),2&r&&u.Y8G("ngIf",i.maskVisible)},dependencies:()=>[v.YU,v.bT,v.T3,v.B3,HI,Ml.n,Vl.A,H_,Q_],styles:["@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}\n"],encapsulation:2,data:{animation:[(0,ke.hZ)("animation",[(0,ke.kY)("void => visible",[(0,ke.sM)(VT)]),(0,ke.kY)("visible => void",[(0,ke.sM)(MT)])])]},changeDetection:0})}return n})(),FT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({imports:[v.MD,QI,Ml.Z,Vl.A,H_,Q_,ce.Gg]})}return n})();var Ud=W(6038);const UT=(n,e)=>({"stage-level-number-unselected":n,"stage-level-number-selected":e});function BT(n,e){if(1&n){const t=u.RV6();u.j41(0,"div",3),u.bIt("click",function(){u.eBV(t);const i=u.XpG();return u.Njj(i.stageClick())}),u.j41(1,"span",4),u.EFF(2),u.k0s()()}if(2&n){const t=u.XpG();u.R7$(2),u.SpI(" ",t.stageLevel.value," ")}}function zT(n,e){if(1&n&&(u.qex(0,5),u.EFF(1),u.bVm()),2&n){const t=u.XpG();u.R7$(),u.SpI(" ",t.stageLevel.value," ")}}function GT(n,e){1&n&&(u.j41(0,"span",6),u.nrm(1,"i",7),u.k0s())}function jT(n,e){if(1&n&&(u.j41(0,"div",2),u.Z7z(1,GT,2,0,"span",6,u.fX1),u.k0s()),2&n){const t=u.XpG();u.R7$(),u.Dyx(t.stars)}}function qT(n,e){1&n&&(u.j41(0,"span",8),u.nrm(1,"i",7),u.k0s())}function $T(n,e){if(1&n){const t=u.RV6();u.j41(0,"div",3),u.bIt("click",function(){u.eBV(t);const i=u.XpG(2);return u.Njj(i.stageClick())}),u.Z7z(1,qT,2,0,"span",8,u.fX1),u.k0s()}if(2&n){const t=u.XpG(2);u.R7$(),u.Dyx(t.stars)}}function KT(n,e){1&n&&(u.j41(0,"span",9),u.nrm(1,"i",10),u.k0s())}function WT(n,e){if(1&n&&u.Z7z(0,KT,2,0,"span",9,u.fX1),2&n){const t=u.XpG(2);u.Dyx(t.stars)}}function HT(n,e){if(1&n&&(u.j41(0,"div",2),u.DNE(1,$T,3,0,"div")(2,WT,2,0),u.k0s()),2&n){const t=u.XpG();u.R7$(),u.vxM(1,t.stageLevel.completed?1:2)}}let QT=(()=>{class n{constructor(t){this.stageCommunicationService=t,this.stars=new Array(1,2,3)}stageClick(){this.stageCommunicationService.updatePerformedItem(this.stageLevel),console.log("Stage Clicked")}static#e=this.\u0275fac=function(r){return new(r||n)(u.rXU(K_))};static#t=this.\u0275cmp=u.VBU({type:n,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:7,vars:6,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[2,"display","flex","justify-content","center"],[3,"click"],[1,"stage-level-completed-value","enable-stage-click"],[1,"disable-stage-click"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],[1,"stage-level-asterisk-unselected","stage-level-completed","enable-stage-click"],[1,"stage-level-asterisk-unselected","disable-stage-click"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(r,i){1&r&&(u.j41(0,"div",0)(1,"div",1),u.DNE(2,BT,3,1,"div")(3,zT,2,1),u.k0s(),u.j41(4,"div"),u.DNE(5,jT,3,0,"div",2)(6,HT,3,1),u.k0s()()),2&r&&(u.R7$(),u.Y8G("ngClass",u.l_i(3,UT,!i.stageLevel.selected,i.stageLevel.selected)),u.R7$(),u.vxM(2,i.stageLevel.completed?2:3),u.R7$(3),u.vxM(5,i.stageLevel.selected?5:6))},dependencies:[v.YU,Ud.PW],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .enable-stage-click[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.stage-level-layout[_ngcontent-%COMP%]   .disable-stage-click[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]})}return n})();const YT=(n,e)=>e.index,XT=n=>({"border-bottom":n});function JT(n,e){1&n&&(u.j41(0,"div")(1,"span",1),u.EFF(2,"No stage levels defined!"),u.k0s()())}function ZT(n,e){if(1&n&&(u.j41(0,"div",3),u.nrm(1,"app-stage-level",4),u.k0s()),2&n){const t=e.$implicit;u.Y8G("ngStyle",u.eq3(2,XT,t.selected?"none":"1px solid #d4d4d4")),u.R7$(),u.Y8G("stageLevel",t)}}function eE(n,e){if(1&n&&(u.j41(0,"div",2),u.Z7z(1,ZT,2,4,"div",3,YT),u.k0s()),2&n){const t=u.XpG();u.R7$(),u.Dyx(t.stageLevels)}}let tE=(()=>{class n{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=u.VBU({type:n,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:3,vars:1,consts:[[1,"game-stage-level-layout"],[1,"warning-message"],[1,"stage-levels"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(r,i){1&r&&(u.j41(0,"div",0),u.DNE(1,JT,3,0,"div")(2,eE,3,0),u.k0s()),2&r&&(u.R7$(),u.vxM(1,i.NO_STAGE_LEVELS?1:2))},dependencies:[v.B3,Ud.eI,QT],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]})}return n})();class Y_{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}}class X_{constructor(e,t,r){this.operands=e,this.operator=t,this.result=r}}const nE=(0,ke.hZ)("operandButtonAnimationMove",[(0,ke.wk)("buttonFromA",(0,ke.iF)({left:"{{ posALeft }}",top:"{{ posATop }}",width:"90px",height:"90px"}),{params:{posALeft:"1025px",posATop:"219px"}}),(0,ke.wk)("buttonToB",(0,ke.iF)({left:"{{ posBLeft }}",top:"{{ posBTop }}",width:"90px",height:"90px"}),{params:{posBLeft:"805px",posBTop:"324px"}}),(0,ke.kY)("* => buttonToB",(0,ke.i0)("1.5s"))]);var Hp=W(9213),rE=W(345);const J_=(n,e)=>e.id,iE=n=>({"background-color":n});function sE(n,e){if(1&n){const t=u.RV6();u.j41(0,"button",10),u.bIt("click",function(){const i=u.eBV(t).$implicit,s=u.XpG();return u.Njj(s.onOperandButtonClick(i))}),u.EFF(1),u.k0s()}if(2&n){const t=e.$implicit;u.Y8G("disabled",t.disabled)("ngStyle",u.eq3(4,iE,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",t.disabled||t.selected?"operator-content-button-disabled":"operator-content-button"),u.R7$(),u.SpI("",t.value," ")}}function oE(n,e){if(1&n){const t=u.RV6();u.j41(0,"button",11),u.bIt("click",function(){const i=u.eBV(t).$implicit,s=u.XpG();return u.Njj(s.onOperatorButtonClick(i))}),u.nrm(1,"mat-icon",12),u.k0s()}if(2&n){const t=e.$implicit;u.Y8G("ngClass",0===e.$index?"revert-button":"arithmetic-operation-button"),u.R7$(),u.FS9("svgIcon",t.icon)}}let aE=(()=>{class n{constructor(t,r){this.githubLogoPath="assets/logos/GitHub-Mark-32px.png",this.operators=new Array({id:0,selected:!1,caption:Ie.OPERATOR_REV,operator:Ie.OPERATOR_REV,icon:"revert"},{id:1,selected:!1,caption:Ie.OPERATOR_ADD,operator:Ie.OPERATOR_ADD,icon:"addition"},{id:2,selected:!1,caption:Ie.OPERATOR_SUB,operator:Ie.OPERATOR_SUB,icon:"substraction"},{id:3,selected:!1,caption:Ie.OPERATOR_MUL,operator:Ie.OPERATOR_MUL,icon:"multiplication"},{id:4,selected:!1,caption:Ie.OPERATOR_DIV,operator:Ie.OPERATOR_DIV,icon:"division"}),this.expectedResultReached=new u.bkB,this.invalidOperationExecuted=new u.bkB,t.addSvgIcon("revert",r.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),t.addSvgIcon("addition",r.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),t.addSvgIcon("substraction",r.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),t.addSvgIcon("multiplication",r.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),t.addSvgIcon("division",r.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(t=>t.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(t=>{t.selected=!1})}isTheExpectedResultReached(t){return this.gameParameters.result===t}addStateToHistory(t){this.history.push(t)}clearSelectionOfOperators(){this.operators.forEach(t=>{t.selected=!1})}addGameOperationToOperationHistory(t){this.operationHistory?.push(t)}captureAnimationTriggerStartEvent(t){console.log("Animation trigger start ",t)}captureAnimationTriggerDoneEvent(t){console.log("Animation trigger done ",t)}ngOnInit(){this.history=new Y_,this.operationHistory=new Y_}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(t=>{t.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(t){if(t.selected=!t.selected,!t.selected){if(this.selectedOperandB&&this.selectedOperandB.id===t.id)return this.selectedOperandB.selected=!1,void(this.selectedOperandB=null);if(this.selectedOperandA&&this.selectedOperandA.id===t.id)return this.selectedOperandA.selected=!1,void(this.selectedOperandA=null)}this.selectedOperandA?this.selectedOperandA.id!==t.id&&(this.selectedOperandB||(this.selectedOperandB=t)):this.selectedOperandA=t;var r=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!r)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&r){const i=wt.cloneGameParameters(this.gameParameters),s=wt.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,r.operator);if(this.addStateToHistory(i),s===Number.MIN_VALUE)this.invalidOperationExecuted.emit(s);else{const a=new Array(this.selectedOperandA.value,this.selectedOperandB.value),h=new X_(a,r.operator,s);this.addGameOperationToOperationHistory(h),this.isTheExpectedResultReached(s)&&this.expectedResultReached.emit(this.operationHistory),t.value=s,this.gameParameters.operands.find(m=>m.id==this.selectedOperandA.id).disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${t.value} Selected ${t.selected}`)}onOperatorButtonClick(t){if(this.selectedOperandA||t.operator===Ie.OPERATOR_REV){if(t.selected=!t.selected,t.operator===Ie.OPERATOR_REV){this.revertLastOperation();const r=wt.cloneGameParameters(this.gameParameters),i=new Array;r.operands.forEach(a=>{i.push(a.value)});const s=new X_(i,t.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(s)}console.log(`Caption ${t.caption} Selected ${t.selected}`)}else t.selected=!1}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}static#e=this.\u0275fac=function(r){return new(r||n)(u.rXU(Hp.tp),u.rXU(rE.up))};static#t=this.\u0275cmp=u.VBU({type:n,selectors:[["app-game-arithmetic-operations"]],hostVars:1,hostBindings:function(r,i){1&r&&u.Kam("@operandButtonAnimationMove.start",function(a){return i.captureAnimationTriggerStartEvent(a)})("@operandButtonAnimationMove.done",function(a){return i.captureAnimationTriggerDoneEvent(a)}),2&r&&u.zvX("@operandButtonAnimationMove",i.operandButtonAnimation)},inputs:{gameParameters:"gameParameters"},outputs:{expectedResultReached:"expectedResultReached",invalidOperationExecuted:"invalidOperationExecuted"},decls:15,vars:2,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass"],[1,"operators-container"],["type","button",1,"operator-content",3,"ngClass"],["href","https://github.com/lkovari/LKovariHome/tree/master/src/app/digits/digits-game.component.ts"],["width","16","height","16",3,"src"],["type","button",1,"operand",3,"click","disabled","ngStyle","ngClass"],["type","button",1,"operator-content",3,"click","ngClass"],[1,"operator-content-icon",3,"svgIcon"]],template:function(r,i){1&r&&(u.j41(0,"div",0)(1,"div",1),u.EFF(2,"Use the any combination of number to reach the target:"),u.k0s(),u.j41(3,"div")(4,"label",2),u.EFF(5),u.k0s()(),u.j41(6,"div",3)(7,"div",4),u.Z7z(8,sE,2,6,"button",5,J_),u.k0s()(),u.j41(10,"div",6),u.Z7z(11,oE,2,2,"button",7,J_),u.k0s(),u.j41(13,"a",8),u.nrm(14,"img",9),u.k0s()()),2&r&&(u.R7$(5),u.JRh(i.gameParameters.result),u.R7$(3),u.Dyx(i.gameParameters.operands),u.R7$(3),u.Dyx(i.operators),u.R7$(3),u.Y8G("src",i.githubLogoPath,u.B4B))},dependencies:[v.YU,v.B3,Ud.PW,Ud.eI,Hp.An],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{justify-content:center;display:flex;flex-direction:row;flex-wrap:wrap;width:371px;margin:7px auto}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"],data:{animation:[nE]}})}return n})();const cE=["arithmeticOperations"];function lE(n,e){if(1&n&&(u.j41(0,"li",13),u.EFF(1),u.k0s()),2&n){const t=e.$implicit;u.R7$(),u.SpI(" ",t," ")}}function uE(n,e){if(1&n&&(u.j41(0,"li",13),u.EFF(1),u.k0s()),2&n){const t=e.$implicit;u.R7$(),u.SpI(" ",t," ")}}const dE=[{path:"digits/digits-game",component:(()=>{class n{constructor(t,r,i,s,a){this.messageService=t,this.cookieService=r,this.clipboardService=i,this.numbersFirestoreService=s,this.stageCommunicationService=a,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new L,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw",this.destroyRef=(0,u.WQX)(u.abz),this.updateStageLevel=this.stageCommunicationService.getUpdatedStageLevel().pipe((0,Te.pQ)(this.destroyRef)).subscribe({next:h=>{console.log("StageLevel updated "+h.index)},error:h=>console.error("StageLevel updated "+h),complete:()=>console.info("StageLevel updated Complete")})}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(t){let r="Completed! Executed Operations:\n",i=t.size()-1;for(;i>=0;){const s=t.peekBy(i);r+=i+1+". "+s?.operands[0]+" "+s?.operator+" "+s?.operands[1]+" = "+s?.result+"\n",--i}return r}createSummaryOfTHeOperations(t,r){let i=this.stageLevels[t].value+" -> ";for(this.gameCompletedModalMessages=[];r.size()>0;){const s=r.pop();this.gameCompletedModalMessages.push(s?.operands[0]+" "+s.operator+" "+s?.operands[1]+" = "+s?.result),i+=""+s?.operator}return i+="\n",i}showSuccessMessage(t){this.messageService.add({severity:"success",summary:"Congratulation!",detail:t})}showErrorMessage(t){this.messageService.add({severity:"error",summary:"Error!",detail:t})}setupStages(){let t=0;this.gameParameters.forEach(r=>{this.stageLevels[t].value=r.result,++t})}storeGameStateToCookie(){const t=new j;t.storeDate=new Date,t.stageIndex=this.stageIndex,t.stageLevels=this.stageLevels,t.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,t.gameParameters=this.gameParameters;const r=t.cookieData2Text(),i=new Date;i.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,r,i)}restoreGameStateFromCookie(){const t=this.cookieService.get(this.COOKIE_LK_DIGITS);let r;return t&&""!=t?(r=new j,r=r.text2CookieData(t)):(console.log("INFO: Unable to retrieve the Game State"),r=null),r}mapPuzzleDataToGameParameters(t){t.stages.forEach(r=>{const i=this.gameParameters.find(s=>s.stageIndex===r.stageIndex);if(i){i.result=r.expectedValue;let s=0;i.operands.forEach(h=>{h.value=r.operands[s],s++}),this.initializeStageLevels(),this.stageLevels.find(h=>h.index===r.stageIndex)}})}mapGameParametersToPuzzleData(t){const r=new Ne;return r.day=new Date,r.day.setHours(23,59,59,999),t.forEach(i=>{const s=new kt;s.stageIndex=i.stageIndex,s.expectedValue=i.result;const a=new Array;i.operands.forEach(h=>{a.push(h.value)}),s.operands=a,r.stages.push(s)}),r}isDateSame(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}updatePuzzleDataInDb(t){this.firestorePuzzleData.data=JSON.stringify(t),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(r=>console.log(r))}createPuzzleDataInDb(t){this.numbersFirestoreService.create(t).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){const t=navigator.language;return void 0!==this.firestorePuzzleDataItems.find(i=>i.locale===t)}upsertGameDataInDb(t){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(t);else{const r=new Le;r.locale=navigator.language,r.data=JSON.stringify(t),this.createPuzzleDataInDb(r)}}allGameCompleted(){let t=!0;return this.stageLevels.forEach(r=>{t=t&&r.completed}),t}collectAllOperations(){const t=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(t){let r="Genius!\n";this.allGameCompletedModalMessage=[],this.stageLevels.forEach(i=>{r+=i.summary,this.allGameCompletedModalMessage.push(i.summary)}),this.clipboardService.copy(r),this.storeGameStateToCookie(),this.allGameCompletedModalVisible=!0}return t}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const t=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(t)}ngOnInit(){console.log(`Browser locale: ${navigator.language}`),this.initializeStageLevels();const t=this.restoreGameStateFromCookie();if(t){console.log("INFO: Game state restored from cookie");const r=new Date(t.storeDate);if(this.isDateSame(r,new Date))this.stageIndex=t.stageIndex,this.stageLevels=t.stageLevels,this.gameParameters=t.gameParameters,this.setupStages(),t.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const i=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+i),this.upsertGameDataInDb(i)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();const r=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe((0,ae.T)(i=>i.map(s=>({id:s.payload.doc.id,...s.payload.doc.data()})))).subscribe(i=>{this.firestorePuzzleDataItems=i;const s=i.find(a=>a.locale===r);if(s){this.firestorePuzzleData=s,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");const a=new Date,h=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(h,a))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const f=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(f)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();const a=this.mapGameParametersToPuzzleData(this.gameParameters),h=new Le;h.locale=navigator.language,h.data=JSON.stringify(a),this.createPuzzleDataInDb(h)}})}}ngOnDestroy(){this.updateStageLevel.unsubscribe()}expectedResultReached(t){const r=this.formatOperations(t),i=this.createSummaryOfTHeOperations(this.stageIndex,t);this.stageLevels[this.stageIndex].summary=i,this.clipboardService.copy(r),this.showSuccessMessage("You are reach the expected result!"),this.stageToCompleted(),this.reachedValue=this.gameParameters[this.stageIndex].result,this.gameCompletedModalVisible=!0}hideGameCompletedDialog(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}invalidOperationExecuted(t){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(t)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}static#e=this.\u0275fac=function(r){return new(r||n)(u.rXU(ce.bg),u.rXU(re),u.rXU(Ht),u.rXU($_),u.rXU(K_))};static#t=this.\u0275cmp=u.VBU({type:n,selectors:[["app-digits-game"]],viewQuery:function(r,i){if(1&r&&u.GBs(cE,7),2&r){let s;u.mGM(s=u.lsd())&&(i.arithmeticComponent=s.first)}},features:[u.Jv_([ce.bg,re])],decls:31,vars:14,consts:[["arithmeticOperations",""],[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"expectedResultReached","invalidOperationExecuted","gameParameters"],["id","splashscreen","header","Welcome to the Numbers Puzzle Game",3,"visibleChange","visible","modal"],["id","gameCompleted","header","Game Completed",3,"visibleChange","onHide","visible","modal"],[1,"li-no-bullet"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visibleChange","visible","modal","closable"]],template:function(r,i){if(1&r){const s=u.RV6();u.j41(0,"div",1),u.nrm(1,"p-toast",2),u.j41(2,"div",3),u.EFF(3," This is a daily numbers puzzle, similar to the "),u.j41(4,"a",4),u.EFF(5,"NY Times Digits"),u.k0s(),u.EFF(6,", which unfortunately discontinued at August 8, 2023 "),u.k0s(),u.j41(7,"div",5)(8,"div",6),u.bIt("click",function(){return u.eBV(s),u.Njj(i.onDeleteCookie())}),u.EFF(9," Numbers "),u.k0s(),u.j41(10,"div",7),u.bIt("click",function(){return u.eBV(s),u.Njj(i.onUpdatePuzzleData())}),u.EFF(11),u.nI1(12,"date"),u.k0s()(),u.j41(13,"div",8),u.nrm(14,"app-game-stage-levels",9),u.k0s(),u.j41(15,"div")(16,"app-game-arithmetic-operations",10,0),u.bIt("expectedResultReached",function(h){return u.eBV(s),u.Njj(i.expectedResultReached(h))})("invalidOperationExecuted",function(h){return u.eBV(s),u.Njj(i.invalidOperationExecuted(h))}),u.k0s()()(),u.j41(18,"p-dialog",11),u.mxI("visibleChange",function(h){return u.eBV(s),u.DH7(i.splashVisible,h)||(i.splashVisible=h),u.Njj(h)}),u.j41(19,"p"),u.EFF(20,"It can improves your arithmetic combination ability."),u.k0s()(),u.j41(21,"p-dialog",12),u.mxI("visibleChange",function(h){return u.eBV(s),u.DH7(i.gameCompletedModalVisible,h)||(i.gameCompletedModalVisible=h),u.Njj(h)}),u.bIt("onHide",function(){return u.eBV(s),u.Njj(i.hideGameCompletedDialog())}),u.j41(22,"div"),u.EFF(23),u.Z7z(24,lE,2,1,"li",13,u.fX1),u.k0s()(),u.j41(26,"p-dialog",14),u.mxI("visibleChange",function(h){return u.eBV(s),u.DH7(i.allGameCompletedModalVisible,h)||(i.allGameCompletedModalVisible=h),u.Njj(h)}),u.j41(27,"div"),u.EFF(28," Congratulation! Your Solutions: "),u.Z7z(29,uE,2,1,"li",13,u.fX1),u.k0s()()}2&r&&(u.R7$(11),u.SpI(" ",u.i5U(12,11,i.currentDate,"MM/dd/yyyy")," "),u.R7$(3),u.Y8G("stageLevels",i.stageLevels),u.R7$(2),u.Y8G("gameParameters",i.gameParameters[i.stageIndex]),u.R7$(2),u.R50("visible",i.splashVisible),u.Y8G("modal",!0),u.R7$(3),u.R50("visible",i.gameCompletedModalVisible),u.Y8G("modal",!0),u.R7$(2),u.SpI(" Target ",i.reachedValue,". Your solution: "),u.R7$(),u.Dyx(i.gameCompletedModalMessages),u.R7$(2),u.R50("visible",i.allGameCompletedModalVisible),u.Y8G("modal",!0)("closable",!1),u.R7$(3),u.Dyx(i.allGameCompletedModalMessage))},dependencies:[KI,LT,tE,aE,v.vh],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:50vw;position:absolute;inset:0;margin:auto;background:#ebf9fd40;border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:90vh;width:99vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}.digits-game-layout[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]})}return n})()}];let hE=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=u.$C({type:n});static#n=this.\u0275inj=u.G2t({imports:[v.MD,fe.iI.forChild(dE),fe.iI]})}return n})();var fE=W(6924);let DE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=u.$C({type:n});static \u0275inj=u.G2t({imports:[v.MD,Ml.Z,qp,Kp,Wp,$p,Vl.A]})}return n})();var kE=W(5312);let OE=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=u.$C({type:n});static#n=this.\u0275inj=u.G2t({providers:[$_],imports:[v.MD,fe.iI,WI,DE,hE,fE.YF,Hp.m_,qe,Wn.initializeApp(kE.c.firebasePuzzleData),SI,FT]})}return n})()},3345:(ro,Wt,W)=>{W.d(Wt,{A:()=>kt});var v=W(1076),fe=W(1362),u=W(7852),ce=W(8041);class Ie{constructor(Te,we){this._delegate=Te,this.firebase=we,(0,u._addComponent)(Te,new fe.uA("app-compat",()=>this,"PUBLIC")),this.container=Te.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Te){this._delegate.automaticDataCollectionEnabled=Te}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Te=>{this._delegate.checkDestroyed(),Te()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,u.deleteApp)(this._delegate)))}_getService(Te,we=u._DEFAULT_ENTRY_NAME){var gt;this._delegate.checkDestroyed();const Ht=this._delegate.container.getProvider(Te);return!Ht.isInitialized()&&"EXPLICIT"===(null===(gt=Ht.getComponent())||void 0===gt?void 0:gt.instantiationMode)&&Ht.initialize(),Ht.getImmediate({identifier:we})}_removeServiceInstance(Te,we=u._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Te).clearInstance(we)}_addComponent(Te){(0,u._addComponent)(this._delegate,Te)}_addOrOverwriteComponent(Te){(0,u._addOrOverwriteComponent)(this._delegate,Te)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const At=new v.FA("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),L=function je(){const Le=function wt(Le){const Te={},we={__esModule:!0,initializeApp:function bt(be,Ct={}){const N=u.initializeApp(be,Ct);if((0,v.gR)(Te,N.name))return Te[N.name];const tt=new Le(N,we);return Te[N.name]=tt,tt},app:Ht,registerVersion:u.registerVersion,setLogLevel:u.setLogLevel,onLog:u.onLog,apps:null,SDK_VERSION:u.SDK_VERSION,INTERNAL:{registerComponent:function qe(be){const Ct=be.name,N=Ct.replace("-compat","");if(u._registerComponent(be)&&"PUBLIC"===be.type){const tt=(st=Ht())=>{if("function"!=typeof st[N])throw At.create("invalid-app-argument",{appName:Ct});return st[N]()};void 0!==be.serviceProps&&(0,v.zw)(tt,be.serviceProps),we[N]=tt,Le.prototype[N]=function(...st){return this._getService.bind(this,Ct).apply(this,be.multipleInstances?st:[])}}return"PUBLIC"===be.type?we[N]:null},removeApp:function gt(be){delete Te[be]},useAsService:function tn(be,Ct){return"serverAuth"===Ct?null:Ct},modularAPIs:u}};function Ht(be){if(!(0,v.gR)(Te,be=be||u._DEFAULT_ENTRY_NAME))throw At.create("no-app",{appName:be});return Te[be]}return we.default=we,Object.defineProperty(we,"apps",{get:function ze(){return Object.keys(Te).map(be=>Te[be])}}),Ht.App=Le,we}(Ie);return Le.INTERNAL=Object.assign(Object.assign({},Le.INTERNAL),{createFirebaseNamespace:je,extendNamespace:function Te(we){(0,v.zw)(Le,we)},createSubscribe:v.tD,ErrorFactory:v.FA,deepExtend:v.zw}),Le}(),j=new ce.Vy("@firebase/app-compat");if((0,v.Bd)()&&void 0!==self.firebase){j.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Le=self.firebase.SDK_VERSION;Le&&Le.indexOf("LITE")>=0&&j.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const kt=L;!function Ne(Le){(0,u.registerVersion)("@firebase/app-compat","0.2.25",Le)}()},7852:(ro,Wt,W)=>{W.r(Wt),W.d(Wt,{FirebaseError:()=>ce.g,SDK_VERSION:()=>Lr,_DEFAULT_ENTRY_NAME:()=>pn,_addComponent:()=>mn,_addOrOverwriteComponent:()=>gn,_apps:()=>Qt,_clearComponents:()=>Wn,_components:()=>xn,_getProvider:()=>lr,_registerComponent:()=>Kn,_removeServiceInstance:()=>ai,deleteApp:()=>Ut,getApp:()=>Hn,getApps:()=>dr,initializeApp:()=>co,onLog:()=>Fr,registerVersion:()=>Ot,setLogLevel:()=>lo});var v=W(467),fe=W(1362),u=W(8041),ce=W(1076);const Ie=(D,I)=>I.some(F=>D instanceof F);let Et,At;const L=new WeakMap,j=new WeakMap,re=new WeakMap,ae=new WeakMap,Ne=new WeakMap;let Te={get(D,I,F){if(D instanceof IDBTransaction){if("done"===I)return j.get(D);if("objectStoreNames"===I)return D.objectStoreNames||re.get(D);if("store"===I)return F.objectStoreNames[1]?void 0:F.objectStore(F.objectStoreNames[0])}return bt(D[I])},set:(D,I,F)=>(D[I]=F,!0),has:(D,I)=>D instanceof IDBTransaction&&("done"===I||"store"===I)||I in D};function Ht(D){return"function"==typeof D?function gt(D){return D!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function je(){return At||(At=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(D)?function(...I){return D.apply(ze(this),I),bt(L.get(this))}:function(...I){return bt(D.apply(ze(this),I))}:function(I,...F){const Q=D.call(ze(this),I,...F);return re.set(Q,I.sort?I.sort():[I]),bt(Q)}}(D):(D instanceof IDBTransaction&&function Le(D){if(j.has(D))return;const I=new Promise((F,Q)=>{const Y=()=>{D.removeEventListener("complete",Ee),D.removeEventListener("error",me),D.removeEventListener("abort",me)},Ee=()=>{F(),Y()},me=()=>{Q(D.error||new DOMException("AbortError","AbortError")),Y()};D.addEventListener("complete",Ee),D.addEventListener("error",me),D.addEventListener("abort",me)});j.set(D,I)}(D),Ie(D,function wt(){return Et||(Et=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(D,Te):D)}function bt(D){if(D instanceof IDBRequest)return function kt(D){const I=new Promise((F,Q)=>{const Y=()=>{D.removeEventListener("success",Ee),D.removeEventListener("error",me)},Ee=()=>{F(bt(D.result)),Y()},me=()=>{Q(D.error),Y()};D.addEventListener("success",Ee),D.addEventListener("error",me)});return I.then(F=>{F instanceof IDBCursor&&L.set(F,D)}).catch(()=>{}),Ne.set(I,D),I}(D);if(ae.has(D))return ae.get(D);const I=Ht(D);return I!==D&&(ae.set(D,I),Ne.set(I,D)),I}const ze=D=>Ne.get(D),be=["get","getKey","getAll","getAllKeys","count"],Ct=["put","add","delete","clear"],N=new Map;function tt(D,I){if(!(D instanceof IDBDatabase)||I in D||"string"!=typeof I)return;if(N.get(I))return N.get(I);const F=I.replace(/FromIndex$/,""),Q=I!==F,Y=Ct.includes(F);if(!(F in(Q?IDBIndex:IDBObjectStore).prototype)||!Y&&!be.includes(F))return;const Ee=function(){var me=(0,v.A)(function*(z,...$e){const se=this.transaction(z,Y?"readwrite":"readonly");let Xn=se.store;return Q&&(Xn=Xn.index($e.shift())),(yield Promise.all([Xn[F](...$e),Y&&se.done]))[0]});return function($e){return me.apply(this,arguments)}}();return N.set(I,Ee),Ee}!function we(D){Te=D(Te)}(D=>({...D,get:(I,F,Q)=>tt(I,F)||D.get(I,F,Q),has:(I,F)=>!!tt(I,F)||D.has(I,F)}));class st{constructor(I){this.container=I}getPlatformInfoString(){return this.container.getProviders().map(F=>{if(function Rn(D){const I=D.getComponent();return"VERSION"===I?.type}(F)){const Q=F.getImmediate();return`${Q.library}/${Q.version}`}return null}).filter(F=>F).join(" ")}}const ar="@firebase/app",un=new u.Vy("@firebase/app"),pn="[DEFAULT]",Ji={[ar]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Qt=new Map,xn=new Map;function mn(D,I){try{D.container.addComponent(I)}catch(F){un.debug(`Component ${I.name} failed to register with FirebaseApp ${D.name}`,F)}}function gn(D,I){D.container.addOrOverwriteComponent(I)}function Kn(D){const I=D.name;if(xn.has(I))return un.debug(`There were multiple attempts to register component ${I}.`),!1;xn.set(I,D);for(const F of Qt.values())mn(F,D);return!0}function lr(D,I){const F=D.container.getProvider("heartbeat").getImmediate({optional:!0});return F&&F.triggerHeartbeat(),D.container.getProvider(I)}function ai(D,I,F=pn){lr(D,I).clearInstance(F)}function Wn(){xn.clear()}const sn=new ce.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class on{constructor(I,F,Q){this._isDeleted=!1,this._options=Object.assign({},I),this._config=Object.assign({},F),this._name=F.name,this._automaticDataCollectionEnabled=F.automaticDataCollectionEnabled,this._container=Q,this.container.addComponent(new fe.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(I){this.checkDestroyed(),this._automaticDataCollectionEnabled=I}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(I){this._isDeleted=I}checkDestroyed(){if(this.isDeleted)throw sn.create("app-deleted",{appName:this._name})}}const Lr="10.7.1";function co(D,I={}){let F=D;"object"!=typeof I&&(I={name:I});const Q=Object.assign({name:pn,automaticDataCollectionEnabled:!1},I),Y=Q.name;if("string"!=typeof Y||!Y)throw sn.create("bad-app-name",{appName:String(Y)});if(F||(F=(0,ce.T9)()),!F)throw sn.create("no-options");const Ee=Qt.get(Y);if(Ee){if((0,ce.bD)(F,Ee.options)&&(0,ce.bD)(Q,Ee.config))return Ee;throw sn.create("duplicate-app",{appName:Y})}const me=new fe.h1(Y);for(const $e of xn.values())me.addComponent($e);const z=new on(F,Q,me);return Qt.set(Y,z),z}function Hn(D=pn){const I=Qt.get(D);if(!I&&D===pn&&(0,ce.T9)())return co();if(!I)throw sn.create("no-app",{appName:D});return I}function dr(){return Array.from(Qt.values())}function Ut(D){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,v.A)(function*(D){const I=D.name;Qt.has(I)&&(Qt.delete(I),yield Promise.all(D.container.getProviders().map(F=>F.delete())),D.isDeleted=!0)})).apply(this,arguments)}function Ot(D,I,F){var Q;let Y=null!==(Q=Ji[D])&&void 0!==Q?Q:D;F&&(Y+=`-${F}`);const Ee=Y.match(/\s|\//),me=I.match(/\s|\//);if(Ee||me){const z=[`Unable to register library "${Y}" with version "${I}":`];return Ee&&z.push(`library name "${Y}" contains illegal characters (whitespace or "/")`),Ee&&me&&z.push("and"),me&&z.push(`version name "${I}" contains illegal characters (whitespace or "/")`),void un.warn(z.join(" "))}Kn(new fe.uA(`${Y}-version`,()=>({library:Y,version:I}),"VERSION"))}function Fr(D,I){if(null!==D&&"function"!=typeof D)throw sn.create("invalid-log-argument");(0,u.Ey)(D,I)}function lo(D){(0,u.He)(D)}const Zi="firebase-heartbeat-database",ci=1,A="firebase-heartbeat-store";let E=null;function b(){return E||(E=function qe(D,I,{blocked:F,upgrade:Q,blocking:Y,terminated:Ee}={}){const me=indexedDB.open(D,I),z=bt(me);return Q&&me.addEventListener("upgradeneeded",$e=>{Q(bt(me.result),$e.oldVersion,$e.newVersion,bt(me.transaction),$e)}),F&&me.addEventListener("blocked",$e=>F($e.oldVersion,$e.newVersion,$e)),z.then($e=>{Ee&&$e.addEventListener("close",()=>Ee()),Y&&$e.addEventListener("versionchange",se=>Y(se.oldVersion,se.newVersion,se))}).catch(()=>{}),z}(Zi,ci,{upgrade:(D,I)=>{0===I&&D.createObjectStore(A)}}).catch(D=>{throw sn.create("idb-open",{originalErrorMessage:D.message})})),E}function P(){return(P=(0,v.A)(function*(D){try{return yield(yield b()).transaction(A).objectStore(A).get(ve(D))}catch(I){if(I instanceof ce.g)un.warn(I.message);else{const F=sn.create("idb-get",{originalErrorMessage:I?.message});un.warn(F.message)}}})).apply(this,arguments)}function X(D,I){return he.apply(this,arguments)}function he(){return(he=(0,v.A)(function*(D,I){try{const Q=(yield b()).transaction(A,"readwrite");yield Q.objectStore(A).put(I,ve(D)),yield Q.done}catch(F){if(F instanceof ce.g)un.warn(F.message);else{const Q=sn.create("idb-set",{originalErrorMessage:F?.message});un.warn(Q.message)}}})).apply(this,arguments)}function ve(D){return`${D.name}!${D.options.appId}`}class yt{constructor(I){this.container=I,this._heartbeatsCache=null;const F=this.container.getProvider("app").getImmediate();this._storage=new Yn(F),this._heartbeatsCachePromise=this._storage.read().then(Q=>(this._heartbeatsCache=Q,Q))}triggerHeartbeat(){var I=this;return(0,v.A)(function*(){var F,Q;const Ee=I.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),me=ge();if((null!=(null===(F=I._heartbeatsCache)||void 0===F?void 0:F.heartbeats)||(I._heartbeatsCache=yield I._heartbeatsCachePromise,null!=(null===(Q=I._heartbeatsCache)||void 0===Q?void 0:Q.heartbeats)))&&I._heartbeatsCache.lastSentHeartbeatDate!==me&&!I._heartbeatsCache.heartbeats.some(z=>z.date===me))return I._heartbeatsCache.heartbeats.push({date:me,agent:Ee}),I._heartbeatsCache.heartbeats=I._heartbeatsCache.heartbeats.filter(z=>{const $e=new Date(z.date).valueOf();return Date.now()-$e<=2592e6}),I._storage.overwrite(I._heartbeatsCache)})()}getHeartbeatsHeader(){var I=this;return(0,v.A)(function*(){var F;if(null===I._heartbeatsCache&&(yield I._heartbeatsCachePromise),null==(null===(F=I._heartbeatsCache)||void 0===F?void 0:F.heartbeats)||0===I._heartbeatsCache.heartbeats.length)return"";const Q=ge(),{heartbeatsToSend:Y,unsentEntries:Ee}=function Bt(D,I=1024){const F=[];let Q=D.slice();for(const Y of D){const Ee=F.find(me=>me.agent===Y.agent);if(Ee){if(Ee.dates.push(Y.date),Dn(F)>I){Ee.dates.pop();break}}else if(F.push({agent:Y.agent,dates:[Y.date]}),Dn(F)>I){F.pop();break}Q=Q.slice(1)}return{heartbeatsToSend:F,unsentEntries:Q}}(I._heartbeatsCache.heartbeats),me=(0,ce.Uj)(JSON.stringify({version:2,heartbeats:Y}));return I._heartbeatsCache.lastSentHeartbeatDate=Q,Ee.length>0?(I._heartbeatsCache.heartbeats=Ee,yield I._storage.overwrite(I._heartbeatsCache)):(I._heartbeatsCache.heartbeats=[],I._storage.overwrite(I._heartbeatsCache)),me})()}}function ge(){return(new Date).toISOString().substring(0,10)}class Yn{constructor(I){this.app=I,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,v.A)(function*(){return!!(0,ce.zW)()&&(0,ce.eX)().then(()=>!0).catch(()=>!1)})()}read(){var I=this;return(0,v.A)(function*(){if(yield I._canUseIndexedDBPromise){const Q=yield function O(D){return P.apply(this,arguments)}(I.app);return Q?.heartbeats?Q:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(I){var F=this;return(0,v.A)(function*(){var Q;if(yield F._canUseIndexedDBPromise){const Ee=yield F.read();return X(F.app,{lastSentHeartbeatDate:null!==(Q=I.lastSentHeartbeatDate)&&void 0!==Q?Q:Ee.lastSentHeartbeatDate,heartbeats:I.heartbeats})}})()}add(I){var F=this;return(0,v.A)(function*(){var Q;if(yield F._canUseIndexedDBPromise){const Ee=yield F.read();return X(F.app,{lastSentHeartbeatDate:null!==(Q=I.lastSentHeartbeatDate)&&void 0!==Q?Q:Ee.lastSentHeartbeatDate,heartbeats:[...Ee.heartbeats,...I.heartbeats]})}})()}}function Dn(D){return(0,ce.Uj)(JSON.stringify({version:2,heartbeats:D})).length}!function li(D){Kn(new fe.uA("platform-logger",I=>new st(I),"PRIVATE")),Kn(new fe.uA("heartbeat",I=>new yt(I),"PRIVATE")),Ot(ar,"0.9.25",D),Ot(ar,"0.9.25","esm2017"),Ot("fire-js","")}("")},1362:(ro,Wt,W)=>{W.d(Wt,{h1:()=>wt,uA:()=>u});var v=W(467),fe=W(1076);class u{constructor(L,j,re){this.name=L,this.instanceFactory=j,this.type=re,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(L){return this.instantiationMode=L,this}setMultipleInstances(L){return this.multipleInstances=L,this}setServiceProps(L){return this.serviceProps=L,this}setInstanceCreatedCallback(L){return this.onInstanceCreated=L,this}}const ce="[DEFAULT]";class Ie{constructor(L,j){this.name=L,this.container=j,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(L){const j=this.normalizeInstanceIdentifier(L);if(!this.instancesDeferred.has(j)){const re=new fe.cY;if(this.instancesDeferred.set(j,re),this.isInitialized(j)||this.shouldAutoInitialize())try{const ae=this.getOrInitializeService({instanceIdentifier:j});ae&&re.resolve(ae)}catch{}}return this.instancesDeferred.get(j).promise}getImmediate(L){var j;const re=this.normalizeInstanceIdentifier(L?.identifier),ae=null!==(j=L?.optional)&&void 0!==j&&j;if(!this.isInitialized(re)&&!this.shouldAutoInitialize()){if(ae)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:re})}catch(Ne){if(ae)return null;throw Ne}}getComponent(){return this.component}setComponent(L){if(L.name!==this.name)throw Error(`Mismatching Component ${L.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=L,this.shouldAutoInitialize()){if(function At(je){return"EAGER"===je.instantiationMode}(L))try{this.getOrInitializeService({instanceIdentifier:ce})}catch{}for(const[j,re]of this.instancesDeferred.entries()){const ae=this.normalizeInstanceIdentifier(j);try{const Ne=this.getOrInitializeService({instanceIdentifier:ae});re.resolve(Ne)}catch{}}}}clearInstance(L=ce){this.instancesDeferred.delete(L),this.instancesOptions.delete(L),this.instances.delete(L)}delete(){var L=this;return(0,v.A)(function*(){const j=Array.from(L.instances.values());yield Promise.all([...j.filter(re=>"INTERNAL"in re).map(re=>re.INTERNAL.delete()),...j.filter(re=>"_delete"in re).map(re=>re._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(L=ce){return this.instances.has(L)}getOptions(L=ce){return this.instancesOptions.get(L)||{}}initialize(L={}){const{options:j={}}=L,re=this.normalizeInstanceIdentifier(L.instanceIdentifier);if(this.isInitialized(re))throw Error(`${this.name}(${re}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ae=this.getOrInitializeService({instanceIdentifier:re,options:j});for(const[Ne,kt]of this.instancesDeferred.entries())re===this.normalizeInstanceIdentifier(Ne)&&kt.resolve(ae);return ae}onInit(L,j){var re;const ae=this.normalizeInstanceIdentifier(j),Ne=null!==(re=this.onInitCallbacks.get(ae))&&void 0!==re?re:new Set;Ne.add(L),this.onInitCallbacks.set(ae,Ne);const kt=this.instances.get(ae);return kt&&L(kt,ae),()=>{Ne.delete(L)}}invokeOnInitCallbacks(L,j){const re=this.onInitCallbacks.get(j);if(re)for(const ae of re)try{ae(L,j)}catch{}}getOrInitializeService({instanceIdentifier:L,options:j={}}){let re=this.instances.get(L);if(!re&&this.component&&(re=this.component.instanceFactory(this.container,{instanceIdentifier:(je=L,je===ce?void 0:je),options:j}),this.instances.set(L,re),this.instancesOptions.set(L,j),this.invokeOnInitCallbacks(re,L),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,L,re)}catch{}var je;return re||null}normalizeInstanceIdentifier(L=ce){return this.component?this.component.multipleInstances?L:ce:L}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class wt{constructor(L){this.name=L,this.providers=new Map}addComponent(L){const j=this.getProvider(L.name);if(j.isComponentSet())throw new Error(`Component ${L.name} has already been registered with ${this.name}`);j.setComponent(L)}addOrOverwriteComponent(L){this.getProvider(L.name).isComponentSet()&&this.providers.delete(L.name),this.addComponent(L)}getProvider(L){if(this.providers.has(L))return this.providers.get(L);const j=new Ie(L,this);return this.providers.set(L,j),j}getProviders(){return Array.from(this.providers.values())}}},8041:(ro,Wt,W)=>{W.d(Wt,{$b:()=>fe,Ey:()=>je,He:()=>wt,Vy:()=>At});const v=[];var fe=function(L){return L[L.DEBUG=0]="DEBUG",L[L.VERBOSE=1]="VERBOSE",L[L.INFO=2]="INFO",L[L.WARN=3]="WARN",L[L.ERROR=4]="ERROR",L[L.SILENT=5]="SILENT",L}(fe||{});const u={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},ce=fe.INFO,Ie={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},Et=(L,j,...re)=>{if(j<L.logLevel)return;const ae=(new Date).toISOString(),Ne=Ie[j];if(!Ne)throw new Error(`Attempted to log a message with an invalid logType (value: ${j})`);console[Ne](`[${ae}]  ${L.name}:`,...re)};class At{constructor(j){this.name=j,this._logLevel=ce,this._logHandler=Et,this._userLogHandler=null,v.push(this)}get logLevel(){return this._logLevel}set logLevel(j){if(!(j in fe))throw new TypeError(`Invalid value "${j}" assigned to \`logLevel\``);this._logLevel=j}setLogLevel(j){this._logLevel="string"==typeof j?u[j]:j}get logHandler(){return this._logHandler}set logHandler(j){if("function"!=typeof j)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=j}get userLogHandler(){return this._userLogHandler}set userLogHandler(j){this._userLogHandler=j}debug(...j){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...j),this._logHandler(this,fe.DEBUG,...j)}log(...j){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...j),this._logHandler(this,fe.VERBOSE,...j)}info(...j){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...j),this._logHandler(this,fe.INFO,...j)}warn(...j){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...j),this._logHandler(this,fe.WARN,...j)}error(...j){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...j),this._logHandler(this,fe.ERROR,...j)}}function wt(L){v.forEach(j=>{j.setLogLevel(L)})}function je(L,j){for(const re of v){let ae=null;j&&j.level&&(ae=u[j.level]),re.userLogHandler=null===L?null:(Ne,kt,...Le)=>{const Te=Le.map(we=>{if(null==we)return null;if("string"==typeof we)return we;if("number"==typeof we||"boolean"==typeof we)return we.toString();if(we instanceof Error)return we.message;try{return JSON.stringify(we)}catch{return null}}).filter(we=>we).join(" ");kt>=(ae??Ne.logLevel)&&L({level:fe[kt].toLowerCase(),message:Te,args:Le,type:Ne.name})}}}},3228:(ro,Wt,W)=>{W.r(Wt);var v=W(467),fe=W(3345),u=W(1076),ce=W(7852),Ie=W(8041),Et=W(1635),At=W(1362);const je={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const kt=function ae(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Le=function Ne(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Te=new u.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),gt=new Ie.Vy("@firebase/auth");function bt(l,...o){gt.logLevel<=Ie.$b.ERROR&&gt.error(`Auth (${ce.SDK_VERSION}): ${l}`,...o)}function ze(l,...o){throw Ct(l,...o)}function qe(l,...o){return Ct(l,...o)}function tn(l,o,c){const d=Object.assign(Object.assign({},Le()),{[o]:c});return new u.FA("auth","Firebase",d).create(o,{appName:l.name})}function be(l,o,c){if(!(o instanceof c))throw c.name!==o.constructor.name&&ze(l,"argument-error"),tn(l,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ct(l,...o){if("string"!=typeof l){const c=o[0],d=[...o.slice(1)];return d[0]&&(d[0].appName=l.name),l._errorFactory.create(c,...d)}return Te.create(l,...o)}function N(l,o,...c){if(!l)throw Ct(o,...c)}function tt(l){const o="INTERNAL ASSERTION FAILED: "+l;throw bt(o),new Error(o)}function st(l,o){l||tt(o)}function Rn(){var l;return typeof self<"u"&&(null===(l=self.location)||void 0===l?void 0:l.href)||""}function ar(){return"http:"===ii()||"https:"===ii()}function ii(){var l;return typeof self<"u"&&(null===(l=self.location)||void 0===l?void 0:l.protocol)||null}class nn{constructor(o,c){this.shortDelay=o,this.longDelay=c,st(c>o,"Short delay should be less than long delay!"),this.isMobile=(0,u.jZ)()||(0,u.lV)()}get(){return function un(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(ar()||(0,u.sr)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dn(l,o){st(l.emulator,"Emulator should always be set here");const{url:c}=l.emulator;return o?`${c}${o.startsWith("/")?o.slice(1):o}`:c}class cr{static initialize(o,c,d){this.fetchImpl=o,c&&(this.headersImpl=c),d&&(this.responseImpl=d)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ma={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},so=new nn(3e4,6e4);function Pe(l,o){return l.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:l.tenantId}):o}function De(l,o,c,d){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,v.A)(function*(l,o,c,d,p={}){return hn(l,p,(0,v.A)(function*(){let _={},T={};d&&("GET"===o?T=d:_={body:JSON.stringify(d)});const C=(0,u.Am)(Object.assign({key:l.config.apiKey},T)).slice(1),k=yield l._getAdditionalHeaders();return k["Content-Type"]="application/json",l.languageCode&&(k["X-Firebase-Locale"]=l.languageCode),cr.fetch()(Sn(l,l.config.apiHost,c,C),Object.assign({method:o,headers:k,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function hn(l,o,c){return $n.apply(this,arguments)}function $n(){return($n=(0,v.A)(function*(l,o,c){l._canInitEmulator=!1;const d=Object.assign(Object.assign({},Ma),o);try{const p=new Pn(l),_=yield Promise.race([c(),p.promise]);p.clearNetworkTimeout();const T=yield _.json();if("needConfirmation"in T)throw Vr(l,"account-exists-with-different-credential",T);if(_.ok&&!("errorMessage"in T))return T;{const C=_.ok?T.errorMessage:T.error.message,[k,q]=C.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===k)throw Vr(l,"credential-already-in-use",T);if("EMAIL_EXISTS"===k)throw Vr(l,"email-already-in-use",T);if("USER_DISABLED"===k)throw Vr(l,"user-disabled",T);const J=d[k]||k.toLowerCase().replace(/[_\s]+/g,"-");if(q)throw tn(l,J,q);ze(l,J)}}catch(p){if(p instanceof u.g)throw p;ze(l,"network-request-failed",{message:String(p)})}})).apply(this,arguments)}function rn(l,o,c,d){return fn.apply(this,arguments)}function fn(){return(fn=(0,v.A)(function*(l,o,c,d,p={}){const _=yield De(l,o,c,d,p);return"mfaPendingCredential"in _&&ze(l,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function Sn(l,o,c,d){const p=`${o}${c}?${d}`;return l.config.emulator?dn(l.config,p):`${l.config.apiScheme}://${p}`}function oo(l){switch(l){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Pn{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((c,d)=>{this.timer=setTimeout(()=>d(qe(this.auth,"network-request-failed")),so.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Vr(l,o,c){const d={appName:l.name};c.email&&(d.email=c.email),c.phoneNumber&&(d.phoneNumber=c.phoneNumber);const p=qe(l,o,d);return p.customData._tokenResponse=c,p}function Yi(l){return void 0!==l&&void 0!==l.getResponse}function _t(l){return void 0!==l&&void 0!==l.enterprise}class si{constructor(o){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=o.recaptchaEnforcementState}getProviderEnforcementState(o){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const c of this.recaptchaEnforcementState)if(c.provider&&c.provider===o)return oo(c.enforcementState);return null}isProviderEnabled(o){return"ENFORCE"===this.getProviderEnforcementState(o)||"AUDIT"===this.getProviderEnforcementState(o)}}function Mr(){return(Mr=(0,v.A)(function*(l){return(yield De(l,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ft(l,o){return oi.apply(this,arguments)}function oi(){return(oi=(0,v.A)(function*(l,o){return De(l,"GET","/v2/recaptchaConfig",Pe(l,o))})).apply(this,arguments)}function pn(){return(pn=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Qt(){return(Qt=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function mn(){return(mn=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function gn(l){if(l)try{const o=new Date(Number(l));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function ai(){return(ai=(0,v.A)(function*(l,o=!1){const c=(0,u.Ku)(l),d=yield c.getIdToken(o),p=ur(d);N(p&&p.exp&&p.auth_time&&p.iat,c.auth,"internal-error");const _="object"==typeof p.firebase?p.firebase:void 0,T=_?.sign_in_provider;return{claims:p,token:d,authTime:gn(Wn(p.auth_time)),issuedAtTime:gn(Wn(p.iat)),expirationTime:gn(Wn(p.exp)),signInProvider:T||null,signInSecondFactor:_?.sign_in_second_factor||null}})).apply(this,arguments)}function Wn(l){return 1e3*Number(l)}function ur(l){const[o,c,d]=l.split(".");if(void 0===o||void 0===c||void 0===d)return bt("JWT malformed, contained fewer than 3 sections"),null;try{const p=(0,u.u)(c);return p?JSON.parse(p):(bt("Failed to decode base64 JWT payload"),null)}catch(p){return bt("Caught error parsing JWT payload as JSON",p?.toString()),null}}function on(l,o){return Lr.apply(this,arguments)}function Lr(){return(Lr=(0,v.A)(function*(l,o,c=!1){if(c)return o;try{return yield o}catch(d){throw d instanceof u.g&&function co({code:l}){return"auth/user-disabled"===l||"auth/user-token-expired"===l}(d)&&l.auth.currentUser===l&&(yield l.auth.signOut()),d}})).apply(this,arguments)}class Hn{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var c;if(o){const d=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),d}{this.errorBackoff=3e4;const p=(null!==(c=this.user.stsTokenManager.expirationTime)&&void 0!==c?c:0)-Date.now()-3e5;return Math.max(0,p)}}schedule(o=!1){var c=this;if(!this.isRunning)return;const d=this.getInterval(o);this.timerId=setTimeout((0,v.A)(function*(){yield c.iteration()}),d)}iteration(){var o=this;return(0,v.A)(function*(){try{yield o.user.getIdToken(!0)}catch(c){return void("auth/network-request-failed"===c?.code&&o.schedule(!0))}o.schedule()})()}}class dr{constructor(o,c){this.createdAt=o,this.lastLoginAt=c,this._initializeTime()}_initializeTime(){this.lastSignInTime=gn(this.lastLoginAt),this.creationTime=gn(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Ut(l){return Qn.apply(this,arguments)}function Qn(){return Qn=(0,v.A)(function*(l){var o;const c=l.auth,d=yield l.getIdToken(),p=yield on(l,function xn(l,o){return mn.apply(this,arguments)}(c,{idToken:d}));N(p?.users.length,c,"internal-error");const _=p.users[0];l._notifyReloadListener(_);const T=null!==(o=_.providerUserInfo)&&void 0!==o&&o.length?function Zi(l){return l.map(o=>{var{providerId:c}=o,d=(0,Et.Tt)(o,["providerId"]);return{providerId:c,uid:d.rawId||"",displayName:d.displayName||null,email:d.email||null,phoneNumber:d.phoneNumber||null,photoURL:d.photoUrl||null}})}(_.providerUserInfo):[],C=function lo(l,o){return[...l.filter(d=>!o.some(p=>p.providerId===d.providerId)),...o]}(l.providerData,T),J=!!l.isAnonymous&&!(l.email&&_.passwordHash||C?.length),ee={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:C,metadata:new dr(_.createdAt,_.lastLoginAt),isAnonymous:J};Object.assign(l,ee)}),Qn.apply(this,arguments)}function Fr(){return(Fr=(0,v.A)(function*(l){const o=(0,u.Ku)(l);yield Ut(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function A(){return(A=(0,v.A)(function*(l,o){const c=yield hn(l,{},(0,v.A)(function*(){const d=(0,u.Am)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:p,apiKey:_}=l.config,T=Sn(l,p,"/v1/token",`key=${_}`),C=yield l._getAdditionalHeaders();return C["Content-Type"]="application/x-www-form-urlencoded",cr.fetch()(T,{method:"POST",headers:C,body:d})}));return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}})).apply(this,arguments)}function b(){return(b=(0,v.A)(function*(l,o){return De(l,"POST","/v2/accounts:revokeToken",Pe(l,o))})).apply(this,arguments)}class O{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){N(o.idToken,"internal-error"),N(typeof o.idToken<"u","internal-error"),N(typeof o.refreshToken<"u","internal-error");const c="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function sn(l){const o=ur(l);return N(o,"internal-error"),N(typeof o.exp<"u","internal-error"),N(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,c)}getToken(o,c=!1){var d=this;return(0,v.A)(function*(){return N(!d.accessToken||d.refreshToken,o,"user-token-expired"),c||!d.accessToken||d.isExpired?d.refreshToken?(yield d.refresh(o,d.refreshToken),d.accessToken):null:d.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,c){var d=this;return(0,v.A)(function*(){const{accessToken:p,refreshToken:_,expiresIn:T}=yield function ci(l,o){return A.apply(this,arguments)}(o,c);d.updateTokensAndExpiration(p,_,Number(T))})()}updateTokensAndExpiration(o,c,d){this.refreshToken=c||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*d}static fromJSON(o,c){const{refreshToken:d,accessToken:p,expirationTime:_}=c,T=new O;return d&&(N("string"==typeof d,"internal-error",{appName:o}),T.refreshToken=d),p&&(N("string"==typeof p,"internal-error",{appName:o}),T.accessToken=p),_&&(N("number"==typeof _,"internal-error",{appName:o}),T.expirationTime=_),T}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new O,this.toJSON())}_performRefresh(){return tt("not implemented")}}function P(l,o){N("string"==typeof l||typeof l>"u","internal-error",{appName:o})}class X{constructor(o){var{uid:c,auth:d,stsTokenManager:p}=o,_=(0,Et.Tt)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=c,this.auth=d,this.stsTokenManager=p,this.accessToken=p.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new dr(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(o){var c=this;return(0,v.A)(function*(){const d=yield on(c,c.stsTokenManager.getToken(c.auth,o));return N(d,c.auth,"internal-error"),c.accessToken!==d&&(c.accessToken=d,yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)),d})()}getIdTokenResult(o){return function lr(l){return ai.apply(this,arguments)}(this,o)}reload(){return function Ot(l){return Fr.apply(this,arguments)}(this)}_assign(o){this!==o&&(N(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(c=>Object.assign({},c)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const c=new X(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return c.metadata._copy(this.metadata),c}_onReload(o){N(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,c=!1){var d=this;return(0,v.A)(function*(){let p=!1;o.idToken&&o.idToken!==d.stsTokenManager.accessToken&&(d.stsTokenManager.updateFromServerResponse(o),p=!0),c&&(yield Ut(d)),yield d.auth._persistUserIfCurrent(d),p&&d.auth._notifyListenersIfCurrent(d)})()}delete(){var o=this;return(0,v.A)(function*(){const c=yield o.getIdToken();return yield on(o,function Xi(l,o){return pn.apply(this,arguments)}(o.auth,{idToken:c})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,c){var d,p,_,T,C,k,q,J;const ee=null!==(d=c.displayName)&&void 0!==d?d:void 0,Ke=null!==(p=c.email)&&void 0!==p?p:void 0,bn=null!==(_=c.phoneNumber)&&void 0!==_?_:void 0,cn=null!==(T=c.photoURL)&&void 0!==T?T:void 0,Xu=null!==(C=c.tenantId)&&void 0!==C?C:void 0,xt=null!==(k=c._redirectEventId)&&void 0!==k?k:void 0,il=null!==(q=c.createdAt)&&void 0!==q?q:void 0,Ui=null!==(J=c.lastLoginAt)&&void 0!==J?J:void 0,{uid:ca,emailVerified:Cn,isAnonymous:sl,providerData:Jr,stsTokenManager:Ju}=c;N(ca&&Ju,o,"internal-error");const Fh=O.fromJSON(this.name,Ju);N("string"==typeof ca,o,"internal-error"),P(ee,o.name),P(Ke,o.name),N("boolean"==typeof Cn,o,"internal-error"),N("boolean"==typeof sl,o,"internal-error"),P(bn,o.name),P(cn,o.name),P(Xu,o.name),P(xt,o.name),P(il,o.name),P(Ui,o.name);const pe=new X({uid:ca,auth:o,email:Ke,emailVerified:Cn,displayName:ee,isAnonymous:sl,photoURL:cn,phoneNumber:bn,tenantId:Xu,stsTokenManager:Fh,createdAt:il,lastLoginAt:Ui});return Jr&&Array.isArray(Jr)&&(pe.providerData=Jr.map(Uh=>Object.assign({},Uh))),xt&&(pe._redirectEventId=xt),pe}static _fromIdTokenResponse(o,c,d=!1){return(0,v.A)(function*(){const p=new O;p.updateFromServerResponse(c);const _=new X({uid:c.localId,auth:o,stsTokenManager:p,isAnonymous:d});return yield Ut(_),_})()}}const he=new Map;function ve(l){st(l instanceof Function,"Expected a class definition");let o=he.get(l);return o?(st(o instanceof l,"Instance stored in cache mismatched with class"),o):(o=new l,he.set(l,o),o)}const He=(()=>{class l{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,v.A)(function*(){return!0})()}_set(c,d){var p=this;return(0,v.A)(function*(){p.storage[c]=d})()}_get(c){var d=this;return(0,v.A)(function*(){const p=d.storage[c];return void 0===p?null:p})()}_remove(c){var d=this;return(0,v.A)(function*(){delete d.storage[c]})()}_addListener(c,d){}_removeListener(c,d){}}return l.type="NONE",l})();function yt(l,o,c){return`firebase:${l}:${o}:${c}`}class ge{constructor(o,c,d){this.persistence=o,this.auth=c,this.userKey=d;const{config:p,name:_}=this.auth;this.fullUserKey=yt(this.userKey,p.apiKey,_),this.fullPersistenceKey=yt("persistence",p.apiKey,_),this.boundEventHandler=c._onStorageEvent.bind(c),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,v.A)(function*(){const c=yield o.persistence._get(o.fullUserKey);return c?X._fromJSON(o.auth,c):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var c=this;return(0,v.A)(function*(){if(c.persistence===o)return;const d=yield c.getCurrentUser();return yield c.removeCurrentUser(),c.persistence=o,d?c.setCurrentUser(d):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,c,d="authUser"){return(0,v.A)(function*(){if(!c.length)return new ge(ve(He),o,d);const p=(yield Promise.all(c.map(function(){var q=(0,v.A)(function*(J){if(yield J._isAvailable())return J});return function(J){return q.apply(this,arguments)}}()))).filter(q=>q);let _=p[0]||ve(He);const T=yt(d,o.config.apiKey,o.name);let C=null;for(const q of c)try{const J=yield q._get(T);if(J){const ee=X._fromJSON(o,J);q!==_&&(C=ee),_=q;break}}catch{}const k=p.filter(q=>q._shouldAllowMigration);return _._shouldAllowMigration&&k.length?(_=k[0],C&&(yield _._set(T,C.toJSON())),yield Promise.all(c.map(function(){var q=(0,v.A)(function*(J){if(J!==_)try{yield J._remove(T)}catch{}});return function(J){return q.apply(this,arguments)}}())),new ge(_,o,d)):new ge(_,o,d)})()}}function Bt(l){const o=l.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(D(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(Yn(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(F(o))return"Blackberry";if(Q(o))return"Webos";if(Dn(o))return"Safari";if((o.includes("chrome/")||li(o))&&!o.includes("edge/"))return"Chrome";if(I(o))return"Android";{const d=l.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===d?.length)return d[1]}return"Other"}function Yn(l=(0,u.ZQ)()){return/firefox\//i.test(l)}function Dn(l=(0,u.ZQ)()){const o=l.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function li(l=(0,u.ZQ)()){return/crios\//i.test(l)}function D(l=(0,u.ZQ)()){return/iemobile/i.test(l)}function I(l=(0,u.ZQ)()){return/android/i.test(l)}function F(l=(0,u.ZQ)()){return/blackberry/i.test(l)}function Q(l=(0,u.ZQ)()){return/webos/i.test(l)}function Y(l=(0,u.ZQ)()){return/iphone|ipad|ipod/i.test(l)||/macintosh/i.test(l)&&/mobile/i.test(l)}function $e(l=(0,u.ZQ)()){return Y(l)||I(l)||Q(l)||F(l)||/windows phone/i.test(l)||D(l)}function Xn(l,o=[]){let c;switch(l){case"Browser":c=Bt((0,u.ZQ)());break;case"Worker":c=`${Bt((0,u.ZQ)())}-${l}`;break;default:c=l}const d=o.length?o.join(","):"FirebaseCore-web";return`${c}/JsCore/${ce.SDK_VERSION}/${d}`}class es{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,c){const d=_=>new Promise((T,C)=>{try{T(o(_))}catch(k){C(k)}});d.onAbort=c,this.queue.push(d);const p=this.queue.length-1;return()=>{this.queue[p]=()=>Promise.resolve()}}runMiddleware(o){var c=this;return(0,v.A)(function*(){if(c.auth.currentUser===o)return;const d=[];try{for(const p of c.queue)yield p(o),p.onAbort&&d.push(p.onAbort)}catch(p){d.reverse();for(const _ of d)try{_()}catch{}throw c.auth._errorFactory.create("login-blocked",{originalMessage:p?.message})}})()}}function ts(){return(ts=(0,v.A)(function*(l,o={}){return De(l,"GET","/v2/passwordPolicy",Pe(l,o))})).apply(this,arguments)}class Gd{constructor(o){var c,d,p,_;const T=o.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(c=T.minPasswordLength)&&void 0!==c?c:6,T.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=T.maxPasswordLength),void 0!==T.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=T.containsLowercaseCharacter),void 0!==T.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=T.containsUppercaseCharacter),void 0!==T.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=T.containsNumericCharacter),void 0!==T.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=T.containsNonAlphanumericCharacter),this.enforcementState=o.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(p=null===(d=o.allowedNonAlphanumericCharacters)||void 0===d?void 0:d.join(""))&&void 0!==p?p:"",this.forceUpgradeOnSignin=null!==(_=o.forceUpgradeOnSignin)&&void 0!==_&&_,this.schemaVersion=o.schemaVersion}validatePassword(o){var c,d,p,_,T,C;const k={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(o,k),this.validatePasswordCharacterOptions(o,k),k.isValid&&(k.isValid=null===(c=k.meetsMinPasswordLength)||void 0===c||c),k.isValid&&(k.isValid=null===(d=k.meetsMaxPasswordLength)||void 0===d||d),k.isValid&&(k.isValid=null===(p=k.containsLowercaseLetter)||void 0===p||p),k.isValid&&(k.isValid=null===(_=k.containsUppercaseLetter)||void 0===_||_),k.isValid&&(k.isValid=null===(T=k.containsNumericCharacter)||void 0===T||T),k.isValid&&(k.isValid=null===(C=k.containsNonAlphanumericCharacter)||void 0===C||C),k}validatePasswordLengthOptions(o,c){const d=this.customStrengthOptions.minPasswordLength,p=this.customStrengthOptions.maxPasswordLength;d&&(c.meetsMinPasswordLength=o.length>=d),p&&(c.meetsMaxPasswordLength=o.length<=p)}validatePasswordCharacterOptions(o,c){let d;this.updatePasswordCharacterOptionsStatuses(c,!1,!1,!1,!1);for(let p=0;p<o.length;p++)d=o.charAt(p),this.updatePasswordCharacterOptionsStatuses(c,d>="a"&&d<="z",d>="A"&&d<="Z",d>="0"&&d<="9",this.allowedNonAlphanumericCharacters.includes(d))}updatePasswordCharacterOptionsStatuses(o,c,d,p,_){this.customStrengthOptions.containsLowercaseLetter&&(o.containsLowercaseLetter||(o.containsLowercaseLetter=c)),this.customStrengthOptions.containsUppercaseLetter&&(o.containsUppercaseLetter||(o.containsUppercaseLetter=d)),this.customStrengthOptions.containsNumericCharacter&&(o.containsNumericCharacter||(o.containsNumericCharacter=p)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(o.containsNonAlphanumericCharacter||(o.containsNonAlphanumericCharacter=_))}}class jd{constructor(o,c,d,p){this.app=o,this.heartbeatServiceProvider=c,this.appCheckServiceProvider=d,this.config=p,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ns(this),this.idTokenSubscription=new ns(this),this.beforeStateQueue=new es(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Te,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=p.sdkClientVersion}_initializeWithPersistence(o,c){var d=this;return c&&(this._popupRedirectResolver=ve(c)),this._initializationPromise=this.queue((0,v.A)(function*(){var p,_;if(!d._deleted&&(d.persistenceManager=yield ge.create(d,o),!d._deleted)){if(null!==(p=d._popupRedirectResolver)&&void 0!==p&&p._shouldInitProactively)try{yield d._popupRedirectResolver._initialize(d)}catch{}yield d.initializeCurrentUser(c),d.lastNotifiedUid=(null===(_=d.currentUser)||void 0===_?void 0:_.uid)||null,!d._deleted&&(d._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,v.A)(function*(){if(o._deleted)return;const c=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||c){if(o.currentUser&&c&&o.currentUser.uid===c.uid)return o._currentUser._assign(c),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(c,!0)}})()}initializeCurrentUser(o){var c=this;return(0,v.A)(function*(){var d;const p=yield c.assertedPersistence.getCurrentUser();let _=p,T=!1;if(o&&c.config.authDomain){yield c.getOrInitRedirectPersistenceManager();const C=null===(d=c.redirectUser)||void 0===d?void 0:d._redirectEventId,k=_?._redirectEventId,q=yield c.tryRedirectSignIn(o);(!C||C===k)&&q?.user&&(_=q.user,T=!0)}if(!_)return c.directlySetCurrentUser(null);if(!_._redirectEventId){if(T)try{yield c.beforeStateQueue.runMiddleware(_)}catch(C){_=p,c._popupRedirectResolver._overrideRedirectResult(c,()=>Promise.reject(C))}return _?c.reloadAndSetCurrentUserOrClear(_):c.directlySetCurrentUser(null)}return N(c._popupRedirectResolver,c,"argument-error"),yield c.getOrInitRedirectPersistenceManager(),c.redirectUser&&c.redirectUser._redirectEventId===_._redirectEventId?c.directlySetCurrentUser(_):c.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(o){var c=this;return(0,v.A)(function*(){let d=null;try{d=yield c._popupRedirectResolver._completeRedirectFn(c,o,!0)}catch{yield c._setRedirectUser(null)}return d})()}reloadAndSetCurrentUserOrClear(o){var c=this;return(0,v.A)(function*(){try{yield Ut(o)}catch(d){if("auth/network-request-failed"!==d?.code)return c.directlySetCurrentUser(null)}return c.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function io(){if(typeof navigator>"u")return null;const l=navigator;return l.languages&&l.languages[0]||l.language||null}()}_delete(){var o=this;return(0,v.A)(function*(){o._deleted=!0})()}updateCurrentUser(o){var c=this;return(0,v.A)(function*(){const d=o?(0,u.Ku)(o):null;return d&&N(d.auth.config.apiKey===c.config.apiKey,c,"invalid-user-token"),c._updateCurrentUser(d&&d._clone(c))})()}_updateCurrentUser(o,c=!1){var d=this;return(0,v.A)(function*(){if(!d._deleted)return o&&N(d.tenantId===o.tenantId,d,"tenant-id-mismatch"),c||(yield d.beforeStateQueue.runMiddleware(o)),d.queue((0,v.A)(function*(){yield d.directlySetCurrentUser(o),d.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,v.A)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var c=this;return this.queue((0,v.A)(function*(){yield c.assertedPersistence.setPersistence(ve(o))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(o){var c=this;return(0,v.A)(function*(){c._getPasswordPolicyInternal()||(yield c._updatePasswordPolicy());const d=c._getPasswordPolicyInternal();return d.schemaVersion!==c.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(c._errorFactory.create("unsupported-password-policy-schema-version",{})):d.validatePassword(o)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var o=this;return(0,v.A)(function*(){const c=yield function Bd(l){return ts.apply(this,arguments)}(o),d=new Gd(c);null===o.tenantId?o._projectPasswordPolicy=d:o._tenantPasswordPolicies[o.tenantId]=d})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new u.FA("auth","Firebase",o())}onAuthStateChanged(o,c,d){return this.registerStateListener(this.authStateSubscription,o,c,d)}beforeAuthStateChanged(o,c){return this.beforeStateQueue.pushCallback(o,c)}onIdTokenChanged(o,c,d){return this.registerStateListener(this.idTokenSubscription,o,c,d)}authStateReady(){return new Promise((o,c)=>{if(this.currentUser)o();else{const d=this.onAuthStateChanged(()=>{d(),o()},c)}})}revokeAccessToken(o){var c=this;return(0,v.A)(function*(){if(c.currentUser){const d=yield c.currentUser.getIdToken(),p={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:o,idToken:d};null!=c.tenantId&&(p.tenantId=c.tenantId),yield function E(l,o){return b.apply(this,arguments)}(c,p)}})()}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,c){var d=this;return(0,v.A)(function*(){const p=yield d.getOrInitRedirectPersistenceManager(c);return null===o?p.removeCurrentUser():p.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var c=this;return(0,v.A)(function*(){if(!c.redirectPersistenceManager){const d=o&&ve(o)||c._popupRedirectResolver;N(d,c,"argument-error"),c.redirectPersistenceManager=yield ge.create(c,[ve(d._redirectPersistence)],"redirectUser"),c.redirectUser=yield c.redirectPersistenceManager.getCurrentUser()}return c.redirectPersistenceManager})()}_redirectUserForId(o){var c=this;return(0,v.A)(function*(){var d,p;return c._isInitialized&&(yield c.queue((0,v.A)(function*(){}))),(null===(d=c._currentUser)||void 0===d?void 0:d._redirectEventId)===o?c._currentUser:(null===(p=c.redirectUser)||void 0===p?void 0:p._redirectEventId)===o?c.redirectUser:null})()}_persistUserIfCurrent(o){var c=this;return(0,v.A)(function*(){if(o===c.currentUser)return c.queue((0,v.A)(function*(){return c.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,c;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const d=null!==(c=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==c?c:null;this.lastNotifiedUid!==d&&(this.lastNotifiedUid=d,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,c,d,p){if(this._deleted)return()=>{};const _="function"==typeof c?c:c.next.bind(c);let T=!1;const C=this._isInitialized?Promise.resolve():this._initializationPromise;if(N(C,this,"internal-error"),C.then(()=>{T||_(this.currentUser)}),"function"==typeof c){const k=o.addObserver(c,d,p);return()=>{T=!0,k()}}{const k=o.addObserver(c);return()=>{T=!0,k()}}}directlySetCurrentUser(o){var c=this;return(0,v.A)(function*(){c.currentUser&&c.currentUser!==o&&c._currentUser._stopProactiveRefresh(),o&&c.isProactiveRefreshEnabled&&o._startProactiveRefresh(),c.currentUser=o,o?yield c.assertedPersistence.setCurrentUser(o):yield c.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return N(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=Xn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,v.A)(function*(){var c;const d={"X-Client-Version":o.clientVersion};o.app.options.appId&&(d["X-Firebase-gmpid"]=o.app.options.appId);const p=yield null===(c=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getHeartbeatsHeader();p&&(d["X-Firebase-Client"]=p);const _=yield o._getAppCheckToken();return _&&(d["X-Firebase-AppCheck"]=_),d})()}_getAppCheckToken(){var o=this;return(0,v.A)(function*(){var c;const d=yield null===(c=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===c?void 0:c.getToken();return d?.error&&function Ht(l,...o){gt.logLevel<=Ie.$b.WARN&&gt.warn(`Auth (${ce.SDK_VERSION}): ${l}`,...o)}(`Error while retrieving App Check token: ${d.error}`),d?.token})()}}function _e(l){return(0,u.Ku)(l)}class ns{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,u.tD)(c=>this.observer=c)}get next(){return N(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function kn(l){return new Promise((o,c)=>{const d=document.createElement("script");d.setAttribute("src",l),d.onload=o,d.onerror=p=>{const _=qe("internal-error");_.customData=p,c(_)},d.type="text/javascript",d.charset="UTF-8",function ht(){var l,o;return null!==(o=null===(l=document.getElementsByTagName("head"))||void 0===l?void 0:l[0])&&void 0!==o?o:document}().appendChild(d)})}function Ll(l){return`__${l}${Math.floor(1e6*Math.random())}`}class vt{constructor(o){this.type="recaptcha-enterprise",this.auth=_e(o)}verify(o="verify",c=!1){var d=this;return(0,v.A)(function*(){function _(){return _=(0,v.A)(function*(C){if(!c){if(null==C.tenantId&&null!=C._agentRecaptchaConfig)return C._agentRecaptchaConfig.siteKey;if(null!=C.tenantId&&void 0!==C._tenantRecaptchaConfigs[C.tenantId])return C._tenantRecaptchaConfigs[C.tenantId].siteKey}return new Promise(function(){var k=(0,v.A)(function*(q,J){Ft(C,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ee=>{if(void 0!==ee.recaptchaKey){const Ke=new si(ee);return null==C.tenantId?C._agentRecaptchaConfig=Ke:C._tenantRecaptchaConfigs[C.tenantId]=Ke,q(Ke.siteKey)}J(new Error("recaptcha Enterprise site key undefined"))}).catch(ee=>{J(ee)})});return function(q,J){return k.apply(this,arguments)}}())}),_.apply(this,arguments)}function T(C,k,q){const J=window.grecaptcha;_t(J)?J.enterprise.ready(()=>{J.enterprise.execute(C,{action:o}).then(ee=>{k(ee)}).catch(()=>{k("NO_RECAPTCHA")})}):q(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((C,k)=>{(function p(C){return _.apply(this,arguments)})(d.auth).then(q=>{if(!c&&_t(window.grecaptcha))T(q,C,k);else{if(typeof window>"u")return void k(new Error("RecaptchaVerifier is only supported in browser"));kn("https://www.google.com/recaptcha/enterprise.js?render="+q).then(()=>{T(q,C,k)}).catch(J=>{k(J)})}}).catch(q=>{k(q)})})})()}}function Bl(l,o,c){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,v.A)(function*(l,o,c,d=!1){const p=new vt(l);let _;try{_=yield p.verify(c)}catch{_=yield p.verify(c,!0)}const T=Object.assign({},o);return Object.assign(T,d?{captchaResp:_}:{captchaResponse:_}),Object.assign(T,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(T,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),T})).apply(this,arguments)}function hr(l,o,c,d){return an.apply(this,arguments)}function an(){return an=(0,v.A)(function*(l,o,c,d){var p;if(null!==(p=l._getRecaptchaConfig())&&void 0!==p&&p.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const _=yield Bl(l,o,c,"getOobCode"===c);return d(l,_)}return d(l,o).catch(function(){var _=(0,v.A)(function*(T){if("auth/missing-recaptcha-token"===T.code){console.log(`${c} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const C=yield Bl(l,o,c,"getOobCode"===c);return d(l,C)}return Promise.reject(T)});return function(T){return _.apply(this,arguments)}}())}),an.apply(this,arguments)}function uo(l){const o=l.indexOf(":");return o<0?"":l.substr(0,o+1)}function Gl(l){if(!l)return null;const o=Number(l);return isNaN(o)?null:o}class fr{constructor(o,c){this.providerId=o,this.signInMethod=c}toJSON(){return tt("not implemented")}_getIdTokenResponse(o){return tt("not implemented")}_linkToIdToken(o,c){return tt("not implemented")}_getReauthenticationResolver(o){return tt("not implemented")}}function ho(l,o){return rs.apply(this,arguments)}function rs(){return(rs=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:resetPassword",Pe(l,o))})).apply(this,arguments)}function is(){return(is=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function ql(l,o){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:signUp",o)})).apply(this,arguments)}function ja(){return(ja=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:update",Pe(l,o))})).apply(this,arguments)}function os(l,o){return qa.apply(this,arguments)}function qa(){return(qa=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithPassword",Pe(l,o))})).apply(this,arguments)}function fo(l,o){return di.apply(this,arguments)}function di(){return(di=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:sendOobCode",Pe(l,o))})).apply(this,arguments)}function Ka(){return(Ka=(0,v.A)(function*(l,o){return fo(l,o)})).apply(this,arguments)}function $l(l,o){return po.apply(this,arguments)}function po(){return(po=(0,v.A)(function*(l,o){return fo(l,o)})).apply(this,arguments)}function Kl(l,o){return hi.apply(this,arguments)}function hi(){return(hi=(0,v.A)(function*(l,o){return fo(l,o)})).apply(this,arguments)}function as(){return(as=(0,v.A)(function*(l,o){return fo(l,o)})).apply(this,arguments)}function cs(){return(cs=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithEmailLink",Pe(l,o))})).apply(this,arguments)}function mo(){return(mo=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithEmailLink",Pe(l,o))})).apply(this,arguments)}class ls extends fr{constructor(o,c,d,p=null){super("password",d),this._email=o,this._password=c,this._tenantId=p}static _fromEmailAndPassword(o,c){return new ls(o,c,"password")}static _fromEmailAndCode(o,c,d=null){return new ls(o,c,"emailLink",d)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o;if(c?.email&&c?.password){if("password"===c.signInMethod)return this._fromEmailAndPassword(c.email,c.password);if("emailLink"===c.signInMethod)return this._fromEmailAndCode(c.email,c.password,c.tenantId)}return null}_getIdTokenResponse(o){var c=this;return(0,v.A)(function*(){switch(c.signInMethod){case"password":return hr(o,{returnSecureToken:!0,email:c._email,password:c._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",os);case"emailLink":return function Ha(l,o){return cs.apply(this,arguments)}(o,{email:c._email,oobCode:c._password});default:ze(o,"internal-error")}})()}_linkToIdToken(o,c){var d=this;return(0,v.A)(function*(){switch(d.signInMethod){case"password":return hr(o,{idToken:c,returnSecureToken:!0,email:d._email,password:d._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ql);case"emailLink":return function Wl(l,o){return mo.apply(this,arguments)}(o,{idToken:c,email:d._email,oobCode:d._password});default:ze(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function On(l,o){return go.apply(this,arguments)}function go(){return(go=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithIdp",Pe(l,o))})).apply(this,arguments)}class _n extends fr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const c=new _n(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(c.idToken=o.idToken),o.accessToken&&(c.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(c.nonce=o.nonce),o.pendingToken&&(c.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(c.accessToken=o.oauthToken,c.secret=o.oauthTokenSecret):ze("argument-error"),c}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:d,signInMethod:p}=c,_=(0,Et.Tt)(c,["providerId","signInMethod"]);if(!d||!p)return null;const T=new _n(d,p);return T.idToken=_.idToken||void 0,T.accessToken=_.accessToken||void 0,T.secret=_.secret,T.nonce=_.nonce,T.pendingToken=_.pendingToken||null,T}_getIdTokenResponse(o){return On(o,this.buildRequest())}_linkToIdToken(o,c){const d=this.buildRequest();return d.idToken=c,On(o,d)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,On(o,c)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const c={};this.idToken&&(c.id_token=this.idToken),this.accessToken&&(c.access_token=this.accessToken),this.secret&&(c.oauth_token_secret=this.secret),c.providerId=this.providerId,this.nonce&&!this.pendingToken&&(c.nonce=this.nonce),o.postBody=(0,u.Am)(c)}return o}}function us(){return(us=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:sendVerificationCode",Pe(l,o))})).apply(this,arguments)}function ds(){return(ds=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithPhoneNumber",Pe(l,o))})).apply(this,arguments)}function ct(){return(ct=(0,v.A)(function*(l,o){const c=yield rn(l,"POST","/v1/accounts:signInWithPhoneNumber",Pe(l,o));if(c.temporaryProof)throw Vr(l,"account-exists-with-different-credential",c);return c})).apply(this,arguments)}const _o={USER_NOT_FOUND:"user-not-found"};function Ja(){return(Ja=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithPhoneNumber",Pe(l,Object.assign(Object.assign({},o),{operation:"REAUTH"})),_o)})).apply(this,arguments)}class Br extends fr{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,c){return new Br({verificationId:o,verificationCode:c})}static _fromTokenResponse(o,c){return new Br({phoneNumber:o,temporaryProof:c})}_getIdTokenResponse(o){return function Ya(l,o){return ds.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,c){return function ft(l,o){return ct.apply(this,arguments)}(o,Object.assign({idToken:c},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function Xa(l,o){return Ja.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:c,verificationId:d,verificationCode:p}=this.params;return o&&c?{temporaryProof:o,phoneNumber:c}:{sessionInfo:d,code:p}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:c,verificationCode:d,phoneNumber:p,temporaryProof:_}=o;return d||c||p||_?new Br({verificationId:c,verificationCode:d,phoneNumber:p,temporaryProof:_}):null}}class hs{constructor(o){var c,d,p,_,T,C;const k=(0,u.I9)((0,u.hp)(o)),q=null!==(c=k.apiKey)&&void 0!==c?c:null,J=null!==(d=k.oobCode)&&void 0!==d?d:null,ee=function Kd(l){switch(l){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(p=k.mode)&&void 0!==p?p:null);N(q&&J&&ee,"argument-error"),this.apiKey=q,this.operation=ee,this.code=J,this.continueUrl=null!==(_=k.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(T=k.languageCode)&&void 0!==T?T:null,this.tenantId=null!==(C=k.tenantId)&&void 0!==C?C:null}static parseLink(o){const c=function Hl(l){const o=(0,u.I9)((0,u.hp)(l)).link,c=o?(0,u.I9)((0,u.hp)(o)).deep_link_id:null,d=(0,u.I9)((0,u.hp)(l)).deep_link_id;return(d?(0,u.I9)((0,u.hp)(d)).link:null)||d||c||o||l}(o);try{return new hs(c)}catch{return null}}}let Za=(()=>{class l{constructor(){this.providerId=l.PROVIDER_ID}static credential(c,d){return ls._fromEmailAndPassword(c,d)}static credentialWithLink(c,d){const p=hs.parseLink(d);return N(p,"argument-error"),ls._fromEmailAndCode(c,p.code,p.tenantId)}}return l.PROVIDER_ID="password",l.EMAIL_PASSWORD_SIGN_IN_METHOD="password",l.EMAIL_LINK_SIGN_IN_METHOD="emailLink",l})();class Yt{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class Nn extends Yt{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class pr extends Nn{static credentialFromJSON(o){const c="string"==typeof o?JSON.parse(o):o;return N("providerId"in c&&"signInMethod"in c,"argument-error"),_n._fromParams(c)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return N(o.idToken||o.accessToken,"argument-error"),_n._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return pr.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return pr.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:c,oauthAccessToken:d,oauthTokenSecret:p,pendingToken:_,nonce:T,providerId:C}=o;if(!d&&!p&&!c&&!_||!C)return null;try{return new pr(C)._credential({idToken:c,accessToken:d,nonce:T,pendingToken:_})}catch{return null}}}let ec=(()=>{class l extends Nn{constructor(){super("facebook.com")}static credential(c){return _n._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.FACEBOOK_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return l.credential(c.oauthAccessToken)}catch{return null}}}return l.FACEBOOK_SIGN_IN_METHOD="facebook.com",l.PROVIDER_ID="facebook.com",l})(),Ql=(()=>{class l extends Nn{constructor(){super("google.com"),this.addScope("profile")}static credential(c,d){return _n._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.GOOGLE_SIGN_IN_METHOD,idToken:c,accessToken:d})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:d,oauthAccessToken:p}=c;if(!d&&!p)return null;try{return l.credential(d,p)}catch{return null}}}return l.GOOGLE_SIGN_IN_METHOD="google.com",l.PROVIDER_ID="google.com",l})(),fs=(()=>{class l extends Nn{constructor(){super("github.com")}static credential(c){return _n._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.GITHUB_SIGN_IN_METHOD,accessToken:c})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c||!("oauthAccessToken"in c)||!c.oauthAccessToken)return null;try{return l.credential(c.oauthAccessToken)}catch{return null}}}return l.GITHUB_SIGN_IN_METHOD="github.com",l.PROVIDER_ID="github.com",l})();class mr extends fr{constructor(o,c){super(o,o),this.pendingToken=c}_getIdTokenResponse(o){return On(o,this.buildRequest())}_linkToIdToken(o,c){const d=this.buildRequest();return d.idToken=c,On(o,d)}_getReauthenticationResolver(o){const c=this.buildRequest();return c.autoCreate=!1,On(o,c)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const c="string"==typeof o?JSON.parse(o):o,{providerId:d,signInMethod:p,pendingToken:_}=c;return d&&p&&_&&d===p?new mr(d,_):null}static _create(o,c){return new mr(o,c)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class yo extends Yt{constructor(o){N(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return yo.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return yo.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const c=mr.fromJSON(o);return N(c,"argument-error"),c}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:c,providerId:d}=o;if(!c||!d)return null;try{return mr._create(d,c)}catch{return null}}}let fi=(()=>{class l extends Nn{constructor(){super("twitter.com")}static credential(c,d){return _n._fromParams({providerId:l.PROVIDER_ID,signInMethod:l.TWITTER_SIGN_IN_METHOD,oauthToken:c,oauthTokenSecret:d})}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthAccessToken:d,oauthTokenSecret:p}=c;if(!d||!p)return null;try{return l.credential(d,p)}catch{return null}}}return l.TWITTER_SIGN_IN_METHOD="twitter.com",l.PROVIDER_ID="twitter.com",l})();function nc(l,o){return vo.apply(this,arguments)}function vo(){return(vo=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signUp",Pe(l,o))})).apply(this,arguments)}class Xt{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,c,d,p=!1){return(0,v.A)(function*(){const _=yield X._fromIdTokenResponse(o,d,p),T=ps(d);return new Xt({user:_,providerId:T,_tokenResponse:d,operationType:c})})()}static _forOperation(o,c,d){return(0,v.A)(function*(){yield o._updateTokensIfNecessary(d,!0);const p=ps(d);return new Xt({user:o,providerId:p,_tokenResponse:d,operationType:c})})()}}function ps(l){return l.providerId?l.providerId:"phoneNumber"in l?"phone":null}function rc(){return(rc=(0,v.A)(function*(l){var o;const c=_e(l);if(yield c._initializationPromise,null!==(o=c.currentUser)&&void 0!==o&&o.isAnonymous)return new Xt({user:c.currentUser,providerId:null,operationType:"signIn"});const d=yield nc(c,{returnSecureToken:!0}),p=yield Xt._fromIdTokenResponse(c,"signIn",d,!0);return yield c._updateCurrentUser(p.user),p})).apply(this,arguments)}class Jn extends u.g{constructor(o,c,d,p){var _;super(c.code,c.message),this.operationType=d,this.user=p,Object.setPrototypeOf(this,Jn.prototype),this.customData={appName:o.name,tenantId:null!==(_=o.tenantId)&&void 0!==_?_:void 0,_serverResponse:c.customData._serverResponse,operationType:d}}static _fromErrorAndOperation(o,c,d,p){return new Jn(o,c,d,p)}}function Xl(l,o,c,d){return("reauthenticate"===o?c._getReauthenticationResolver(l):c._getIdTokenResponse(l)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?Jn._fromErrorAndOperation(l,_,o,d):_})}function Jl(l){return new Set(l.map(({providerId:o})=>o).filter(o=>!!o))}function Io(){return Io=(0,v.A)(function*(l,o){const c=(0,u.Ku)(l);yield gr(!0,c,o);const{providerUserInfo:d}=yield function Ji(l,o){return Qt.apply(this,arguments)}(c.auth,{idToken:yield c.getIdToken(),deleteProvider:[o]}),p=Jl(d||[]);return c.providerData=c.providerData.filter(_=>p.has(_.providerId)),p.has("phone")||(c.phoneNumber=null),yield c.auth._persistUserIfCurrent(c),c}),Io.apply(this,arguments)}function pi(l,o){return To.apply(this,arguments)}function To(){return(To=(0,v.A)(function*(l,o,c=!1){const d=yield on(l,o._linkToIdToken(l.auth,yield l.getIdToken()),c);return Xt._forOperation(l,"link",d)})).apply(this,arguments)}function gr(l,o,c){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,v.A)(function*(l,o,c){yield Ut(o);const p=!1===l?"provider-already-linked":"no-such-provider";N(Jl(o.providerData).has(c)===l,o.auth,p)})).apply(this,arguments)}function Rt(l,o){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,v.A)(function*(l,o,c=!1){const{auth:d}=l,p="reauthenticate";try{const _=yield on(l,Xl(d,p,o,l),c);N(_.idToken,d,"internal-error");const T=ur(_.idToken);N(T,d,"internal-error");const{sub:C}=T;return N(l.uid===C,d,"user-mismatch"),Xt._forOperation(l,p,_)}catch(_){throw"auth/user-not-found"===_?.code&&ze(d,"user-mismatch"),_}})).apply(this,arguments)}function mi(l,o){return gi.apply(this,arguments)}function gi(){return(gi=(0,v.A)(function*(l,o,c=!1){const d="signIn",p=yield Xl(l,d,o),_=yield Xt._fromIdTokenResponse(l,d,p);return c||(yield l._updateCurrentUser(_.user)),_})).apply(this,arguments)}function ms(l,o){return gs.apply(this,arguments)}function gs(){return(gs=(0,v.A)(function*(l,o){return mi(_e(l),o)})).apply(this,arguments)}function ic(l,o){return wo.apply(this,arguments)}function wo(){return(wo=(0,v.A)(function*(l,o){const c=(0,u.Ku)(l);return yield gr(!1,c,o.providerId),pi(c,o)})).apply(this,arguments)}function _i(l,o){return _s.apply(this,arguments)}function _s(){return(_s=(0,v.A)(function*(l,o){return Rt((0,u.Ku)(l),o)})).apply(this,arguments)}function ys(){return(ys=(0,v.A)(function*(l,o){return rn(l,"POST","/v1/accounts:signInWithCustomToken",Pe(l,o))})).apply(this,arguments)}function Gr(){return Gr=(0,v.A)(function*(l,o){const c=_e(l),d=yield function sc(l,o){return ys.apply(this,arguments)}(c,{token:o,returnSecureToken:!0}),p=yield Xt._fromIdTokenResponse(c,"signIn",d);return yield c._updateCurrentUser(p.user),p}),Gr.apply(this,arguments)}class yi{constructor(o,c){this.factorId=o,this.uid=c.mfaEnrollmentId,this.enrollmentTime=new Date(c.enrolledAt).toUTCString(),this.displayName=c.displayName}static _fromServerResponse(o,c){return"phoneInfo"in c?oc._fromServerResponse(o,c):"totpInfo"in c?Co._fromServerResponse(o,c):ze(o,"internal-error")}}class oc extends yi{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,c){return new oc(c)}}class Co extends yi{constructor(o){super("totp",o)}static _fromServerResponse(o,c){return new Co(c)}}function vi(l,o,c){var d;N((null===(d=c.url)||void 0===d?void 0:d.length)>0,l,"invalid-continue-uri"),N(typeof c.dynamicLinkDomain>"u"||c.dynamicLinkDomain.length>0,l,"invalid-dynamic-link-domain"),o.continueUrl=c.url,o.dynamicLinkDomain=c.dynamicLinkDomain,o.canHandleCodeInApp=c.handleCodeInApp,c.iOS&&(N(c.iOS.bundleId.length>0,l,"missing-ios-bundle-id"),o.iOSBundleId=c.iOS.bundleId),c.android&&(N(c.android.packageName.length>0,l,"missing-android-pkg-name"),o.androidInstallApp=c.android.installApp,o.androidMinimumVersionCode=c.android.minimumVersion,o.androidPackageName=c.android.packageName)}function vs(l){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,v.A)(function*(l){const o=_e(l);o._getPasswordPolicyInternal()&&(yield o._updatePasswordPolicy())})).apply(this,arguments)}function So(){return(So=(0,v.A)(function*(l,o,c){const d=_e(l),p={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};c&&vi(d,p,c),yield hr(d,p,"getOobCode",$l)})).apply(this,arguments)}function jr(){return jr=(0,v.A)(function*(l,o,c){yield ho((0,u.Ku)(l),{oobCode:o,newPassword:c}).catch(function(){var d=(0,v.A)(function*(p){throw"auth/password-does-not-meet-requirements"===p.code&&vs(l),p});return function(p){return d.apply(this,arguments)}}())}),jr.apply(this,arguments)}function Ii(){return Ii=(0,v.A)(function*(l,o){yield function ss(l,o){return ja.apply(this,arguments)}((0,u.Ku)(l),{oobCode:o})}),Ii.apply(this,arguments)}function Ti(l,o){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,v.A)(function*(l,o){const c=(0,u.Ku)(l),d=yield ho(c,{oobCode:o}),p=d.requestType;switch(N(p,c,"internal-error"),p){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":N(d.newEmail,c,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":N(d.mfaInfo,c,"internal-error");default:N(d.email,c,"internal-error")}let _=null;return d.mfaInfo&&(_=yi._fromServerResponse(_e(c),d.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===d.requestType?d.newEmail:d.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===d.requestType?d.email:d.newEmail)||null,multiFactorInfo:_},operation:p}})).apply(this,arguments)}function cc(){return(cc=(0,v.A)(function*(l,o){const{data:c}=yield Ti((0,u.Ku)(l),o);return c.email})).apply(this,arguments)}function Po(){return(Po=(0,v.A)(function*(l,o,c){const d=_e(l),T=yield hr(d,{returnSecureToken:!0,email:o,password:c,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",nc).catch(k=>{throw"auth/password-does-not-meet-requirements"===k.code&&vs(l),k}),C=yield Xt._fromIdTokenResponse(d,"signIn",T);return yield d._updateCurrentUser(C.user),C})).apply(this,arguments)}function er(){return(er=(0,v.A)(function*(l,o,c){const d=_e(l),p={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};(function _(T,C){N(C.handleCodeInApp,d,"argument-error"),C&&vi(d,T,C)})(p,c),yield hr(d,p,"getOobCode",Kl)})).apply(this,arguments)}function Ei(){return(Ei=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l),p=Za.credentialWithLink(o,c||Rn());return N(p._tenantId===(d.tenantId||null),d,"tenant-id-mismatch"),ms(d,p)})).apply(this,arguments)}function Me(){return(Me=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:createAuthUri",Pe(l,o))})).apply(this,arguments)}function qr(){return qr=(0,v.A)(function*(l,o){const d={identifier:o,continueUri:ar()?Rn():"http://localhost"},{signinMethods:p}=yield function nu(l,o){return Me.apply(this,arguments)}((0,u.Ku)(l),d);return p||[]}),qr.apply(this,arguments)}function lc(){return lc=(0,v.A)(function*(l,o){const c=(0,u.Ku)(l),p={requestType:"VERIFY_EMAIL",idToken:yield l.getIdToken()};o&&vi(c.auth,p,o);const{email:_}=yield function $a(l,o){return Ka.apply(this,arguments)}(c.auth,p);_!==l.email&&(yield l.reload())}),lc.apply(this,arguments)}function uc(){return uc=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield l.getIdToken(),newEmail:o};c&&vi(d.auth,_,c);const{email:T}=yield function Wa(l,o){return as.apply(this,arguments)}(d.auth,_);T!==l.email&&(yield l.reload())}),uc.apply(this,arguments)}function dc(){return(dc=(0,v.A)(function*(l,o){return De(l,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function $r(){return $r=(0,v.A)(function*(l,{displayName:o,photoURL:c}){if(void 0===o&&void 0===c)return;const d=(0,u.Ku)(l),_={idToken:yield d.getIdToken(),displayName:o,photoUrl:c,returnSecureToken:!0},T=yield on(d,function Xd(l,o){return dc.apply(this,arguments)}(d.auth,_));d.displayName=T.displayName||null,d.photoURL=T.photoUrl||null;const C=d.providerData.find(({providerId:k})=>"password"===k);C&&(C.displayName=d.displayName,C.photoURL=d.photoURL),yield d._updateTokensIfNecessary(T)}),$r.apply(this,arguments)}function hc(l,o,c){return ko.apply(this,arguments)}function ko(){return ko=(0,v.A)(function*(l,o,c){const{auth:d}=l,_={idToken:yield l.getIdToken(),returnSecureToken:!0};o&&(_.email=o),c&&(_.password=c);const T=yield on(l,function za(l,o){return is.apply(this,arguments)}(d,_));yield l._updateTokensIfNecessary(T,!0)}),ko.apply(this,arguments)}class wi{constructor(o,c,d={}){this.isNewUser=o,this.providerId=c,this.profile=d}}class su extends wi{constructor(o,c,d,p){super(o,c,d),this.username=p}}class ou extends wi{constructor(o,c){super(o,"facebook.com",c)}}class Zd extends su{constructor(o,c){super(o,"github.com",c,"string"==typeof c?.login?c?.login:null)}}class au extends wi{constructor(o,c){super(o,"google.com",c)}}class cu extends su{constructor(o,c,d){super(o,"twitter.com",c,d)}}function fc(l){const{user:o,_tokenResponse:c}=l;return o.isAnonymous&&!c?{providerId:null,isNewUser:!1,profile:null}:function Ai(l){var o,c;if(!l)return null;const{providerId:d}=l,p=l.rawUserInfo?JSON.parse(l.rawUserInfo):{},_=l.isNewUser||"identitytoolkit#SignupNewUserResponse"===l.kind;if(!d&&l?.idToken){const T=null===(c=null===(o=ur(l.idToken))||void 0===o?void 0:o.firebase)||void 0===c?void 0:c.sign_in_provider;if(T)return new wi(_,"anonymous"!==T&&"custom"!==T?T:null)}if(!d)return null;switch(d){case"facebook.com":return new ou(_,p);case"github.com":return new Zd(_,p);case"google.com":return new au(_,p);case"twitter.com":return new cu(_,p,l.screenName||null);case"custom":case"anonymous":return new wi(_,null);default:return new wi(_,d,p)}}(c)}class yn{constructor(o,c,d){this.type=o,this.credential=c,this.user=d}static _fromIdtoken(o,c){return new yn("enroll",o,c)}static _fromMfaPendingCredential(o){return new yn("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var c,d;if(o?.multiFactorSession){if(null!==(c=o.multiFactorSession)&&void 0!==c&&c.pendingCredential)return yn._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(d=o.multiFactorSession)&&void 0!==d&&d.idToken)return yn._fromIdtoken(o.multiFactorSession.idToken)}return null}}class _c{constructor(o,c,d){this.session=o,this.hints=c,this.signInResolver=d}static _fromError(o,c){const d=_e(o),p=c.customData._serverResponse,_=(p.mfaInfo||[]).map(C=>yi._fromServerResponse(d,C));N(p.mfaPendingCredential,d,"internal-error");const T=yn._fromMfaPendingCredential(p.mfaPendingCredential);return new _c(T,_,function(){var C=(0,v.A)(function*(k){const q=yield k._process(d,T);delete p.mfaInfo,delete p.mfaPendingCredential;const J=Object.assign(Object.assign({},p),{idToken:q.idToken,refreshToken:q.refreshToken});switch(c.operationType){case"signIn":const ee=yield Xt._fromIdTokenResponse(d,c.operationType,J);return yield d._updateCurrentUser(ee.user),ee;case"reauthenticate":return N(c.user,d,"internal-error"),Xt._forOperation(c.user,c.operationType,J);default:ze(d,"internal-error")}});return function(k){return C.apply(this,arguments)}}())}resolveSignIn(o){var c=this;return(0,v.A)(function*(){return c.signInResolver(o)})()}}class No{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(c=>{c.mfaInfo&&(this.enrolledFactors=c.mfaInfo.map(d=>yi._fromServerResponse(o.auth,d)))})}static _fromUser(o){return new No(o)}getSession(){var o=this;return(0,v.A)(function*(){return yn._fromIdtoken(yield o.user.getIdToken(),o.user)})()}enroll(o,c){var d=this;return(0,v.A)(function*(){const p=o,_=yield d.getSession(),T=yield on(d.user,p._process(d.user.auth,_,c));return yield d.user._updateTokensIfNecessary(T),d.user.reload()})()}unenroll(o){var c=this;return(0,v.A)(function*(){const d="string"==typeof o?o:o.uid,p=yield c.user.getIdToken();try{const _=yield on(c.user,function hu(l,o){return De(l,"POST","/v2/accounts/mfaEnrollment:withdraw",Pe(l,o))}(c.user.auth,{idToken:p,mfaEnrollmentId:d}));c.enrolledFactors=c.enrolledFactors.filter(({uid:T})=>T!==d),yield c.user._updateTokensIfNecessary(_),yield c.user.reload()}catch(_){throw _}})()}}const Vo=new WeakMap,Ts="__sak";class vn{constructor(o,c){this.storageRetriever=o,this.type=c}_isAvailable(){try{return this.storage?(this.storage.setItem(Ts,"1"),this.storage.removeItem(Ts),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,c){return this.storage.setItem(o,JSON.stringify(c)),Promise.resolve()}_get(o){const c=this.storage.getItem(o);return Promise.resolve(c?JSON.parse(c):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const yr=(()=>{class l extends vn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(c,d)=>this.onStorageEvent(c,d),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function fu(){const l=(0,u.ZQ)();return Dn(l)||Y(l)}()&&function se(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=$e(),this._shouldAllowMigration=!0}forAllChangedKeys(c){for(const d of Object.keys(this.listeners)){const p=this.storage.getItem(d),_=this.localCache[d];p!==_&&c(d,_,p)}}onStorageEvent(c,d=!1){if(!c.key)return void this.forAllChangedKeys((C,k,q)=>{this.notifyListeners(C,q)});const p=c.key;if(d?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const C=this.storage.getItem(p);if(c.newValue!==C)null!==c.newValue?this.storage.setItem(p,c.newValue):this.storage.removeItem(p);else if(this.localCache[p]===c.newValue&&!d)return}const _=()=>{const C=this.storage.getItem(p);!d&&this.localCache[p]===C||this.notifyListeners(p,C)},T=this.storage.getItem(p);!function z(){return(0,u.lT)()&&10===document.documentMode}()||T===c.newValue||c.newValue===c.oldValue?_():setTimeout(_,10)}notifyListeners(c,d){this.localCache[c]=d;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(d&&JSON.parse(d))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((c,d,p)=>{this.onStorageEvent(new StorageEvent("storage",{key:c,oldValue:d,newValue:p}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(c,d){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[c]||(this.listeners[c]=new Set,this.localCache[c]=this.storage.getItem(c)),this.listeners[c].add(d)}_removeListener(c,d){this.listeners[c]&&(this.listeners[c].delete(d),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(c,d){var p=()=>super._set,_=this;return(0,v.A)(function*(){yield p().call(_,c,d),_.localCache[c]=JSON.stringify(d)})()}_get(c){var d=()=>super._get,p=this;return(0,v.A)(function*(){const _=yield d().call(p,c);return p.localCache[c]=JSON.stringify(_),_})()}_remove(c){var d=()=>super._remove,p=this;return(0,v.A)(function*(){yield d().call(p,c),delete p.localCache[c]})()}}return l.type="LOCAL",l})(),Vn=(()=>{class l extends vn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(c,d){}_removeListener(c,d){}}return l.type="SESSION",l})();let gu=(()=>{class l{constructor(c){this.eventTarget=c,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(c){const d=this.receivers.find(_=>_.isListeningto(c));if(d)return d;const p=new l(c);return this.receivers.push(p),p}isListeningto(c){return this.eventTarget===c}handleEvent(c){var d=this;return(0,v.A)(function*(){const p=c,{eventId:_,eventType:T,data:C}=p.data,k=d.handlersMap[T];if(!k?.size)return;p.ports[0].postMessage({status:"ack",eventId:_,eventType:T});const q=Array.from(k).map(function(){var ee=(0,v.A)(function*(Ke){return Ke(p.origin,C)});return function(Ke){return ee.apply(this,arguments)}}()),J=yield function Lo(l){return Promise.all(l.map(function(){var o=(0,v.A)(function*(c){try{return{fulfilled:!0,value:yield c}}catch(d){return{fulfilled:!1,reason:d}}});return function(c){return o.apply(this,arguments)}}()))}(q);p.ports[0].postMessage({status:"done",eventId:_,eventType:T,response:J})})()}_subscribe(c,d){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[c]||(this.handlersMap[c]=new Set),this.handlersMap[c].add(d)}_unsubscribe(c,d){this.handlersMap[c]&&d&&this.handlersMap[c].delete(d),(!d||0===this.handlersMap[c].size)&&delete this.handlersMap[c],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return l.receivers=[],l})();function vr(l="",o=10){let c="";for(let d=0;d<o;d++)c+=Math.floor(10*Math.random());return l+c}class lh{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,c,d=50){var p=this;return(0,v.A)(function*(){const _=typeof MessageChannel<"u"?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let T,C;return new Promise((k,q)=>{const J=vr("",20);_.port1.start();const ee=setTimeout(()=>{q(new Error("unsupported_event"))},d);C={messageChannel:_,onMessage(Ke){const bn=Ke;if(bn.data.eventId===J)switch(bn.data.status){case"ack":clearTimeout(ee),T=setTimeout(()=>{q(new Error("timeout"))},3e3);break;case"done":clearTimeout(T),k(bn.data.response);break;default:clearTimeout(ee),clearTimeout(T),q(new Error("invalid_response"))}}},p.handlers.add(C),_.port1.addEventListener("message",C.onMessage),p.target.postMessage({eventType:o,eventId:J,data:c},[_.port2])}).finally(()=>{C&&p.removeMessageHandler(C)})})()}}function nt(){return window}function Fo(){return typeof nt().WorkerGlobalScope<"u"&&"function"==typeof nt().importScripts}function As(){return(As=(0,v.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const ws="firebaseLocalStorageDb",bs="firebaseLocalStorage",Ir="fbase_key";class bi{constructor(o){this.request=o}toPromise(){return new Promise((o,c)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{c(this.request.error)})})}}function Cs(l,o){return l.transaction([bs],o?"readwrite":"readonly").objectStore(bs)}function Uo(){const l=indexedDB.open(ws,1);return new Promise((o,c)=>{l.addEventListener("error",()=>{c(l.error)}),l.addEventListener("upgradeneeded",()=>{const d=l.result;try{d.createObjectStore(bs,{keyPath:Ir})}catch(p){c(p)}}),l.addEventListener("success",(0,v.A)(function*(){const d=l.result;d.objectStoreNames.contains(bs)?o(d):(d.close(),yield function Iu(){const l=indexedDB.deleteDatabase(ws);return new bi(l).toPromise()}(),o(yield Uo()))}))})}function Rs(l,o,c){return Vt.apply(this,arguments)}function Vt(){return(Vt=(0,v.A)(function*(l,o,c){const d=Cs(l,!0).put({[Ir]:o,value:c});return new bi(d).toPromise()})).apply(this,arguments)}function Bo(){return(Bo=(0,v.A)(function*(l,o){const c=Cs(l,!1).get(o),d=yield new bi(c).toPromise();return void 0===d?null:d.value})).apply(this,arguments)}function Wr(l,o){const c=Cs(l,!0).delete(o);return new bi(c).toPromise()}const Re=(()=>{class l{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var c=this;return(0,v.A)(function*(){return c.db||(c.db=yield Uo()),c.db})()}_withRetries(c){var d=this;return(0,v.A)(function*(){let p=0;for(;;)try{const _=yield d._openDb();return yield c(_)}catch(_){if(p++>3)throw _;d.db&&(d.db.close(),d.db=void 0)}})()}initializeServiceWorkerMessaging(){var c=this;return(0,v.A)(function*(){return Fo()?c.initializeReceiver():c.initializeSender()})()}initializeReceiver(){var c=this;return(0,v.A)(function*(){c.receiver=gu._getInstance(function yu(){return Fo()?self:null}()),c.receiver._subscribe("keyChanged",function(){var d=(0,v.A)(function*(p,_){return{keyProcessed:(yield c._poll()).includes(_.key)}});return function(p,_){return d.apply(this,arguments)}}()),c.receiver._subscribe("ping",function(){var d=(0,v.A)(function*(p,_){return["keyChanged"]});return function(p,_){return d.apply(this,arguments)}}())})()}initializeSender(){var c=this;return(0,v.A)(function*(){var d,p;if(c.activeServiceWorker=yield function _u(){return As.apply(this,arguments)}(),!c.activeServiceWorker)return;c.sender=new lh(c.activeServiceWorker);const _=yield c.sender._send("ping",{},800);_&&null!==(d=_[0])&&void 0!==d&&d.fulfilled&&null!==(p=_[0])&&void 0!==p&&p.value.includes("keyChanged")&&(c.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(c){var d=this;return(0,v.A)(function*(){if(d.sender&&d.activeServiceWorker&&function yc(){var l;return(null===(l=navigator?.serviceWorker)||void 0===l?void 0:l.controller)||null}()===d.activeServiceWorker)try{yield d.sender._send("keyChanged",{key:c},d.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,v.A)(function*(){try{if(!indexedDB)return!1;const c=yield Uo();return yield Rs(c,Ts,"1"),yield Wr(c,Ts),!0}catch{}return!1})()}_withPendingWrite(c){var d=this;return(0,v.A)(function*(){d.pendingWrites++;try{yield c()}finally{d.pendingWrites--}})()}_set(c,d){var p=this;return(0,v.A)(function*(){return p._withPendingWrite((0,v.A)(function*(){return yield p._withRetries(_=>Rs(_,c,d)),p.localCache[c]=d,p.notifyServiceWorker(c)}))})()}_get(c){var d=this;return(0,v.A)(function*(){const p=yield d._withRetries(_=>function Tu(l,o){return Bo.apply(this,arguments)}(_,c));return d.localCache[c]=p,p})()}_remove(c){var d=this;return(0,v.A)(function*(){return d._withPendingWrite((0,v.A)(function*(){return yield d._withRetries(p=>Wr(p,c)),delete d.localCache[c],d.notifyServiceWorker(c)}))})()}_poll(){var c=this;return(0,v.A)(function*(){const d=yield c._withRetries(T=>{const C=Cs(T,!1).getAll();return new bi(C).toPromise()});if(!d)return[];if(0!==c.pendingWrites)return[];const p=[],_=new Set;if(0!==d.length)for(const{fbase_key:T,value:C}of d)_.add(T),JSON.stringify(c.localCache[T])!==JSON.stringify(C)&&(c.notifyListeners(T,C),p.push(T));for(const T of Object.keys(c.localCache))c.localCache[T]&&!_.has(T)&&(c.notifyListeners(T,null),p.push(T));return p})()}notifyListeners(c,d){this.localCache[c]=d;const p=this.listeners[c];if(p)for(const _ of Array.from(p))_(d)}startPolling(){var c=this;this.stopPolling(),this.pollTimer=setInterval((0,v.A)(function*(){return c._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(c,d){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[c]||(this.listeners[c]=new Set,this._get(c)),this.listeners[c].add(d)}_removeListener(c,d){this.listeners[c]&&(this.listeners[c].delete(d),0===this.listeners[c].size&&delete this.listeners[c]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return l.type="LOCAL",l})(),nr=1e12;class Tc{constructor(o){this.auth=o,this.counter=nr,this._widgets=new Map}render(o,c){const d=this.counter;return this._widgets.set(d,new wu(o,this.auth.name,c||{})),this.counter++,d}reset(o){var c;const d=o||nr;null===(c=this._widgets.get(d))||void 0===c||c.delete(),this._widgets.delete(d)}getResponse(o){var c;return(null===(c=this._widgets.get(o||nr))||void 0===c?void 0:c.getResponse())||""}execute(o){var c=this;return(0,v.A)(function*(){var d;return null===(d=c._widgets.get(o||nr))||void 0===d||d.execute(),""})()}}class wu{constructor(o,c,d){this.params=d,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const p="string"==typeof o?document.getElementById(o):o;N(p,"argument-error",{appName:c}),this.container=p,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function rr(l){const o=[],c="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let d=0;d<l;d++)o.push(c.charAt(Math.floor(62*Math.random())));return o.join("")}(50);const{callback:o,"expired-callback":c}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,c)try{c()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const zt=Ll("rcb"),It=new nn(3e4,6e4);class Go{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=nt().grecaptcha)||void 0===o||!o.render)}load(o,c=""){return N(function Ss(l){return l.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(l)}(c),o,"argument-error"),this.shouldResolveImmediately(c)&&Yi(nt().grecaptcha)?Promise.resolve(nt().grecaptcha):new Promise((d,p)=>{const _=nt().setTimeout(()=>{p(qe(o,"network-request-failed"))},It.get());nt()[zt]=()=>{nt().clearTimeout(_),delete nt()[zt];const C=nt().grecaptcha;if(!C||!Yi(C))return void p(qe(o,"internal-error"));const k=C.render;C.render=(q,J)=>{const ee=k(q,J);return this.counter++,ee},this.hostLanguage=c,d(C)},kn(`https://www.google.com/recaptcha/api.js??${(0,u.Am)({onload:zt,render:"explicit",hl:c})}`).catch(()=>{clearTimeout(_),p(qe(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var c;return!(null===(c=nt().grecaptcha)||void 0===c||!c.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class jo{load(o){return(0,v.A)(function*(){return new Tc(o)})()}clearedOneInstance(){}}const Ec="recaptcha",Ci={theme:"light",type:"image"};class hh{constructor(o,c,d=Object.assign({},Ci)){this.parameters=d,this.type=Ec,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=_e(o),this.isInvisible="invisible"===this.parameters.size,N(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const p="string"==typeof c?document.getElementById(c):c;N(p,this.auth,"argument-error"),this.container=p,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new jo:new Go,this.validateStartingState()}verify(){var o=this;return(0,v.A)(function*(){o.assertNotDestroyed();const c=yield o.render(),d=o.getAssertedRecaptcha();return d.getResponse(c)||new Promise(_=>{const T=C=>{C&&(o.tokenChangeListeners.delete(T),_(C))};o.tokenChangeListeners.add(T),o.isInvisible&&d.execute(c)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){N(!this.parameters.sitekey,this.auth,"argument-error"),N(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),N(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return c=>{if(this.tokenChangeListeners.forEach(d=>d(c)),"function"==typeof o)o(c);else if("string"==typeof o){const d=nt()[o];"function"==typeof d&&d(c)}}}assertNotDestroyed(){N(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,v.A)(function*(){if(yield o.init(),!o.widgetId){let c=o.container;if(!o.isInvisible){const d=document.createElement("div");c.appendChild(d),c=d}o.widgetId=o.getAssertedRecaptcha().render(c,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,v.A)(function*(){N(ar()&&!Fo(),o.auth,"internal-error"),yield function fh(){let l=null;return new Promise(o=>{"complete"!==document.readyState?(l=()=>o(),window.addEventListener("load",l)):o()}).catch(o=>{throw l&&window.removeEventListener("load",l),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const c=yield function ao(l){return Mr.apply(this,arguments)}(o.auth);N(c,o.auth,"internal-error"),o.parameters.sitekey=c})()}getAssertedRecaptcha(){return N(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Ps{constructor(o,c){this.verificationId=o,this.onConfirmation=c}confirm(o){const c=Br._fromVerification(this.verificationId,o);return this.onConfirmation(c)}}function Ac(){return(Ac=(0,v.A)(function*(l,o,c){const d=_e(l),p=yield $o(d,o,(0,u.Ku)(c));return new Ps(p,_=>ms(d,_))})).apply(this,arguments)}function Cu(){return(Cu=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l);yield gr(!1,d,"phone");const p=yield $o(d.auth,o,(0,u.Ku)(c));return new Ps(p,_=>ic(d,_))})).apply(this,arguments)}function wc(){return(wc=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l),p=yield $o(d.auth,o,(0,u.Ku)(c));return new Ps(p,_=>_i(d,_))})).apply(this,arguments)}function $o(l,o,c){return Tr.apply(this,arguments)}function Tr(){return Tr=(0,v.A)(function*(l,o,c){var d;const p=yield c.verify();try{let _;if(N("string"==typeof p,l,"argument-error"),N(c.type===Ec,l,"argument-error"),_="string"==typeof o?{phoneNumber:o}:o,"session"in _){const T=_.session;if("phoneNumber"in _)return N("enroll"===T.type,l,"internal-error"),(yield function du(l,o){return De(l,"POST","/v2/accounts/mfaEnrollment:start",Pe(l,o))}(l,{idToken:T.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:p}})).phoneSessionInfo.sessionInfo;{N("signin"===T.type,l,"internal-error");const C=(null===(d=_.multiFactorHint)||void 0===d?void 0:d.uid)||_.multiFactorUid;return N(C,l,"missing-multi-factor-info"),(yield function dh(l,o){return De(l,"POST","/v2/accounts/mfaSignIn:start",Pe(l,o))}(l,{mfaPendingCredential:T.credential,mfaEnrollmentId:C,phoneSignInInfo:{recaptchaToken:p}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:T}=yield function $d(l,o){return us.apply(this,arguments)}(l,{phoneNumber:_.phoneNumber,recaptchaToken:p});return T}}finally{c._reset()}}),Tr.apply(this,arguments)}function ot(){return(ot=(0,v.A)(function*(l,o){yield pi((0,u.Ku)(l),o)})).apply(this,arguments)}let Ln=(()=>{class l{constructor(c){this.providerId=l.PROVIDER_ID,this.auth=_e(c)}verifyPhoneNumber(c,d){return $o(this.auth,c,(0,u.Ku)(d))}static credential(c,d){return Br._fromVerification(c,d)}static credentialFromResult(c){return l.credentialFromTaggedObject(c)}static credentialFromError(c){return l.credentialFromTaggedObject(c.customData||{})}static credentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{phoneNumber:d,temporaryProof:p}=c;return d&&p?Br._fromTokenResponse(d,p):null}}return l.PROVIDER_ID="phone",l.PHONE_SIGN_IN_METHOD="phone",l})();function Gt(l,o){return o?ve(o):(N(l._popupRedirectResolver,l,"argument-error"),l._popupRedirectResolver)}class Er extends fr{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return On(o,this._buildIdpRequest())}_linkToIdToken(o,c){return On(o,this._buildIdpRequest(c))}_getReauthenticationResolver(o){return On(o,this._buildIdpRequest())}_buildIdpRequest(o){const c={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(c.idToken=o),c}}function mh(l){return mi(l.auth,new Er(l),l.bypassAuthState)}function M(l){const{auth:o,user:c}=l;return N(c,o,"internal-error"),Rt(c,new Er(l),l.bypassAuthState)}function rt(l){return St.apply(this,arguments)}function St(){return(St=(0,v.A)(function*(l){const{auth:o,user:c}=l;return N(c,o,"internal-error"),pi(c,new Er(l),l.bypassAuthState)})).apply(this,arguments)}class Ko{constructor(o,c,d,p,_=!1){this.auth=o,this.resolver=d,this.user=p,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(c)?c:[c]}execute(){var o=this;return new Promise(function(){var c=(0,v.A)(function*(d,p){o.pendingPromise={resolve:d,reject:p};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(_){o.reject(_)}});return function(d,p){return c.apply(this,arguments)}}())}onAuthEvent(o){var c=this;return(0,v.A)(function*(){const{urlResponse:d,sessionId:p,postBody:_,tenantId:T,error:C,type:k}=o;if(C)return void c.reject(C);const q={auth:c.auth,requestUri:d,sessionId:p,tenantId:T||void 0,postBody:_||void 0,user:c.user,bypassAuthState:c.bypassAuthState};try{c.resolve(yield c.getIdpTask(k)(q))}catch(J){c.reject(J)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return mh;case"linkViaPopup":case"linkViaRedirect":return rt;case"reauthViaPopup":case"reauthViaRedirect":return M;default:ze(this.auth,"internal-error")}}resolve(o){st(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){st(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Z=new nn(2e3,1e4);function bc(){return(bc=(0,v.A)(function*(l,o,c){const d=_e(l);be(l,o,Yt);const p=Gt(d,c);return new Wo(d,"signInViaPopup",o,p).executeNotNull()})).apply(this,arguments)}function x(){return(x=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l);be(d.auth,o,Yt);const p=Gt(d.auth,c);return new Wo(d.auth,"reauthViaPopup",o,p,d).executeNotNull()})).apply(this,arguments)}function it(){return(it=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l);be(d.auth,o,Yt);const p=Gt(d.auth,c);return new Wo(d.auth,"linkViaPopup",o,p,d).executeNotNull()})).apply(this,arguments)}let Wo=(()=>{class l extends Ko{constructor(c,d,p,_,T){super(c,d,_,T),this.provider=p,this.authWindow=null,this.pollId=null,l.currentPopupAction&&l.currentPopupAction.cancel(),l.currentPopupAction=this}executeNotNull(){var c=this;return(0,v.A)(function*(){const d=yield c.execute();return N(d,c.auth,"internal-error"),d})()}onExecution(){var c=this;return(0,v.A)(function*(){st(1===c.filter.length,"Popup operations only handle one event");const d=vr();c.authWindow=yield c.resolver._openPopup(c.auth,c.provider,c.filter[0],d),c.authWindow.associatedEvent=d,c.resolver._originValidation(c.auth).catch(p=>{c.reject(p)}),c.resolver._isIframeWebStorageSupported(c.auth,p=>{p||c.reject(qe(c.auth,"web-storage-unsupported"))}),c.pollUserCancellation()})()}get eventId(){var c;return(null===(c=this.authWindow)||void 0===c?void 0:c.associatedEvent)||null}cancel(){this.reject(qe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,l.currentPopupAction=null}pollUserCancellation(){const c=()=>{var d,p;this.pollId=null!==(p=null===(d=this.authWindow)||void 0===d?void 0:d.window)&&void 0!==p&&p.closed?window.setTimeout(()=>{this.pollId=null,this.reject(qe(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(c,Z.get())};c()}}return l.currentPopupAction=null,l})();const gh="pendingRedirect",xs=new Map;class _h extends Ko{constructor(o,c,d=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],c,void 0,d),this.eventId=null}execute(){var o=()=>super.execute,c=this;return(0,v.A)(function*(){let d=xs.get(c.auth._key());if(!d){try{const _=(yield function yh(l,o){return Cc.apply(this,arguments)}(c.resolver,c.auth))?yield o().call(c):null;d=()=>Promise.resolve(_)}catch(p){d=()=>Promise.reject(p)}xs.set(c.auth._key(),d)}return c.bypassAuthState||xs.set(c.auth._key(),()=>Promise.resolve(null)),d()})()}onAuthEvent(o){var c=()=>super.onAuthEvent,d=this;return(0,v.A)(function*(){if("signInViaRedirect"===o.type)return c().call(d,o);if("unknown"!==o.type){if(o.eventId){const p=yield d.auth._redirectUserForId(o.eventId);if(p)return d.user=p,c().call(d,o);d.resolve(null)}}else d.resolve(null)})()}onExecution(){return(0,v.A)(function*(){})()}cleanUp(){}}function Cc(){return(Cc=(0,v.A)(function*(l,o){const c=de(o),d=Pc(l);if(!(yield d._isAvailable()))return!1;const p="true"===(yield d._get(c));return yield d._remove(c),p})).apply(this,arguments)}function Ho(l,o){return Rc.apply(this,arguments)}function Rc(){return(Rc=(0,v.A)(function*(l,o){return Pc(l)._set(de(o),"true")})).apply(this,arguments)}function Sc(l,o){xs.set(l._key(),o)}function Pc(l){return ve(l._redirectPersistence)}function de(l){return yt(gh,l.config.apiKey,l.name)}function Ri(l,o,c){return function Su(l,o,c){return Fe.apply(this,arguments)}(l,o,c)}function Fe(){return(Fe=(0,v.A)(function*(l,o,c){const d=_e(l);be(l,o,Yt),yield d._initializationPromise;const p=Gt(d,c);return yield Ho(p,d),p._openRedirect(d,o,"signInViaRedirect")})).apply(this,arguments)}function ne(l,o,c){return function Ds(l,o,c){return Ae.apply(this,arguments)}(l,o,c)}function Ae(){return(Ae=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l);be(d.auth,o,Yt),yield d.auth._initializationPromise;const p=Gt(d.auth,c);yield Ho(p,d.auth);const _=yield Ar(d);return p._openRedirect(d.auth,o,"reauthViaRedirect",_)})).apply(this,arguments)}function vh(l,o,c){return function Ge(l,o,c){return $.apply(this,arguments)}(l,o,c)}function $(){return($=(0,v.A)(function*(l,o,c){const d=(0,u.Ku)(l);be(d.auth,o,Yt),yield d.auth._initializationPromise;const p=Gt(d.auth,c);yield gr(!1,d,o.providerId),yield Ho(p,d.auth);const _=yield Ar(d);return p._openRedirect(d.auth,o,"linkViaRedirect",_)})).apply(this,arguments)}function ks(){return(ks=(0,v.A)(function*(l,o){return yield _e(l)._initializationPromise,Fn(l,o,!1)})).apply(this,arguments)}function Fn(l,o){return xc.apply(this,arguments)}function xc(){return(xc=(0,v.A)(function*(l,o,c=!1){const d=_e(l),p=Gt(d,o),T=yield new _h(d,p,c).execute();return T&&!c&&(delete T.user._redirectEventId,yield d._persistUserIfCurrent(T.user),yield d._setRedirectUser(null,o)),T})).apply(this,arguments)}function Ar(l){return Dc.apply(this,arguments)}function Dc(){return(Dc=(0,v.A)(function*(l){const o=vr(`${l.uid}:::`);return l._redirectEventId=o,yield l.auth._setRedirectUser(l),yield l.auth._persistUserIfCurrent(l),o})).apply(this,arguments)}class kc{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let c=!1;return this.consumers.forEach(d=>{this.isEventForConsumer(o,d)&&(c=!0,this.sendToConsumer(o,d),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function Nc(l){switch(l.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jt(l);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,c||(this.queuedRedirectEvent=o,c=!0)),c}sendToConsumer(o,c){var d;if(o.error&&!jt(o)){const p=(null===(d=o.error.code)||void 0===d?void 0:d.split("auth/")[1])||"internal-error";c.onError(qe(this.auth,p))}else c.onAuthEvent(o)}isEventForConsumer(o,c){const d=null===c.eventId||!!o.eventId&&o.eventId===c.eventId;return c.filter.includes(o.type)&&d}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Oc(o))}saveEventToCache(o){this.cachedEventUids.add(Oc(o)),this.lastProcessedEventTime=Date.now()}}function Oc(l){return[l.type,l.eventId,l.sessionId,l.tenantId].filter(o=>o).join("-")}function jt({type:l,error:o}){return"unknown"===l&&"auth/no-auth-event"===o?.code}function Vc(l){return Qo.apply(this,arguments)}function Qo(){return(Qo=(0,v.A)(function*(l,o={}){return De(l,"GET","/v1/projects",o)})).apply(this,arguments)}const wr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Mc=/^https?/;function xi(){return(xi=(0,v.A)(function*(l){if(l.config.emulator)return;const{authorizedDomains:o}=yield Vc(l);for(const c of o)try{if(Tn(c))return}catch{}ze(l,"unauthorized-domain")})).apply(this,arguments)}function Tn(l){const o=Rn(),{protocol:c,hostname:d}=new URL(o);if(l.startsWith("chrome-extension://")){const T=new URL(l);return""===T.hostname&&""===d?"chrome-extension:"===c&&l.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===c&&T.hostname===d}if(!Mc.test(c))return!1;if(wr.test(l))return d===l;const p=l.replace(/\./g,"\\.");return new RegExp("^(.+\\."+p+"|"+p+")$","i").test(d)}const Ih=new nn(3e4,6e4);function Di(){const l=nt().___jsl;if(l?.H)for(const o of Object.keys(l.H))if(l.H[o].r=l.H[o].r||[],l.H[o].L=l.H[o].L||[],l.H[o].r=[...l.H[o].L],l.CP)for(let c=0;c<l.CP.length;c++)l.CP[c]=null}let Yo=null;const Pu=new nn(5e3,15e3),Lc="__/auth/iframe",Th="emulator/auth/iframe",Eh={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Jt=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Os(l){const o=l.config;N(o.authDomain,l,"auth-domain-config-required");const c=o.emulator?dn(o,Th):`https://${l.config.authDomain}/${Lc}`,d={apiKey:o.apiKey,appName:l.name,v:ce.SDK_VERSION},p=Jt.get(l.config.apiHost);p&&(d.eid=p);const _=l._getFrameworks();return _.length&&(d.fw=_.join(",")),`${c}?${(0,u.Am)(d).slice(1)}`}function Xo(){return Xo=(0,v.A)(function*(l){const o=yield function Hr(l){return Yo=Yo||function br(l){return new Promise((o,c)=>{var d,p,_;function T(){Di(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{Di(),c(qe(l,"network-request-failed"))},timeout:Ih.get()})}if(null!==(p=null===(d=nt().gapi)||void 0===d?void 0:d.iframes)&&void 0!==p&&p.Iframe)o(gapi.iframes.getContext());else{if(null===(_=nt().gapi)||void 0===_||!_.load){const C=Ll("iframefcb");return nt()[C]=()=>{gapi.load?T():c(qe(l,"network-request-failed"))},kn(`https://apis.google.com/js/api.js?onload=${C}`).catch(k=>c(k))}T()}}).catch(o=>{throw Yo=null,o})}(l),Yo}(l),c=nt().gapi;return N(c,l,"internal-error"),o.open({where:document.body,url:Os(l),messageHandlersFilter:c.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Eh,dontclear:!0},d=>new Promise(function(){var p=(0,v.A)(function*(_,T){yield d.restyle({setHideOnLeave:!1});const C=qe(l,"network-request-failed"),k=nt().setTimeout(()=>{T(C)},Pu.get());function q(){nt().clearTimeout(k),_(d)}d.ping(q).then(q,()=>{T(C)})});return function(_,T){return p.apply(this,arguments)}}()))}),Xo.apply(this,arguments)}const Pt={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Vs{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const bh="__/auth/handler",Ch="emulator/auth/handler",Rh=encodeURIComponent("fac");function Fc(l,o,c,d,p,_){return Uc.apply(this,arguments)}function Uc(){return(Uc=(0,v.A)(function*(l,o,c,d,p,_){N(l.config.authDomain,l,"auth-domain-config-required"),N(l.config.apiKey,l,"invalid-api-key");const T={apiKey:l.config.apiKey,appName:l.name,authType:c,redirectUrl:d,v:ce.SDK_VERSION,eventId:p};if(o instanceof Yt){o.setDefaultLanguage(l.languageCode),T.providerId=o.providerId||"",(0,u.Im)(o.getCustomParameters())||(T.customParameters=JSON.stringify(o.getCustomParameters()));for(const[J,ee]of Object.entries(_||{}))T[J]=ee}if(o instanceof Nn){const J=o.getScopes().filter(ee=>""!==ee);J.length>0&&(T.scopes=J.join(","))}l.tenantId&&(T.tid=l.tenantId);const C=T;for(const J of Object.keys(C))void 0===C[J]&&delete C[J];const k=yield l._getAppCheckToken(),q=k?`#${Rh}=${encodeURIComponent(k)}`:"";return`${function Sh({config:l}){return l.emulator?dn(l,Ch):`https://${l.authDomain}/${bh}`}(l)}?${(0,u.Am)(C).slice(1)}${q}`})).apply(this,arguments)}const Bc="webStorageSupport",Ou=class Ph{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Vn,this._completeRedirectFn=Fn,this._overrideRedirectResult=Sc}_openPopup(o,c,d,p){var _=this;return(0,v.A)(function*(){var T;st(null===(T=_.eventManagers[o._key()])||void 0===T?void 0:T.manager,"_initialize() not called before _openPopup()");const C=yield Fc(o,c,d,Rn(),p);return function ku(l,o,c,d=500,p=600){const _=Math.max((window.screen.availHeight-p)/2,0).toString(),T=Math.max((window.screen.availWidth-d)/2,0).toString();let C="";const k=Object.assign(Object.assign({},Pt),{width:d.toString(),height:p.toString(),top:_,left:T}),q=(0,u.ZQ)().toLowerCase();c&&(C=li(q)?"_blank":c),Yn(q)&&(o=o||"http://localhost",k.scrollbars="yes");const J=Object.entries(k).reduce((Ke,[bn,cn])=>`${Ke}${bn}=${cn},`,"");if(function me(l=(0,u.ZQ)()){var o;return Y(l)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(q)&&"_self"!==C)return function wh(l,o){const c=document.createElement("a");c.href=l,c.target=o;const d=document.createEvent("MouseEvent");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),c.dispatchEvent(d)}(o||"",C),new Vs(null);const ee=window.open(o||"",C,J);N(ee,l,"popup-blocked");try{ee.focus()}catch{}return new Vs(ee)}(o,C,vr())})()}_openRedirect(o,c,d,p){var _=this;return(0,v.A)(function*(){return yield _._originValidation(o),function Es(l){nt().location.href=l}(yield Fc(o,c,d,Rn(),p)),new Promise(()=>{})})()}_initialize(o){const c=o._key();if(this.eventManagers[c]){const{manager:p,promise:_}=this.eventManagers[c];return p?Promise.resolve(p):(st(_,"If manager is not set, promise should be"),_)}const d=this.initAndGetManager(o);return this.eventManagers[c]={promise:d},d.catch(()=>{delete this.eventManagers[c]}),d}initAndGetManager(o){var c=this;return(0,v.A)(function*(){const d=yield function Ns(l){return Xo.apply(this,arguments)}(o),p=new kc(o);return d.register("authEvent",_=>(N(_?.authEvent,o,"invalid-auth-event"),{status:p.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),c.eventManagers[o._key()]={manager:p},c.iframes[o._key()]=d,p})()}_isIframeWebStorageSupported(o,c){this.iframes[o._key()].send(Bc,{type:Bc},p=>{var _;const T=null===(_=p?.[0])||void 0===_?void 0:_[Bc];void 0!==T&&c(!!T),ze(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function R(l){return xi.apply(this,arguments)}(o)),this.originValidationPromises[c]}get _shouldInitProactively(){return $e()||Dn()||Y()}};class Nu{constructor(o){this.factorId=o}_process(o,c,d){switch(c.type){case"enroll":return this._finalizeEnroll(o,c.credential,d);case"signin":return this._finalizeSignIn(o,c.credential);default:return tt("unexpected MultiFactorSessionType")}}}class zc extends Nu{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new zc(o)}_finalizeEnroll(o,c,d){return function sh(l,o){return De(l,"POST","/v2/accounts/mfaEnrollment:finalize",Pe(l,o))}(o,{idToken:c,displayName:d,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,c){return function vc(l,o){return De(l,"POST","/v2/accounts/mfaSignIn:finalize",Pe(l,o))}(o,{mfaPendingCredential:c,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let xh=(()=>{class l{constructor(){}static assertion(c){return zc._fromCredential(c)}}return l.FACTOR_ID="phone",l})();var qc="@firebase/auth";class Dh{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var c=this;return(0,v.A)(function*(){return c.assertAuthConfigured(),yield c.auth._initializationPromise,c.auth.currentUser?{accessToken:yield c.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const c=this.auth.onIdTokenChanged(d=>{o(d?.stsTokenManager.accessToken||null)});this.internalListeners.set(o,c),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const c=this.internalListeners.get(o);c&&(this.internalListeners.delete(o),c(),this.updateProactiveRefresh())}assertAuthConfigured(){N(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Qe(){return window}(0,u.XA)("authIdTokenMaxAge"),function pt(l){(0,ce._registerComponent)(new At.uA("auth",(o,{options:c})=>{const d=o.getProvider("app").getImmediate(),p=o.getProvider("heartbeat"),_=o.getProvider("app-check-internal"),{apiKey:T,authDomain:C}=d.options;N(T&&!T.includes(":"),"invalid-api-key",{appName:d.name});const k={apiKey:T,authDomain:C,clientPlatform:l,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xn(l)},q=new jd(d,p,_,k);return function ui(l,o){const c=o?.persistence||[],d=(Array.isArray(c)?c:[c]).map(ve);o?.errorMap&&l._updateErrorMap(o.errorMap),l._initializeWithPersistence(d,o?.popupRedirectResolver)}(q,c),q},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,c,d)=>{o.getProvider("auth-internal").initialize()})),(0,ce._registerComponent)(new At.uA("auth-internal",o=>{const c=_e(o.getProvider("auth").getImmediate());return new Dh(c)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ce.registerVersion)(qc,"1.5.1",function Kc(l){switch(l){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(l)),(0,ce.registerVersion)(qc,"1.5.1","esm2017")}("Browser");function Rr(){return Rr=(0,v.A)(function*(l,o,c){var d;const{BuildInfo:p}=Qe();st(o.sessionId,"AuthEvent did not contain a session ID");const _=yield function Ze(l){return En.apply(this,arguments)}(o.sessionId),T={};return Y()?T.ibi=p.packageName:I()?T.apn=p.packageName:ze(l,"operation-not-supported-in-this-environment"),p.displayName&&(T.appDisplayName=p.displayName),T.sessionId=_,Fc(l,c,o.type,void 0,null!==(d=o.eventId)&&void 0!==d?d:void 0,T)}),Rr.apply(this,arguments)}function Zo(){return(Zo=(0,v.A)(function*(l){const{BuildInfo:o}=Qe(),c={};Y()?c.iosBundleId=o.packageName:I()?c.androidPackageName=o.packageName:ze(l,"operation-not-supported-in-this-environment"),yield Vc(l,c)})).apply(this,arguments)}function Qc(){return(Qc=(0,v.A)(function*(l,o,c){const{cordova:d}=Qe();let p=()=>{};try{yield new Promise((_,T)=>{let C=null;function k(){var ee;_();const Ke=null===(ee=d.plugins.browsertab)||void 0===ee?void 0:ee.close;"function"==typeof Ke&&Ke(),"function"==typeof c?.close&&c.close()}function q(){C||(C=window.setTimeout(()=>{T(qe(l,"redirect-cancelled-by-user"))},2e3))}function J(){"visible"===document?.visibilityState&&q()}o.addPassiveListener(k),document.addEventListener("resume",q,!1),I()&&document.addEventListener("visibilitychange",J,!1),p=()=>{o.removePassiveListener(k),document.removeEventListener("resume",q,!1),document.removeEventListener("visibilitychange",J,!1),C&&window.clearTimeout(C)}})}finally{p()}})).apply(this,arguments)}function En(){return(En=(0,v.A)(function*(l){const o=function ea(l){if(st(/[0-9a-zA-Z]+/.test(l),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(l);const o=new ArrayBuffer(l.length),c=new Uint8Array(o);for(let d=0;d<l.length;d++)c[d]=l.charCodeAt(d);return c}(l),c=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(c)).map(p=>p.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Ms extends kc{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(c=>c(o)),super.onEvent(o)}initialized(){var o=this;return(0,v.A)(function*(){yield o.initPromise})()}}function ir(l){return ki.apply(this,arguments)}function ki(){return(ki=(0,v.A)(function*(l){const o=yield Qr()._get(zn(l));return o&&(yield Qr()._remove(zn(l))),o})).apply(this,arguments)}function Bn(){const l=[];for(let c=0;c<20;c++){const d=Math.floor(62*Math.random());l.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(d))}return l.join("")}function Qr(){return ve(yr)}function zn(l){return yt("authEvent",l.config.apiKey,l.name)}function Ni(l){if(!l?.includes("?"))return{};const[o,...c]=l.split("?");return(0,u.I9)(c.join("?"))}const Yc=class Yr{constructor(){this._redirectPersistence=Vn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Fn,this._overrideRedirectResult=Sc}_initialize(o){var c=this;return(0,v.A)(function*(){const d=o._key();let p=c.eventManagers.get(d);return p||(p=new Ms(o),c.eventManagers.set(d,p),c.attachCallbackListeners(o,p)),p})()}_openPopup(o){ze(o,"operation-not-supported-in-this-environment")}_openRedirect(o,c,d,p){var _=this;return(0,v.A)(function*(){!function Sr(l){var o,c,d,p,_,T,C,k,q,J;const ee=Qe();N("function"==typeof(null===(o=ee?.universalLinks)||void 0===o?void 0:o.subscribe),l,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),N(typeof(null===(c=ee?.BuildInfo)||void 0===c?void 0:c.packageName)<"u",l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),N("function"==typeof(null===(_=null===(p=null===(d=ee?.cordova)||void 0===d?void 0:d.plugins)||void 0===p?void 0:p.browsertab)||void 0===_?void 0:_.openUrl),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),N("function"==typeof(null===(k=null===(C=null===(T=ee?.cordova)||void 0===T?void 0:T.plugins)||void 0===C?void 0:C.browsertab)||void 0===k?void 0:k.isAvailable),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),N("function"==typeof(null===(J=null===(q=ee?.cordova)||void 0===q?void 0:q.InAppBrowser)||void 0===J?void 0:J.open),l,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const T=yield _._initialize(o);yield T.initialized(),T.resetRedirect(),function Jp(){xs.clear()}(),yield _._originValidation(o);const C=function Oh(l,o,c=null){return{type:o,eventId:c,urlResponse:null,sessionId:Bn(),postBody:null,tenantId:l.tenantId,error:qe(l,"no-auth-event")}}(o,d,p);yield function Pr(l,o){return Qr()._set(zn(l),o)}(o,C);const k=yield function Mu(l,o,c){return Rr.apply(this,arguments)}(o,C,c),q=yield function kh(l){const{cordova:o}=Qe();return new Promise(c=>{o.plugins.browsertab.isAvailable(d=>{let p=null;d?o.plugins.browsertab.openUrl(l):p=o.InAppBrowser.open(l,function Ee(l=(0,u.ZQ)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(l)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(l)}()?"_blank":"_system","location=yes"),c(p)})})}(k);return function lt(l,o,c){return Qc.apply(this,arguments)}(o,T,q)})()}_isIframeWebStorageSupported(o,c){throw new Error("Method not implemented.")}_originValidation(o){const c=o._key();return this.originValidationPromises[c]||(this.originValidationPromises[c]=function qt(l){return Zo.apply(this,arguments)}(o)),this.originValidationPromises[c]}attachCallbackListeners(o,c){const{universalLinks:d,handleOpenURL:p,BuildInfo:_}=Qe(),T=setTimeout((0,v.A)(function*(){yield ir(o),c.onEvent(Vi())}),500),C=function(){var J=(0,v.A)(function*(ee){clearTimeout(T);const Ke=yield ir(o);let bn=null;Ke&&ee?.url&&(bn=function xr(l,o){var c,d;const p=function Oi(l){const o=Ni(l),c=o.link?decodeURIComponent(o.link):void 0,d=Ni(c).link,p=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return Ni(p).link||p||d||c||l}(o);if(p.includes("/__/auth/callback")){const _=Ni(p),T=_.firebaseError?function Lu(l){try{return JSON.parse(l)}catch{return null}}(decodeURIComponent(_.firebaseError)):null,C=null===(d=null===(c=T?.code)||void 0===c?void 0:c.split("auth/"))||void 0===d?void 0:d[1],k=C?qe(C):null;return k?{type:l.type,eventId:l.eventId,tenantId:l.tenantId,error:k,urlResponse:null,sessionId:null,postBody:null}:{type:l.type,eventId:l.eventId,tenantId:l.tenantId,sessionId:l.sessionId,urlResponse:p,postBody:null}}return null}(Ke,ee.url)),c.onEvent(bn||Vi())});return function(Ke){return J.apply(this,arguments)}}();typeof d<"u"&&"function"==typeof d.subscribe&&d.subscribe(null,C);const k=p,q=`${_.packageName.toLowerCase()}://`;Qe().handleOpenURL=function(){var J=(0,v.A)(function*(ee){if(ee.toLowerCase().startsWith(q)&&C({url:ee}),"function"==typeof k)try{k(ee)}catch(Ke){console.error(Ke)}});return function(ee){return J.apply(this,arguments)}}()}};function Vi(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:qe("no-auth-event")}}function Mi(){var l;return(null===(l=self?.location)||void 0===l?void 0:l.protocol)||null}function Bu(l=(0,u.ZQ)()){return!("file:"!==Mi()&&"ionic:"!==Mi()&&"capacitor:"!==Mi()||!l.toLowerCase().match(/iphone|ipad|ipod|android/))}function Be(){try{const l=self.localStorage,o=vr();if(l)return l.setItem(o,"1"),l.removeItem(o),!function ju(l=(0,u.ZQ)()){return function Gu(){return(0,u.lT)()&&11===document?.documentMode}()||function Tt(l=(0,u.ZQ)()){return/Edge\/\d+/.test(l)}(l)}()||(0,u.zW)()}catch{return Gn()&&(0,u.zW)()}return!1}function Gn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ia(){return(function Nh(){return"http:"===Mi()||"https:"===Mi()}()||(0,u.sr)()||Bu())&&!function zu(){return(0,u.lV)()||(0,u.Ll)()}()&&Be()&&!Gn()}function Xc(){return Bu()&&typeof document<"u"}function Jc(){return(Jc=(0,v.A)(function*(){return!!Xc()&&new Promise(l=>{const o=setTimeout(()=>{l(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),l(!0)})})})).apply(this,arguments)}const le={LOCAL:"local",NONE:"none",SESSION:"session"},Se=N,Xr="persistence";function Us(l){return sa.apply(this,arguments)}function sa(){return(sa=(0,v.A)(function*(l){yield l._initializationPromise;const o=tl(),c=yt(Xr,l.config.apiKey,l.name);o&&o.setItem(c,l._getPersistence())})).apply(this,arguments)}function tl(){var l;try{return(null===(l=function qu(){return typeof window<"u"?window:null}())||void 0===l?void 0:l.sessionStorage)||null}catch{return null}}const $u=N;class sr{constructor(){this.browserResolver=ve(Ou),this.cordovaResolver=ve(Yc),this.underlyingResolver=null,this._redirectPersistence=Vn,this._completeRedirectFn=Fn,this._overrideRedirectResult=Sc}_initialize(o){var c=this;return(0,v.A)(function*(){return yield c.selectUnderlyingResolver(),c.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,c,d,p){var _=this;return(0,v.A)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(o,c,d,p)})()}_openRedirect(o,c,d,p){var _=this;return(0,v.A)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(o,c,d,p)})()}_isIframeWebStorageSupported(o,c){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,c)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Xc()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return $u(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,v.A)(function*(){if(o.underlyingResolver)return;const c=yield function Fs(){return Jc.apply(this,arguments)}();o.underlyingResolver=c?o.cordovaResolver:o.browserResolver})()}}function Ku(l){return l.unwrap()}function Mh(l){return Hu(l)}function Hu(l){const{_tokenResponse:o}=l instanceof u.g?l.customData:l;if(!o)return null;if(!(l instanceof u.g)&&"temporaryProof"in o&&"phoneNumber"in o)return Ln.credentialFromResult(l);const c=o.providerId;if(!c||c===je.PASSWORD)return null;let d;switch(c){case je.GOOGLE:d=Ql;break;case je.FACEBOOK:d=ec;break;case je.GITHUB:d=fs;break;case je.TWITTER:d=fi;break;default:const{oauthIdToken:p,oauthAccessToken:_,oauthTokenSecret:T,pendingToken:C,nonce:k}=o;return _||T||p||C?C?c.startsWith("saml.")?mr._create(c,C):_n._fromParams({providerId:c,signInMethod:c,pendingToken:C,idToken:p,accessToken:_}):new pr(c).credential({idToken:p,accessToken:_,rawNonce:k}):null}return l instanceof u.g?d.credentialFromError(l):d.credentialFromResult(l)}function Mt(l,o){return o.catch(c=>{throw c instanceof u.g&&function Wu(l,o){var c;const d=null===(c=o.customData)||void 0===c?void 0:c._tokenResponse;if("auth/multi-factor-auth-required"===o?.code)o.resolver=new Lh(l,function Je(l,o){var c;const d=(0,u.Ku)(l),p=o;return N(o.customData.operationType,d,"argument-error"),N(null===(c=p.customData._serverResponse)||void 0===c?void 0:c.mfaPendingCredential,d,"argument-error"),_c._fromError(d,p)}(l,o));else if(d){const p=Hu(o),_=o;p&&(_.credential=p,_.tenantId=d.tenantId||void 0,_.email=d.email||void 0,_.phoneNumber=d.phoneNumber||void 0)}}(l,c),c}).then(c=>{const p=c.user;return{operationType:c.operationType,credential:Mh(c),additionalUserInfo:fc(c),user:An.getOrCreate(p)}})}function nl(l,o){return rl.apply(this,arguments)}function rl(){return(rl=(0,v.A)(function*(l,o){const c=yield o;return{verificationId:c.verificationId,confirm:d=>Mt(l,c.confirm(d))}})).apply(this,arguments)}class Lh{constructor(o,c){this.resolver=c,this.auth=function Vh(l){return l.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return Mt(Ku(this.auth),this.resolver.resolveSignIn(o))}}class An{constructor(o){this._delegate=o,this.multiFactor=function Mo(l){const o=(0,u.Ku)(l);return Vo.has(o)||Vo.set(o,No._fromUser(o)),Vo.get(o)}(o)}static getOrCreate(o){return An.USER_MAP.has(o)||An.USER_MAP.set(o,new An(o)),An.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var c=this;return(0,v.A)(function*(){return Mt(c.auth,ic(c._delegate,o))})()}linkWithPhoneNumber(o,c){var d=this;return(0,v.A)(function*(){return nl(d.auth,function bu(l,o,c){return Cu.apply(this,arguments)}(d._delegate,o,c))})()}linkWithPopup(o){var c=this;return(0,v.A)(function*(){return Mt(c.auth,function V(l,o,c){return it.apply(this,arguments)}(c._delegate,o,sr))})()}linkWithRedirect(o){var c=this;return(0,v.A)(function*(){return yield Us(_e(c.auth)),vh(c._delegate,o,sr)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var c=this;return(0,v.A)(function*(){return Mt(c.auth,_i(c._delegate,o))})()}reauthenticateWithPhoneNumber(o,c){return nl(this.auth,function qo(l,o,c){return wc.apply(this,arguments)}(this._delegate,o,c))}reauthenticateWithPopup(o){return Mt(this.auth,function K(l,o,c){return x.apply(this,arguments)}(this._delegate,o,sr))}reauthenticateWithRedirect(o){var c=this;return(0,v.A)(function*(){return yield Us(_e(c.auth)),ne(c._delegate,o,sr)})()}sendEmailVerification(o){return function Is(l,o){return lc.apply(this,arguments)}(this._delegate,o)}unlink(o){var c=this;return(0,v.A)(function*(){return yield function zr(l,o){return Io.apply(this,arguments)}(c._delegate,o),c})()}updateEmail(o){return function _r(l,o){return hc((0,u.Ku)(l),o,null)}(this._delegate,o)}updatePassword(o){return function iu(l,o){return hc((0,u.Ku)(l),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function Ru(l,o){return ot.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function Jd(l,o){return $r.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,c){return function ru(l,o,c){return uc.apply(this,arguments)}(this._delegate,o,c)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}An.USER_MAP=new WeakMap;const wn=N;let Li=(()=>{class l{constructor(c,d){if(this.app=c,d.isInitialized())return this._delegate=d.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:p}=c.options;wn(p,"invalid-api-key",{appName:c.name}),wn(p,"invalid-api-key",{appName:c.name});const _=typeof window<"u"?sr:void 0;this._delegate=d.initialize({options:{persistence:oa(p,c.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap(kt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?An.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(c){this._delegate.languageCode=c}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(c){this._delegate.tenantId=c}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(c,d){!function Ba(l,o,c){const d=_e(l);N(d._canInitEmulator,d,"emulator-config-failed"),N(/^https?:\/\//.test(o),d,"invalid-emulator-scheme");const p=!!c?.disableWarnings,_=uo(o),{host:T,port:C}=function zl(l){const o=uo(l),c=/(\/\/)?([^?#/]+)/.exec(l.substr(o.length));if(!c)return{host:"",port:null};const d=c[2].split("@").pop()||"",p=/^(\[[^\]]+\])(:|$)/.exec(d);if(p){const _=p[1];return{host:_,port:Gl(d.substr(_.length+1))}}{const[_,T]=d.split(":");return{host:_,port:Gl(T)}}}(o);d.config.emulator={url:`${_}//${T}${null===C?"":`:${C}`}/`},d.settings.appVerificationDisabledForTesting=!0,d.emulatorConfig=Object.freeze({host:T,port:C,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:p})}),p||function jl(){function l(){const o=document.createElement("p"),c=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",c.position="fixed",c.width="100%",c.backgroundColor="#ffffff",c.border=".1em solid #000000",c.color="#b50000",c.bottom="0px",c.left="0px",c.margin="0px",c.zIndex="10000",c.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",l):l())}()}(this._delegate,c,d)}applyActionCode(c){return function eu(l,o){return Ii.apply(this,arguments)}(this._delegate,c)}checkActionCode(c){return Ti(this._delegate,c)}confirmPasswordReset(c,d){return function Hd(l,o,c){return jr.apply(this,arguments)}(this._delegate,c,d)}createUserWithEmailAndPassword(c,d){var p=this;return(0,v.A)(function*(){return Mt(p._delegate,function Qd(l,o,c){return Po.apply(this,arguments)}(p._delegate,c,d))})()}fetchProvidersForEmail(c){return this.fetchSignInMethodsForEmail(c)}fetchSignInMethodsForEmail(c){return function Do(l,o){return qr.apply(this,arguments)}(this._delegate,c)}isSignInWithEmailLink(c){return function tr(l,o){const c=hs.parseLink(o);return"EMAIL_SIGNIN"===c?.operation}(0,c)}getRedirectResult(){var c=this;return(0,v.A)(function*(){wn(ia(),c._delegate,"operation-not-supported-in-this-environment");const d=yield function Si(l,o){return ks.apply(this,arguments)}(c._delegate,sr);return d?Mt(c._delegate,Promise.resolve(d)):{credential:null,user:null}})()}addFrameworkForLogging(c){!function Fu(l,o){_e(l)._logFramework(o)}(this._delegate,c)}onAuthStateChanged(c,d,p){const{next:_,error:T,complete:C}=Bs(c,d,p);return this._delegate.onAuthStateChanged(_,T,C)}onIdTokenChanged(c,d,p){const{next:_,error:T,complete:C}=Bs(c,d,p);return this._delegate.onIdTokenChanged(_,T,C)}sendSignInLinkToEmail(c,d){return function Yd(l,o,c){return er.apply(this,arguments)}(this._delegate,c,d)}sendPasswordResetEmail(c,d){return function Zl(l,o,c){return So.apply(this,arguments)}(this._delegate,c,d||void 0)}setPersistence(c){var d=this;return(0,v.A)(function*(){let p;switch(function Zc(l,o){Se(Object.values(le).includes(o),l,"invalid-persistence-type"),(0,u.lV)()?Se(o!==le.SESSION,l,"unsupported-persistence-type"):(0,u.Ll)()?Se(o===le.NONE,l,"unsupported-persistence-type"):Gn()?Se(o===le.NONE||o===le.LOCAL&&(0,u.zW)(),l,"unsupported-persistence-type"):Se(o===le.NONE||Be(),l,"unsupported-persistence-type")}(d._delegate,c),c){case le.SESSION:p=Vn;break;case le.LOCAL:p=(yield ve(Re)._isAvailable())?Re:yr;break;case le.NONE:p=He;break;default:return ze("argument-error",{appName:d._delegate.name})}return d._delegate.setPersistence(p)})()}signInAndRetrieveDataWithCredential(c){return this.signInWithCredential(c)}signInAnonymously(){return Mt(this._delegate,function Wd(l){return rc.apply(this,arguments)}(this._delegate))}signInWithCredential(c){return Mt(this._delegate,ms(this._delegate,c))}signInWithCustomToken(c){return Mt(this._delegate,function bo(l,o){return Gr.apply(this,arguments)}(this._delegate,c))}signInWithEmailAndPassword(c,d){return Mt(this._delegate,function tu(l,o,c){return ms((0,u.Ku)(l),Za.credential(o,c)).catch(function(){var d=(0,v.A)(function*(p){throw"auth/password-does-not-meet-requirements"===p.code&&vs(l),p});return function(p){return d.apply(this,arguments)}}())}(this._delegate,c,d))}signInWithEmailLink(c,d){return Mt(this._delegate,function xo(l,o,c){return Ei.apply(this,arguments)}(this._delegate,c,d))}signInWithPhoneNumber(c,d){return nl(this._delegate,function ph(l,o,c){return Ac.apply(this,arguments)}(this._delegate,c,d))}signInWithPopup(c){var d=this;return(0,v.A)(function*(){return wn(ia(),d._delegate,"operation-not-supported-in-this-environment"),Mt(d._delegate,function te(l,o,c){return bc.apply(this,arguments)}(d._delegate,c,sr))})()}signInWithRedirect(c){var d=this;return(0,v.A)(function*(){return wn(ia(),d._delegate,"operation-not-supported-in-this-environment"),yield Us(d._delegate),Ri(d._delegate,c,sr)})()}updateCurrentUser(c){return this._delegate.updateCurrentUser(c)}verifyPasswordResetCode(c){return function ac(l,o){return cc.apply(this,arguments)}(this._delegate,c)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return l.Persistence=le,l})();function Bs(l,o,c){let d=l;"function"!=typeof l&&({next:d,error:o,complete:c}=l);const p=d;return{next:T=>p(T&&An.getOrCreate(T)),error:o,complete:c}}function oa(l,o){const c=function el(l,o){const c=tl();if(!c)return[];const d=yt(Xr,l,o);switch(c.getItem(d)){case le.NONE:return[He];case le.LOCAL:return[Re,Vn];case le.SESSION:return[Vn];default:return[]}}(l,o);if(typeof self<"u"&&!c.includes(Re)&&c.push(Re),typeof window<"u")for(const d of[yr,Vn])c.includes(d)||c.push(d);return c.includes(He)||c.push(He),c}class aa{constructor(){this.providerId="phone",this._delegate=new Ln(Ku(fe.A.auth()))}static credential(o,c){return Ln.credential(o,c)}verifyPhoneNumber(o,c){return this._delegate.verifyPhoneNumber(o,c)}unwrap(){return this._delegate}}aa.PHONE_SIGN_IN_METHOD=Ln.PHONE_SIGN_IN_METHOD,aa.PROVIDER_ID=Ln.PROVIDER_ID;const Qu=N;class or{constructor(o,c,d=fe.A.app()){var p;Qu(null===(p=d.options)||void 0===p?void 0:p.apiKey,"invalid-api-key",{appName:d.name}),this._delegate=new hh(d.auth(),o,c),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function Fi(l){l.INTERNAL.registerComponent(new At.uA("auth-compat",o=>{const c=o.getProvider("app-compat").getImmediate(),d=o.getProvider("auth");return new Li(c,d)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Za,FacebookAuthProvider:ec,GithubAuthProvider:fs,GoogleAuthProvider:Ql,OAuthProvider:pr,SAMLAuthProvider:yo,PhoneAuthProvider:aa,PhoneMultiFactorGenerator:xh,RecaptchaVerifier:or,TwitterAuthProvider:fi,Auth:Li,AuthCredential:fr,Error:u.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),l.registerVersion("@firebase/auth-compat","0.5.1")}(fe.A)}}]);