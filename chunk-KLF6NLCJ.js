import{a as Rp}from"./chunk-4WOZYAGK.js";import{c as Tp,d as Ep,e as kn}from"./chunk-222QVGCF.js";import{a as bp,b as _c,c as Cp,d as ys,e as yc,f as ea,g as Ap,h as Sp,i as vc,j as Ee,k as mi,l as Kt,m as ta,n as vs,o as xp,p as Pp,q as Vn,r as pt}from"./chunk-PHPGP6OX.js";import{$ as Jo,O as dp,P as mp,Q as pp,R as _p,S as yp,T as rt,U as di,V as Xi,X as _s,Y as vp,Z as wp,_ as Xo,aa as Ip,ba as se,da as Pt,ea as Zo,fa as Ji,g as Wo,i as Yo,n as hp}from"./chunk-2OAEYAPD.js";import{c as hi,d as Dn,f as $t,g as gs,h as hn,i as fc,j as fp,k as gc,l as gp}from"./chunk-XSSXK7EZ.js";import{$ as ue,$a as Jm,Aa as ut,B as $m,Bb as sp,C as Lo,Cb as ms,D as zo,Db as op,Eb as ap,F as uc,Ga as Ct,H as Bo,Ha as xn,I as oi,Ia as ne,Ib as pc,J as hc,Ja as re,Jb as ps,Ka as N,L as Km,Mb as De,Na as Xm,Nb as cn,O as lt,Oa as Se,P as Be,Pa as Yi,Q as Qe,Qa as ai,R as Y,Ra as At,S as Qi,Sa as St,Sb as jt,T as Hm,Ta as L,U as _e,Ua as U,Ub as un,V as qe,Va as X,Vb as lp,W as dc,Wa as yt,Wb as Ko,Xa as vt,Xb as Rn,Ya as an,Yb as Ho,Z as Qm,Za as Ue,_ as ce,_b as cp,aa as Tt,ab as xe,ac as mt,b as $i,ba as Et,bb as Zm,bc as ui,c as Ki,cb as H,cc as Qo,db as ep,eb as qo,f as Fo,fa as Wm,fb as tp,g as Um,gb as li,ha as Wi,hb as ln,i as si,ia as ct,ib as ht,j as Hi,jb as dt,jc as up,k as An,kb as ds,l as Sn,la as bt,lb as ye,mb as Pn,n as He,nb as Gt,ob as Uo,oc as fs,pb as Go,qa as Ym,qb as jo,rb as np,s as Gm,sa as M,sb as xt,t as us,ta as de,tb as mc,ub as Nt,vb as ci,xb as $o,ya as hs,yb as ip,z as jm,zb as rp}from"./chunk-PP4FAFPJ.js";import{a as Mt,b as lc,e as cc,f as P}from"./chunk-RDYEX3OW.js";var pe=(()=>{let e=class e{};e.OPERATOR_REV="\xAB",e.OPERATOR_ADD="+",e.OPERATOR_SUB="-",e.OPERATOR_MUL="\xD7",e.OPERATOR_DIV="/";let i=e;return i})();var Zi=class{constructor(e,t,n,r){this.id=e,this.selected=t,this.disabled=n,this.value=r}};var er=class{constructor(){this.operands=[]}};var Ft=class{static evaluate(e,t,n){let r=Number.MIN_VALUE;switch(n){case pe.OPERATOR_ADD:{r=e+t;break}case pe.OPERATOR_SUB:{r=e>=t?e-t:Number.MIN_VALUE;break}case pe.OPERATOR_DIV:{r=e%t==0?e/t:Number.MIN_VALUE;break}case pe.OPERATOR_MUL:{r=e*t;break}}return r}static cloneGameParameters(e){let t=new er;return t.result=e.result,e.operands.forEach(n=>{let r=new Zi(n.id,!1,!1,-1);Object.assign(r,n),t.operands.push(r)}),t}};var na=class{constructor(){this.numbers=[]}generateNumber(e,t){let n=Math.floor(e+Math.random()*(t-e+1));for(;this.numbers.indexOf(n)>=0;)n=Math.floor(e+Math.random()*(t-e+1));this.numbers.push(n)}getGeneratedNumbers(){return this.numbers}clearGeneratedNumbers(){this.numbers=[]}};var ia=class{generateNumber(e,t){return Math.floor(e+Math.random()*(t-e+1))}choiceRandomOperation(){let e=this.generateNumber(0,4),t=pe.OPERATOR_ADD;switch(e){case 0:{t=pe.OPERATOR_ADD;break}case 1:{t=pe.OPERATOR_SUB;break}case 2:{t=pe.OPERATOR_MUL;break}case 3:{t=pe.OPERATOR_DIV;break}}return t}checkExecuteDivision(e,t){return e%t===0}checkExecuteSubstraction(e,t){return e>t}removeOperandByIndex(e,t){let n=t;return e<t&&(n=t-1),this.operands.splice(e,1),n}calculateResult(e){let t=this.operands.length,n=0,r=0,s=this.generateNumber(3,5),o=Number.MIN_VALUE;for(;r<s&&e.length>1;){let l=this.choiceRandomOperation(),c=this.generateNumber(0,t-1);for(o===Number.MIN_VALUE&&(o=this.generateNumber(0,t-1));o===c;)c=this.generateNumber(0,t-1);switch(l){case pe.OPERATOR_ADD:{e[o]=Ft.evaluate(e[o],e[c],l),o=this.removeOperandByIndex(c,o),--t,++r;break}case pe.OPERATOR_SUB:{if(this.checkExecuteSubstraction(e[o],e[c]))e[o]=Ft.evaluate(e[o],e[c],l),o=this.removeOperandByIndex(c,o),--t,++r;else continue;break}case pe.OPERATOR_MUL:{e[o]=Ft.evaluate(e[o],e[c],l),o=this.removeOperandByIndex(c,o),--t,++r;break}case pe.OPERATOR_DIV:{if(this.checkExecuteDivision(e[o],e[c]))e[o]=Ft.evaluate(e[o],e[c],l),o=this.removeOperandByIndex(c,o),--t,++r;else continue;break}}}return n=e[o],n}generateGameParameter(e){let t=new na;switch(e){case 0:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,25);break}case 1:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(10,15),t.generateNumber(10,25);break}case 2:{t.generateNumber(1,5),t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,20),t.generateNumber(10,25);break}case 3:{t.generateNumber(1,5),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,20),t.generateNumber(10,25);break}case 4:{t.generateNumber(1,10),t.generateNumber(5,10),t.generateNumber(5,15),t.generateNumber(10,15),t.generateNumber(10,25),t.generateNumber(10,25);break}}let n=t.getGeneratedNumbers();n=n.sort((m,f)=>m-f);let r=new Array(n[0],n[1],n[2],n[3],n[4],n[5]);this.operands=new Array(n[0],n[1],n[2],n[3],n[4],n[5]),t.clearGeneratedNumbers();let s=0,o=0;switch(e){case 0:{s=30,o=100;break}case 1:{s=50,o=150;break}case 2:{s=100,o=200;break}case 3:{s=300,o=400;break}case 4:{s=400,o=550;break}}let l=this.calculateResult(this.operands);for(;s>l||l>o;)this.operands=new Array(n[0],n[1],n[2],n[3],n[4],n[5]),l=this.calculateResult(this.operands);let c=new er;c.result=l;let h=0;return r.forEach(m=>{let f=new Zi(h,!1,!1,m);c.operands.push(f),++h}),c}generateStageNumbers(){let e=new Array;for(let t=0;t<5;t++){let n=this.generateGameParameter(t);n.stageIndex=t,e.push(n)}return e=e.sort((t,n)=>t.result-n.result),e}};var ws=class{cookieData2Text(){return JSON.stringify(this)}text2CookieData(e){return JSON.parse(e)}};var ra=(()=>{let e=class e{constructor(n,r){this.document=n,this.platformId=r,this.documentIsAccessible=ui(this.platformId)}static getCookieRegExp(n){let r=n.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+r+"|;\\s*"+r+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(n){try{return decodeURIComponent(n)}catch{return n}}check(n){return this.documentIsAccessible?(n=encodeURIComponent(n),e.getCookieRegExp(n).test(this.document.cookie)):!1}get(n){if(this.documentIsAccessible&&this.check(n)){n=encodeURIComponent(n);let s=e.getCookieRegExp(n).exec(this.document.cookie);return s[1]?e.safeDecodeURIComponent(s[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let n={},r=this.document;return r.cookie&&r.cookie!==""&&r.cookie.split(";").forEach(s=>{let[o,l]=s.split("=");n[e.safeDecodeURIComponent(o.replace(/^ /,""))]=e.safeDecodeURIComponent(l)}),n}set(n,r,s,o,l,c,h,m){if(!this.documentIsAccessible)return;if(typeof s=="number"||s instanceof Date||o||l||c||h){let b={expires:s,path:o,domain:l,secure:c,sameSite:h||"Lax",partitioned:m};this.set(n,r,b);return}let f=encodeURIComponent(n)+"="+encodeURIComponent(r)+";",g=s||{};if(g.expires)if(typeof g.expires=="number"){let b=new Date(new Date().getTime()+g.expires*1e3*60*60*24);f+="expires="+b.toUTCString()+";"}else f+="expires="+g.expires.toUTCString()+";";g.path&&(f+="path="+g.path+";"),g.domain&&(f+="domain="+g.domain+";"),g.secure===!1&&g.sameSite==="None"&&(g.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${n} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),g.secure&&(f+="secure;"),g.sameSite||(g.sameSite="Lax"),f+="sameSite="+g.sameSite+";",g.partitioned&&(f+="Partitioned;"),this.document.cookie=f}delete(n,r,s,o,l="Lax"){if(!this.documentIsAccessible)return;let c=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(n,"",{expires:c,path:r,domain:s,secure:o,sameSite:l})}deleteAll(n,r,s,o="Lax"){if(!this.documentIsAccessible)return;let l=this.getAll();for(let c in l)l.hasOwnProperty(c)&&this.delete(c,n,r,s,o)}};e.\u0275fac=function(r){return new(r||e)(Y(jt),Y(bt))},e.\u0275prov=lt({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var sa=class{constructor(){this.stages=[]}};var oa=class{constructor(){this.operands=[]}};var Is=class{};var Dp=new Qe("WindowToken",typeof window<"u"&&window.document?{providedIn:"root",factory:()=>window}:{providedIn:"root",factory:()=>{}});var kp=(()=>{class i{constructor(t,n,r){this.ngZone=t,this.document=n,this.window=r,this.copySubject=new Ki,this.copyResponse$=this.copySubject.asObservable(),this.config={}}configure(t){this.config=t}copy(t){if(!this.isSupported||!t)return this.pushCopyResponse({isSuccess:!1,content:t});let n=this.copyFromContent(t);return n?this.pushCopyResponse({content:t,isSuccess:n}):this.pushCopyResponse({isSuccess:!1,content:t})}get isSupported(){return!!this.document.queryCommandSupported&&!!this.document.queryCommandSupported("copy")&&!!this.window}isTargetValid(t){if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){if(t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');return!0}throw new Error("Target should be input or textarea")}copyFromInputElement(t,n=!0){try{this.selectTarget(t);let r=this.copyText();return this.clearSelection(n?t:void 0,this.window),r&&this.isCopySuccessInIE11()}catch{return!1}}isCopySuccessInIE11(){let t=this.window.clipboardData;return!(t&&t.getData&&!t.getData("Text"))}copyFromContent(t,n=this.document.body){if(this.tempTextArea&&!n.contains(this.tempTextArea)&&this.destroy(this.tempTextArea.parentElement||void 0),!this.tempTextArea){this.tempTextArea=this.createTempTextArea(this.document,this.window);try{n.appendChild(this.tempTextArea)}catch{throw new Error("Container should be a Dom element")}}this.tempTextArea.value=t;let r=this.copyFromInputElement(this.tempTextArea,!1);return this.config.cleanUpAfterCopy&&this.destroy(this.tempTextArea.parentElement||void 0),r}destroy(t=this.document.body){this.tempTextArea&&(t.removeChild(this.tempTextArea),this.tempTextArea=void 0)}selectTarget(t){return t.select(),t.setSelectionRange(0,t.value.length),t.value.length}copyText(){return this.document.execCommand("copy")}clearSelection(t,n){t&&t.focus(),n.getSelection()?.removeAllRanges()}createTempTextArea(t,n){let r=t.documentElement.getAttribute("dir")==="rtl",s;s=t.createElement("textarea"),s.style.fontSize="12pt",s.style.border="0",s.style.padding="0",s.style.margin="0",s.style.position="absolute",s.style[r?"right":"left"]="-9999px";let o=n.pageYOffset||t.documentElement.scrollTop;return s.style.top=o+"px",s.setAttribute("readonly",""),s}pushCopyResponse(t){this.copySubject.observers.length>0&&this.ngZone.run(()=>{this.copySubject.next(t)})}pushCopyReponse(t){this.pushCopyResponse(t)}}return i.\u0275fac=function(t){return new(t||i)(Y(ut),Y(jt),Y(Dp,8))},i.\u0275prov=lt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Vp=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=qe({type:i}),i.\u0275inj=Be({imports:[mt]}),i})();var Oy="firebase",My="10.12.2";Vn(Oy,My,"app");var tr=new op("ANGULARFIRE2_VERSION");var Ny=(i,e)=>{let t=e?[e]:Pp(),n=[];return t.forEach(r=>{r.container.getProvider(i).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n},pi=class{constructor(){return Ny(Fy)}},Fy="app-check";function wc(){}var aa=class{zone;delegate;constructor(e,t=Um){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,n)}},Ic=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",wc,{},wc,wc)),t.pipe(Km({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},la=(()=>{class i{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new aa(Zone.current)),this.insideAngular=t.run(()=>new aa(Zone.current,Fo)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||i)(Y(ut))};static \u0275prov=lt({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Ly(){let i=globalThis.\u0275AngularFireScheduler;if(!i)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return i}function ft(i){return zy(Ly())(i)}function zy(i){return function(t){return t=t.lift(new Ic(i.ngZone)),t.pipe(Hi(i.outsideAngular),si(i.insideAngular))}}var Uy=new Map,Gy={activated:!1,tokenObservers:[]},jy={initialized:!1,enabled:!1};function Lt(i){return Uy.get(i)||Object.assign({},Gy)}function zp(){return jy}var $y="https://content-firebaseappcheck.googleapis.com/v1";var Ky="exchangeDebugToken",Mp={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},lE=24*60*60*1e3;var Ec=class{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return P(this,null,function*(){this.stop();try{this.pending=new _c,this.pending.promise.catch(t=>{}),yield Hy(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new _c,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Hy(i){return new Promise(e=>{setTimeout(e,i)})}var Qy={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},On=new Sp("appCheck","AppCheck",Qy);function Bp(i){if(!Lt(i).activated)throw On.create("use-before-activation",{appName:i.name})}function qp(n,r){return P(this,arguments,function*({url:i,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let b=yield o.getHeartbeatsHeader();b&&(s["X-Firebase-Client"]=b)}let l={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(i,l)}catch(b){throw On.create("fetch-network-error",{originalErrorMessage:b?.message})}if(c.status!==200)throw On.create("fetch-status-error",{httpStatus:c.status});let h;try{h=yield c.json()}catch(b){throw On.create("fetch-parse-error",{originalErrorMessage:b?.message})}let m=h.ttl.match(/^([\d.]+)(s)$/);if(!m||!m[2]||isNaN(Number(m[1])))throw On.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});let f=Number(m[1])*1e3,g=Date.now();return{token:h.token,expireTimeMillis:g+f,issuedAtTimeMillis:g}})}function Up(i,e){let{projectId:t,appId:n,apiKey:r}=i.options;return{url:`${$y}/projects/${t}/apps/${n}:${Ky}?key=${r}`,body:{debug_token:e}}}var Wy="firebase-app-check-database",Yy=1,bc="firebase-app-check-store";var ca=null;function Xy(){return ca||(ca=new Promise((i,e)=>{try{let t=indexedDB.open(Wy,Yy);t.onsuccess=n=>{i(n.target.result)},t.onerror=n=>{var r;e(On.create("storage-open",{originalErrorMessage:(r=n.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=n=>{let r=n.target.result;switch(n.oldVersion){case 0:r.createObjectStore(bc,{keyPath:"compositeKey"})}}}catch(t){e(On.create("storage-open",{originalErrorMessage:t?.message}))}}),ca)}function Jy(i,e){return Zy(e1(i),e)}function Zy(i,e){return P(this,null,function*(){let n=(yield Xy()).transaction(bc,"readwrite"),s=n.objectStore(bc).put({compositeKey:i,value:e});return new Promise((o,l)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var h;l(On.create("storage-set",{originalErrorMessage:(h=c.target.error)===null||h===void 0?void 0:h.message}))}})})}function e1(i){return`${i.options.appId}-${i.name}`}var Cc=new ta("@firebase/app-check");function Tc(i,e){return ea()?Jy(i,e).catch(t=>{Cc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Gp(){return zp().enabled}function jp(){return P(this,null,function*(){let i=zp();if(i.enabled&&i.token)return i.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var t1={error:"UNKNOWN_ERROR"};function n1(i){return bp.encodeString(JSON.stringify(i),!1)}function Ac(i,e=!1){return P(this,null,function*(){let t=i.app;Bp(t);let n=Lt(t),r=n.token,s;if(r&&!Ts(r)&&(n.token=void 0,r=void 0),!r){let c=yield n.cachedTokenPromise;c&&(Ts(c)?r=c:yield Tc(t,void 0))}if(!e&&r&&Ts(r))return{token:r.token};let o=!1;if(Gp()){n.exchangeTokenPromise||(n.exchangeTokenPromise=qp(Up(t,yield jp()),i.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);let c=yield n.exchangeTokenPromise;return yield Tc(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),r=yield Lt(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Cc.warn(c.message):Cc.error(c),s=c}let l;return r?s?Ts(r)?l={token:r.token,internalError:s}:l=Fp(s):(l={token:r.token},n.token=r,yield Tc(t,r)):l=Fp(s),o&&o1(t,l),l})}function i1(i){return P(this,null,function*(){let e=i.app;Bp(e);let{provider:t}=Lt(e);if(Gp()){let n=yield jp(),{token:r}=yield qp(Up(e,n),i.heartbeatServiceProvider);return{token:r}}else{let{token:n}=yield t.getToken();return{token:n}}})}function r1(i,e,t,n){let{app:r}=i,s=Lt(r),o={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ts(s.token)){let l=s.token;Promise.resolve().then(()=>{t({token:l.token}),Np(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Np(i))}function $p(i,e){let t=Lt(i),n=t.tokenObservers.filter(r=>r.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function Np(i){let{app:e}=i,t=Lt(e),n=t.tokenRefresher;n||(n=s1(i),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function s1(i){let{app:e}=i;return new Ec(()=>P(this,null,function*(){let t=Lt(e),n;if(t.token?n=yield Ac(i,!0):n=yield Ac(i),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=Lt(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,r),Math.max(0,n-Date.now())}else return 0},Mp.RETRIAL_MIN_WAIT,Mp.RETRIAL_MAX_WAIT)}function o1(i,e){let t=Lt(i).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Ts(i){return i.expireTimeMillis-Date.now()>0}function Fp(i){return{token:n1(t1),error:i}}var Sc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Lt(this.app);for(let t of e)$p(this.app,t.next);return Promise.resolve()}};function a1(i,e){return new Sc(i,e)}function l1(i){return{getToken:e=>Ac(i,e),getLimitedUseToken:()=>i1(i),addTokenListener:e=>r1(i,"INTERNAL",e),removeTokenListener:e=>$p(i.app,e)}}var c1="@firebase/app-check",u1="0.8.4";var h1="app-check",Lp="app-check-internal";function d1(){vs(new mi(h1,i=>{let e=i.getProvider("app").getImmediate(),t=i.getProvider("heartbeat");return a1(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(Lp).initialize()})),vs(new mi(Lp,i=>{let e=i.getProvider("app-check").getImmediate();return l1(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Vn(c1,u1)}d1();var m1=["localhost","0.0.0.0","127.0.0.1"],wE=typeof window<"u"&&m1.includes(window.location.hostname);var p1="firebase",f1="10.12.2";pt.registerVersion(p1,f1,"app-compat");var g1=["ngOnDestroy"],Qp=(i,e,t,n={})=>new Proxy(i,{get:(r,s)=>t.runOutsideAngular(()=>{if(i[s])return n?.spy?.get&&n.spy.get(s,i[s]),i[s];if(g1.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(l=>{let c=l?.[s];return typeof c=="function"?c.bind(l):c?.then?c.then(h=>t.run(()=>h)):t.run(()=>c)});return new Proxy(()=>{},{get:(l,c)=>o[c],apply:(l,c,h)=>o.then(m=>{let f=m?.(...h);return n?.spy?.apply&&n.spy.apply(s,h,f),f})})})});var ua=class{constructor(e){return e}},nr=new Qe("angularfire2.app.options"),ir=new Qe("angularfire2.app.name");function Es(i,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||n;let o=pt.apps.filter(l=>l&&l.name===r.name)[0]||e.runOutsideAngular(()=>pt.initializeApp(i,r));try{if(JSON.stringify(i)!==JSON.stringify(o.options)){let l=!!module.hot;_1("error",`${o.name} Firebase App already initialized with different options${l?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ua(o)}var _1=(i,...e)=>{pc()&&typeof console<"u"&&console[i](...e)},y1={provide:ua,useFactory:Es,deps:[nr,ut,[new Hm,ir]]},Wp=(()=>{class i{static initializeApp(t,n){return{ngModule:i,providers:[{provide:nr,useValue:t},{provide:ir,useValue:n}]}}constructor(t){pt.registerVersion("angularfire",tr.full,"core"),pt.registerVersion("angularfire",tr.full,"app-compat"),pt.registerVersion("angular",ap.full,t.toString())}static \u0275fac=function(n){return new(n||i)(Y(bt))};static \u0275mod=qe({type:i});static \u0275inj=Be({providers:[y1]})}return i})();function ha(i,e,t,n,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(l=>l[0]===i)||[];if(s)return v1(r,o)||(Hp("error",`${e} was already initialized on the ${t} Firebase App with different settings.${w1?" You may need to reload as Firebase is not HMR aware.":""}`),Hp("warn",{is:r,was:o})),s;{let l=n();return globalThis.\u0275AngularfireInstanceCache.push([i,l,r]),l}}function v1(i,e){try{return i.toString()===e.toString()}catch{return i===e}}var w1=typeof module<"u"&&!!module.hot,Hp=(i,...e)=>{pc()&&typeof console<"u"&&console[i](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var xc=new Qe("angularfire2.auth.use-emulator"),Pc=new Qe("angularfire2.auth.settings"),Rc=new Qe("angularfire2.auth.tenant-id"),Dc=new Qe("angularfire2.auth.langugage-code"),kc=new Qe("angularfire2.auth.use-device-language"),Vc=new Qe("angularfire.auth.persistence"),Oc=(i,e,t,n,r,s,o,l)=>ha(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{let c=e.runOutsideAngular(()=>i.auth());if(t&&c.useEmulator(...t),n&&(c.tenantId=n),c.languageCode=r,s&&c.useDeviceLanguage(),o)for(let[h,m]of Object.entries(o))c.settings[h]=m;return l&&c.setPersistence(l),c},[t,n,r,s,o,l]),Yp=(()=>{class i{authState;idToken;user;idTokenResult;credential;constructor(t,n,r,s,o,l,c,h,m,f,g,b){let V=new Ki,O=Sn(void 0).pipe(si(o.outsideAngular),oi(()=>s.runOutsideAngular(()=>import("./chunk-AWLUVYNR.js"))),He(()=>Es(t,s,n)),He(R=>Oc(R,s,l,h,m,f,c,g)),uc({bufferSize:1,refCount:!1}));if(Qo(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Sn(null);else{O.pipe($m()).subscribe();let R=O.pipe(oi(z=>z.getRedirectResult().then(W=>W,()=>null)),ft,uc({bufferSize:1,refCount:!1})),K=O.pipe(oi(z=>new $i(W=>({unsubscribe:s.runOutsideAngular(()=>z.onAuthStateChanged(J=>W.next(J),J=>W.error(J),()=>W.complete()))})))),Q=O.pipe(oi(z=>new $i(W=>({unsubscribe:s.runOutsideAngular(()=>z.onIdTokenChanged(J=>W.next(J),J=>W.error(J),()=>W.complete()))}))));this.authState=R.pipe(hc(K),Hi(o.outsideAngular),si(o.insideAngular)),this.user=R.pipe(hc(Q),Hi(o.outsideAngular),si(o.insideAngular)),this.idToken=this.user.pipe(oi(z=>z?An(z.getIdToken()):Sn(null))),this.idTokenResult=this.user.pipe(oi(z=>z?An(z.getIdTokenResult()):Sn(null))),this.credential=Gm(R,V,this.authState.pipe(us(z=>!z))).pipe(He(z=>z?.user?z:null),Hi(o.outsideAngular),si(o.insideAngular))}return Qp(this,O,s,{spy:{apply:(R,K,Q)=>{(R.startsWith("signIn")||R.startsWith("createUser"))&&Q.then(z=>V.next(z))}}})}static \u0275fac=function(n){return new(n||i)(Y(nr),Y(ir,8),Y(bt),Y(ut),Y(la),Y(xc,8),Y(Pc,8),Y(Rc,8),Y(Dc,8),Y(kc,8),Y(Vc,8),Y(pi,8))};static \u0275prov=lt({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var Xp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jp={};var Mn,Mc;(function(){var i;function e(w,_){function v(){}v.prototype=_.prototype,w.D=_.prototype,w.prototype=new v,w.prototype.constructor=w,w.C=function(I,T,C){for(var y=Array(arguments.length-2),rn=2;rn<arguments.length;rn++)y[rn-2]=arguments[rn];return _.prototype[T].apply(I,y)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,_,v){v||(v=0);var I=Array(16);if(typeof _=="string")for(var T=0;16>T;++T)I[T]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(T=0;16>T;++T)I[T]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=w.g[0],v=w.g[1],T=w.g[2];var C=w.g[3],y=_+(C^v&(T^C))+I[0]+3614090360&4294967295;_=v+(y<<7&4294967295|y>>>25),y=C+(T^_&(v^T))+I[1]+3905402710&4294967295,C=_+(y<<12&4294967295|y>>>20),y=T+(v^C&(_^v))+I[2]+606105819&4294967295,T=C+(y<<17&4294967295|y>>>15),y=v+(_^T&(C^_))+I[3]+3250441966&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(C^v&(T^C))+I[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(T^_&(v^T))+I[5]+1200080426&4294967295,C=_+(y<<12&4294967295|y>>>20),y=T+(v^C&(_^v))+I[6]+2821735955&4294967295,T=C+(y<<17&4294967295|y>>>15),y=v+(_^T&(C^_))+I[7]+4249261313&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(C^v&(T^C))+I[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(T^_&(v^T))+I[9]+2336552879&4294967295,C=_+(y<<12&4294967295|y>>>20),y=T+(v^C&(_^v))+I[10]+4294925233&4294967295,T=C+(y<<17&4294967295|y>>>15),y=v+(_^T&(C^_))+I[11]+2304563134&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(C^v&(T^C))+I[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(T^_&(v^T))+I[13]+4254626195&4294967295,C=_+(y<<12&4294967295|y>>>20),y=T+(v^C&(_^v))+I[14]+2792965006&4294967295,T=C+(y<<17&4294967295|y>>>15),y=v+(_^T&(C^_))+I[15]+1236535329&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(T^C&(v^T))+I[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^T&(_^v))+I[6]+3225465664&4294967295,C=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(C^_))+I[11]+643717713&4294967295,T=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(T^C))+I[0]+3921069994&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^C&(v^T))+I[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^T&(_^v))+I[10]+38016083&4294967295,C=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(C^_))+I[15]+3634488961&4294967295,T=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(T^C))+I[4]+3889429448&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^C&(v^T))+I[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^T&(_^v))+I[14]+3275163606&4294967295,C=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(C^_))+I[3]+4107603335&4294967295,T=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(T^C))+I[8]+1163531501&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^C&(v^T))+I[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^T&(_^v))+I[2]+4243563512&4294967295,C=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(C^_))+I[7]+1735328473&4294967295,T=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(T^C))+I[12]+2368359562&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(v^T^C)+I[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^T)+I[8]+2272392833&4294967295,C=_+(y<<11&4294967295|y>>>21),y=T+(C^_^v)+I[11]+1839030562&4294967295,T=C+(y<<16&4294967295|y>>>16),y=v+(T^C^_)+I[14]+4259657740&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^C)+I[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^T)+I[4]+1272893353&4294967295,C=_+(y<<11&4294967295|y>>>21),y=T+(C^_^v)+I[7]+4139469664&4294967295,T=C+(y<<16&4294967295|y>>>16),y=v+(T^C^_)+I[10]+3200236656&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^C)+I[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^T)+I[0]+3936430074&4294967295,C=_+(y<<11&4294967295|y>>>21),y=T+(C^_^v)+I[3]+3572445317&4294967295,T=C+(y<<16&4294967295|y>>>16),y=v+(T^C^_)+I[6]+76029189&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^C)+I[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^T)+I[12]+3873151461&4294967295,C=_+(y<<11&4294967295|y>>>21),y=T+(C^_^v)+I[15]+530742520&4294967295,T=C+(y<<16&4294967295|y>>>16),y=v+(T^C^_)+I[2]+3299628645&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(T^(v|~C))+I[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~T))+I[7]+1126891415&4294967295,C=_+(y<<10&4294967295|y>>>22),y=T+(_^(C|~v))+I[14]+2878612391&4294967295,T=C+(y<<15&4294967295|y>>>17),y=v+(C^(T|~_))+I[5]+4237533241&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~C))+I[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~T))+I[3]+2399980690&4294967295,C=_+(y<<10&4294967295|y>>>22),y=T+(_^(C|~v))+I[10]+4293915773&4294967295,T=C+(y<<15&4294967295|y>>>17),y=v+(C^(T|~_))+I[1]+2240044497&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~C))+I[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~T))+I[15]+4264355552&4294967295,C=_+(y<<10&4294967295|y>>>22),y=T+(_^(C|~v))+I[6]+2734768916&4294967295,T=C+(y<<15&4294967295|y>>>17),y=v+(C^(T|~_))+I[13]+1309151649&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~C))+I[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~T))+I[11]+3174756917&4294967295,C=_+(y<<10&4294967295|y>>>22),y=T+(_^(C|~v))+I[2]+718787259&4294967295,T=C+(y<<15&4294967295|y>>>17),y=v+(C^(T|~_))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+_&4294967295,w.g[1]=w.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+T&4294967295,w.g[3]=w.g[3]+C&4294967295}n.prototype.u=function(w,_){_===void 0&&(_=w.length);for(var v=_-this.blockSize,I=this.B,T=this.h,C=0;C<_;){if(T==0)for(;C<=v;)r(this,w,C),C+=this.blockSize;if(typeof w=="string"){for(;C<_;)if(I[T++]=w.charCodeAt(C++),T==this.blockSize){r(this,I),T=0;break}}else for(;C<_;)if(I[T++]=w[C++],T==this.blockSize){r(this,I),T=0;break}}this.h=T,this.o+=_},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var _=1;_<w.length-8;++_)w[_]=0;var v=8*this.o;for(_=w.length-8;_<w.length;++_)w[_]=v&255,v/=256;for(this.u(w),w=Array(16),_=v=0;4>_;++_)for(var I=0;32>I;I+=8)w[v++]=this.g[_]>>>I&255;return w};function s(w,_){var v=l;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=_(w)}function o(w,_){this.h=_;for(var v=[],I=!0,T=w.length-1;0<=T;T--){var C=w[T]|0;I&&C==_||(v[T]=C,I=!1)}this.g=v}var l={};function c(w){return-128<=w&&128>w?s(w,function(_){return new o([_|0],0>_?-1:0)}):new o([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return f;if(0>w)return R(h(-w));for(var _=[],v=1,I=0;w>=v;I++)_[I]=w/v|0,v*=4294967296;return new o(_,0)}function m(w,_){if(w.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(w.charAt(0)=="-")return R(m(w.substring(1),_));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(_,8)),I=f,T=0;T<w.length;T+=8){var C=Math.min(8,w.length-T),y=parseInt(w.substring(T,T+C),_);8>C?(C=h(Math.pow(_,C)),I=I.j(C).add(h(y))):(I=I.j(v),I=I.add(h(y)))}return I}var f=c(0),g=c(1),b=c(16777216);i=o.prototype,i.m=function(){if(O(this))return-R(this).m();for(var w=0,_=1,v=0;v<this.g.length;v++){var I=this.i(v);w+=(0<=I?I:4294967296+I)*_,_*=4294967296}return w},i.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(V(this))return"0";if(O(this))return"-"+R(this).toString(w);for(var _=h(Math.pow(w,6)),v=this,I="";;){var T=W(v,_).g;v=K(v,T.j(_));var C=((0<v.g.length?v.g[0]:v.h)>>>0).toString(w);if(v=T,V(v))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},i.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function V(w){if(w.h!=0)return!1;for(var _=0;_<w.g.length;_++)if(w.g[_]!=0)return!1;return!0}function O(w){return w.h==-1}i.l=function(w){return w=K(this,w),O(w)?-1:V(w)?0:1};function R(w){for(var _=w.g.length,v=[],I=0;I<_;I++)v[I]=~w.g[I];return new o(v,~w.h).add(g)}i.abs=function(){return O(this)?R(this):this},i.add=function(w){for(var _=Math.max(this.g.length,w.g.length),v=[],I=0,T=0;T<=_;T++){var C=I+(this.i(T)&65535)+(w.i(T)&65535),y=(C>>>16)+(this.i(T)>>>16)+(w.i(T)>>>16);I=y>>>16,C&=65535,y&=65535,v[T]=y<<16|C}return new o(v,v[v.length-1]&-2147483648?-1:0)};function K(w,_){return w.add(R(_))}i.j=function(w){if(V(this)||V(w))return f;if(O(this))return O(w)?R(this).j(R(w)):R(R(this).j(w));if(O(w))return R(this.j(R(w)));if(0>this.l(b)&&0>w.l(b))return h(this.m()*w.m());for(var _=this.g.length+w.g.length,v=[],I=0;I<2*_;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var T=0;T<w.g.length;T++){var C=this.i(I)>>>16,y=this.i(I)&65535,rn=w.i(T)>>>16,$r=w.i(T)&65535;v[2*I+2*T]+=y*$r,Q(v,2*I+2*T),v[2*I+2*T+1]+=C*$r,Q(v,2*I+2*T+1),v[2*I+2*T+1]+=y*rn,Q(v,2*I+2*T+1),v[2*I+2*T+2]+=C*rn,Q(v,2*I+2*T+2)}for(I=0;I<_;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=_;I<2*_;I++)v[I]=0;return new o(v,0)};function Q(w,_){for(;(w[_]&65535)!=w[_];)w[_+1]+=w[_]>>>16,w[_]&=65535,_++}function z(w,_){this.g=w,this.h=_}function W(w,_){if(V(_))throw Error("division by zero");if(V(w))return new z(f,f);if(O(w))return _=W(R(w),_),new z(R(_.g),R(_.h));if(O(_))return _=W(w,R(_)),new z(R(_.g),_.h);if(30<w.g.length){if(O(w)||O(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,I=_;0>=I.l(w);)v=J(v),I=J(I);var T=Z(v,1),C=Z(I,1);for(I=Z(I,2),v=Z(v,2);!V(I);){var y=C.add(I);0>=y.l(w)&&(T=T.add(v),C=y),I=Z(I,1),v=Z(v,1)}return _=K(w,T.j(_)),new z(T,_)}for(T=f;0<=w.l(_);){for(v=Math.max(1,Math.floor(w.m()/_.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=h(v),y=C.j(_);O(y)||0<y.l(w);)v-=I,C=h(v),y=C.j(_);V(C)&&(C=g),T=T.add(C),w=K(w,y)}return new z(T,w)}i.A=function(w){return W(this,w).h},i.and=function(w){for(var _=Math.max(this.g.length,w.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)&w.i(I);return new o(v,this.h&w.h)},i.or=function(w){for(var _=Math.max(this.g.length,w.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)|w.i(I);return new o(v,this.h|w.h)},i.xor=function(w){for(var _=Math.max(this.g.length,w.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)^w.i(I);return new o(v,this.h^w.h)};function J(w){for(var _=w.g.length+1,v=[],I=0;I<_;I++)v[I]=w.i(I)<<1|w.i(I-1)>>>31;return new o(v,w.h)}function Z(w,_){var v=_>>5;_%=32;for(var I=w.g.length-v,T=[],C=0;C<I;C++)T[C]=0<_?w.i(C+v)>>>_|w.i(C+v+1)<<32-_:w.i(C+v);return new o(T,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Mc=Jp.Md5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=m,Mn=Jp.Integer=o}).apply(typeof Xp<"u"?Xp:typeof self<"u"?self:typeof window<"u"?window:{});var da=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dn={};var Nc,Fc,rr,Lc,bs,ma,zc,Bc,qc;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,u,d){return a==Array.prototype||a==Object.prototype||(a[u]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof da=="object"&&da];for(var u=0;u<a.length;++u){var d=a[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var n=t(this);function r(a,u){if(u)e:{var d=n;a=a.split(".");for(var p=0;p<a.length-1;p++){var E=a[p];if(!(E in d))break e;d=d[E]}a=a[a.length-1],p=d[a],u=u(p),u!=p&&u!=null&&e(d,a,{configurable:!0,writable:!0,value:u})}}function s(a,u){a instanceof String&&(a+="");var d=0,p=!1,E={next:function(){if(!p&&d<a.length){var S=d++;return{value:u(S,a[S]),done:!1}}return p=!0,{done:!0,value:void 0}}};return E[Symbol.iterator]=function(){return E},E}r("Array.prototype.values",function(a){return a||function(){return s(this,function(u,d){return d})}});var o=o||{},l=this||self;function c(a){var u=typeof a;return u=u!="object"?u:a?Array.isArray(a)?"array":u:"null",u=="array"||u=="object"&&typeof a.length=="number"}function h(a){var u=typeof a;return u=="object"&&a!=null||u=="function"}function m(a,u,d){return a.call.apply(a.bind,arguments)}function f(a,u,d){if(!a)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var E=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(E,p),a.apply(u,E)}}return function(){return a.apply(u,arguments)}}function g(a,u,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:f,g.apply(null,arguments)}function b(a,u){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function V(a,u){function d(){}d.prototype=u.prototype,a.aa=u.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(p,E,S){for(var F=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)F[fe-2]=arguments[fe];return u.prototype[E].apply(p,F)}}function O(a){let u=a.length;if(0<u){let d=Array(u);for(let p=0;p<u;p++)d[p]=a[p];return d}return[]}function R(a,u){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(c(p)){let E=a.length||0,S=p.length||0;a.length=E+S;for(let F=0;F<S;F++)a[E+F]=p[F]}else a.push(p)}}class K{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function Q(a){return/^[\s\xa0]*$/.test(a)}function z(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function W(a){return W[" "](a),a}W[" "]=function(){};var J=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function Z(a,u,d){for(let p in a)u.call(d,a[p],p,a)}function w(a,u){for(let d in a)u.call(void 0,a[d],d,a)}function _(a){let u={};for(let d in a)u[d]=a[d];return u}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(a,u){let d,p;for(let E=1;E<arguments.length;E++){p=arguments[E];for(d in p)a[d]=p[d];for(let S=0;S<v.length;S++)d=v[S],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function T(a){var u=1;a=a.split(":");let d=[];for(;0<u&&a.length;)d.push(a.shift()),u--;return a.length&&d.push(a.join(":")),d}function C(a){l.setTimeout(()=>{throw a},0)}function y(){var a=Fl;let u=null;return a.g&&(u=a.g,a.g=a.g.next,a.g||(a.h=null),u.next=null),u}class rn{constructor(){this.h=this.g=null}add(u,d){let p=$r.get();p.set(u,d),this.h?this.h.next=p:this.g=p,this.h=p}}var $r=new K(()=>new J0,a=>a.reset());class J0{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Kr,Hr=!1,Fl=new rn,qd=()=>{let a=l.Promise.resolve(void 0);Kr=()=>{a.then(Z0)}};var Z0=()=>{for(var a;a=y();){try{a.h.call(a.g)}catch(d){C(d)}var u=$r;u.j(a),100>u.h&&(u.h++,a.next=u.g,u.g=a)}Hr=!1};function Tn(){this.s=this.s,this.C=this.C}Tn.prototype.s=!1,Tn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Tn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(a,u){this.type=a,this.g=this.target=u,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var ey=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,u=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};l.addEventListener("test",d,u),l.removeEventListener("test",d,u)}catch{}return a}();function Qr(a,u){if(Ye.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=u,u=a.relatedTarget){if(J){e:{try{W(u.nodeName);var E=!0;break e}catch{}E=!1}E||(u=null)}}else d=="mouseover"?u=a.fromElement:d=="mouseout"&&(u=a.toElement);this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:ty[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Qr.aa.h.call(this)}}V(Qr,Ye);var ty={2:"touch",3:"pen",4:"mouse"};Qr.prototype.h=function(){Qr.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Wr="closure_listenable_"+(1e6*Math.random()|0),ny=0;function iy(a,u,d,p,E){this.listener=a,this.proxy=null,this.src=u,this.type=d,this.capture=!!p,this.ha=E,this.key=++ny,this.da=this.fa=!1}function wo(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Io(a){this.src=a,this.g={},this.h=0}Io.prototype.add=function(a,u,d,p,E){var S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);var F=zl(a,u,p,E);return-1<F?(u=a[F],d||(u.fa=!1)):(u=new iy(u,this.src,S,!!p,E),u.fa=d,a.push(u)),u};function Ll(a,u){var d=u.type;if(d in a.g){var p=a.g[d],E=Array.prototype.indexOf.call(p,u,void 0),S;(S=0<=E)&&Array.prototype.splice.call(p,E,1),S&&(wo(u),a.g[d].length==0&&(delete a.g[d],a.h--))}}function zl(a,u,d,p){for(var E=0;E<a.length;++E){var S=a[E];if(!S.da&&S.listener==u&&S.capture==!!d&&S.ha==p)return E}return-1}var Bl="closure_lm_"+(1e6*Math.random()|0),ql={};function Ud(a,u,d,p,E){if(p&&p.once)return jd(a,u,d,p,E);if(Array.isArray(u)){for(var S=0;S<u.length;S++)Ud(a,u[S],d,p,E);return null}return d=$l(d),a&&a[Wr]?a.K(u,d,h(p)?!!p.capture:!!p,E):Gd(a,u,d,!1,p,E)}function Gd(a,u,d,p,E,S){if(!u)throw Error("Invalid event type");var F=h(E)?!!E.capture:!!E,fe=Gl(a);if(fe||(a[Bl]=fe=new Io(a)),d=fe.add(u,d,p,F,S),d.proxy)return d;if(p=ry(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)ey||(E=F),E===void 0&&(E=!1),a.addEventListener(u.toString(),p,E);else if(a.attachEvent)a.attachEvent(Kd(u.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function ry(){function a(d){return u.call(a.src,a.listener,d)}let u=sy;return a}function jd(a,u,d,p,E){if(Array.isArray(u)){for(var S=0;S<u.length;S++)jd(a,u[S],d,p,E);return null}return d=$l(d),a&&a[Wr]?a.L(u,d,h(p)?!!p.capture:!!p,E):Gd(a,u,d,!0,p,E)}function $d(a,u,d,p,E){if(Array.isArray(u))for(var S=0;S<u.length;S++)$d(a,u[S],d,p,E);else p=h(p)?!!p.capture:!!p,d=$l(d),a&&a[Wr]?(a=a.i,u=String(u).toString(),u in a.g&&(S=a.g[u],d=zl(S,d,p,E),-1<d&&(wo(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete a.g[u],a.h--)))):a&&(a=Gl(a))&&(u=a.g[u.toString()],a=-1,u&&(a=zl(u,d,p,E)),(d=-1<a?u[a]:null)&&Ul(d))}function Ul(a){if(typeof a!="number"&&a&&!a.da){var u=a.src;if(u&&u[Wr])Ll(u.i,a);else{var d=a.type,p=a.proxy;u.removeEventListener?u.removeEventListener(d,p,a.capture):u.detachEvent?u.detachEvent(Kd(d),p):u.addListener&&u.removeListener&&u.removeListener(p),(d=Gl(u))?(Ll(d,a),d.h==0&&(d.src=null,u[Bl]=null)):wo(a)}}}function Kd(a){return a in ql?ql[a]:ql[a]="on"+a}function sy(a,u){if(a.da)a=!0;else{u=new Qr(u,this);var d=a.listener,p=a.ha||a.src;a.fa&&Ul(a),a=d.call(p,u)}return a}function Gl(a){return a=a[Bl],a instanceof Io?a:null}var jl="__closure_events_fn_"+(1e9*Math.random()>>>0);function $l(a){return typeof a=="function"?a:(a[jl]||(a[jl]=function(u){return a.handleEvent(u)}),a[jl])}function Xe(){Tn.call(this),this.i=new Io(this),this.M=this,this.F=null}V(Xe,Tn),Xe.prototype[Wr]=!0,Xe.prototype.removeEventListener=function(a,u,d,p){$d(this,a,u,d,p)};function nt(a,u){var d,p=a.F;if(p)for(d=[];p;p=p.F)d.push(p);if(a=a.M,p=u.type||u,typeof u=="string")u=new Ye(u,a);else if(u instanceof Ye)u.target=u.target||a;else{var E=u;u=new Ye(p,a),I(u,E)}if(E=!0,d)for(var S=d.length-1;0<=S;S--){var F=u.g=d[S];E=To(F,p,!0,u)&&E}if(F=u.g=a,E=To(F,p,!0,u)&&E,E=To(F,p,!1,u)&&E,d)for(S=0;S<d.length;S++)F=u.g=d[S],E=To(F,p,!1,u)&&E}Xe.prototype.N=function(){if(Xe.aa.N.call(this),this.i){var a=this.i,u;for(u in a.g){for(var d=a.g[u],p=0;p<d.length;p++)wo(d[p]);delete a.g[u],a.h--}}this.F=null},Xe.prototype.K=function(a,u,d,p){return this.i.add(String(a),u,!1,d,p)},Xe.prototype.L=function(a,u,d,p){return this.i.add(String(a),u,!0,d,p)};function To(a,u,d,p){if(u=a.i.g[String(u)],!u)return!0;u=u.concat();for(var E=!0,S=0;S<u.length;++S){var F=u[S];if(F&&!F.da&&F.capture==d){var fe=F.listener,Ke=F.ha||F.src;F.fa&&Ll(a.i,F),E=fe.call(Ke,p)!==!1&&E}}return E&&!p.defaultPrevented}function Hd(a,u,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:l.setTimeout(a,u||0)}function Qd(a){a.g=Hd(()=>{a.g=null,a.i&&(a.i=!1,Qd(a))},a.l);let u=a.h;a.h=null,a.m.apply(null,u)}class oy extends Tn{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Qd(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yr(a){Tn.call(this),this.h=a,this.g={}}V(Yr,Tn);var Wd=[];function Yd(a){Z(a.g,function(u,d){this.g.hasOwnProperty(d)&&Ul(u)},a),a.g={}}Yr.prototype.N=function(){Yr.aa.N.call(this),Yd(this)},Yr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kl=l.JSON.stringify,ay=l.JSON.parse,ly=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Hl(){}Hl.prototype.h=null;function Xd(a){return a.h||(a.h=a.i())}function Jd(){}var Xr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ql(){Ye.call(this,"d")}V(Ql,Ye);function Wl(){Ye.call(this,"c")}V(Wl,Ye);var ti={},Zd=null;function Eo(){return Zd=Zd||new Xe}ti.La="serverreachability";function em(a){Ye.call(this,ti.La,a)}V(em,Ye);function Jr(a){let u=Eo();nt(u,new em(u))}ti.STAT_EVENT="statevent";function tm(a,u){Ye.call(this,ti.STAT_EVENT,a),this.stat=u}V(tm,Ye);function it(a){let u=Eo();nt(u,new tm(u,a))}ti.Ma="timingevent";function nm(a,u){Ye.call(this,ti.Ma,a),this.size=u}V(nm,Ye);function Zr(a,u){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},u)}function es(){this.g=!0}es.prototype.xa=function(){this.g=!1};function cy(a,u,d,p,E,S){a.info(function(){if(a.g)if(S)for(var F="",fe=S.split("&"),Ke=0;Ke<fe.length;Ke++){var he=fe[Ke].split("=");if(1<he.length){var Je=he[0];he=he[1];var Ze=Je.split("_");F=2<=Ze.length&&Ze[1]=="type"?F+(Je+"="+he+"&"):F+(Je+"=redacted&")}}else F=null;else F=S;return"XMLHTTP REQ ("+p+") [attempt "+E+"]: "+u+`
`+d+`
`+F})}function uy(a,u,d,p,E,S,F){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+E+"]: "+u+`
`+d+`
`+S+" "+F})}function qi(a,u,d,p){a.info(function(){return"XMLHTTP TEXT ("+u+"): "+dy(a,d)+(p?" "+p:"")})}function hy(a,u){a.info(function(){return"TIMEOUT: "+u})}es.prototype.info=function(){};function dy(a,u){if(!a.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var p=d[a];if(!(2>p.length)){var E=p[1];if(Array.isArray(E)&&!(1>E.length)){var S=E[0];if(S!="noop"&&S!="stop"&&S!="close")for(var F=1;F<E.length;F++)E[F]=""}}}}return Kl(d)}catch{return u}}var bo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},im={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Yl;function Co(){}V(Co,Hl),Co.prototype.g=function(){return new XMLHttpRequest},Co.prototype.i=function(){return{}},Yl=new Co;function En(a,u,d,p){this.j=a,this.i=u,this.l=d,this.R=p||1,this.U=new Yr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rm}function rm(){this.i=null,this.g="",this.h=!1}var sm={},Xl={};function Jl(a,u,d){a.L=1,a.v=Po(sn(u)),a.m=d,a.P=!0,om(a,null)}function om(a,u){a.F=Date.now(),Ao(a),a.A=sn(a.v);var d=a.A,p=a.R;Array.isArray(p)||(p=[String(p)]),wm(d.i,"t",p),a.C=0,d=a.j.J,a.h=new rm,a.g=Lm(a.j,d?u:null,!a.m),0<a.O&&(a.M=new oy(g(a.Y,a,a.g),a.O)),u=a.U,d=a.g,p=a.ca;var E="readystatechange";Array.isArray(E)||(E&&(Wd[0]=E.toString()),E=Wd);for(var S=0;S<E.length;S++){var F=Ud(d,E[S],p||u.handleEvent,!1,u.h||u);if(!F)break;u.g[F.key]=F}u=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,u)):(a.u="GET",a.g.ea(a.A,a.u,null,u)),Jr(),cy(a.i,a.u,a.A,a.l,a.R,a.m)}En.prototype.ca=function(a){a=a.target;let u=this.M;u&&on(a)==3?u.j():this.Y(a)},En.prototype.Y=function(a){try{if(a==this.g)e:{let Ze=on(this.g);var u=this.g.Ba();let ji=this.g.Z();if(!(3>Ze)&&(Ze!=3||this.g&&(this.h.h||this.g.oa()||Sm(this.g)))){this.J||Ze!=4||u==7||(u==8||0>=ji?Jr(3):Jr(2)),Zl(this);var d=this.g.Z();this.X=d;t:if(am(this)){var p=Sm(this.g);a="";var E=p.length,S=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ni(this),ts(this);var F="";break t}this.h.i=new l.TextDecoder}for(u=0;u<E;u++)this.h.h=!0,a+=this.h.i.decode(p[u],{stream:!(S&&u==E-1)});p.length=0,this.h.g+=a,this.C=0,F=this.h.g}else F=this.g.oa();if(this.o=d==200,uy(this.i,this.u,this.A,this.l,this.R,Ze,d),this.o){if(this.T&&!this.K){t:{if(this.g){var fe,Ke=this.g;if((fe=Ke.g?Ke.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(fe)){var he=fe;break t}}he=null}if(d=he)qi(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ec(this,d);else{this.o=!1,this.s=3,it(12),ni(this),ts(this);break e}}if(this.P){d=!0;let Ot;for(;!this.J&&this.C<F.length;)if(Ot=my(this,F),Ot==Xl){Ze==4&&(this.s=4,it(14),d=!1),qi(this.i,this.l,null,"[Incomplete Response]");break}else if(Ot==sm){this.s=4,it(15),qi(this.i,this.l,F,"[Invalid Chunk]"),d=!1;break}else qi(this.i,this.l,Ot,null),ec(this,Ot);if(am(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||F.length!=0||this.h.h||(this.s=1,it(16),d=!1),this.o=this.o&&d,!d)qi(this.i,this.l,F,"[Invalid Chunked Response]"),ni(this),ts(this);else if(0<F.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),oc(Je),Je.M=!0,it(11))}}else qi(this.i,this.l,F,null),ec(this,F);Ze==4&&ni(this),this.o&&!this.J&&(Ze==4?Om(this.j,this):(this.o=!1,Ao(this)))}else Ry(this.g),d==400&&0<F.indexOf("Unknown SID")?(this.s=3,it(12)):(this.s=0,it(13)),ni(this),ts(this)}}}catch{}finally{}};function am(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function my(a,u){var d=a.C,p=u.indexOf(`
`,d);return p==-1?Xl:(d=Number(u.substring(d,p)),isNaN(d)?sm:(p+=1,p+d>u.length?Xl:(u=u.slice(p,p+d),a.C=p+d,u)))}En.prototype.cancel=function(){this.J=!0,ni(this)};function Ao(a){a.S=Date.now()+a.I,lm(a,a.I)}function lm(a,u){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Zr(g(a.ba,a),u)}function Zl(a){a.B&&(l.clearTimeout(a.B),a.B=null)}En.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(hy(this.i,this.A),this.L!=2&&(Jr(),it(17)),ni(this),this.s=2,ts(this)):lm(this,this.S-a)};function ts(a){a.j.G==0||a.J||Om(a.j,a)}function ni(a){Zl(a);var u=a.M;u&&typeof u.ma=="function"&&u.ma(),a.M=null,Yd(a.U),a.g&&(u=a.g,a.g=null,u.abort(),u.ma())}function ec(a,u){try{var d=a.j;if(d.G!=0&&(d.g==a||tc(d.h,a))){if(!a.K&&tc(d.h,a)&&d.G==3){try{var p=d.Da.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var E=p;if(E[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Oo(d),ko(d);else break e;sc(d),it(18)}}else d.za=E[1],0<d.za-d.T&&37500>E[2]&&d.F&&d.v==0&&!d.C&&(d.C=Zr(g(d.Za,d),6e3));if(1>=hm(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else ri(d,11)}else if((a.K||d.g==a)&&Oo(d),!Q(u))for(E=d.Da.g.parse(u),u=0;u<E.length;u++){let he=E[u];if(d.T=he[0],he=he[1],d.G==2)if(he[0]=="c"){d.K=he[1],d.ia=he[2];let Je=he[3];Je!=null&&(d.la=Je,d.j.info("VER="+d.la));let Ze=he[4];Ze!=null&&(d.Aa=Ze,d.j.info("SVER="+d.Aa));let ji=he[5];ji!=null&&typeof ji=="number"&&0<ji&&(p=1.5*ji,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let Ot=a.g;if(Ot){let No=Ot.g?Ot.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(No){var S=p.h;S.g||No.indexOf("spdy")==-1&&No.indexOf("quic")==-1&&No.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(nc(S,S.h),S.h=null))}if(p.D){let ac=Ot.g?Ot.g.getResponseHeader("X-HTTP-Session-Id"):null;ac&&(p.ya=ac,we(p.I,p.D,ac))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var F=a;if(p.qa=Fm(p,p.J?p.ia:null,p.W),F.K){dm(p.h,F);var fe=F,Ke=p.L;Ke&&(fe.I=Ke),fe.B&&(Zl(fe),Ao(fe)),p.g=F}else km(p);0<d.i.length&&Vo(d)}else he[0]!="stop"&&he[0]!="close"||ri(d,7);else d.G==3&&(he[0]=="stop"||he[0]=="close"?he[0]=="stop"?ri(d,7):rc(d):he[0]!="noop"&&d.l&&d.l.ta(he),d.v=0)}}Jr(4)}catch{}}var py=class{constructor(a,u){this.g=a,this.map=u}};function cm(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function um(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function hm(a){return a.h?1:a.g?a.g.size:0}function tc(a,u){return a.h?a.h==u:a.g?a.g.has(u):!1}function nc(a,u){a.g?a.g.add(u):a.h=u}function dm(a,u){a.h&&a.h==u?a.h=null:a.g&&a.g.has(u)&&a.g.delete(u)}cm.prototype.cancel=function(){if(this.i=mm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function mm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let u=a.i;for(let d of a.g.values())u=u.concat(d.D);return u}return O(a.i)}function fy(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var u=[],d=a.length,p=0;p<d;p++)u.push(a[p]);return u}u=[],d=0;for(p in a)u[d++]=a[p];return u}function gy(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var u=[];a=a.length;for(var d=0;d<a;d++)u.push(d);return u}u=[],d=0;for(let p in a)u[d++]=p;return u}}}function pm(a,u){if(a.forEach&&typeof a.forEach=="function")a.forEach(u,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,u,void 0);else for(var d=gy(a),p=fy(a),E=p.length,S=0;S<E;S++)u.call(void 0,p[S],d&&d[S],a)}var fm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _y(a,u){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var p=a[d].indexOf("="),E=null;if(0<=p){var S=a[d].substring(0,p);E=a[d].substring(p+1)}else S=a[d];u(S,E?decodeURIComponent(E.replace(/\+/g," ")):"")}}}function ii(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ii){this.h=a.h,So(this,a.j),this.o=a.o,this.g=a.g,xo(this,a.s),this.l=a.l;var u=a.i,d=new rs;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),gm(this,d),this.m=a.m}else a&&(u=String(a).match(fm))?(this.h=!1,So(this,u[1]||"",!0),this.o=ns(u[2]||""),this.g=ns(u[3]||"",!0),xo(this,u[4]),this.l=ns(u[5]||"",!0),gm(this,u[6]||"",!0),this.m=ns(u[7]||"")):(this.h=!1,this.i=new rs(null,this.h))}ii.prototype.toString=function(){var a=[],u=this.j;u&&a.push(is(u,_m,!0),":");var d=this.g;return(d||u=="file")&&(a.push("//"),(u=this.o)&&a.push(is(u,_m,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(is(d,d.charAt(0)=="/"?wy:vy,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",is(d,Ty)),a.join("")};function sn(a){return new ii(a)}function So(a,u,d){a.j=d?ns(u,!0):u,a.j&&(a.j=a.j.replace(/:$/,""))}function xo(a,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);a.s=u}else a.s=null}function gm(a,u,d){u instanceof rs?(a.i=u,Ey(a.i,a.h)):(d||(u=is(u,Iy)),a.i=new rs(u,a.h))}function we(a,u,d){a.i.set(u,d)}function Po(a){return we(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function ns(a,u){return a?u?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function is(a,u,d){return typeof a=="string"?(a=encodeURI(a).replace(u,yy),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function yy(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var _m=/[#\/\?@]/g,vy=/[#\?:]/g,wy=/[#\?]/g,Iy=/[#\?@]/g,Ty=/#/g;function rs(a,u){this.h=this.g=null,this.i=a||null,this.j=!!u}function bn(a){a.g||(a.g=new Map,a.h=0,a.i&&_y(a.i,function(u,d){a.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}i=rs.prototype,i.add=function(a,u){bn(this),this.i=null,a=Ui(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(u),this.h+=1,this};function ym(a,u){bn(a),u=Ui(a,u),a.g.has(u)&&(a.i=null,a.h-=a.g.get(u).length,a.g.delete(u))}function vm(a,u){return bn(a),u=Ui(a,u),a.g.has(u)}i.forEach=function(a,u){bn(this),this.g.forEach(function(d,p){d.forEach(function(E){a.call(u,E,p,this)},this)},this)},i.na=function(){bn(this);let a=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let p=0;p<u.length;p++){let E=a[p];for(let S=0;S<E.length;S++)d.push(u[p])}return d},i.V=function(a){bn(this);let u=[];if(typeof a=="string")vm(this,a)&&(u=u.concat(this.g.get(Ui(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)u=u.concat(a[d])}return u},i.set=function(a,u){return bn(this),this.i=null,a=Ui(this,a),vm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[u]),this.h+=1,this},i.get=function(a,u){return a?(a=this.V(a),0<a.length?String(a[0]):u):u};function wm(a,u,d){ym(a,u),0<d.length&&(a.i=null,a.g.set(Ui(a,u),O(d)),a.h+=d.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var p=u[d];let S=encodeURIComponent(String(p)),F=this.V(p);for(p=0;p<F.length;p++){var E=S;F[p]!==""&&(E+="="+encodeURIComponent(String(F[p]))),a.push(E)}}return this.i=a.join("&")};function Ui(a,u){return u=String(u),a.j&&(u=u.toLowerCase()),u}function Ey(a,u){u&&!a.j&&(bn(a),a.i=null,a.g.forEach(function(d,p){var E=p.toLowerCase();p!=E&&(ym(this,p),wm(this,E,d))},a)),a.j=u}function by(a,u){let d=new es;if(l.Image){let p=new Image;p.onload=b(Cn,d,"TestLoadImage: loaded",!0,u,p),p.onerror=b(Cn,d,"TestLoadImage: error",!1,u,p),p.onabort=b(Cn,d,"TestLoadImage: abort",!1,u,p),p.ontimeout=b(Cn,d,"TestLoadImage: timeout",!1,u,p),l.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else u(!1)}function Cy(a,u){let d=new es,p=new AbortController,E=setTimeout(()=>{p.abort(),Cn(d,"TestPingServer: timeout",!1,u)},1e4);fetch(a,{signal:p.signal}).then(S=>{clearTimeout(E),S.ok?Cn(d,"TestPingServer: ok",!0,u):Cn(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(E),Cn(d,"TestPingServer: error",!1,u)})}function Cn(a,u,d,p,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),p(d)}catch{}}function Ay(){this.g=new ly}function Sy(a,u,d){let p=d||"";try{pm(a,function(E,S){let F=E;h(E)&&(F=Kl(E)),u.push(p+S+"="+encodeURIComponent(F))})}catch(E){throw u.push(p+"type="+encodeURIComponent("_badmap")),E}}function ss(a){this.l=a.Ub||null,this.j=a.eb||!1}V(ss,Hl),ss.prototype.g=function(){return new Ro(this.l,this.j)},ss.prototype.i=function(a){return function(){return a}}({});function Ro(a,u){Xe.call(this),this.D=a,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(Ro,Xe),i=Ro.prototype,i.open=function(a,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=u,this.readyState=1,as(this)},i.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(u.body=a),(this.D||l).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,os(this)),this.readyState=0},i.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,as(this)),this.g&&(this.readyState=3,as(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Im(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Im(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}i.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var u=a.value?a.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!a.done}))&&(this.response=this.responseText+=u)}a.done?os(this):as(this),this.readyState==3&&Im(this)}},i.Ra=function(a){this.g&&(this.response=this.responseText=a,os(this))},i.Qa=function(a){this.g&&(this.response=a,os(this))},i.ga=function(){this.g&&os(this)};function os(a){a.readyState=4,a.l=null,a.j=null,a.v=null,as(a)}i.setRequestHeader=function(a,u){this.u.append(a,u)},i.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=u.next();return a.join(`\r
`)};function as(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Ro.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Tm(a){let u="";return Z(a,function(d,p){u+=p,u+=":",u+=d,u+=`\r
`}),u}function ic(a,u,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Tm(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):we(a,u,d))}function Ae(a){Xe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(Ae,Xe);var xy=/^https?$/i,Py=["POST","PUT"];i=Ae.prototype,i.Ha=function(a){this.J=a},i.ea=function(a,u,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);u=u?u.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Yl.g(),this.v=this.o?Xd(this.o):Xd(Yl),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(u,String(a),!0),this.B=!1}catch(S){Em(this,S);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var E in p)d.set(E,p[E]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),E=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Py,u,void 0))||p||E||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,F]of d)this.g.setRequestHeader(S,F);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Am(this),this.u=!0,this.g.send(a),this.u=!1}catch(S){Em(this,S)}};function Em(a,u){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=u,a.m=5,bm(a),Do(a)}function bm(a){a.A||(a.A=!0,nt(a,"complete"),nt(a,"error"))}i.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,nt(this,"complete"),nt(this,"abort"),Do(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Do(this,!0)),Ae.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Cm(this):this.bb())},i.bb=function(){Cm(this)};function Cm(a){if(a.h&&typeof o<"u"&&(!a.v[1]||on(a)!=4||a.Z()!=2)){if(a.u&&on(a)==4)Hd(a.Ea,0,a);else if(nt(a,"readystatechange"),on(a)==4){a.h=!1;try{let F=a.Z();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var p;if(p=F===0){var E=String(a.D).match(fm)[1]||null;!E&&l.self&&l.self.location&&(E=l.self.location.protocol.slice(0,-1)),p=!xy.test(E?E.toLowerCase():"")}d=p}if(d)nt(a,"complete"),nt(a,"success");else{a.m=6;try{var S=2<on(a)?a.g.statusText:""}catch{S=""}a.l=S+" ["+a.Z()+"]",bm(a)}}finally{Do(a)}}}}function Do(a,u){if(a.g){Am(a);let d=a.g,p=a.v[0]?()=>{}:null;a.g=null,a.v=null,u||nt(a,"ready");try{d.onreadystatechange=p}catch{}}}function Am(a){a.I&&(l.clearTimeout(a.I),a.I=null)}i.isActive=function(){return!!this.g};function on(a){return a.g?a.g.readyState:0}i.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(a){if(this.g){var u=this.g.responseText;return a&&u.indexOf(a)==0&&(u=u.substring(a.length)),ay(u)}};function Sm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Ry(a){let u={};a=(a.g&&2<=on(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(Q(a[p]))continue;var d=T(a[p]);let E=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=u[E]||[];u[E]=S,S.push(d)}w(u,function(p){return p.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ls(a,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||u}function xm(a){this.Aa=0,this.i=[],this.j=new es,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ls("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ls("baseRetryDelayMs",5e3,a),this.cb=ls("retryDelaySeedMs",1e4,a),this.Wa=ls("forwardChannelMaxRetries",2,a),this.wa=ls("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new cm(a&&a.concurrentRequestLimit),this.Da=new Ay,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=xm.prototype,i.la=8,i.G=1,i.connect=function(a,u,d,p){it(0),this.W=a,this.H=u||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=Fm(this,null,this.W),Vo(this)};function rc(a){if(Pm(a),a.G==3){var u=a.U++,d=sn(a.I);if(we(d,"SID",a.K),we(d,"RID",u),we(d,"TYPE","terminate"),cs(a,d),u=new En(a,a.j,u),u.L=2,u.v=Po(sn(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=u.v,d=!0),d||(u.g=Lm(u.j,null),u.g.ea(u.v)),u.F=Date.now(),Ao(u)}Nm(a)}function ko(a){a.g&&(oc(a),a.g.cancel(),a.g=null)}function Pm(a){ko(a),a.u&&(l.clearTimeout(a.u),a.u=null),Oo(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Vo(a){if(!um(a.h)&&!a.s){a.s=!0;var u=a.Ga;Kr||qd(),Hr||(Kr(),Hr=!0),Fl.add(u,a),a.B=0}}function Dy(a,u){return hm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=u.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Zr(g(a.Ga,a,u),Mm(a,a.B)),a.B++,!0)}i.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let E=new En(this,this.j,a),S=this.o;if(this.S&&(S?(S=_(S),I(S,this.S)):S=this.S),this.m!==null||this.O||(E.H=S,S=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=Dm(this,E,u),d=sn(this.I),we(d,"RID",a),we(d,"CVER",22),this.D&&we(d,"X-HTTP-Session-Id",this.D),cs(this,d),S&&(this.O?u="headers="+encodeURIComponent(String(Tm(S)))+"&"+u:this.m&&ic(d,this.m,S)),nc(this.h,E),this.Ua&&we(d,"TYPE","init"),this.P?(we(d,"$req",u),we(d,"SID","null"),E.T=!0,Jl(E,d,null)):Jl(E,d,u),this.G=2}}else this.G==3&&(a?Rm(this,a):this.i.length==0||um(this.h)||Rm(this))};function Rm(a,u){var d;u?d=u.l:d=a.U++;let p=sn(a.I);we(p,"SID",a.K),we(p,"RID",d),we(p,"AID",a.T),cs(a,p),a.m&&a.o&&ic(p,a.m,a.o),d=new En(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),u&&(a.i=u.D.concat(a.i)),u=Dm(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),nc(a.h,d),Jl(d,p,u)}function cs(a,u){a.H&&Z(a.H,function(d,p){we(u,p,d)}),a.l&&pm({},function(d,p){we(u,p,d)})}function Dm(a,u,d){d=Math.min(a.i.length,d);var p=a.l?g(a.l.Na,a.l,a):null;e:{var E=a.i;let S=-1;for(;;){let F=["count="+d];S==-1?0<d?(S=E[0].g,F.push("ofs="+S)):S=0:F.push("ofs="+S);let fe=!0;for(let Ke=0;Ke<d;Ke++){let he=E[Ke].g,Je=E[Ke].map;if(he-=S,0>he)S=Math.max(0,E[Ke].g-100),fe=!1;else try{Sy(Je,F,"req"+he+"_")}catch{p&&p(Je)}}if(fe){p=F.join("&");break e}}}return a=a.i.splice(0,d),u.D=a,p}function km(a){if(!a.g&&!a.u){a.Y=1;var u=a.Fa;Kr||qd(),Hr||(Kr(),Hr=!0),Fl.add(u,a),a.v=0}}function sc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Zr(g(a.Fa,a),Mm(a,a.v)),a.v++,!0)}i.Fa=function(){if(this.u=null,Vm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Zr(g(this.ab,this),a)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,it(10),ko(this),Vm(this))};function oc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Vm(a){a.g=new En(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var u=sn(a.qa);we(u,"RID","rpc"),we(u,"SID",a.K),we(u,"AID",a.T),we(u,"CI",a.F?"0":"1"),!a.F&&a.ja&&we(u,"TO",a.ja),we(u,"TYPE","xmlhttp"),cs(a,u),a.m&&a.o&&ic(u,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Po(sn(u)),d.m=null,d.P=!0,om(d,a)}i.Za=function(){this.C!=null&&(this.C=null,ko(this),sc(this),it(19))};function Oo(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Om(a,u){var d=null;if(a.g==u){Oo(a),oc(a),a.g=null;var p=2}else if(tc(a.h,u))d=u.D,dm(a.h,u),p=1;else return;if(a.G!=0){if(u.o)if(p==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var E=a.B;p=Eo(),nt(p,new nm(p,d)),Vo(a)}else km(a);else if(E=u.s,E==3||E==0&&0<u.X||!(p==1&&Dy(a,u)||p==2&&sc(a)))switch(d&&0<d.length&&(u=a.h,u.i=u.i.concat(d)),E){case 1:ri(a,5);break;case 4:ri(a,10);break;case 3:ri(a,6);break;default:ri(a,2)}}}function Mm(a,u){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*u}function ri(a,u){if(a.j.info("Error code "+u),u==2){var d=g(a.fb,a),p=a.Xa;let E=!p;p=new ii(p||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||So(p,"https"),Po(p),E?by(p.toString(),d):Cy(p.toString(),d)}else it(2);a.G=0,a.l&&a.l.sa(u),Nm(a),Pm(a)}i.fb=function(a){a?(this.j.info("Successfully pinged google.com"),it(2)):(this.j.info("Failed to ping google.com"),it(1))};function Nm(a){if(a.G=0,a.ka=[],a.l){let u=mm(a.h);(u.length!=0||a.i.length!=0)&&(R(a.ka,u),R(a.ka,a.i),a.h.i.length=0,O(a.i),a.i.length=0),a.l.ra()}}function Fm(a,u,d){var p=d instanceof ii?sn(d):new ii(d);if(p.g!="")u&&(p.g=u+"."+p.g),xo(p,p.s);else{var E=l.location;p=E.protocol,u=u?u+"."+E.hostname:E.hostname,E=+E.port;var S=new ii(null);p&&So(S,p),u&&(S.g=u),E&&xo(S,E),d&&(S.l=d),p=S}return d=a.D,u=a.ya,d&&u&&we(p,d,u),we(p,"VER",a.la),cs(a,p),p}function Lm(a,u,d){if(u&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=a.Ca&&!a.pa?new Ae(new ss({eb:d})):new Ae(a.pa),u.Ha(a.J),u}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function zm(){}i=zm.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Mo(){}Mo.prototype.g=function(a,u){return new _t(a,u)};function _t(a,u){Xe.call(this),this.g=new xm(u),this.l=a,this.h=u&&u.messageUrlParams||null,a=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(a?a["X-WebChannel-Content-Type"]=u.messageContentType:a={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(a?a["X-WebChannel-Client-Profile"]=u.va:a={"X-WebChannel-Client-Profile":u.va}),this.g.S=a,(a=u&&u.Sb)&&!Q(a)&&(this.g.m=a),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!Q(u)&&(this.g.D=u,a=this.h,a!==null&&u in a&&(a=this.h,u in a&&delete a[u])),this.j=new Gi(this)}V(_t,Xe),_t.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_t.prototype.close=function(){rc(this.g)},_t.prototype.o=function(a){var u=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=Kl(a),a=d);u.i.push(new py(u.Ya++,a)),u.G==3&&Vo(u)},_t.prototype.N=function(){this.g.l=null,delete this.j,rc(this.g),delete this.g,_t.aa.N.call(this)};function Bm(a){Ql.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var u=a.__sm__;if(u){e:{for(let d in u){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,u=u!==null&&a in u?u[a]:void 0),this.data=u}else this.data=a}V(Bm,Ql);function qm(){Wl.call(this),this.status=1}V(qm,Wl);function Gi(a){this.g=a}V(Gi,zm),Gi.prototype.ua=function(){nt(this.g,"a")},Gi.prototype.ta=function(a){nt(this.g,new Bm(a))},Gi.prototype.sa=function(a){nt(this.g,new qm)},Gi.prototype.ra=function(){nt(this.g,"b")},Mo.prototype.createWebChannel=Mo.prototype.g,_t.prototype.send=_t.prototype.o,_t.prototype.open=_t.prototype.m,_t.prototype.close=_t.prototype.close,qc=dn.createWebChannelTransport=function(){return new Mo},Bc=dn.getStatEventTarget=function(){return Eo()},zc=dn.Event=ti,ma=dn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bo.NO_ERROR=0,bo.TIMEOUT=8,bo.HTTP_ERROR=6,bs=dn.ErrorCode=bo,im.COMPLETE="complete",Lc=dn.EventType=im,Jd.EventType=Xr,Xr.OPEN="a",Xr.CLOSE="b",Xr.ERROR="c",Xr.MESSAGE="d",Xe.prototype.listen=Xe.prototype.K,rr=dn.WebChannel=Jd,Fc=dn.FetchXmlHttpFactory=ss,Ae.prototype.listenOnce=Ae.prototype.L,Ae.prototype.getLastError=Ae.prototype.Ka,Ae.prototype.getLastErrorCode=Ae.prototype.Ba,Ae.prototype.getStatus=Ae.prototype.Z,Ae.prototype.getResponseJson=Ae.prototype.Oa,Ae.prototype.getResponseText=Ae.prototype.oa,Ae.prototype.send=Ae.prototype.ea,Ae.prototype.setWithCredentials=Ae.prototype.Ha,Nc=dn.XhrIo=Ae}).apply(typeof da<"u"?da:typeof self<"u"?self:typeof window<"u"?window:{});var Zp="@firebase/firestore";var Fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");var Mr="10.12.1";var Un=new ta("@firebase/firestore");function cr(){return Un.logLevel}function eg(i){Un.setLogLevel(i)}function k(i,...e){if(Un.logLevel<=Kt.DEBUG){let t=e.map(jh);Un.debug(`Firestore (${Mr}): ${i}`,...t)}}function ke(i,...e){if(Un.logLevel<=Kt.ERROR){let t=e.map(jh);Un.error(`Firestore (${Mr}): ${i}`,...t)}}function Dt(i,...e){if(Un.logLevel<=Kt.WARN){let t=e.map(jh);Un.warn(`Firestore (${Mr}): ${i}`,...t)}}function jh(i){if(typeof i=="string")return i;try{return function(t){return JSON.stringify(t)}(i)}catch{return i}}function G(i="Unexpected state"){let e=`FIRESTORE (${Mr}) INTERNAL ASSERTION FAILED: `+i;throw ke(e),new Error(e)}function j(i,e){i||G()}function tg(i,e){i||G()}function q(i,e){return i}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Ap{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Le=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ba=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Kc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fe.UNAUTHENTICATED))}shutdown(){}},Hc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Qc=class{constructor(e){this.t=e,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i,r=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve(),s=new Le;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Le,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>P(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},l=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?l(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Le)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(j(typeof n.accessToken=="string"),new ba(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return j(e===null||typeof e=="string"),new Fe(e)}},Wc=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Fe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Yc=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Wc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Xc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Jc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let n=s=>{s.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,k("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let r=s=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(j(typeof t.token=="string"),this.R=t.token,new Xc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function T1(i){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}var Ca=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let r=T1(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}};function ee(i,e){return i<e?-1:i>e?1:0}function yr(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}function ng(i){return i+"\0"}var Ce=class i{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new D(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return i.fromMillis(Date.now())}static fromDate(e){return i.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new i(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var $=class i{constructor(e){this.timestamp=e}static fromTimestamp(e){return new i(e)}static min(){return new i(new Ce(0,0))}static max(){return new i(new Ce(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Aa=class i{constructor(e,t,n){t===void 0?t=0:t>e.length&&G(),n===void 0?n=e.length-t:n>e.length-t&&G(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return i.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof i?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ae=class i extends Aa{construct(e,t,n){return new i(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new D(x.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new i(t)}static emptyPath(){return new i([])}},E1=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ve=class i extends Aa{construct(e,t,n){return new i(e,t,n)}static isValidIdentifier(e){return E1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),i.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new i(["__name__"])}static fromServerFormat(e){let t=[],n="",r=0,s=()=>{if(n.length===0)throw new D(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},o=!1;for(;r<e.length;){let l=e[r];if(l==="\\"){if(r+1===e.length)throw new D(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new D(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(n+=l,r++):(s(),r++)}if(s(),o)throw new D(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new i(t)}static emptyPath(){return new i([])}};var B=class i{constructor(e){this.path=e}static fromPath(e){return new i(ae.fromString(e))}static fromName(e){return new i(ae.fromString(e).popFirst(5))}static empty(){return new i(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new i(new ae(e.slice()))}};var vr=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};function Zc(i){return i.fields.find(e=>e.kind===2)}function gi(i){return i.fields.filter(e=>e.kind!==2)}vr.UNKNOWN_ID=-1;var fr=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ns=class i{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new i(0,kt.min())}};function ig(i,e){let t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=$.fromTimestamp(n===1e9?new Ce(t+1,0):new Ce(t,n));return new kt(r,B.empty(),e)}function rg(i){return new kt(i.readTime,i.key,-1)}var kt=class i{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new i($.min(),B.empty(),-1)}static max(){return new i($.max(),B.empty(),-1)}};function $h(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(i.documentKey,e.documentKey),t!==0?t:ee(i.largestBatchId,e.largestBatchId))}var sg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Sa=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Jn(i){return P(this,null,function*(){if(i.code!==x.FAILED_PRECONDITION||i.message!==sg)throw i;k("LocalStore","Unexpectedly lost primary lease")})}var A=class i{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new i((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof i?t:i.resolve(t)}catch(t){return i.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):i.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):i.reject(t)}static resolve(e){return new i((t,n)=>{t(e)})}static reject(e){return new i((t,n)=>{n(e)})}static waitFor(e){return new i((t,n)=>{let r=0,s=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++s,o&&s===r&&t()},c=>n(c))}),o=!0,s===r&&t()})}static or(e){let t=i.resolve(!1);for(let n of e)t=t.next(r=>r?i.resolve(r):n());return t}static forEach(e,t){let n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new i((n,r)=>{let s=e.length,o=new Array(s),l=0;for(let c=0;c<s;c++){let h=c;t(e[h]).next(m=>{o[h]=m,++l,l===s&&n(o)},m=>r(m))}})}static doWhile(e,t){return new i((n,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):n()};s()})}};var xa=class i{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Le,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ti(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{let r=Kh(n.target.error);this.V.reject(new Ti(e,r))}}static open(e,t,n,r){try{return new i(t,e.transaction(r,n))}catch(s){throw new Ti(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new tu(t)}},Gn=class i{constructor(e,t,n){this.name=e,this.version=t,this.p=n,i.S(ys())===12.2&&ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),_i(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ea())return!1;if(i.C())return!0;let e=ys(),t=i.S(e),n=0<t&&t<10,r=og(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}M(e){return P(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{n(new Ti(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?n(new D(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new D(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Ti(e,o))},r.onupgradeneeded=s=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,r.transaction,s.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){return P(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let l=xa.open(this.db,e,s?"readonly":"readwrite",n),c=r(l).next(h=>(l.g(),h)).catch(h=>(l.abort(h),A.reject(h))).toPromise();return c.catch(()=>{}),yield l.m,c}catch(l){let c=l,h=c.name!=="FirebaseError"&&o<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),this.close(),!h)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function og(i){let e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var eu=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return _i(this.B.delete())}},Ti=class extends D{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Zn(i){return i.name==="IndexedDbTransactionError"}var tu=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),_i(n)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),_i(this.store.count())}U(e,t){let n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(n.range);return new A((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new A((r,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{r(o.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.H=!1;let r=this.cursor(n);return this.W(r,(s,o,l)=>l.delete())}J(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.W(r,t)}Y(e){let t=this.cursor({});return new A((n,r)=>{t.onerror=s=>{let o=Kh(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,t){let n=[];return new A((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let l=o.target.result;if(!l)return void r();let c=new eu(l),h=t(l.primaryKey,l.value,c);if(h instanceof A){let m=h.catch(f=>(c.done(),A.reject(f)));n.push(m)}c.isDone?r():c.K===null?l.continue():l.continue(c.K)}}).next(()=>A.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function _i(i){return new A((e,t)=>{i.onsuccess=n=>{let r=n.target.result;e(r)},i.onerror=n=>{let r=Kh(n.target.error);t(r)}})}var ef=!1;function Kh(i){let e=Gn.S(ys());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){let n=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ef||(ef=!0,setTimeout(()=>{throw n},0)),n}}return i}var nu=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>P(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Zn(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Jn(t)}yield this.X(6e4)}))}},iu=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return P(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let n=new Set,r=t,s=!0;return A.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return k("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,r).next(l=>{r-=l,n.add(o)});s=!1})).next(()=>t-r)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(r,s)).next(l=>(k("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}re(e,t){let n=e;return t.changes.forEach((r,s)=>{let o=rg(s);$h(o,n)>0&&(n=o)}),new kt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var wt=(()=>{class i{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return i.oe=-1,i})();function ro(i){return i==null}function Fs(i){return i===0&&1/i==-1/0}function ag(i){return typeof i=="number"&&Number.isInteger(i)&&!Fs(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}function st(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=tf(e)),e=b1(i.get(t),e);return tf(e)}function b1(i,e){let t=e,n=i.length;for(let r=0;r<n;r++){let s=i.charAt(r);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function tf(i){return i+""}function Ht(i){let e=i.length;if(j(e>=2),e===2)return j(i.charAt(0)===""&&i.charAt(1)===""),ae.emptyPath();let t=e-2,n=[],r="";for(let s=0;s<e;){let o=i.indexOf("",s);switch((o<0||o>t)&&G(),i.charAt(o+1)){case"":let l=i.substring(s,o),c;r.length===0?c=l:(r+=l,c=r,r=""),n.push(c);break;case"":r+=i.substring(s,o),r+="\0";break;case"":r+=i.substring(s,o+1);break;default:G()}s=o+2}return new ae(n)}var nf=["userId","batchId"];function ya(i,e){return[i,st(e)]}function lg(i,e,t){return[i,st(e),t]}var C1={},A1=["prefixPath","collectionGroup","readTime","documentId"],S1=["prefixPath","collectionGroup","documentId"],x1=["collectionGroup","readTime","prefixPath","documentId"],P1=["canonicalId","targetId"],R1=["targetId","path"],D1=["path","targetId"],k1=["collectionId","parent"],V1=["indexId","uid"],O1=["uid","sequenceNumber"],M1=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],N1=["indexId","uid","orderedDocumentKey"],F1=["userId","collectionPath","documentId"],L1=["userId","collectionPath","largestBatchId"],z1=["userId","collectionGroup","largestBatchId"],cg=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],B1=[...cg,"documentOverlays"],ug=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hg=ug,dg=[...hg,"indexConfiguration","indexState","indexEntries"],q1=dg;var Ls=class extends Sa{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function $e(i,e){let t=q(i);return Gn.F(t._e,e)}function rf(i){let e=0;for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Oi(i,e){for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function mg(i){for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}var Ie=class i{constructor(e,t){this.comparator=e,this.root=t||Wt.EMPTY}insert(e,t){return new i(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wt.BLACK,null,null))}remove(e){return new i(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pr(this.root,e,this.comparator,!1)}getReverseIterator(){return new pr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pr(this.root,e,this.comparator,!0)}},pr=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wt=class i{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??i.RED,this.left=r??i.EMPTY,this.right=s??i.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new i(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return i.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};Wt.EMPTY=null,Wt.RED=!0,Wt.BLACK=!1;Wt.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,n,r,s){return this}insert(e,t,n){return new Wt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ge=class i{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pa(this.data.getIterator())}getIteratorFrom(e){return new Pa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof i)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new i(this.comparator);return t.data=e,t}},Pa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function sr(i){return i.hasNext()?i.getNext():void 0}var It=class i{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new i([])}unionWith(e){let t=new ge(Ve.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new i(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return yr(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var Ra=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function pg(){return typeof atob<"u"}var je=class i{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ra("Invalid base64 string: "+s):s}}(e);return new i(t)}static fromUint8Array(e){let t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new i(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};je.EMPTY_BYTE_STRING=new je("");var U1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fn(i){if(j(!!i),typeof i=="string"){let e=0,t=U1.exec(i);if(j(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pe(i.seconds),nanos:Pe(i.nanos)}}function Pe(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function jn(i){return typeof i=="string"?je.fromBase64String(i):je.fromUint8Array(i)}function wl(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Hh(i){let e=i.mapValue.fields.__previous_value__;return wl(e)?Hh(e):e}function zs(i){let e=fn(i.mapValue.fields.__local_write_time__.timestampValue);return new Ce(e.seconds,e.nanos)}var ru=class{constructor(e,t,n,r,s,o,l,c,h){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}},$n=class i{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new i("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof i&&e.projectId===this.projectId&&e.database===this.database}};var Bn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},va={nullValue:"NULL_VALUE"};function Ei(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?wl(i)?4:fg(i)?9007199254740991:10:G()}function Jt(i,e){if(i===e)return!0;let t=Ei(i);if(t!==Ei(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return zs(i).isEqual(zs(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=fn(r.timestampValue),l=fn(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(r,s){return jn(r.bytesValue).isEqual(jn(s.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(r,s){return Pe(r.geoPointValue.latitude)===Pe(s.geoPointValue.latitude)&&Pe(r.geoPointValue.longitude)===Pe(s.geoPointValue.longitude)}(i,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Pe(r.integerValue)===Pe(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=Pe(r.doubleValue),l=Pe(s.doubleValue);return o===l?Fs(o)===Fs(l):isNaN(o)&&isNaN(l)}return!1}(i,e);case 9:return yr(i.arrayValue.values||[],e.arrayValue.values||[],Jt);case 10:return function(r,s){let o=r.mapValue.fields||{},l=s.mapValue.fields||{};if(rf(o)!==rf(l))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Jt(o[c],l[c])))return!1;return!0}(i,e);default:return G()}}function Bs(i,e){return(i.values||[]).find(t=>Jt(t,e))!==void 0}function Kn(i,e){if(i===e)return 0;let t=Ei(i),n=Ei(e);if(t!==n)return ee(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(i.booleanValue,e.booleanValue);case 2:return function(s,o){let l=Pe(s.integerValue||s.doubleValue),c=Pe(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(i,e);case 3:return sf(i.timestampValue,e.timestampValue);case 4:return sf(zs(i),zs(e));case 5:return ee(i.stringValue,e.stringValue);case 6:return function(s,o){let l=jn(s),c=jn(o);return l.compareTo(c)}(i.bytesValue,e.bytesValue);case 7:return function(s,o){let l=s.split("/"),c=o.split("/");for(let h=0;h<l.length&&h<c.length;h++){let m=ee(l[h],c[h]);if(m!==0)return m}return ee(l.length,c.length)}(i.referenceValue,e.referenceValue);case 8:return function(s,o){let l=ee(Pe(s.latitude),Pe(o.latitude));return l!==0?l:ee(Pe(s.longitude),Pe(o.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(s,o){let l=s.values||[],c=o.values||[];for(let h=0;h<l.length&&h<c.length;++h){let m=Kn(l[h],c[h]);if(m)return m}return ee(l.length,c.length)}(i.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Bn.mapValue&&o===Bn.mapValue)return 0;if(s===Bn.mapValue)return 1;if(o===Bn.mapValue)return-1;let l=s.fields||{},c=Object.keys(l),h=o.fields||{},m=Object.keys(h);c.sort(),m.sort();for(let f=0;f<c.length&&f<m.length;++f){let g=ee(c[f],m[f]);if(g!==0)return g;let b=Kn(l[c[f]],h[m[f]]);if(b!==0)return b}return ee(c.length,m.length)}(i.mapValue,e.mapValue);default:throw G()}}function sf(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return ee(i,e);let t=fn(i),n=fn(e),r=ee(t.seconds,n.seconds);return r!==0?r:ee(t.nanos,n.nanos)}function wr(i){return su(i)}function su(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){let n=fn(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return jn(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return B.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",r=!0;for(let s of t.values||[])r?r=!1:n+=",",n+=su(s);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){let n=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let o of n)s?s=!1:r+=",",r+=`${o}:${su(t.fields[o])}`;return r+"}"}(i.mapValue):G()}function bi(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function ou(i){return!!i&&"integerValue"in i}function qs(i){return!!i&&"arrayValue"in i}function of(i){return!!i&&"nullValue"in i}function af(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function wa(i){return!!i&&"mapValue"in i}function Ds(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){let e={mapValue:{fields:{}}};return Oi(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ds(n)),e}if(i.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ds(i.arrayValue.values[t]);return e}return Object.assign({},i)}function fg(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function G1(i){return"nullValue"in i?va:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?bi($n.empty(),B.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:G()}function j1(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?bi($n.empty(),B.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?Bn:G()}function lf(i,e){let t=Kn(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function cf(i,e){let t=Kn(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}var tt=class i{constructor(e){this.value=e}static empty(){return new i({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!wa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ds(t)}setAll(e){let t=Ve.emptyPath(),n={},r=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){let c=this.getFieldsMap(t);this.applyChanges(c,n,r),n={},r=[],t=l.popLast()}o?n[l.lastSegment()]=Ds(o):r.push(l.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){let t=this.field(e.popLast());wa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];wa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Oi(t,(r,s)=>e[r]=s);for(let r of n)delete e[r]}clone(){return new i(Ds(this.value))}};function gg(i){let e=[];return Oi(i.fields,(t,n)=>{let r=new Ve([t]);if(wa(n)){let s=gg(n.mapValue).fields;if(s.length===0)e.push(r);else for(let o of s)e.push(r.child(o))}else e.push(r)}),new It(e)}var ze=class i{constructor(e,t,n,r,s,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new i(e,0,$.min(),$.min(),$.min(),tt.empty(),0)}static newFoundDocument(e,t,n,r){return new i(e,1,t,$.min(),n,r,0)}static newNoDocument(e,t){return new i(e,2,t,$.min(),$.min(),tt.empty(),0)}static newUnknownDocument(e,t){return new i(e,3,t,$.min(),$.min(),tt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof i&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new i(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Zt=class{constructor(e,t){this.position=e,this.inclusive=t}};function uf(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){let s=e[r],o=i.position[r];if(s.field.isKeyField()?n=B.comparator(B.fromName(o.referenceValue),t.key):n=Kn(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function hf(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Jt(i.position[t],e.position[t]))return!1;return!0}var Ci=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $1(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}var Da=class{},ie=class i extends Da{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new cu(e,t,n):t==="array-contains"?new du(e,n):t==="in"?new ka(e,n):t==="not-in"?new mu(e,n):t==="array-contains-any"?new pu(e,n):new i(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new uu(e,n):new hu(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Kn(t,this.value)):t!==null&&Ei(this.value)===Ei(t)&&this.matchesComparison(Kn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},me=class i extends Da{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new i(e,t)}matches(e){return Ir(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Ir(i){return i.op==="and"}function au(i){return i.op==="or"}function Qh(i){return _g(i)&&Ir(i)}function _g(i){for(let e of i.filters)if(e instanceof me)return!1;return!0}function lu(i){if(i instanceof ie)return i.field.canonicalString()+i.op.toString()+wr(i.value);if(Qh(i))return i.filters.map(e=>lu(e)).join(",");{let e=i.filters.map(t=>lu(t)).join(",");return`${i.op}(${e})`}}function yg(i,e){return i instanceof ie?function(n,r){return r instanceof ie&&n.op===r.op&&n.field.isEqual(r.field)&&Jt(n.value,r.value)}(i,e):i instanceof me?function(n,r){return r instanceof me&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,o,l)=>s&&yg(o,r.filters[l]),!0):!1}(i,e):void G()}function vg(i,e){let t=i.filters.concat(e);return me.create(t,i.op)}function wg(i){return i instanceof ie?function(t){return`${t.field.canonicalString()} ${t.op} ${wr(t.value)}`}(i):i instanceof me?function(t){return t.op.toString()+" {"+t.getFilters().map(wg).join(" ,")+"}"}(i):"Filter"}var cu=class extends ie{constructor(e,t,n){super(e,t,n),this.key=B.fromName(n.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},uu=class extends ie{constructor(e,t){super(e,"in",t),this.keys=Ig("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},hu=class extends ie{constructor(e,t){super(e,"not-in",t),this.keys=Ig("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ig(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>B.fromName(n.referenceValue))}var du=class extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return qs(t)&&Bs(t.arrayValue,this.value)}},ka=class extends ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Bs(this.value.arrayValue,t)}},mu=class extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Bs(this.value.arrayValue,t)}},pu=class extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!qs(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Bs(this.value.arrayValue,n))}};var fu=class{constructor(e,t=null,n=[],r=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}};function gu(i,e=null,t=[],n=[],r=null,s=null,o=null){return new fu(i,e,t,n,r,s,o)}function Ai(i){let e=q(i);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>lu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ro(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>wr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>wr(n)).join(",")),e.ue=t}return e.ue}function so(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!$1(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!yg(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!hf(i.startAt,e.startAt)&&hf(i.endAt,e.endAt)}function Va(i){return B.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function Oa(i,e){return i.filters.filter(t=>t instanceof ie&&t.field.isEqual(e))}function df(i,e,t){let n=va,r=!0;for(let s of Oa(i,e)){let o=va,l=!0;switch(s.op){case"<":case"<=":o=G1(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=va}lf({value:n,inclusive:r},{value:o,inclusive:l})<0&&(n=o,r=l)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){let o=t.position[s];lf({value:n,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(n=o,r=t.inclusive);break}}return{value:n,inclusive:r}}function mf(i,e,t){let n=Bn,r=!0;for(let s of Oa(i,e)){let o=Bn,l=!0;switch(s.op){case">=":case">":o=j1(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Bn}cf({value:n,inclusive:r},{value:o,inclusive:l})>0&&(n=o,r=l)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){let o=t.position[s];cf({value:n,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(n=o,r=t.inclusive);break}}return{value:n,inclusive:r}}var zt=class{constructor(e,t=null,n=[],r=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Tg(i,e,t,n,r,s,o,l){return new zt(i,e,t,n,r,s,o,l)}function Nr(i){return new zt(i)}function pf(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function Wh(i){return i.collectionGroup!==null}function gr(i){let e=q(i);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ge(Ve.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ci(s,n))}),t.has(Ve.keyField().canonicalString())||e.ce.push(new Ci(Ve.keyField(),n))}return e.ce}function ot(i){let e=q(i);return e.le||(e.le=K1(e,gr(i))),e.le}function K1(i,e){if(i.limitType==="F")return gu(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Ci(r.field,s)});let t=i.endAt?new Zt(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new Zt(i.startAt.position,i.startAt.inclusive):null;return gu(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function _u(i,e){let t=i.filters.concat([e]);return new zt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function Ma(i,e,t){return new zt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function oo(i,e){return so(ot(i),ot(e))&&i.limitType===e.limitType}function Eg(i){return`${Ai(ot(i))}|lt:${i.limitType}`}function ur(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(r=>wg(r)).join(", ")}]`),ro(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>wr(r)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>wr(r)).join(",")),`Target(${n})`}(ot(i))}; limitType=${i.limitType})`}function ao(i,e){return e.isFoundDocument()&&function(n,r){let s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):B.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(i,e)&&function(n,r){for(let s of gr(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(i,e)&&function(n,r){for(let s of n.filters)if(!s.matches(r))return!1;return!0}(i,e)&&function(n,r){return!(n.startAt&&!function(o,l,c){let h=uf(o,l,c);return o.inclusive?h<=0:h<0}(n.startAt,gr(n),r)||n.endAt&&!function(o,l,c){let h=uf(o,l,c);return o.inclusive?h>=0:h>0}(n.endAt,gr(n),r))}(i,e)}function bg(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function Cg(i){return(e,t)=>{let n=!1;for(let r of gr(i)){let s=H1(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function H1(i,e,t){let n=i.field.isKeyField()?B.comparator(e.key,t.key):function(s,o,l){let c=o.data.field(s),h=l.data.field(s);return c!==null&&h!==null?Kn(c,h):G()}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return G()}}var en=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Oi(this.inner,(t,n)=>{for(let[r,s]of n)e(r,s)})}isEmpty(){return mg(this.inner)}size(){return this.innerSize}};var Q1=new Ie(B.comparator);function gt(){return Q1}var Ag=new Ie(B.comparator);function Ps(...i){let e=Ag;for(let t of i)e=e.insert(t.key,t);return e}function Sg(i){let e=Ag;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Qt(){return ks()}function xg(){return ks()}function ks(){return new en(i=>i.toString(),(i,e)=>i.isEqual(e))}var W1=new Ie(B.comparator),Y1=new ge(B.comparator);function te(...i){let e=Y1;for(let t of i)e=e.add(t);return e}var X1=new ge(ee);function Yh(){return X1}function Pg(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fs(e)?"-0":e}}function Rg(i){return{integerValue:""+i}}function Dg(i,e){return ag(e)?Rg(e):Pg(i,e)}var Tr=class{constructor(){this._=void 0}};function J1(i,e,t){return i instanceof Hn?function(r,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&wl(s)&&(s=Hh(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):i instanceof gn?Vg(i,e):i instanceof _n?Og(i,e):function(r,s){let o=kg(r,s),l=ff(o)+ff(r.Pe);return ou(o)&&ou(r.Pe)?Rg(l):Pg(r.serializer,l)}(i,e)}function Z1(i,e,t){return i instanceof gn?Vg(i,e):i instanceof _n?Og(i,e):t}function kg(i,e){return i instanceof Qn?function(n){return ou(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var Hn=class extends Tr{},gn=class extends Tr{constructor(e){super(),this.elements=e}};function Vg(i,e){let t=Mg(e);for(let n of i.elements)t.some(r=>Jt(r,n))||t.push(n);return{arrayValue:{values:t}}}var _n=class extends Tr{constructor(e){super(),this.elements=e}};function Og(i,e){let t=Mg(e);for(let n of i.elements)t=t.filter(r=>!Jt(r,n));return{arrayValue:{values:t}}}var Qn=class extends Tr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function ff(i){return Pe(i.integerValue||i.doubleValue)}function Mg(i){return qs(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}var Si=class{constructor(e,t){this.field=e,this.transform=t}};function ev(i,e){return i.field.isEqual(e.field)&&function(n,r){return n instanceof gn&&r instanceof gn||n instanceof _n&&r instanceof _n?yr(n.elements,r.elements,Jt):n instanceof Qn&&r instanceof Qn?Jt(n.Pe,r.Pe):n instanceof Hn&&r instanceof Hn}(i.transform,e.transform)}var yu=class{constructor(e,t){this.version=e,this.transformResults=t}},Re=class i{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new i}static exists(e){return new i(void 0,e)}static updateTime(e){return new i(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ia(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}var Er=class{};function Ng(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new Yn(i.key,Re.none()):new Wn(i.key,i.data,Re.none());{let t=i.data,n=tt.empty(),r=new ge(Ve.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new Bt(i.key,n,new It(r.toArray()),Re.none())}}function tv(i,e,t){i instanceof Wn?function(r,s,o){let l=r.value.clone(),c=_f(r.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(i,e,t):i instanceof Bt?function(r,s,o){if(!Ia(r.precondition,s))return void s.convertToUnknownDocument(o.version);let l=_f(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Fg(r)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(i,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Vs(i,e,t,n){return i instanceof Wn?function(s,o,l,c){if(!Ia(s.precondition,o))return l;let h=s.value.clone(),m=yf(s.fieldTransforms,c,o);return h.setAll(m),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(i,e,t,n):i instanceof Bt?function(s,o,l,c){if(!Ia(s.precondition,o))return l;let h=yf(s.fieldTransforms,c,o),m=o.data;return m.setAll(Fg(s)),m.setAll(h),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(i,e,t,n):function(s,o,l){return Ia(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(i,e,t)}function nv(i,e){let t=null;for(let n of i.fieldTransforms){let r=e.data.field(n.field),s=kg(n.transform,r||null);s!=null&&(t===null&&(t=tt.empty()),t.set(n.field,s))}return t||null}function gf(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&yr(n,r,(s,o)=>ev(s,o))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}var Wn=class extends Er{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Bt=class extends Er{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Fg(i){let e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=i.data.field(t);e.set(t,n)}}),e}function _f(i,e,t){let n=new Map;j(i.length===t.length);for(let r=0;r<t.length;r++){let s=i[r],o=s.transform,l=e.data.field(s.field);n.set(s.field,Z1(o,l,t[r]))}return n}function yf(i,e,t){let n=new Map;for(let r of i){let s=r.transform,o=t.data.field(r.field);n.set(r.field,J1(s,o,e))}return n}var Yn=class extends Er{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Us=class extends Er{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Gs=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&tv(s,e,n[r])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Vs(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Vs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=xg();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,l=this.applyToLocalView(o,s.mutatedFields);l=t.has(r.key)?null:l;let c=Ng(o,l);c!==null&&n.set(r.key,c),o.isValidDocument()||o.convertToNoDocument($.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),te())}isEqual(e){return this.batchId===e.batchId&&yr(this.mutations,e.mutations,(t,n)=>gf(t,n))&&yr(this.baseMutations,e.baseMutations,(t,n)=>gf(t,n))}},vu=class i{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){j(e.mutations.length===n.length);let r=function(){return W1}(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new i(e,t,n,r)}};var js=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var wu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Me,oe;function Lg(i){switch(i){default:return G();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function zg(i){if(i===void 0)return ke("GRPC error has no .code"),x.UNKNOWN;switch(i){case Me.OK:return x.OK;case Me.CANCELLED:return x.CANCELLED;case Me.UNKNOWN:return x.UNKNOWN;case Me.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case Me.INTERNAL:return x.INTERNAL;case Me.UNAVAILABLE:return x.UNAVAILABLE;case Me.UNAUTHENTICATED:return x.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case Me.NOT_FOUND:return x.NOT_FOUND;case Me.ALREADY_EXISTS:return x.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return x.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case Me.ABORTED:return x.ABORTED;case Me.OUT_OF_RANGE:return x.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return x.UNIMPLEMENTED;case Me.DATA_LOSS:return x.DATA_LOSS;default:return G()}}(oe=Me||(Me={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var vf=null;function Bg(){return new TextEncoder}var iv=new Mn([4294967295,4294967295],0);function wf(i){let e=Bg().encode(i),t=new Mc;return t.update(e),new Uint8Array(t.digest())}function If(i){let e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Mn([t,n],0),new Mn([r,s],0)]}var Iu=class i{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ii(`Invalid padding: ${t}`);if(n<0)throw new Ii(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ii(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ii(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Mn.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Mn.fromNumber(n)));return r.compare(iv)===1&&(r=new Mn([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=wf(e),[n,r]=If(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,r,s);if(!this.de(o))return!1}return!0}static create(e,t,n){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new i(s,r,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;let t=wf(e),[n,r]=If(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(n,r,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Ii=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var $s=class i{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let r=new Map;return r.set(e,Ks.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new i($.min(),r,new Ie(ee),gt(),te())}},Ks=class i{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new i(n,t,te(),te(),te())}};var _r=class{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}},Na=class{constructor(e,t){this.targetId=e,this.me=t}},Fa=class{constructor(e,t,n=je.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}},La=class{constructor(){this.fe=0,this.ge=Ef(),this.pe=je.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=te(),t=te(),n=te();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:G()}}),new Ks(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=Ef()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,j(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Tu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=gt(),this.qe=Tf(),this.Qe=new Ie(ee)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,n=e.me.count,r=this.Je(t);if(r){let s=r.target;if(Va(s))if(n===0){let o=new B(s.path);this.Ue(t,o,ze.newNoDocument(o,$.min()))}else j(n===1);else{let o=this.Ye(t);if(o!==n){let l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(t);let h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}vf?.et(function(m,f,g,b,V){var O,R,K,Q,z,W;let J={localCacheCount:m,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},Z=f.unchangedNames;return Z&&(J.bloomFilter={applied:V===0,hashCount:(O=Z?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(Q=(K=(R=Z?.bits)===null||R===void 0?void 0:R.bitmap)===null||K===void 0?void 0:K.length)!==null&&Q!==void 0?Q:0,padding:(W=(z=Z?.bits)===null||z===void 0?void 0:z.padding)!==null&&W!==void 0?W:0,mightContain:w=>{var _;return(_=b?.mightContain(w))!==null&&_!==void 0&&_}}),J}(o,e.me,this.Le.tt(),l,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t,o,l;try{o=jn(n).toUint8Array()}catch(c){if(c instanceof Ra)return Dt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Iu(o,r,s)}catch(c){return Dt(c instanceof Ii?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){let n=this.Le.getRemoteKeysForTarget(t),r=0;return n.forEach(s=>{let o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let l=this.Je(o);if(l){if(s.current&&Va(l.target)){let c=new B(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ze.newNoDocument(c,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let n=te();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{let h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let r=new $s(e,t,this.Qe,this.ke,n);return this.ke=gt(),this.qe=Tf(),this.Qe=new Ie(ee),r}$e(e,t){if(!this.ze(e))return;let n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new La,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ge(ee),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new La),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Tf(){return new Ie(B.comparator)}function Ef(){return new Ie(B.comparator)}var rv={asc:"ASCENDING",desc:"DESCENDING"},sv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ov={and:"AND",or:"OR"},Eu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function bu(i,e){return i.useProto3Json||ro(e)?e:{value:e}}function br(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qg(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function av(i,e){return br(i,e.toTimestamp())}function Oe(i){return j(!!i),$.fromTimestamp(function(t){let n=fn(t);return new Ce(n.seconds,n.nanos)}(i))}function Xh(i,e){return Cu(i,e).canonicalString()}function Cu(i,e){let t=function(r){return new ae(["projects",r.projectId,"databases",r.database])}(i).child("documents");return e===void 0?t:t.child(e)}function Ug(i){let e=ae.fromString(i);return j(Jg(e)),e}function Hs(i,e){return Xh(i.databaseId,e.path)}function Yt(i,e){let t=Ug(e);if(t.get(1)!==i.databaseId.projectId)throw new D(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new D(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new B($g(t))}function Gg(i,e){return Xh(i.databaseId,e)}function jg(i){let e=Ug(i);return e.length===4?ae.emptyPath():$g(e)}function Au(i){return new ae(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function $g(i){return j(i.length>4&&i.get(4)==="documents"),i.popFirst(5)}function bf(i,e,t){return{name:Hs(i,e),fields:t.value.mapValue.fields}}function Kg(i,e,t){let n=Yt(i,e.name),r=Oe(e.updateTime),s=e.createTime?Oe(e.createTime):$.min(),o=new tt({mapValue:{fields:e.fields}}),l=ze.newFoundDocument(n,r,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function lv(i,e){return"found"in e?function(n,r){j(!!r.found),r.found.name,r.found.updateTime;let s=Yt(n,r.found.name),o=Oe(r.found.updateTime),l=r.found.createTime?Oe(r.found.createTime):$.min(),c=new tt({mapValue:{fields:r.found.fields}});return ze.newFoundDocument(s,o,l,c)}(i,e):"missing"in e?function(n,r){j(!!r.missing),j(!!r.readTime);let s=Yt(n,r.missing),o=Oe(r.readTime);return ze.newNoDocument(s,o)}(i,e):G()}function cv(i,e){let t;if("targetChange"in e){e.targetChange;let n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(h,m){return h.useProto3Json?(j(m===void 0||typeof m=="string"),je.fromBase64String(m||"")):(j(m===void 0||m instanceof Buffer||m instanceof Uint8Array),je.fromUint8Array(m||new Uint8Array))}(i,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){let m=h.code===void 0?x.UNKNOWN:zg(h.code);return new D(m,h.message||"")}(o);t=new Fa(n,r,s,l||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let r=Yt(i,n.document.name),s=Oe(n.document.updateTime),o=n.document.createTime?Oe(n.document.createTime):$.min(),l=new tt({mapValue:{fields:n.document.fields}}),c=ze.newFoundDocument(r,s,o,l),h=n.targetIds||[],m=n.removedTargetIds||[];t=new _r(h,m,c.key,c)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let r=Yt(i,n.document),s=n.readTime?Oe(n.readTime):$.min(),o=ze.newNoDocument(r,s),l=n.removedTargetIds||[];t=new _r([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let r=Yt(i,n.document),s=n.removedTargetIds||[];t=new _r([],s,r,null)}else{if(!("filter"in e))return G();{e.filter;let n=e.filter;n.targetId;let{count:r=0,unchangedNames:s}=n,o=new wu(r,s),l=n.targetId;t=new Na(l,o)}}return t}function Qs(i,e){let t;if(e instanceof Wn)t={update:bf(i,e.key,e.value)};else if(e instanceof Yn)t={delete:Hs(i,e.key)};else if(e instanceof Bt)t={update:bf(i,e.key,e.data),updateMask:fv(e.fieldMask)};else{if(!(e instanceof Us))return G();t={verify:Hs(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){let l=o.transform;if(l instanceof Hn)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof gn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof _n)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Qn)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw G()}(0,n))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:av(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(i,e.precondition)),t}function Su(i,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Re.updateTime(Oe(s.updateTime)):s.exists!==void 0?Re.exists(s.exists):Re.none()}(e.currentDocument):Re.none(),n=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let c=null;if("setToServerValue"in l)j(l.setToServerValue==="REQUEST_TIME"),c=new Hn;else if("appendMissingElements"in l){let m=l.appendMissingElements.values||[];c=new gn(m)}else if("removeAllFromArray"in l){let m=l.removeAllFromArray.values||[];c=new _n(m)}else"increment"in l?c=new Qn(o,l.increment):G();let h=Ve.fromServerFormat(l.fieldPath);return new Si(h,c)}(i,r)):[];if(e.update){e.update.name;let r=Yt(i,e.update.name),s=new tt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let h=c.fieldPaths||[];return new It(h.map(m=>Ve.fromServerFormat(m)))}(e.updateMask);return new Bt(r,s,o,t,n)}return new Wn(r,s,t,n)}if(e.delete){let r=Yt(i,e.delete);return new Yn(r,t)}if(e.verify){let r=Yt(i,e.verify);return new Us(r,t)}return G()}function uv(i,e){return i&&i.length>0?(j(e!==void 0),i.map(t=>function(r,s){let o=r.updateTime?Oe(r.updateTime):Oe(s);return o.isEqual($.min())&&(o=Oe(s)),new yu(o,r.transformResults||[])}(t,e))):[]}function Hg(i,e){return{documents:[Gg(i,e.path)]}}function Qg(i,e){let t={structuredQuery:{}},n=e.path,r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Gg(i,r);let s=function(h){if(h.length!==0)return Xg(me.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(h){if(h.length!==0)return h.map(m=>function(g){return{field:hr(g.field),direction:dv(g.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let l=bu(i,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:r}}function Wg(i){let e=jg(i.parent),t=i.structuredQuery,n=t.from?t.from.length:0,r=null;if(n>0){j(n===1);let m=t.from[0];m.allDescendants?r=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(f){let g=Yg(f);return g instanceof me&&Qh(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(V){return new Ci(dr(V.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(f){let g;return g=typeof f=="object"?f.value:f,ro(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(f){let g=!!f.before,b=f.values||[];return new Zt(b,g)}(t.startAt));let h=null;return t.endAt&&(h=function(f){let g=!f.before,b=f.values||[];return new Zt(b,g)}(t.endAt)),Tg(e,r,o,s,l,"F",c,h)}function hv(i,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Yg(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=dr(t.unaryFilter.field);return ie.create(n,"==",{doubleValue:NaN});case"IS_NULL":let r=dr(t.unaryFilter.field);return ie.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=dr(t.unaryFilter.field);return ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=dr(t.unaryFilter.field);return ie.create(o,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(i):i.fieldFilter!==void 0?function(t){return ie.create(dr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return me.create(t.compositeFilter.filters.map(n=>Yg(n)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(i):G()}function dv(i){return rv[i]}function mv(i){return sv[i]}function pv(i){return ov[i]}function hr(i){return{fieldPath:i.canonicalString()}}function dr(i){return Ve.fromServerFormat(i.fieldPath)}function Xg(i){return i instanceof ie?function(t){if(t.op==="=="){if(af(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NAN"}};if(of(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(af(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NAN"}};if(of(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hr(t.field),op:mv(t.op),value:t.value}}}(i):i instanceof me?function(t){let n=t.getFilters().map(r=>Xg(r));return n.length===1?n[0]:{compositeFilter:{op:pv(t.op),filters:n}}}(i):G()}function fv(i){let e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Jg(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}var Cr=class i{constructor(e,t,n,r,s=$.min(),o=$.min(),l=je.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var za=class{constructor(e){this.ct=e}};function gv(i,e){let t;if(e.document)t=Kg(i.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=B.fromSegments(e.noDocument.path),r=Pi(e.noDocument.readTime);t=ze.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let n=B.fromSegments(e.unknownDocument.path),r=Pi(e.unknownDocument.version);t=ze.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime(function(r){let s=new Ce(r[0],r[1]);return $.fromTimestamp(s)}(e.readTime)),t}function Cf(i,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Ba(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:Hs(s,o.key),fields:o.data.value.mapValue.fields,updateTime:br(s,o.version.toTimestamp()),createTime:br(s,o.createTime.toTimestamp())}}(i.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:xi(e.version)};else{if(!e.isUnknownDocument())return G();n.unknownDocument={path:t.path.toArray(),version:xi(e.version)}}return n}function Ba(i){let e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function xi(i){let e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Pi(i){let e=new Ce(i.seconds,i.nanoseconds);return $.fromTimestamp(e)}function yi(i,e){let t=(e.baseMutations||[]).map(s=>Su(i.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>Su(i.ct,s)),r=Ce.fromMillis(e.localWriteTimeMs);return new Gs(e.batchId,r,t,n)}function Rs(i){let e=Pi(i.readTime),t=i.lastLimboFreeSnapshotVersion!==void 0?Pi(i.lastLimboFreeSnapshotVersion):$.min(),n;return n=function(s){return s.documents!==void 0}(i.query)?function(s){return j(s.documents.length===1),ot(Nr(jg(s.documents[0])))}(i.query):function(s){return ot(Wg(s))}(i.query),new Cr(n,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,je.fromBase64String(i.resumeToken))}function Zg(i,e){let t=xi(e.snapshotVersion),n=xi(e.lastLimboFreeSnapshotVersion),r;r=Va(e.target)?Hg(i.ct,e.target):Qg(i.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ai(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function Jh(i){let e=Wg({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Ma(e,e.limit,"L"):e}function Uc(i,e){return new js(e.largestBatchId,Su(i.ct,e.overlayMutation))}function Af(i,e){let t=e.path.lastSegment();return[i,st(e.path.popLast()),t]}function Sf(i,e,t,n){return{indexId:i,uid:e,sequenceNumber:t,readTime:xi(n.readTime),documentKey:st(n.documentKey.path),largestBatchId:n.largestBatchId}}var xu=class{getBundleMetadata(e,t){return xf(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:Pi(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return xf(e).put(function(r){return{bundleId:r.id,createTime:xi(Oe(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return Pf(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:Jh(s.bundledQuery),readTime:Pi(s.readTime)}}(n)})}saveNamedQuery(e,t){return Pf(e).put(function(r){return{name:r.name,readTime:xi(Oe(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function xf(i){return $e(i,"bundles")}function Pf(i){return $e(i,"namedQueries")}var qa=class i{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let n=t.uid||"";return new i(e,n)}getOverlay(e,t){return Cs(e).get(Af(this.userId,t)).next(n=>n?Uc(this.serializer,n):null)}getOverlays(e,t){let n=Qt();return A.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((s,o)=>{let l=new js(t,o);r.push(this.ht(e,l))}),A.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(o=>r.add(st(o.getCollectionPath())));let s=[];return r.forEach(o=>{let l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Cs(e).j("collectionPathOverlayIndex",l))}),A.waitFor(s)}getOverlaysForCollection(e,t,n){let r=Qt(),s=st(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Cs(e).U("collectionPathOverlayIndex",o).next(l=>{for(let c of l){let h=Uc(this.serializer,c);r.set(h.getKey(),h)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let s=Qt(),o,l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Cs(e).J({index:"collectionGroupOverlayIndex",range:l},(c,h,m)=>{let f=Uc(this.serializer,h);s.size()<r||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):m.done()}).next(()=>s)}ht(e,t){return Cs(e).put(function(r,s,o){let[l,c,h]=Af(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Qs(r.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Cs(i){return $e(i,"documentOverlays")}var mn=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Pe(e.integerValue));else if("doubleValue"in e){let n=Pe(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),Fs(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),typeof n=="string"&&(n=fn(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(jn(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?fg(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):G()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let n=e.fields||{};this.Et(t,55);for(let r of Object.keys(n))this.Rt(r,t),this.It(n[r],t)}wt(e,t){let n=e.values||[];this.Et(t,50);for(let r of n)this.It(r,t)}gt(e,t){this.Et(t,37),B.fromName(e).path.forEach(n=>{this.Et(t,60),this.St(n,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};mn.bt=new mn;function _v(i){if(i===0)return 8;let e=0;return!(i>>4)&&(e+=4,i<<=4),!(i>>6)&&(e+=2,i<<=2),!(i>>7)&&(e+=1),e}function Rf(i){let e=64-function(n){let r=0;for(let s=0;s<8;++s){let o=_v(255&n[s]);if(r+=o,o!==8)break}return r}(i);return Math.ceil(e/8)}var Pu=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Ct(n);else if(n<2048)this.Ct(960|n>>>6),this.Ct(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|n>>>12),this.Ct(128|63&n>>>6),this.Ct(128|63&n);else{let r=t.codePointAt(0);this.Ct(240|r>>>18),this.Ct(128|63&r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r)}}this.vt()}Nt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Mt(n);else if(n<2048)this.Mt(960|n>>>6),this.Mt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|n>>>12),this.Mt(128|63&n>>>6),this.Mt(128|63&n);else{let r=t.codePointAt(0);this.Mt(240|r>>>18),this.Mt(128|63&r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r)}}this.xt()}Lt(e){let t=this.Bt(e),n=Rf(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}qt(e){let t=this.Bt(e),n=Rf(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ct(e){let t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}},Ru=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},Du=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},vi=class{constructor(){this.Gt=new Pu,this.zt=new Ru(this.Gt),this.jt=new Du(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var wi=class i{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new i(this.indexId,this.documentKey,this.arrayValue,n)}};function Nn(i,e){let t=i.indexId-e.indexId;return t!==0?t:(t=Df(i.arrayValue,e.arrayValue),t!==0?t:(t=Df(i.directionalValue,e.directionalValue),t!==0?t:B.comparator(i.documentKey,e.documentKey)))}function Df(i,e){for(let t=0;t<i.length&&t<e.length;++t){let n=i[t]-e[t];if(n!==0)return n}return i.length-e.length}var Ua=class{constructor(e){this.Yt=new ge((t,n)=>Ve.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let t of e.filters){let n=t;n.isInequality()?this.Yt=this.Yt.add(n):this.Xt.push(n)}}get en(){return this.Yt.size>1}tn(e){if(j(e.collectionGroup===this.collectionId),this.en)return!1;let t=Zc(e);if(t!==void 0&&!this.nn(t))return!1;let n=gi(e),r=new Set,s=0,o=0;for(;s<n.length&&this.nn(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Yt.size>0){let l=this.Yt.getIterator().getNext();if(!r.has(l.field.canonicalString())){let c=n[s];if(!this.rn(l,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<n.length;++s){let l=n[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],l))return!1}return!0}on(){if(this.en)return null;let e=new ge(Ve.comparator),t=[];for(let n of this.Xt)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new fr(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new fr(n.field,0))}for(let n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new fr(n.field,n.dir==="asc"?0:1)));return new vr(vr.UNKNOWN_ID,this.collectionId,t,Ns.empty())}nn(e){for(let t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function e_(i){var e,t;if(j(i instanceof ie||i instanceof me),i instanceof ie){if(i instanceof ka){let r=((t=(e=i.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ie.create(i.field,"==",s)))||[];return me.create(r,"or")}return i}let n=i.filters.map(r=>e_(r));return me.create(n,i.op)}function yv(i){if(i.getFilters().length===0)return[];let e=Ou(e_(i));return j(t_(e)),ku(e)||Vu(e)?[e]:e.getFilters()}function ku(i){return i instanceof ie}function Vu(i){return i instanceof me&&Qh(i)}function t_(i){return ku(i)||Vu(i)||function(t){if(t instanceof me&&au(t)){for(let n of t.getFilters())if(!ku(n)&&!Vu(n))return!1;return!0}return!1}(i)}function Ou(i){if(j(i instanceof ie||i instanceof me),i instanceof ie)return i;if(i.filters.length===1)return Ou(i.filters[0]);let e=i.filters.map(n=>Ou(n)),t=me.create(e,i.op);return t=Ga(t),t_(t)?t:(j(t instanceof me),j(Ir(t)),j(t.filters.length>1),t.filters.reduce((n,r)=>Zh(n,r)))}function Zh(i,e){let t;return j(i instanceof ie||i instanceof me),j(e instanceof ie||e instanceof me),t=i instanceof ie?e instanceof ie?function(r,s){return me.create([r,s],"and")}(i,e):kf(i,e):e instanceof ie?kf(e,i):function(r,s){if(j(r.filters.length>0&&s.filters.length>0),Ir(r)&&Ir(s))return vg(r,s.getFilters());let o=au(r)?r:s,l=au(r)?s:r,c=o.filters.map(h=>Zh(h,l));return me.create(c,"or")}(i,e),Ga(t)}function kf(i,e){if(Ir(e))return vg(e,i.getFilters());{let t=e.filters.map(n=>Zh(i,n));return me.create(t,"or")}}function Ga(i){if(j(i instanceof ie||i instanceof me),i instanceof ie)return i;let e=i.getFilters();if(e.length===1)return Ga(e[0]);if(_g(i))return i;let t=e.map(r=>Ga(r)),n=[];return t.forEach(r=>{r instanceof ie?n.push(r):r instanceof me&&(r.op===i.op?n.push(...r.filters):n.push(r))}),n.length===1?n[0]:me.create(n,i.op)}var Mu=class{constructor(){this._n=new Ws}addToCollectionParentIndex(e,t){return this._n.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}deleteAllFieldIndexes(e){return A.resolve()}createTargetIndexes(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(kt.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(kt.min())}updateCollectionGroup(e,t,n){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}},Ws=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ge(ae.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ge(ae.comparator)).toArray()}};var pa=new Uint8Array(0),Nu=class{constructor(e,t){this.databaseId=t,this.an=new Ws,this.un=new en(n=>Ai(n),(n,r)=>so(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});let s={collectionId:n,parent:st(r)};return Vf(e).put(s)}return A.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[ng(t),""],!1,!0);return Vf(e).U(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;n.push(Ht(o.parent))}return n})}addFieldIndex(e,t){let n=As(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete r.indexId;let s=n.add(r);if(t.indexState){let o=ar(e);return s.next(l=>{o.put(Sf(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let n=As(e),r=ar(e),s=or(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=As(e),n=or(e),r=ar(e);return t.j().next(()=>n.j()).next(()=>r.j())}createTargetIndexes(e,t){return A.forEach(this.cn(t),n=>this.getIndexType(e,n).next(r=>{if(r===0||r===1){let s=new Ua(n).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let n=or(e),r=!0,s=new Map;return A.forEach(this.cn(t),o=>this.ln(e,o).next(l=>{r&&(r=!!l),s.set(o,l)})).next(()=>{if(r){let o=te(),l=[];return A.forEach(s,(c,h)=>{k("IndexedDbIndexManager",`Using index ${function(z){return`id=${z.indexId}|cg=${z.collectionGroup}|f=${z.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(c)} to execute ${Ai(t)}`);let m=function(z,W){let J=Zc(W);if(J===void 0)return null;for(let Z of Oa(z,J.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(h,c),f=function(z,W){let J=new Map;for(let Z of gi(W))for(let w of Oa(z,Z.fieldPath))switch(w.op){case"==":case"in":J.set(Z.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return J.set(Z.fieldPath.canonicalString(),w.value),Array.from(J.values())}return null}(h,c),g=function(z,W){let J=[],Z=!0;for(let w of gi(W)){let _=w.kind===0?df(z,w.fieldPath,z.startAt):mf(z,w.fieldPath,z.startAt);J.push(_.value),Z&&(Z=_.inclusive)}return new Zt(J,Z)}(h,c),b=function(z,W){let J=[],Z=!0;for(let w of gi(W)){let _=w.kind===0?mf(z,w.fieldPath,z.endAt):df(z,w.fieldPath,z.endAt);J.push(_.value),Z&&(Z=_.inclusive)}return new Zt(J,Z)}(h,c),V=this.hn(c,h,g),O=this.hn(c,h,b),R=this.Pn(c,h,f),K=this.In(c.indexId,m,V,g.inclusive,O,b.inclusive,R);return A.forEach(K,Q=>n.G(Q,t.limit).next(z=>{z.forEach(W=>{let J=B.fromSegments(W.documentKey);o.has(J)||(o=o.add(J),l.push(J))})}))}).next(()=>l)}return A.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=yv(me.create(e.filters,"and")).map(n=>gu(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,n,r,s,o,l){let c=(t!=null?t.length:1)*Math.max(n.length,s.length),h=c/(t!=null?t.length:1),m=[];for(let f=0;f<c;++f){let g=t?this.Tn(t[f/h]):pa,b=this.En(e,g,n[f%h],r),V=this.dn(e,g,s[f%h],o),O=l.map(R=>this.En(e,g,R,!0));m.push(...this.createRange(b,V,O))}return m}En(e,t,n,r){let s=new wi(e,B.empty(),t,n);return r?s:s.Jt()}dn(e,t,n,r){let s=new wi(e,B.empty(),t,n);return r?s.Jt():s}ln(e,t){let n=new Ua(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let l of s)n.tn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let n=2,r=this.cn(t);return A.forEach(r,s=>this.ln(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let h=new ge(Ve.comparator),m=!1;for(let f of c.filters)for(let g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?m=!0:h=h.add(g.field));for(let f of c.orderBy)f.field.isKeyField()||(h=h.add(f.field));return h.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&n===2?1:n)}An(e,t){let n=new vi;for(let r of gi(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=n.Ht(r.kind);mn.bt.Pt(s,o)}return n.Wt()}Tn(e){let t=new vi;return mn.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){let n=new vi;return mn.bt.Pt(bi(this.databaseId,t),n.Ht(function(s){let o=gi(s);return o.length===0?0:o[o.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(n===null)return[];let r=[];r.push(new vi);let s=0;for(let o of gi(e)){let l=n[s++];for(let c of r)if(this.Vn(t,o.fieldPath)&&qs(l))r=this.mn(r,o,l);else{let h=c.Ht(o.kind);mn.bt.Pt(l,h)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){let r=[...e],s=[];for(let o of n.arrayValue.values||[])for(let l of r){let c=new vi;c.seed(l.Wt()),mn.bt.Pt(o,c.Ht(t.kind)),s.push(c)}return s}Vn(e,t){return!!e.filters.find(n=>n instanceof ie&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=As(e),r=ar(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{let o=[];return A.forEach(s,l=>r.get([l.indexId,this.uid]).next(c=>{o.push(function(m,f){let g=f?new Ns(f.sequenceNumber,new kt(Pi(f.readTime),new B(Ht(f.documentKey)),f.largestBatchId)):Ns.empty(),b=m.fields.map(([V,O])=>new fr(Ve.fromServerFormat(V),O));return new vr(m.indexId,m.collectionGroup,b,g)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,r)=>{let s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:ee(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=As(e),s=ar(e);return this.gn(e).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>A.forEach(l,c=>s.put(Sf(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){let n=new Map;return A.forEach(t,(r,s)=>{let o=n.get(r.collectionGroup);return(o?A.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(n.set(r.collectionGroup,l),A.forEach(l,c=>this.pn(e,r,c).next(h=>{let m=this.yn(s,c);return h.isEqual(m)?A.resolve():this.wn(e,s,c,h,m)}))))})}Sn(e,t,n,r){return or(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return or(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){let r=or(e),s=new ge(Nn);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},(o,l)=>{s=s.add(new wi(n.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}yn(e,t){let n=new ge(Nn),r=this.An(t,e);if(r==null)return n;let s=Zc(t);if(s!=null){let o=e.data.field(s.fieldPath);if(qs(o))for(let l of o.arrayValue.values||[])n=n.add(new wi(t.indexId,e.key,this.Tn(l),r))}else n=n.add(new wi(t.indexId,e.key,pa,r));return n}wn(e,t,n,r,s){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,h,m,f,g){let b=c.getIterator(),V=h.getIterator(),O=sr(b),R=sr(V);for(;O||R;){let K=!1,Q=!1;if(O&&R){let z=m(O,R);z<0?Q=!0:z>0&&(K=!0)}else O!=null?Q=!0:K=!0;K?(f(R),R=sr(V)):Q?(g(O),O=sr(b)):(O=sr(b),R=sr(V))}}(r,s,Nn,l=>{o.push(this.Sn(e,t,n,l))},l=>{o.push(this.bn(e,t,n,l))}),A.waitFor(o)}gn(e){let t=1;return ar(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,l)=>Nn(o,l)).filter((o,l,c)=>!l||Nn(o,c[l-1])!==0);let r=[];r.push(e);for(let o of n){let l=Nn(o,e),c=Nn(o,t);if(l===0)r[0]=e.Jt();else if(l>0&&c<0)r.push(o),r.push(o.Jt());else if(c>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.Dn(r[o],r[o+1]))return[];let l=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,pa,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,pa,[]];s.push(IDBKeyRange.bound(l,c))}return s}Dn(e,t){return Nn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Of)}getMinOffset(e,t){return A.mapArray(this.cn(t),n=>this.ln(e,n).next(r=>r||G())).next(Of)}};function Vf(i){return $e(i,"collectionParents")}function or(i){return $e(i,"indexEntries")}function As(i){return $e(i,"indexConfiguration")}function ar(i){return $e(i,"indexState")}function Of(i){j(i.length!==0);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){let r=i[n].indexState.offset;$h(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new kt(e.readTime,e.documentKey,t)}var Mf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rt=class i{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new i(e,i.DEFAULT_COLLECTION_PERCENTILE,i.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function n_(i,e,t){let n=i.store("mutations"),r=i.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),l=0,c=n.J({range:o},(m,f,g)=>(l++,g.delete()));s.push(c.next(()=>{j(l===1)}));let h=[];for(let m of t.mutations){let f=lg(e,m.key.path,t.batchId);s.push(r.delete(f)),h.push(m.key)}return A.waitFor(s).next(()=>h)}function ja(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw G();e=i.noDocument}return JSON.stringify(e).length}Rt.DEFAULT_COLLECTION_PERCENTILE=10,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rt.DEFAULT=new Rt(41943040,Rt.DEFAULT_COLLECTION_PERCENTILE,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rt.DISABLED=new Rt(-1,0,0);var $a=class i{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){j(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new i(s,t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fn(e).J({index:"userMutationsIndex",range:n},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let s=mr(e),o=Fn(e);return o.add({}).next(l=>{j(typeof l=="number");let c=new Gs(l,t,n,r),h=function(b,V,O){let R=O.baseMutations.map(Q=>Qs(b.ct,Q)),K=O.mutations.map(Q=>Qs(b.ct,Q));return{userId:V,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:R,mutations:K}}(this.serializer,this.userId,c),m=[],f=new ge((g,b)=>ee(g.canonicalString(),b.canonicalString()));for(let g of r){let b=lg(this.userId,g.key.path,l);f=f.add(g.key.path.popLast()),m.push(o.put(h)),m.push(s.put(b,C1))}return f.forEach(g=>{m.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Cn[l]=c.keys()}),A.waitFor(m).next(()=>c)})}lookupMutationBatch(e,t){return Fn(e).get(t).next(n=>n?(j(n.userId===this.userId),yi(this.serializer,n)):null)}vn(e,t){return this.Cn[t]?A.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let r=n.keys();return this.Cn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),s=null;return Fn(e).J({index:"userMutationsIndex",range:r},(o,l,c)=>{l.userId===this.userId&&(j(l.batchId>=n),s=yi(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Fn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fn(e).U("userMutationsIndex",t).next(n=>n.map(r=>yi(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=ya(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return mr(e).J({range:r},(o,l,c)=>{let[h,m,f]=o,g=Ht(m);if(h===this.userId&&t.path.isEqual(g))return Fn(e).get(f).next(b=>{if(!b)throw G();j(b.userId===this.userId),s.push(yi(this.serializer,b))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ge(ee),r=[];return t.forEach(s=>{let o=ya(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=mr(e).J({range:l},(h,m,f)=>{let[g,b,V]=h,O=Ht(b);g===this.userId&&s.path.isEqual(O)?n=n.add(V):f.done()});r.push(c)}),A.waitFor(r).next(()=>this.Fn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,s=ya(this.userId,n),o=IDBKeyRange.lowerBound(s),l=new ge(ee);return mr(e).J({range:o},(c,h,m)=>{let[f,g,b]=c,V=Ht(g);f===this.userId&&n.isPrefixOf(V)?V.length===r&&(l=l.add(b)):m.done()}).next(()=>this.Fn(e,l))}Fn(e,t){let n=[],r=[];return t.forEach(s=>{r.push(Fn(e).get(s).next(o=>{if(o===null)throw G();j(o.userId===this.userId),n.push(yi(this.serializer,o))}))}),A.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return n_(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),A.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return A.resolve();let n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return mr(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){let c=Ht(s[1]);r.push(c)}else l.done()}).next(()=>{j(r.length===0)})})}containsKey(e,t){return i_(e,this.userId,t)}xn(e){return r_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function i_(i,e,t){let n=ya(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n),o=!1;return mr(i).J({range:s,H:!0},(l,c,h)=>{let[m,f,g]=l;m===e&&f===r&&(o=!0),h.done()}).next(()=>o)}function Fn(i){return $e(i,"mutations")}function mr(i){return $e(i,"documentMutations")}function r_(i){return $e(i,"mutationQueues")}var Ar=class i{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new i(0)}static Ln(){return new i(-1)}};var Fu=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{let n=new Ar(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>$.fromTimestamp(new Ce(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Bn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>lr(e).delete(t.targetId)).next(()=>this.Bn(e)).next(n=>(j(n.targetCount>0),n.targetCount-=1,this.kn(e,n)))}removeTargets(e,t,n){let r=0,s=[];return lr(e).J((o,l)=>{let c=Rs(l);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(e,c)))}).next(()=>A.waitFor(s)).next(()=>r)}forEachTarget(e,t){return lr(e).J((n,r)=>{let s=Rs(r);t(s)})}Bn(e){return Nf(e).get("targetGlobalKey").next(t=>(j(t!==null),t))}kn(e,t){return Nf(e).put("targetGlobalKey",t)}qn(e,t){return lr(e).put(Zg(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){let n=Ai(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return lr(e).J({range:r,index:"queryTargetsIndex"},(o,l,c)=>{let h=Rs(l);so(t,h.target)&&(s=h,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){let r=[],s=Ln(e);return t.forEach(o=>{let l=st(o.path);r.push(s.put({targetId:n,path:l})),r.push(this.referenceDelegate.addReference(e,n,o))}),A.waitFor(r)}removeMatchingKeys(e,t,n){let r=Ln(e);return A.forEach(t,s=>{let o=st(s.path);return A.waitFor([r.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){let n=Ln(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Ln(e),s=te();return r.J({range:n,H:!0},(o,l,c)=>{let h=Ht(o[1]),m=new B(h);s=s.add(m)}).next(()=>s)}containsKey(e,t){let n=st(t.path),r=IDBKeyRange.bound([n],[ng(n)],!1,!0),s=0;return Ln(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,l],c,h)=>{o!==0&&(s++,h.done())}).next(()=>s>0)}ot(e,t){return lr(e).get(t).next(n=>n?Rs(n):null)}};function lr(i){return $e(i,"targets")}function Nf(i){return $e(i,"targetGlobal")}function Ln(i){return $e(i,"targetDocuments")}function Ff([i,e],[t,n]){let r=ee(i,t);return r===0?ee(e,n):r}var Lu=class{constructor(e){this.Kn=e,this.buffer=new ge(Ff),this.$n=0}Un(){return++this.$n}Wn(e){let t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();Ff(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},zu=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>P(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zn(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Jn(t)}yield this.zn(3e5)}))}},Bu=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return A.resolve(wt.oe);let n=new Lu(t);return this.jn.forEachTarget(e,r=>n.Wn(r.sequenceNumber)).next(()=>this.jn.Jn(e,r=>n.Wn(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(Mf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mf):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,r,s,o,l,c,h,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,t))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(h=Date.now(),cr()<=Kt.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(h-c)+`ms
Total Duration: ${h-m}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:f})))}};function vv(i,e){return new Bu(i,e)}var qu=class{constructor(e,t){this.db=e,this.garbageCollector=vv(this,t)}Hn(e){let t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}Zn(e){let t=0;return this.Jn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(n,r)=>t(r))}addReference(e,t,n){return fa(e,n)}removeReference(e,t,n){return fa(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return fa(e,t)}er(e,t){return function(r,s){let o=!1;return r_(r).Y(l=>i_(r,l,s).next(c=>(c&&(o=!0),A.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],s=0;return this.Xn(e,(o,l)=>{if(l<=t){let c=this.er(e,o).next(h=>{if(!h)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,$.min()),Ln(e).delete(function(f){return[0,st(f.path)]}(o))))});r.push(c)}}).next(()=>A.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return fa(e,t)}Xn(e,t){let n=Ln(e),r,s=wt.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:h})=>{o===0?(s!==wt.oe&&t(new B(Ht(r)),s),s=h,r=c):s=wt.oe}).next(()=>{s!==wt.oe&&t(new B(Ht(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function fa(i,e){return Ln(i).put(function(n,r){return{targetId:0,path:st(n.path),sequenceNumber:r}}(e,i.currentSequenceNumber))}var Ka=class{constructor(){this.changes=new en(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ze.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?A.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Uu=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return fi(e).put(n)}removeEntry(e,t,n){return fi(e).delete(function(s,o){let l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Ba(o),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.tr(e,n)))}getEntry(e,t){let n=ze.newInvalidDocument(t);return fi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ss(t))},(r,s)=>{n=this.nr(t,s)}).next(()=>n)}rr(e,t){let n={size:0,document:ze.newInvalidDocument(t)};return fi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ss(t))},(r,s)=>{n={document:this.nr(t,s),size:ja(s)}}).next(()=>n)}getEntries(e,t){let n=gt();return this.ir(e,t,(r,s)=>{let o=this.nr(r,s);n=n.insert(r,o)}).next(()=>n)}sr(e,t){let n=gt(),r=new Ie(B.comparator);return this.ir(e,t,(s,o)=>{let l=this.nr(s,o);n=n.insert(s,l),r=r.insert(s,ja(o))}).next(()=>({documents:n,_r:r}))}ir(e,t,n){if(t.isEmpty())return A.resolve();let r=new ge(Bf);t.forEach(c=>r=r.add(c));let s=IDBKeyRange.bound(Ss(r.first()),Ss(r.last())),o=r.getIterator(),l=o.getNext();return fi(e).J({index:"documentKeyIndex",range:s},(c,h,m)=>{let f=B.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;l&&Bf(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,h),l=o.hasNext()?o.getNext():null),l?m.$(Ss(l)):m.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,s){let o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Ba(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fi(e).U(IDBKeyRange.bound(l,c,!0)).next(h=>{s?.incrementDocumentReadCount(h.length);let m=gt();for(let f of h){let g=this.nr(B.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(ao(t,g)||r.has(g.key))&&(m=m.insert(g.key,g))}return m})}getAllFromCollectionGroup(e,t,n,r){let s=gt(),o=zf(t,n),l=zf(t,kt.max());return fi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,h,m)=>{let f=this.nr(B.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(f.key,f),s.size===r&&m.done()}).next(()=>s)}newChangeBuffer(e){return new Gu(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Lf(e).get("remoteDocumentGlobalKey").next(t=>(j(!!t),t))}tr(e,t){return Lf(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){let n=gv(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual($.min())))return n}return ze.newInvalidDocument(e)}};function s_(i){return new Uu(i)}var Gu=class extends Ka{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new en(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){let t=[],n=0,r=new ge((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let l=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,l.readTime)),o.isValidDocument()){let c=Cf(this.ar.serializer,o);r=r.add(s.path.popLast());let h=ja(c);n+=h-l.size,t.push(this.ar.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){let c=Cf(this.ar.serializer,o.convertToNoDocument($.min()));t.push(this.ar.addEntry(e,s,c))}}),r.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,n)),A.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(n=>(this.ur.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:n,_r:r})=>(r.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:n.get(s).readTime})}),n))}};function Lf(i){return $e(i,"remoteDocumentGlobal")}function fi(i){return $e(i,"remoteDocumentsV14")}function Ss(i){let e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function zf(i,e){let t=e.documentKey.path.toArray();return[i,Ba(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Bf(i,e){let t=i.path.toArray(),n=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=ee(t[s],n[s]),r)return r;return r=ee(t.length,n.length),r||(r=ee(t[t.length-2],n[n.length-2]),r||ee(t[t.length-1],n[n.length-1]))}var ju=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ha=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(n!==null&&Vs(n.mutation,r,It.empty(),Ce.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,te()).next(()=>n))}getLocalViewOfDocuments(e,t,n=te()){let r=Qt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let o=Ps();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let n=Qt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,te()))}populateOverlays(e,t,n){let r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,r){let s=gt(),o=ks(),l=function(){return ks()}();return t.forEach((c,h)=>{let m=n.get(h.key);r.has(h.key)&&(m===void 0||m.mutation instanceof Bt)?s=s.insert(h.key,h):m!==void 0?(o.set(h.key,m.mutation.getFieldMask()),Vs(m.mutation,h,m.mutation.getFieldMask(),Ce.now())):o.set(h.key,It.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,m)=>o.set(h,m)),t.forEach((h,m)=>{var f;return l.set(h,new ju(m,(f=o.get(h))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,t){let n=ks(),r=new Ie((o,l)=>o-l),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let l of o)l.keys().forEach(c=>{let h=t.get(c);if(h===null)return;let m=n.get(c)||It.empty();m=l.applyToLocalView(h,m),n.set(c,m);let f=(r.get(l.batchId)||te()).add(c);r=r.insert(l.batchId,f)})}).next(()=>{let o=[],l=r.getReverseIterator();for(;l.hasNext();){let c=l.getNext(),h=c.key,m=c.value,f=xg();m.forEach(g=>{if(!s.has(g)){let b=Ng(t.get(g),n.get(g));b!==null&&f.set(g,b),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,f))}return A.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,r){return function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Wh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):A.resolve(Qt()),l=-1,c=s;return o.next(h=>A.forEach(h,(m,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(m)?A.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{c=c.insert(m,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,te())).next(m=>({batchId:l,changes:Sg(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(n=>{let r=Ps();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let s=t.collectionGroup,o=Ps();return this.indexManager.getCollectionParents(e,s).next(l=>A.forEach(l,c=>{let h=function(f,g){return new zt(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,r).next(m=>{m.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(o=>{s.forEach((c,h)=>{let m=h.getKey();o.get(m)===null&&(o=o.insert(m,ze.newInvalidDocument(m)))});let l=Ps();return o.forEach((c,h)=>{let m=s.get(c);m!==void 0&&Vs(m.mutation,h,It.empty(),Ce.now()),ao(t,h)&&(l=l.insert(c,h))}),l})}};var $u=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return A.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Oe(r.createTime)}}(t)),A.resolve()}getNamedQuery(e,t){return A.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(r){return{name:r.name,query:Jh(r.bundledQuery),readTime:Oe(r.readTime)}}(t)),A.resolve()}};var Ku=class{constructor(){this.overlays=new Ie(B.comparator),this.hr=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){let n=Qt();return A.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.ht(e,t,s)}),A.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.hr.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(n)),A.resolve()}getOverlaysForCollection(e,t,n){let r=Qt(),s=t.length+1,o=new B(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){let c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>n&&r.set(c.getKey(),c)}return A.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Ie((h,m)=>h-m),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let m=s.get(h.largestBatchId);m===null&&(m=Qt(),s=s.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}let l=Qt(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,m)=>l.set(h,m)),!(l.size()>=r)););return A.resolve(l)}ht(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let o=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new js(t,n));let s=this.hr.get(t);s===void 0&&(s=te(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}};var Ys=class{constructor(){this.Pr=new ge(Ne.Ir),this.Tr=new ge(Ne.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let n=new Ne(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Ar(new Ne(e,t))}Rr(e,t){e.forEach(n=>this.removeReference(n,t))}Vr(e){let t=new B(new ae([])),n=new Ne(t,e),r=new Ne(t,e+1),s=[];return this.Tr.forEachInRange([n,r],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new B(new ae([])),n=new Ne(t,e),r=new Ne(t,e+1),s=te();return this.Tr.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ne(e,0),n=this.Pr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Ne=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return B.comparator(e.key,t.key)||ee(e.pr,t.pr)}static Er(e,t){return ee(e.pr,t.pr)||B.comparator(e.key,t.key)}};var Hu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new ge(Ne.Ir)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Gs(s,t,n,r);this.mutationQueue.push(o);for(let l of r)this.wr=this.wr.add(new Ne(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return A.resolve(o)}lookupMutationBatch(e,t){return A.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.br(n),s=r<0?0:r;return A.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Ne(t,0),r=new Ne(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,r],o=>{let l=this.Sr(o.pr);s.push(l)}),A.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ge(ee);return t.forEach(r=>{let s=new Ne(r,0),o=new Ne(r,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],l=>{n=n.add(l.pr)})}),A.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,s=n;B.isDocumentKey(s)||(s=s.child(""));let o=new Ne(new B(s),0),l=new ge(ee);return this.wr.forEachWhile(c=>{let h=c.key.path;return!!n.isPrefixOf(h)&&(h.length===r&&(l=l.add(c.pr)),!0)},o),A.resolve(this.Dr(l))}Dr(e){let t=[];return e.forEach(n=>{let r=this.Sr(n);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){j(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.wr;return A.forEach(t.mutations,r=>{let s=new Ne(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.wr=n})}Mn(e){}containsKey(e,t){let n=new Ne(t,0),r=this.wr.firstAfterOrEqual(n);return A.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Qu=class{constructor(e){this.vr=e,this.docs=function(){return new Ie(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),s=r?r.size:0,o=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return A.resolve(n?n.document.mutableCopy():ze.newInvalidDocument(t))}getEntries(e,t){let n=gt();return t.forEach(r=>{let s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ze.newInvalidDocument(r))}),A.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=gt(),o=t.path,l=new B(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){let{key:h,value:{document:m}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||$h(rg(m),n)<=0||(r.has(m.key)||ao(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return A.resolve(s)}getAllFromCollectionGroup(e,t,n,r){G()}Fr(e,t){return A.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Wu(this)}getSize(e){return A.resolve(this.size)}},Wu=class extends Ka{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)}),A.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var Yu=class{constructor(e){this.persistence=e,this.Mr=new en(t=>Ai(t),so),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ys,this.targetCount=0,this.Lr=Ar.Nn()}forEachTarget(e,t){return this.Mr.forEach((n,r)=>t(r)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),A.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ar(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.qn(t),A.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,n){let r=0,s=[];return this.Mr.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),A.waitFor(s).next(()=>r)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){let n=this.Mr.get(t)||null;return A.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),A.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),A.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),A.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Nr.gr(t);return A.resolve(n)}containsKey(e,t){return A.resolve(this.Nr.containsKey(t))}};var Qa=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new wt(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Yu(this),this.indexManager=new Mu,this.remoteDocumentCache=function(r){return new Qu(r)}(n=>this.referenceDelegate.Kr(n)),this.serializer=new za(t),this.$r=new $u(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ku,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new Hu(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){k("MemoryPersistence","Starting transaction:",e);let r=new Xu(this.kr.next());return this.referenceDelegate.Ur(),n(r).next(s=>this.referenceDelegate.Wr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gr(e,t){return A.or(Object.values(this.Br).map(n=>()=>n.containsKey(e,t)))}},Xu=class extends Sa{constructor(e){super(),this.currentSequenceNumber=e}},Wa=class i{constructor(e){this.persistence=e,this.zr=new Ys,this.jr=null}static Hr(e){return new i(e)}get Jr(){if(this.jr)return this.jr;throw G()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),A.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),A.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(r=>this.Jr.add(r.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Jr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Jr,n=>{let r=B.fromPath(n);return this.Yr(e,r).next(s=>{s||t.removeEntry(r,$.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(n=>{n?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return A.or([()=>A.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var Ju=class{constructor(e){this.serializer=e}O(e,t,n,r){let s=new xa("createOrUpgrade",t);n<1&&r>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nf,{unique:!0}),c.createObjectStore("documentMutations")}(e),qf(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=A.resolve();return n<3&&r>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),qf(e)),o=o.next(()=>function(c){let h=c.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:$.min().toTimestamp(),targetCount:0};return h.put("targetGlobalKey",m)}(s))),n<4&&r>=4&&(n!==0&&(o=o.next(()=>function(c,h){return h.store("mutations").U().next(m=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nf,{unique:!0});let f=h.store("mutations"),g=m.map(b=>f.put(b));return A.waitFor(g)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&r>=5&&(o=o.next(()=>this.Xr(s))),n<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),n<7&&r>=7&&(o=o.next(()=>this.ti(s))),n<8&&r>=8&&(o=o.next(()=>this.ni(e,s))),n<9&&r>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&r>=10&&(o=o.next(()=>this.ri(s))),n<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(o=o.next(()=>{(function(c){let h=c.createObjectStore("documentOverlays",{keyPath:F1});h.createIndex("collectionPathOverlayIndex",L1,{unique:!1}),h.createIndex("collectionGroupOverlayIndex",z1,{unique:!1})})(e)})),n<13&&r>=13&&(o=o.next(()=>function(c){let h=c.createObjectStore("remoteDocumentsV14",{keyPath:A1});h.createIndex("documentKeyIndex",S1),h.createIndex("collectionGroupIndex",x1)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(o=o.next(()=>this.si(e,s))),n<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:V1}).createIndex("sequenceNumberIndex",O1,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:M1}).createIndex("documentKeyIndex",N1,{unique:!1})}(e))),n<16&&r>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((n,r)=>{t+=ja(r)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Xr(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(r=>A.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>A.forEach(l,c=>{j(c.userId===s.userId);let h=yi(this.serializer,c);return n_(e,s.userId,h).next(()=>{})}))}))}ti(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{let s=[];return n.J((o,l)=>{let c=new ae(o),h=function(f){return[0,st(f)]}(c);s.push(t.get(h).next(m=>m?A.resolve():(f=>t.put({targetId:0,path:st(f),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>A.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:k1});let n=t.store("collectionParents"),r=new Ws,s=o=>{if(r.add(o)){let l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:st(c)})}};return t.store("remoteDocuments").J({H:!0},(o,l)=>{let c=new ae(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,l,c],h)=>{let m=Ht(l);return s(m.popLast())}))}ri(e){let t=e.store("targets");return t.J((n,r)=>{let s=Rs(r),o=Zg(this.serializer,s);return t.put(o)})}ii(e,t){let n=t.store("remoteDocuments"),r=[];return n.J((s,o)=>{let l=t.store("remoteDocumentsV14"),c=function(f){return f.document?new B(ae.fromString(f.document.name).popFirst(5)):f.noDocument?B.fromSegments(f.noDocument.path):f.unknownDocument?B.fromSegments(f.unknownDocument.path):G()}(o).path.toArray(),h={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(h))}).next(()=>A.waitFor(r))}si(e,t){let n=t.store("mutations"),r=s_(this.serializer),s=new Qa(Wa.Hr,this.serializer.ct);return n.U().next(o=>{let l=new Map;return o.forEach(c=>{var h;let m=(h=l.get(c.userId))!==null&&h!==void 0?h:te();yi(this.serializer,c).keys().forEach(f=>m=m.add(f)),l.set(c.userId,m)}),A.forEach(l,(c,h)=>{let m=new Fe(h),f=qa.lt(this.serializer,m),g=s.getIndexManager(m),b=$a.lt(m,this.serializer,g,s.referenceDelegate);return new Ha(r,b,f,g).recalculateAndSaveOverlaysForDocumentKeys(new Ls(t,wt.oe),c).next()})})}};function qf(i){i.createObjectStore("targetDocuments",{keyPath:R1}).createIndex("documentTargetsIndex",D1,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",P1,{unique:!0}),i.createObjectStore("targetGlobal")}var Gc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Zu=class i{constructor(e,t,n,r,s,o,l,c,h,m,f=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=s,this.window=o,this.document=l,this._i=h,this.ai=m,this.ui=f,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=g=>Promise.resolve(),!i.D())throw new D(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qu(this,r),this.Ti=t+"main",this.serializer=new za(c),this.Ei=new Gn(this.Ti,this.ui,new Ju(this.serializer)),this.Qr=new Fu(this.referenceDelegate,this.serializer),this.remoteDocumentCache=s_(this.serializer),this.$r=new xu,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,m===!1&&ke("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(x.FAILED_PRECONDITION,Gc);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new wt(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=t=>P(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(t=>P(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>P(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ga(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Zn(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return xs(e).get("owner").next(t=>A.resolve(this.Si(t)))}bi(e){return ga(e).delete(this.clientId)}Di(){return P(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=$e(t,"clientMetadata");return n.U().next(r=>{let s=this.vi(r,18e5),o=r.filter(l=>s.indexOf(l)===-1);return A.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let t of e)this.di.removeItem(this.Fi(t.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?A.resolve(!0):xs(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new D(x.FAILED_PRECONDITION,Gc);return!1}}return!(!this.networkEnabled||!this.inForeground)||ga(e).U().next(n=>this.vi(n,5e3).find(r=>{if(this.clientId!==r.clientId){let s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return P(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Ls(e,wt.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()})}vi(e,t){return e.filter(n=>this.Ci(n.updateTimeMs,t)&&!this.Mi(n.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>ga(e).U().next(t=>this.vi(t,18e5).map(n=>n.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return $a.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Nu(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return qa.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){k("IndexedDbPersistence","Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=function(c){return c===16?q1:c===15?dg:c===14?hg:c===13?ug:c===12?B1:c===11?cg:void G()}(this.ui),o;return this.Ei.runTransaction(e,r,s,l=>(o=new Ls(l,this.kr?this.kr.next():wt.oe),t==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new D(x.FAILED_PRECONDITION,sg);return n(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}ki(e){return xs(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new D(x.FAILED_PRECONDITION,Gc)})}wi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return xs(e).put("owner",t)}static D(){return Gn.D()}yi(e){let t=xs(e);return t.get("owner").next(n=>this.Si(n)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):A.resolve())}Ci(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(ke(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;yc()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{let n=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return ke("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){ke("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function xs(i){return $e(i,"owner")}function ga(i){return $e(i,"clientMetadata")}function ed(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}var eh=class i{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=te(),r=te();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new i(e,t.fromCache,n,r)}};var th=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ya=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return yc()?8:og(ys())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){let s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,r,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new th;return this.Ji(e,t,o).next(l=>{if(s.result=l,this.Ui)return this.Yi(e,t,o,l.size)})}).next(()=>s.result)}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(cr()<=Kt.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",ur(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),A.resolve()):(cr()<=Kt.DEBUG&&k("QueryEngine","Query:",ur(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(cr()<=Kt.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",ur(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ot(t))):A.resolve())}ji(e,t){if(pf(t))return A.resolve(null);let n=ot(t);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Ma(t,null,"F"),n=ot(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{let h=this.Zi(t,l);return this.Xi(t,h,o,c.readTime)?this.ji(e,Ma(t,null,"F")):this.es(e,h,t,c)}))})))}Hi(e,t,n,r){return pf(t)||r.isEqual($.min())?A.resolve(null):this.zi.getDocuments(e,n).next(s=>{let o=this.Zi(t,s);return this.Xi(t,o,n,r)?A.resolve(null):(cr()<=Kt.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ur(t)),this.es(e,o,t,ig(r,-1)).next(l=>l))})}Zi(e,t){let n=new ge(Cg(e));return t.forEach((r,s)=>{ao(e,s)&&(n=n.add(s))}),n}Xi(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ji(e,t,n){return cr()<=Kt.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",ur(t)),this.zi.getDocumentsMatchingQuery(e,t,kt.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var nh=class{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new Ie(ee),this.rs=new en(s=>Ai(s),so),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ha(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function o_(i,e,t,n){return new nh(i,e,t,n)}function a_(i,e){return P(this,null,function*(){let t=q(i);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t._s(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{let o=[],l=[],c=te();for(let h of r){o.push(h.batchId);for(let m of h.mutations)c=c.add(m.key)}for(let h of s){l.push(h.batchId);for(let m of h.mutations)c=c.add(m.key)}return t.localDocuments.getDocuments(n,c).next(h=>({us:h,removedBatchIds:o,addedBatchIds:l}))})})})}function wv(i,e){let t=q(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let r=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(l,c,h,m){let f=h.batch,g=f.keys(),b=A.resolve();return g.forEach(V=>{b=b.next(()=>m.getEntry(c,V)).next(O=>{let R=h.docVersions.get(V);j(R!==null),O.version.compareTo(R)<0&&(f.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),m.addEntry(O)))})}),b.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=te();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function l_(i){let e=q(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function Iv(i,e){let t=q(i),n=e.snapshotVersion,r=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.os.newChangeBuffer({trackRemovals:!0});r=t.ns;let l=[];e.targetChanges.forEach((m,f)=>{let g=r.get(f);if(!g)return;l.push(t.Qr.removeMatchingKeys(s,m.removedDocuments,f).next(()=>t.Qr.addMatchingKeys(s,m.addedDocuments,f)));let b=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?b=b.withResumeToken(je.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):m.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(m.resumeToken,n)),r=r.insert(f,b),function(O,R,K){return O.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0}(g,b,m)&&l.push(t.Qr.updateTargetData(s,b))});let c=gt(),h=te();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(c_(s,o,e.documentUpdates).next(m=>{c=m.cs,h=m.ls})),!n.isEqual($.min())){let m=t.Qr.getLastRemoteSnapshotVersion(s).next(f=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return A.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(t.ns=r,s))}function c_(i,e,t){let n=te(),r=te();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let o=gt();return t.forEach((l,c)=>{let h=s.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(l)),c.isNoDocument()&&c.version.isEqual($.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):k("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{cs:o,ls:r}})}function Tv(i,e){let t=q(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Sr(i,e){let t=q(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Qr.getTargetData(n,e).next(s=>s?(r=s,A.resolve(r)):t.Qr.allocateTargetId(n).next(o=>(r=new Cr(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Qr.addTargetData(n,r).next(()=>r))))}).then(n=>{let r=t.ns.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ns=t.ns.insert(n.targetId,n),t.rs.set(e,n.targetId)),n})}function xr(i,e,t){return P(this,null,function*(){let n=q(i),r=n.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Zn(o))throw o;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.ns=n.ns.remove(e),n.rs.delete(r.target)})}function Xa(i,e,t){let n=q(i),r=$.min(),s=te();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,m){let f=q(c),g=f.rs.get(m);return g!==void 0?A.resolve(f.ns.get(g)):f.Qr.getTargetData(h,m)}(n,o,ot(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ts.getDocumentsMatchingQuery(o,e,t?r:$.min(),t?s:te())).next(l=>(d_(n,bg(e),l),{documents:l,hs:s})))}function u_(i,e){let t=q(i),n=q(t.Qr),r=t.ns.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(o=>o?o.target:null))}function h_(i,e){let t=q(i),n=t.ss.get(e)||$.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.os.getAllFromCollectionGroup(r,e,ig(n,-1),Number.MAX_SAFE_INTEGER)).then(r=>(d_(t,e,r),r))}function d_(i,e,t){let n=i.ss.get(e)||$.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.ss.set(e,n)}function Ev(i,e,t,n){return P(this,null,function*(){let r=q(i),s=te(),o=gt();for(let h of t){let m=e.Ps(h.metadata.name);h.document&&(s=s.add(m));let f=e.Is(h);f.setReadTime(e.Ts(h.metadata.readTime)),o=o.insert(m,f)}let l=r.os.newChangeBuffer({trackRemovals:!0}),c=yield Sr(r,function(m){return ot(Nr(ae.fromString(`__bundle__/docs/${m}`)))}(n));return r.persistence.runTransaction("Apply bundle documents","readwrite",h=>c_(h,l,o).next(m=>(l.apply(h),m)).next(m=>r.Qr.removeMatchingKeysForTargetId(h,c.targetId).next(()=>r.Qr.addMatchingKeys(h,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(h,m.cs,m.ls)).next(()=>m.cs)))})}function bv(n,r){return P(this,arguments,function*(i,e,t=te()){let s=yield Sr(i,ot(Jh(e.bundledQuery))),o=q(i);return o.persistence.runTransaction("Save named query","readwrite",l=>{let c=Oe(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(l,e);let h=s.withResumeToken(je.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(h.targetId,h),o.Qr.updateTargetData(l,h).next(()=>o.Qr.removeMatchingKeysForTargetId(l,s.targetId)).next(()=>o.Qr.addMatchingKeys(l,t,s.targetId)).next(()=>o.$r.saveNamedQuery(l,e))})})}function Uf(i,e){return`firestore_clients_${i}_${e}`}function Gf(i,e,t){let n=`firestore_mutations_${i}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function jc(i,e){return`firestore_targets_${i}_${e}`}var Ja=class i{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){let r=JSON.parse(n),s,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new D(r.error.code,r.error.message))),o?new i(e,t,r.state,s):(ke("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Os=class i{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){let n=JSON.parse(t),r,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(r=new D(n.error.code,n.error.message))),s?new i(e,n.state,r):(ke("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Za=class i{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){let n=JSON.parse(t),r=typeof n=="object"&&n.activeTargetIds instanceof Array,s=Yh();for(let o=0;r&&o<n.activeTargetIds.length;++o)r=ag(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return r?new i(e,s):(ke("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},ih=class i{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new i(t.clientId,t.onlineState):(ke("SharedClientState",`Failed to parse online state: ${e}`),null)}},Xs=class{constructor(){this.activeTargetIds=Yh()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ms=class{constructor(e,t,n,r,s){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ie(ee),this.started=!1,this.ys=[];let o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Uf(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Xs),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return P(this,null,function*(){let e=yield this.syncEngine.Bi();for(let n of e){if(n===this.Vs)continue;let r=this.getItem(Uf(this.persistenceKey,n));if(r){let s=Za.Es(n,r);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let t=this.storage.getItem(this.vs);if(t){let n=this.xs(t);n&&this.Os(n)}for(let n of this.ys)this.gs(n);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem(jc(this.persistenceKey,e));if(n){let r=Os.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(jc(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach(r=>{this.Bs(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>P(this,null,function*(){if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){let n=this.$s(t.key);return this.Us(n,null)}{let n=this.Ws(t.key,t.newValue);if(n)return this.Us(n.clientId,n)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){let n=this.Gs(t.key,t.newValue);if(n)return this.zs(n)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){let n=this.js(t.key,t.newValue);if(n)return this.Hs(n)}}else if(t.key===this.vs){if(t.newValue!==null){let n=this.xs(t.newValue);if(n)return this.Os(n)}}else if(t.key===this.Ss){let n=function(s){let o=wt.oe;if(s!=null)try{let l=JSON.parse(s);j(typeof l=="number"),o=l}catch(l){ke("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(t.newValue);n!==wt.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Fs){let n=this.Js(t.newValue);yield Promise.all(n.map(r=>this.syncEngine.Ys(r)))}}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){let r=new Ja(this.currentUser,e,t,n),s=Gf(this.persistenceKey,this.currentUser,e);this.setItem(s,r.ds())}Bs(e){let t=Gf(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){let t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){let r=jc(this.persistenceKey,e),s=new Os(e,t,n);this.setItem(r,s.ds())}Ks(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){let t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){let n=this.$s(e);return Za.Es(n,t)}Gs(e,t){let n=this.Ds.exec(e),r=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Ja.Es(new Fe(s),r,t)}js(e,t){let n=this.Cs.exec(e),r=Number(n[1]);return Os.Es(r,t)}xs(e){return ih.Es(e)}Js(e){return JSON.parse(e)}zs(e){return P(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){let n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),s=this.Ns(n),o=[],l=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||l.push(c)}),this.syncEngine.eo(o,l).then(()=>{this.ps=n})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Yh();return e.forEach((n,r)=>{t=t.unionWith(r.activeTargetIds)}),t}},el=class{constructor(){this.no=new Xs,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Xs,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var rh=class{io(e){}shutdown(){}};var tl=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var _a=null;function $c(){return _a===null?_a=function(){return 268435456+Math.round(2147483648*Math.random())}():_a++,"0x"+_a.toString(16)}var Cv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var sh=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var et="WebChannelConnection",oh=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let n=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=n+"://"+t.host,this.So=`projects/${r}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Do(){return!1}Co(t,n,r,s,o){let l=$c(),c=this.vo(t,n.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${l}:`,c,r);let h={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(h,s,o),this.Mo(t,c,h,r).then(m=>(k("RestConnection",`Received RPC '${t}' ${l}: `,m),m),m=>{throw Dt("RestConnection",`RPC '${t}' ${l} failed with error: `,m,"url: ",c,"request:",r),m})}xo(t,n,r,s,o,l){return this.Co(t,n,r,s,o)}Fo(t,n,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Mr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}vo(t,n){let r=Cv[t];return`${this.wo}/v1/${n}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,n,r){let s=$c();return new Promise((o,l)=>{let c=new Nc;c.setWithCredentials(!0),c.listenOnce(Lc.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case bs.NO_ERROR:let m=c.getResponseJson();k(et,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),o(m);break;case bs.TIMEOUT:k(et,`RPC '${e}' ${s} timed out`),l(new D(x.DEADLINE_EXCEEDED,"Request time out"));break;case bs.HTTP_ERROR:let f=c.getStatus();if(k(et,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let b=g?.error;if(b&&b.status&&b.message){let V=function(R){let K=R.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(K)>=0?K:x.UNKNOWN}(b.status);l(new D(V,b.message))}else l(new D(x.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new D(x.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{k(et,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(r);k(et,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",h,n,15)})}Oo(e,t,n){let r=$c(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=qc(),l=Bc(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.xmlHttpFactory=new Fc({})),this.Fo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;let m=s.join("");k(et,`Creating RPC '${e}' stream ${r}: ${m}`,c);let f=o.createWebChannel(m,c),g=!1,b=!1,V=new sh({lo:R=>{b?k(et,`Not sending because RPC '${e}' stream ${r} is closed:`,R):(g||(k(et,`Opening RPC '${e}' stream ${r} transport.`),f.open(),g=!0),k(et,`RPC '${e}' stream ${r} sending:`,R),f.send(R))},ho:()=>f.close()}),O=(R,K,Q)=>{R.listen(K,z=>{try{Q(z)}catch(W){setTimeout(()=>{throw W},0)}})};return O(f,rr.EventType.OPEN,()=>{b||(k(et,`RPC '${e}' stream ${r} transport opened.`),V.mo())}),O(f,rr.EventType.CLOSE,()=>{b||(b=!0,k(et,`RPC '${e}' stream ${r} transport closed`),V.po())}),O(f,rr.EventType.ERROR,R=>{b||(b=!0,Dt(et,`RPC '${e}' stream ${r} transport errored:`,R),V.po(new D(x.UNAVAILABLE,"The operation could not be completed")))}),O(f,rr.EventType.MESSAGE,R=>{var K;if(!b){let Q=R.data[0];j(!!Q);let z=Q,W=z.error||((K=z[0])===null||K===void 0?void 0:K.error);if(W){k(et,`RPC '${e}' stream ${r} received error:`,W);let J=W.status,Z=function(v){let I=Me[v];if(I!==void 0)return zg(I)}(J),w=W.message;Z===void 0&&(Z=x.INTERNAL,w="Unknown error status: "+J+" with message "+W.message),b=!0,V.po(new D(Z,w)),f.close()}else k(et,`RPC '${e}' stream ${r} received:`,Q),V.yo(Q)}}),O(l,zc.STAT_EVENT,R=>{R.stat===ma.PROXY?k(et,`RPC '${e}' stream ${r} detected buffering proxy`):R.stat===ma.NOPROXY&&k(et,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{V.fo()},0),V}};function m_(){return typeof window<"u"?window:null}function Ta(){return typeof document<"u"?document:null}function lo(i){return new Eu(i,!0)}var Js=class{constructor(e,t,n=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=n,this.Lo=r,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),r=Math.max(0,t-n);r>0&&k("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var nl=class{constructor(e,t,n,r,s,o,l,c){this.oi=e,this.Go=n,this.zo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Js(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return P(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return P(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return P(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(ke(t.toString()),ke("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.jo===t&&this.u_(n,r)},n=>{e(()=>{let r=new D(x.UNKNOWN,"Fetching auth token failed: "+n.message);return this.c_(r)})})}u_(e,t){let n=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{n(()=>this.listener.Po())}),this.stream.To(()=>{n(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(r=>{n(()=>this.c_(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}e_(){this.state=5,this.Yo.$o(()=>P(this,null,function*(){this.state=0,this.start()}))}c_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ah=class extends nl{constructor(e,t,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=cv(this.serializer,e),n=function(s){if(!("targetChange"in s))return $.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?$.min():o.readTime?Oe(o.readTime):$.min()}(e);return this.listener.h_(t,n)}P_(e){let t={};t.database=Au(this.serializer),t.addTarget=function(s,o){let l,c=o.target;if(l=Va(c)?{documents:Hg(s,c)}:{query:Qg(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=qg(s,o.resumeToken);let h=bu(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo($.min())>0){l.readTime=br(s,o.snapshotVersion.toTimestamp());let h=bu(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);let n=hv(this.serializer,e);n&&(t.labels=n),this.i_(t)}I_(e){let t={};t.database=Au(this.serializer),t.removeTarget=e,this.i_(t)}},lh=class extends nl{constructor(e,t,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=uv(e.writeResults,e.commitTime),n=Oe(e.commitTime);return this.listener.A_(n,t)}return j(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=Au(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>Qs(this.serializer,n))};this.i_(t)}};var ch=class extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.m_=!1}f_(){if(this.m_)throw new D(x.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,n,r){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,Cu(t,n),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(x.UNKNOWN,s.toString())})}xo(e,t,n,r,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.xo(e,Cu(t,n),r,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(x.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},uh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(ke(t),this.y_=!1):k("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var hh=class{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{n.enqueueAndForget(()=>P(this,null,function*(){ei(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return P(this,null,function*(){let h=q(c);h.M_.add(4),yield Fr(h),h.N_.set("Unknown"),h.M_.delete(4),yield co(h)})}(this))}))}),this.N_=new uh(n,r)}};function co(i){return P(this,null,function*(){if(ei(i))for(let e of i.x_)yield e(!0)})}function Fr(i){return P(this,null,function*(){for(let e of i.x_)yield e(!1)})}function Il(i,e){let t=q(i);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),id(t)?nd(t):zr(t).Xo()&&td(t,e))}function Pr(i,e){let t=q(i),n=zr(t);t.F_.delete(e),n.Xo()&&p_(t,e),t.F_.size===0&&(n.Xo()?n.n_():ei(t)&&t.N_.set("Unknown"))}function td(i,e){if(i.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){let t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zr(i).P_(e)}function p_(i,e){i.L_.xe(e),zr(i).I_(e)}function nd(i){i.L_=new Tu({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>i.F_.get(e)||null,tt:()=>i.datastore.serializer.databaseId}),zr(i).start(),i.N_.w_()}function id(i){return ei(i)&&!zr(i).Zo()&&i.F_.size>0}function ei(i){return q(i).M_.size===0}function f_(i){i.L_=void 0}function Av(i){return P(this,null,function*(){i.N_.set("Online")})}function Sv(i){return P(this,null,function*(){i.F_.forEach((e,t)=>{td(i,e)})})}function xv(i,e){return P(this,null,function*(){f_(i),id(i)?(i.N_.D_(e),nd(i)):i.N_.set("Unknown")})}function Pv(i,e,t){return P(this,null,function*(){if(i.N_.set("Online"),e instanceof Fa&&e.state===2&&e.cause)try{yield function(r,s){return P(this,null,function*(){let o=s.cause;for(let l of s.targetIds)r.F_.has(l)&&(yield r.remoteSyncer.rejectListen(l,o),r.F_.delete(l),r.L_.removeTarget(l))})}(i,e)}catch(n){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield il(i,n)}else if(e instanceof _r?i.L_.Ke(e):e instanceof Na?i.L_.He(e):i.L_.We(e),!t.isEqual($.min()))try{let n=yield l_(i.localStore);t.compareTo(n)>=0&&(yield function(s,o){let l=s.L_.rt(o);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){let m=s.F_.get(h);m&&s.F_.set(h,m.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,h)=>{let m=s.F_.get(c);if(!m)return;s.F_.set(c,m.withResumeToken(je.EMPTY_BYTE_STRING,m.snapshotVersion)),p_(s,c);let f=new Cr(m.target,c,h,m.sequenceNumber);td(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(i,t))}catch(n){k("RemoteStore","Failed to raise snapshot:",n),yield il(i,n)}})}function il(i,e,t){return P(this,null,function*(){if(!Zn(e))throw e;i.M_.add(1),yield Fr(i),i.N_.set("Offline"),t||(t=()=>l_(i.localStore)),i.asyncQueue.enqueueRetryable(()=>P(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),i.M_.delete(1),yield co(i)}))})}function g_(i,e){return e().catch(t=>il(i,t,e))}function Lr(i){return P(this,null,function*(){let e=q(i),t=Xn(e),n=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;Rv(e);)try{let r=yield Tv(e.localStore,n);if(r===null){e.v_.length===0&&t.n_();break}n=r.batchId,Dv(e,r)}catch(r){yield il(e,r)}__(e)&&y_(e)})}function Rv(i){return ei(i)&&i.v_.length<10}function Dv(i,e){i.v_.push(e);let t=Xn(i);t.Xo()&&t.E_&&t.d_(e.mutations)}function __(i){return ei(i)&&!Xn(i).Zo()&&i.v_.length>0}function y_(i){Xn(i).start()}function kv(i){return P(this,null,function*(){Xn(i).V_()})}function Vv(i){return P(this,null,function*(){let e=Xn(i);for(let t of i.v_)e.d_(t.mutations)})}function Ov(i,e,t){return P(this,null,function*(){let n=i.v_.shift(),r=vu.from(n,e,t);yield g_(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),yield Lr(i)})}function Mv(i,e){return P(this,null,function*(){e&&Xn(i).E_&&(yield function(n,r){return P(this,null,function*(){if(function(o){return Lg(o)&&o!==x.ABORTED}(r.code)){let s=n.v_.shift();Xn(n).t_(),yield g_(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield Lr(n)}})}(i,e)),__(i)&&y_(i)})}function jf(i,e){return P(this,null,function*(){let t=q(i);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let n=ei(t);t.M_.add(3),yield Fr(t),n&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield co(t)})}function dh(i,e){return P(this,null,function*(){let t=q(i);e?(t.M_.delete(2),yield co(t)):e||(t.M_.add(2),yield Fr(t),t.N_.set("Unknown"))})}function zr(i){return i.B_||(i.B_=function(t,n,r){let s=q(t);return s.f_(),new ah(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{Po:Av.bind(null,i),To:Sv.bind(null,i),Ao:xv.bind(null,i),h_:Pv.bind(null,i)}),i.x_.push(e=>P(this,null,function*(){e?(i.B_.t_(),id(i)?nd(i):i.N_.set("Unknown")):(yield i.B_.stop(),f_(i))}))),i.B_}function Xn(i){return i.k_||(i.k_=function(t,n,r){let s=q(t);return s.f_(),new lh(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(i.datastore,i.asyncQueue,{Po:()=>Promise.resolve(),To:kv.bind(null,i),Ao:Mv.bind(null,i),R_:Vv.bind(null,i),A_:Ov.bind(null,i)}),i.x_.push(e=>P(this,null,function*(){e?(i.k_.t_(),yield Lr(i)):(yield i.k_.stop(),i.v_.length>0&&(k("RemoteStore",`Stopping write stream with ${i.v_.length} pending writes`),i.v_=[]))}))),i.k_}var mh=class i{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Le,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){let o=Date.now()+n,l=new i(e,t,o,r,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Br(i,e){if(ke("AsyncQueue",`${e}: ${i}`),Zn(i))return new D(x.UNAVAILABLE,`${e}: ${i}`);throw i}var rl=class i{constructor(e){this.comparator=e?(t,n)=>e(t,n)||B.comparator(t.key,n.key):(t,n)=>B.comparator(t.key,n.key),this.keyedMap=Ps(),this.sortedSet=new Ie(this.comparator)}static emptySet(e){return new i(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof i)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new i;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var sl=class{constructor(){this.q_=new Ie(B.comparator)}track(e){let t=e.doc.key,n=this.q_.get(t);n?e.type!==0&&n.type===3?this.q_=this.q_.insert(t,e):e.type===3&&n.type!==1?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.q_=this.q_.remove(t):e.type===1&&n.type===2?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):G():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,n)=>{e.push(n)}),e}},Rr=class i{constructor(e,t,n,r,s,o,l,c,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,r,s){let o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new i(e,t,rl.emptySet(t),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}};var ph=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},fh=class{constructor(){this.queries=new en(e=>Eg(e),oo),this.onlineState="Unknown",this.z_=new Set}};function rd(i,e){return P(this,null,function*(){let t=q(i),n=3,r=e.query,s=t.queries.get(r);s?!s.W_()&&e.G_()&&(n=2):(s=new ph,n=e.G_()?0:1);try{switch(n){case 0:s.K_=yield t.onListen(r,!0);break;case 1:s.K_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){let l=Br(o,`Initialization of query '${ur(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&od(t)})}function sd(i,e){return P(this,null,function*(){let t=q(i),n=e.query,r=3,s=t.queries.get(n);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?r=e.G_()?0:1:!s.W_()&&e.G_()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})}function Nv(i,e){let t=q(i),n=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let l of o.U_)l.H_(r)&&(n=!0);o.K_=r}}n&&od(t)}function Fv(i,e,t){let n=q(i),r=n.queries.get(e);if(r)for(let s of r.U_)s.onError(t);n.queries.delete(e)}function od(i){i.z_.forEach(e=>{e.next()})}var gh,$f;($f=gh||(gh={})).J_="default",$f.Cache="cache";var Zs=class{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){let n=[];for(let r of e.docChanges)r.type!==3&&n.push(r);e=new Rr(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let n=t!=="Offline";return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Rr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==gh.Cache}};var _h=class{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}};var ol=class{constructor(e){this.serializer=e}Ps(e){return Yt(this.serializer,e)}Is(e){return e.metadata.exists?Kg(this.serializer,e.document,!1):ze.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Oe(e)}},yh=class{constructor(e,t,n){this.oa=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=v_(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;let n=ae.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){let t=new Map,n=new ol(this.serializer);for(let r of e)if(r.metadata.queries){let s=n.Ps(r.metadata.name);for(let o of r.metadata.queries){let l=(t.get(o)||te()).add(s);t.set(o,l)}}return t}complete(){return P(this,null,function*(){let e=yield Ev(this.localStore,new ol(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(let n of this.queries)yield bv(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function v_(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}var al=class{constructor(e){this.key=e}},ll=class{constructor(e){this.key=e}},cl=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=te(),this.mutatedKeys=te(),this.Ia=Cg(e),this.Ta=new rl(this.Ia)}get Ea(){return this.la}da(e,t){let n=t?t.Aa:new sl,r=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((m,f)=>{let g=r.get(m),b=ao(this.query,f)?f:null,V=!!g&&this.mutatedKeys.has(g.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),R=!1;g&&b?g.data.isEqual(b.data)?V!==O&&(n.track({type:3,doc:b}),R=!0):this.Ra(g,b)||(n.track({type:2,doc:b}),R=!0,(c&&this.Ia(b,c)>0||h&&this.Ia(b,h)<0)&&(l=!0)):!g&&b?(n.track({type:0,doc:b}),R=!0):g&&!b&&(n.track({type:1,doc:g}),R=!0,(c||h)&&(l=!0)),R&&(b?(o=o.add(b),s=O?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{Ta:o,Aa:n,Xi:l,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((m,f)=>function(b,V){let O=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return O(b)-O(V)}(m.type,f.type)||this.Ia(m.doc,f.doc)),this.Va(n),r=r!=null&&r;let l=t&&!r?this.ma():[],c=this.Pa.size===0&&this.current&&!r?1:0,h=c!==this.ha;return this.ha=c,o.length!==0||h?{snapshot:new Rr(this.query,e.Ta,s,o,e.mutatedKeys,c===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:l}:{fa:l}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new sl,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=te(),this.Ta.forEach(n=>{this.ga(n.key)&&(this.Pa=this.Pa.add(n.key))});let t=[];return e.forEach(n=>{this.Pa.has(n)||t.push(new ll(n))}),this.Pa.forEach(n=>{e.has(n)||t.push(new al(n))}),t}pa(e){this.la=e.hs,this.Pa=te();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Rr.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},vh=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},wh=class{constructor(e){this.key=e,this.wa=!1}},Ih=class{constructor(e,t,n,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new en(l=>Eg(l),oo),this.Da=new Map,this.Ca=new Set,this.va=new Ie(B.comparator),this.Fa=new Map,this.Ma=new Ys,this.xa={},this.Oa=new Map,this.Na=Ar.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function Lv(i,e,t=!0){return P(this,null,function*(){let n=Tl(i),r,s=n.ba.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.ya()):r=yield w_(n,e,t,!0),r})}function zv(i,e){return P(this,null,function*(){let t=Tl(i);yield w_(t,e,!0,!1)})}function w_(i,e,t,n){return P(this,null,function*(){let r=yield Sr(i.localStore,ot(e)),s=r.targetId,o=t?i.sharedClientState.addLocalQueryTarget(s):"not-current",l;return n&&(l=yield ad(i,e,s,o==="current",r.resumeToken)),i.isPrimaryClient&&t&&Il(i.remoteStore,r),l})}function ad(i,e,t,n,r){return P(this,null,function*(){i.Ba=(f,g,b)=>function(O,R,K,Q){return P(this,null,function*(){let z=R.view.da(K);z.Xi&&(z=yield Xa(O.localStore,R.query,!1).then(({documents:w})=>R.view.da(w,z)));let W=Q&&Q.targetChanges.get(R.targetId),J=Q&&Q.targetMismatches.get(R.targetId)!=null,Z=R.view.applyChanges(z,O.isPrimaryClient,W,J);return Th(O,R.targetId,Z.fa),Z.snapshot})}(i,f,g,b);let s=yield Xa(i.localStore,e,!0),o=new cl(e,s.hs),l=o.da(s.documents),c=Ks.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),h=o.applyChanges(l,i.isPrimaryClient,c);Th(i,t,h.fa);let m=new vh(e,t,o);return i.ba.set(e,m),i.Da.has(t)?i.Da.get(t).push(e):i.Da.set(t,[e]),h.snapshot})}function Bv(i,e,t){return P(this,null,function*(){let n=q(i),r=n.ba.get(e),s=n.Da.get(r.targetId);if(s.length>1)return n.Da.set(r.targetId,s.filter(o=>!oo(o,e))),void n.ba.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield xr(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Pr(n.remoteStore,r.targetId),Dr(n,r.targetId)}).catch(Jn))):(Dr(n,r.targetId),yield xr(n.localStore,r.targetId,!0))})}function qv(i,e){return P(this,null,function*(){let t=q(i),n=t.ba.get(e),r=t.Da.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Pr(t.remoteStore,n.targetId))})}function Uv(i,e,t){return P(this,null,function*(){let n=hd(i);try{let r=yield function(o,l){let c=q(o),h=Ce.now(),m=l.reduce((b,V)=>b.add(V.key),te()),f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",b=>{let V=gt(),O=te();return c.os.getEntries(b,m).next(R=>{V=R,V.forEach((K,Q)=>{Q.isValidDocument()||(O=O.add(K))})}).next(()=>c.localDocuments.getOverlayedDocuments(b,V)).next(R=>{f=R;let K=[];for(let Q of l){let z=nv(Q,f.get(Q.key).overlayedDocument);z!=null&&K.push(new Bt(Q.key,z,gg(z.value.mapValue),Re.exists(!0)))}return c.mutationQueue.addMutationBatch(b,h,K,l)}).next(R=>{g=R;let K=R.applyToLocalDocumentSet(f,O);return c.documentOverlayCache.saveOverlays(b,R.batchId,K)})}).then(()=>({batchId:g.batchId,changes:Sg(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(o,l,c){let h=o.xa[o.currentUser.toKey()];h||(h=new Ie(ee)),h=h.insert(l,c),o.xa[o.currentUser.toKey()]=h}(n,r.batchId,t),yield wn(n,r.changes),yield Lr(n.remoteStore)}catch(r){let s=Br(r,"Failed to persist write");t.reject(s)}})}function I_(i,e){return P(this,null,function*(){let t=q(i);try{let n=yield Iv(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.Fa.get(s);o&&(j(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.wa=!0:r.modifiedDocuments.size>0?j(o.wa):r.removedDocuments.size>0&&(j(o.wa),o.wa=!1))}),yield wn(t,n,e)}catch(n){yield Jn(n)}})}function Kf(i,e,t){let n=q(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let r=[];n.ba.forEach((s,o)=>{let l=o.view.j_(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){let c=q(o);c.onlineState=l;let h=!1;c.queries.forEach((m,f)=>{for(let g of f.U_)g.j_(l)&&(h=!0)}),h&&od(c)}(n.eventManager,e),r.length&&n.Sa.h_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function Gv(i,e,t){return P(this,null,function*(){let n=q(i);n.sharedClientState.updateQueryState(e,"rejected",t);let r=n.Fa.get(e),s=r&&r.key;if(s){let o=new Ie(B.comparator);o=o.insert(s,ze.newNoDocument(s,$.min()));let l=te().add(s),c=new $s($.min(),new Map,new Ie(ee),o,l);yield I_(n,c),n.va=n.va.remove(s),n.Fa.delete(e),ud(n)}else yield xr(n.localStore,e,!1).then(()=>Dr(n,e,t)).catch(Jn)})}function jv(i,e){return P(this,null,function*(){let t=q(i),n=e.batch.batchId;try{let r=yield wv(t.localStore,e);cd(t,n,null),ld(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield wn(t,r)}catch(r){yield Jn(r)}})}function $v(i,e,t){return P(this,null,function*(){let n=q(i);try{let r=yield function(o,l){let c=q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return c.mutationQueue.lookupMutationBatch(h,l).next(f=>(j(f!==null),m=f.keys(),c.mutationQueue.removeMutationBatch(h,f))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,m,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>c.localDocuments.getDocuments(h,m))})}(n.localStore,e);cd(n,e,t),ld(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield wn(n,r)}catch(r){yield Jn(r)}})}function Kv(i,e){return P(this,null,function*(){let t=q(i);ei(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield function(o){let l=q(o);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>l.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(n===-1)return void e.resolve();let r=t.Oa.get(n)||[];r.push(e),t.Oa.set(n,r)}catch(n){let r=Br(n,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function ld(i,e){(i.Oa.get(e)||[]).forEach(t=>{t.resolve()}),i.Oa.delete(e)}function cd(i,e,t){let n=q(i),r=n.xa[n.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.xa[n.currentUser.toKey()]=r}}function Dr(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(let n of i.Da.get(e))i.ba.delete(n),t&&i.Sa.ka(n,t);i.Da.delete(e),i.isPrimaryClient&&i.Ma.Vr(e).forEach(n=>{i.Ma.containsKey(n)||T_(i,n)})}function T_(i,e){i.Ca.delete(e.path.canonicalString());let t=i.va.get(e);t!==null&&(Pr(i.remoteStore,t),i.va=i.va.remove(e),i.Fa.delete(t),ud(i))}function Th(i,e,t){for(let n of t)n instanceof al?(i.Ma.addReference(n.key,e),Hv(i,n)):n instanceof ll?(k("SyncEngine","Document no longer in limbo: "+n.key),i.Ma.removeReference(n.key,e),i.Ma.containsKey(n.key)||T_(i,n.key)):G()}function Hv(i,e){let t=e.key,n=t.path.canonicalString();i.va.get(t)||i.Ca.has(n)||(k("SyncEngine","New document in limbo: "+t),i.Ca.add(n),ud(i))}function ud(i){for(;i.Ca.size>0&&i.va.size<i.maxConcurrentLimboResolutions;){let e=i.Ca.values().next().value;i.Ca.delete(e);let t=new B(ae.fromString(e)),n=i.Na.next();i.Fa.set(n,new wh(t)),i.va=i.va.insert(t,n),Il(i.remoteStore,new Cr(ot(Nr(t.path)),n,"TargetPurposeLimboResolution",wt.oe))}}function wn(i,e,t){return P(this,null,function*(){let n=q(i),r=[],s=[],o=[];n.ba.isEmpty()||(n.ba.forEach((l,c)=>{o.push(n.Ba(c,e,t).then(h=>{if((h||t)&&n.isPrimaryClient){let m=h&&!h.fromCache;n.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){r.push(h);let m=eh.Ki(c.targetId,h);s.push(m)}}))}),yield Promise.all(o),n.Sa.h_(r),yield function(c,h){return P(this,null,function*(){let m=q(c);try{yield m.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>A.forEach(h,g=>A.forEach(g.qi,b=>m.persistence.referenceDelegate.addReference(f,g.targetId,b)).next(()=>A.forEach(g.Qi,b=>m.persistence.referenceDelegate.removeReference(f,g.targetId,b)))))}catch(f){if(!Zn(f))throw f;k("LocalStore","Failed to update sequence numbers: "+f)}for(let f of h){let g=f.targetId;if(!f.fromCache){let b=m.ns.get(g),V=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(V);m.ns=m.ns.insert(g,O)}}})}(n.localStore,s))})}function Qv(i,e){return P(this,null,function*(){let t=q(i);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let n=yield a_(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(l=>{l.forEach(c=>{c.reject(new D(x.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield wn(t,n.us)}})}function Wv(i,e){let t=q(i),n=t.Fa.get(e);if(n&&n.wa)return te().add(n.key);{let r=te(),s=t.Da.get(e);if(!s)return r;for(let o of s){let l=t.ba.get(o);r=r.unionWith(l.view.Ea)}return r}}function Yv(i,e){return P(this,null,function*(){let t=q(i),n=yield Xa(t.localStore,e.query,!0),r=e.view.pa(n);return t.isPrimaryClient&&Th(t,e.targetId,r.fa),r})}function Xv(i,e){return P(this,null,function*(){let t=q(i);return h_(t.localStore,e).then(n=>wn(t,n))})}function Jv(i,e,t,n){return P(this,null,function*(){let r=q(i),s=yield function(l,c){let h=q(l),m=q(h.mutationQueue);return h.persistence.runTransaction("Lookup mutation documents","readonly",f=>m.vn(f,c).next(g=>g?h.localDocuments.getDocuments(f,g):A.resolve(null)))}(r.localStore,e);s!==null?(t==="pending"?yield Lr(r.remoteStore):t==="acknowledged"||t==="rejected"?(cd(r,e,n||null),ld(r,e),function(l,c){q(q(l).mutationQueue).Mn(c)}(r.localStore,e)):G(),yield wn(r,s)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Zv(i,e){return P(this,null,function*(){let t=q(i);if(Tl(t),hd(t),e===!0&&t.La!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),r=yield Hf(t,n.toArray());t.La=!0,yield dh(t.remoteStore,!0);for(let s of r)Il(t.remoteStore,s)}else if(e===!1&&t.La!==!1){let n=[],r=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):r=r.then(()=>(Dr(t,o),xr(t.localStore,o,!0))),Pr(t.remoteStore,o)}),yield r,yield Hf(t,n),function(o){let l=q(o);l.Fa.forEach((c,h)=>{Pr(l.remoteStore,h)}),l.Ma.mr(),l.Fa=new Map,l.va=new Ie(B.comparator)}(t),t.La=!1,yield dh(t.remoteStore,!1)}})}function Hf(i,e,t){return P(this,null,function*(){let n=q(i),r=[],s=[];for(let o of e){let l,c=n.Da.get(o);if(c&&c.length!==0){l=yield Sr(n.localStore,ot(c[0]));for(let h of c){let m=n.ba.get(h),f=yield Yv(n,m);f.snapshot&&s.push(f.snapshot)}}else{let h=yield u_(n.localStore,o);l=yield Sr(n.localStore,h),yield ad(n,E_(h),o,!1,l.resumeToken)}r.push(l)}return n.Sa.h_(s),r})}function E_(i){return Tg(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function ew(i){return function(t){return q(q(t).persistence).Bi()}(q(i).localStore)}function tw(i,e,t,n){return P(this,null,function*(){let r=q(i);if(r.La)return void k("SyncEngine","Ignoring unexpected query state notification.");let s=r.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield h_(r.localStore,bg(s[0])),l=$s.createSynthesizedRemoteEventForCurrentChange(e,t==="current",je.EMPTY_BYTE_STRING);yield wn(r,o,l);break}case"rejected":yield xr(r.localStore,e,!0),Dr(r,e,n);break;default:G()}})}function nw(i,e,t){return P(this,null,function*(){let n=Tl(i);if(n.La){for(let r of e){if(n.Da.has(r)&&n.sharedClientState.isActiveQueryTarget(r)){k("SyncEngine","Adding an already active target "+r);continue}let s=yield u_(n.localStore,r),o=yield Sr(n.localStore,s);yield ad(n,E_(s),o.targetId,!1,o.resumeToken),Il(n.remoteStore,o)}for(let r of t)n.Da.has(r)&&(yield xr(n.localStore,r,!1).then(()=>{Pr(n.remoteStore,r),Dr(n,r)}).catch(Jn))}})}function Tl(i){let e=q(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=I_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gv.bind(null,e),e.Sa.h_=Nv.bind(null,e.eventManager),e.Sa.ka=Fv.bind(null,e.eventManager),e}function hd(i){let e=q(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$v.bind(null,e),e}function iw(i,e,t){let n=q(i);(function(s,o,l){return P(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(b,V){let O=q(b),R=Oe(V.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",K=>O.$r.getBundleMetadata(K,V.id)).then(K=>!!K&&K.createTime.compareTo(R)>=0)}(s.localStore,c))return yield o.close(),l._completeWith(function(b){return{taskState:"Success",documentsLoaded:b.totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}}(c)),Promise.resolve(new Set);l._updateProgress(v_(c));let h=new yh(c,s.localStore,o.serializer),m=yield o.qa();for(;m;){let g=yield h._a(m);g&&l._updateProgress(g),m=yield o.qa()}let f=yield h.complete();return yield wn(s,f.ca,void 0),yield function(b,V){let O=q(b);return O.persistence.runTransaction("Save bundle","readwrite",R=>O.$r.saveBundleMetadata(R,V))}(s.localStore,c),l._completeWith(f.progress),Promise.resolve(f.ua)}catch(c){return Dt("SyncEngine",`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}})})(n,e,t).then(r=>{n.sharedClientState.notifyBundleLoaded(r)})}var eo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){this.serializer=lo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return o_(this.persistence,new Ya,e.initialUser,this.serializer)}createPersistence(e){return new Qa(Wa.Hr,this.serializer)}createSharedClientState(e){return new el}terminate(){return P(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var ul=class i extends eo{constructor(e,t,n){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){return P(this,null,function*(){yield cc(i.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield hd(this.Qa.syncEngine),yield Lr(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return o_(this.persistence,new Ya,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new zu(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new iu(t,this.persistence);return new nu(e.asyncQueue,n)}createPersistence(e){let t=ed(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Rt.withCacheSize(this.cacheSizeBytes):Rt.DEFAULT;return new Zu(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,m_(),Ta(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new el}},Eh=class i extends ul{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return P(this,null,function*(){yield cc(i.prototype,this,"initialize").call(this,e);let t=this.Qa.syncEngine;this.sharedClientState instanceof Ms&&(this.sharedClientState.syncEngine={Zs:Jv.bind(null,t),Xs:tw.bind(null,t),eo:nw.bind(null,t),Bi:ew.bind(null,t),Ys:Xv.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.fi(n=>P(this,null,function*(){yield Zv(this.Qa.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=m_();if(!Ms.D(t))throw new D(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=ed(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ms(t,e.asyncQueue,n,e.clientId,e.initialUser)}},to=class{initialize(e,t){return P(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Kf(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qv.bind(null,this.syncEngine),yield dh(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new fh}()}createDatastore(e){let t=lo(e.databaseInfo.databaseId),n=function(s){return new oh(s)}(e.databaseInfo);return function(s,o,l,c){return new ch(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,r,s,o,l){return new hh(n,r,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>Kf(this.syncEngine,t,0),function(){return tl.D()?new tl:new rh}())}createSyncEngine(e,t){return function(r,s,o,l,c,h,m){let f=new Ih(r,s,o,l,c,h);return m&&(f.La=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return P(this,null,function*(){var e;yield function(n){return P(this,null,function*(){let r=q(n);k("RemoteStore","RemoteStore shutting down."),r.M_.add(5),yield Fr(r),r.O_.shutdown(),r.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Qf(i,e=10240){let t=0;return{read(){return P(this,null,function*(){if(t<i.byteLength){let r={value:i.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})},cancel(){return P(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var kr=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):ke("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var bh=class{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new Le,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(n=>{n&&n.sa()?this.metadata.resolve(n.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.ia)}`))},n=>this.metadata.reject(n))}close(){return this.Ua.cancel()}getMetadata(){return P(this,null,function*(){return this.metadata.promise})}qa(){return P(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return P(this,null,function*(){let e=yield this.za();if(e===null)return null;let t=this.Wa.decode(e),n=Number(t);isNaN(n)&&this.ja(`length string (${t}) is not valid number`);let r=yield this.Ha(n);return new _h(JSON.parse(r),e.length+n)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return P(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Ha(e){return P(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return P(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Ch=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new D(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(r,s){return P(this,null,function*(){let o=q(r),l={documents:s.map(f=>Hs(o.serializer,f))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,ae.emptyPath(),l,s.length),h=new Map;c.forEach(f=>{let g=lv(o.serializer,f);h.set(g.key.toString(),g)});let m=[];return s.forEach(f=>{let g=h.get(f.toString());j(!!g),m.push(g)}),m})}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return P(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let r=B.fromPath(n);this.mutations.push(new Us(r,this.precondition(r)))}),yield function(n,r){return P(this,null,function*(){let s=q(n),o={writes:r.map(l=>Qs(s.serializer,l))};yield s.Co("Commit",s.serializer.databaseId,ae.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw G();t=$.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new D(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual($.min())?Re.exists(!1):Re.updateTime(t):Re.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual($.min()))throw new D(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Re.updateTime(t)}return Re.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Ah=class{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.Za=n.maxAttempts,this.Yo=new Js(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>P(this,null,function*(){let e=new Ch(this.datastore),t=this.tu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(r=>{this.nu(r)}))}).catch(n=>{this.nu(n)})}))}tu(e){try{let t=this.updateFunction(e);return!ro(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Lg(t)}return!1}};var Sh=class{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Fe.UNAUTHENTICATED,this.clientId=Ca.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>P(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(x.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Le;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=Br(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Ea(i,e){return P(this,null,function*(){i.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=i.configuration;yield e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(r=>P(this,null,function*(){n.isEqual(r)||(yield a_(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e})}function xh(i,e){return P(this,null,function*(){i.asyncQueue.verifyOperationInProgress();let t=yield dd(i);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>jf(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,r)=>jf(e.remoteStore,r)),i._onlineComponents=e})}function b_(i){return i.name==="FirebaseError"?i.code===x.FAILED_PRECONDITION||i.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}function dd(i){return P(this,null,function*(){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ea(i,i._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!b_(t))throw t;Dt("Error using user provided cache. Falling back to memory cache: "+t),yield Ea(i,new eo)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Ea(i,new eo);return i._offlineComponents})}function El(i){return P(this,null,function*(){return i._onlineComponents||(i._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield xh(i,i._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield xh(i,new to))),i._onlineComponents})}function C_(i){return dd(i).then(e=>e.persistence)}function md(i){return dd(i).then(e=>e.localStore)}function A_(i){return El(i).then(e=>e.remoteStore)}function pd(i){return El(i).then(e=>e.syncEngine)}function rw(i){return El(i).then(e=>e.datastore)}function Vr(i){return P(this,null,function*(){let e=yield El(i),t=e.eventManager;return t.onListen=Lv.bind(null,e.syncEngine),t.onUnlisten=Bv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=zv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=qv.bind(null,e.syncEngine),t})}function sw(i){return i.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield C_(i),t=yield A_(i);return e.setNetworkEnabled(!0),function(r){let s=q(r);return s.M_.delete(0),co(s)}(t)}))}function ow(i){return i.asyncQueue.enqueue(()=>P(this,null,function*(){let e=yield C_(i),t=yield A_(i);return e.setNetworkEnabled(!1),function(r){return P(this,null,function*(){let s=q(r);s.M_.add(0),yield Fr(s),s.N_.set("Offline")})}(t)}))}function aw(i,e){let t=new Le;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,s,o){return P(this,null,function*(){try{let l=yield function(h,m){let f=q(h);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,m))}(r,s);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new D(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){let c=Br(l,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield md(i),e,t)})),t.promise}function S_(i,e,t={}){let n=new Le;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,l,c,h){let m=new kr({next:g=>{o.enqueueAndForget(()=>sd(s,f));let b=g.docs.has(l);!b&&g.fromCache?h.reject(new D(x.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&g.fromCache&&c&&c.source==="server"?h.reject(new D(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),f=new Zs(Nr(l.path),m,{includeMetadataChanges:!0,ra:!0});return rd(s,f)}(yield Vr(i),i.asyncQueue,e,t,n)})),n.promise}function lw(i,e){let t=new Le;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,s,o){return P(this,null,function*(){try{let l=yield Xa(r,s,!0),c=new cl(s,l.hs),h=c.da(l.documents),m=c.applyChanges(h,!1);o.resolve(m.snapshot)}catch(l){let c=Br(l,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield md(i),e,t)})),t.promise}function x_(i,e,t={}){let n=new Le;return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(s,o,l,c,h){let m=new kr({next:g=>{o.enqueueAndForget(()=>sd(s,f)),g.fromCache&&c.source==="server"?h.reject(new D(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),f=new Zs(l,m,{includeMetadataChanges:!0,ra:!0});return rd(s,f)}(yield Vr(i),i.asyncQueue,e,t,n)})),n.promise}function cw(i,e){let t=new kr(e);return i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,s){q(r).z_.add(s),s.next()}(yield Vr(i),t)})),()=>{t.$a(),i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return function(r,s){q(r).z_.delete(s)}(yield Vr(i),t)}))}}function uw(i,e,t,n){let r=function(o,l){let c;return c=typeof o=="string"?Bg().encode(o):o,function(m,f){return new bh(m,f)}(function(m,f){if(m instanceof Uint8Array)return Qf(m,f);if(m instanceof ArrayBuffer)return Qf(new Uint8Array(m),f);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),l)}(t,lo(e));i.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){iw(yield pd(i),r,n)}))}function hw(i,e){return i.asyncQueue.enqueue(()=>P(this,null,function*(){return function(n,r){let s=q(n);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,r))}(yield md(i),e)}))}function P_(i){let e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}var Wf=new Map;function fd(i,e,t){if(!t)throw new D(x.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function gd(i,e,t,n){if(e===!0&&n===!0)throw new D(x.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function Yf(i){if(!B.isDocumentKey(i))throw new D(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Xf(i){if(B.isDocumentKey(i))throw new D(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function bl(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":G()}function le(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new D(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=bl(i);throw new D(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function R_(i,e){if(e<=0)throw new D(x.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}var hl=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new D(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gd("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=P_((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ri=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hl(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Kc;switch(n.type){case"firstParty":return new Yc(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new D(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=Wf.get(t);n&&(k("ComponentProvider","Removing Datastore"),Wf.delete(t),n.terminate())}(this),Promise.resolve()}};function D_(i,e,t,n={}){var r;let s=(i=le(i,Ri))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Dt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),i._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Fe.MOCK_USER;else{l=Cp(n.mockUserToken,(r=i._app)===null||r===void 0?void 0:r.options.projectId);let h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new D(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Fe(h)}i._authCredentials=new Hc(new ba(l,c))}}var We=class i{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new i(this.firestore,e,this._query)}},ve=class i{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new i(this.firestore,e,this._key)}},Xt=class i extends We{constructor(e,t,n){super(e,t,Nr(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ve(this.firestore,null,new B(e))}withConverter(e){return new i(this.firestore,e,this._path)}};function _d(i,e,...t){if(i=Ee(i),fd("collection","path",e),i instanceof Ri){let n=ae.fromString(e,...t);return Xf(n),new Xt(i,null,n)}{if(!(i instanceof ve||i instanceof Xt))throw new D(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=i._path.child(ae.fromString(e,...t));return Xf(n),new Xt(i.firestore,null,n)}}function k_(i,e){if(i=le(i,Ri),fd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new We(i,null,function(n){return new zt(ae.emptyPath(),n)}(e))}function uo(i,e,...t){if(i=Ee(i),arguments.length===1&&(e=Ca.newId()),fd("doc","path",e),i instanceof Ri){let n=ae.fromString(e,...t);return Yf(n),new ve(i,null,new B(n))}{if(!(i instanceof ve||i instanceof Xt))throw new D(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=i._path.child(ae.fromString(e,...t));return Yf(n),new ve(i.firestore,i instanceof Xt?i.converter:null,new B(n))}}function yd(i,e){return i=Ee(i),e=Ee(e),(i instanceof ve||i instanceof Xt)&&(e instanceof ve||e instanceof Xt)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function vd(i,e){return i=Ee(i),e=Ee(e),i instanceof We&&e instanceof We&&i.firestore===e.firestore&&oo(i._query,e._query)&&i.converter===e.converter}var Ph=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Js(this,"async_queue_retry"),this.hu=()=>{let t=Ta();t&&k("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Ta();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Ta();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Le;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return P(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Zn(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(n=>{this.au=n,this.uu=!1;let r=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw ke("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.uu=!1,n))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let r=mh.createAndSchedule(this,e,t,n,s=>this.Eu(s));return this._u.push(r),r}Pu(){this.au&&G()}verifyOperationInProgress(){}du(){return P(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function Rh(i){return function(t,n){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(i,["next","error","complete"])}var Dh=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Le,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var V_=-1,Te=class extends Ri{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=function(){return new Ph}(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||O_(this),this._firestoreClient.terminate()}};function Ge(i){return i._firestoreClient||O_(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function O_(i){var e,t,n;let r=i._freezeSettings(),s=function(l,c,h,m){return new ru(l,c,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,P_(m.experimentalLongPollingOptions),m.useFetchStreams)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,r);i._firestoreClient=new Sh(i._authCredentials,i._appCheckCredentials,i._queue,s),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=r.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function M_(i,e){j_(i=le(i,Te));let t=Ge(i);if(t._uninitializedComponentsProvider)throw new D(x.FAILED_PRECONDITION,"SDK cache is already specified.");Dt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=i._freezeSettings(),r=new to;return F_(t,r,new ul(r,n.cacheSizeBytes,e?.forceOwnership))}function N_(i){j_(i=le(i,Te));let e=Ge(i);if(e._uninitializedComponentsProvider)throw new D(x.FAILED_PRECONDITION,"SDK cache is already specified.");Dt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=i._freezeSettings(),n=new to;return F_(e,n,new Eh(n,t.cacheSizeBytes))}function F_(i,e,t){let n=new Le;return i.asyncQueue.enqueue(()=>P(this,null,function*(){try{yield Ea(i,t),yield xh(i,e),n.resolve()}catch(r){let s=r;if(!b_(s))throw s;Dt("Error enabling indexeddb cache. Falling back to memory cache: "+s),n.reject(s)}})).then(()=>n.promise)}function L_(i){if(i._initialized&&!i._terminated)throw new D(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Le;return i._queue.enqueueAndForgetEvenWhileRestricted(()=>P(this,null,function*(){try{yield function(n){return P(this,null,function*(){if(!Gn.D())return Promise.resolve();let r=n+"main";yield Gn.delete(r)})}(ed(i._databaseId,i._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function z_(i){return function(t){let n=new Le;return t.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Kv(yield pd(t),n)})),n.promise}(Ge(i=le(i,Te)))}function B_(i){return sw(Ge(i=le(i,Te)))}function q_(i){return ow(Ge(i=le(i,Te)))}function U_(i,e){let t=Ge(i=le(i,Te)),n=new Dh;return uw(t,i._databaseId,e,n),n}function G_(i,e){return hw(Ge(i=le(i,Te)),e).then(t=>t?new We(i,null,t.query):null)}function j_(i){if(i._initialized||i._terminated)throw new D(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var tn=class i{constructor(e){this._byteString=e}static fromBase64String(e){try{return new i(je.fromBase64String(e))}catch(t){throw new D(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new i(je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var qt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var yn=class{constructor(e){this._methodName=e}};var Di=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var dw=/^__.*__$/,kh=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Bt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wn(e,this.data,t,this.fieldTransforms)}},dl=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Bt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function $_(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var ml=class i{constructor(e,t,n,r,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new i(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.wu(e),r}Su(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return pl(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if($_(this.fu)&&dw.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},Vh=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||lo(e)}Fu(e,t,n,r=!1){return new ml({fu:e,methodName:t,vu:n,path:Ve.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Mi(i){let e=i._freezeSettings(),t=lo(i._databaseId);return new Vh(i._databaseId,!!e.ignoreUndefinedProperties,t)}function Cl(i,e,t,n,r,s={}){let o=i.Fu(s.merge||s.mergeFields?2:0,e,t,r);Td("Data must be an object, but it was:",o,n);let l=Q_(n,o),c,h;if(s.merge)c=new It(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let m=[];for(let f of s.mergeFields){let g=Lh(e,f,t);if(!o.contains(g))throw new D(x.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Y_(m,g)||m.push(g)}c=new It(m),h=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,h=o.fieldTransforms;return new kh(new tt(l),c,h)}var no=class i extends yn{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof i}};function K_(i,e,t){return new ml({fu:3,vu:e.settings.vu,methodName:i._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Oh=class i extends yn{_toFieldTransform(e){return new Si(e.path,new Hn)}isEqual(e){return e instanceof i}},Mh=class i extends yn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=K_(this,e,!0),n=this.Mu.map(s=>Ni(s,t)),r=new gn(n);return new Si(e.path,r)}isEqual(e){return e instanceof i&&vc(this.Mu,e.Mu)}},Nh=class i extends yn{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){let t=K_(this,e,!0),n=this.Mu.map(s=>Ni(s,t)),r=new _n(n);return new Si(e.path,r)}isEqual(e){return e instanceof i&&vc(this.Mu,e.Mu)}},Fh=class i extends yn{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){let t=new Qn(e.serializer,Dg(e.serializer,this.xu));return new Si(e.path,t)}isEqual(e){return e instanceof i&&this.xu===e.xu}};function wd(i,e,t,n){let r=i.Fu(1,e,t);Td("Data must be an object, but it was:",r,n);let s=[],o=tt.empty();Oi(n,(c,h)=>{let m=Ed(e,c,t);h=Ee(h);let f=r.Su(m);if(h instanceof no)s.push(m);else{let g=Ni(h,f);g!=null&&(s.push(m),o.set(m,g))}});let l=new It(s);return new dl(o,l,r.fieldTransforms)}function Id(i,e,t,n,r,s){let o=i.Fu(1,e,t),l=[Lh(e,n,t)],c=[r];if(s.length%2!=0)throw new D(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Lh(e,s[g])),c.push(s[g+1]);let h=[],m=tt.empty();for(let g=l.length-1;g>=0;--g)if(!Y_(h,l[g])){let b=l[g],V=c[g];V=Ee(V);let O=o.Su(b);if(V instanceof no)h.push(b);else{let R=Ni(V,O);R!=null&&(h.push(b),m.set(b,R))}}let f=new It(h);return new dl(m,f,o.fieldTransforms)}function H_(i,e,t,n=!1){return Ni(t,i.Fu(n?4:3,e))}function Ni(i,e){if(W_(i=Ee(i)))return Td("Unsupported field value:",e,i),Q_(i,e);if(i instanceof yn)return function(n,r){if(!$_(r.fu))throw r.Du(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Du(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(n,r){let s=[],o=0;for(let l of n){let c=Ni(l,r.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(i,e)}return function(n,r){if((n=Ee(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Dg(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=Ce.fromDate(n);return{timestampValue:br(r.serializer,s)}}if(n instanceof Ce){let s=new Ce(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:br(r.serializer,s)}}if(n instanceof Di)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof tn)return{bytesValue:qg(r.serializer,n._byteString)};if(n instanceof ve){let s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Xh(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.Du(`Unsupported field value: ${bl(n)}`)}(i,e)}function Q_(i,e){let t={};return mg(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oi(i,(n,r)=>{let s=Ni(r,e.pu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function W_(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Ce||i instanceof Di||i instanceof tn||i instanceof ve||i instanceof yn)}function Td(i,e,t){if(!W_(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let n=bl(t);throw n==="an object"?e.Du(i+" a custom object"):e.Du(i+" "+n)}}function Lh(i,e,t){if((e=Ee(e))instanceof qt)return e._internalPath;if(typeof e=="string")return Ed(i,e);throw pl("Field path arguments must be of type string or ",i,!1,void 0,t)}var mw=new RegExp("[~\\*/\\[\\]]");function Ed(i,e,t){if(e.search(mw)>=0)throw pl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new qt(...e.split("."))._internalPath}catch{throw pl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function pl(i,e,t,n,r){let s=n&&!n.isEmpty(),o=r!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${r}`),c+=")"),new D(x.INVALID_ARGUMENT,l+i+c)}function Y_(i,e){return i.some(t=>t.isEqual(e))}var ki=class{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new zh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Al("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},zh=class extends ki{data(){return super.data()}};function Al(i,e){return typeof e=="string"?Ed(i,e):e instanceof qt?e._internalPath:e._delegate._internalPath}function X_(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new D(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var io=class{},Vi=class extends io{};function In(i,e,...t){let n=[];e instanceof io&&n.push(e),n=n.concat(t),function(s){let o=s.filter(c=>c instanceof Bh).length,l=s.filter(c=>c instanceof fl).length;if(o>1||o>0&&l>0)throw new D(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(let r of n)i=r._apply(i);return i}var fl=class i extends Vi{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=this._parse(e);return a0(e._query,t),new We(e.firestore,e.converter,_u(e._query,t))}_parse(e){let t=Mi(e.firestore);return function(s,o,l,c,h,m,f){let g;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new D(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Zf(f,m);let b=[];for(let V of f)b.push(Jf(c,s,V));g={arrayValue:{values:b}}}else g=Jf(c,s,f)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Zf(f,m),g=H_(l,o,f,m==="in"||m==="not-in");return ie.create(h,m,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function J_(i,e,t){let n=e,r=Al("where",i);return fl._create(r,n,t)}var Bh=class i extends io{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new i(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:me.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r,l=s.getFlattenedFilters();for(let c of l)a0(o,c),o=_u(o,c)}(e._query,t),new We(e.firestore,e.converter,_u(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var qh=class i extends Vi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new i(e,t)}_apply(e){let t=function(r,s,o){if(r.startAt!==null)throw new D(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new D(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ci(s,o)}(e._query,this._field,this._direction);return new We(e.firestore,e.converter,function(r,s){let o=r.explicitOrderBy.concat([s]);return new zt(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}};function Z_(i,e="asc"){let t=e,n=Al("orderBy",i);return qh._create(n,t)}var gl=class i extends Vi{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){return new We(e.firestore,e.converter,Ma(e._query,this._limit,this._limitType))}};function e0(i){return R_("limit",i),gl._create("limit",i,"F")}function t0(i){return R_("limitToLast",i),gl._create("limitToLast",i,"L")}var _l=class i extends Vi{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=o0(e,this.type,this._docOrFields,this._inclusive);return new We(e.firestore,e.converter,function(r,s){return new zt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,t))}};function n0(...i){return _l._create("startAt",i,!0)}function i0(...i){return _l._create("startAfter",i,!1)}var yl=class i extends Vi{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new i(e,t,n)}_apply(e){let t=o0(e,this.type,this._docOrFields,this._inclusive);return new We(e.firestore,e.converter,function(r,s){return new zt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,t))}};function r0(...i){return yl._create("endBefore",i,!1)}function s0(...i){return yl._create("endAt",i,!0)}function o0(i,e,t,n){if(t[0]=Ee(t[0]),t[0]instanceof ki)return function(s,o,l,c,h){if(!c)throw new D(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);let m=[];for(let f of gr(s))if(f.field.isKeyField())m.push(bi(o,c.key));else{let g=c.data.field(f.field);if(wl(g))throw new D(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let b=f.field.canonicalString();throw new D(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}m.push(g)}return new Zt(m,h)}(i._query,i.firestore._databaseId,e,t[0]._document,n);{let r=Mi(i.firestore);return function(o,l,c,h,m,f){let g=o.explicitOrderBy;if(m.length>g.length)throw new D(x.INVALID_ARGUMENT,`Too many arguments provided to ${h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let b=[];for(let V=0;V<m.length;V++){let O=m[V];if(g[V].field.isKeyField()){if(typeof O!="string")throw new D(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${h}(), but got a ${typeof O}`);if(!Wh(o)&&O.indexOf("/")!==-1)throw new D(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${h}() must be a plain document ID, but '${O}' contains a slash.`);let R=o.path.child(ae.fromString(O));if(!B.isDocumentKey(R))throw new D(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${h}() must result in a valid document path, but '${R}' is not because it contains an odd number of segments.`);let K=new B(R);b.push(bi(l,K))}else{let R=H_(c,h,O);b.push(R)}}return new Zt(b,f)}(i._query,i.firestore._databaseId,r,e,t,n)}}function Jf(i,e,t){if(typeof(t=Ee(t))=="string"){if(t==="")throw new D(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wh(e)&&t.indexOf("/")!==-1)throw new D(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(ae.fromString(t));if(!B.isDocumentKey(n))throw new D(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return bi(i,new B(n))}if(t instanceof ve)return bi(i,t._key);throw new D(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bl(t)}.`)}function Zf(i,e){if(!Array.isArray(i)||i.length===0)throw new D(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function a0(i,e){let t=function(r,s){for(let o of r)for(let l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(i.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new D(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Or=class{convertValue(e,t="none"){switch(Ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(jn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return Oi(e,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new Di(Pe(e.latitude),Pe(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=Hh(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(zs(e));default:return null}}convertTimestamp(e){let t=fn(e);return new Ce(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=ae.fromString(e);j(Jg(n));let r=new $n(n.get(1),n.get(3)),s=new B(n.popFirst(5));return r.isEqual(t)||ke(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Sl(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}var Uh=class extends Or{constructor(e){super(),this.firestore=e}convertBytes(e){return new tn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}};var pn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vt=class extends ki{constructor(e,t,n,r,s,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new qn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(Al("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},qn=class extends Vt{data(e={}){return super.data(e)}},Ut=class{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new pn(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new qn(this._firestore,this._userDataWriter,n.key,n,new pn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{let c=new qn(r._firestore,r._userDataWriter,l.doc.key,l.doc,new pn(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{let c=new qn(r._firestore,r._userDataWriter,l.doc.key,l.doc,new pn(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),h=-1,m=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:pw(l.type),doc:c,oldIndex:h,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function pw(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function bd(i,e){return i instanceof Vt&&e instanceof Vt?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(i._document===null?e._document===null:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof Ut&&e instanceof Ut&&i._firestore===e._firestore&&vd(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}function l0(i){i=le(i,ve);let e=le(i.firestore,Te);return S_(Ge(e),i._key).then(t=>xd(e,i,t))}var vn=class extends Or{constructor(e){super(),this.firestore=e}convertBytes(e){return new tn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}};function c0(i){i=le(i,ve);let e=le(i.firestore,Te),t=Ge(e),n=new vn(e);return aw(t,i._key).then(r=>new Vt(e,n,i._key,r,new pn(r!==null&&r.hasLocalMutations,!0),i.converter))}function u0(i){i=le(i,ve);let e=le(i.firestore,Te);return S_(Ge(e),i._key,{source:"server"}).then(t=>xd(e,i,t))}function h0(i){i=le(i,We);let e=le(i.firestore,Te),t=Ge(e),n=new vn(e);return X_(i._query),x_(t,i._query).then(r=>new Ut(e,n,i,r))}function d0(i){i=le(i,We);let e=le(i.firestore,Te),t=Ge(e),n=new vn(e);return lw(t,i._query).then(r=>new Ut(e,n,i,r))}function m0(i){i=le(i,We);let e=le(i.firestore,Te),t=Ge(e),n=new vn(e);return x_(t,i._query,{source:"server"}).then(r=>new Ut(e,n,i,r))}function Cd(i,e,t){i=le(i,ve);let n=le(i.firestore,Te),r=Sl(i.converter,e,t);return qr(n,[Cl(Mi(n),"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,Re.none())])}function Ad(i,e,t,...n){i=le(i,ve);let r=le(i.firestore,Te),s=Mi(r),o;return o=typeof(e=Ee(e))=="string"||e instanceof qt?Id(s,"updateDoc",i._key,e,t,n):wd(s,"updateDoc",i._key,e),qr(r,[o.toMutation(i._key,Re.exists(!0))])}function p0(i){return qr(le(i.firestore,Te),[new Yn(i._key,Re.none())])}function f0(i,e){let t=le(i.firestore,Te),n=uo(i),r=Sl(i.converter,e);return qr(t,[Cl(Mi(i.firestore),"addDoc",n._key,r,i.converter!==null,{}).toMutation(n._key,Re.exists(!1))]).then(()=>n)}function Sd(i,...e){var t,n,r;i=Ee(i);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Rh(e[o])||(s=e[o],o++);let l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Rh(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(r=f.complete)===null||r===void 0?void 0:r.bind(f)}let c,h,m;if(i instanceof ve)h=le(i.firestore,Te),m=Nr(i._key.path),c={next:f=>{e[o]&&e[o](xd(h,i,f))},error:e[o+1],complete:e[o+2]};else{let f=le(i,We);h=le(f.firestore,Te),m=f._query;let g=new vn(h);c={next:b=>{e[o]&&e[o](new Ut(h,g,f,b))},error:e[o+1],complete:e[o+2]},X_(i._query)}return function(g,b,V,O){let R=new kr(O),K=new Zs(b,R,V);return g.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return rd(yield Vr(g),K)})),()=>{R.$a(),g.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return sd(yield Vr(g),K)}))}}(Ge(h),m,l,c)}function g0(i,e){return cw(Ge(i=le(i,Te)),Rh(e)?e:{next:e})}function qr(i,e){return function(n,r){let s=new Le;return n.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){return Uv(yield pd(n),r,s)})),s.promise}(Ge(i),e)}function xd(i,e,t){let n=t.docs.get(e._key),r=new vn(i);return new Vt(i,r,e._key,n,new pn(t.hasPendingWrites,t.fromCache),e.converter)}var fw={maxAttempts:5};var vl=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Mi(e)}set(e,t,n){this._verifyNotCommitted();let r=zn(e,this._firestore),s=Sl(r.converter,t,n),o=Cl(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,n);return this._mutations.push(o.toMutation(r._key,Re.none())),this}update(e,t,n,...r){this._verifyNotCommitted();let s=zn(e,this._firestore),o;return o=typeof(t=Ee(t))=="string"||t instanceof qt?Id(this._dataReader,"WriteBatch.update",s._key,t,n,r):wd(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Re.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=zn(e,this._firestore);return this._mutations=this._mutations.concat(new Yn(t._key,Re.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function zn(i,e){if((i=Ee(i)).firestore!==e)throw new D(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}var Gh=class extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=Mi(t)}get(t){let n=zn(t,this._firestore),r=new Uh(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return G();let o=s[0];if(o.isFoundDocument())return new ki(this._firestore,r,o.key,o,n.converter);if(o.isNoDocument())return new ki(this._firestore,r,n._key,null,n.converter);throw G()})}set(t,n,r){let s=zn(t,this._firestore),o=Sl(s.converter,n,r),l=Cl(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,r);return this._transaction.set(s._key,l),this}update(t,n,r,...s){let o=zn(t,this._firestore),l;return l=typeof(n=Ee(n))=="string"||n instanceof qt?Id(this._dataReader,"Transaction.update",o._key,n,r,s):wd(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(t){let n=zn(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=zn(e,this._firestore),n=new vn(this._firestore);return super.get(e).then(r=>new Vt(this._firestore,n,t._key,r._document,new pn(!1,!1),t.converter))}};function _0(i,e,t){i=le(i,Te);let n=Object.assign(Object.assign({},fw),t);return function(s){if(s.maxAttempts<1)throw new D(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){let c=new Le;return s.asyncQueue.enqueueAndForget(()=>P(this,null,function*(){let h=yield rw(s);new Ah(s.asyncQueue,h,l,o,c).Xa()})),c.promise}(Ge(i),r=>e(new Gh(i,r)),n)}function y0(){return new no("deleteField")}function v0(){return new Oh("serverTimestamp")}function w0(...i){return new Mh("arrayUnion",i)}function I0(...i){return new Nh("arrayRemove",i)}function T0(i){return new Fh("increment",i)}(function(e,t=!0){(function(r){Mr=r})(xp),vs(new mi("firestore",(n,{instanceIdentifier:r,options:s})=>{let o=n.getProvider("app").getImmediate(),l=new Te(new Qc(n.getProvider("auth-internal")),new Jc(n.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new D(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $n(h.options.projectId,m)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Vn(Zp,"4.6.3",e),Vn(Zp,"4.6.3","esm2017")})();var gw="@firebase/firestore-compat",_w="0.3.32";function Od(i,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function E0(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function b0(){if(!pg())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}var xl=class i{constructor(e){this._delegate=e}static fromBase64String(e){return b0(),new i(tn.fromBase64String(e))}static fromUint8Array(e){return E0(),new i(tn.fromUint8Array(e))}toBase64(){return b0(),this._delegate.toBase64()}toUint8Array(){return E0(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Pd(i){return yw(i,["next","error","complete"])}function yw(i,e){if(typeof i!="object"||i===null)return!1;let t=i;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var Rd=class{enableIndexedDbPersistence(e,t){return M_(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return N_(e._delegate)}clearIndexedDbPersistence(e){return L_(e._delegate)}},Pl=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof $n||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Dt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){D_(this._delegate,e,t,n)}enableNetwork(){return B_(this._delegate)}disableNetwork(){return q_(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,gd("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return z_(this._delegate)}onSnapshotsInSync(e){return g0(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new jr(this,_d(this._delegate,e))}catch(t){throw at(t,"collection()","Firestore.collection()")}}doc(e){try{return new nn(this,uo(this._delegate,e))}catch(t){throw at(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Bi(this,k_(this._delegate,e))}catch(t){throw at(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return _0(this._delegate,t=>e(new Rl(this,t)))}batch(){return Ge(this._delegate),new Dl(new vl(this._delegate,e=>qr(this._delegate,e)))}loadBundle(e){return U_(this._delegate,e)}namedQuery(e){return G_(this._delegate,e).then(t=>t?new Bi(this,t):null)}},Ur=class extends Or{constructor(e){super(),this.firestore=e}convertBytes(e){return new xl(new tn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return nn.forKey(t,this.firestore,null)}};function vw(i){eg(i)}var Rl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}get(e){let t=Fi(e);return this._delegate.get(t).then(n=>new Li(this._firestore,new Vt(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let r=Fi(e);return n?(Od("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let s=Fi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){let t=Fi(e);return this._delegate.delete(t),this}},Dl=class{constructor(e){this._delegate=e}set(e,t,n){let r=Fi(e);return n?(Od("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let s=Fi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){let t=Fi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Gr=class i{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new qn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zi(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=i.INSTANCES,r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(t);return s||(s=new i(e,new Ur(e),t),r.set(t,s)),s}};Gr.INSTANCES=new WeakMap;var nn=class i{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}static forPath(e,t,n){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new i(t,new ve(t._delegate,n,new B(e)))}static forKey(e,t,n){return new i(t,new ve(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new jr(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new jr(this.firestore,_d(this._delegate,e))}catch(t){throw at(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ee(e),e instanceof ve?yd(this._delegate,e):!1}set(e,t){t=Od("DocumentReference.set",t);try{return t?Cd(this._delegate,e,t):Cd(this._delegate,e)}catch(n){throw at(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?Ad(this._delegate,e):Ad(this._delegate,e,t,...n)}catch(r){throw at(r,"updateDoc()","DocumentReference.update()")}}delete(){return p0(this._delegate)}onSnapshot(...e){let t=C0(e),n=A0(e,r=>new Li(this.firestore,new Vt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Sd(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=c0(this._delegate):e?.source==="server"?t=u0(this._delegate):t=l0(this._delegate),t.then(n=>new Li(this.firestore,new Vt(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function at(i,e,t){return i.message=i.message.replace(e,t),i}function C0(i){for(let e of i)if(typeof e=="object"&&!Pd(e))return e;return{}}function A0(i,e){var t,n;let r;return Pd(i[0])?r=i[0]:Pd(i[1])?r=i[1]:typeof i[0]=="function"?r={next:i[0],error:i[1],complete:i[2]}:r={next:i[1],error:i[2],complete:i[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(n=r.complete)===null||n===void 0?void 0:n.bind(r)}}var Li=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new nn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return bd(this._delegate,e._delegate)}},zi=class extends Li{data(e){let t=this._delegate.data(e);return this._delegate._converter||tg(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Bi=class i{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ur(e)}where(e,t,n){try{return new i(this.firestore,In(this._delegate,J_(e,t,n)))}catch(r){throw at(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new i(this.firestore,In(this._delegate,Z_(e,t)))}catch(n){throw at(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new i(this.firestore,In(this._delegate,e0(e)))}catch(t){throw at(t,"limit()","Query.limit()")}}limitToLast(e){try{return new i(this.firestore,In(this._delegate,t0(e)))}catch(t){throw at(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new i(this.firestore,In(this._delegate,n0(...e)))}catch(t){throw at(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new i(this.firestore,In(this._delegate,i0(...e)))}catch(t){throw at(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new i(this.firestore,In(this._delegate,r0(...e)))}catch(t){throw at(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new i(this.firestore,In(this._delegate,s0(...e)))}catch(t){throw at(t,"endAt()","Query.endAt()")}}isEqual(e){return vd(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=d0(this._delegate):e?.source==="server"?t=m0(this._delegate):t=h0(this._delegate),t.then(n=>new ho(this.firestore,new Ut(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=C0(e),n=A0(e,r=>new ho(this.firestore,new Ut(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Sd(this._delegate,t,n)}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Dd=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},ho=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Bi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Dd(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new zi(this._firestore,n))})}isEqual(e){return bd(this._delegate,e._delegate)}},jr=class i extends Bi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new nn(this.firestore,e):null}doc(e){try{return e===void 0?new nn(this.firestore,uo(this._delegate)):new nn(this.firestore,uo(this._delegate,e))}catch(t){throw at(t,"doc()","CollectionReference.doc()")}}add(e){return f0(this._delegate,e).then(t=>new nn(this.firestore,t))}isEqual(e){return yd(this._delegate,e._delegate)}withConverter(e){return new i(this.firestore,e?this._delegate.withConverter(Gr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Fi(i){return le(i,ve)}var kd=class i{constructor(...e){this._delegate=new qt(...e)}static documentId(){return new i(Ve.keyField().canonicalString())}isEqual(e){return e=Ee(e),e instanceof qt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Vd=class i{constructor(e){this._delegate=e}static serverTimestamp(){let e=v0();return e._methodName="FieldValue.serverTimestamp",new i(e)}static delete(){let e=y0();return e._methodName="FieldValue.delete",new i(e)}static arrayUnion(...e){let t=w0(...e);return t._methodName="FieldValue.arrayUnion",new i(t)}static arrayRemove(...e){let t=I0(...e);return t._methodName="FieldValue.arrayRemove",new i(t)}static increment(e){let t=T0(e);return t._methodName="FieldValue.increment",new i(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var ww={Firestore:Pl,GeoPoint:Di,Timestamp:Ce,Blob:xl,Transaction:Rl,WriteBatch:Dl,DocumentReference:nn,DocumentSnapshot:Li,Query:Bi,QueryDocumentSnapshot:zi,QuerySnapshot:ho,CollectionReference:jr,FieldPath:kd,FieldValue:Vd,setLogLevel:vw,CACHE_SIZE_UNLIMITED:V_};function Iw(i,e){i.INTERNAL.registerComponent(new mi("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},ww)))}function Tw(i){Iw(i,(e,t)=>new Pl(e,t,new Rd)),i.registerVersion(gw,_w)}Tw(pt);function Ew(i,e=Fo){return new $i(t=>{let n;return e!=null?e.schedule(()=>{n=i.onSnapshot({includeMetadataChanges:!0},t)}):n=i.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function S0(i,e){return Ew(i,e)}function bw(i,e){return S0(i,e).pipe(Bo(void 0),Lo(),He(t=>{let[n,r]=t;return r.exists?n?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function Fd(i,e){return S0(i,e).pipe(He(t=>({payload:t,type:"query"})))}var kl=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:r,query:s}=k0(n,t);return new Ol(r,s,this.afs)}snapshotChanges(){return bw(this.ref,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return this.snapshotChanges().pipe(He(({payload:t})=>e.idField?lc(Mt({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return An(this.ref.get(e)).pipe(ft)}};function Vl(i,e){return Fd(i,e).pipe(Bo(void 0),Lo(),He(t=>{let[n,r]=t,s=r.payload.docChanges(),o=s.map(l=>({type:l.type,payload:l}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,c)=>{let h=s.find(f=>f.doc.ref.isEqual(l.ref)),m=n?.payload.docs.find(f=>f.ref.isEqual(l.ref));h&&JSON.stringify(h.doc.metadata)===JSON.stringify(l.metadata)||!h&&m&&JSON.stringify(m.metadata)===JSON.stringify(l.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:l}})}),o}))}function x0(i,e,t){return Vl(i,t).pipe(zo((n,r)=>Cw(n,r.map(s=>s.payload),e),[]),jm(),He(n=>n.map(r=>({type:r.type,payload:r}))))}function Cw(i,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(i=Aw(i,n))}),i}function Md(i,e,t,...n){let r=i.slice();return r.splice(e,t,...n),r}function Aw(i,e){switch(e.type){case"added":if(!(i[e.newIndex]&&i[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Md(i,e.newIndex,0,e);break;case"modified":if(i[e.oldIndex]==null||i[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Md(i,e.newIndex,1,e);break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Md(i,e.oldIndex,1);break}return i}function P0(i){return(!i||i.length===0)&&(i=["added","removed","modified"]),i}var Ol=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=Vl(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(He(n=>n.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Bo(void 0),Lo(),us(([n,r])=>r.length>0||!n),He(([,n])=>n),ft)}auditTrail(e){return this.stateChanges(e).pipe(zo((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=P0(e);return x0(this.query,t,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return Fd(this.query,this.afs.schedulers.outsideAngular).pipe(He(t=>t.payload.docs.map(n=>e.idField?lc(Mt({},n.data()),{[e.idField]:n.id}):n.data())),ft)}get(e){return An(this.query.get(e)).pipe(ft)}add(e){return this.ref.add(e)}doc(e){return new kl(this.ref.doc(e),this.afs)}},Nd=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Vl(this.query,this.afs.schedulers.outsideAngular).pipe(ft):Vl(this.query,this.afs.schedulers.outsideAngular).pipe(He(t=>t.filter(n=>e.indexOf(n.type)>-1)),us(t=>t.length>0),ft)}auditTrail(e){return this.stateChanges(e).pipe(zo((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=P0(e);return x0(this.query,t,this.afs.schedulers.outsideAngular).pipe(ft)}valueChanges(e={}){return Fd(this.query,this.afs.schedulers.outsideAngular).pipe(He(n=>n.payload.docs.map(r=>e.idField?Mt({[e.idField]:r.id},r.data()):r.data())),ft)}get(e){return An(this.query.get(e)).pipe(ft)}},R0=new Qe("angularfire2.enableFirestorePersistence"),D0=new Qe("angularfire2.firestore.persistenceSettings"),Sw=new Qe("angularfire2.firestore.settings"),xw=new Qe("angularfire2.firestore.use-emulator");function k0(i,e=t=>t){return{query:e(i),ref:i}}var Ld=(()=>{class i{schedulers;firestore;persistenceEnabled$;constructor(t,n,r,s,o,l,c,h,m,f,g,b,V,O,R,K,Q){this.schedulers=c;let z=Es(t,l,n),W=m;f&&Oc(z,l,g,V,O,R,b,K),[this.firestore,this.persistenceEnabled$]=ha(`${z.name}.firestore`,"AngularFirestore",z.name,()=>{let J=l.runOutsideAngular(()=>z.firestore());if(s&&J.settings(s),W&&J.useEmulator(...W),r&&!Qo(o)){let Z=()=>{try{return An(J.enablePersistence(h||void 0).then(()=>!0,()=>!1))}catch(w){return typeof console<"u"&&console.warn(w),Sn(!1)}};return[J,l.runOutsideAngular(Z)]}else return[J,Sn(!1)]},[s,W,r])}collection(t,n){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=k0(r,n),l=this.schedulers.ngZone.run(()=>s);return new Ol(l,o,this)}collectionGroup(t,n){let r=n||(o=>o),s=this.firestore.collectionGroup(t);return new Nd(r(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let r=this.schedulers.ngZone.run(()=>n);return new kl(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||i)(Y(nr),Y(ir,8),Y(R0,8),Y(Sw,8),Y(bt),Y(ut),Y(la),Y(D0,8),Y(xw,8),Y(Yp,8),Y(xc,8),Y(Pc,8),Y(Rc,8),Y(Dc,8),Y(kc,8),Y(Vc,8),Y(pi,8))};static \u0275prov=lt({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})(),V0=(()=>{class i{constructor(){pt.registerVersion("angularfire",tr.full,"fst-compat")}static enablePersistence(t){return{ngModule:i,providers:[{provide:R0,useValue:!0},{provide:D0,useValue:t}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=qe({type:i});static \u0275inj=Be({providers:[Ld]})}return i})();var Ml=(()=>{let e=class e{constructor(n){this.db=n,this.dbPath="/puzzledata",this.puzzleDataRef=this.db.collection(this.dbPath)}getAll(){return this.puzzleDataRef}create(n){return this.puzzleDataRef.add(Mt({},n))}update(n,r){return this.puzzleDataRef.doc(n).update(r)}delete(n){return this.puzzleDataRef.doc(n).delete()}};e.\u0275fac=function(r){return new(r||e)(Y(Ld))},e.\u0275prov=lt({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Nl=(()=>{let e=class e{constructor(){this.subjectItemUpdate=new Ki}updatePerformedItem(n){this.subjectItemUpdate.next(n)}getUpdatedStageLevel(){return this.subjectItemUpdate.asObservable()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=lt({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var mo=(()=>{class i extends Pt{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["CheckIcon"]],standalone:!0,features:[Ct,xt],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0),X(1,"path",1),U()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role))},encapsulation:2})}return i})();var po=(()=>{class i extends Pt{pathId;ngOnInit(){this.pathId="url(#"+rt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[Ct,xt],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0)(1,"g"),X(2,"path",1)(3,"path",2)(4,"path",3),U(),L(5,"defs")(6,"clipPath",4),X(7,"rect",5),U()()()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),M(),re("clip-path",r.pathId),M(5),N("id",r.pathId))},encapsulation:2})}return i})();var fo=(()=>{class i extends Pt{pathId;ngOnInit(){this.pathId="url(#"+rt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["InfoCircleIcon"]],standalone:!0,features:[Ct,xt],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0)(1,"g"),X(2,"path",1),U(),L(3,"defs")(4,"clipPath",2),X(5,"rect",3),U()()()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),M(),re("clip-path",r.pathId),M(3),N("id",r.pathId))},encapsulation:2})}return i})();var go=(()=>{class i extends Pt{pathId;ngOnInit(){this.pathId="url(#"+rt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["TimesCircleIcon"]],standalone:!0,features:[Ct,xt],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0)(1,"g"),X(2,"path",1),U(),L(3,"defs")(4,"clipPath",2),X(5,"rect",3),U()()()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),M(),re("clip-path",r.pathId),M(3),N("id",r.pathId))},encapsulation:2})}return i})();var N0=["container"],kw=i=>[i,"p-toast-message"],Vw=(i,e,t,n)=>({showTransformParams:i,hideTransformParams:e,showTransitionParams:t,hideTransitionParams:n}),Ow=i=>({value:"visible",params:i}),Mw=(i,e)=>({$implicit:i,closeFn:e}),Nw=i=>({$implicit:i});function Fw(i,e){i&1&&an(0)}function Lw(i,e){if(i&1&&(yt(0),ne(1,Fw,1,0,"ng-container",4),vt()),i&2){let t=H();M(),N("ngTemplateOutlet",t.headlessTemplate)("ngTemplateOutletContext",ci(2,Mw,t.message,t.onCloseIconClick))}}function zw(i,e){if(i&1&&X(0,"span"),i&2){let t=H(3);Se("p-toast-message-icon pi "+t.message.icon)}}function Bw(i,e){i&1&&X(0,"CheckIcon"),i&2&&re("aria-hidden",!0)("data-pc-section","icon")}function qw(i,e){i&1&&X(0,"InfoCircleIcon"),i&2&&re("aria-hidden",!0)("data-pc-section","icon")}function Uw(i,e){i&1&&X(0,"TimesCircleIcon"),i&2&&re("aria-hidden",!0)("data-pc-section","icon")}function Gw(i,e){i&1&&X(0,"ExclamationTriangleIcon"),i&2&&re("aria-hidden",!0)("data-pc-section","icon")}function jw(i,e){if(i&1&&(L(0,"span",13),yt(1),ne(2,Bw,1,2,"CheckIcon",6)(3,qw,1,2,"InfoCircleIcon",6)(4,Uw,1,2,"TimesCircleIcon",6)(5,Gw,1,2,"ExclamationTriangleIcon",6),vt(),U()),i&2){let t=H(3);re("aria-hidden",!0)("data-pc-section","icon"),M(2),N("ngIf",t.message.severity==="success"),M(),N("ngIf",t.message.severity==="info"),M(),N("ngIf",t.message.severity==="error"),M(),N("ngIf",t.message.severity==="warn")}}function $w(i,e){if(i&1&&(yt(0),ne(1,zw,1,2,"span",8)(2,jw,6,6,"span",9),L(3,"div",10)(4,"div",11),ye(5),U(),L(6,"div",12),ye(7),U()(),vt()),i&2){let t=H(2);M(),N("ngIf",t.message.icon),M(),N("ngIf",!t.message.icon),M(),re("data-pc-section","text"),M(),re("data-pc-section","summary"),M(),Pn(t.message.summary),M(),re("data-pc-section","detail"),M(),Pn(t.message.detail)}}function Kw(i,e){i&1&&an(0)}function Hw(i,e){if(i&1&&X(0,"span"),i&2){let t=H(3);Se("pt-1 text-base p-toast-message-icon pi "+t.message.closeIcon)}}function Qw(i,e){i&1&&X(0,"TimesIcon",16),i&2&&(N("styleClass","p-toast-icon-close-icon"),re("aria-hidden",!0)("data-pc-section","closeicon"))}function Ww(i,e){if(i&1){let t=Ue();L(0,"button",14),xe("click",function(r){ce(t);let s=H(2);return ue(s.onCloseIconClick(r))})("keydown.enter",function(r){ce(t);let s=H(2);return ue(s.onCloseIconClick(r))}),ne(1,Hw,1,2,"span",8)(2,Qw,1,3,"TimesIcon",15),U()}if(i&2){let t=H(2);re("aria-label",t.closeAriaLabel)("data-pc-section","closebutton"),M(),N("ngIf",t.message.closeIcon),M(),N("ngIf",!t.message.closeIcon)}}function Yw(i,e){if(i&1&&(L(0,"div",5),ne(1,$w,8,7,"ng-container",6)(2,Kw,1,0,"ng-container",4)(3,Ww,3,4,"button",7),U()),i&2){let t=H();N("ngClass",t.message==null?null:t.message.contentStyleClass),re("data-pc-section","content"),M(),N("ngIf",!t.template),M(),N("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Nt(6,Nw,t.message)),M(),N("ngIf",(t.message==null?null:t.message.closable)!==!1)}}function Xw(i,e){if(i&1){let t=Ue();L(0,"p-toastItem",3),xe("onClose",function(r){ce(t);let s=H();return ue(s.onMessageClose(r))})("@toastAnimation.start",function(r){ce(t);let s=H();return ue(s.onAnimationStart(r))})("@toastAnimation.done",function(r){ce(t);let s=H();return ue(s.onAnimationEnd(r))}),U()}if(i&2){let t=e.$implicit,n=e.index,r=H();N("message",t)("index",n)("life",r.life)("template",r.template)("headlessTemplate",r.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}var Jw=(()=>{class i{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new ct;containerViewChild;timeout;constructor(t,n){this.zone=t,this.config=n}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=t=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),t.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(n){return new(n||i)(de(ut),de(_s))};static \u0275cmp=_e({type:i,selectors:[["p-toastItem"]],viewQuery:function(n,r){if(n&1&&ln(N0,5),n&2){let s;ht(s=dt())&&(r.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",cn],life:[2,"life","life",cn],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[xn],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(n,r){if(n&1){let s=Ue();L(0,"div",2,0),xe("mouseenter",function(){return ce(s),ue(r.onMouseEnter())})("mouseleave",function(){return ce(s),ue(r.onMouseLeave())}),ne(2,Lw,2,5,"ng-container",3)(3,Yw,4,8,"ng-template",null,1,ms),U()}if(n&2){let s=ds(4);Se(r.message==null?null:r.message.styleClass),N("ngClass",Nt(9,kw,"p-toast-message-"+(r.message==null?null:r.message.severity)))("@messageState",Nt(16,Ow,$o(11,Vw,r.showTransformOptions,r.hideTransformOptions,r.showTransitionOptions,r.hideTransitionOptions))),re("id",r.message==null?null:r.message.id)("data-pc-name","toast")("data-pc-section","root"),M(2),N("ngIf",r.headlessTemplate)("ngIfElse",s)}},dependencies:()=>[un,Ko,Ho,Zo,mo,fo,go,po,kn],encapsulation:2,data:{animation:[hi("messageState",[gs("visible",$t({transform:"translateY(0)",opacity:1})),hn("void => *",[$t({transform:"{{showTransformParams}}",opacity:0}),Dn("{{showTransitionParams}}")]),hn("* => void",[Dn("{{hideTransitionParams}}",$t({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return i})(),F0=(()=>{class i{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(t){this._position=t,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new ct;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(t,n,r,s,o){this.document=t,this.renderer=n,this.messageService=r,this.cd=s,this.config=o}styleElement;id=rt();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(t=>{if(t)if(Array.isArray(t)){let n=t.filter(r=>this.canAdd(r));this.add(n)}else this.canAdd(t)&&this.add([t])}),this.clearSubscription=this.messageService.clearObserver.subscribe(t=>{t?this.key===t&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(t){this.messages=this.messages?[...this.messages,...t]:[...t],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...t]:[...t]),this.cd.markForCheck()}canAdd(t){let n=this.key===t.key;return n&&this.preventOpenDuplicates&&(n=!this.containsMessage(this.messages,t)),n&&this.preventDuplicates&&(n=!this.containsMessage(this.messagesArchieve,t)),n}containsMessage(t,n){return t?t.find(r=>r.summary===n.summary&&r.detail==n.detail&&r.severity===n.severity)!=null:!1}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"message":this.template=t.template;break;case"headless":this.headlessTemplate=t.template;break;default:this.template=t.template;break}})}onMessageClose(t){this.messages?.splice(t.index,1),this.onClose.emit({message:t.message}),this.cd.detectChanges()}onAnimationStart(t){t.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&di.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(t){t.toState==="void"&&this.autoZIndex&&yp.isEmpty(this.messages)&&di.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let n in this.breakpoints){let r="";for(let s in this.breakpoints[n])r+=s+":"+this.breakpoints[n][s]+" !important;";t+=`
                    @media screen and (max-width: ${n}) {
                        .p-toast[${this.id}] {
                           ${r}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",t),se.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&di.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(n){return new(n||i)(de(jt),de(hs),de(Xi),de(ps),de(_s))};static \u0275cmp=_e({type:i,selectors:[["p-toast"]],contentQueries:function(n,r,s){if(n&1&&li(s,Xo,4),n&2){let o;ht(o=dt())&&(r.templates=o)}},viewQuery:function(n,r){if(n&1&&ln(N0,5),n&2){let s;ht(s=dt())&&(r.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",De],baseZIndex:[2,"baseZIndex","baseZIndex",cn],life:[2,"life","life",cn],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",De],preventDuplicates:[2,"preventDuplicates","preventDuplicates",De],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[xn],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(n,r){n&1&&(L(0,"div",1,0),ne(2,Xw,1,10,"p-toastItem",2),U()),n&2&&(Se(r.styleClass),N("ngClass","p-toast-"+r._position)("ngStyle",r.style),M(2),N("ngForOf",r.messages))},dependencies:[un,lp,Rn,Jw],styles:[`@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}
`],encapsulation:2,data:{animation:[hi("toastAnimation",[hn(":enter, :leave",[gp("@*",fp())])])]},changeDetection:0})}return i})(),L0=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=qe({type:i});static \u0275inj=Be({imports:[mt,Ji,mo,fo,go,po,kn,Jo]})}return i})();var z0=(()=>{class i{pFocusTrapDisabled=!1;platformId=Qi(bt);host=Qi(Wi);document=Qi(jt);firstHiddenFocusableElement;lastHiddenFocusableElement;ngOnInit(){ui(this.platformId)&&!this.pFocusTrapDisabled&&!this.firstHiddenFocusableElement&&!this.lastHiddenFocusableElement&&this.createHiddenFocusableElements()}ngOnChanges(t){t.pFocusTrapDisabled&&ui(this.platformId)&&(t.pFocusTrapDisabled.currentValue?this.removeHiddenFocusableElements():this.createHiddenFocusableElements())}removeHiddenFocusableElements(){this.firstHiddenFocusableElement&&this.firstHiddenFocusableElement.parentNode&&this.firstHiddenFocusableElement.parentNode.removeChild(this.firstHiddenFocusableElement),this.lastHiddenFocusableElement&&this.lastHiddenFocusableElement.parentNode&&this.lastHiddenFocusableElement.parentNode.removeChild(this.lastHiddenFocusableElement)}getComputedSelector(t){return`:not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])${t??""}`}createHiddenFocusableElements(){let t="0",n=r=>se.createElement("span",{class:"p-hidden-accessible p-hidden-focusable",tabindex:t,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:r?.bind(this)});this.firstHiddenFocusableElement=n(this.onFirstHiddenElementFocus),this.lastHiddenFocusableElement=n(this.onLastHiddenElementFocus),this.firstHiddenFocusableElement.setAttribute("data-pc-section","firstfocusableelement"),this.lastHiddenFocusableElement.setAttribute("data-pc-section","lastfocusableelement"),this.host.nativeElement.prepend(this.firstHiddenFocusableElement),this.host.nativeElement.append(this.lastHiddenFocusableElement)}onFirstHiddenElementFocus(t){let{currentTarget:n,relatedTarget:r}=t,s=r===this.lastHiddenFocusableElement||!this.host.nativeElement?.contains(r)?se.getFirstFocusableElement(n.parentElement,":not(.p-hidden-focusable)"):this.lastHiddenFocusableElement;se.focus(s)}onLastHiddenElementFocus(t){let{currentTarget:n,relatedTarget:r}=t,s=r===this.firstHiddenFocusableElement||!this.host.nativeElement?.contains(r)?se.getLastFocusableElement(n.parentElement,":not(.p-hidden-focusable)"):this.firstHiddenFocusableElement;se.focus(s)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=dc({type:i,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],inputs:{pFocusTrapDisabled:[2,"pFocusTrapDisabled","pFocusTrapDisabled",De]},features:[xn,Qm]})}return i})(),B0=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=qe({type:i});static \u0275inj=Be({imports:[mt]})}return i})();var zd=(()=>{class i extends Pt{pathId;ngOnInit(){this.pathId="url(#"+rt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["WindowMaximizeIcon"]],standalone:!0,features:[Ct,xt],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14ZM9.77805 7.42192C9.89013 7.534 10.0415 7.59788 10.2 7.59995C10.3585 7.59788 10.5099 7.534 10.622 7.42192C10.7341 7.30985 10.798 7.15844 10.8 6.99995V3.94242C10.8066 3.90505 10.8096 3.86689 10.8089 3.82843C10.8079 3.77159 10.7988 3.7157 10.7824 3.6623C10.756 3.55552 10.701 3.45698 10.622 3.37798C10.5099 3.2659 10.3585 3.20202 10.2 3.19995H7.00002C6.84089 3.19995 6.68828 3.26317 6.57576 3.37569C6.46324 3.48821 6.40002 3.64082 6.40002 3.79995C6.40002 3.95908 6.46324 4.11169 6.57576 4.22422C6.68828 4.33674 6.84089 4.39995 7.00002 4.39995H8.80006L6.19997 7.00005C6.10158 7.11005 6.04718 7.25246 6.04718 7.40005C6.04718 7.54763 6.10158 7.69004 6.19997 7.80005C6.30202 7.91645 6.44561 7.98824 6.59997 8.00005C6.75432 7.98824 6.89791 7.91645 6.99997 7.80005L9.60002 5.26841V6.99995C9.6021 7.15844 9.66598 7.30985 9.77805 7.42192ZM1.4 14H3.8C4.17066 13.9979 4.52553 13.8498 4.78763 13.5877C5.04973 13.3256 5.1979 12.9707 5.2 12.6V10.2C5.1979 9.82939 5.04973 9.47452 4.78763 9.21242C4.52553 8.95032 4.17066 8.80215 3.8 8.80005H1.4C1.02934 8.80215 0.674468 8.95032 0.412371 9.21242C0.150274 9.47452 0.00210008 9.82939 0 10.2V12.6C0.00210008 12.9707 0.150274 13.3256 0.412371 13.5877C0.674468 13.8498 1.02934 13.9979 1.4 14ZM1.25858 10.0586C1.29609 10.0211 1.34696 10 1.4 10H3.8C3.85304 10 3.90391 10.0211 3.94142 10.0586C3.97893 10.0961 4 10.147 4 10.2V12.6C4 12.6531 3.97893 12.704 3.94142 12.7415C3.90391 12.779 3.85304 12.8 3.8 12.8H1.4C1.34696 12.8 1.29609 12.779 1.25858 12.7415C1.22107 12.704 1.2 12.6531 1.2 12.6V10.2C1.2 10.147 1.22107 10.0961 1.25858 10.0586Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0)(1,"g"),X(2,"path",1),U(),L(3,"defs")(4,"clipPath",2),X(5,"rect",3),U()()()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),M(),re("clip-path",r.pathId),M(3),N("id",r.pathId))},encapsulation:2})}return i})();var Bd=(()=>{class i extends Pt{pathId;ngOnInit(){this.pathId="url(#"+rt()+")"}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Et(i)))(r||i)}})();static \u0275cmp=_e({type:i,selectors:[["WindowMinimizeIcon"]],standalone:!0,features:[Ct,xt],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.8 0H2.2C1.61652 0 1.05694 0.231785 0.644365 0.644365C0.231785 1.05694 0 1.61652 0 2.2V7C0 7.15913 0.063214 7.31174 0.175736 7.42426C0.288258 7.53679 0.44087 7.6 0.6 7.6C0.75913 7.6 0.911742 7.53679 1.02426 7.42426C1.13679 7.31174 1.2 7.15913 1.2 7V2.2C1.2 1.93478 1.30536 1.68043 1.49289 1.49289C1.68043 1.30536 1.93478 1.2 2.2 1.2H11.8C12.0652 1.2 12.3196 1.30536 12.5071 1.49289C12.6946 1.68043 12.8 1.93478 12.8 2.2V11.8C12.8 12.0652 12.6946 12.3196 12.5071 12.5071C12.3196 12.6946 12.0652 12.8 11.8 12.8H7C6.84087 12.8 6.68826 12.8632 6.57574 12.9757C6.46321 13.0883 6.4 13.2409 6.4 13.4C6.4 13.5591 6.46321 13.7117 6.57574 13.8243C6.68826 13.9368 6.84087 14 7 14H11.8C12.3835 14 12.9431 13.7682 13.3556 13.3556C13.7682 12.9431 14 12.3835 14 11.8V2.2C14 1.61652 13.7682 1.05694 13.3556 0.644365C12.9431 0.231785 12.3835 0 11.8 0ZM6.368 7.952C6.44137 7.98326 6.52025 7.99958 6.6 8H9.8C9.95913 8 10.1117 7.93678 10.2243 7.82426C10.3368 7.71174 10.4 7.55913 10.4 7.4C10.4 7.24087 10.3368 7.08826 10.2243 6.97574C10.1117 6.86321 9.95913 6.8 9.8 6.8H8.048L10.624 4.224C10.73 4.11026 10.7877 3.95982 10.7849 3.80438C10.7822 3.64894 10.7192 3.50063 10.6093 3.3907C10.4994 3.28077 10.3511 3.2178 10.1956 3.21506C10.0402 3.21232 9.88974 3.27002 9.776 3.376L7.2 5.952V4.2C7.2 4.04087 7.13679 3.88826 7.02426 3.77574C6.91174 3.66321 6.75913 3.6 6.6 3.6C6.44087 3.6 6.28826 3.66321 6.17574 3.77574C6.06321 3.88826 6 4.04087 6 4.2V7.4C6.00042 7.47975 6.01674 7.55862 6.048 7.632C6.07656 7.70442 6.11971 7.7702 6.17475 7.82524C6.2298 7.88029 6.29558 7.92344 6.368 7.952ZM1.4 8.80005H3.8C4.17066 8.80215 4.52553 8.95032 4.78763 9.21242C5.04973 9.47452 5.1979 9.82939 5.2 10.2V12.6C5.1979 12.9707 5.04973 13.3256 4.78763 13.5877C4.52553 13.8498 4.17066 13.9979 3.8 14H1.4C1.02934 13.9979 0.674468 13.8498 0.412371 13.5877C0.150274 13.3256 0.00210008 12.9707 0 12.6V10.2C0.00210008 9.82939 0.150274 9.47452 0.412371 9.21242C0.674468 8.95032 1.02934 8.80215 1.4 8.80005ZM3.94142 12.7415C3.97893 12.704 4 12.6531 4 12.6V10.2C4 10.147 3.97893 10.0961 3.94142 10.0586C3.90391 10.0211 3.85304 10 3.8 10H1.4C1.34696 10 1.29609 10.0211 1.25858 10.0586C1.22107 10.0961 1.2 10.147 1.2 10.2V12.6C1.2 12.6531 1.22107 12.704 1.25858 12.7415C1.29609 12.779 1.34696 12.8 1.4 12.8H3.8C3.85304 12.8 3.90391 12.779 3.94142 12.7415Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,r){n&1&&(Tt(),L(0,"svg",0)(1,"g"),X(2,"path",1),U(),L(3,"defs")(4,"clipPath",2),X(5,"rect",3),U()()()),n&2&&(Se(r.getClassNames()),re("aria-label",r.ariaLabel)("aria-hidden",r.ariaHidden)("role",r.role),M(),re("clip-path",r.pathId),M(3),N("id",r.pathId))},encapsulation:2})}return i})();var tI=["titlebar"],nI=["content"],iI=["footer"],rI=["*",[["p-header"]],[["p-footer"]]],sI=["*","p-header","p-footer"],oI=(i,e,t,n,r,s,o,l,c,h)=>({"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":i,"p-dialog-mask-scrollblocker":e,"p-dialog-left":t,"p-dialog-right":n,"p-dialog-top":r,"p-dialog-top-left":s,"p-dialog-top-right":o,"p-dialog-bottom":l,"p-dialog-bottom-left":c,"p-dialog-bottom-right":h}),aI=(i,e,t,n)=>({"p-dialog p-component":!0,"p-dialog-rtl":i,"p-dialog-draggable":e,"p-dialog-resizable":t,"p-dialog-maximized":n}),lI=(i,e)=>({transform:i,transition:e}),cI=i=>({value:"visible",params:i}),uI=()=>({"p-dialog-header-icon p-dialog-header-maximize p-link":!0}),hI=()=>({"p-dialog-header-icon p-dialog-header-close p-link":!0});function dI(i,e){i&1&&an(0)}function mI(i,e){if(i&1&&(yt(0),ne(1,dI,1,0,"ng-container",10),vt()),i&2){let t=H(3);M(),N("ngTemplateOutlet",t.headlessTemplate)}}function pI(i,e){if(i&1){let t=Ue();L(0,"div",15),xe("mousedown",function(r){ce(t);let s=H(4);return ue(s.initResize(r))}),U()}}function fI(i,e){if(i&1&&(L(0,"span",21),ye(1),U()),i&2){let t=H(5);N("id",t.ariaLabelledBy),M(),Pn(t.header)}}function gI(i,e){if(i&1&&(L(0,"span",21),qo(1,1),U()),i&2){let t=H(5);N("id",t.ariaLabelledBy)}}function _I(i,e){i&1&&an(0)}function yI(i,e){if(i&1&&X(0,"span",25),i&2){let t=H(6);N("ngClass",t.maximized?t.minimizeIcon:t.maximizeIcon)}}function vI(i,e){i&1&&X(0,"WindowMaximizeIcon",27),i&2&&N("styleClass","p-dialog-header-maximize-icon")}function wI(i,e){i&1&&X(0,"WindowMinimizeIcon",27),i&2&&N("styleClass","p-dialog-header-maximize-icon")}function II(i,e){if(i&1&&(yt(0),ne(1,vI,1,1,"WindowMaximizeIcon",26)(2,wI,1,1,"WindowMinimizeIcon",26),vt()),i&2){let t=H(6);M(),N("ngIf",!t.maximized&&!t.maximizeIconTemplate),M(),N("ngIf",t.maximized&&!t.minimizeIconTemplate)}}function TI(i,e){}function EI(i,e){i&1&&ne(0,TI,0,0,"ng-template")}function bI(i,e){if(i&1&&(yt(0),ne(1,EI,1,0,null,10),vt()),i&2){let t=H(6);M(),N("ngTemplateOutlet",t.maximizeIconTemplate)}}function CI(i,e){}function AI(i,e){i&1&&ne(0,CI,0,0,"ng-template")}function SI(i,e){if(i&1&&(yt(0),ne(1,AI,1,0,null,10),vt()),i&2){let t=H(6);M(),N("ngTemplateOutlet",t.minimizeIconTemplate)}}function xI(i,e){if(i&1){let t=Ue();L(0,"button",22),xe("click",function(){ce(t);let r=H(5);return ue(r.maximize())})("keydown.enter",function(){ce(t);let r=H(5);return ue(r.maximize())}),ne(1,yI,1,1,"span",23)(2,II,3,2,"ng-container",24)(3,bI,2,1,"ng-container",24)(4,SI,2,1,"ng-container",24),U()}if(i&2){let t=H(5);N("ngClass",mc(7,uI)),re("tabindex",t.maximizable?"0":"-1")("aria-label",t.maximizeLabel),M(),N("ngIf",t.maximizeIcon&&!t.maximizeIconTemplate&&!t.minimizeIconTemplate),M(),N("ngIf",!t.maximizeIcon),M(),N("ngIf",!t.maximized),M(),N("ngIf",t.maximized)}}function PI(i,e){if(i&1&&X(0,"span",30),i&2){let t=H(7);N("ngClass",t.closeIcon)}}function RI(i,e){i&1&&X(0,"TimesIcon",27),i&2&&N("styleClass","p-dialog-header-close-icon")}function DI(i,e){if(i&1&&(yt(0),ne(1,PI,1,1,"span",29)(2,RI,1,1,"TimesIcon",26),vt()),i&2){let t=H(6);M(),N("ngIf",t.closeIcon),M(),N("ngIf",!t.closeIcon)}}function kI(i,e){}function VI(i,e){i&1&&ne(0,kI,0,0,"ng-template")}function OI(i,e){if(i&1&&(L(0,"span"),ne(1,VI,1,0,null,10),U()),i&2){let t=H(6);M(),N("ngTemplateOutlet",t.closeIconTemplate)}}function MI(i,e){if(i&1){let t=Ue();L(0,"button",28),xe("click",function(r){ce(t);let s=H(5);return ue(s.close(r))})("keydown.enter",function(r){ce(t);let s=H(5);return ue(s.close(r))}),ne(1,DI,3,2,"ng-container",24)(2,OI,2,1,"span",24),U()}if(i&2){let t=H(5);N("ngClass",mc(5,hI)),re("aria-label",t.closeAriaLabel)("tabindex",t.closeTabindex),M(),N("ngIf",!t.closeIconTemplate),M(),N("ngIf",t.closeIconTemplate)}}function NI(i,e){if(i&1){let t=Ue();L(0,"div",16,3),xe("mousedown",function(r){ce(t);let s=H(4);return ue(s.initDrag(r))}),ne(2,fI,2,2,"span",17)(3,gI,2,1,"span",17)(4,_I,1,0,"ng-container",10),L(5,"div",18),ne(6,xI,5,8,"button",19)(7,MI,3,6,"button",20),U()()}if(i&2){let t=H(4);M(2),N("ngIf",!t.headerFacet&&!t.headerTemplate),M(),N("ngIf",t.headerFacet),M(),N("ngTemplateOutlet",t.headerTemplate),M(2),N("ngIf",t.maximizable),M(),N("ngIf",t.closable)}}function FI(i,e){i&1&&an(0)}function LI(i,e){i&1&&an(0)}function zI(i,e){if(i&1&&(L(0,"div",31,4),qo(2,2),ne(3,LI,1,0,"ng-container",10),U()),i&2){let t=H(4);M(3),N("ngTemplateOutlet",t.footerTemplate)}}function BI(i,e){if(i&1&&(ne(0,pI,1,0,"div",11)(1,NI,8,5,"div",12),L(2,"div",13,2),qo(4),ne(5,FI,1,0,"ng-container",10),U(),ne(6,zI,4,1,"div",14)),i&2){let t=H(3);N("ngIf",t.resizable),M(),N("ngIf",t.showHeader),M(),Se(t.contentStyleClass),N("ngClass","p-dialog-content")("ngStyle",t.contentStyle),M(3),N("ngTemplateOutlet",t.contentTemplate),M(),N("ngIf",t.footerFacet||t.footerTemplate)}}function qI(i,e){if(i&1){let t=Ue();L(0,"div",8,0),xe("@animation.start",function(r){ce(t);let s=H(2);return ue(s.onAnimationStart(r))})("@animation.done",function(r){ce(t);let s=H(2);return ue(s.onAnimationEnd(r))}),ne(2,mI,2,1,"ng-container",9)(3,BI,7,8,"ng-template",null,1,ms),U()}if(i&2){let t=ds(4),n=H(2);Se(n.styleClass),N("ngClass",$o(10,aI,n.rtl,n.draggable,n.resizable,n.maximized))("ngStyle",n.style)("pFocusTrapDisabled",n.focusTrap===!1)("@animation",Nt(18,cI,ci(15,lI,n.transformOptions,n.transitionOptions))),re("aria-labelledby",n.ariaLabelledBy)("aria-modal",!0),M(2),N("ngIf",n.headlessTemplate)("ngIfElse",t)}}function UI(i,e){if(i&1&&(L(0,"div",6),ne(1,qI,5,20,"div",7),U()),i&2){let t=H();Xm(t.maskStyle),Se(t.maskStyleClass),N("ngClass",ip(6,oI,[t.modal,t.modal||t.blockScroll,t.position==="left",t.position==="right",t.position==="top",t.position==="topleft"||t.position==="top-left",t.position==="topright"||t.position==="top-right",t.position==="bottom",t.position==="bottomleft"||t.position==="bottom-left",t.position==="bottomright"||t.position==="bottom-right"])),M(),N("ngIf",t.visible)}}var GI=fc([$t({transform:"{{transform}}",opacity:0}),Dn("{{transition}}")]),jI=fc([Dn("{{transition}}",$t({transform:"{{transform}}",opacity:0}))]),q0=(()=>{class i{document;platformId;el;renderer;zone;cd;config;header;draggable=!0;resizable=!0;get positionLeft(){return 0}set positionLeft(t){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(t){console.log("positionTop property is deprecated.")}contentStyle;contentStyleClass;modal=!1;closeOnEscape=!0;dismissableMask=!1;rtl=!1;closable=!0;get responsive(){return!1}set responsive(t){console.log("Responsive property is deprecated.")}appendTo;breakpoints;styleClass;maskStyleClass;maskStyle;showHeader=!0;get breakpoint(){return 649}set breakpoint(t){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}blockScroll=!1;autoZIndex=!0;baseZIndex=0;minX=0;minY=0;focusOnShow=!0;maximizable=!1;keepInViewport=!0;focusTrap=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";closeIcon;closeAriaLabel;closeTabindex="0";minimizeIcon;maximizeIcon;get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(t){t&&(this._style=Mt({},t),this.originalStyle=t)}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)";break}}onShow=new ct;onHide=new ct;visibleChange=new ct;onResizeInit=new ct;onResizeEnd=new ct;onDragEnd=new ct;onMaximize=new ct;headerFacet;footerFacet;templates;headerViewChild;contentViewChild;footerViewChild;headerTemplate;contentTemplate;footerTemplate;maximizeIconTemplate;closeIconTemplate;minimizeIconTemplate;headlessTemplate;_visible=!1;maskVisible;container;wrapper;dragging;ariaLabelledBy=this.getAriaLabelledBy();documentDragListener;documentDragEndListener;resizing;documentResizeListener;documentResizeEndListener;documentEscapeListener;maskClickListener;lastPageX;lastPageY;preventVisibleChangePropagation;maximized;preMaximizeContentHeight;preMaximizeContainerWidth;preMaximizeContainerHeight;preMaximizePageX;preMaximizePageY;id=rt();_style={};_position="center";originalStyle;transformOptions="scale(0.7)";styleElement;window;get maximizeLabel(){return this.config.getTranslation(Ip.ARIA).maximizeLabel}constructor(t,n,r,s,o,l,c){this.document=t,this.platformId=n,this.el=r,this.renderer=s,this.zone=o,this.cd=l,this.config=c,this.window=this.document.defaultView}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":this.contentTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"maximizeicon":this.maximizeIconTemplate=t.template;break;case"minimizeicon":this.minimizeIconTemplate=t.template;break;case"headless":this.headlessTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}ngOnInit(){this.breakpoints&&this.createStyle()}getAriaLabelledBy(){return this.header!==null?rt()+"_header":null}focus(t=this.contentViewChild?.nativeElement){let n=se.getFocusableElement(t,"[autofocus]");if(n){this.zone.runOutsideAngular(()=>{setTimeout(()=>n.focus(),5)});return}let r=se.getFocusableElement(t);r?this.zone.runOutsideAngular(()=>{setTimeout(()=>r.focus(),5)}):this.footerViewChild&&this.focus(this.footerViewChild.nativeElement)}close(t){this.visibleChange.emit(!1),t.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",t=>{this.wrapper&&this.wrapper.isSameNode(t.target)&&this.close(t)})),this.modal&&se.blockBodyScroll()}disableModality(){if(this.wrapper){this.dismissableMask&&this.unbindMaskClickListener();let t=document.querySelectorAll(".p-dialog-mask-scrollblocker");this.modal&&t&&t.length==1&&se.unblockBodyScroll(),this.cd.destroyed||this.cd.detectChanges()}}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?se.blockBodyScroll():se.unblockBodyScroll()),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(di.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(ui(this.platformId)&&!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let t="";for(let n in this.breakpoints)t+=`
                        @media screen and (max-width: ${n}) {
                            .p-dialog[${this.id}]:not(.p-dialog-maximized) {
                                width: ${this.breakpoints[n]} !important;
                            }
                        }
                    `;this.renderer.setProperty(this.styleElement,"innerHTML",t),se.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}initDrag(t){se.hasClass(t.target,"p-dialog-header-icon")||se.hasClass(t.target,"p-dialog-header-close-icon")||se.hasClass(t.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,this.container.style.margin="0",se.addClass(this.document.body,"p-unselectable-text"))}onDrag(t){if(this.dragging){let n=se.getOuterWidth(this.container),r=se.getOuterHeight(this.container),s=t.pageX-this.lastPageX,o=t.pageY-this.lastPageY,l=this.container.getBoundingClientRect(),c=getComputedStyle(this.container),h=parseFloat(c.marginLeft),m=parseFloat(c.marginTop),f=l.left+s-h,g=l.top+o-m,b=se.getViewport();this.container.style.position="fixed",this.keepInViewport?(f>=this.minX&&f+n<b.width&&(this._style.left=`${f}px`,this.lastPageX=t.pageX,this.container.style.left=`${f}px`),g>=this.minY&&g+r<b.height&&(this._style.top=`${g}px`,this.lastPageY=t.pageY,this.container.style.top=`${g}px`)):(this.lastPageX=t.pageX,this.container.style.left=`${f}px`,this.lastPageY=t.pageY,this.container.style.top=`${g}px`)}}endDrag(t){this.dragging&&(this.dragging=!1,se.removeClass(this.document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(t))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(t){this.resizable&&(this.resizing=!0,this.lastPageX=t.pageX,this.lastPageY=t.pageY,se.addClass(this.document.body,"p-unselectable-text"),this.onResizeInit.emit(t))}onResize(t){if(this.resizing){let n=t.pageX-this.lastPageX,r=t.pageY-this.lastPageY,s=se.getOuterWidth(this.container),o=se.getOuterHeight(this.container),l=se.getOuterHeight(this.contentViewChild?.nativeElement),c=s+n,h=o+r,m=this.container.style.minWidth,f=this.container.style.minHeight,g=this.container.getBoundingClientRect(),b=se.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(c+=n,h+=r),(!m||c>parseInt(m))&&g.left+c<b.width&&(this._style.width=c+"px",this.container.style.width=this._style.width),(!f||h>parseInt(f))&&g.top+h<b.height&&(this.contentViewChild.nativeElement.style.height=l+h-o+"px",this._style.height&&(this._style.height=h+"px",this.container.style.height=this._style.height)),this.lastPageX=t.pageX,this.lastPageY=t.pageY}}resizeEnd(t){this.resizing&&(this.resizing=!1,se.removeClass(this.document.body,"p-unselectable-text"),this.onResizeEnd.emit(t))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.documentDragListener||this.zone.runOutsideAngular(()=>{this.documentDragListener=this.renderer.listen(this.window,"mousemove",this.onDrag.bind(this))})}unbindDocumentDragListener(){this.documentDragListener&&(this.documentDragListener(),this.documentDragListener=null)}bindDocumentDragEndListener(){this.documentDragEndListener||this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.renderer.listen(this.window,"mouseup",this.endDrag.bind(this))})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(this.documentDragEndListener(),this.documentDragEndListener=null)}bindDocumentResizeListeners(){!this.documentResizeListener&&!this.documentResizeEndListener&&this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.renderer.listen(this.window,"mousemove",this.onResize.bind(this)),this.documentResizeEndListener=this.renderer.listen(this.window,"mouseup",this.resizeEnd.bind(this))})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(this.documentResizeListener(),this.documentResizeEndListener(),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){let t=this.el?this.el.nativeElement.ownerDocument:"document";this.documentEscapeListener=this.renderer.listen(t,"keydown",n=>{n.key=="Escape"&&this.close(n)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.wrapper):se.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.renderer.appendChild(this.el.nativeElement,this.wrapper)}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container?.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container?.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&se.addClass(this.document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&se.addClass(this.wrapper,"p-component-overlay-leave");break}}onAnimationEnd(t){switch(t.toState){case"void":this.onContainerDestroy(),this.onHide.emit({}),this.cd.markForCheck();break;case"visible":this.onShow.emit({});break}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(se.removeClass(this.document.body,"p-overflow-hidden"),this.document.body.style.removeProperty("--scrollbar-width"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&se.removeClass(this.document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&di.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?Mt({},this.originalStyle):{}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}static \u0275fac=function(n){return new(n||i)(de(jt),de(bt),de(Wi),de(hs),de(ut),de(ps),de(_s))};static \u0275cmp=_e({type:i,selectors:[["p-dialog"]],contentQueries:function(n,r,s){if(n&1&&(li(s,vp,5),li(s,wp,5),li(s,Xo,4)),n&2){let o;ht(o=dt())&&(r.headerFacet=o.first),ht(o=dt())&&(r.footerFacet=o.first),ht(o=dt())&&(r.templates=o)}},viewQuery:function(n,r){if(n&1&&(ln(tI,5),ln(nI,5),ln(iI,5)),n&2){let s;ht(s=dt())&&(r.headerViewChild=s.first),ht(s=dt())&&(r.contentViewChild=s.first),ht(s=dt())&&(r.footerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:[2,"draggable","draggable",De],resizable:[2,"resizable","resizable",De],positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:[2,"modal","modal",De],closeOnEscape:[2,"closeOnEscape","closeOnEscape",De],dismissableMask:[2,"dismissableMask","dismissableMask",De],rtl:[2,"rtl","rtl",De],closable:[2,"closable","closable",De],responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",maskStyle:"maskStyle",showHeader:[2,"showHeader","showHeader",De],breakpoint:"breakpoint",blockScroll:[2,"blockScroll","blockScroll",De],autoZIndex:[2,"autoZIndex","autoZIndex",De],baseZIndex:[2,"baseZIndex","baseZIndex",cn],minX:[2,"minX","minX",cn],minY:[2,"minY","minY",cn],focusOnShow:[2,"focusOnShow","focusOnShow",De],maximizable:[2,"maximizable","maximizable",De],keepInViewport:[2,"keepInViewport","keepInViewport",De],focusTrap:[2,"focusTrap","focusTrap",De],transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},features:[xn],ngContentSelectors:sI,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["content",""],["titlebar",""],["footer",""],[3,"class","style","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["class","p-dialog-footer",4,"ngIf"],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"],[1,"p-dialog-header",3,"mousedown"],["class","p-dialog-title",3,"id",4,"ngIf"],[1,"p-dialog-header-icons"],["role","button","type","button","pRipple","","pButton","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","","pButton","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title",3,"id"],["role","button","type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-maximize-icon",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],["type","button","pRipple","","pButton","",3,"click","keydown.enter","ngClass"],["class","p-dialog-header-close-icon",3,"ngClass",4,"ngIf"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"]],template:function(n,r){n&1&&(ep(rI),ne(0,UI,2,17,"div",5)),n&2&&N("ngIf",r.maskVisible)},dependencies:()=>[un,Ko,Ho,Rn,z0,Tp,Zo,kn,zd,Bd],styles:[`@layer primeng{.p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translateZ(0)}.p-dialog-maximized{-webkit-transition:none;transition:none;transform:none;width:100vw!important;height:100vh!important;top:0!important;left:0!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}}
`],encapsulation:2,data:{animation:[hi("animation",[hn("void => visible",[gc(GI)]),hn("visible => void",[gc(jI)])])]},changeDetection:0})}return i})(),U0=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=qe({type:i});static \u0275inj=Be({imports:[mt,B0,Ep,Ji,kn,zd,Bd,Jo]})}return i})();var KI=(i,e)=>({"stage-level-number-unselected":i,"stage-level-number-selected":e});function HI(i,e){if(i&1){let t=Ue();L(0,"div",4),xe("click",function(){ce(t);let r=H();return ue(r.stageClick())}),L(1,"span",5),ye(2),U()()}if(i&2){let t=H();M(2),Gt(" ",t.stageLevel.value," ")}}function QI(i,e){if(i&1&&(yt(0,2),ye(1),vt()),i&2){let t=H();M(),Gt(" ",t.stageLevel.value," ")}}function WI(i,e){i&1&&(L(0,"span",6),X(1,"i",7),U())}function YI(i,e){if(i&1&&(L(0,"div",3),At(1,WI,2,0,"span",6,ai),U()),i&2){let t=H();M(),St(t.stars)}}function XI(i,e){i&1&&(L(0,"span",8),X(1,"i",7),U())}function JI(i,e){if(i&1){let t=Ue();L(0,"div",4),xe("click",function(){ce(t);let r=H(2);return ue(r.stageClick())}),At(1,XI,2,0,"span",8,ai),U()}if(i&2){let t=H(2);M(),St(t.stars)}}function ZI(i,e){i&1&&(L(0,"span",9),X(1,"i",10),U())}function eT(i,e){if(i&1&&At(0,ZI,2,0,"span",9,ai),i&2){let t=H(2);St(t.stars)}}function tT(i,e){if(i&1&&(L(0,"div",3),ne(1,JI,3,0,"div")(2,eT,2,0),U()),i&2){let t=H();M(),Yi(t.stageLevel.completed?1:2)}}var j0=(()=>{let e=class e{constructor(n){this.stageCommunicationService=n,this.stars=new Array(1,2,3)}stageClick(){this.stageCommunicationService.updatePerformedItem(this.stageLevel),console.log("Stage Clicked")}};e.\u0275fac=function(r){return new(r||e)(de(Nl))},e.\u0275cmp=_e({type:e,selectors:[["app-stage-level"]],inputs:{stageLevel:"stageLevel"},decls:7,vars:6,consts:[[1,"stage-level-layout"],[2,"text-align","center",3,"ngClass"],[1,"disable-stage-click"],[2,"display","flex","justify-content","center"],[3,"click"],[1,"stage-level-completed-value","enable-stage-click"],[1,"stage-level-asterisk-selected"],[1,"pi","pi-star-fill",2,"font-size","10px"],[1,"stage-level-asterisk-unselected","stage-level-completed","enable-stage-click"],[1,"stage-level-asterisk-unselected","disable-stage-click"],[1,"pi","pi-star",2,"font-size","10px"]],template:function(r,s){r&1&&(L(0,"div",0)(1,"div",1),ne(2,HI,3,1,"div")(3,QI,2,1,"ng-container",2),U(),L(4,"div"),ne(5,YI,3,0,"div",3)(6,tT,3,1,"div",3),U()()),r&2&&(M(),N("ngClass",ci(3,KI,!s.stageLevel.selected,s.stageLevel.selected)),M(),Yi(s.stageLevel.completed?2:3),M(3),Yi(s.stageLevel.selected?5:6))},dependencies:[un,Wo],styles:[".stage-level-layout[_ngcontent-%COMP%]{padding-top:1px}.stage-level-layout[_ngcontent-%COMP%]   .enable-stage-click[_ngcontent-%COMP%]{cursor:pointer;pointer-events:auto}.stage-level-layout[_ngcontent-%COMP%]   .disable-stage-click[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-font[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-size:17px}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-unselected[_ngcontent-%COMP%]{font-weight:450}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-number-selected[_ngcontent-%COMP%]{font-weight:600}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-unselected[_ngcontent-%COMP%]{color:#00f}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-asterisk-selected[_ngcontent-%COMP%]{color:#ec09eb}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed[_ngcontent-%COMP%], .stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{color:green;opacity:.5}.stage-level-layout[_ngcontent-%COMP%]   .stage-level-completed-value[_ngcontent-%COMP%]{font-weight:500;color:#000}"]});let i=e;return i})();var iT=(i,e)=>e.index,rT=i=>({"border-bottom":i});function sT(i,e){i&1&&(L(0,"div")(1,"span",2),ye(2,"No stage levels defined!"),U()())}function oT(i,e){if(i&1&&(L(0,"div",3),X(1,"app-stage-level",4),U()),i&2){let t=e.$implicit;N("ngStyle",Nt(2,rT,t.selected?"none":"1px solid #d4d4d4")),M(),N("stageLevel",t)}}function aT(i,e){if(i&1&&(L(0,"div",1),At(1,oT,2,4,"div",3,iT),U()),i&2){let t=H();M(),St(t.stageLevels)}}var $0=(()=>{let e=class e{constructor(){this.MAXSTAGE_LEVELS=5,this.NO_STAGE_LEVELS=!1,this.stageLevels=new Array}ngOnInit(){this.NO_STAGE_LEVELS=!this.stageLevels||this.stageLevels&&this.stageLevels.length!=this.MAXSTAGE_LEVELS}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=_e({type:e,selectors:[["app-game-stage-levels"]],inputs:{stageLevels:"stageLevels"},decls:3,vars:1,consts:[[1,"game-stage-level-layout"],[1,"stage-levels"],[1,"warning-message"],[1,"stage-level",3,"ngStyle"],[3,"stageLevel"]],template:function(r,s){r&1&&(L(0,"div",0),ne(1,sT,3,0,"div")(2,aT,3,0,"div",1),U()),r&2&&(M(),Yi(s.NO_STAGE_LEVELS?1:2))},dependencies:[Rn,Yo,j0],styles:[".digit-font-settings[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.game-stage-level-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange;padding-left:calc(50% - 115px)}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-items:center}.game-stage-level-layout[_ngcontent-%COMP%]   .stage-levels[_ngcontent-%COMP%]   .stage-level[_ngcontent-%COMP%]{border:1px solid #d4d4d4;padding:0 10px;order:0;flex:1 1 auto;align-self:auto}"]});let i=e;return i})();var yo=class{constructor(e=1/0){this.capacity=e,this.itemStorage=[]}peekBy(e){return this.itemStorage[e]}clear(){this.itemStorage.splice(0,this.itemStorage.length)}push(e){if(this.size()===this.capacity)throw Error("Error: The Stack has reached maximum Capacity!");this.itemStorage.push(e)}pop(){return this.itemStorage.pop()}peek(){return this.itemStorage[this.size()-1]}size(){return this.itemStorage.length}};var vo=class{constructor(e,t,n){this.operands=e,this.operator=t,this.result=n}};var K0=hi("operandButtonAnimationMove",[gs("buttonFromA",$t({left:"{{ posALeft }}",top:"{{ posATop }}",width:"90px",height:"90px"}),{params:{posALeft:"1025px",posATop:"219px"}}),gs("buttonToB",$t({left:"{{ posBLeft }}",top:"{{ posBTop }}",width:"90px",height:"90px"}),{params:{posBLeft:"805px",posBTop:"324px"}}),hn("* => buttonToB",Dn("1.5s"))]);var H0=(i,e)=>e.id,cT=i=>({"background-color":i});function uT(i,e){if(i&1){let t=Ue();L(0,"button",10),xe("click",function(){let r=ce(t).$implicit,s=H();return ue(s.onOperandButtonClick(r))}),ye(1),U()}if(i&2){let t=e.$implicit;N("disabled",t.disabled)("ngStyle",Nt(4,cT,t.selected?"rgb(190 209 253 / 59%)":""))("ngClass",!t.disabled&&!t.selected?"operator-content-button":"operator-content-button-disabled"),M(),Gt("",t.value," ")}}function hT(i,e){if(i&1){let t=Ue();L(0,"button",11),xe("click",function(){let r=ce(t).$implicit,s=H();return ue(s.onOperatorButtonClick(r))}),X(1,"mat-icon",12),U()}if(i&2){let t=e.$implicit,n=e.$index;N("ngClass",n===0?"revert-button":"arithmetic-operation-button"),M(),tp("svgIcon",t.icon)}}var Q0=(()=>{let e=class e{constructor(n,r){this.githubLogoPath="assets/logos/GitHub-Mark-32px.png",this.operators=new Array({id:0,selected:!1,caption:pe.OPERATOR_REV,operator:pe.OPERATOR_REV,icon:"revert"},{id:1,selected:!1,caption:pe.OPERATOR_ADD,operator:pe.OPERATOR_ADD,icon:"addition"},{id:2,selected:!1,caption:pe.OPERATOR_SUB,operator:pe.OPERATOR_SUB,icon:"substraction"},{id:3,selected:!1,caption:pe.OPERATOR_MUL,operator:pe.OPERATOR_MUL,icon:"multiplication"},{id:4,selected:!1,caption:pe.OPERATOR_DIV,operator:pe.OPERATOR_DIV,icon:"division"}),this.expectedResultReached=new ct,this.invalidOperationExecuted=new ct,n.addSvgIcon("revert",r.bypassSecurityTrustResourceUrl("assets/icons/rotate-left-solid.svg")),n.addSvgIcon("addition",r.bypassSecurityTrustResourceUrl("assets/icons/plus-solid.svg")),n.addSvgIcon("substraction",r.bypassSecurityTrustResourceUrl("assets/icons/minus-solid.svg")),n.addSvgIcon("multiplication",r.bypassSecurityTrustResourceUrl("assets/icons/xmark-solid.svg")),n.addSvgIcon("division",r.bypassSecurityTrustResourceUrl("assets/icons/divide-solid.svg"))}getSelectedOperator(){return this.operators.find(n=>n.selected)}clearSelectionOfOperands(){this.gameParameters.operands.forEach(n=>{n.selected=!1})}isTheExpectedResultReached(n){return this.gameParameters.result===n}addStateToHistory(n){this.history.push(n)}clearSelectionOfOperators(){this.operators.forEach(n=>{n.selected=!1})}addGameOperationToOperationHistory(n){this.operationHistory?.push(n)}captureAnimationTriggerStartEvent(n){console.log("Animation trigger start ",n)}captureAnimationTriggerDoneEvent(n){console.log("Animation trigger done ",n)}ngOnInit(){this.history=new yo,this.operationHistory=new yo}revertLastOperation(){this.history.size()>0?this.gameParameters=this.history.pop():console.log("History is empty!"),this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}enableOfAllOperands(){this.gameParameters.operands.forEach(n=>{n.disabled=!1})}clearHistory(){this.history?.clear()}removeLastOperation(){return this.history.pop()}onOperandButtonClick(n){if(n.selected=!n.selected,!n.selected){if(this.selectedOperandB&&this.selectedOperandB.id===n.id){this.selectedOperandB.selected=!1,this.selectedOperandB=null;return}else if(this.selectedOperandA&&this.selectedOperandA.id===n.id){this.selectedOperandA.selected=!1,this.selectedOperandA=null;return}}this.selectedOperandA?this.selectedOperandA.id!==n.id&&(this.selectedOperandB||(this.selectedOperandB=n)):this.selectedOperandA=n;var r=this.getSelectedOperator();if(this.selectedOperandA&&this.selectedOperandB&&!r)this.selectedOperandB.selected=!1,this.selectedOperandB=null;else if(this.selectedOperandA&&this.selectedOperandB&&r){let s=Ft.cloneGameParameters(this.gameParameters),o=Ft.evaluate(this.selectedOperandA.value,this.selectedOperandB.value,r.operator);if(this.addStateToHistory(s),o===Number.MIN_VALUE)this.invalidOperationExecuted.emit(o);else{let l=new Array(this.selectedOperandA.value,this.selectedOperandB.value),c=new vo(l,r.operator,o);this.addGameOperationToOperationHistory(c),this.isTheExpectedResultReached(o)&&this.expectedResultReached.emit(this.operationHistory),n.value=o;let h=this.gameParameters.operands.find(m=>m.id==this.selectedOperandA.id);h.disabled=!0,this.clearSelectionOfOperators(),this.clearSelectionOfOperands(),this.selectedOperandA=null,this.selectedOperandB=null}}console.log(`Value ${n.value} Selected ${n.selected}`)}onOperatorButtonClick(n){if(!this.selectedOperandA&&n.operator!==pe.OPERATOR_REV){n.selected=!1;return}if(n.selected=!n.selected,n.operator===pe.OPERATOR_REV){this.revertLastOperation();let r=Ft.cloneGameParameters(this.gameParameters),s=new Array;r.operands.forEach(l=>{s.push(l.value)});let o=new vo(s,n.operator,this.gameParameters.result);this.addGameOperationToOperationHistory(o)}console.log(`Caption ${n.caption} Selected ${n.selected}`)}ngOnDestroy(){this.history.clear(),this.history=void 0,this.operationHistory.clear(),this.operationHistory=void 0}};e.\u0275fac=function(r){return new(r||e)(de(dp),de(up))},e.\u0275cmp=_e({type:e,selectors:[["app-game-arithmetic-operations"]],hostVars:1,hostBindings:function(r,s){r&1&&Zm("@operandButtonAnimationMove.start",function(l){return s.captureAnimationTriggerStartEvent(l)})("@operandButtonAnimationMove.done",function(l){return s.captureAnimationTriggerDoneEvent(l)}),r&2&&Jm("@operandButtonAnimationMove",s.operandButtonAnimation)},inputs:{gameParameters:"gameParameters"},outputs:{expectedResultReached:"expectedResultReached",invalidOperationExecuted:"invalidOperationExecuted"},decls:15,vars:2,consts:[[1,"game-arithmetic-operations-layout"],[1,"usage-instruction"],[1,"expected-result"],[1,"operands-container"],[1,"three-operands"],["type","button",1,"operand",3,"disabled","ngStyle","ngClass"],[1,"operators-container"],["type","button",1,"operator-content",3,"ngClass"],["href","https://github.com/lkovari/LKovariHome/tree/master/src/app/digits/digits-game.component.ts"],["width","16","height","16",3,"src"],["type","button",1,"operand",3,"click","disabled","ngStyle","ngClass"],["type","button",1,"operator-content",3,"click","ngClass"],[1,"operator-content-icon",3,"svgIcon"]],template:function(r,s){r&1&&(L(0,"div",0)(1,"div",1),ye(2,"Use the any combination of number to reach the target:"),U(),L(3,"div")(4,"label",2),ye(5),U()(),L(6,"div",3)(7,"div",4),At(8,uT,2,6,"button",5,H0),U()(),L(10,"div",6),At(11,hT,2,2,"button",7,H0),U(),L(13,"a",8),X(14,"img",9),U()()),r&2&&(M(5),Pn(s.gameParameters.result),M(3),St(s.gameParameters.operands),M(3),St(s.operators),M(3),N("src",s.githubLogoPath,Ym))},dependencies:[un,Rn,Wo,Yo,mp],styles:[".game-arithmetic-operations-layout[_ngcontent-%COMP%]{text-align:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .usage-instruction[_ngcontent-%COMP%]{font-size:13px;font-weight:500;line-height:13px;letter-spacing:.02em;padding-bottom:20px;font-family:Arial,Helvetica,sans-serif}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .expected-result[_ngcontent-%COMP%]{text-align:center;font-size:55px;font-weight:500;padding-bottom:1rem}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]{font-size:44px;font-weight:500}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]{justify-content:center;display:flex;flex-direction:row;flex-wrap:wrap;width:371px;margin:7px auto}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]{width:90px;height:90px;border:4px dashed blue;border-radius:50%;font-size:26px;font-weight:550;margin:4px 10px;font-family:Courier New,Courier,monospace}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operands-container[_ngcontent-%COMP%]   .three-operands[_ngcontent-%COMP%]   .operand[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:4px solid blue}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operators-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:center;align-content:center;align-items:center}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;width:3.55rem;height:3.55rem;border:4px solid #6b6b6b;border-radius:50%;margin:3px;display:flex;justify-content:center;align-items:center;color:#00f}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%], .game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button-disabled[_ngcontent-%COMP%]{background-color:#fff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-button[_ngcontent-%COMP%]:hover{background-color:#e6fffa}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .operator-content-icon[_ngcontent-%COMP%]{width:30px;height:30px;font-weight:500;vertical-align:middle}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]{background-color:#dbfbdd}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .revert-button[_ngcontent-%COMP%]:hover{background-color:#aae0ae}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]{background-color:#d9ecff}.game-arithmetic-operations-layout[_ngcontent-%COMP%]   .arithmetic-operation-button[_ngcontent-%COMP%]:hover{background-color:#aed7ff}"],data:{animation:[K0]}});let i=e;return i})();var mT=["arithmeticOperations"];function pT(i,e){if(i&1&&(L(0,"li",13),ye(1),U()),i&2){let t=e.$implicit;M(),Gt(" ",t," ")}}function fT(i,e){if(i&1&&(L(0,"li",13),ye(1),U()),i&2){let t=e.$implicit;M(),Gt(" ",t," ")}}var W0=(()=>{let e=class e{constructor(n,r,s,o,l){this.messageService=n,this.cookieService=r,this.clipboardService=s,this.numbersFirestoreService=o,this.stageCommunicationService=l,this.COOKIE_LK_DIGITS="CookieLKNumbers",this.generateGameParameters=new ia,this.currentDate=new Date,this.stageLevels=[],this.gameParameters=[],this.stageIndex=0,this.todayPuzzleDataItems=[],this.splashVisible=!1,this.gameCompletedModalMessages=[],this.gameCompletedModalVisible=!1,this.allGameCompletedModalMessage=[],this.allGameCompletedModalVisible=!1,this.splashWidth="80vw",this.destroyRef=Qi(Wm),this.defaultGameParameters={result:0,operands:[],stageIndex:0},this.updateStageLevel=this.stageCommunicationService.getUpdatedStageLevel().pipe(_p(this.destroyRef)).subscribe({next:c=>{console.log("StageLevel updated "+c.index)},error:c=>console.error("StageLevel updated "+c),complete:()=>console.info("StageLevel updated Complete")})}initializeStageLevels(){this.stageLevels=new Array({selected:!0,index:0,value:96,completed:!1,summary:""},{selected:!1,index:1,value:161,completed:!1,summary:""},{selected:!1,index:2,value:275,completed:!1,summary:""},{selected:!1,index:3,value:355,completed:!1,summary:""},{selected:!1,index:4,value:404,completed:!1,summary:""})}stageToCompleted(){this.stageLevels[this.stageIndex].completed=!0,this.stageLevels[this.stageIndex].selected=!1}formatOperations(n){let r=`Completed! Executed Operations:
`,s=n.size()-1;for(;s>=0;){let o=n.peekBy(s);r+=s+1+". "+o?.operands[0]+" "+o?.operator+" "+o?.operands[1]+" = "+o?.result+`
`,--s}return r}createSummaryOfTHeOperations(n,r){let s=this.stageLevels[n].value+" -> ";for(this.gameCompletedModalMessages=[];r.size()>0;){let o=r.pop();this.gameCompletedModalMessages.push(o?.operands[0]+" "+o.operator+" "+o?.operands[1]+" = "+o?.result),s+=""+o?.operator}return s+=`
`,s}showSuccessMessage(n){this.messageService.add({severity:"success",summary:"Congratulation!",detail:n})}showErrorMessage(n){this.messageService.add({severity:"error",summary:"Error!",detail:n})}setupStages(){let n=0;this.gameParameters.forEach(r=>{this.stageLevels[n].value=r.result,++n})}storeGameStateToCookie(){let n=new ws;n.storeDate=new Date,n.stageIndex=this.stageIndex,n.stageLevels=this.stageLevels,n.completed=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1,n.gameParameters=this.gameParameters;let r=n.cookieData2Text(),s=new Date;s.setHours(23,59,59,999),this.cookieService.set(this.COOKIE_LK_DIGITS,r,s)}restoreGameStateFromCookie(){let n=this.cookieService.get(this.COOKIE_LK_DIGITS),r;return!n||n==""?(console.log("INFO: Unable to retrieve the Game State"),r=null):(r=new ws,r=r.text2CookieData(n)),r}mapPuzzleDataToGameParameters(n){n.stages.forEach(r=>{let s=this.gameParameters.find(o=>o.stageIndex===r.stageIndex);if(s){s.result=r.expectedValue;let o=0;s.operands.forEach(c=>{c.value=r.operands[o],o++}),this.initializeStageLevels();let l=this.stageLevels.find(c=>c.index===r.stageIndex);l&&l.value==r.expectedValue}})}mapGameParametersToPuzzleData(n){let r=new sa;return r.day=new Date,r.day.setHours(23,59,59,999),n.forEach(s=>{let o=new oa;o.stageIndex=s.stageIndex,o.expectedValue=s.result;let l=new Array;s.operands.forEach(c=>{l.push(c.value)}),o.operands=l,r.stages.push(o)}),r}isDateSame(n,r){return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()}updatePuzzleDataInDb(n){this.firestorePuzzleData.data=JSON.stringify(n),this.numbersFirestoreService.update(this.firestorePuzzleData.id,{data:this.firestorePuzzleData.data}).then(()=>console.log("INFO: The Game Data was updated successfully in DB!")).catch(r=>console.log(r))}createPuzzleDataInDb(n){this.numbersFirestoreService.create(n).then(()=>{console.log("INFO: The Puzzle Data was created successfully in DB!")})}currentLocaleAlreadyStoredInDb(){let n=navigator.language;return this.firestorePuzzleDataItems.find(s=>s.locale===n)!==void 0}upsertGameDataInDb(n){if(this.currentLocaleAlreadyStoredInDb())this.updatePuzzleDataInDb(n);else{let r=new Is;r.locale=navigator.language,r.data=JSON.stringify(n),this.createPuzzleDataInDb(r)}}allGameCompleted(){let n=!0;return this.stageLevels.forEach(r=>{n=n&&r.completed}),n}collectAllOperations(){let n=this.allGameCompleted()&&this.stageIndex===this.stageLevels.length-1;if(n){let r=`Genius!
`;this.allGameCompletedModalMessage=[],this.stageLevels.forEach(s=>{r+=s.summary,this.allGameCompletedModalMessage.push(s.summary)}),this.clipboardService.copy(r),this.storeGameStateToCookie(),this.allGameCompletedModalVisible=!0}return n}generateNewGameAndStore(){this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let n=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(n)}ngOnInit(){console.log(`Browser locale: ${navigator.language}`),this.initializeStageLevels();let n=this.restoreGameStateFromCookie();if(n){console.log("INFO: Game state restored from cookie");let r=new Date(n.storeDate);if(this.isDateSame(r,new Date))this.stageIndex=n.stageIndex,this.stageLevels=n.stageLevels,this.gameParameters=n.gameParameters,this.setupStages(),n.completed?this.collectAllOperations()&&console.log("INFO: All Games completed show completed modal"):(console.log("INFO: All Games incomplete show splash"),this.splashVisible=!0);else{this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let s=this.mapGameParametersToPuzzleData(this.gameParameters);console.log("INFO: Date mismatch which restored from cookie "+s),this.upsertGameDataInDb(s)}}else{console.log("INFO: No game state in cookie, try to get if from DB."),this.gameParameters=this.generateGameParameters.generateStageNumbers();let r=navigator.language;this.numbersFirestoreService.getAll().snapshotChanges().pipe(He(s=>s.map(o=>Mt({id:o.payload.doc.id},o.payload.doc.data())))).subscribe(s=>{this.firestorePuzzleDataItems=s;let o=s.find(l=>l.locale===r);if(o){this.firestorePuzzleData=o,this.todayPuzzleData=JSON.parse(this.firestorePuzzleData.data),console.log("INFO: Game Data retrieved from DB.");let l=new Date,c=new Date(this.todayPuzzleData.day);if(this.todayPuzzleData.day&&this.isDateSame(c,l))console.log("INFO: Game Data day date is matched, apply Game data"),this.mapPuzzleDataToGameParameters(this.todayPuzzleData),this.storeGameStateToCookie(),this.setupStages();else{console.log("INFO: Game Data day of date is Not matched, generate new game parameters"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let h=this.mapGameParametersToPuzzleData(this.gameParameters);this.upsertGameDataInDb(h)}}else{console.log("INFO: Game Data not found in the DB. by locale"),this.gameParameters=this.generateGameParameters.generateStageNumbers(),this.storeGameStateToCookie(),this.setupStages();let l=this.mapGameParametersToPuzzleData(this.gameParameters),c=new Is;c.locale=navigator.language,c.data=JSON.stringify(l),this.createPuzzleDataInDb(c)}})}}ngOnDestroy(){this.updateStageLevel.unsubscribe()}expectedResultReached(n){let r=this.formatOperations(n),s=this.createSummaryOfTHeOperations(this.stageIndex,n);this.stageLevels[this.stageIndex].summary=s,this.clipboardService.copy(r),this.showSuccessMessage("You are reach the expected result!"),this.stageToCompleted(),this.reachedValue=this.gameParameters[this.stageIndex].result,this.gameCompletedModalVisible=!0}hideGameCompletedDialog(){this.collectAllOperations()||(this.stageIndex++,this.stageLevels[this.stageIndex].selected=!0),this.storeGameStateToCookie(),this.arithmeticComponent.clearHistory()}invalidOperationExecuted(n){this.showErrorMessage("Invalid Operation Executed!"),this.arithmeticComponent.revertLastOperation(),console.log(n)}onDeleteCookie(){this.cookieService.deleteAll()}onUpdatePuzzleData(){this.generateNewGameAndStore()}};e.\u0275fac=function(r){return new(r||e)(de(Xi),de(ra),de(kp),de(Ml),de(Nl))},e.\u0275cmp=_e({type:e,selectors:[["app-digits-game"]],viewQuery:function(r,s){if(r&1&&ln(mT,7),r&2){let o;ht(o=dt())&&(s.arithmeticComponent=o.first)}},features:[np([Xi,ra])],decls:31,vars:14,consts:[["arithmeticOperations",""],[1,"digits-game-layout"],["position","top-center","closable","true"],[1,"digits-game-title"],["href","https://www.nytimes.com/games/digits",1,"anchor-underline-off"],[1,"title-bar"],[1,"title-bar-name",3,"click"],[1,"title-bar-date",3,"click"],[1,"tool-bar"],[3,"stageLevels"],[3,"expectedResultReached","invalidOperationExecuted","gameParameters"],["id","splashscreen","header","Welcome to the Numbers Puzzle Game",3,"visibleChange","visible","modal"],["id","gameCompleted","header","Game Completed",3,"visibleChange","onHide","visible","modal"],[1,"li-no-bullet"],["id","allGamesCompleted","header","All Game Completed Genius!",3,"visibleChange","visible","modal","closable"]],template:function(r,s){if(r&1){let o=Ue();L(0,"div",1),X(1,"p-toast",2),L(2,"div",3),ye(3," This is a daily numbers puzzle, similar to the "),L(4,"a",4),ye(5,"NY Times Digits"),U(),ye(6,", which unfortunately discontinued at August 8, 2023 "),U(),L(7,"div",5)(8,"div",6),xe("click",function(){return ce(o),ue(s.onDeleteCookie())}),ye(9," Numbers "),U(),L(10,"div",7),xe("click",function(){return ce(o),ue(s.onUpdatePuzzleData())}),ye(11),rp(12,"date"),U()(),L(13,"div",8),X(14,"app-game-stage-levels",9),U(),L(15,"div")(16,"app-game-arithmetic-operations",10,0),xe("expectedResultReached",function(c){return ce(o),ue(s.expectedResultReached(c))})("invalidOperationExecuted",function(c){return ce(o),ue(s.invalidOperationExecuted(c))}),U()()(),L(18,"p-dialog",11),jo("visibleChange",function(c){return ce(o),Go(s.splashVisible,c)||(s.splashVisible=c),ue(c)}),L(19,"p"),ye(20,"It can improves your arithmetic combination ability."),U()(),L(21,"p-dialog",12),jo("visibleChange",function(c){return ce(o),Go(s.gameCompletedModalVisible,c)||(s.gameCompletedModalVisible=c),ue(c)}),xe("onHide",function(){return ce(o),ue(s.hideGameCompletedDialog())}),L(22,"div"),ye(23),At(24,pT,2,1,"li",13,ai),U()(),L(26,"p-dialog",14),jo("visibleChange",function(c){return ce(o),Go(s.allGameCompletedModalVisible,c)||(s.allGameCompletedModalVisible=c),ue(c)}),L(27,"div"),ye(28," Congratulation! Your Solutions: "),At(29,fT,2,1,"li",13,ai),U()()}if(r&2){let o;M(11),Gt(" ",sp(12,11,s.currentDate,"MM/dd/yyyy")," "),M(3),N("stageLevels",s.stageLevels),M(2),N("gameParameters",(o=s.gameParameters[s.stageIndex])!==null&&o!==void 0?o:s.defaultGameParameters),M(2),Uo("visible",s.splashVisible),N("modal",!0),M(3),Uo("visible",s.gameCompletedModalVisible),N("modal",!0),M(2),Gt(" Target ",s.reachedValue,". Your solution: "),M(),St(s.gameCompletedModalMessages),M(2),Uo("visible",s.allGameCompletedModalVisible),N("modal",!0)("closable",!1),M(3),St(s.allGameCompletedModalMessage)}},dependencies:[F0,q0,$0,Q0,cp],styles:[".digit-font-settings[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:17px;font-family:Courier New,Courier,monospace;letter-spacing:.03em}.digits-border-horizontal[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{border-bottom:1px solid #d4d4d4;padding:12px 0}.digits-game-layout[_ngcontent-%COMP%]{height:98vh;width:50vw;position:absolute;inset:0;margin:auto;background:#ebf9fd40;border:1px solid lightgray}.digits-game-layout[_ngcontent-%COMP%]   .digits-game-title[_ngcontent-%COMP%]{text-align:center}.digits-game-layout[_ngcontent-%COMP%]   .anchor-underline-off[_ngcontent-%COMP%]{text-decoration:none}.digits-game-layout[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{font-weight:500;font-size:17px;text-align:center;color:orange}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;align-content:stretch;align-items:center;font-size:28px;font-weight:300;font-family:Arial,Helvetica,sans-serif}.digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-name[_ngcontent-%COMP%], .digits-game-layout[_ngcontent-%COMP%]   .title-bar[_ngcontent-%COMP%]   .title-bar-date[_ngcontent-%COMP%]{order:0;flex:0 1 auto;align-self:auto;cursor:default}.digits-game-layout[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]{height:52px}@media only screen and (max-width: 600px){.digits-game-layout[_ngcontent-%COMP%]{height:90vh;width:99vw}.digits-game-layout[_ngcontent-%COMP%]     .p-dialog{width:80vw}}@media only screen and (min-width: 601px){  .p-dialog{width:20vw}.digits-game-layout[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}}@media only screen and (max-width: 600px){  .p-dialog{width:80vw}}  .p-dialog{border:2px solid;border-radius:25px;border-color:#00bfff}  .p-dialog .p-dialog-header{background-color:#f0f8ff;background-image:none;border-top-right-radius:25px;border-top-left-radius:25px}  .p-dialog .p-dialog-content:last-of-type{background-color:#f0f8ff;background-image:none;border-bottom-right-radius:25px;border-bottom-left-radius:25px}  li.li-no-bullet{list-style-position:revert;list-style-image:initial;list-style-type:decimal-leading-zero}"]});let i=e;return i})();var gT=[{path:"digits/digits-game",component:W0}],Y0=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=Be({imports:[mt,fs.forChild(gT),fs]});let i=e;return i})();var X0=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=qe({type:i});static \u0275inj=Be({imports:[mt,Ji,mo,fo,go,po,kn]})}return i})();var tA=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=qe({type:e}),e.\u0275inj=Be({providers:[Ml],imports:[mt,fs,L0,X0,Y0,hp,pp,Vp,Wp.initializeApp(Rp.firebasePuzzleData),V0,U0]});let i=e;return i})();export{tA as DigitsModule};
